"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2548],{52548:function(e,t,r){r.d(t,{$E:function(){return Vr}});var n=r(50959),o=r(77320),i=r(80472),a=r(10866),c=r(11029),l=r(58002),u=r(81505);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var d=function(){return n.createElement("div",null,"Loading...")},p=function(e){var t=e.children,r=(e.type,(0,n.useRef)(null)),o=s((0,n.useState)(!0),2),i=o[0],a=o[1],c=new u.X(!0);(0,n.useEffect)((function(){var e=c.subscribe(a),t=new IntersectionObserver((function(e){var t=s(e,1)[0].isIntersecting;c.next(t)}),{root:null,rootMargin:"100px",threshold:0}),n=r.current;return n&&t.observe(n),function(){n&&t.unobserve(n),t.disconnect(),e.unsubscribe()}}),[]);var l=i&&n.createElement(n.Suspense,{fallback:n.createElement(d,null)},t);return n.createElement("div",{ref:r,style:{height:"100px",width:"100px"}},i?l:null)},y=function(e){e.id;var t=e.data,r=(t||{})._fromEdge,i=r?{top:"30px",backgroundColor:"transparent",border:"none"}:{top:"60px",backgroundColor:"transparent",border:"none"};return n.createElement("div",null,n.createElement(o.HH,{type:"target",position:o.Ly.Left,id:"left",style:i}),n.createElement(o.HH,{type:"target",position:o.Ly.Right,id:"left-revert",style:i}),n.createElement(o.HH,{type:"source",position:o.Ly.Right,id:"right",style:i}),n.createElement(o.HH,{type:"source",position:o.Ly.Left,id:"right-revert",style:i}),n.createElement(l.TableCard,{data:t,_fromEdge:r}))},b=function(e){return n.createElement(p,{type:"NODE"},n.createElement(y,e))},g=(0,n.memo)(b),m=r(53531),h=r(10705),v=r(1705),w=r(52553),O={appMode:"DATA_MODELING",disabled:!1,nodes:[],edges:[],source:{nodes:[],edges:[]},displayMode:"graph",graphPosition:{},tablePosition:{},currentType:"nodes",currentId:"",hasLayouted:!1,elementOptions:{isEditable:!1,isConnectable:!0},theme:{primaryColor:"#1978FF"}},E={},x=function(e,t){e&&(E[e]||(E[e]=t));return E[e]};function j(){var e=Ot().graphId,t=x(null!=e?e:"root-1",(0,v.sj)(l.Utils.fakeSnapshot(O)));Ot().onNodesChange,Ot().onEdgesChange;return{store:(0,w.R)(t),updateStore:function(e){return e(t)}}}function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){L(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function L(e,t,r){var n;return n=function(e,t){if("object"!=S(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==S(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Z=m.Z.useToken,I="100px",N="116px",D={handler:{width:N,height:N,zIndex:0,top:"50%",left:"50%",transform:"translate(-50%, -50%)",transition:"all 0.3s ease"}},M=function(e){var t=e.data,r=void 0===t?{}:t,i=e.id,a=r.label,c=r.filelocation,u=r.disabled,s=j(),f=s.store,d=s.updateStore,p=f.currentId,y=f.theme,b=f.elementOptions,g=(0,l.useStudioProvier)().isLight,m=(0,l.useSection)(),v=m.toggleRightSide,w=m.toggleLeftSide,O=Z().token,E=i===p,x=!b.isConnectable,S=C((0,n.useState)({isHover:!1,contentEditable:!1}),2),P=S[0],L=S[1],A=x?{cursor:"not-allow",background:"transparent",border:"none"}:k(k({},D.handler),{},{border:P.isHover?"2px dashed ".concat(y.primaryColor):"none",background:P.isHover?"#fafafa":"transparent",cursor:"copy"});return n.createElement("div",{"data-nodeid":i,style:{boxSizing:"border-box",width:"100px",height:"100px"},onMouseEnter:function(){x||L((function(e){return k(k({},e),{},{isHover:!0})}))},onMouseLeave:function(){x||L((function(e){return k(k({},e),{},{isHover:!1})}))},onClick:function(){d((function(e){e.currentType="nodes",e.currentId=i})),v(!1),w(!0)}},n.createElement(o.HH,{type:"target",position:o.Ly.Left,id:"left",style:{background:"transparent",position:"relative",border:"none"}}),n.createElement(o.HH,{type:"source",position:o.Ly.Right,id:"right",style:A}),n.createElement("div",{style:{position:"absolute",top:0,left:0,border:g?E?"4px solid ".concat(y.primaryColor):"2px solid #000":E?"4px solid ".concat(y.primaryColor):"2px solid #d7d7d7",backgroundColor:g?"#fafafa":"#161616",borderRadius:"50%",height:I,width:I,boxSizing:"border-box",zIndex:0,display:"flex",justifyContent:"center",alignItems:"center",fontSize:"20px"},"data-nodeid":i},c&&n.createElement("div",{style:{position:"absolute",top:"0px",right:"-16px"}},n.createElement(h.Z,{style:{color:O.colorSuccessActive,fontSize:20}})),n.createElement(l.EditableText,{id:i,text:a,onTextChange:function(e){d((function(t){var r=t.nodes.find((function(e){return e.id===i}));r&&(r.data.label=e)}))},disabled:u,style:{color:g?"#000":"#D7D7D7"}})))},T={"table-node":g,"graph-node":(0,n.memo)(M)};function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){U(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function U(e,t,r){var n;return n=function(e,t){if("object"!=_(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==_(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F(e,t){var r=e.width,n=e.height,o=e.positionAbsolute,i=t.positionAbsolute,a=r/2,c=n/2,l=o.x+a,u=o.y+c,s=i.x+t.width/2,f=i.y+t.height/2,d=(s-l)/(2*a)-(f-u)/(2*c),p=(s-l)/(2*a)+(f-u)/(2*c),y=1/(Math.abs(d)+Math.abs(p)),b=y*d,g=y*p;return{x:a*(b+g)+l,y:c*(-b+g)+u}}function Y(e,t){var r=H(H({},e.positionAbsolute),e),n=Math.round(r.x),i=Math.round(r.y),a=Math.round(t.x),c=Math.round(t.y);return a<=n+1?o.Ly.Left:a>=n+r.width-1?o.Ly.Right:c<=i+1?o.Ly.Top:c>=r.y+r.height-1?o.Ly.Bottom:o.Ly.Top}var G=function(e){var t=e.sourceX,r=e.sourceY,n=e.targetX,o=e.targetY,i=e.offset,a=n-t,c=o-r,l=Math.sqrt(a*a+c*c);return{x:t+a/2+-(c/l)*i,y:r+c/2+a/l*i}};function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach((function(t){W(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function W(e,t,r){var n;return n=function(e,t){if("object"!=X(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=X(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==X(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var $=m.Z.useToken,B=function(e){var t=e.id,r=e.label,i=e.style,a=e.filelocation,c=e.disabled,u=j(),s=u.store,f=u.updateStore,d=(0,l.useSection)().toggleRightSide,p=$().token,y=s.currentId,b=s.theme,g=t===y,m=(0,l.useStudioProvier)().isLight,v=Ot().disabled,w=void 0!==v&&v;return n.createElement(o.XQ,null,n.createElement("div",{style:V({cursor:"pointer",position:"absolute",fontSize:12,pointerEvents:"all"},i),className:"nodrag nopan"},a&&n.createElement("div",{style:{position:"absolute",right:"-16px",top:"-6px"}},n.createElement(h.Z,{style:{color:p.colorSuccessActive,fontSize:12}})),n.createElement("div",{className:"edgebutton",onClick:function(){f((function(e){e.currentId=t,e.currentType="edges"})),d(!1)},style:{borderRadius:"4px",background:m?g?"".concat(b.primaryColor):"#fff":g?"".concat(b.primaryColor):"#161616",border:m?g?"2px solid ".concat(b.primaryColor):"1px solid #000":g?"2px solid ".concat(b.primaryColor):"1px solid #d7d7d7"}},n.createElement(l.EditableText,{disabled:c||w,id:t,text:r||"",onTextChange:function(e){f((function(r){var n=r.edges.find((function(e){return e.id===t}));n&&(n.data.label=e)}))},style:{color:m?g?"#fff":"#000":g?"#fff":"#D7D7D7",fontSize:"10px",lineHeight:"14px",minHeight:"14px"}}))))};function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){K(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function K(e,t,r){var n;return n=function(e,t){if("object"!=q(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==q(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ee=function(e){var t=e.id,r=e.style,o=e.data,i=e.sourceX,a=e.sourceY,c=o||{},u=c._extra,s=c.label,f=c.filelocation,d=(u||{}).index,p=void 0===d?0:d,y=function(e){var t=j().store,r=t.currentId,n=t.theme,o=e===r,i=(0,l.useStudioProvier)().isLight;return{isSelected:o,markerEnd:o?"url(#arrow-selected)":"url(#arrow)",style:{stroke:i?o?n.primaryColor:"#000":o?n.primaryColor:"#d7d7d7",strokeWidth:o?"2px":"1px"}}}(t),b=y.markerEnd,g=y.style,m=function(e,t,r){var n=r.index,o=e-33,i=t-40,a=60+40*n,c=o,l=i,u=o-60,s=i;return"\n        M ".concat(c," ").concat(l," \n        C ").concat(c+a," ").concat(l-a,", \n          ").concat(u-a," ").concat(s-a,", \n          ").concat(u," ").concat(s)}(i,a,{index:p}),h=function(e,t,r){var n=r.index,o=30*n;return{x:e-63,y:t-o-80}}(i,a,{index:p}),v=Ot().onEdgeClick;return n.createElement(n.Fragment,null,n.createElement("path",{id:t,className:"react-flow__edge-path",d:m,markerEnd:b,style:J(J({},r),g),onClick:function(e){v&&v(o,e)}}),n.createElement(B,{filelocation:f,label:s,id:t,style:{transform:"translate(-50%, -50%) translate(".concat(h.x,"px,").concat(h.y,"px)")}}))};function te(e){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},te(e)}function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(Object(r),!0).forEach((function(t){oe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function oe(e,t,r){var n;return n=function(e,t){if("object"!=te(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=te(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==te(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ae(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ae(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ce=function(e){var t=e.id,r=e.source,i=e.target,a=e.style,c=e.data,u=c||{},s=u._extra,f=u.label,d=u.filelocation,p=u.disabled,y=(s||{}).offset,b=void 0===y?0:y,g=(0,o.oR)((0,n.useCallback)((function(e){return e.nodeInternals.get(r)}),[r])),m=(0,o.oR)((0,n.useCallback)((function(e){return e.nodeInternals.get(i)}),[i])),h=j().store,v=h.currentId,w=h.theme,O=(0,l.useStudioProvier)().isLight,E=Ot().onEdgeClick;if(!g||!m)return null;if(r===i)return n.createElement(ee,e);var x=t===v,S=function(e,t){var r=F(e,t),n=F(t,e),o=Y(e,r),i=Y(t,n);return{sx:r.x,sy:r.y,tx:n.x,ty:n.y,sourcePos:o,targetPos:i}}(g,m),P=S.sx,k=S.sy,L=S.tx,C=S.ty,A=G({sourceX:P,sourceY:k,targetX:L,targetY:C,offset:b}),Z=function(e){var t=e.sourceX,r=e.sourceY,n=e.targetX,o=e.targetY,i=e.offset,a=e.R1,c=void 0===a?20:a,l=e.R2,u=void 0===l?20:l,s=G({sourceX:t,sourceY:r,targetX:n,targetY:o,offset:i}),f=n-t,d=o-r,p=Math.sqrt(f*f+d*d),y=f/p,b=d/p;return{P1:{x:t+y*c+i*-b,y:r+b*c+i*y},P2:{x:n+-y*u+i*-b,y:o+-b*u+i*y},controlPoint:s}}({sourceX:P,sourceY:k,targetX:L,targetY:C,offset:b}),I=ie(function(e){var t=e.source,r=e.P1,n=e.P2,o=e.P3,i=e.target,a={x:r.x+(t.x-r.x)/3,y:r.y+(t.y-r.y)/3},c={x:r.x+(n.x-r.x)/3,y:r.y+(n.y-r.y)/3},l={x:o.x+(n.x-o.x)/3,y:o.y+(n.y-o.y)/3},u={x:o.x+(i.x-o.x)/3,y:o.y+(i.y-o.y)/3};return[["M ".concat(t.x,",").concat(t.y),"L ".concat(a.x,",").concat(a.y),"Q ".concat(r.x,",").concat(r.y," ").concat(c.x,",").concat(c.y),"L ".concat(n.x,",").concat(n.y),"L ".concat(l.x,",").concat(l.y),"Q ".concat(o.x,",").concat(o.y," ").concat(u.x,",").concat(u.y),"L ".concat(i.x,",").concat(i.y)].join(" ")]}({source:{x:P,y:k},target:{x:L,y:C},P1:Z.P1,P2:A,P3:Z.P2}),1)[0],N=function(e,t){var r=t.x-e.x,n=t.y-e.y,o=Math.atan2(n,r)*(180/Math.PI);return o>90?o-=180:o<-90&&(o+=180),o}({x:P,y:k},{x:L,y:C});return n.createElement("g",{onClick:function(e){E&&E(c,e)}},n.createElement("path",{id:t,className:"react-flow__edge-path",d:I,markerEnd:x?"url(#arrow-selected)":"url(#arrow)",style:ne(ne({},a),{},{stroke:O?x?w.primaryColor:"#000":x?w.primaryColor:"#d7d7d7",strokeWidth:x?"2px":"1px"})}),n.createElement(B,{id:t,label:f,filelocation:d,disabled:p,style:{transform:"translate(-50%, -50%) translate(".concat(A.x,"px,").concat(A.y,"px) rotate(").concat(N,"deg)")}}))},le={"table-edge":function(e){e.source,e.target;var t=e.sourceX,r=e.sourceY,i=e.targetX,a=e.targetY,c=e.sourcePosition,l=e.targetPosition,u=e.markerEnd,s=(e.data,e.style||{}),f=(s._isLoop,s._isPoly,s._isRevert,s._offset),d=function(e,t){var r=e.sourceX,n=e.sourceY,o=e.targetX,i=e.targetY,a=(r+o)/2,c=(n+i)/2;return"M ".concat(r," ").concat(n," Q ").concat(a," ").concat(c+t," ").concat(o," ").concat(i)}({sourceX:t,sourceY:r,sourcePosition:c,targetX:i,targetY:a,targetPosition:l},void 0===f?0:f);return n.createElement(n.Fragment,null,n.createElement(o.u5,{path:d,markerEnd:u}))},"graph-edge":ce},ue=function(e){var t=e.fromX,r=e.fromY,o=e.toX,i=e.toY;return n.createElement("g",{style:{zIndex:-1,position:"absolute"}},n.createElement("path",{fill:"none",stroke:"#000",strokeWidth:1,className:"animated",d:"M".concat(t,",").concat(r," L ").concat(o,",").concat(i),markerEnd:"url(#arrow-dragging)"}),n.createElement("circle",{cx:o,cy:i,fill:"#fff",r:50,className:"animated",stroke:"#000",strokeWidth:1,strokeDasharray:"10, 5"}))},se=(m.Z.useToken,function(e){var t=e.selectedColor,r=void 0===t?"red":t,o=e.color,i=void 0===o?"#000":o;return n.createElement("svg",{id:"arrow-marker-svg",width:"200",height:"200",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",top:0,left:0,zIndex:-1}},n.createElement("defs",null,n.createElement("marker",{id:"arrow",markerWidth:"10",markerHeight:"10",refX:"8",refY:"3",orient:"auto",markerUnits:"strokeWidth"},n.createElement("path",{d:"M0,0 L0,6 L9,3 z",fill:i})),n.createElement("marker",{id:"arrow-selected",markerWidth:"10",markerHeight:"10",refX:"8",refY:"3",orient:"auto",markerUnits:"strokeWidth"},n.createElement("path",{d:"M0,0 L0,6 L9,3 z",fill:r})),n.createElement("marker",{id:"arrow-dragging",markerWidth:"10",markerHeight:"10",refX:"60",refY:"3",orient:"auto",markerUnits:"strokeWidth"},n.createElement("path",{d:"M0,0 L0,6 L9,3 z",fill:i,className:"animated",strokeDasharray:"10, 5"}))))}),fe=r(28541),de=r(17905),pe=r(38943),ye=function(e){var t=1/0,r=-1/0,n=1/0,o=-1/0;return e.forEach((function(e){e.position.x<t&&(t=e.position.x),e.position.x>r&&(r=e.position.x),e.position.y<n&&(n=e.position.y),e.position.y>o&&(o=e.position.y)})),{x:t,y:n,width:r-t+100,height:o-n+100}},be=1,ge=1,me=function(){return"Vertex_".concat(be++)},he=function(){return"Edge_".concat(ge++)},ve=r(84155),we=function(e){var t=e.style,r=j(),o=r.updateStore,i=r.store.elementOptions,a=i.isEditable?n.createElement(ve.Z,{id:"The current mode is preview only, and does not support clearing the model"}):n.createElement(ve.Z,{id:"Clear graph model"});return n.createElement(de.Z,{title:a,placement:"right"},n.createElement(pe.ZP,{disabled:i.isEditable,onClick:function(){be=1,ge=1,o((function(e){e.nodes=[],e.edges=[]}))},style:t,type:"text",icon:n.createElement(l.Icons.Trash,{disabled:i.isEditable})}))},Oe=r(62950);function Ee(e){return function(e){if(Array.isArray(e))return xe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return xe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xe(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var je=l.Icons.AddNode,Se=0,Pe=function(e){var t=e.style,r=(0,o._K)().setCenter,i=j().updateStore,a=Ot().noDefaultLabel,c=n.createElement(ve.Z,{id:"Create new vertex"});return n.createElement(de.Z,{title:c,placement:"right"},n.createElement(pe.ZP,{onClick:function(){i((function(e){var t=me(),n=200*Se,o=100*Se;Se++,e.nodes=[].concat(Ee(e.nodes),[{id:(0,Oe.Z)(),position:{x:n,y:o},type:"graph-node",data:{label:a?"":t}}]),r(n+50,o+50,{duration:600,zoom:1})}))},style:t,type:"text",icon:n.createElement(je,null)}))},ke=(0,n.memo)(Pe),Le=r(61448),Ce=r(5490);function Ae(e){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(e)}function Ze(){Ze=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var i=t&&t.prototype instanceof g?t:g,a=Object.create(i.prototype),c=new C(n||[]);return o(a,"_invoke",{value:S(e,r,c)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=s;var d="suspendedStart",p="executing",y="completed",b={};function g(){}function m(){}function h(){}var v={};u(v,a,(function(){return this}));var w=Object.getPrototypeOf,O=w&&w(w(A([])));O&&O!==r&&n.call(O,a)&&(v=O);var E=h.prototype=g.prototype=Object.create(v);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function r(o,i,a,c){var l=f(e[o],e,i);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==Ae(s)&&n.call(s,"__await")?t.resolve(s.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):t.resolve(s).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,c)}))}c(l.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function S(t,r,n){var o=d;return function(i,a){if(o===p)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var l=P(c,n);if(l){if(l===b)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:"suspendedYield",u.arg===b)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function P(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,P(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function A(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Ae(t)+" is not iterable")}return m.prototype=h,o(E,"constructor",{value:h,configurable:!0}),o(h,"constructor",{value:m,configurable:!0}),m.displayName=u(h,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,u(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},x(j.prototype),u(j.prototype,c,(function(){return this})),t.AsyncIterator=j,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new j(s(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(E),u(E,l,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=A,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return c.type="throw",c.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),L(r),b}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:A(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),b}},t}function Ie(e,t,r,n,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,o)}var Ne=function(){console.log("ExportImage >> ");var e=function(){var e,t=(e=Ze().mark((function e(){var t,r;return Ze().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=document.querySelector(".react-flow__viewport"))){e.next=6;break}return e.next=4,(0,Ce.KT)(t,{});case 4:r=e.sent,l.Utils.downloadImage(r,"model.svg");case 6:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Ie(i,n,o,a,c,"next",e)}function c(e){Ie(i,n,o,a,c,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}();return n.createElement(de.Z,{title:"Save graph model to svg image",placement:"right"},n.createElement(pe.ZP,{type:"text",icon:n.createElement(Le.Z,null),onClick:e}))},De=(0,n.memo)(Ne),Me=function(e){var t=Ot().controlElements;return n.createElement(n.Fragment,null,n.createElement(l.Toolbar,null,n.createElement(ke,null),n.createElement(we,null),n.createElement(De,null),t))},Te=n.memo(Me),_e=r(42655),Re=r(44575),He=r(64681),Ue=r(4507),Fe=r(2881);function Ye(e){return Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ye(e)}function Ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,c=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Xe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ze(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ve(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(r),!0).forEach((function(t){We(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ze(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function We(e,t,r){var n;return n=function(e,t){if("object"!=Ye(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ye(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==Ye(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $e(e){return e%2==0}function Be(e){return!$e(e)}var qe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{poly:30,loop:10,loopLabelPosition:1},r=t.poly,n=void 0===r?30:r,o=t.loop,i=void 0===o?10:o,a=(t.loopLabelPosition,{});e.forEach((function(e,t){var r=Ve({},e),n=r.source,o=r.target,i="".concat(n,"-").concat(o),c="".concat(o,"-").concat(n);a[i]?a[i].push(r):a[c]?a[c].push(r):a[i]=[r]}));var c=Object.values(a),l=[];return c.forEach((function(e){if(e.length>1){var t=$e(e.length);e.forEach((function(r,o){var c,u=r.source,s=r.target,f=r.data,d="".concat(s,"-").concat(u),p=u===s,y=!!a[d],b=o;if(t){var g=Math.ceil((b+1)/2);c=n*g}else{var m=Be(b)?b+1:b,h=Math.ceil(m/2);c=n*h}var v=$e(b)?c:-c,w="poly";y&&(v=-v),p&&(w="loop",v=b*i),l.push(Ve(Ve({},r),{},{data:Ve(Ve({},f),{},{_extra:{count:e.length,index:b,type:w,isPoly:!0,isLoop:p,offset:v,isRevert:y}})}))}))}else{var r=Ge(e,1)[0],o=r.source,c=r.target,u=r.data;l.push(Ve(Ve({},r),{},{data:Ve(Ve({},u),{},{_extra:{count:1,index:0,isLoop:o===c}})}))}})),l},Qe=r(6724);var Je=new(r.n(Qe)().graphlib.Graph);Je.setDefaultEdgeLabel((function(){return{}}));function Ke(e,t){return qe(e).map((function(e,r){var n=e.id,o=e.source,i=e.target,a=e.data;return{id:n||"".concat(o,"-").concat(i,"-").concat(r),source:o,target:i,type:"table"===t?"smoothstep":"graph-edge",data:a}}))}var et=r(32699),tt=r.n(et);function rt(e){return function(e){if(Array.isArray(e))return nt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return nt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ot=function(e){return JSON.parse(JSON.stringify(e))},it=l.Utils.fakeSnapshot,at=null,ct=function(){var e=j(),t=e.store,r=e.updateStore,i=(0,o._K)(),a=i.screenToFlowPosition,c=i.fitBounds,l=(i.fitView,t.displayMode),u=t.nodes,s=t.edges,f=t.hasLayouted,d=t.elementOptions,p=(0,n.useRef)(null),y=Ot(),b=y.onNodesChange,g=y.onEdgesChange,m=y.onSelectionChange,h=y.disabled,v=y.noDefaultLabel,w=(0,n.useCallback)((function(e,t){var r=t.nodeId;p.current=r,d.isConnectable}),[]),O=(0,n.useCallback)((function(e){if(p.current&&d.isConnectable)if(e.target.classList.contains("react-flow__pane")){var t=(0,Oe.Z)(),n=(0,Oe.Z)(),o=a({x:e.clientX,y:e.clientY}),i={id:t,position:{x:o.x-50,y:o.y-50},type:"graph-node",data:{label:v?"":me()}};p.current,v||he();r((function(e){e.nodes.push(i),e.edges.push({id:n,source:p.current,target:t,type:"graph-edge",data:{label:v?"":he()}})}))}else{var c=e.target.dataset.nodeid,u=(0,Oe.Z)(),s=he();r((function(e){var t=Ke([].concat(rt(e.edges),[{id:u,data:{label:v?"":s},source:p.current||"",target:c}]),l);e.edges=t}))}}),[a]);(0,o.AQ)({onChange:(0,n.useCallback)((function(e){var t=e.nodes,r=e.edges;m&&m(t,r)}),[m])});return(0,n.useEffect)((function(){if(u.length>0&&!f){var e=function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.iterations,o=void 0===n?1e3:n,i=r.center,a=void 0===i?{x:window.innerWidth/2,y:window.innerHeight/2}:i,c=250,l=c*(0===t.length?.5:8)*-1,u=(0,_e.Z)(e).force("link",(0,Re.Z)(t).id((function(e){return e.id})).distance(c)).force("charge",(0,He.Z)().strength(l)).force("center",(0,Ue.Z)(a.x,a.y)).force("radial",(0,Fe.Z)(0,a.x,a.y).strength(.01)).stop(),s=0;s<o;s++)u.tick();return e.forEach((function(e){delete e.index,delete e.vx,delete e.vy,e.position={x:e.x,y:e.y},delete e.x,delete e.y})),t.forEach((function(e){delete e.index,e.source=e.source.id,e.target=e.target.id})),{nodes:e,edges:t,simulation:u}}(it(u),it(s));clearTimeout(at),at=setTimeout((function(){var t=ye(e.nodes);c(t,{duration:300})}),300),r((function(t){t.hasLayouted=!0,t.nodes=e.nodes,t.edges=e.edges}))}}),[u,s,f]),(0,n.useEffect)((function(){g&&g(s),b&&b(u)}),[s,u]),(0,n.useEffect)((function(){var e=document.getElementById("arrow-marker-svg"),t=document.querySelector(".react-flow__viewport");e&&t&&t.appendChild(e)}),[]),{store:t,updateStore:r,onDoubleClick:function(){var e=ye(u);c(e,{duration:600})},onEdgesChange:function(e){h||d.isConnectable&&r((function(t){var r=(0,o.yn)(e,ot(t.edges));t.edges=r}))},onNodesChange:function(e){if(!h){var t=e[0].type;(d.isConnectable||"position"===t)&&r((function(t){var r=(0,o.Fb)(e,ot(t.nodes));b&&b(r),tt().isEqual(t.nodes,r)||(t.nodes=r)}))}},onConnectStart:w,onConnectEnd:O}};function lt(e){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lt(e)}function ut(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function st(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(r),!0).forEach((function(t){ft(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ut(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ft(e,t,r){var n;return n=function(e,t){if("object"!=lt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=lt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==lt(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var dt=l.Utils.fakeSnapshot,pt=function(e){var t=e.children,r=j(),u=r.store,s=r.updateStore,f=ct(),d=f.onEdgesChange,p=f.onNodesChange,y=f.onConnectStart,b=f.onConnectEnd,g=u.nodes,m=u.edges,h=u.theme,v=(0,l.useStudioProvier)().isLight,w=0===g.length,O=Ot(),E=O.isMiniMap,x=void 0===E||E,S=O.defaultEdges,P=void 0===S?[]:S,k=O.defaultNodes,L=void 0===k?[]:k,C=O.isControlButton,A=void 0===C||C,Z=O.isPreview,I=void 0!==Z&&Z,N=O.disabled,D=void 0!==N&&N,M=(O.graphId,n.createElement(ve.Z,{id:"Start sketching a model, a vertex label is a named grouping or categorization of nodes within the graph dataset",values:{icon:n.createElement(fe.Z,null)}}));return(0,n.useEffect)((function(){s((function(e){e.nodes=L,e.edges=P}))}),[]),n.createElement("div",{style:st({height:"100%",width:"100%"},e.style),className:e.className},n.createElement("div",{style:{height:"100%",width:"100%",position:I?"relative":"absolute"}},n.createElement(o.x$,{nodesDraggable:!D,nodes:g.length?dt(g):[],edges:m.length?dt(m):[],onNodesChange:p,onEdgesChange:d,nodeTypes:T,edgeTypes:le,connectionLineComponent:ue,onConnectStart:y,onConnectEnd:b,zoomOnDoubleClick:!1},n.createElement(se,{selectedColor:h.primaryColor,color:v?"#000":"#d7d7d7"}),A&&n.createElement(n.Fragment,null,n.createElement(i.Z,{style:{gap:"4px",boxShadow:"0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 9px 28px 8px rgba(0, 0, 0, 0.05)"}}),n.createElement(Te,null)),n.createElement(a.A,{style:{background:"#fff"}}),w&&n.createElement(l.EmptyCanvas,{description:M}),x&&n.createElement(c.a,{style:{backgroundColor:v?"":"#161616"}}),t&&t)))},yt=r(98262),bt={"en-US":{"Start sketching a model, a vertex label is a named grouping or categorization of nodes within the graph dataset":"Start sketching a model, a vertex label is a named grouping or categorization of nodes within the graph dataset","Create new vertex":"Create new vertex"},"zh-CN":{"Start sketching a model, a vertex label is a named grouping or categorization of nodes within the graph dataset":"开始绘制模型吧，顶点标签是图数据集中节点的命名分组或分类","Create new vertex":"创建节点"}};function gt(e){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gt(e)}function mt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ht(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(r),!0).forEach((function(t){vt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function vt(e,t,r){var n;return n=function(e,t){if("object"!=gt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=gt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==gt(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var wt=n.createContext({}),Ot=function(){var e=n.useContext(wt);if(void 0===e)throw new Error("useGraphContext must be used within a GraphProvider");return e},Et=n.forwardRef((function(e,t){var r=e.locale,i=void 0===r?"en-US":r,a=bt[i],c=j().updateStore;return n.useImperativeHandle(t,(function(){return{clearCanvas:function(){c((function(e){e.nodes=[],e.edges=[]}))}}})),n.createElement(yt.Z,{messages:a,locale:i},n.createElement(wt.Provider,{value:ht({},e)},n.createElement(o.tV,null,n.createElement(pt,{className:e.className},e.children))))})),xt=r(17446),jt=r(23316);function St(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Pt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Pt(e,t,r[t])}))}return e}function Lt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Ct(e){return function(e){if(Array.isArray(e))return St(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return St(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return St(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var At=new jt.x,Zt=function(e,t){return At.next(Lt(kt({},e),{nodes:t})),{nodes:t}},It=(0,xt.Ue)()((function(e){return{nodes:[],addNode:function(t){return e((function(e){return e.nodes.some((function(e){return e.id===t.id}))?e:Zt(e,Ct(e.nodes).concat([t]))}))},deleteNode:function(t){return e((function(e){return e.nodes.some((function(e){return e.id===t}))?Zt(e,e.nodes.filter((function(e){return e.id!==t}))):e}))},clearNode:function(){return e((function(){return At.next({nodes:[]}),{nodes:[]}}))},replaceNodes:function(t){return e((function(){return At.next({nodes:t}),{nodes:t}}))},addVariableForNode:function(t,r){return e((function(e){var n=e.nodes.find((function(e){return e.id===t}));if(null==n?void 0:n.variable)return e;var o=e.nodes.map((function(e){return e.id===t?Lt(kt({},e),{variable:r}):e}));return Zt(e,o)}))},editNode:function(t){return e((function(e){var r=e.nodes.findIndex((function(e){return e.id===t.id}));if(-1===r||tt().isEqual(e.nodes[r],t))return e;var n=Ct(e.nodes);return n[r]=kt({},n[r],t),Zt(e,n)}))}}}));At.asObservable();function Nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Dt(e,t,r[t])}))}return e}function Tt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function _t(e){return function(e){if(Array.isArray(e))return Nt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Nt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Nt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Rt=new jt.x,Ht=function(e,t){return Rt.next(Tt(Mt({},e),{edges:t})),{edges:t}},Ut=(0,xt.Ue)((function(e,t){return{edges:[],addVariableForEdge:function(t,r){return e((function(e){var n=e.edges.find((function(e){return e.id===t}));if(null==n?void 0:n.variable)return e;var o=e.edges.map((function(e){return e.id===t?Tt(Mt({},e),{variable:r}):e}));return Ht(e,o)}))},addEdge:function(t){e((function(e){return e.edges.some((function(e){return e.id===t.id}))?e:Ht(e,_t(e.edges).concat([t]))}))},deleteEdge:function(t){e((function(e){return e.edges.some((function(e){return e.id===t}))?Ht(e,e.edges.filter((function(e){return e.id!==t}))):e}))},clearEdge:function(){e((function(){return Rt.next({edges:[]}),{edges:[]}}))},replaceEdges:function(t){e((function(){return Rt.next({edges:t}),{edges:t}}))},editEdge:function(t){e((function(e){var r=e.edges.findIndex((function(e){return e.id===t.id}));if(-1===r||tt().isEqual(e.edges[r],t))return e;var n=_t(e.edges);return n[r]=Mt({},n[r],t),Ht(e,n)}))}}}));Rt.asObservable();function Ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Yt(e){return function(e){if(Array.isArray(e))return Ft(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ft(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ft(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Gt=(0,xt.Ue)()((function(e){return{graphNodes:[],graphEdges:[],updateGraphNode:function(t){return e((function(e){console.log("updateGraphNode",t);var r=e.graphNodes.find((function(e){return e.id===t.id}));return tt().isEqual(r,t)?e:{graphNodes:Yt(e.graphNodes).concat([t]),graphEdges:e.graphEdges}}))},updateGraphEdge:function(t){return e((function(e){console.log("updateGraphEdge",t);var r=e.graphEdges.find((function(e){return e.id===t.id}));return tt().isEqual(r,t)?e:{graphNodes:e.graphNodes,graphEdges:Yt(e.graphEdges).concat([t])}}))},clearGraphStore:function(){return e({graphNodes:[],graphEdges:[]})}}})),Xt=function(){var e=It((function(e){return e.addNode})),t=Ut((function(e){return e.addEdge})),r=Gt((function(e){return e.updateGraphNode})),o=Gt((function(e){return e.updateGraphEdge})),i=(0,n.useCallback)((function(e){return{id:e.id,label:e.data.label}}),[]),a=(0,n.useCallback)((function(e){return{id:e.id,label:e.data.label,sourceNode:e.source,targetNode:e.target}}),[]),c=(0,n.useCallback)((function(t){t.map((function(t){t&&e&&e(i(t)),r(t)}))}),[]),l=(0,n.useCallback)((function(e,r){e.map((function(e){var n=u(e,r);n&&e&&t&&t(a(e)),n&&o(e)}))}),[]),u=(0,n.useCallback)((function(e,t){var r=t.some((function(t){return t.id===e.source})),n=t.some((function(t){return t.id===e.target}));return r&&n}),[]);return{transformNode:i,transformEdge:a,transformNodes:c,transformEdges:l}};function zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wt(e){return function(e){if(Array.isArray(e))return zt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return zt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zt(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var $t=(0,xt.Ue)()((function(e){return{properties:[],updateProperties:function(t){return e((function(e){return{properties:Wt(new Map(Wt(e.properties).concat(Wt(t)).map((function(e){return[e.belongId,e]}))).values())}}))},clearProperties:function(){return e({properties:[]})},editProperties:function(t){return e((function(e){return e.properties.find((function(e){return e.belongId===t.belongId}))?{properties:e.properties.map((function(e){return e.belongId===t.belongId?function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Vt(e,t,r[t])}))}return e}({},e,t):e}))}:{properties:Wt(e.properties).concat([t])}}))}}}));function Bt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qt(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Qt(e,t){return-1!==t.indexOf(e)}var Jt=function(e){var t=[];return e.forEach((function(e,r){var n,o=null!==(n=e.position)&&void 0!==n?n:{x:200*Math.random(),y:200*Math.random()},i=o.x,a=o.y,c=200;for(console.log(e.id);t.some((function(t){return t.id!==e.id&&Math.abs(t.position.x-i)<c&&Math.abs(t.position.y-a)<c}));)console.log("collision"),i+=c,t.some((function(t){return t.id!==e.id&&Math.abs(t.position.x-i)<c&&Math.abs(t.position.y-a)<c}))&&(a+=c,i-=c);t.push(qt(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Bt(e,t,r[t])}))}return e}({},e),{position:{x:i,y:a},width:100,height:100}))})),t},Kt=function(){var e=Xt(),t=e.transformNodes,r=e.transformEdges,o=Gt((function(e){return e.clearGraphStore})),i=It((function(e){return e.clearNode})),a=Ut((function(e){return e.clearEdge})),c=$t((function(e){return e.clearProperties})),l=(0,n.useCallback)((function(e,n){e.length>0&&n.length>0&&(c(),o(),a&&a(),i&&i(),t(e),r(n,e))}),[]),u=(0,n.useContext)(zr).previewGraph,s=(0,n.useMemo)((function(){return Jt((null==u?void 0:u.nodes)||[])}),[u]);return console.log("更新后的节点",JSON.parse(JSON.stringify(s))),n.createElement("div",{style:{borderRadius:"8px",border:"1px solid #E3E3E3",height:"50%",padding:"0.8rem",backgroundColor:"#F9F9F9",display:"flex",flexDirection:"column",gap:"0.6rem",flexBasis:"50%",marginTop:"1rem",overflow:"hidden"}},n.createElement("span",{style:{fontSize:"1rem"}},"Model Preview"),n.createElement("div",{style:{backgroundColor:"white",height:"100%",flexGrow:"1"}},n.createElement(Et,{isControlButton:!1,isMiniMap:!1,disabled:!0,isPreview:!0,defaultEdges:null==u?void 0:u.edges,defaultNodes:s,graphId:"preview-graph",onSelectionChange:l})))},er=r(59739),tr=function(e){var t=e.title,r=e.svgSrc,o=e.id,i=Xt(),a=i.transformNodes,c=i.transformEdges,l={generateSelfLoop:(0,n.useCallback)((function(){var e=(0,er.Z)();return{nodes:[{id:e,position:{x:400,y:400},type:"graph-node",data:{label:""},width:100,height:100}],edges:[{id:(0,er.Z)(),source:e,target:e,type:"graph-edge",data:{label:"",_extra:{count:1,index:0,isLoop:!0}}}]}}),[]),generateTriangleLoop:(0,n.useCallback)((function(){var e=(0,er.Z)(),t=(0,er.Z)(),r=(0,er.Z)();return{nodes:[{id:e,position:{x:400,y:200},type:"graph-node",data:{label:""},width:100,height:100,selected:!1,positionAbsolute:{x:702,y:572},dragging:!1},{id:t,position:{x:200,y:400},type:"graph-node",data:{label:""},width:100,height:100,selected:!0,positionAbsolute:{x:877.25,y:324.75},dragging:!1},{id:r,position:{x:500,y:480},type:"graph-node",data:{label:""},width:100,height:100}],edges:[{id:(0,er.Z)(),source:e,target:t,type:"graph-edge",data:{label:"",_extra:{count:1,index:0,isLoop:!1}},selected:!1},{id:(0,er.Z)(),source:t,target:r,type:"graph-edge",data:{label:"",_extra:{count:1,index:0,isLoop:!1}}},{id:(0,er.Z)(),source:r,target:e,type:"graph-edge",data:{label:"",_extra:{count:1,index:0,isLoop:!1}}}]}}),[]),generatePaperChallenge:(0,n.useCallback)((function(){var e=(0,er.Z)(),t=(0,er.Z)();return{edges:[{id:(0,er.Z)(),source:e,target:t,type:"graph-edge",data:{label:"",_extra:{count:1,index:0,isLoop:!1}},selected:!1}],nodes:[{id:e,position:{x:238.5,y:283.5},type:"graph-node",data:{label:"Paper"},width:100,height:100,selected:!1,positionAbsolute:{x:238.5,y:283.5},dragging:!1},{id:t,position:{x:593,y:176},type:"graph-node",data:{label:"Challenge"},width:100,height:100,selected:!1,positionAbsolute:{x:593,y:176},dragging:!1}]}}),[]),generatePaperChallengeSolution:(0,n.useCallback)((function(){var e=(0,er.Z)(),t=(0,er.Z)(),r=(0,er.Z)();return{edges:[{id:(0,er.Z)(),source:e,target:t,type:"graph-edge",data:{label:"",_extra:{count:1,index:0,isLoop:!1}},selected:!1},{id:(0,er.Z)(),source:t,target:r,type:"graph-edge",data:{label:"",_extra:{count:1,index:0,isLoop:!1}},selected:!0}],nodes:[{id:t,position:{x:383.5,y:327.5},type:"graph-node",data:{label:"Challenge"},width:100,height:100,selected:!1,positionAbsolute:{x:383.5,y:327.5},dragging:!1},{id:e,position:{x:200,y:100},type:"graph-node",data:{label:"Paper"},width:100,height:100,selected:!1,dragging:!1},{id:r,position:{x:628.4000000000003,y:119},type:"graph-node",data:{label:"Solution"},width:100,height:100,selected:!1,positionAbsolute:{x:628.4000000000003,y:119},dragging:!1}]}}),[]),generatePaperCite:(0,n.useCallback)((function(){var e=(0,er.Z)(),t=(0,er.Z)(),r=(0,er.Z)();return{edges:[{id:(0,er.Z)(),source:e,target:t,type:"graph-edge",data:{label:"Cite",_extra:{count:1,index:0,isLoop:!1}},selected:!1},{id:(0,er.Z)(),source:t,target:r,type:"graph-edge",data:{label:"Cite",_extra:{count:1,index:0,isLoop:!1}},selected:!0}],nodes:[{id:t,position:{x:383.5,y:327.5},type:"graph-node",data:{label:"Paper"},width:100,height:100,selected:!1,positionAbsolute:{x:383.5,y:327.5},dragging:!1},{id:e,position:{x:200,y:100},type:"graph-node",data:{label:"Paper"},width:100,height:100,selected:!1,dragging:!1},{id:r,position:{x:628.4000000000003,y:119},type:"graph-node",data:{label:"Paper"},width:100,height:100,selected:!1,positionAbsolute:{x:628.4000000000003,y:119},dragging:!1}]}}),[]),generateComplexPaperCite:(0,n.useCallback)((function(){var e=(0,er.Z)(),t=(0,er.Z)(),r=(0,er.Z)(),n=(0,er.Z)(),o=(0,er.Z)();return{edges:[{id:(0,er.Z)(),source:e,target:t,type:"graph-edge",data:{label:"Cite",_extra:{count:1,index:0,isLoop:!1}},selected:!1},{id:(0,er.Z)(),source:t,target:r,type:"graph-edge",data:{label:"Cite",_extra:{count:1,index:0,isLoop:!1}},selected:!1},{id:(0,er.Z)(),source:e,target:n,type:"graph-edge",data:{label:"",_extra:{count:1,index:0,isLoop:!1}},selected:!1},{id:(0,er.Z)(),source:t,target:n,type:"graph-edge",data:{label:"",_extra:{count:1,index:0,isLoop:!1}},selected:!1},{id:(0,er.Z)(),source:t,target:o,type:"graph-edge",data:{label:"",_extra:{count:1,index:0,isLoop:!1}},selected:!1},{id:(0,er.Z)(),source:r,target:o,type:"graph-edge",data:{label:"",_extra:{count:1,index:0,isLoop:!1}},selected:!1}],nodes:[{id:e,position:{x:294.444360104079,y:218.78591352988423},type:"graph-node",data:{label:"Paper"},width:100,height:100,selected:!1,positionAbsolute:{x:294.444360104079,y:218.78591352988423},dragging:!1},{id:t,position:{x:532.9830537728634,y:214.96446600176026},type:"graph-node",data:{label:"Paper"},width:100,height:100,selected:!1,positionAbsolute:{x:532.9830537728634,y:214.96446600176026},dragging:!1},{id:r,position:{x:775.9922071088333,y:210.94593515264864},type:"graph-node",data:{label:"Paper"},width:100,height:100,selected:!1,positionAbsolute:{x:775.9922071088333,y:210.94593515264864},dragging:!1},{id:n,position:{x:422.3616593234866,y:443.3323212489479},type:"graph-node",data:{label:"Challenge"},width:100,height:100,selected:!1,positionAbsolute:{x:422.3616593234866,y:443.3323212489479},dragging:!1},{id:o,position:{x:657.340588627554,y:428.36785524718766},type:"graph-node",data:{label:"Challenge"},width:100,height:100,selected:!1,positionAbsolute:{x:657.340588627554,y:428.36785524718766},dragging:!1}]}}),[])},u=l.generateSelfLoop,s=l.generateTriangleLoop,f=l.generatePaperChallenge,d=l.generatePaperChallengeSolution,p=l.generatePaperCite,y=l.generateComplexPaperCite,b=Gt((function(e){return e.clearGraphStore})),g=It((function(e){return e.clearNode})),m=Ut((function(e){return e.clearEdge})),h=$t((function(e){return e.clearProperties})),v=function(){g&&g(),m&&m(),b(),h();var e={"triangle-loop":s,"self-loop":u,"paper-challenge":f,"paper-challenge-solution":d,"paper-cite":p,"complex-paper-cite":y}[o];if(e){var t=e();a(t.nodes),c(t.edges,t.nodes)}};return n.createElement("div",{style:{border:"1px solid #E3E3E3",borderRadius:"5px",padding:"0.8rem",cursor:"pointer"},onClick:v},t,n.createElement("div",{style:{height:"8rem",backgroundColor:"#F0F0F0",marginTop:"0.8rem",borderRadius:"2px",display:"flex",alignItems:"center",justifyContent:"center"},onClick:v},r))},rr=r(20509);function nr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var or=[{svgSrc:n.createElement("svg",{width:"71",height:"93",viewBox:"0 0 71 93",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("circle",{cx:"35.6904",cy:"62.3413",r:"29",stroke:"black","stroke-width":"2"}),n.createElement("path",{d:"M60.6916 44.8395L70.8028 39.2631L60.9179 33.2947L60.6916 44.8395ZM66.2853 37.4731C67.7414 33.4636 67.4987 29.8569 65.9372 26.7474C64.3913 23.6689 61.6037 21.1766 58.1396 19.249C51.2221 15.3998 41.3293 13.6435 32.0076 14.068C22.7197 14.4908 13.7017 17.0945 8.71468 22.2775C6.18883 24.9026 4.704 28.1872 4.77323 32.1151C4.84194 36.0139 6.43922 40.4447 9.86754 45.4097L11.5133 44.2733C8.22325 39.5085 6.83244 35.4572 6.77292 32.0798C6.7139 28.7314 7.96069 25.9456 10.1559 23.6642C14.6109 19.0342 22.9927 16.4805 32.0986 16.0659C41.1708 15.6528 50.6659 17.3791 57.1671 20.9967C60.4123 22.8025 62.8416 25.0397 64.1499 27.6449C65.4425 30.219 65.6912 33.25 64.4055 36.7905L66.2853 37.4731Z",fill:"black"})),title:"自环 Self-Loop",id:"self-loop"},{svgSrc:n.createElement("svg",{width:"152",height:"118",viewBox:"0 0 152 118",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("circle",{cx:"20",cy:"98",r:"19",stroke:"black","stroke-width":"2"}),n.createElement("circle",{cx:"76",cy:"20",r:"19",stroke:"black","stroke-width":"2"}),n.createElement("circle",{cx:"132",cy:"98",r:"19",stroke:"black","stroke-width":"2"}),n.createElement("path",{d:"M56 34L46 39.7735L56 45.547L56 34ZM31.866 77.8013L52.366 42.2942L50.634 41.2942L30.134 76.8013L31.866 77.8013Z",fill:"black"}),n.createElement("path",{d:"M120.91 79.1451L120.91 67.5981L110.91 73.3716L120.91 79.1451ZM95.134 36.5L115.544 71.8509L117.276 70.8509L96.866 35.5L95.134 36.5Z",fill:"black"}),n.createElement("path",{d:"M42.9853 98L52.9853 103.774V92.2265L42.9853 98ZM109.016 97H51.9853V99H109.016V97Z",fill:"black"})),title:"三角环 Triangle-Loop",id:"triangle-loop"},{svgSrc:n.createElement("svg",{width:"150",height:"222",viewBox:"0 0 407 222",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("circle",{cx:"60",cy:"60",r:"57",stroke:"black","stroke-width":"6"}),n.createElement("circle",{cx:"347",cy:"162",r:"57",stroke:"black","stroke-width":"6"}),n.createElement("path",{d:"M120 83L141.724 109.982L154.23 77.6773L120 83ZM276.083 140.202L146.262 89.9491L144.096 95.5445L273.917 145.798L276.083 140.202Z",fill:"black"})),title:"Paper 的挑战",id:"paper-challenge"},{svgSrc:n.createElement("svg",{width:"130",height:"280",viewBox:"0 0 550 400",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("circle",{cx:"60",cy:"238",r:"57",stroke:"black","stroke-width":"6"}),n.createElement("circle",{cx:"347",cy:"340",r:"57",stroke:"black","stroke-width":"6"}),n.createElement("path",{d:"M275 321L253.276 294.018L240.77 326.323L275 321ZM250.904 308.455L121.083 258.202L118.917 263.798L248.738 314.051L250.904 308.455Z",fill:"black"}),n.createElement("circle",{cx:"490.5",cy:"59.5",r:"56.5",stroke:"black","stroke-width":"6"}),n.createElement("path",{d:"M457 124L429.135 144.58L460.89 158.422L457 124ZM391.75 281.199L448.961 149.95L443.461 147.552L386.25 278.801L391.75 281.199Z",fill:"black"})),title:"Paper 的 Solution",id:"paper-challenge-solution"},{svgSrc:n.createElement("svg",{width:"180",height:"200",viewBox:"0 0 737 362",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("circle",{cx:"60",cy:"60",r:"57",stroke:"black","stroke-width":"6"}),n.createElement("circle",{cx:"347",cy:"162",r:"57",stroke:"black","stroke-width":"6"}),n.createElement("path",{d:"M275 143L253.276 116.018L240.77 148.323L275 143ZM250.904 130.455L121.083 80.2023L118.917 85.7977L248.738 136.051L250.904 130.455Z",fill:"black"}),n.createElement("circle",{cx:"677.5",cy:"302.5",r:"56.5",stroke:"black","stroke-width":"6"}),n.createElement("path",{d:"M611 278L590.249 250.262L576.603 282.102L611 278ZM413.818 196.757L585.001 270.122L587.365 264.607L416.182 191.243L413.818 196.757Z",fill:"black"})),title:"Paper 的连环引用",id:"paper-cite"},{svgSrc:n.createElement("svg",{width:"200",height:"280",viewBox:"0 0 837 423",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("circle",{cx:"60",cy:"60",r:"57",stroke:"black","stroke-width":"6"}),n.createElement("circle",{cx:"600",cy:"363",r:"57",stroke:"black","stroke-width":"6"}),n.createElement("circle",{cx:"234",cy:"363",r:"57",stroke:"black","stroke-width":"6"}),n.createElement("circle",{cx:"408",cy:"60",r:"57",stroke:"black","stroke-width":"6"}),n.createElement("path",{d:"M331 60L301 42.6795V77.3205L331 60ZM304 57L137 57V63L304 63V57Z",fill:"black"}),n.createElement("circle",{cx:"777.5",cy:"60.5",r:"56.5",stroke:"black","stroke-width":"6"}),n.createElement("path",{d:"M704 60L674 42.6795V77.3205L704 60ZM482 63L677 63V57L482 57V63Z",fill:"black"}),n.createElement("path",{d:"M213 297L211.456 262.393L182.258 281.034L213 297ZM97.4714 121.614L195.942 275.857L201 272.628L102.529 118.386L97.4714 121.614Z",fill:"black"}),n.createElement("path",{d:"M253 297L284.112 281.767L255.364 262.44L253 297ZM369.51 118.326L265.575 272.919L270.554 276.267L374.49 121.674L369.51 118.326Z",fill:"black"}),n.createElement("path",{d:"M593 297L587.272 262.836L560.549 284.879L593 297ZM444.686 121.909L573.505 278.08L578.134 274.263L449.314 118.091L444.686 121.909Z",fill:"black"}),n.createElement("path",{d:"M612 297L643.229 282.009L614.632 262.459L612 297ZM730.523 118.307L624.761 273.017L629.714 276.404L735.477 121.693L730.523 118.307Z",fill:"black"})),title:"复杂的 Paper Cite",id:"complex-paper-cite"}],ir=function(){return n.createElement("div",{id:"quick-start-wrapper",style:{height:"100%",display:"flex",flexDirection:"column",gap:"0.8rem"}},n.createElement(Kt,null),n.createElement("div",{id:"items-wrapper",style:{display:"flex",flexDirection:"column",height:"50%",gap:"0.3rem"}},n.createElement("span",{style:{fontSize:"1rem"}},n.createElement(rr.Z,null),"快速开始"),n.createElement("div",{style:{overflowY:"scroll",display:"flex",flexDirection:"column",gap:"0.6rem",scrollbarWidth:"none",msOverflowStyle:"none"}},or.map((function(e){return n.createElement(tr,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){nr(e,t,r[t])}))}return e}({key:e.id},e))})))))};function ar(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){cr(e,t,r[t])}))}return e}function ur(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function sr(e){return function(e){if(Array.isArray(e))return ar(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ar(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ar(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var fr=r(16889),dr=r(7234),pr=r(40434),yr=r(40678),br=r(95078),gr=r(35215),mr=r(86132),hr=r(41610);function vr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function wr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Or(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Er(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],a=!0,c=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==r.return||r.return()}finally{if(c)throw o}}return i}}(e,t)||jr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xr(e){return function(e){if(Array.isArray(e))return vr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||jr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jr(e,t){if(e){if("string"==typeof e)return vr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?vr(e,t):void 0}}var Sr=function(e){var t,r,o=e.currentId,i=e.onChange,a=$t((function(e){return e.properties})),c=Er((0,n.useState)(null!==(r=null===(t=a.find((function(e){return e.belongId===o})))||void 0===t?void 0:t.data)&&void 0!==r?r:[]),2),l=c[0],u=c[1];(0,n.useEffect)((function(){console.log("id change",o)}),[o]),(0,n.useEffect)((function(){i&&i({currentId:null!=o?o:"",properties:l})}),[l,o]);var s=function(e,t,r){var n=l.map((function(n){return n.id===e?Or(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){wr(e,t,r[t])}))}return e}({},n),wr({},t,r)):n}));u(n)},f=[{title:"Name",dataIndex:"name",render:function(e,t){return n.createElement(fr.Z,{placeholder:"Name",value:t.name,onChange:function(e){return s(t.id,"name",e.target.value)},style:{width:"100%"}})},width:"35%"},{title:"Compare",dataIndex:"compare",render:function(e,t){return n.createElement(dr.default,{defaultValue:t.compare,onChange:function(e){return s(t.id,"compare",e)},style:{width:"100%"},options:[{value:">",label:">"},{value:"=",label:"="},{value:"<",label:"<"},{value:">=",label:">="},{value:"<=",label:"<="}],className:"nospan nodrag",getPopupContainer:function(){return document.getElementById(o)}})},width:"20%"},{title:"Value",dataIndex:"value",render:function(e,t){return n.createElement(fr.Z,{placeholder:"Value",value:t.value,onChange:function(e){return s(t.id,"value",e.target.value)},style:{width:"100%"}})},width:"35%"},{title:"Actions",dataIndex:"actions",render:function(e,t){return n.createElement(pe.ZP,{type:"text",icon:n.createElement(mr.Z,null),onClick:function(){return e=t.id,r=l.filter((function(t){return t.id!==e})),void u(r);var e,r}})},width:"10%"}];return n.createElement(pr.Z,{layout:"vertical"},n.createElement(yr.Z,{justify:"space-between",align:"middle",style:{marginBottom:16}},n.createElement(br.Z,null,n.createElement("h3",null,"Properties")),n.createElement(br.Z,null,n.createElement(pe.ZP,{type:"primary",icon:n.createElement(hr.Z,null),onClick:function(){u(xr(l).concat([{id:Date.now().toString(),name:"",compare:"",value:""}]))}},"Add"))),n.createElement(gr.Z,{columns:f,dataSource:l,pagination:!1,rowKey:"id",bordered:!0}))};function Pr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){kr(e,t,r[t])}))}return e}function Cr(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function Ar(e){return function(e){if(Array.isArray(e))return Pr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Pr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pr(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ir(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Zr(e,t,r[t])}))}return e}function Nr(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}var Dr=function(){var e=It((function(e){return e.nodes})),t=It((function(e){return e.editNode})),r=Ut((function(e){return e.edges})),o=Ut((function(e){return e.editEdge})),i=$t((function(e){return e.properties})),a=$t((function(e){return e.editProperties})),c=It((function(e){return e.addVariableForNode})),l=Ut((function(e){return e.addVariableForEdge})),u=(0,n.useCallback)((function(){!function(e,t){0!==t.length&&t.forEach((function(t){var r=t.data.map((function(e){if(!e.name||!e.compare||!e.value)return e;var t=isNaN(Number(e.value))?"'".concat(e.value,"'"):e.value;return Cr(Lr({},e),{statement:"".concat(e.name," ").concat(e.compare," ").concat(t)})}));e(t,t.data,r)}))}((function(e,t,r){!tt().isEqual(t,r)&&a(Nr(Ir({},e),{data:r}))}),i)}),[e,i]),s=(0,n.useCallback)((function(){var r=0;!function(e,t){e&&e.filter((function(e){return void 0!==e})).forEach((function(e){var r=e.label&&":".concat(e.label),n=Cr(Lr({},e),{statement:null!=r?r:""});t(e,n)}))}(e,(function(e,n){var o=tt().isEqual(e.statement,n.statement),i="n".concat(r);c&&c(n.id,i),!o&&t&&t(Ir({},n)),r++}))}),[e]),f=(0,n.useCallback)((function(){var e=0;!function(e,t){e&&e.filter((function(e){return void 0!==e})).forEach((function(e){var r=e.label&&":".concat(e.label),n=Cr(Lr({},e),{statement:null!=r?r:""});t(e,n)}))}(r,(function(t,r){var n=tt().isEqual(t.statement,r.statement),i="e".concat(e);l&&l(r.id,i),!n&&o&&o(Ir({},r)),e++}))}),[r]),d=(0,n.useCallback)((function(){return function(e,t){var r=function(){var t=n.find((function(e){return!e.isErgodic}));if(!t)return"break";var r=t,i=t,a=e.find((function(e){return e.id===(null==t?void 0:t.targetNode)})),c=e.find((function(e){return e.id===(null==t?void 0:t.sourceNode)}));t&&(t.isErgodic=!0);var l="[".concat(t.variable).concat(null==t?void 0:t.statement,"]");if(a)for(;;){var u=a.variable?"(".concat(a.variable).concat(a.statement,")"):"(".concat(a.statement,")");if(l="".concat(l,"->").concat(u),r.isErgodic=!0,!a.outRelations)break;var s=n.filter((function(e){return Qt(e.id,Ar(a.outRelations))}));if(!(r=s.find((function(e){return!e.isErgodic}))))break;if(l="".concat(l,"-[").concat(r.variable).concat(null==r?void 0:r.statement,"]"),!(a=e.find((function(e){return e.id===(null==r?void 0:r.targetNode)}))))throw new Error("targetNode is not exist")}if(c)for(;;){var f=c.variable?"(".concat(c.variable).concat(c.statement,")"):"(".concat(c.statement,")");if(l="".concat(f,"-").concat(l),i.isErgodic=!0,!c.inRelations)break;var d=n.filter((function(e){return Qt(e.id,Ar(c.inRelations))}));if(!(i=d.find((function(e){return!e.isErgodic}))))break;if(l="[".concat(i.variable).concat(null==i?void 0:i.statement,"]->").concat(l),!(c=e.find((function(e){return e.id===(null==i?void 0:i.sourceNode)}))))throw new Error("sourceNode is not exist")}l="MATCH ".concat(l),o.push(l)},n=tt().cloneDeep(t);if(0===t.length)return e.map((function(e){return"MATCH: (".concat(e.variable).concat(e.statement,")")}));for(var o=[];"break"!==r(););return o}(e,r)}),[e,r]),p=(0,n.useCallback)((function(){return function(e,t){var r=[];return 0===e.length?"":(t.forEach((function(t){var n,o=e.find((function(e){return e.id===t.belongId}));if(o){var i=null===(n=t.data)||void 0===n?void 0:n.filter((function(e){return e.statement})).map((function(e){return"".concat(o.variable,".").concat(e.statement)}));i&&i.length>0&&r.push("WHERE ".concat(i.join(" AND ")))}})),r.join("\n"))}(e,i)}),[e,i]);return{encodeProperties:u,encodeNodes:s,encodeEdges:f,generateMATCH:d,generateWHERE:p}},Mr=r(12142),Tr=r(12423);function _r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Rr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Rr(e,t,r[t])}))}return e}function Ur(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],a=!0,c=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==r.return||r.return()}finally{if(c)throw o}}return i}}(e,t)||Yr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fr(e){return function(e){if(Array.isArray(e))return _r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Yr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yr(e,t){if(e){if("string"==typeof e)return _r(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_r(e,t):void 0}}var Gr=function(){var e,t,r=Ur((0,n.useState)(),2),o=r[0],i=(r[1],It((function(e){return e.nodes}))),a=Ut((function(e){return e.edges})),c=It((function(e){return e.replaceNodes})),u=Ut((function(e){return e.replaceEdges})),s=Xt(),f=s.transformNode,d=s.transformEdge,p=Gt((function(e){return e.graphNodes})),y=Gt((function(e){return e.graphEdges})),b=Dr(),g=b.encodeProperties,m=b.encodeNodes,h=b.encodeEdges,v=b.generateMATCH,w=b.generateWHERE,O=$t((function(e){return e.updateProperties})),E=$t((function(e){return e.properties})),x=Ur((0,n.useState)(""),2),j=x[0],S=x[1],P=Ur((0,n.useState)(""),2),k=P[0],L=P[1],C=(e=It((function(e){return e.editNode})),t=It((function(e){return e.nodes})),{generateRelation:(0,n.useCallback)((function(r){var n=sr(t);r.forEach((function(e){var t=n.findIndex((function(t){return t.id===e.sourceNode})),r=n.findIndex((function(t){return t.id===e.targetNode}));if(-1!==t&&-1!==r){var o=n[t],i=n[r];o===i?n[t]=ur(lr({},o),{outRelations:new Set(sr(o.outRelations||[]).concat([e.id])),inRelations:new Set(sr(o.inRelations||[]).concat([e.id]))}):(o&&(n[t]=ur(lr({},o),{outRelations:new Set(sr(o.outRelations||[]).concat([e.id]))})),i&&(n[r]=ur(lr({},i),{inRelations:new Set(sr(i.inRelations||[]).concat([e.id]))})))}})),n.forEach((function(t){e&&e(t)}))}),[t])}).generateRelation,A=(0,n.useContext)(zr).onClick,Z=Ur((0,n.useState)(""),2),I=Z[0],N=Z[1],D=(0,l.useSection)().toggleLeftSide,M=Ur((0,n.useState)(!1),2),T=M[0],_=M[1],R=Ur((0,n.useState)(!1),2),H=(R[0],R[1]);(0,n.useEffect)((function(){var e=Array.from(i).map((function(e){return"".concat(e.variable)})),t=Array.from(a).map((function(e){return"".concat(e.variable)}));Fr(e).concat(Fr(t)).length>0&&N("RETURN ".concat(Fr(e).concat(Fr(t)).join(", "))),T&&j&&I&&A&&A({MATCHs:j,WHEREs:k,RETURNs:"RETURN ".concat(Fr(e).concat(Fr(t)).join(", ")),description:null!=o?o:""})}),[j,I,T]),(0,n.useEffect)((function(){S(v().join("\n")),L(w())}),[i,a,E]),(0,n.useEffect)((function(){C(a)}),[a]);var U=(0,n.useCallback)((function(e){O(Fr(E).concat([{belongId:e.currentId,belongType:"node",data:e.properties}]))}),[i]),F=(0,n.useCallback)((function(e){var t=e.map((function(e){var t=i.find((function(t){return t.id===e.id}));return t?Hr({},t,f(e)):f(e)}));c&&c(t)}),[i]),Y=(0,n.useCallback)((function(e){var t=e.map((function(e){var t=a.find((function(t){return t.id===e.id}));return t?Hr({},t,d(e)):d(e)}));u&&u(t)}),[a]),G=(0,n.useCallback)((function(){return n.createElement(Et,{graphId:"edit-graph",noDefaultLabel:!0,defaultNodes:p,defaultEdges:y,onNodesChange:F,onEdgesChange:Y,isShowPopover:!0,popoverCustomContent:n.createElement(Sr,{onChange:U})})}),[p,y]);return n.createElement("div",{style:{height:"100%",width:"100%"}},n.createElement(G,null),n.createElement("div",{style:{backgroundColor:"white",position:"absolute",top:"140px",left:"24px",padding:"4px",borderRadius:"4px",boxShadow:"0px 6px 16px 0px rgba(0, 0, 0, 0.08), 0px 3px 6px -4px rgba(0, 0, 0, 0.12), 0px 9px 28px 8px rgba(0, 0, 0, 0.05)"}},n.createElement(de.Z,{title:"展开工具栏",placement:"right"},n.createElement(pe.ZP,{onClick:function(){D()},type:"text",icon:n.createElement(Mr.Z,null)}))),n.createElement(pe.ZP,{onClick:function(){h(),m(),g(),_(!0),H(!0)},type:"primary",style:{position:"absolute",bottom:"20px",right:"240px"},icon:n.createElement(Tr.Z,null)},n.createElement("pre",null,"Cypher"),"查询"))},Xr={previewGraph:void 0,onClick:void 0},zr=(0,n.createContext)(Xr),Vr=function(e){var t=Gt((function(e){return e.clearGraphStore})),r=Ut((function(e){return e.clearEdge})),o=It((function(e){return e.clearNode}));return(0,n.useEffect)((function(){return function(){t(),null==r||r(),null==o||o()}}),[t,r,o]),n.createElement(zr.Provider,{value:e},n.createElement(l.Section,{defaultCollapsed:{leftSide:!0},splitBorder:!0,leftSide:n.createElement("div",{id:"quick-start-wrapper",style:{height:"100%",width:"100%",boxSizing:"border-box"}},n.createElement(ir,null))},n.createElement("div",{id:"canvas-wrapper",style:{height:"100%",width:"100%",backgroundColor:"#E6F4FF"}},n.createElement(Gr,null))))}}}]);