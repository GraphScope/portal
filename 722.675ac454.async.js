(self.webpackChunk=self.webpackChunk||[]).push([[722],{9069:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm-600-80h56c4.4 0 8-3.6 8-8V560c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v144c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V384c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v320c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V462c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v242c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V304c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v400c0 4.4 3.6 8 8 8z"}}]},name:"bar-chart",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},63806:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M766.4 744.3c43.7 0 79.4-36.2 79.4-80.5 0-53.5-79.4-140.8-79.4-140.8S687 610.3 687 663.8c0 44.3 35.7 80.5 79.4 80.5zm-377.1-44.1c7.1 7.1 18.6 7.1 25.6 0l256.1-256c7.1-7.1 7.1-18.6 0-25.6l-256-256c-.6-.6-1.3-1.2-2-1.7l-78.2-78.2a9.11 9.11 0 00-12.8 0l-48 48a9.11 9.11 0 000 12.8l67.2 67.2-207.8 207.9c-7.1 7.1-7.1 18.6 0 25.6l255.9 256zm12.9-448.6l178.9 178.9H223.4l178.8-178.9zM904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8z"}}]},name:"bg-colors",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},15001:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-260 72h96v209.9L621.5 312 572 347.4V136zm220 752H232V136h280v296.9c0 3.3 1 6.6 3 9.3a15.9 15.9 0 0022.3 3.7l83.8-59.9 81.4 59.4c2.7 2 6 3.1 9.4 3.1 8.8 0 16-7.2 16-16V136h64v752z"}}]},name:"book",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},9541:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M740 161c-61.8 0-112 50.2-112 112 0 50.1 33.1 92.6 78.5 106.9v95.9L320 602.4V318.1c44.2-15 76-56.9 76-106.1 0-61.8-50.2-112-112-112s-112 50.2-112 112c0 49.2 31.8 91 76 106.1V706c-44.2 15-76 56.9-76 106.1 0 61.8 50.2 112 112 112s112-50.2 112-112c0-49.2-31.8-91-76-106.1v-27.8l423.5-138.7a50.52 50.52 0 0034.9-48.2V378.2c42.9-15.8 73.6-57 73.6-105.2 0-61.8-50.2-112-112-112zm-504 51a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm96 600a48.01 48.01 0 01-96 0 48.01 48.01 0 0196 0zm408-491a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"branches",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},31097:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M632 888H392c-4.4 0-8 3.6-8 8v32c0 17.7 14.3 32 32 32h192c17.7 0 32-14.3 32-32v-32c0-4.4-3.6-8-8-8zM512 64c-181.1 0-328 146.9-328 328 0 121.4 66 227.4 164 284.1V792c0 17.7 14.3 32 32 32h264c17.7 0 32-14.3 32-32V676.1c98-56.7 164-162.7 164-284.1 0-181.1-146.9-328-328-328zm127.9 549.8L604 634.6V752H420V634.6l-35.9-20.8C305.4 568.3 256 484.5 256 392c0-141.4 114.6-256 256-256s256 114.6 256 256c0 92.5-49.4 176.3-128.1 221.8z"}}]},name:"bulb",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},25046:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},31931:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M516 673c0 4.4 3.4 8 7.5 8h185c4.1 0 7.5-3.6 7.5-8v-48c0-4.4-3.4-8-7.5-8h-185c-4.1 0-7.5 3.6-7.5 8v48zm-194.9 6.1l192-161c3.8-3.2 3.8-9.1 0-12.3l-192-160.9A7.95 7.95 0 00308 351v62.7c0 2.4 1 4.6 2.9 6.1L420.7 512l-109.8 92.2a8.1 8.1 0 00-2.9 6.1V673c0 6.8 7.9 10.5 13.1 6.1zM880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"code",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},56977:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M651.1 641.9a7.84 7.84 0 00-5.1-1.9h-54.7c-2.4 0-4.6 1.1-6.1 2.9L512 730.7l-73.1-87.8a8.1 8.1 0 00-6.1-2.9H378c-1.9 0-3.7.7-5.1 1.9a7.97 7.97 0 00-1 11.3L474.2 776 371.8 898.9a8.06 8.06 0 006.1 13.2h54.7c2.4 0 4.6-1.1 6.1-2.9l73.1-87.8 73.1 87.8a8.1 8.1 0 006.1 2.9h55c1.9 0 3.7-.7 5.1-1.9 3.4-2.8 3.9-7.9 1-11.3L549.8 776l102.4-122.9c2.8-3.4 2.3-8.4-1.1-11.2zM472 544h80c4.4 0 8-3.6 8-8V120c0-4.4-3.6-8-8-8h-80c-4.4 0-8 3.6-8 8v416c0 4.4 3.6 8 8 8zM350 386H184V136c0-3.3-2.7-6-6-6h-60c-3.3 0-6 2.7-6 6v292c0 16.6 13.4 30 30 30h208c3.3 0 6-2.7 6-6v-60c0-3.3-2.7-6-6-6zm556-256h-60c-3.3 0-6 2.7-6 6v250H674c-3.3 0-6 2.7-6 6v60c0 3.3 2.7 6 6 6h208c16.6 0 30-13.4 30-30V136c0-3.3-2.7-6-6-6z"}}]},name:"delete-column",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},13049:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888.3 693.2c-42.5-24.6-94.3-18-129.2 12.8l-53-30.7V523.6c0-15.7-8.4-30.3-22-38.1l-136-78.3v-67.1c44.2-15 76-56.8 76-106.1 0-61.9-50.1-112-112-112s-112 50.1-112 112c0 49.3 31.8 91.1 76 106.1v67.1l-136 78.3c-13.6 7.8-22 22.4-22 38.1v151.6l-53 30.7c-34.9-30.8-86.8-37.4-129.2-12.8-53.5 31-71.7 99.4-41 152.9 30.8 53.5 98.9 71.9 152.2 41 42.5-24.6 62.7-73 53.6-118.8l48.7-28.3 140.6 81c6.8 3.9 14.4 5.9 22 5.9s15.2-2 22-5.9L674.5 740l48.7 28.3c-9.1 45.7 11.2 94.2 53.6 118.8 53.3 30.9 121.5 12.6 152.2-41 30.8-53.6 12.6-122-40.7-152.9zm-673 138.4a47.6 47.6 0 01-65.2-17.6c-13.2-22.9-5.4-52.3 17.5-65.5a47.6 47.6 0 0165.2 17.6c13.2 22.9 5.4 52.3-17.5 65.5zM522 463.8zM464 234a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm170 446.2l-122 70.3-122-70.3V539.8l122-70.3 122 70.3v140.4zm239.9 133.9c-13.2 22.9-42.4 30.8-65.2 17.6-22.8-13.2-30.7-42.6-17.5-65.5s42.4-30.8 65.2-17.6c22.9 13.2 30.7 42.5 17.5 65.5z"}}]},name:"deployment-unit",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},88766:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM514.1 580.1l-61.8-102.4c-2.2-3.6-6.1-5.8-10.3-5.8h-38.4c-2.3 0-4.5.6-6.4 1.9-5.6 3.5-7.3 10.9-3.7 16.6l82.3 130.4-83.4 132.8a12.04 12.04 0 0010.2 18.4h34.5c4.2 0 8-2.2 10.2-5.7L510 664.8l62.3 101.4c2.2 3.6 6.1 5.7 10.2 5.7H620c2.3 0 4.5-.7 6.5-1.9 5.6-3.6 7.2-11 3.6-16.6l-84-130.4 85.3-132.5a12.04 12.04 0 00-10.1-18.5h-35.7c-4.2 0-8.1 2.2-10.3 5.8l-61.2 102.3z"}}]},name:"file-excel",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},61448:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M553.1 509.1l-77.8 99.2-41.1-52.4a8 8 0 00-12.6 0l-99.8 127.2a7.98 7.98 0 006.3 12.9H696c6.7 0 10.4-7.7 6.3-12.9l-136.5-174a8.1 8.1 0 00-12.7 0zM360 442a40 40 0 1080 0 40 40 0 10-80 0zm494.6-153.4L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file-image",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},54666:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-696 72h136v656H184V184zm656 656H384V384h456v456zM384 320V184h456v136H384z"}}]},name:"layout",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},29643:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 1024c-69.1 0-136.2-13.5-199.3-40.2C251.7 958 197 921 150 874c-47-47-84-101.7-109.8-162.7C13.5 648.2 0 581.1 0 512c0-19.9 16.1-36 36-36s36 16.1 36 36c0 59.4 11.6 117 34.6 171.3 22.2 52.4 53.9 99.5 94.3 139.9 40.4 40.4 87.5 72.2 139.9 94.3C395 940.4 452.6 952 512 952c59.4 0 117-11.6 171.3-34.6 52.4-22.2 99.5-53.9 139.9-94.3 40.4-40.4 72.2-87.5 94.3-139.9C940.4 629 952 571.4 952 512c0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.2C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3s-13.5 136.2-40.2 199.3C958 772.3 921 827 874 874c-47 47-101.8 83.9-162.7 109.7-63.1 26.8-130.2 40.3-199.3 40.3z"}}]},name:"loading-3-quarters",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},73873:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M248 752h72V264h-72z"}},{tag:"path",attrs:{d:"M740 863c61.86 0 112-50.14 112-112 0-48.33-30.6-89.5-73.5-105.2l-.01-113.04a50.73 50.73 0 00-34.95-48.2l-434.9-142.41-22.4 68.42 420.25 137.61.01 95.92C661 658.34 628 700.8 628 751c0 61.86 50.14 112 112 112m-456 61c61.86 0 112-50.14 112-112s-50.14-112-112-112-112 50.14-112 112 50.14 112 112 112m456-125a48 48 0 110-96 48 48 0 010 96m-456 61a48 48 0 110-96 48 48 0 010 96m0-536c61.86 0 112-50.14 112-112s-50.14-112-112-112-112 50.14-112 112 50.14 112 112 112m0-64a48 48 0 110-96 48 48 0 010 96"}}]},name:"merge",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},28541:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},84254:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M878.3 392.1L631.9 145.7c-6.5-6.5-15-9.7-23.5-9.7s-17 3.2-23.5 9.7L423.8 306.9c-12.2-1.4-24.5-2-36.8-2-73.2 0-146.4 24.1-206.5 72.3a33.23 33.23 0 00-2.7 49.4l181.7 181.7-215.4 215.2a15.8 15.8 0 00-4.6 9.8l-3.4 37.2c-.9 9.4 6.6 17.4 15.9 17.4.5 0 1 0 1.5-.1l37.2-3.4c3.7-.3 7.2-2 9.8-4.6l215.4-215.4 181.7 181.7c6.5 6.5 15 9.7 23.5 9.7 9.7 0 19.3-4.2 25.9-12.4 56.3-70.3 79.7-158.3 70.2-243.4l161.1-161.1c12.9-12.8 12.9-33.8 0-46.8zM666.2 549.3l-24.5 24.5 3.8 34.4a259.92 259.92 0 01-30.4 153.9L262 408.8c12.9-7.1 26.3-13.1 40.3-17.9 27.2-9.4 55.7-14.1 84.7-14.1 9.6 0 19.3.5 28.9 1.6l34.4 3.8 24.5-24.5L608.5 224 800 415.5 666.2 549.3z"}}]},name:"pushpin",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},67492:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},63432:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 009.3-35.2l-.9-2.6a443.74 443.74 0 00-79.7-137.9l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.4a351.86 351.86 0 00-99 57.4l-81.9-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a446.02 446.02 0 00-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1 0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0025.8 25.7l2.7.5a449.4 449.4 0 00159 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-85a350 350 0 0099.7-57.6l81.3 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1 74.7 63.9a370.03 370.03 0 01-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3-17.9 97a377.5 377.5 0 01-85 0l-17.9-97.2-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5 0-15.3 1.2-30.6 3.7-45.5l6.5-40-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2 31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3 17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97 38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8 92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8A111.6 111.6 0 01624 502c0 29.9-11.7 58-32.8 79.2z"}}]},name:"setting",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},42176:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M752 664c-28.5 0-54.8 10-75.4 26.7L469.4 540.8a160.68 160.68 0 000-57.6l207.2-149.9C697.2 350 723.5 360 752 360c66.2 0 120-53.8 120-120s-53.8-120-120-120-120 53.8-120 120c0 11.6 1.6 22.7 4.7 33.3L439.9 415.8C410.7 377.1 364.3 352 312 352c-88.4 0-160 71.6-160 160s71.6 160 160 160c52.3 0 98.7-25.1 127.9-63.8l196.8 142.5c-3.1 10.6-4.7 21.8-4.7 33.3 0 66.2 53.8 120 120 120s120-53.8 120-120-53.8-120-120-120zm0-476c28.7 0 52 23.3 52 52s-23.3 52-52 52-52-23.3-52-52 23.3-52 52-52zM312 600c-48.5 0-88-39.5-88-88s39.5-88 88-88 88 39.5 88 88-39.5 88-88 88zm440 236c-28.7 0-52-23.3-52-52s23.3-52 52-52 52 23.3 52 52-23.3 52-52 52z"}}]},name:"share-alt",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},57591:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 208H676V232h212v136zm0 224H676V432h212v160zM412 432h200v160H412V432zm200-64H412V232h200v136zm-476 64h212v160H136V432zm0-200h212v136H136V232zm0 424h212v136H136V656zm276 0h200v136H412V656zm476 136H676V656h212v136z"}}]},name:"table",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},89543:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},75377:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(2053),i=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"},s=n(82350),a=function(e,t){return i.createElement(s.Z,(0,r.Z)({},e,{ref:t,icon:o}))};var u=i.forwardRef(a)},35685:function(e,t,n){"use strict";const r=n(68327),i=n(47947),o=n(99780),s=n(83798),a=n(10747),u=n(1416),c=n(75684),l=n(54571),h=n(13837),d=n(27348),f=n(7363),p=n(49193),m=n(47007),g=n(75921),v=n(123),y=n(12624);e.exports={driver:{RemoteConnection:u.RemoteConnection,RemoteStrategy:u.RemoteStrategy,RemoteTraversal:u.RemoteTraversal,ResponseError:f,DriverRemoteConnection:d,Client:p,ResultSet:m,auth:{Authenticator:g,PlainTextSaslAuthenticator:v}},process:{Bytecode:c,EnumValue:r.EnumValue,P:r.P,TextP:r.TextP,Traversal:r.Traversal,TraversalSideEffects:r.TraversalSideEffects,TraversalStrategies:o.TraversalStrategies,TraversalStrategy:o.TraversalStrategy,Traverser:r.Traverser,barrier:r.barrier,cardinality:r.cardinality,column:r.column,direction:r.direction,dt:r.dt,merge:r.merge,operator:r.operator,order:r.order,pick:r.pick,pop:r.pop,scope:r.scope,t:r.t,GraphTraversal:i.GraphTraversal,GraphTraversalSource:i.GraphTraversalSource,statics:i.statics,Translator:l,traversal:y.traversal,AnonymousTraversalSource:y,withOptions:r.withOptions},structure:{io:a,Edge:s.Edge,Graph:s.Graph,Path:s.Path,Property:s.Property,Vertex:s.Vertex,VertexProperty:s.VertexProperty,toLong:h.toLong}}},75921:function(e){"use strict";e.exports=class{constructor(e){this._options=e}evaluateChallenge(e){throw new Error("evaluateChallenge should be implemented")}}},73122:function(e){"use strict";e.exports=class{constructor(e){this.setopts(e)}get name(){return null}setopts(e){this._options=e}evaluateChallenge(e){throw new Error("evaluateChallenge should be implemented")}}},43948:function(e,t,n){"use strict";const{Buffer:r}=n(55872),i=n(73122);e.exports=class extends i{constructor(e){if(super(e),void 0===this._options.username||null===this._options.username||0===this._options.username.length||void 0===this._options.password||null===this._options.password||0===this._options.password.length)throw new Error("Missing credentials for SASL PLAIN mechanism")}get name(){return"PLAIN"}evaluateChallenge(e){return this._hasInitialResponse(e)?Promise.resolve({saslMechanism:this.name,sasl:this._saslArgument(this._options.authzid,this._options.username,this._options.password)}):Promise.resolve({sasl:this._saslArgument(this._options.authzid,this._options.username,this._options.password)})}_saslArgument(e,t,n){return null==e&&(e=""),null==t&&(t=""),void 0!==n&&null!==n.length||(n=""),r.from(`${e}\0${t}\0${n}`).toString("base64")}_hasInitialResponse(e){return null!=e}}},123:function(e,t,n){"use strict";const r=n(75921),i=n(43948);e.exports=class extends r{constructor(e,t,n){super({mechanism:new i({username:e,password:t,authzid:n})})}evaluateChallenge(e){return this._options.mechanism.evaluateChallenge(e)}}},49193:function(e,t,n){"use strict";const r=n(13837),i=n(99461),o=n(75684);e.exports=class{constructor(e,t={}){this._options=t,"session"===this._options.processor&&(this._options.session=t.session||r.getUuid()),this._options.session&&(this._options.processor=t.processor||"session"),this._connection=new i(e,t)}open(){return this._connection.open()}get isOpen(){return this._connection.isOpen}submit(e,t,n){const r=n&&n.requestId;r&&delete n.requestId;const i=Object.assign({gremlin:e,aliases:{g:this._options.traversalSource||"g"}},n);if(this._options.session&&"session"===this._options.processor&&(i.session=this._options.session),e instanceof o)return this._options.session&&"session"===this._options.processor?this._connection.submit("session","bytecode",i,r):this._connection.submit("traversal","bytecode",i,r);if("string"==typeof e)return i.bindings=t,i.language="gremlin-groovy",i.accept=this._connection.mimeType,this._connection.submit(this._options.processor||"","eval",i,r);throw new TypeError("message must be of type Bytecode or string")}stream(e,t,n){const r=n&&n.requestId;r&&delete n.requestId;const i=Object.assign({gremlin:e,aliases:{g:this._options.traversalSource||"g"}},n);if(this._options.session&&"session"===this._options.processor&&(i.session=this._options.session),e instanceof o)return this._options.session&&"session"===this._options.processor?this._connection.stream("session","bytecode",i,r):this._connection.stream("traversal","bytecode",i,r);if("string"==typeof e)return i.bindings=t,i.language="gremlin-groovy",i.accept=this._connection.mimeType,this._connection.stream(this._options.processor||"","eval",i,r);throw new TypeError("message must be of type Bytecode or string")}close(){if(this._options.session&&"session"===this._options.processor){const e={session:this._options.session};return this._connection.submit(this._options.processor,"close",e,null).then((()=>this._connection.close()))}return this._connection.close()}addListener(e,t){this._connection.on(e,t)}removeListener(e,t){this._connection.removeListener(e,t)}}},99461:function(e,t,n){"use strict";const{Buffer:r}=n(55872),i=n(2337),o=n(34654),s=n(13837),{DeferredPromise:a}=s,u=n(10747),{graphBinaryReader:c,graphBinaryWriter:l}=n(66691),h=n(47007),d=n(7363),f=204,p=206,m=407,g="application/vnd.gremlin-v2.0+json",v="application/vnd.graphbinary-v1.0",y="[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}";e.exports=class extends i{constructor(e,t){super(),this.url=e,this.options=t=t||{},this.mimeType=t.mimeType||"application/vnd.gremlin-v3.0+json",this._responseHandlers={},this._reader=t.reader||this.#e(this.mimeType),this._writer=t.writer||this.#t(this.mimeType),this._openPromise=null,this._openCallback=null,this._closePromise=null,this._closeCallback=null,this._header=String.fromCharCode(this.mimeType.length)+this.mimeType,this._header_buf=r.from(this._header),this.isOpen=!1,this.traversalSource=t.traversalSource||"g",this._authenticator=t.authenticator,this._enableUserAgentOnConnect=!1!==t.enableUserAgentOnConnect}async open(){if(this.isOpen)return;if(this._openPromise)return this._openPromise;this._openPromise=a(),this.emit("log","ws open");let e=this.options.headers;if(this._enableUserAgentOnConnect){e||(e=[]);void 0!==await s.getUserAgent()&&(e[s.getUserAgentHeader()]=await s.getUserAgent())}const t=globalThis.WebSocket??(await n.e(5183).then(n.t.bind(n,85183,23))).default;return this._ws=new t(this.url,void 0===globalThis.WebSocket?{headers:e,ca:this.options.ca,cert:this.options.cert,pfx:this.options.pfx,rejectUnauthorized:this.options.rejectUnauthorized,agent:this.options.agent}:void 0),"binaryType"in this._ws&&(this._ws.binaryType="arraybuffer"),this._ws.addEventListener("open",this.#n),this._ws.addEventListener("error",this.#r),this._ws.addEventListener("message",this.#i),this._ws.addEventListener("close",this.#o),await this._openPromise}submit(e,t,n,i){const o=(i||s.getUuid()).toLowerCase();if(!o.match(y))throw new Error('Provided requestId "'+o+'" is not a valid UUID.');return this.open().then((()=>new Promise(((i,a)=>{"authentication"!==t&&(this._responseHandlers[o]={callback:(e,t)=>e?a(e):i(t),result:null});const u={requestId:o,op:t||"bytecode",processor:e||"eval"===t?e:"traversal",args:n||{}},c=this._writer.writeRequest(u),l=s.toArrayBuffer(r.concat([this._header_buf,c]));this._ws.send(l)}))))}stream(e,t,n,i){const a=(i||s.getUuid()).toLowerCase();if(!a.match(y))throw new Error('Provided requestId "'+a+'" is not a valid UUID.');const u=new o.Readable({objectMode:!0,read(){}});return this._responseHandlers[a]={callback:e=>e?u.destroy(e):u.push(null),result:u},this.open().then((()=>{const i={requestId:a,op:t||"bytecode",processor:e||"eval"===t?e:"traversal",args:n||{}},o=this._writer.writeRequest(i),u=s.toArrayBuffer(r.concat([this._header_buf,o]));this._ws.send(u)})).catch((e=>u.destroy(e))),u}#e(e){return e===v?c:e===g?new u.GraphSON2Reader:new u.GraphSONReader}#t(e){return e===v?l:e===g?new u.GraphSON2Writer:new u.GraphSONWriter}#n=()=>{this._openPromise.resolve(),this.isOpen=!0};#r=({error:e})=>{this._openPromise.reject(e),this.emit("log",`ws error ${e}`),this.#s(e),this.emit("socketError",e)};#o=({code:e,message:t})=>{this.emit("log",`ws close code=${e} message=${t}`),this.#s(),this._closeCallback&&this._closeCallback(),this.emit("close",e,t)};#i=({data:e})=>{const t=e instanceof ArrayBuffer?r.from(e):e,n=this._reader.readResponse(t);if(null===n.requestId||void 0===n.requestId)return void Object.keys(this._responseHandlers).forEach((e=>{const t=this._responseHandlers[e];return this.#a(e),void 0!==n.status&&n.status.message?t.callback(new d(`Server error (no request information): ${n.status.message} (${n.status.code})`,n.status)):t.callback(new d(`Server error (no request information): ${JSON.stringify(n)}`,n.status))}));n.requestId=n.requestId.toLowerCase();const i=this._responseHandlers[n.requestId];if(!i)return;if(n.status.code===m&&this._authenticator)return void this._authenticator.evaluateChallenge(n.result.data).then((e=>this.submit(void 0,"authentication",e,n.requestId))).catch(i.callback);if(n.status.code>=400)return i.callback(new d(`Server error: ${n.status.message} (${n.status.code})`,n.status));const a=i.result instanceof o.Readable;switch(n.status.code){case f:return this.#a(n.requestId),a?(i.result.push(new h(s.emptyArray,n.status.attributes)),i.callback(null)):i.callback(null,new h(s.emptyArray,n.status.attributes));case p:if(a){i.result.push(new h(n.result.data,n.status.attributes));break}i.result=i.result||[],i.result.push.apply(i.result,n.result.data);break;default:return a?(i.result.push(new h(n.result.data,n.status.attributes)),i.callback(null)):(i.result?i.result.push.apply(i.result,n.result.data):i.result=n.result.data,this.#a(n.requestId),i.callback(null,new h(i.result,n.status.attributes)))}};#s(e){Object.keys(this._responseHandlers).forEach((t=>{const n=this._responseHandlers[t];if(n.result instanceof o.Readable)n.callback(null);else{const t=e||new Error("Connection has been closed.");n.callback(t)}})),this._ws.removeEventListener("open",this.#n),this._ws.removeEventListener("error",this.#r),this._ws.removeEventListener("message",this.#i),this._ws.removeEventListener("close",this.#o),this._openPromise=null,this._closePromise=null,this.isOpen=!1}#a(e){delete this._responseHandlers[e]}close(){return!1===this.isOpen?Promise.resolve():(this._closePromise||(this._closePromise=new Promise((e=>{this._closeCallback=e,this._ws.close()}))),this._closePromise)}}},27348:function(e,t,n){"use strict";const r=n(1416),i=r.RemoteConnection,o=r.RemoteTraversal,s=n(13837),a=n(49193),u=n(75684),c=n(99780).OptionsStrategy;class l extends i{constructor(e,t={}){super(e,t),this._client=new a(e,t)}open(){return this._client.open()}get isOpen(){return this._client.isOpen}submit(e){const t=e.sourceInstructions.find((e=>"withStrategies"===e[0]&&e[1]instanceof c)),n=["evaluationTimeout","scriptEvaluationTimeout","batchSize","requestId","userAgent","materializeProperties"];let r;if(void 0!==t){r={};const e=t[1].configuration;for(const t in e)e.hasOwnProperty(t)&&n.indexOf(t)>-1&&(r[t]=e[t])}return this._client.submit(e,null,r).then((e=>new o(e.toArray())))}createSession(){if(this.isSessionBound)throw new Error("Connection is already bound to a session - child sessions are not allowed");const e=Object.assign({},this.options);return e.session=s.getUuid(),new l(this.url,e)}get isSessionBound(){return this.options.session}commit(){return this._client.submit(u.GraphOp.commit,null)}rollback(){return this._client.submit(u.GraphOp.rollback,null)}close(){return this._client.close()}addListener(...e){return this._client.addListener(...e)}removeListener(...e){return this._client.removeListener(...e)}}e.exports=l},1416:function(e,t,n){"use strict";const r=n(68327),i=n(99780).TraversalStrategy;class o extends r.Traversal{constructor(e,t){super(null,null,null),this.traversers=e,this.sideEffects=t}}e.exports={RemoteConnection:class{constructor(e,t={}){this.url=e,this.options=t}open(){throw new Error("open() must be implemented")}get isOpen(){throw new Error("isOpen() must be implemented")}get isSessionBound(){return!1}submit(e){throw new Error("submit() must be implemented")}createSession(){throw new Error("createSession() must be implemented")}commit(){throw new Error("commit() must be implemented")}rollback(){throw new Error("rollback() must be implemented")}close(){throw new Error("close() must be implemented")}},RemoteStrategy:class extends i{constructor(e){super("js:RemoteStrategy"),this.connection=e}apply(e){return e.traversers?Promise.resolve():this.connection.submit(e.getBytecode()).then((function(t){e.sideEffects=t.sideEffects,e.traversers=t.traversers}))}},RemoteTraversal:o}},7363:function(e){"use strict";class t extends Error{constructor(e,t){super(e),this.name="ResponseError",this.statusCode=t.code,this.statusMessage=t.message,this.statusAttributes=t.attributes||{}}}e.exports=t},47007:function(e,t,n){"use strict";const r=n(13837),i=Object.freeze(new r.ImmutableMap);class o{constructor(e,t){if(!Array.isArray(e))throw new TypeError("items must be an Array instance");this._items=e,this.attributes=t||i,this.length=e.length}[Symbol.iterator](){return this._items[Symbol.iterator]()}toArray(){return this._items}first(){const e=this._items[0];return void 0!==e?e:null}}e.exports=o},12624:function(e,t,n){"use strict";const r=n(47947),i=n(1416),o=n(99780).TraversalStrategies,s=r.GraphTraversalSource,a=r.GraphTraversal,u=n(75684),c=n(83798).Graph;class l{constructor(e,t){this.traversalSourceClass=e,this.traversalClass=t}static traversal(e,t){return new l(e||s,t||a)}with_(e){const t=new o;return t.addStrategy(new i.RemoteStrategy(e)),new this.traversalSourceClass(new c,t,new u,this.traversalSourceClass,this.traversalClass)}withRemote(e){return this.with_(e)}}e.exports=l},75684:function(e,t,n){"use strict";const{Traversal:r}=n(68327);class i{constructor(e){e?(this.sourceInstructions=[...e.sourceInstructions],this.stepInstructions=[...e.stepInstructions]):(this.sourceInstructions=[],this.stepInstructions=[])}addSource(e,t){if(void 0===e)throw new Error("Name is not defined");const n=new Array(t.length+1);n[0]=e;for(let e=0;e<t.length;++e)n[e+1]=t[e];return this.sourceInstructions.push(i._generateInstruction(e,t)),this}addStep(e,t){if(void 0===e)throw new Error("Name is not defined");return this.stepInstructions.push(i._generateInstruction(e,t)),this}static _generateInstruction(e,t){const n=(t?t.length:0)+1,i=new Array(n);i[0]=e;for(let e=1;e<n;e++){const n=t[e-1];if(n instanceof r&&null!=n.graph)throw new Error(`The child traversal of ${n} was not spawned anonymously - use the __ class rather than a TraversalSource to construct the child traversal`);i[e]=n}return i}toString(){return JSON.stringify([this.sourceInstructions,this.stepInstructions])}static _createGraphOp(e,t){const n=new i;return n.addSource(e,t),n}static get GraphOp(){return{commit:i._createGraphOp("tx",["commit"]),rollback:i._createGraphOp("tx",["rollback"])}}}e.exports=i},47947:function(e,t,n){"use strict";const{Traversal:r,cardinality:i}=n(68327),{Transaction:o}=n(44095),s=n(75684),{TraversalStrategies:a,VertexProgramStrategy:u,OptionsStrategy:c}=n(99780);class l{constructor(e,t,n,r,i){this.graph=e,this.traversalStrategies=t,this.bytecode=n||new s,this.graphTraversalSourceClass=r||l,this.graphTraversalClass=i||h;const o=t.strategies.find((e=>"js:RemoteStrategy"===e.fqcn));this.remoteConnection=void 0!==o?o.connection:void 0}tx(){if(this.remoteConnection&&this.remoteConnection.isSessionBound)throw new Error("This TraversalSource is already bound to a transaction - child transactions are not supported");return new o(this)}withComputer(e,t,n,r,i,o,s){const a={};return void 0!==e&&(a.graphComputer=e),void 0!==t&&(a.workers=t),void 0!==n&&(a.result=n),void 0!==r&&(a.graphComputer=r),void 0!==i&&(a.vertices=i),void 0!==o&&(a.edges=o),void 0!==s&&(a.configuration=s),this.withStrategies(new u(a))}with_(e,t){const n=void 0===t||t;let r=this.bytecode.sourceInstructions.find((e=>"withStrategies"===e[0]&&e[1]instanceof c));return void 0===r?(r=new c({[e]:n}),this.withStrategies(r)):(r[1].configuration[e]=n,new this.graphTraversalSourceClass(this.graph,new a(this.traversalStrategies),this.bytecode,this.graphTraversalSourceClass,this.graphTraversalClass))}toString(){return"graphtraversalsource["+this.graph.toString()+"]"}withBulk(...e){const t=new s(this.bytecode).addSource("withBulk",e);return new this.graphTraversalSourceClass(this.graph,new a(this.traversalStrategies),t,this.graphTraversalSourceClass,this.graphTraversalClass)}withPath(...e){const t=new s(this.bytecode).addSource("withPath",e);return new this.graphTraversalSourceClass(this.graph,new a(this.traversalStrategies),t,this.graphTraversalSourceClass,this.graphTraversalClass)}withSack(...e){const t=new s(this.bytecode).addSource("withSack",e);return new this.graphTraversalSourceClass(this.graph,new a(this.traversalStrategies),t,this.graphTraversalSourceClass,this.graphTraversalClass)}withSideEffect(...e){const t=new s(this.bytecode).addSource("withSideEffect",e);return new this.graphTraversalSourceClass(this.graph,new a(this.traversalStrategies),t,this.graphTraversalSourceClass,this.graphTraversalClass)}withStrategies(...e){const t=new s(this.bytecode).addSource("withStrategies",e);return new this.graphTraversalSourceClass(this.graph,new a(this.traversalStrategies),t,this.graphTraversalSourceClass,this.graphTraversalClass)}withoutStrategies(...e){const t=new s(this.bytecode).addSource("withoutStrategies",e);return new this.graphTraversalSourceClass(this.graph,new a(this.traversalStrategies),t,this.graphTraversalSourceClass,this.graphTraversalClass)}E(...e){const t=new s(this.bytecode).addStep("E",e);return new this.graphTraversalClass(this.graph,new a(this.traversalStrategies),t)}V(...e){const t=new s(this.bytecode).addStep("V",e);return new this.graphTraversalClass(this.graph,new a(this.traversalStrategies),t)}addE(...e){const t=new s(this.bytecode).addStep("addE",e);return new this.graphTraversalClass(this.graph,new a(this.traversalStrategies),t)}mergeE(...e){const t=new s(this.bytecode).addStep("mergeE",e);return new this.graphTraversalClass(this.graph,new a(this.traversalStrategies),t)}addV(...e){const t=new s(this.bytecode).addStep("addV",e);return new this.graphTraversalClass(this.graph,new a(this.traversalStrategies),t)}mergeV(...e){const t=new s(this.bytecode).addStep("mergeV",e);return new this.graphTraversalClass(this.graph,new a(this.traversalStrategies),t)}inject(...e){const t=new s(this.bytecode).addStep("inject",e);return new this.graphTraversalClass(this.graph,new a(this.traversalStrategies),t)}io(...e){const t=new s(this.bytecode).addStep("io",e);return new this.graphTraversalClass(this.graph,new a(this.traversalStrategies),t)}call(...e){const t=new s(this.bytecode).addStep("call",e);return new this.graphTraversalClass(this.graph,new a(this.traversalStrategies),t)}union(...e){const t=new s(this.bytecode).addStep("union",e);return new this.graphTraversalClass(this.graph,new a(this.traversalStrategies),t)}}class h extends r{constructor(e,t,n){super(e,t,n)}clone(){return new h(this.graph,this.traversalStrategies,this.getBytecode())}V(...e){return this.bytecode.addStep("V",e),this}E(...e){return this.bytecode.addStep("E",e),this}addE(...e){return this.bytecode.addStep("addE",e),this}addV(...e){return this.bytecode.addStep("addV",e),this}aggregate(...e){return this.bytecode.addStep("aggregate",e),this}all(...e){return this.bytecode.addStep("all",e),this}and(...e){return this.bytecode.addStep("and",e),this}any(...e){return this.bytecode.addStep("any",e),this}as(...e){return this.bytecode.addStep("as",e),this}asDate(...e){return this.bytecode.addStep("asDate",e),this}asString(...e){return this.bytecode.addStep("asString",e),this}barrier(...e){return this.bytecode.addStep("barrier",e),this}both(...e){return this.bytecode.addStep("both",e),this}bothE(...e){return this.bytecode.addStep("bothE",e),this}bothV(...e){return this.bytecode.addStep("bothV",e),this}branch(...e){return this.bytecode.addStep("branch",e),this}by(...e){return this.bytecode.addStep("by",e),this}call(...e){return this.bytecode.addStep("call",e),this}cap(...e){return this.bytecode.addStep("cap",e),this}choose(...e){return this.bytecode.addStep("choose",e),this}coalesce(...e){return this.bytecode.addStep("coalesce",e),this}coin(...e){return this.bytecode.addStep("coin",e),this}combine(...e){return this.bytecode.addStep("combine",e),this}concat(...e){return this.bytecode.addStep("concat",e),this}conjoin(...e){return this.bytecode.addStep("conjoin",e),this}connectedComponent(...e){return this.bytecode.addStep("connectedComponent",e),this}constant(...e){return this.bytecode.addStep("constant",e),this}count(...e){return this.bytecode.addStep("count",e),this}cyclicPath(...e){return this.bytecode.addStep("cyclicPath",e),this}dateAdd(...e){return this.bytecode.addStep("dateAdd",e),this}dateDiff(...e){return this.bytecode.addStep("dateDiff",e),this}dedup(...e){return this.bytecode.addStep("dedup",e),this}difference(...e){return this.bytecode.addStep("difference",e),this}discard(...e){return this.bytecode.addStep("discard",e),this}disjunct(...e){return this.bytecode.addStep("disjunct",e),this}drop(...e){return this.bytecode.addStep("drop",e),this}element(...e){return this.bytecode.addStep("element",e),this}elementMap(...e){return this.bytecode.addStep("elementMap",e),this}emit(...e){return this.bytecode.addStep("emit",e),this}fail(...e){return this.bytecode.addStep("fail",e),this}filter(...e){return this.bytecode.addStep("filter",e),this}flatMap(...e){return this.bytecode.addStep("flatMap",e),this}fold(...e){return this.bytecode.addStep("fold",e),this}format(...e){return this.bytecode.addStep("format",e),this}from_(...e){return this.bytecode.addStep("from",e),this}group(...e){return this.bytecode.addStep("group",e),this}groupCount(...e){return this.bytecode.addStep("groupCount",e),this}has(...e){return this.bytecode.addStep("has",e),this}hasId(...e){return this.bytecode.addStep("hasId",e),this}hasKey(...e){return this.bytecode.addStep("hasKey",e),this}hasLabel(...e){return this.bytecode.addStep("hasLabel",e),this}hasNot(...e){return this.bytecode.addStep("hasNot",e),this}hasValue(...e){return this.bytecode.addStep("hasValue",e),this}id(...e){return this.bytecode.addStep("id",e),this}identity(...e){return this.bytecode.addStep("identity",e),this}in_(...e){return this.bytecode.addStep("in",e),this}inE(...e){return this.bytecode.addStep("inE",e),this}inV(...e){return this.bytecode.addStep("inV",e),this}index(...e){return this.bytecode.addStep("index",e),this}inject(...e){return this.bytecode.addStep("inject",e),this}intersect(...e){return this.bytecode.addStep("intersect",e),this}is(...e){return this.bytecode.addStep("is",e),this}key(...e){return this.bytecode.addStep("key",e),this}label(...e){return this.bytecode.addStep("label",e),this}length(...e){return this.bytecode.addStep("length",e),this}limit(...e){return this.bytecode.addStep("limit",e),this}local(...e){return this.bytecode.addStep("local",e),this}loops(...e){return this.bytecode.addStep("loops",e),this}lTrim(...e){return this.bytecode.addStep("lTrim",e),this}map(...e){return this.bytecode.addStep("map",e),this}match(...e){return this.bytecode.addStep("match",e),this}math(...e){return this.bytecode.addStep("math",e),this}max(...e){return this.bytecode.addStep("max",e),this}mean(...e){return this.bytecode.addStep("mean",e),this}merge(...e){return this.bytecode.addStep("merge",e),this}mergeE(...e){return this.bytecode.addStep("mergeE",e),this}mergeV(...e){return this.bytecode.addStep("mergeV",e),this}min(...e){return this.bytecode.addStep("min",e),this}none(...e){return this.bytecode.addStep("none",e),this}not(...e){return this.bytecode.addStep("not",e),this}option(...e){return this.bytecode.addStep("option",e),this}optional(...e){return this.bytecode.addStep("optional",e),this}or(...e){return this.bytecode.addStep("or",e),this}order(...e){return this.bytecode.addStep("order",e),this}otherV(...e){return this.bytecode.addStep("otherV",e),this}out(...e){return this.bytecode.addStep("out",e),this}outE(...e){return this.bytecode.addStep("outE",e),this}outV(...e){return this.bytecode.addStep("outV",e),this}pageRank(...e){return this.bytecode.addStep("pageRank",e),this}path(...e){return this.bytecode.addStep("path",e),this}peerPressure(...e){return this.bytecode.addStep("peerPressure",e),this}product(...e){return this.bytecode.addStep("product",e),this}profile(...e){return this.bytecode.addStep("profile",e),this}program(...e){return this.bytecode.addStep("program",e),this}project(...e){return this.bytecode.addStep("project",e),this}properties(...e){return this.bytecode.addStep("properties",e),this}property(...e){return this.bytecode.addStep("property",e),this}propertyMap(...e){return this.bytecode.addStep("propertyMap",e),this}range(...e){return this.bytecode.addStep("range",e),this}read(...e){return this.bytecode.addStep("read",e),this}repeat(...e){return this.bytecode.addStep("repeat",e),this}replace(...e){return this.bytecode.addStep("replace",e),this}reverse(...e){return this.bytecode.addStep("reverse",e),this}rTrim(...e){return this.bytecode.addStep("rTrim",e),this}sack(...e){return this.bytecode.addStep("sack",e),this}sample(...e){return this.bytecode.addStep("sample",e),this}select(...e){return this.bytecode.addStep("select",e),this}shortestPath(...e){return this.bytecode.addStep("shortestPath",e),this}sideEffect(...e){return this.bytecode.addStep("sideEffect",e),this}simplePath(...e){return this.bytecode.addStep("simplePath",e),this}skip(...e){return this.bytecode.addStep("skip",e),this}split(...e){return this.bytecode.addStep("split",e),this}store(...e){return this.bytecode.addStep("store",e),this}subgraph(...e){return this.bytecode.addStep("subgraph",e),this}substring(...e){return this.bytecode.addStep("substring",e),this}sum(...e){return this.bytecode.addStep("sum",e),this}tail(...e){return this.bytecode.addStep("tail",e),this}timeLimit(...e){return this.bytecode.addStep("timeLimit",e),this}times(...e){return this.bytecode.addStep("times",e),this}to(...e){return this.bytecode.addStep("to",e),this}toE(...e){return this.bytecode.addStep("toE",e),this}toLower(...e){return this.bytecode.addStep("toLower",e),this}toUpper(...e){return this.bytecode.addStep("toUpper",e),this}toV(...e){return this.bytecode.addStep("toV",e),this}tree(...e){return this.bytecode.addStep("tree",e),this}trim(...e){return this.bytecode.addStep("trim",e),this}unfold(...e){return this.bytecode.addStep("unfold",e),this}union(...e){return this.bytecode.addStep("union",e),this}until(...e){return this.bytecode.addStep("until",e),this}value(...e){return this.bytecode.addStep("value",e),this}valueMap(...e){return this.bytecode.addStep("valueMap",e),this}values(...e){return this.bytecode.addStep("values",e),this}where(...e){return this.bytecode.addStep("where",e),this}with_(...e){return this.bytecode.addStep("with",e),this}write(...e){return this.bytecode.addStep("write",e),this}}class d extends s{constructor(e,t){super(),this.addSource("CardinalityValueTraversal",[e,t])}static single(e){return new d(i.single,e)}static list(e){return new d(i.list,e)}static set(e){return new d(i.set,e)}}function f(e,t){const n=new h(null,null,new s);return n[e].apply(n,t)}const p={E:(...e)=>f("E",e),V:(...e)=>f("V",e),addE:(...e)=>f("addE",e),addV:(...e)=>f("addV",e),aggregate:(...e)=>f("aggregate",e),all:(...e)=>f("all",e),and:(...e)=>f("and",e),any:(...e)=>f("any",e),as:(...e)=>f("as",e),asDate:(...e)=>f("asDate",e),asString:(...e)=>f("asString",e),barrier:(...e)=>f("barrier",e),both:(...e)=>f("both",e),bothE:(...e)=>f("bothE",e),bothV:(...e)=>f("bothV",e),branch:(...e)=>f("branch",e),call:(...e)=>f("call",e),cap:(...e)=>f("cap",e),choose:(...e)=>f("choose",e),coalesce:(...e)=>f("coalesce",e),coin:(...e)=>f("coin",e),concat:(...e)=>f("concat",e),constant:(...e)=>f("constant",e),count:(...e)=>f("count",e),cyclicPath:(...e)=>f("cyclicPath",e),dateAdd:(...e)=>f("dateAdd",e),dateDiff:(...e)=>f("dateDiff",e),dedup:(...e)=>f("dedup",e),drop:(...e)=>f("drop",e),element:(...e)=>f("element",e),elementMap:(...e)=>f("elementMap",e),emit:(...e)=>f("emit",e),fail:(...e)=>f("fail",e),filter:(...e)=>f("filter",e),flatMap:(...e)=>f("flatMap",e),fold:(...e)=>f("fold",e),format:(...e)=>f("format",e),group:(...e)=>f("group",e),groupCount:(...e)=>f("groupCount",e),has:(...e)=>f("has",e),hasId:(...e)=>f("hasId",e),hasKey:(...e)=>f("hasKey",e),hasLabel:(...e)=>f("hasLabel",e),hasNot:(...e)=>f("hasNot",e),hasValue:(...e)=>f("hasValue",e),id:(...e)=>f("id",e),identity:(...e)=>f("identity",e),in_:(...e)=>f("in_",e),inE:(...e)=>f("inE",e),inV:(...e)=>f("inV",e),index:(...e)=>f("index",e),inject:(...e)=>f("inject",e),is:(...e)=>f("is",e),key:(...e)=>f("key",e),label:(...e)=>f("label",e),length:(...e)=>f("length",e),limit:(...e)=>f("limit",e),local:(...e)=>f("local",e),loops:(...e)=>f("loops",e),lTrim:(...e)=>f("lTrim",e),map:(...e)=>f("map",e),match:(...e)=>f("match",e),math:(...e)=>f("math",e),max:(...e)=>f("max",e),mean:(...e)=>f("mean",e),mergeE:(...e)=>f("mergeE",e),mergeV:(...e)=>f("mergeV",e),min:(...e)=>f("min",e),none:(...e)=>f("none",e),not:(...e)=>f("not",e),optional:(...e)=>f("optional",e),or:(...e)=>f("or",e),order:(...e)=>f("order",e),otherV:(...e)=>f("otherV",e),out:(...e)=>f("out",e),outE:(...e)=>f("outE",e),outV:(...e)=>f("outV",e),path:(...e)=>f("path",e),project:(...e)=>f("project",e),properties:(...e)=>f("properties",e),property:(...e)=>f("property",e),propertyMap:(...e)=>f("propertyMap",e),range:(...e)=>f("range",e),repeat:(...e)=>f("repeat",e),replace:(...e)=>f("replace",e),reverse:(...e)=>f("reverse",e),rTrim:(...e)=>f("rTrim",e),sack:(...e)=>f("sack",e),sample:(...e)=>f("sample",e),select:(...e)=>f("select",e),sideEffect:(...e)=>f("sideEffect",e),simplePath:(...e)=>f("simplePath",e),skip:(...e)=>f("skip",e),split:(...e)=>f("split",e),store:(...e)=>f("store",e),subgraph:(...e)=>f("subgraph",e),substring:(...e)=>f("substring",e),sum:(...e)=>f("sum",e),tail:(...e)=>f("tail",e),timeLimit:(...e)=>f("timeLimit",e),times:(...e)=>f("times",e),to:(...e)=>f("to",e),toE:(...e)=>f("toE",e),toLower:(...e)=>f("toLower",e),toUpper:(...e)=>f("toUpper",e),toV:(...e)=>f("toV",e),tree:(...e)=>f("tree",e),trim:(...e)=>f("trim",e),unfold:(...e)=>f("unfold",e),union:(...e)=>f("union",e),until:(...e)=>f("until",e),value:(...e)=>f("value",e),valueMap:(...e)=>f("valueMap",e),values:(...e)=>f("values",e),where:(...e)=>f("where",e)};e.exports={GraphTraversal:h,GraphTraversalSource:l,CardinalityValue:d,statics:p}},44095:function(e,t,n){"use strict";const r=n(1416),i=n(75684),{TraversalStrategies:o}=n(99780);e.exports={Transaction:class{constructor(e){this._g=e,this._sessionBasedConnection=void 0}begin(){if(this._sessionBasedConnection)throw new Error("Transaction already started on this object");this._sessionBasedConnection=this._g.remoteConnection.createSession();const e=new o;return e.addStrategy(new r.RemoteStrategy(this._sessionBasedConnection)),new this._g.graphTraversalSourceClass(this._g.graph,e,new i(this._g.bytecode),this._g.graphTraversalSourceClass,this._g.graphTraversalClass)}commit(){if(!this._sessionBasedConnection)throw new Error("Cannot commit a transaction that is not started");return this._sessionBasedConnection.commit().finally((()=>this.close()))}rollback(){if(!this._sessionBasedConnection)throw new Error("Cannot rollback a transaction that is not started");return this._sessionBasedConnection.rollback().finally((()=>this.close()))}get isOpen(){return this._sessionBasedConnection.isOpen}close(){this._sessionBasedConnection&&this._sessionBasedConnection.close()}}}},54571:function(e,t,n){"use strict";const r=n(68327).Traversal,i=n(75684);e.exports=class{constructor(e){this._traversalSource=e}getTraversalSource(){return this._traversalSource}getTargetLanguage(){return"gremlin-groovy"}of(e){this._traversalSource=e}translate(e,t=!1){let n=t?"__":this._traversalSource;const r=(e instanceof i?e:e.getBytecode()).stepInstructions;for(let e=0;e<r.length;e++){const t=r[e].slice(1);if(n+="."+r[e][0]+"(",t.length)for(let e=0;e<t.length;e++)e>0&&(n+=", "),n+=this.convert(t[e]);n+=")"}return n}convert(e){let t="";if(Object(e)===e)if(e instanceof r)t+=this.translate(e.getBytecode(),!0);else if("[object Object]"===e.toString())Object.keys(e).forEach((function(n,r){r>0&&(t+=", "),t+=`('${n}', `,e[n]instanceof String||"string"==typeof e[n]?t+=`'${e[n]}'`:t+=e[n],t+=")"}));else if(Array.isArray(e)){const n=[];for(const t of e)n.push(this.convert(t));t+="["+n.join(", ")+"]"}else t+=e.toString();else t+=void 0===e?"":"number"==typeof e||"boolean"==typeof e?e:`'${e}'`;return t}}},99780:function(e,t,n){"use strict";const r=n(68327).Traversal;class i{constructor(e,t={}){this.fqcn=e,this.configuration=t}apply(e){}}e.exports={TraversalStrategies:class{constructor(e){this.strategies=e?[...e.strategies]:[]}addStrategy(e){this.strategies.push(e)}removeStrategy(e){const t=this.strategies.findIndex((t=>t.fqcn===e.fqcn));if(-1!==t)return this.strategies.splice(t,1)[0]}applyStrategies(e){return this.strategies.reduce(((t,n)=>t.then((()=>n.apply(e)))),Promise.resolve())}},TraversalStrategy:i,ConnectiveStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.decoration.ConnectiveStrategy")}},ElementIdStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.decoration.ElementIdStrategy")}},HaltedTraverserStrategy:class extends i{constructor(e){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.decoration.HaltedTraverserStrategy"),void 0!==e&&(this.configuration.haltedTraverserFactory=e)}},OptionsStrategy:class extends i{constructor(e){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.decoration.OptionsStrategy",e)}},PartitionStrategy:class extends i{constructor(e){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.decoration.PartitionStrategy",e)}},SeedStrategy:class extends i{constructor(e){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.decoration.SeedStrategy",{seed:e.seed})}},SubgraphStrategy:class extends i{constructor(e){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.decoration.SubgraphStrategy",e),this.configuration.vertices instanceof r&&(this.configuration.vertices=this.configuration.vertices.bytecode),this.configuration.edges instanceof r&&(this.configuration.edges=this.configuration.edges.bytecode),this.configuration.vertexProperties instanceof r&&(this.configuration.vertexProperties=this.configuration.vertexProperties.bytecode)}},VertexProgramStrategy:class extends i{constructor(e){super("org.apache.tinkerpop.gremlin.process.computer.traversal.strategy.decoration.VertexProgramStrategy",e)}},MatchAlgorithmStrategy:class extends i{constructor(e){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.finalization.MatchAlgorithmStrategy"),void 0!==e&&(this.configuration.matchAlgorithm=e)}},AdjacentToIncidentStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.AdjacentToIncidentStrategy")}},FilterRankingStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.FilterRankingStrategy")}},IdentityRemovalStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.IdentityRemovalStrategy")}},IncidentToAdjacentStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.IncidentToAdjacentStrategy")}},InlineFilterStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.InlineFilterStrategy")}},LazyBarrierStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.LazyBarrierStrategy")}},MatchPredicateStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.MatchPredicateStrategy")}},OrderLimitStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.OrderLimitStrategy")}},PathProcessorStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.PathProcessorStrategy")}},PathRetractionStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.PathRetractionStrategy")}},ProductiveByStrategy:class extends i{constructor(e){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.ProductiveByStrategy",e)}},CountStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.CountStrategy")}},RepeatUnrollStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.RepeatUnrollStrategy")}},GraphFilterStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.GraphFilterStrategy")}},EarlyLimitStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.optimization.EarlyLimitStrategy")}},EdgeLabelVerificationStrategy:class extends i{constructor(e=!1,t=!1){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.verification.EdgeLabelVerificationStrategy",{logWarnings:e,throwException:t})}},LambdaRestrictionStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.verification.LambdaRestrictionStrategy")}},ReadOnlyStrategy:class extends i{constructor(){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.verification.ReadOnlyStrategy")}},ReservedKeysVerificationStrategy:class extends i{constructor(e=!1,t=!1,n=["id","label"]){super("org.apache.tinkerpop.gremlin.process.traversal.strategy.verification.ReservedKeysVerificationStrategy",{logWarnings:e,throwException:t,keys:n})}}}},68327:function(e){"use strict";const t=Object.freeze({value:null,done:!0}),n=Symbol.asyncIterator||Symbol("@@asyncIterator");class r{constructor(e,t,n){this.operator=e,this.value=t,this.other=n}toString(){function e(t){if(Array.isArray(t)){const n=[];for(const r of t)n.push(e(r));return n}return t&&"string"==typeof t?`'${t}'`:t}return void 0===this.other||null===this.other?this.operator+"("+e(this.value)+")":this.operator+"("+e(this.value)+", "+e(this.other)+")"}and(e){return new r("and",this,e)}or(e){return new r("or",this,e)}static within(...e){return 1===e.length&&Array.isArray(e[0])?new r("within",e[0],null):new r("within",e,null)}static without(...e){return 1===e.length&&Array.isArray(e[0])?new r("without",e[0],null):new r("without",e,null)}static between(...e){return i("between",e)}static eq(...e){return i("eq",e)}static gt(...e){return i("gt",e)}static gte(...e){return i("gte",e)}static inside(...e){return i("inside",e)}static lt(...e){return i("lt",e)}static lte(...e){return i("lte",e)}static neq(...e){return i("neq",e)}static not(...e){return i("not",e)}static outside(...e){return i("outside",e)}static test(...e){return i("test",e)}}function i(e,t){return t.unshift(null,e),new(Function.prototype.bind.apply(r,t))}class o{constructor(e,t,n){this.operator=e,this.value=t,this.other=n}toString(){function e(e){return e&&"string"==typeof e?`'${e}'`:e}return void 0===this.other?this.operator+"("+e(this.value)+")":this.operator+"("+e(this.value)+", "+e(this.other)+")"}and(e){return new r("and",this,e)}or(e){return new r("or",this,e)}static containing(...e){return s("containing",e)}static endingWith(...e){return s("endingWith",e)}static notContaining(...e){return s("notContaining",e)}static notEndingWith(...e){return s("notEndingWith",e)}static notStartingWith(...e){return s("notStartingWith",e)}static startingWith(...e){return s("startingWith",e)}static regex(...e){return s("regex",e)}static notRegex(...e){return s("notRegex",e)}}function s(e,t){return t.unshift(null,e),new(Function.prototype.bind.apply(o,t))}function a(e,t){const n={};return t.split(" ").forEach((t=>{let r=t;r===r.toUpperCase()&&(r=r.toLowerCase()),n[r]=new c(e,t)})),n}const u={from_:"out",to:"in"};class c{constructor(e,t){this.typeName=e,this.elementName=t}toString(){return this.elementName}}e.exports={EnumValue:c,P:r,TextP:o,withOptions:{tokens:"~tinkerpop.valueMap.tokens",none:0,ids:1,labels:2,keys:4,values:8,all:15,indexer:"~tinkerpop.index.indexer",list:0,map:1},IO:class{static get graphml(){return"graphml"}static get graphson(){return"graphson"}static get gryo(){return"gryo"}static get reader(){return"~tinkerpop.io.reader"}static get registry(){return"~tinkerpop.io.registry"}static get writer(){return"~tinkerpop.io.writer"}},Traversal:class{constructor(e,t,n){this.graph=e,this.traversalStrategies=t,this.bytecode=n,this.traversers=null,this.sideEffects=null,this._traversalStrategiesPromise=null,this._traversersIteratorIndex=0}[n](){return this}getBytecode(){return this.bytecode}toList(){return this._applyStrategies().then((()=>{const e=[];let t;for(;(t=this._getNext())&&!t.done;)e.push(t.value);return e}))}hasNext(){return this._applyStrategies().then((()=>this.traversers&&this.traversers.length>0&&this._traversersIteratorIndex<this.traversers.length&&this.traversers[this._traversersIteratorIndex].bulk>0))}iterate(){return this.bytecode.addStep("discard"),this._applyStrategies().then((()=>{let e;for(;(e=this._getNext())&&!e.done;);}))}next(){return this._applyStrategies().then((()=>this._getNext()))}_getNext(){for(;this.traversers&&this._traversersIteratorIndex<this.traversers.length;){const e=this.traversers[this._traversersIteratorIndex];if(e.bulk>0)return e.bulk--,{value:e.object,done:!1};this._traversersIteratorIndex++}return t}_applyStrategies(){return this._traversalStrategiesPromise?this._traversalStrategiesPromise:this._traversalStrategiesPromise=this.traversalStrategies.applyStrategies(this)}toJSON(){return this.bytecode.stepInstructions}toString(){return this.bytecode.toString()}},TraversalSideEffects:class{},Traverser:class{constructor(e,t){this.object=e,this.bulk=t||1}},barrier:a("Barrier","normSack"),cardinality:a("Cardinality","list set single"),column:a("Column","keys values"),direction:function(e,t){const n=a(e,t);return Object.keys(u).forEach((e=>{n[e]=n[u[e]]})),n}("Direction","BOTH IN OUT from_ to"),dt:a("DT","second minute hour day"),graphSONVersion:a("GraphSONVersion","V1_0 V2_0 V3_0"),gryoVersion:a("GryoVersion","V1_0 V3_0"),merge:a("Merge","onCreate onMatch outV inV"),operator:a("Operator","addAll and assign div max min minus mult or sum sumLong"),order:a("Order","asc desc shuffle"),pick:a("Pick","any none"),pop:a("Pop","all first last mixed"),scope:a("Scope","global local"),t:a("T","id key label value")}},83798:function(e,t,n){"use strict";const r=n(47947),{TraversalStrategies:i}=n(99780);class o{constructor(e,t){this.id=e,this.label=t}equals(e){return e instanceof o&&this.id===e.id}}class s{constructor(e,t){this.key=e,this.value=t}toString(){return`p[${this.key}->${c(this.value)}]`}equals(e){return e instanceof s&&this.key===e.key&&this.value===e.value}}class a{constructor(e,t){this.labels=e,this.objects=t}toString(){return`path[${(this.objects||[]).join(", ")}]`}equals(e){return e instanceof a&&(e===this||u(this.objects,e.objects)&&u(this.labels,e.labels))}}function u(e,t){if(e===t)return!0;if("function"==typeof e.equals)return e.equals(t);if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!u(e[n],t[n]))return!1;return!0}return!1}function c(e){if(null==e)return e;const t=e.toString();return t.length>20?t.substr(0,20):t}e.exports={Edge:class extends o{constructor(e,t,n,r,i){if(super(e,n),this.outV=t,this.inV=r,this.properties={},i){const e=Object.keys(i);for(let t=0;t<e.length;t++){const n=e[t];this.properties[n]=i[n].value}}}toString(){const e=this.outV?this.outV.id:"?",t=this.inV?this.inV.id:"?";return`e[${this.id}][${e}-${this.label}->${t}]`}},Graph:class{traversal(e){return new(e||r.GraphTraversalSource)(this,new i)}toString(){return"graph[]"}},Path:a,Property:s,Vertex:class extends o{constructor(e,t,n){super(e,t),this.properties=n}toString(){return`v[${this.id}]`}},VertexProperty:class extends o{constructor(e,t,n,r){super(e,t),this.value=n,this.key=this.label,this.properties=r}toString(){return`vp[${this.label}->${c(this.value)}]`}}}},66691:function(e,t,n){"use strict";const r={};r.DataType=n(64793),r.utils=n(19785),r.serializers={},r.intSerializer=new(n(71046))(r),r.longSerializer=new(n(83306))(r),r.longSerializerNg=new(n(12802))(r),r.stringSerializer=new(n(99777))(r,r.DataType.STRING),r.dateSerializer=new(n(6389))(r,r.DataType.DATE),r.timestampSerializer=new(n(6389))(r,r.DataType.TIMESTAMP),r.classSerializer=new(n(99777))(r,r.DataType.CLASS),r.doubleSerializer=new(n(54361))(r),r.floatSerializer=new(n(43249))(r),r.listSerializer=new(n(32685))(r,r.DataType.LIST),r.mapSerializer=new(n(16915))(r),r.setSerializer=new(n(534))(r,r.DataType.SET),r.uuidSerializer=new(n(47417))(r),r.edgeSerializer=new(n(41831))(r),r.pathSerializer=new(n(19130))(r),r.propertySerializer=new(n(80595))(r),r.vertexSerializer=new(n(83299))(r),r.vertexPropertySerializer=new(n(2041))(r),r.bytecodeSerializer=new(n(87837))(r),r.pSerializer=new(n(52635))(r),r.traverserSerializer=new(n(97126))(r),r.enumSerializer=new(n(45565))(r),r.lambdaSerializer=new(n(17670))(r),r.bigIntegerSerializer=new(n(55223))(r),r.byteSerializer=new(n(44235))(r),r.byteBufferSerializer=new(n(26072))(r),r.shortSerializer=new(n(35392))(r),r.booleanSerializer=new(n(6832))(r),r.textPSerializer=new(n(78964))(r),r.traversalStrategySerializer=new(n(73088))(r),r.bulkSetSerializer=new(n(14062))(r),r.unspecifiedNullSerializer=new(n(56878))(r),r.numberSerializationStrategy=new(n(99871))(r),r.anySerializer=new(n(9002))(r),r.graphBinaryReader=new(n(49539))(r),r.graphBinaryWriter=new(n(27259))(r),e.exports=r},9002:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e){this.ioc=e,this.serializers=[e.unspecifiedNullSerializer,e.numberSerializationStrategy,e.booleanSerializer,e.dateSerializer,e.bytecodeSerializer,e.pSerializer,e.traverserSerializer,e.enumSerializer,e.listSerializer,e.uuidSerializer,e.edgeSerializer,e.pathSerializer,e.propertySerializer,e.vertexSerializer,e.vertexPropertySerializer,e.stringSerializer,e.textPSerializer,e.traversalStrategySerializer,e.byteBufferSerializer,e.lambdaSerializer,e.mapSerializer]}getSerializerCanBeUsedFor(e){for(let t=0;t<this.serializers.length;t++)if(this.serializers[t].canBeUsedFor(e))return this.serializers[t];throw new Error(`No serializer found to support item where typeof(item)='${typeof e}' and String(item)='${String(e)}'.`)}serialize(e,t=!0){return this.getSerializerCanBeUsedFor(e).serialize(e,t)}deserialize(e){try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");const t=e.readUInt8(),n=this.ioc.serializers[t];if(!n)throw new Error("unknown {type_code}");return n.deserialize(e)}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,err:e})}}}},32685:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e,t){this.ioc=e,this.ID=t,this.ioc.serializers[t]=this}canBeUsedFor(e){return Array.isArray(e)}serialize(e,t=!0){if(null==e)return t?r.from([this.ID,1]):r.from([0,0,0,0]);const n=[];t&&n.push(r.from([this.ID,0]));let i=e.length;if(i<0&&(i=0),i>this.ioc.intSerializer.INT32_MAX)throw new Error(`Array length=${i} is greater than supported max_length=${this.ioc.intSerializer.INT32_MAX}.`);n.push(this.ioc.intSerializer.serialize(i,!1));for(let t=0;t<i;t++)n.push(this.ioc.anySerializer.serialize(e[t]));return r.concat(n)}deserialize(e,t=!0){let n=0,i=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=i.readUInt8();if(n++,e!==this.ID)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");const t=i.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");i=i.slice(1)}let o,s;try{({v:o,len:s}=this.ioc.intSerializer.deserialize(i,!1)),n+=s}catch(e){throw e.message="{length}: "+e.message,e}if(o<0)throw new Error("{length} is less than zero");i=i.slice(s);const a=[];for(let e=0;e<o;e++){let t,r;try{({v:t,len:r}=this.ioc.anySerializer.deserialize(i)),n+=r}catch(t){throw t.message=`{item_${e}}: `+t.message,t}i=i.slice(r),a.push(t)}return{v:a,len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:e})}}}},55223:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.BIGINTEGER]=this}canBeUsedFor(e){return"bigint"==typeof e}serialize(e,t=!0){if(null==e)return t?r.from([this.ioc.DataType.BIGINTEGER,1]):r.from([0,0,0,1,0]);const n=[];let i;if(t&&n.push(r.from([this.ioc.DataType.BIGINTEGER,0])),e>=0){let t=e.toString(16);t.length%2!=0&&(t="0"+t),Number.parseInt(t[0],16)>7&&(t="00"+t),i=r.from(t,"hex")}else{let t=(-e).toString(16);const n=(t.length+t.length%2)/2;let o=BigInt(n)*BigInt(8);e<-(BigInt(2)**(o-BigInt(1)))&&(o+=BigInt(8));t=(BigInt(2)**o+e).toString(16),t.length%2!=0&&(t="0"+t),i=r.from(t,"hex")}return n.push(this.ioc.intSerializer.serialize(i.length,!1)),n.push(i),r.concat(n)}deserialize(e,t=!0){let n=0,i=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=i.readUInt8();if(n++,e!==this.ioc.DataType.BIGINTEGER)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");const t=i.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");i=i.slice(1)}let o,s;try{({v:o,len:s}=this.ioc.intSerializer.deserialize(i,!1)),n+=s}catch(e){throw e.message="{length}: "+e.message,e}if(o<1)throw new Error(`{length}=${o} is less than one`);i=i.slice(s),n+=o,i=i.slice(0,o);let a=BigInt(`0x${i.toString("hex")}`);return 128==(128&i[0])&&(a=BigInt.asIntN(8*o,a)),{v:a,len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:e})}}}},6832:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.BOOLEAN]=this}canBeUsedFor(e){return"boolean"==typeof e}serialize(e,t=!0){if(null==e)return t?r.from([this.ioc.DataType.BOOLEAN,1]):r.from([0]);const n=[];return t&&n.push(r.from([this.ioc.DataType.BOOLEAN,0])),n.push(r.from([e?1:0])),r.concat(n)}deserialize(e,t=!0){let n=0,i=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=i.readUInt8();if(n++,e!==this.ioc.DataType.BOOLEAN)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");const t=i.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<1)throw new Error("unexpected {value} length");n+=1;let o=i.readUInt8();if(0!==o&&1!==o)throw new Error(`unexpected boolean byte=${o}`);return o=1===o,{v:o,len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:e})}}}},14062:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.BULKSET]=this}deserialize(e,t=!0){let n=0,i=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=i.readUInt8();if(n++,e!==this.ioc.DataType.BULKSET)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");const t=i.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");i=i.slice(1)}let o,s;try{({v:o,len:s}=this.ioc.intSerializer.deserialize(i,!1)),n+=s}catch(e){throw e.message="{length}: "+e.message,e}if(o<0)throw new Error("{length} is less than zero");i=i.slice(s);let a=new Array;for(let e=0;e<o;e++){let t,r,o,s;try{({v:t,len:r}=this.ioc.anySerializer.deserialize(i)),n+=r}catch(t){throw t.message=`{item_${e}} value: `+t.message,t}i=i.slice(r);try{({v:o,len:s}=this.ioc.longSerializer.deserialize(i,!1)),n+=s}catch(t){throw t.message=`{item_${e}} bulk: `+t.message,t}if(o<0)throw new Error(`{item_${e}}: bulk is less than zero`);if(o>4294967295)throw new Error(`{item_${e}}: bulk is greater than 2^32-1`);i=i.slice(s),o=Number(o);const u=new Array(o).fill(t);a=a.concat(u)}return{v:a,len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:e})}}}},26072:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.BYTEBUFFER]=this}canBeUsedFor(e){return e instanceof r}serialize(e,t=!0){if(null==e)return t?r.from([this.ioc.DataType.BYTEBUFFER,1]):r.from([0,0,0,0]);const n=[];t&&n.push(r.from([this.ioc.DataType.BYTEBUFFER,0]));let i=e.length;if(i<0&&(i=0),i>this.ioc.intSerializer.INT32_MAX)throw new Error(`Buffer length=${i} is greater than supported max_length=${this.ioc.intSerializer.INT32_MAX}.`);return n.push(this.ioc.intSerializer.serialize(i,!1)),n.push(e),r.concat(n)}deserialize(e,t=!0){let n=0,i=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=i.readUInt8();if(n++,e!==this.ioc.DataType.BYTEBUFFER)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");const t=i.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");i=i.slice(1)}let o,s;try{({v:o,len:s}=this.ioc.intSerializer.deserialize(i,!1)),n+=s}catch(e){throw e.message="{length}: "+e.message,e}if(o<0)throw new Error("{length} is less than zero");if(i=i.slice(s),o!==i.length)throw new Error(`{value}: unexpected actual {value} length=${i.length} when {length}=${o}`);const a=i.slice(0,o);return n+=o,{v:a,len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:e})}}}},44235:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.BYTE]=this}serialize(e,t=!0){if(null==e)return t?r.from([this.ioc.DataType.BYTE,1]):r.from([0]);const n=[];t&&n.push(r.from([this.ioc.DataType.BYTE,0]));const i=r.alloc(1);return i.writeUInt8(e),n.push(i),r.concat(n)}deserialize(e,t=!0){let n=0,i=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=i.readUInt8();if(n++,e!==this.ioc.DataType.BYTE)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");const t=i.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<1)throw new Error("unexpected {value} length");n+=1;return{v:i.readUInt8(),len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:e})}}}},87837:function(e,t,n){"use strict";const{Buffer:r}=n(55872),i=n(75684),o=n(68327);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.BYTECODE]=this}canBeUsedFor(e){return e instanceof i||e instanceof o.Traversal}serialize(e,t=!0){if(null==e){if(t)return r.from([this.ioc.DataType.BYTECODE,1]);const e=[0,0,0,0],n=[0,0,0,0];return r.from([...e,...n])}e instanceof o.Traversal&&(e=e.getBytecode());const n=[];t&&n.push(r.from([this.ioc.DataType.BYTECODE,0])),n.push(this.ioc.intSerializer.serialize(e.stepInstructions.length,!1));for(let t=0;t<e.stepInstructions.length;t++){const r=e.stepInstructions[t],i=r[0],o=r.length-1;n.push(this.ioc.stringSerializer.serialize(i,!1)),n.push(this.ioc.intSerializer.serialize(o,!1));for(let e=0;e<o;e++)n.push(this.ioc.anySerializer.serialize(r[1+e],!0))}n.push(this.ioc.intSerializer.serialize(e.sourceInstructions.length,!1));for(let t=0;t<e.sourceInstructions.length;t++){const r=e.sourceInstructions[t],i=r[0],o=r.length-1;n.push(this.ioc.stringSerializer.serialize(i,!1)),n.push(this.ioc.intSerializer.serialize(o,!1));for(let e=0;e<o;e++)n.push(this.ioc.anySerializer.serialize(r[1+e],!0))}return r.concat(n)}deserialize(e,t=!0){let n=0,o=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=o.readUInt8();if(n++,e!==this.ioc.DataType.BYTECODE)throw new Error("unexpected {type_code}");if(o=o.slice(1),o.length<1)throw new Error("{value_flag} is missing");const t=o.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");o=o.slice(1)}const s=new i;let a,u,c,l;try{({v:a,len:u}=this.ioc.intSerializer.deserialize(o,!1)),n+=u}catch(e){throw e.message="{steps_length}: "+e.message,e}if(a<0)throw new Error("{steps_length} is less than zero");o=o.slice(u);for(let e=0;e<a;e++){let t,r,i,a;try{({v:t,len:r}=this.ioc.stringSerializer.deserialize(o,!1)),n+=r}catch(t){throw t.message=`{step_${e}} {name}: `+t.message,t}o=o.slice(r);try{({v:i,len:a}=this.ioc.intSerializer.deserialize(o,!1)),n+=a}catch(t){throw t.message=`{step_${e}} {values_length}: `+t.message,t}if(i<0)throw new Error(`{step_${e}} {values_length} is less than zero`);o=o.slice(a);const u=[];let c,l;for(let t=0;t<i;t++){try{({v:c,len:l}=this.ioc.anySerializer.deserialize(o)),n+=l,u.push(c)}catch(n){throw n.message=`{step_${e}} {value_${t}}: `+n.message,n}o=o.slice(l)}s.addStep(t,u)}try{({v:c,len:l}=this.ioc.intSerializer.deserialize(o,!1)),n+=l}catch(e){throw e.message="{sources_length}: "+e.message,e}if(c<0)throw new Error("{sources_length} is less than zero");o=o.slice(l);for(let e=0;e<c;e++){let t,r,i,a;try{({v:t,len:r}=this.ioc.stringSerializer.deserialize(o,!1)),n+=r}catch(t){throw t.message=`{source_${e}} {name}: `+t.message,t}o=o.slice(r);try{({v:i,len:a}=this.ioc.intSerializer.deserialize(o,!1)),n+=a}catch(t){throw t.message=`{source_${e}} {values_length}: `+t.message,t}if(i<0)throw new Error(`{source_${e}} {values_length} is less than zero`);o=o.slice(a);const u=[];let c,l;for(let t=0;t<i;t++){try{({v:c,len:l}=this.ioc.anySerializer.deserialize(o)),n+=l,u.push(c)}catch(n){throw n.message=`{source_${e}} {value_${t}}: `+n.message,n}o=o.slice(l)}s.addSource(t,u)}return{v:s,len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:o,err:e})}}}},64793:function(e){"use strict";e.exports={INT:1,LONG:2,STRING:3,DATE:4,TIMESTAMP:5,CLASS:6,DOUBLE:7,FLOAT:8,LIST:9,MAP:10,SET:11,UUID:12,EDGE:13,PATH:14,PROPERTY:15,GRAPH:16,VERTEX:17,VERTEXPROPERTY:18,BARRIER:19,BINDING:20,BYTECODE:21,CARDINALITY:22,COLUMN:23,DIRECTION:24,OPERATOR:25,ORDER:26,PICK:27,POP:28,LAMBDA:29,P:30,SCOPE:31,T:32,TRAVERSER:33,BIGDECIMAL:34,BIGINTEGER:35,BYTE:36,BYTEBUFFER:37,SHORT:38,BOOLEAN:39,TEXTP:40,TRAVERSALSTRATEGY:41,BULKSET:42,TREE:43,METRICS:44,TRAVERSALMETRICS:45,MERGE:46,DT:47,CHAR:128,DURATION:129,INETADDRESS:130,INSTANT:131,LOCALDATE:132,LOCALDATETIME:133,LOCALTIME:134,MONTHDAY:135,OFFSETDATETIME:136,OFFSETTIME:137,PERIOD:138,YEAR:139,YEARMONTH:140,ZONEDATETIME:141,ZONEOFFSET:142,CUSTOM:0,UNSPECIFIED_NULL:254}},6389:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e,t){this.ioc=e,this.ID=t,this.ioc.serializers[t]=this}canBeUsedFor(e){return e instanceof Date}serialize(e,t=!0){if(null==e)return t?r.from([this.ID,1]):r.from([0,0,0,0,0,0,0,0]);const n=[];t&&n.push(r.from([this.ID,0]));const i=r.alloc(8);return i.writeBigInt64BE(BigInt(e.getTime())),n.push(i),r.concat(n)}deserialize(e,t=!0){let n=0,i=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=i.readUInt8();if(n++,e!==this.ID)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");const t=i.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<8)throw new Error("unexpected {value} length");n+=8;const o=i.readBigInt64BE();return{v:new Date(Number(o)),len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:e})}}}},54361:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.DOUBLE]=this}canBeUsedFor(e){return"number"==typeof e&&!Number.isInteger(e)}serialize(e,t=!0){if(null==e)return t?r.from([this.ioc.DataType.DOUBLE,1]):r.from([0,0,0,0,0,0,0,0]);const n=[];t&&n.push(r.from([this.ioc.DataType.DOUBLE,0]));const i=r.alloc(8);return i.writeDoubleBE(e),n.push(i),r.concat(n)}deserialize(e,t=!0){let n=0,i=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=i.readUInt8();if(n++,e!==this.ioc.DataType.DOUBLE)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");const t=i.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<8)throw new Error("unexpected {value} length");n+=8;return{v:i.readDoubleBE(),len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:e})}}}},41831:function(e,t,n){"use strict";const{Buffer:r}=n(55872),i=n(83798);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.EDGE]=this}canBeUsedFor(e){return e instanceof i.Edge}serialize(e,t=!0){if(null==e){if(t)return r.from([this.ioc.DataType.EDGE,1]);const e=[3,0,0,0,0,0],n=[0,0,0,0],i=[3,0,0,0,0,0],o=[0,0,0,0],s=[3,0,0,0,0,0],a=[0,0,0,0],u=[254,1],c=[254,1];return r.from([...e,...n,...i,...o,...s,...a,...u,...c])}const n=[];t&&n.push(r.from([this.ioc.DataType.EDGE,0])),n.push(this.ioc.anySerializer.serialize(e.id)),n.push(this.ioc.stringSerializer.serialize(e.label,!1));const i=e.inV&&e.inV.id;n.push(this.ioc.anySerializer.serialize(i));const o=e.inV&&e.inV.label;n.push(this.ioc.stringSerializer.serialize(o,!1));const s=e.outV&&e.outV.id;n.push(this.ioc.anySerializer.serialize(s));const a=e.outV&&e.outV.label;return n.push(this.ioc.stringSerializer.serialize(a,!1)),n.push(this.ioc.unspecifiedNullSerializer.serialize(null)),n.push(this.ioc.unspecifiedNullSerializer.serialize(null)),r.concat(n)}deserialize(e,t=!0){let n=0,o=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=o.readUInt8();if(n++,e!==this.ioc.DataType.EDGE)throw new Error("unexpected {type_code}");if(o=o.slice(1),o.length<1)throw new Error("{value_flag} is missing");const t=o.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");o=o.slice(1)}let s,a,u,c,l,h,d,f,p,m,g,v,y,b,_;try{({v:s,len:a}=this.ioc.anySerializer.deserialize(o)),n+=a}catch(e){throw e.message="{id}: "+e.message,e}o=o.slice(a);try{({v:u,len:c}=this.ioc.stringSerializer.deserialize(o,!1)),n+=c}catch(e){throw e.message="{label}: "+e.message,e}o=o.slice(c);try{({v:l,len:h}=this.ioc.anySerializer.deserialize(o)),n+=h}catch(e){throw e.message="{inVId}: "+e.message,e}o=o.slice(h);try{({v:d,len:f}=this.ioc.stringSerializer.deserialize(o,!1)),n+=f}catch(e){throw e.message="{inVLabel}: "+e.message,e}o=o.slice(f);try{({v:p,len:m}=this.ioc.anySerializer.deserialize(o)),n+=m}catch(e){throw e.message="{outVId}: "+e.message,e}o=o.slice(m);try{({v:g,len:v}=this.ioc.stringSerializer.deserialize(o,!1)),n+=v}catch(e){throw e.message="{outVLabel}: "+e.message,e}o=o.slice(v);try{({len:y}=this.ioc.anySerializer.deserialize(o)),n+=y}catch(e){throw e.message="{parent}: "+e.message,e}o=o.slice(y);try{({v:b,len:_}=this.ioc.anySerializer.deserialize(o)),n+=_}catch(e){throw e.message="{properties}: "+e.message,e}o=o.slice(_);return{v:new i.Edge(s,new i.Vertex(p,g,null),u,new i.Vertex(l,d,null),b),len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:o,err:e})}}}},45565:function(e,t,n){"use strict";const{Buffer:r}=n(55872),i=n(68327);e.exports=class{constructor(e){this.ioc=e;const t=e=>{const t={};return Object.values(e).forEach((e=>t[e.elementName]=e)),t},n=e.DataType;this.types=[{name:"Barrier",code:n.BARRIER,enum:t(i.barrier)},{name:"Cardinality",code:n.CARDINALITY,enum:t(i.cardinality)},{name:"Column",code:n.COLUMN,enum:t(i.column)},{name:"Direction",code:n.DIRECTION,enum:t(i.direction)},{name:"DT",code:n.DT,enum:t(i.dt)},{name:"Merge",code:n.MERGE,enum:t(i.merge)},{name:"Operator",code:n.OPERATOR,enum:t(i.operator)},{name:"Order",code:n.ORDER,enum:t(i.order)},{name:"Pick",code:n.PICK,enum:t(i.pick)},{name:"Pop",code:n.POP,enum:t(i.pop)},{name:"Scope",code:n.SCOPE,enum:t(i.scope)},{name:"T",code:n.T,enum:t(i.t)}],this.byname={},this.bycode={};for(const e of this.types)this.ioc.serializers[e.code]=this,this.byname[e.name]=e,this.bycode[e.code]=e}canBeUsedFor(e){if(!(e instanceof i.EnumValue))return!1;if(!this.byname[e.typeName])throw new Error(`EnumSerializer.serialize: typeName=${e.typeName} is not supported.`);return!0}serialize(e,t=!0){const n=this.byname[e.typeName];if(void 0===e.elementName||null===e.elementName)return t?r.from([n.code,1]):r.from([this.ioc.DataType.STRING,0,0,0,0,0]);const i=[];return t&&i.push(r.from([n.code,0])),i.push(this.ioc.stringSerializer.serialize(e.elementName,!0)),r.concat(i)}deserialize(e,t=!0){let n=0,o=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");let s,a,u,c;if(t){const e=o.readUInt8();if(n++,s=this.bycode[e],!s)throw new Error(`unexpected {type_code}=${e}`);if(o=o.slice(1),o.length<1)throw new Error("{value_flag} is missing");const t=o.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");o=o.slice(1)}try{({v:a,len:u}=this.ioc.stringSerializer.deserialize(o,!0)),n+=u}catch(e){throw e.message="elementName: "+e.message,e}return o=o.slice(u),c=s?s.enum[a]:new i.EnumValue(void 0,a),{v:c,len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:o,err:e})}}}},43249:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.FLOAT]=this}canBeUsedFor(e){}serialize(e,t=!0){if(null==e)return t?r.from([this.ioc.DataType.FLOAT,1]):r.from([0,0,0,0]);const n=[];t&&n.push(r.from([this.ioc.DataType.FLOAT,0]));const i=r.alloc(4);return i.writeFloatBE(e),n.push(i),r.concat(n)}deserialize(e,t=!0){let n=0,i=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=i.readUInt8();if(n++,e!==this.ioc.DataType.FLOAT)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");const t=i.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<4)throw new Error("unexpected {value} length");n+=4;return{v:i.readFloatBE(),len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:e})}}}},49539:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e){this.ioc=e}readResponse(e){if(null==e)throw new Error("Buffer is missing.");if(!(e instanceof r))throw new Error("Not an instance of Buffer.");if(e.length<1)throw new Error("Buffer is empty.");const t={status:{},result:{}};let n,i=e;const o=i[0];if(129!==o)throw new Error(`Unsupported version '${o}'.`);return i=i.slice(1),({v:t.requestId,len:n}=this.ioc.uuidSerializer.deserialize(i,!1,!0)),i=i.slice(n),({v:t.status.code,len:n}=this.ioc.intSerializer.deserialize(i,!1)),i=i.slice(n),({v:t.status.message,len:n}=this.ioc.stringSerializer.deserialize(i,!1,!0)),i=i.slice(n),({v:t.status.attributes,len:n}=this.ioc.mapSerializer.deserialize(i,!1)),i=i.slice(n),({v:t.result.meta,len:n}=this.ioc.mapSerializer.deserialize(i,!1)),i=i.slice(n),({v:t.result.data}=this.ioc.anySerializer.deserialize(i)),t}}},27259:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e){this.ioc=e}writeRequest({requestId:e,op:t,processor:n,args:i}){const o=[r.from([129]),this.ioc.uuidSerializer.serialize(e,!1),this.ioc.stringSerializer.serialize(t,!1),this.ioc.stringSerializer.serialize(n,!1),this.ioc.mapSerializer.serialize(i,!1)];return r.concat(o)}}},71046:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{get INT32_MIN(){return-2147483648}get INT32_MAX(){return 2147483647}constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.INT]=this}canBeUsedFor(e){return"number"==typeof e&&!(e<this.INT32_MIN||e>this.INT32_MAX)}serialize(e,t=!0){if(null==e)return t?r.from([this.ioc.DataType.INT,1]):r.from([0,0,0,0]);const n=[];t&&n.push(r.from([this.ioc.DataType.INT,0]));const i=r.alloc(4);return i.writeInt32BE(e),n.push(i),r.concat(n)}deserialize(e,t=!0){let n=0,i=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=i.readUInt8();if(n++,e!==this.ioc.DataType.INT)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");const t=i.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<4)throw new Error("unexpected {value} length");n+=4;return{v:i.readInt32BE(),len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:e})}}}},17670:function(e,t,n){"use strict";const{Buffer:r}=n(55872),{valueKey:i,LambdaSerializer:o}=n(59859);e.exports=class{constructor(e){this.ioc=e,this.graphsonLambdaSerializer=new o}canBeUsedFor(e){return this.graphsonLambdaSerializer.canBeUsedFor(e)}serialize(e,t=!0){if(null==e){if(t)return r.from([this.ioc.DataType.LAMBDA,1]);const e=[0,0,0,0],n=[0,0,0,0],i=[0,0,0,0];return r.from([...e,...n,...i])}const n=[];t&&n.push(r.from([this.ioc.DataType.LAMBDA,0]));const o=this.graphsonLambdaSerializer.serialize(e),s=o[i].language,a=o[i].script,u=o[i].arguments;return n.push(this.ioc.stringSerializer.serialize(s,!1)),n.push(this.ioc.stringSerializer.serialize(a,!1)),n.push(this.ioc.intSerializer.serialize(u,!1)),r.concat(n)}}},83306:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.LONG]=this}canBeUsedFor(){}serialize(e,t=!0){if(null==e)return t?r.from([this.ioc.DataType.LONG,1]):r.from([0,0,0,0,0,0,0,0]);const n=[];t&&n.push(r.from([this.ioc.DataType.LONG,0]));const i=r.alloc(8);return i.writeBigInt64BE(BigInt(e)),n.push(i),r.concat(n)}deserialize(e,t=!0){let n=0,i=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=i.readUInt8();if(n++,e!==this.ioc.DataType.LONG)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");const t=i.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<8)throw new Error("unexpected {value} length");n+=8;let o=i.readBigInt64BE();return o=o<Number.MIN_SAFE_INTEGER||o>Number.MAX_SAFE_INTEGER?parseFloat(o.toString()):Number(o),{v:o,len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:e})}}}},12802:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e){this.ioc=e}canBeUsedFor(){}serialize(e,t=!0){if(null==e)return t?r.from([this.ioc.DataType.LONG,1]):r.from([0,0,0,0,0,0,0,0]);const n=[];t&&n.push(r.from([this.ioc.DataType.LONG,0]));const i=r.alloc(8);return i.writeBigInt64BE(BigInt(e)),n.push(i),r.concat(n)}deserialize(e,t=!0){let n=0,i=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=i.readUInt8();if(n++,e!==this.ioc.DataType.LONG)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");const t=i.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<8)throw new Error("unexpected {value} length");n+=8;return{v:i.readBigInt64BE(),len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:e})}}}},16915:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.MAP]=this}canBeUsedFor(e){return null!=e&&(e instanceof Map||!Array.isArray(e)&&"object"==typeof e)}serialize(e,t=!0){if(null==e)return t?r.from([this.ioc.DataType.MAP,1]):this.ioc.intSerializer.serialize(0,!1);const n=e instanceof Map,i=n?Array.from(e.keys()):Object.keys(e);let o=i.length;o<0?o=0:o>this.ioc.intSerializer.INT32_MAX&&(o=this.ioc.intSerializer.INT32_MAX);const s=[];t&&s.push(r.from([this.ioc.DataType.MAP,0])),s.push(this.ioc.intSerializer.serialize(o,!1));for(let t=0;t<o;t++){const r=i[t],o=n?e.get(r):e[r];s.push(this.ioc.anySerializer.serialize(r),this.ioc.anySerializer.serialize(o))}return r.concat(s)}deserialize(e,t=!0){let n=0,i=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=i.readUInt8();if(n++,e!==this.ioc.DataType.MAP)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");const t=i.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");i=i.slice(1)}let o,s;try{({v:o,len:s}=this.ioc.intSerializer.deserialize(i,!1)),n+=s}catch(e){throw e.message="{length}: "+e.message,e}if(o<0)throw new Error("{length} is less than zero");i=i.slice(s);const a=new Map;for(let e=0;e<o;e++){let t,r,o,s;try{({v:t,len:r}=this.ioc.anySerializer.deserialize(i)),n+=r}catch(t){throw t.message=`{item_${e}} key: `+t.message,t}i=i.slice(r);try{({v:o,len:s}=this.ioc.anySerializer.deserialize(i)),n+=s}catch(t){throw t.message=`{item_${e}} value: `+t.message,t}i=i.slice(s),a.set(t,o)}return{v:a,len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:e})}}}},99871:function(e){"use strict";e.exports=class{constructor(e){this.ioc=e}canBeUsedFor(e){return!(!Number.isNaN(e)&&e!==Number.POSITIVE_INFINITY&&e!==Number.NEGATIVE_INFINITY)||("number"==typeof e||"bigint"==typeof e)}serialize(e,t=!0){return"number"==typeof e?Number.isNaN(e)||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY||!Number.isInteger(e)?this.ioc.doubleSerializer.serialize(e,t):e>=-2147483648&&e<=2147483647?this.ioc.intSerializer.serialize(e,t):this.ioc.longSerializer.serialize(e,t):"bigint"==typeof e?this.ioc.bigIntegerSerializer.serialize(e,t):void 0}}},52635:function(e,t,n){"use strict";const{Buffer:r}=n(55872),i=n(68327);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.P]=this}canBeUsedFor(e){return e instanceof i.P}serialize(e,t=!0){if(null==e){if(t)return r.from([this.ioc.DataType.P,1]);const e=[0,0,0,0],n=[0,0,0,0];return r.from([...e,...n])}const n=[];let i;return t&&n.push(r.from([this.ioc.DataType.P,0])),n.push(this.ioc.stringSerializer.serialize(e.operator,!1)),i=void 0===e.other||null===e.other?Array.isArray(e.value)?e.value:[e.value]:[e.value,e.other],n.push(this.ioc.listSerializer.serialize(i,!1)),r.concat(n)}deserialize(e,t=!0){let n=0,o=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=o.readUInt8();if(n++,e!==this.ioc.DataType.P)throw new Error("unexpected {type_code}");if(o=o.slice(1),o.length<1)throw new Error("{value_flag} is missing");const t=o.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");o=o.slice(1)}let s,a,u,c,l;try{({v:s,len:a}=this.ioc.stringSerializer.deserialize(o,!1)),n+=a}catch(e){throw e.message="{name}: "+e.message,e}o=o.slice(a);try{({v:u,len:c}=this.ioc.listSerializer.deserialize(o,!1)),n+=c}catch(e){throw e.message="{values}: "+e.message,e}if(o=o.slice(c),u.length<1)return{v:new i.P(""),len:n};const h=i.P[s];return l="function"==typeof h?h(...u):new i.P(s,...u),{v:l,len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:o,err:e})}}}},19130:function(e,t,n){"use strict";const{Buffer:r}=n(55872),i=n(83798);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.PATH]=this}canBeUsedFor(e){return e instanceof i.Path}serialize(e,t=!0){if(null==e)return t?r.from([this.ioc.DataType.PATH,1]):r.concat([this.ioc.listSerializer.serialize([]),this.ioc.listSerializer.serialize([])]);const n=[];return t&&n.push(r.from([this.ioc.DataType.PATH,0])),n.push(this.ioc.listSerializer.serialize(e.labels)),n.push(this.ioc.listSerializer.serialize(e.objects)),r.concat(n)}deserialize(e,t=!0){let n=0,o=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=o.readUInt8();if(n++,e!==this.ioc.DataType.PATH)throw new Error("unexpected {type_code}");if(o=o.slice(1),o.length<1)throw new Error("{value_flag} is missing");const t=o.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");o=o.slice(1)}let s,a,u,c;try{({v:s,len:a}=this.ioc.listSerializer.deserialize(o)),n+=a}catch(e){throw e.message="{labels}: "+e.message,e}o=o.slice(a);try{({v:u,len:c}=this.ioc.listSerializer.deserialize(o)),n+=c}catch(e){throw e.message="{objects}: "+e.message,e}o=o.slice(c);return{v:new i.Path(s,u),len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:o,err:e})}}}},80595:function(e,t,n){"use strict";const{Buffer:r}=n(55872),i=n(83798);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.PROPERTY]=this}canBeUsedFor(e){return e instanceof i.Property}serialize(e,t=!0){if(null==e)return t?r.from([this.ioc.DataType.PROPERTY,1]):r.concat([this.ioc.stringSerializer.serialize("",!1),this.ioc.unspecifiedNullSerializer.serialize(null),this.ioc.unspecifiedNullSerializer.serialize(null)]);const n=[];return t&&n.push(r.from([this.ioc.DataType.PROPERTY,0])),n.push(this.ioc.stringSerializer.serialize(e.key,!1)),n.push(this.ioc.anySerializer.serialize(e.value)),n.push(this.ioc.unspecifiedNullSerializer.serialize(null)),r.concat(n)}deserialize(e,t=!0){let n=0,o=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=o.readUInt8();if(n++,e!==this.ioc.DataType.PROPERTY)throw new Error("unexpected {type_code}");if(o=o.slice(1),o.length<1)throw new Error("{value_flag} is missing");const t=o.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");o=o.slice(1)}let s,a,u,c,l;try{({v:s,len:a}=this.ioc.stringSerializer.deserialize(o,!1)),n+=a}catch(e){throw e.message="{key}: "+e.message,e}o=o.slice(a);try{({v:u,len:c}=this.ioc.anySerializer.deserialize(o)),n+=c}catch(e){throw e.message="{value}: "+e.message,e}o=o.slice(c);try{({len:l}=this.ioc.unspecifiedNullSerializer.deserialize(o)),n+=l}catch(e){throw e.message="{parent}: "+e.message,e}o=o.slice(l);return{v:new i.Property(s,u),len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:o,err:e})}}}},534:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e,t){this.ioc=e,this.ID=t,this.ioc.serializers[t]=this}canBeUsedFor(e){return e instanceof Set}serialize(e,t=!0){throw new Error("serialize() method not implemented for SetSerializer")}deserialize(e,t=!0){let n=0,i=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=i.readUInt8();if(n++,e!==this.ID)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");const t=i.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");i=i.slice(1)}let o,s;try{({v:o,len:s}=this.ioc.intSerializer.deserialize(i,!1)),n+=s}catch(e){throw e.message="{length}: "+e.message,e}if(o<0)throw new Error("{length} is less than zero");i=i.slice(s);const a=new Set;for(let e=0;e<o;e++){let t,r;try{({v:t,len:r}=this.ioc.anySerializer.deserialize(i)),n+=r}catch(t){throw t.message=`{item_${e}}: `+t.message,t}i=i.slice(r),a.add(t)}return{v:a,len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:e})}}}},35392:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.SHORT]=this}canBeUsedFor(e){}serialize(e,t=!0){if(null==e)return t?r.from([this.ioc.DataType.SHORT,1]):r.from([0,0]);const n=[];t&&n.push(r.from([this.ioc.DataType.SHORT,0]));const i=r.alloc(2);return i.writeInt16BE(e),n.push(i),r.concat(n)}deserialize(e,t=!0){let n=0,i=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=i.readUInt8();if(n++,e!==this.ioc.DataType.SHORT)throw new Error("unexpected {type_code}");if(i=i.slice(1),i.length<1)throw new Error("{value_flag} is missing");const t=i.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");i=i.slice(1)}if(i.length<2)throw new Error("unexpected {value} length");n+=2;return{v:i.readInt16BE(),len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:i,err:e})}}}},99777:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e,t){this.ioc=e,this.ID=t,this.ioc.serializers[t]=this}canBeUsedFor(e){return"string"==typeof e}serialize(e,t=!0){if(null==e)return t?r.from([this.ID,1]):this.ioc.intSerializer.serialize(0,!1);const n=[];t&&n.push(r.from([this.ID,0]));const i=r.from(String(e),"utf8");return n.push(this.ioc.intSerializer.serialize(i.length,!1)),n.push(i),r.concat(n)}deserialize(e,t=!0,n=!1){let i=0,o=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=o.readUInt8();if(i++,e!==this.ID)throw new Error("unexpected {type_code}");o=o.slice(1)}if(t||n){if(o.length<1)throw new Error("{value_flag} is missing");const e=o.readUInt8();if(i++,1===e)return{v:null,len:i};if(0!==e)throw new Error("unexpected {value_flag}");o=o.slice(1)}let s,a;try{({v:s,len:a}=this.ioc.intSerializer.deserialize(o,!1)),i+=a}catch(e){throw e.message="{length}: "+e.message,e}if(s<0)throw new Error("{length} is less than zero");if(o=o.slice(a),o.length<s)throw new Error("unexpected {text_value} length");i+=s;return{v:o.toString("utf8",0,s),len:i}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:o,err:e})}}}},78964:function(e,t,n){"use strict";const{Buffer:r}=n(55872),i=n(68327);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.TEXTP]=this}canBeUsedFor(e){return e instanceof i.TextP}serialize(e,t=!0){if(null==e){if(t)return r.from([this.ioc.DataType.TEXTP,1]);const e=[0,0,0,0],n=[0,0,0,0];return r.from([...e,...n])}const n=[];let i;return t&&n.push(r.from([this.ioc.DataType.TEXTP,0])),n.push(this.ioc.stringSerializer.serialize(e.operator,!1)),i=void 0===e.other||null===e.other?Array.isArray(e.value)?e.value:[e.value]:[e.value,e.other],n.push(this.ioc.listSerializer.serialize(i,!1)),r.concat(n)}deserialize(e,t=!0){let n=0,o=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=o.readUInt8();if(n++,e!==this.ioc.DataType.TEXTP)throw new Error("unexpected {type_code}");if(o=o.slice(1),o.length<1)throw new Error("{value_flag} is missing");const t=o.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");o=o.slice(1)}let s,a,u,c,l;try{({v:s,len:a}=this.ioc.stringSerializer.deserialize(o,!1)),n+=a}catch(e){throw e.message="{name}: "+e.message,e}o=o.slice(a);try{({v:u,len:c}=this.ioc.listSerializer.deserialize(o,!1)),n+=c}catch(e){throw e.message="{values}: "+e.message,e}if(o=o.slice(c),u.length<1)return{v:new i.TextP(""),len:n};const h=i.TextP[s];return l="function"==typeof h?h(...u):new i.TextP(s,...u),{v:l,len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:o,err:e})}}}},73088:function(e,t,n){"use strict";const{Buffer:r}=n(55872),{TraversalStrategySerializer:i}=n(59859);e.exports=class{constructor(e){this.ioc=e,this.graphsonTraversalStrategySerializer=new i}canBeUsedFor(e){return this.graphsonTraversalStrategySerializer.canBeUsedFor(e)}serialize(e,t=!0){if(null==e){if(t)return r.from([this.ioc.DataType.TRAVERSALSTRATEGY,1]);const e=[0,0,0,0],n=[0,0,0,0];return r.from([...e,...n])}const n=[];t&&n.push(r.from([this.ioc.DataType.TRAVERSALSTRATEGY,0]));const i=e.fqcn,o={};for(const t in e.configuration)e.configuration.hasOwnProperty(t)&&(o[t]=e.configuration[t]);return n.push(this.ioc.classSerializer.serialize(i,!1)),n.push(this.ioc.mapSerializer.serialize(o,!1)),r.concat(n)}}},97126:function(e,t,n){"use strict";const{Buffer:r}=n(55872),i=n(68327);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.TRAVERSER]=this}canBeUsedFor(e){return e instanceof i.Traverser}serialize(e,t=!0){if(null==e){if(t)return r.from([this.ioc.DataType.TRAVERSER,1]);const e=[0,0,0,0,0,0,0,1],n=[254,1];return r.from([...e,...n])}const n=[];return t&&n.push(r.from([this.ioc.DataType.TRAVERSER,0])),n.push(this.ioc.longSerializer.serialize(e.bulk,!1)),n.push(this.ioc.anySerializer.serialize(e.object)),r.concat(n)}deserialize(e,t=!0){let n=0,o=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=o.readUInt8();if(n++,e!==this.ioc.DataType.TRAVERSER)throw new Error("unexpected {type_code}");if(o=o.slice(1),o.length<1)throw new Error("{value_flag} is missing");const t=o.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");o=o.slice(1)}let s,a,u,c;try{({v:s,len:a}=this.ioc.longSerializer.deserialize(o,!1)),n+=a}catch(e){throw e.message="{bulk}: "+e.message,e}if(s<0)throw new Error("{bulk} is less than zero");o=o.slice(a);try{({v:u,len:c}=this.ioc.anySerializer.deserialize(o)),n+=c}catch(e){throw e.message="{value}: "+e.message,e}o=o.slice(c);return{v:new i.Traverser(u,s),len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:o,err:e})}}}},56878:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.UNSPECIFIED_NULL]=this}canBeUsedFor(e){return null==e}serialize(e){return r.from([this.ioc.DataType.UNSPECIFIED_NULL,1])}deserialize(e){let t=0,n=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");const i=n.readUInt8();if(t++,i!==this.ioc.DataType.UNSPECIFIED_NULL)throw new Error("unexpected {type_code}");if(n=n.slice(1),n.length<1)throw new Error("{value_flag} is missing");const o=n.readUInt8();if(t++,1!==o)throw new Error("unexpected {value_flag}");return n=n.slice(1),{v:null,len:t}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:n,err:e})}}}},47417:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.UUID]=this}canBeUsedFor(e){}serialize(e,t=!0){if(null==e)return t?r.from([this.ioc.DataType.UUID,1]):r.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);const n=String(e).replace(/^urn:uuid:/,"").replace(/[{}-]/g,""),i=[];t&&i.push(r.from([this.ioc.DataType.UUID,0]));const o=r.alloc(16,0);for(let e=0;e<16&&2*e<n.length;e++)o[e]=parseInt(n.slice(2*e,2*e+2),16);return i.push(o),r.concat(i)}deserialize(e,t=!0,n=!1){let i=0,o=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=o.readUInt8();if(i++,e!==this.ioc.DataType.UUID)throw new Error("unexpected {type_code}");o=o.slice(1)}if(t||n){if(o.length<1)throw new Error("{value_flag} is missing");const e=o.readUInt8();if(i++,1===e)return{v:null,len:i};if(0!==e)throw new Error("unexpected {value_flag}");o=o.slice(1)}if(o.length<16)throw new Error("unexpected {value} length");i+=16;return{v:o.slice(0,4).toString("hex")+"-"+o.slice(4,6).toString("hex")+"-"+o.slice(6,8).toString("hex")+"-"+o.slice(8,10).toString("hex")+"-"+o.slice(10,16).toString("hex"),len:i}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:o,err:e})}}}},2041:function(e,t,n){"use strict";const{Buffer:r}=n(55872),i=n(83798);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.VERTEXPROPERTY]=this}canBeUsedFor(e){return e instanceof i.VertexProperty}serialize(e,t=!0){if(null==e)return t?r.from([this.ioc.DataType.VERTEXPROPERTY,1]):r.concat([this.ioc.unspecifiedNullSerializer.serialize(null),this.ioc.stringSerializer.serialize("",!1),this.ioc.unspecifiedNullSerializer.serialize(null),this.ioc.unspecifiedNullSerializer.serialize(null),this.ioc.unspecifiedNullSerializer.serialize(null)]);const n=[];return t&&n.push(r.from([this.ioc.DataType.VERTEXPROPERTY,0])),n.push(this.ioc.anySerializer.serialize(e.id)),n.push(this.ioc.stringSerializer.serialize(e.label,!1)),n.push(this.ioc.anySerializer.serialize(e.value)),n.push(this.ioc.unspecifiedNullSerializer.serialize(null)),n.push(this.ioc.anySerializer.serialize(e.properties)),r.concat(n)}deserialize(e,t=!0){let n=0,o=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=o.readUInt8();if(n++,e!==this.ioc.DataType.VERTEXPROPERTY)throw new Error("unexpected {type_code}");if(o=o.slice(1),o.length<1)throw new Error("{value_flag} is missing");const t=o.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");o=o.slice(1)}let s,a,u,c,l,h,d,f,p;try{({v:s,len:a}=this.ioc.anySerializer.deserialize(o)),n+=a}catch(e){throw e.message="{id}: "+e.message,e}o=o.slice(a);try{({v:u,len:c}=this.ioc.stringSerializer.deserialize(o,!1)),n+=c}catch(e){throw e.message="{label}: "+e.message,e}o=o.slice(c);try{({v:l,len:h}=this.ioc.anySerializer.deserialize(o)),n+=h}catch(e){throw e.message="{value}: "+e.message,e}o=o.slice(h);try{({len:d}=this.ioc.unspecifiedNullSerializer.deserialize(o)),n+=d}catch(e){throw e.message="{parent}: "+e.message,e}o=o.slice(d);try{({v:f,len:p}=this.ioc.anySerializer.deserialize(o)),n+=p}catch(e){throw e.message="{properties}: "+e.message,e}o=o.slice(p);return{v:new i.VertexProperty(s,u,l,f),len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:o,err:e})}}}},83299:function(e,t,n){"use strict";const{Buffer:r}=n(55872),i=n(83798);e.exports=class{constructor(e){this.ioc=e,this.ioc.serializers[e.DataType.VERTEX]=this}canBeUsedFor(e){return e instanceof i.Vertex}serialize(e,t=!0){if(null==e){if(t)return r.from([this.ioc.DataType.VERTEX,1]);const e=[3,0,0,0,0,0],n=[0,0,0,0],i=[254,1];return r.from([...e,...n,...i])}const n=[];return t&&n.push(r.from([this.ioc.DataType.VERTEX,0])),n.push(this.ioc.anySerializer.serialize(e.id)),n.push(this.ioc.stringSerializer.serialize(e.label,!1)),n.push(this.ioc.anySerializer.serialize(e.properties)),r.concat(n)}deserialize(e,t=!0){let n=0,o=e;try{if(null==e||!(e instanceof r))throw new Error("buffer is missing");if(e.length<1)throw new Error("buffer is empty");if(t){const e=o.readUInt8();if(n++,e!==this.ioc.DataType.VERTEX)throw new Error("unexpected {type_code}");if(o=o.slice(1),o.length<1)throw new Error("{value_flag} is missing");const t=o.readUInt8();if(n++,1===t)return{v:null,len:n};if(0!==t)throw new Error("unexpected {value_flag}");o=o.slice(1)}let s,a,u,c,l,h;try{({v:s,len:a}=this.ioc.anySerializer.deserialize(o)),n+=a}catch(e){throw e.message="{id}: "+e.message,e}o=o.slice(a);try{({v:u,len:c}=this.ioc.stringSerializer.deserialize(o,!1)),n+=c}catch(e){throw e.message="{label}: "+e.message,e}o=o.slice(c);try{({v:l,len:h}=this.ioc.anySerializer.deserialize(o)),n+=h}catch(e){throw e.message="{properties}: "+e.message,e}o=o.slice(h);return{v:new i.Vertex(s,u,l),len:n}}catch(e){throw this.ioc.utils.des_error({serializer:this,args:arguments,cursor:o,err:e})}}}},19785:function(e,t,n){"use strict";const{Buffer:r}=n(55872);e.exports={des_error:({serializer:e,args:t,cursor:n,err:i})=>{void 0===n&&(n=t[0]);let o="";n instanceof r&&(n.length>32&&(o="..."),n=n.slice(0,32).toString("hex"));const s=t[1],a=t[2];let u=`${e.constructor.name}.deserialize(cursor=${n}${o}`;return void 0!==s&&(u+=`, fullyQualifiedFormat=${s}`),void 0!==a&&(u+=`, nullable=${a}`),u+=`): ${i.message.replace(/\.$/,"")}.`,i.message=u,i}}},10747:function(e,t,n){"use strict";const{Buffer:r}=n(55872),i=n(59859),o=n(75684),s=n(38023);class a{constructor(e){this._options=e||{},this._serializers=this.getDefaultSerializers().map((e=>{const t=new e;return t.writer=this,t}));const t=this._options.serializers||{};Object.keys(t).forEach((e=>{const n=t[e];n.serialize&&(n.writer=this,this._serializers.unshift(n))}))}getDefaultSerializers(){return f}adaptObject(e){let t;for(let n=0;n<this._serializers.length;n++){const r=this._serializers[n];if(r.canBeUsedFor&&r.canBeUsedFor(e)){t=r;break}}return t?t.serialize(e):Array.isArray(e)?e.map((e=>this.adaptObject(e))):e}write(e){return JSON.stringify(this.adaptObject(e))}writeRequest({requestId:e,op:t,processor:n,args:i}){const s={requestId:{"@type":"g:UUID","@value":e},op:t,processor:n,args:this._adaptArgs(i,!0)};return s.args.gremlin instanceof o&&(s.args.gremlin=this.adaptObject(s.args.gremlin)),r.from(JSON.stringify(s))}_adaptArgs(e,t){if(e instanceof Object){const n={};return Object.keys(e).forEach((r=>{n[r]=t&&"bindings"===r?this._adaptArgs(e[r],!1):this.adaptObject(e[r])})),n}return e}}class u extends a{getDefaultSerializers(){return p}}class c{constructor(e){this._options=e||{},this._deserializers={};const t=this.getDefaultDeserializers();if(Object.keys(t).forEach((e=>{const n=new(0,t[e]);n.reader=this,this._deserializers[e]=n})),this._options.serializers){const e=this._options.serializers||{};Object.keys(e).forEach((t=>{const n=e[t];n.deserialize&&(n.reader=this,this._deserializers[t]=n)}))}}getDefaultDeserializers(){return h}read(e){if(void 0===e)return;if(null===e)return null;if(Array.isArray(e))return e.map((e=>this.read(e)));const t=e[i.typeKey];if(t){const n=this._deserializers[t];return n?n.deserialize(e):e[i.valueKey]}return e&&"object"==typeof e?this._deserializeObject(e):e}readResponse(e){return this.read(s.parse(e.toString()))}_deserializeObject(e){const t=Object.keys(e),n={};for(let r=0;r<t.length;r++)n[t[r]]=this.read(e[t[r]]);return n}}class l extends c{getDefaultDeserializers(){return d}}const h={"g:Traverser":i.TraverserSerializer,"g:TraversalStrategy":i.TraversalStrategySerializer,"g:Int32":i.NumberSerializer,"g:Int64":i.BigNumberSerializer,"g:Float":i.NumberSerializer,"g:Double":i.NumberSerializer,"g:Date":i.DateSerializer,"g:Direction":i.DirectionSerializer,"g:Vertex":i.VertexSerializer,"g:Edge":i.EdgeSerializer,"g:VertexProperty":i.VertexPropertySerializer,"g:Property":i.PropertySerializer,"g:Path":i.Path3Serializer,"g:TextP":i.TextPSerializer,"g:T":i.TSerializer,"g:BulkSet":i.BulkSetSerializer},d=Object.assign({},h,{"g:List":i.ListSerializer,"g:Set":i.SetSerializer,"g:Map":i.MapSerializer}),f=[i.NumberSerializer,i.DateSerializer,i.BytecodeSerializer,i.TraverserSerializer,i.TraversalStrategySerializer,i.PSerializer,i.TextPSerializer,i.LambdaSerializer,i.EnumSerializer,i.VertexSerializer,i.EdgeSerializer,i.LongSerializer],p=f.concat([i.ListSerializer,i.SetSerializer,i.MapSerializer]);e.exports={GraphSON3Writer:u,GraphSON3Reader:l,GraphSON2Writer:a,GraphSON2Reader:c,GraphSONWriter:u,GraphSONReader:l}},59859:function(e,t,n){"use strict";const r=n(68327),i=n(99780),o=n(75684),s=n(83798),a=n(13837),u=n(21679),c="@value",l="@type";class h{serialize(){throw new Error("serialize() method not implemented for "+this.constructor.name)}deserialize(){throw new Error("deserialize() method not implemented for "+this.constructor.name)}canBeUsedFor(){throw new Error("canBeUsedFor() method not implemented for "+this.constructor.name)}}class d extends h{constructor(e){super(),this.typeKey=e}deserialize(e){const t=e[c];if(!Array.isArray(t))throw new Error("Expected Array, obtained: "+t);return t.map((e=>this.reader.read(e)))}serialize(e){return{[l]:this.typeKey,[c]:e.map((e=>this.writer.adaptObject(e)))}}canBeUsedFor(e){return Array.isArray(e)}}e.exports={BulkSetSerializer:class extends h{deserialize(e){const t=e[c];if(!Array.isArray(t))throw new Error("Expected Array, obtained: "+t);let n=[];for(let e=0,r=t.length;e<r;e+=2){const r=t.slice(e,e+2);n=n.concat(Array(this.reader.read(r[1])).fill(this.reader.read(r[0])))}return n}},BytecodeSerializer:class extends h{serialize(e){let t=e;e instanceof r.Traversal&&(t=e.getBytecode());const n={};n[l]="g:Bytecode";const i=n[c]={},o=this._serializeInstructions(t.sourceInstructions);o&&(i.source=o);const s=this._serializeInstructions(t.stepInstructions);return s&&(i.step=s),n}_serializeInstructions(e){if(0===e.length)return null;const t=new Array(e.length);t[0]=e[0];for(let n=0;n<e.length;n++)t[n]=e[n].map((e=>this.writer.adaptObject(e)));return t}canBeUsedFor(e){return e instanceof o||e instanceof r.Traversal}},DateSerializer:class extends h{serialize(e){return{[l]:"g:Date",[c]:e.getTime()}}deserialize(e){return new Date(e[c])}canBeUsedFor(e){return e instanceof Date}},BigNumberSerializer:class extends h{serialize(e){return isNaN(e)?{[l]:"g:Double",[c]:"NaN"}:e===Number.POSITIVE_INFINITY?{[l]:"g:Double",[c]:"Infinity"}:e===Number.NEGATIVE_INFINITY?{[l]:"g:Double",[c]:"-Infinity"}:e}deserialize(e){return e[c]}canBeUsedFor(e){return e instanceof u}},DirectionSerializer:class extends h{deserialize(e){return r.direction[e[c].toLowerCase()]}},EdgeSerializer:class extends h{deserialize(e){const t=e[c];return new s.Edge(this.reader.read(t.id),new s.Vertex(this.reader.read(t.outV),this.reader.read(t.outVLabel)),t.label,new s.Vertex(this.reader.read(t.inV),this.reader.read(t.inVLabel)),this.reader.read(t.properties))}serialize(e){return{[l]:"g:Edge",[c]:{id:this.writer.adaptObject(e.id),label:e.label,outV:this.writer.adaptObject(e.outV.id),outVLabel:e.outV.label,inV:this.writer.adaptObject(e.inV.id),inVLabel:e.inV.label}}}canBeUsedFor(e){return e instanceof s.Edge}},EnumSerializer:class extends h{serialize(e){return{[l]:"g:"+e.typeName,[c]:e.elementName}}canBeUsedFor(e){return e&&e.typeName&&e instanceof r.EnumValue}},LambdaSerializer:class extends h{serialize(e){const t=e(),n="string"==typeof t,r=n?t:t[0],i=n?"gremlin-groovy":t[1],o="gremlin-groovy"===i&&r.includes("->")?r.substring(0,r.indexOf("->")).includes(",")?2:1:-1;return{[l]:"g:Lambda",[c]:{arguments:o,language:i,script:r}}}canBeUsedFor(e){return"function"==typeof e}},ListSerializer:class extends d{constructor(){super("g:List")}},LongSerializer:class extends h{serialize(e){return{[l]:"g:Int64",[c]:e.value}}canBeUsedFor(e){return e instanceof a.Long}},MapSerializer:class extends h{deserialize(e){const t=e[c];if(!Array.isArray(t))throw new Error("Expected Array, obtained: "+t);const n=new Map;for(let e=0;e<t.length;e+=2)n.set(this.reader.read(t[e]),this.reader.read(t[e+1]));return n}serialize(e){const t=[];return e.forEach(((e,n)=>{t.push(this.writer.adaptObject(n)),t.push(this.writer.adaptObject(e))})),{[l]:"g:Map",[c]:t}}canBeUsedFor(e){return e instanceof Map}},NumberSerializer:class extends h{serialize(e){return isNaN(e)?{[l]:"g:Double",[c]:"NaN"}:e===Number.POSITIVE_INFINITY?{[l]:"g:Double",[c]:"Infinity"}:e===Number.NEGATIVE_INFINITY?{[l]:"g:Double",[c]:"-Infinity"}:e}deserialize(e){const t=e[c];return"NaN"===t?NaN:"Infinity"===t?Number.POSITIVE_INFINITY:"-Infinity"===t?Number.NEGATIVE_INFINITY:parseFloat(t)}canBeUsedFor(e){return"number"==typeof e}},Path3Serializer:class extends h{deserialize(e){const t=e[c];return new s.Path(this.reader.read(t.labels),this.reader.read(t.objects))}},PathSerializer:class extends h{deserialize(e){const t=e[c],n=t.objects.map((e=>this.reader.read(e)));return new s.Path(this.reader.read(t.labels),n)}},PropertySerializer:class extends h{deserialize(e){const t=e[c];return new s.Property(t.key,this.reader.read(t.value))}},PSerializer:class extends h{serialize(e){const t={};t[l]="g:P";const n=t[c]={predicate:e.operator};return void 0===e.other||null===e.other?n.value=this.writer.adaptObject(e.value):n.value=[this.writer.adaptObject(e.value),this.writer.adaptObject(e.other)],t}canBeUsedFor(e){return e instanceof r.P}},TextPSerializer:class extends h{serialize(e){const t={};t[l]="g:TextP";const n=t[c]={predicate:e.operator};return void 0===e.other||null===e.other?n.value=this.writer.adaptObject(e.value):n.value=[this.writer.adaptObject(e.value),this.writer.adaptObject(e.other)],t}canBeUsedFor(e){return e instanceof r.TextP}},SetSerializer:class extends d{constructor(){super("g:Set")}deserialize(e){return new Set(super.deserialize(e))}},TSerializer:class extends h{deserialize(e){return r.t[e[c]]}},TraverserSerializer:class extends h{serialize(e){return{[l]:"g:Traverser",[c]:{value:this.writer.adaptObject(e.object),bulk:this.writer.adaptObject(e.bulk)}}}deserialize(e){const t=e[c];return new r.Traverser(this.reader.read(t.value),this.reader.read(t.bulk))}canBeUsedFor(e){return e instanceof r.Traverser}},TraversalStrategySerializer:class extends h{serialize(e){const t={};for(const n in e.configuration)e.configuration.hasOwnProperty(n)&&(t[n]=this.writer.adaptObject(e.configuration[n]));return{[l]:"g:"+e.constructor.name,[c]:t}}canBeUsedFor(e){return e instanceof i.TraversalStrategy}},typeKey:l,valueKey:c,VertexPropertySerializer:class extends h{deserialize(e){const t=e[c];return new s.VertexProperty(this.reader.read(t.id),t.label,this.reader.read(t.value),this.reader.read(t.properties))}},VertexSerializer:class extends h{deserialize(e){const t=e[c];return new s.Vertex(this.reader.read(t.id),t.label,this.reader.read(t.properties))}serialize(e){return{[l]:"g:Vertex",[c]:{id:this.writer.adaptObject(e.id),label:e.label}}}canBeUsedFor(e){return e instanceof s.Vertex}}}},13837:function(e,t,n){"use strict";var r=n(14224);const i=n(15006);t.toLong=function(e){return new o(e)};const o=t.Long=function(e){if("string"!=typeof e&&"number"!=typeof e)throw new TypeError("The value must be a string or a number");this.value=e.toString()};t.getUuid=function(){return i.v4()},t.emptyArray=Object.freeze([]);class s extends Map{constructor(e){super(e)}set(){return this}delete(){return!1}clear(){}}t.ImmutableMap=s,t.getUserAgentHeader=function(){return"User-Agent"},t.getUserAgent=async()=>"navigator"in globalThis?globalThis.navigator.userAgent:void 0!==r?.versions?.node?await async function(){const e=await Promise.resolve().then(n.t.bind(n,95941,23)),t=({NODE_ENV:"production",PUBLIC_PATH:"/portal/"}.npm_package_name??"NotAvailable").replace("_"," ");let i,o,s,a;return i=o=s=a="NotAvailable",null!=r&&(r.version&&(i=r.version.replace(" ","_")),r.arch&&(a=r.arch.replace(" ","_"))),null!=e&&(o=e.platform().replace(" ","_"),s=e.release().replace(" ","_")),`${t} Gremlin-Javascript.4.0.0-SNAPSHOT ${i} ${o}.${s} ${a}`}():void 0;t.toArrayBuffer=e=>e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);e.exports.DeferredPromise=()=>{let e=e=>{},t=e=>{};const n=new Promise(((n,r)=>{e=n,t=r}));return Object.assign(n,{resolve:e,reject:t})}},20366:function(e){"use strict";var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0,n=t.AbortController,r=t.AbortSignal;e.exports=n,e.exports.AbortSignal=r,e.exports.default=n},69272:function(e,t,n){"use strict";var r,i=n(31759).default,o=n(69153).SymbolDispose,s=n(61714),a=s.AbortError,u=s.codes,c=n(39033),l=c.isNodeStream,h=c.isWebStream,d=c.kControllerErrorFunction,f=n(42415),p=u.ERR_INVALID_ARG_TYPE;e.exports.addAbortSignal=function(t,n){if(function(e,t){if("object"!==i(e)||!("aborted"in e))throw new p(t,"AbortSignal",e)}(t,"signal"),!l(n)&&!h(n))throw new p("stream",["ReadableStream","WritableStream","Stream"],n);return e.exports.addAbortSignalNoValidate(t,n)},e.exports.addAbortSignalNoValidate=function(e,t){if("object"!==i(e)||!("aborted"in e))return t;var s=l(t)?function(){t.destroy(new a(void 0,{cause:e.reason}))}:function(){t[d](new a(void 0,{cause:e.reason}))};if(e.aborted)s();else{var u=(r=r||n(61601).addAbortListener)(e,s);f(t,u[o])}return t}},33558:function(e,t,n){"use strict";var r=n(26068).default,i=n(90228).default,o=n(25298).default,s=n(17069).default,a=n(69153),u=a.StringPrototypeSlice,c=a.SymbolIterator,l=a.TypedArrayPrototypeSet,h=a.Uint8Array,d=n(55872).Buffer,f=n(61601).inspect;e.exports=function(e){function t(){o(this,t),this.head=null,this.tail=null,this.length=0}return s(t,[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;null!==(t=t.next);)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return d.alloc(0);for(var t=d.allocUnsafe(e>>>0),n=this.head,r=0;n;)l(t,n.data,r),r+=n.data.length,n=n.next;return t}},{key:"consume",value:function(e,t){var n=this.head.data;if(e<n.length){var r=n.slice(0,e);return this.head.data=n.slice(e),r}return e===n.length?this.shift():t?this._getString(e):this._getBuffer(e)}},{key:"first",value:function(){return this.head.data}},{key:c,value:i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.head;case 1:if(!t){e.next=7;break}return e.next=4,t.data;case 4:t=t.next,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"_getString",value:function(e){var t="",n=this.head,r=0;do{var i=n.data;if(!(e>i.length)){e===i.length?(t+=i,++r,n.next?this.head=n.next:this.head=this.tail=null):(t+=u(i,0,e),this.head=n,n.data=u(i,e));break}t+=i,e-=i.length,++r}while(null!==(n=n.next));return this.length-=r,t}},{key:"_getBuffer",value:function(e){var t=d.allocUnsafe(e),n=e,r=this.head,i=0;do{var o=r.data;if(!(e>o.length)){e===o.length?(l(t,o,n-e),++i,r.next?this.head=r.next:this.head=this.tail=null):(l(t,new h(o.buffer,o.byteOffset,e),n-e),this.head=r,r.data=o.slice(e));break}l(t,o,n-e),e-=o.length,++i}while(null!==(r=r.next));return this.length-=i,t}},{key:e,value:function(e,t){return f(this,r(r({},t),{},{depth:0,customInspect:!1}))}}]),t}(Symbol.for("nodejs.util.inspect.custom"))},79746:function(e,t,n){"use strict";var r=n(90228).default,i=n(87999).default,o=n(93864).pipeline,s=n(80881),a=n(44659).destroyer,u=n(39033),c=u.isNodeStream,l=u.isReadable,h=u.isWritable,d=u.isWebStream,f=u.isTransformStream,p=u.isWritableStream,m=u.isReadableStream,g=n(61714),v=g.AbortError,y=g.codes,b=y.ERR_INVALID_ARG_VALUE,_=y.ERR_MISSING_ARGS,x=n(42415);e.exports=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)throw new _("streams");if(1===t.length)return s.from(t[0]);var u,g,y,w,S,E=[].concat(t);if("function"==typeof t[0]&&(t[0]=s.from(t[0])),"function"==typeof t[t.length-1]){var T=t.length-1;t[T]=s.from(t[T])}for(var M=0;M<t.length;++M)if(c(t[M])||d(t[M])){if(M<t.length-1&&!(l(t[M])||m(t[M])||f(t[M])))throw new b("streams[".concat(M,"]"),E[M],"must be readable");if(M>0&&!(h(t[M])||p(t[M])||f(t[M])))throw new b("streams[".concat(M,"]"),E[M],"must be writable")}function A(e){var t=w;w=null,t?t(e):e?S.destroy(e):R||P||S.destroy()}var C=t[0],O=o(t,A),P=!!(h(C)||p(C)||f(C)),R=!!(l(O)||m(O)||f(O));if(S=new s({writableObjectMode:!(null==C||!C.writableObjectMode),readableObjectMode:!(null==O||!O.readableObjectMode),writable:P,readable:R}),P){if(c(C))S._write=function(e,t,n){C.write(e,t)?n():u=n},S._final=function(e){C.end(),g=e},C.on("drain",(function(){if(u){var e=u;u=null,e()}}));else if(d(C)){var N=f(C)?C.writable:C,I=N.getWriter();S._write=function(){var e=i(r().mark((function e(t,n,i){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.ready;case 3:I.write(t).catch((function(){})),i(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),i(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n,r){return e.apply(this,arguments)}}(),S._final=function(){var e=i(r().mark((function e(t){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.ready;case 3:I.close().catch((function(){})),g=t,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()}var k=f(O)?O.readable:O;x(k,(function(){if(g){var e=g;g=null,e()}}))}if(R)if(c(O))O.on("readable",(function(){if(y){var e=y;y=null,e()}})),O.on("end",(function(){S.push(null)})),S._read=function(){for(;;){var e=O.read();if(null===e)return void(y=S._read);if(!S.push(e))return}};else if(d(O)){var D=f(O)?O.readable:O,L=D.getReader();S._read=i(r().mark((function e(){var t,n,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,L.read();case 4:if(t=e.sent,n=t.value,i=t.done,S.push(n)){e.next=9;break}return e.abrupt("return");case 9:if(!i){e.next=12;break}return S.push(null),e.abrupt("return");case 12:e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(1),e.abrupt("return");case 17:e.next=0;break;case 19:case"end":return e.stop()}}),e,null,[[1,14]])})))}return S._destroy=function(e,t){e||null===w||(e=new v),y=null,u=null,g=null,null===w?t(e):(w=t,c(O)&&a(O,e))},S}},44659:function(e,t,n){"use strict";var r=n(14224),i=n(61714),o=i.aggregateTwoErrors,s=i.codes.ERR_MULTIPLE_CALLBACK,a=i.AbortError,u=n(69153).Symbol,c=n(39033),l=c.kIsDestroyed,h=c.isDestroyed,d=c.isFinished,f=c.isServerRequest,p=u("kDestroy"),m=u("kConstruct");function g(e,t,n){e&&(e.stack,t&&!t.errored&&(t.errored=e),n&&!n.errored&&(n.errored=e))}function v(e,t,n){var i=!1;function o(t){if(!i){i=!0;var o=e._readableState,s=e._writableState;g(t,s,o),s&&(s.closed=!0),o&&(o.closed=!0),"function"==typeof n&&n(t),t?r.nextTick(y,e,t):r.nextTick(b,e)}}try{e._destroy(t||null,o)}catch(t){o(t)}}function y(e,t){_(e,t),b(e)}function b(e){var t=e._readableState,n=e._writableState;n&&(n.closeEmitted=!0),t&&(t.closeEmitted=!0),(null!=n&&n.emitClose||null!=t&&t.emitClose)&&e.emit("close")}function _(e,t){var n=e._readableState,r=e._writableState;null!=r&&r.errorEmitted||null!=n&&n.errorEmitted||(r&&(r.errorEmitted=!0),n&&(n.errorEmitted=!0),e.emit("error",t))}function x(e,t,n){var i=e._readableState,o=e._writableState;if(null!=o&&o.destroyed||null!=i&&i.destroyed)return this;null!=i&&i.autoDestroy||null!=o&&o.autoDestroy?e.destroy(t):t&&(t.stack,o&&!o.errored&&(o.errored=t),i&&!i.errored&&(i.errored=t),n?r.nextTick(_,e,t):_(e,t))}function w(e){var t=!1;function n(n){if(t)x(e,null!=n?n:new s);else{t=!0;var i=e._readableState,o=e._writableState,a=o||i;i&&(i.constructed=!0),o&&(o.constructed=!0),a.destroyed?e.emit(p,n):n?x(e,n,!0):r.nextTick(S,e)}}try{e._construct((function(e){r.nextTick(n,e)}))}catch(e){r.nextTick(n,e)}}function S(e){e.emit(m)}function E(e){return(null==e?void 0:e.setHeader)&&"function"==typeof e.abort}function T(e){e.emit("close")}function M(e,t){e.emit("error",t),r.nextTick(T,e)}e.exports={construct:function(e,t){if("function"==typeof e._construct){var n=e._readableState,i=e._writableState;n&&(n.constructed=!1),i&&(i.constructed=!1),e.once(m,t),e.listenerCount(m)>1||r.nextTick(w,e)}},destroyer:function(e,t){e&&!h(e)&&(t||d(e)||(t=new a),f(e)?(e.socket=null,e.destroy(t)):E(e)?e.abort():E(e.req)?e.req.abort():"function"==typeof e.destroy?e.destroy(t):"function"==typeof e.close?e.close():t?r.nextTick(M,e,t):r.nextTick(T,e),e.destroyed||(e[l]=!0))},destroy:function(e,t){var n=this._readableState,r=this._writableState,i=r||n;return null!=r&&r.destroyed||null!=n&&n.destroyed?("function"==typeof t&&t(),this):(g(e,r,n),r&&(r.destroyed=!0),n&&(n.destroyed=!0),i.constructed?v(this,e,t):this.once(p,(function(n){v(this,o(n,e),t)})),this)},undestroy:function(){var e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=!1===e.readable,e.endEmitted=!1===e.readable),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=!1===t.writable,t.ending=!1===t.writable,t.finished=!1===t.writable)},errorOrDestroy:x}},80881:function(e,t,n){"use strict";var r=n(26068).default,i=n(69153),o=i.ObjectDefineProperties,s=i.ObjectGetOwnPropertyDescriptor,a=i.ObjectKeys,u=i.ObjectSetPrototypeOf;e.exports=g;var c,l,h=n(1105),d=n(29840);u(g.prototype,h.prototype),u(g,h);for(var f=a(d.prototype),p=0;p<f.length;p++){var m=f[p];g.prototype[m]||(g.prototype[m]=d.prototype[m])}function g(e){if(!(this instanceof g))return new g(e);h.call(this,e),d.call(this,e),e?(this.allowHalfOpen=!1!==e.allowHalfOpen,!1===e.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===e.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}function v(){return void 0===c&&(c={}),c}o(g.prototype,{writable:r({__proto__:null},s(d.prototype,"writable")),writableHighWaterMark:r({__proto__:null},s(d.prototype,"writableHighWaterMark")),writableObjectMode:r({__proto__:null},s(d.prototype,"writableObjectMode")),writableBuffer:r({__proto__:null},s(d.prototype,"writableBuffer")),writableLength:r({__proto__:null},s(d.prototype,"writableLength")),writableFinished:r({__proto__:null},s(d.prototype,"writableFinished")),writableCorked:r({__proto__:null},s(d.prototype,"writableCorked")),writableEnded:r({__proto__:null},s(d.prototype,"writableEnded")),writableNeedDrain:r({__proto__:null},s(d.prototype,"writableNeedDrain")),destroyed:{__proto__:null,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){this._readableState&&this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}}),g.fromWeb=function(e,t){return v().newStreamDuplexFromReadableWritablePair(e,t)},g.toWeb=function(e){return v().newReadableWritablePairFromDuplex(e)},g.from=function(e){return l||(l=n(77875)),l(e,"body")}},77875:function(e,t,n){var r=n(31759).default,i=n(90228).default,o=n(87999).default,s=n(17069).default,a=n(25298).default,u=n(21742).default,c=n(83136).default,l=n(34067).default,h=n(24661).default,d=n(14224),f=n(55872),p=n(39033),m=p.isReadable,g=p.isWritable,v=p.isIterable,y=p.isNodeStream,b=p.isReadableNodeStream,_=p.isWritableNodeStream,x=p.isDuplexNodeStream,w=p.isReadableStream,S=p.isWritableStream,E=n(42415),T=n(61714),M=T.AbortError,A=T.codes,C=A.ERR_INVALID_ARG_TYPE,O=A.ERR_INVALID_RETURN_VALUE,P=n(44659).destroyer,R=n(80881),N=n(1105),I=n(29840),k=n(61601).createDeferredPromise,D=n(64599),L=globalThis.Blob||f.Blob,U=void 0!==L?function(e){return e instanceof L}:function(e){return!1},F=globalThis.AbortController||n(20366).AbortController,B=n(69153).FunctionPrototypeCall,z=function(e){"use strict";u(n,e);var t=c(n);function n(e){var r;return a(this,n),r=t.call(this,e),!1===(null==e?void 0:e.readable)&&(r._readableState.readable=!1,r._readableState.ended=!0,r._readableState.endEmitted=!0),!1===(null==e?void 0:e.writable)&&(r._writableState.writable=!1,r._writableState.ending=!0,r._writableState.ended=!0,r._writableState.finished=!0),r}return s(n)}(R);function j(e){var t,n,r,i,o,s=e.readable&&"function"!=typeof e.readable.read?N.wrap(e.readable):e.readable,a=e.writable,u=!!m(s),c=!!g(a);function l(e){var t=i;i=null,t?t(e):e&&o.destroy(e)}return o=new z({readableObjectMode:!(null==s||!s.readableObjectMode),writableObjectMode:!(null==a||!a.writableObjectMode),readable:u,writable:c}),c&&(E(a,(function(e){c=!1,e&&P(s,e),l(e)})),o._write=function(e,n,r){a.write(e,n)?r():t=r},o._final=function(e){a.end(),n=e},a.on("drain",(function(){if(t){var e=t;t=null,e()}})),a.on("finish",(function(){if(n){var e=n;n=null,e()}}))),u&&(E(s,(function(e){u=!1,e&&P(s,e),l(e)})),s.on("readable",(function(){if(r){var e=r;r=null,e()}})),s.on("end",(function(){o.push(null)})),o._read=function(){for(;;){var e=s.read();if(null===e)return void(r=o._read);if(!o.push(e))return}}),o._destroy=function(e,o){e||null===i||(e=new M),r=null,t=null,n=null,null===i?o(e):(i=o,P(a,e),P(s,e))},o}e.exports=function e(t,n){if(x(t))return t;if(b(t))return j({readable:t});if(_(t))return j({writable:t});if(y(t))return j({writable:!1,readable:!1});if(w(t))return j({readable:N.fromWeb(t)});if(S(t))return j({writable:I.fromWeb(t)});if("function"==typeof t){var s=function(e){var t=k(),n=t.promise,r=t.resolve,o=new F,s=o.signal,a=e(h(i().mark((function e(){var t,o,a,u,c,h;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n,n=null,e.next=5,l(t);case 5:if(o=e.sent,a=o.chunk,u=o.done,c=o.cb,d.nextTick(c),!u){e.next=12;break}return e.abrupt("return");case 12:if(!s.aborted){e.next=14;break}throw new M(void 0,{cause:s.reason});case 14:return h=k(),n=h.promise,r=h.resolve,e.next=19,a;case 19:e.next=0;break;case 21:case"end":return e.stop()}}),e)})))(),{signal:s});return{value:a,write:function(e,t,n){var i=r;r=null,i({chunk:e,done:!1,cb:n})},final:function(e){var t=r;r=null,t({done:!0,cb:e})},destroy:function(e,t){o.abort(),t(e)}}}(t),a=s.value,u=s.write,c=s.final,f=s.destroy;if(v(a))return D(z,a,{objectMode:!0,write:u,final:c,destroy:f});var p=null==a?void 0:a.then;if("function"==typeof p){var m,g=B(p,a,(function(e){if(null!=e)throw new O("nully","body",e)}),(function(e){P(m,e)}));return m=new z({objectMode:!0,readable:!1,write:u,final:function(e){c(o(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g;case 3:d.nextTick(e,null),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),d.nextTick(e,t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])}))))},destroy:f})}throw new O("Iterable, AsyncIterable or AsyncFunction",n,a)}if(U(t))return e(t.arrayBuffer());if(v(t))return D(z,t,{objectMode:!0,writable:!1});if(w(null==t?void 0:t.readable)&&S(null==t?void 0:t.writable))return z.fromWeb(t);if("object"===r(null==t?void 0:t.writable)||"object"===r(null==t?void 0:t.readable))return j({readable:null!=t&&t.readable?b(null==t?void 0:t.readable)?null==t?void 0:t.readable:e(t.readable):void 0,writable:null!=t&&t.writable?_(null==t?void 0:t.writable)?null==t?void 0:t.writable:e(t.writable):void 0});var E,T=null==t?void 0:t.then;if("function"==typeof T)return B(T,t,(function(e){null!=e&&E.push(e),E.push(null)}),(function(e){P(E,e)})),E=new z({objectMode:!0,writable:!1,read:function(){}});throw new C(n,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],t)}},42415:function(e,t,n){var r,i=n(14224),o=n(61714),s=o.AbortError,a=o.codes,u=a.ERR_INVALID_ARG_TYPE,c=a.ERR_STREAM_PREMATURE_CLOSE,l=n(61601),h=l.kEmptyObject,d=l.once,f=n(8568),p=f.validateAbortSignal,m=f.validateFunction,g=f.validateObject,v=f.validateBoolean,y=n(69153),b=y.Promise,_=y.PromisePrototypeThen,x=y.SymbolDispose,w=n(39033),S=w.isClosed,E=w.isReadable,T=w.isReadableNodeStream,M=w.isReadableStream,A=w.isReadableFinished,C=w.isReadableErrored,O=w.isWritable,P=w.isWritableNodeStream,R=w.isWritableStream,N=w.isWritableFinished,I=w.isWritableErrored,k=w.isNodeStream,D=w.willEmitClose,L=w.kIsClosedPromise;function U(e){return e.setHeader&&"function"==typeof e.abort}var F=function(){};function B(e,t,o){var a,l;if(2===arguments.length?(o=t,t=h):null==t?t=h:g(t,"options"),m(o,"callback"),p(t.signal,"options.signal"),o=d(o),M(e)||R(e))return z(e,t,o);if(!k(e))throw new u("stream",["ReadableStream","WritableStream","Stream"],e);var f=null!==(a=t.readable)&&void 0!==a?a:T(e),v=null!==(l=t.writable)&&void 0!==l?l:P(e),y=e._writableState,b=e._readableState,_=function(){e.writable||B()},w=D(e)&&T(e)===f&&P(e)===v,L=N(e,!1),B=function(){L=!0,e.destroyed&&(w=!1),(!w||e.readable&&!f)&&(f&&!j||o.call(e))},j=A(e,!1),V=function(){j=!0,e.destroyed&&(w=!1),(!w||e.writable&&!v)&&(v&&!L||o.call(e))},G=function(t){o.call(e,t)},H=S(e),W=function(){H=!0;var t=I(e)||C(e);return t&&"boolean"!=typeof t?o.call(e,t):f&&!j&&T(e,!0)&&!A(e,!1)?o.call(e,new c):!v||L||N(e,!1)?void o.call(e):o.call(e,new c)},q=function(){H=!0;var t=I(e)||C(e);if(t&&"boolean"!=typeof t)return o.call(e,t);o.call(e)},X=function(){e.req.on("finish",B)};U(e)?(e.on("complete",B),w||e.on("abort",W),e.req?X():e.on("request",X)):v&&!y&&(e.on("end",_),e.on("close",_)),w||"boolean"!=typeof e.aborted||e.on("aborted",W),e.on("end",V),e.on("finish",B),!1!==t.error&&e.on("error",G),e.on("close",W),H?i.nextTick(W):null!=y&&y.errorEmitted||null!=b&&b.errorEmitted?w||i.nextTick(q):(f||w&&!E(e)||!L&&!1!==O(e))&&(v||w&&!O(e)||!j&&!1!==E(e))?b&&e.req&&e.aborted&&i.nextTick(q):i.nextTick(q);var Z=function(){o=F,e.removeListener("aborted",W),e.removeListener("complete",B),e.removeListener("abort",W),e.removeListener("request",X),e.req&&e.req.removeListener("finish",B),e.removeListener("end",_),e.removeListener("close",_),e.removeListener("finish",B),e.removeListener("end",V),e.removeListener("error",G),e.removeListener("close",W)};if(t.signal&&!H){var $=function(){var n=o;Z(),n.call(e,new s(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)i.nextTick($);else{var Y=(r=r||n(61601).addAbortListener)(t.signal,$),K=o;o=d((function(){Y[x]();for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];K.apply(e,n)}))}}return Z}function z(e,t,o){var a=!1,u=F;if(t.signal)if(u=function(){a=!0,o.call(e,new s(void 0,{cause:t.signal.reason}))},t.signal.aborted)i.nextTick(u);else{var c=(r=r||n(61601).addAbortListener)(t.signal,u),l=o;o=d((function(){c[x]();for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];l.apply(e,n)}))}var h=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];a||i.nextTick((function(){return o.apply(e,n)}))};return _(e[L].promise,h,h),F}e.exports=B,e.exports.finished=function(e,t){var n,r=!1;return null===t&&(t=h),null!==(n=t)&&void 0!==n&&n.cleanup&&(v(t.cleanup,"cleanup"),r=t.cleanup),new b((function(n,i){var o=B(e,t,(function(e){r&&o(),e?i(e):n()}))}))}},64599:function(e,t,n){"use strict";var r=n(90228).default,i=n(87999).default,o=n(26068).default,s=n(14224),a=n(69153),u=a.PromisePrototypeThen,c=a.SymbolAsyncIterator,l=a.SymbolIterator,h=n(55872).Buffer,d=n(61714).codes,f=d.ERR_INVALID_ARG_TYPE,p=d.ERR_STREAM_NULL_VALUES;e.exports=function(e,t,n){var a,d;if("string"==typeof t||t instanceof h)return new e(o(o({objectMode:!0},n),{},{read:function(){this.push(t),this.push(null)}}));if(t&&t[c])d=!0,a=t[c]();else{if(!t||!t[l])throw new f("iterable",["Iterable"],t);d=!1,a=t[l]()}var m=new e(o({objectMode:!0,highWaterMark:1},n)),g=!1;function v(){return(v=i(r().mark((function e(t){var n,i,o,s,u,c,l;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null!=t,i="function"==typeof a.throw,!n||!i){e.next=12;break}return e.next=5,a.throw(t);case 5:return o=e.sent,s=o.value,u=o.done,e.next=10,s;case 10:if(!u){e.next=12;break}return e.abrupt("return");case 12:if("function"!=typeof a.return){e.next=19;break}return e.next=15,a.return();case 15:return c=e.sent,l=c.value,e.next=19,l;case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=i(r().mark((function e(){var t,n,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!d){e.next=7;break}return e.next=4,a.next();case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0=a.next();case 8:if(t=e.t0,n=t.value,!t.done){e.next=15;break}m.push(null),e.next=33;break;case 15:if(!n||"function"!=typeof n.then){e.next=21;break}return e.next=18,n;case 18:e.t1=e.sent,e.next=22;break;case 21:e.t1=n;case 22:if(null!==(i=e.t1)){e.next=28;break}throw g=!1,new p;case 28:if(!m.push(i)){e.next=32;break}return e.abrupt("continue",39);case 32:g=!1;case 33:e.next=38;break;case 35:e.prev=35,e.t2=e.catch(0),m.destroy(e.t2);case 38:return e.abrupt("break",41);case 39:e.next=0;break;case 41:case"end":return e.stop()}}),e,null,[[0,35]])})))).apply(this,arguments)}return m._read=function(){g||(g=!0,function(){y.apply(this,arguments)}())},m._destroy=function(e,t){u(function(e){return v.apply(this,arguments)}(e),(function(){return s.nextTick(t,e)}),(function(n){return s.nextTick(t,n||e)}))},m}},604:function(e,t,n){"use strict";var r=n(69153),i=r.ArrayIsArray,o=r.ObjectSetPrototypeOf,s=n(72100).EventEmitter;function a(e){s.call(this,e)}function u(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?i(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}o(a.prototype,s.prototype),o(a,s),a.prototype.pipe=function(e,t){var n=this;function r(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function i(){n.readable&&n.resume&&n.resume()}n.on("data",r),e.on("drain",i),e._isStdio||t&&!1===t.end||(n.on("end",a),n.on("close",c));var o=!1;function a(){o||(o=!0,e.end())}function c(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){h(),0===s.listenerCount(this,"error")&&this.emit("error",e)}function h(){n.removeListener("data",r),e.removeListener("drain",i),n.removeListener("end",a),n.removeListener("close",c),n.removeListener("error",l),e.removeListener("error",l),n.removeListener("end",h),n.removeListener("close",h),e.removeListener("close",h)}return u(n,"error",l),u(e,"error",l),n.on("end",h),n.on("close",h),e.on("close",h),e.emit("pipe",n),e},e.exports={Stream:a,prependListener:u}},84990:function(e,t,n){"use strict";var r=n(82092).default,i=n(17069).default,o=n(25298).default,s=n(21742).default,a=n(83136).default,u=n(90228).default,c=n(87999).default,l=n(56751).default,h=n(75487).default,d=n(34067).default,f=n(24661).default,p=globalThis.AbortController||n(20366).AbortController,m=n(61714),g=m.codes,v=g.ERR_INVALID_ARG_VALUE,y=g.ERR_INVALID_ARG_TYPE,b=g.ERR_MISSING_ARGS,_=g.ERR_OUT_OF_RANGE,x=m.AbortError,w=n(8568),S=w.validateAbortSignal,E=w.validateInteger,T=w.validateObject,M=n(69153).Symbol("kWeak"),A=n(69153).Symbol("kResistStopPropagation"),C=n(42415).finished,O=n(79746),P=n(69272).addAbortSignalNoValidate,R=n(39033),N=R.isWritable,I=R.isNodeStream,k=n(61601).deprecate,D=n(69153),L=D.ArrayPrototypePush,U=D.Boolean,F=D.MathFloor,B=D.Number,z=D.NumberIsNaN,j=D.Promise,V=D.PromiseReject,G=D.PromiseResolve,H=D.PromisePrototypeThen,W=D.Symbol,q=W("kEmpty"),X=W("kEof");function Z(e,t){if("function"!=typeof e)throw new y("fn",["Function","AsyncFunction"],e);null!=t&&T(t,"options"),null!=(null==t?void 0:t.signal)&&S(t.signal,"options.signal");var r=1;null!=(null==t?void 0:t.concurrency)&&(r=F(t.concurrency));var i=r-1;return null!=(null==t?void 0:t.highWaterMark)&&(i=F(t.highWaterMark)),E(r,"options.concurrency",1),E(i,"options.highWaterMark",0),i+=r,function(){var o=f(u().mark((function o(){var s,a,l,f,p,m,g,v,y,b,_,w,S,E;return u().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:S=function(){return(S=c(u().mark((function t(){var n,o,c,d,_,w,S;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,n=!1,o=!1,t.prev=3,d=h(a);case 5:return t.next=7,d.next();case 7:if(!(n=!(_=t.sent).done)){t.next=33;break}if(w=_.value,!g){t.next=11;break}return t.abrupt("return");case 11:if(!s.aborted){t.next=13;break}throw new x;case 13:if(t.prev=13,(w=e(w,f))!==q){t.next=17;break}return t.abrupt("continue",30);case 17:w=G(w),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(13),w=V(t.t0);case 23:if(v+=1,H(w,b,y),l.push(w),p&&(p(),p=null),g||!(l.length>=i||v>=r)){t.next=30;break}return t.next=30,new j((function(e){m=e}));case 30:n=!1,t.next=5;break;case 33:t.next=39;break;case 35:t.prev=35,t.t1=t.catch(3),o=!0,c=t.t1;case 39:if(t.prev=39,t.prev=40,!n||null==d.return){t.next=44;break}return t.next=44,d.return();case 44:if(t.prev=44,!o){t.next=47;break}throw c;case 47:return t.finish(44);case 48:return t.finish(39);case 49:l.push(X),t.next=57;break;case 52:t.prev=52,t.t2=t.catch(0),S=V(t.t2),H(S,b,y),l.push(S);case 57:return t.prev=57,g=!0,p&&(p(),p=null),t.finish(57);case 61:case"end":return t.stop()}}),t,null,[[0,52,57,61],[3,35,39,49],[13,20],[40,,44,48]])})))).apply(this,arguments)},w=function(){return S.apply(this,arguments)},_=function(){m&&!g&&v<r&&l.length<i&&(m(),m=null)},b=function(){v-=1,_()},y=function(){g=!0,b()},s=n(61601).AbortSignalAny([null==t?void 0:t.signal].filter(U)),a=this,l=[],f={signal:s},g=!1,v=0,w(),o.prev=12;case 13:0;case 14:if(!(l.length>0)){o.next=29;break}return o.next=17,d(l[0]);case 17:if((E=o.sent)!==X){o.next=20;break}return o.abrupt("return");case 20:if(!s.aborted){o.next=22;break}throw new x;case 22:if(E===q){o.next=25;break}return o.next=25,E;case 25:l.shift(),_(),o.next=14;break;case 29:return o.next=31,d(new j((function(e){p=e})));case 31:o.next=13;break;case 33:return o.prev=33,g=!0,m&&(m(),m=null),o.finish(33);case 37:case"end":return o.stop()}}),o,this,[[12,,33,37]])})));return function(){return o.apply(this,arguments)}}().call(this)}function $(e){return Y.apply(this,arguments)}function Y(){return Y=c(u().mark((function e(t){var n,r,i,o,s,a,c=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=c.length>1&&void 0!==c[1]?c[1]:void 0,r=!1,i=!1,e.prev=3,s=h(ee.call(this,t,n));case 5:return e.next=7,s.next();case 7:if(!(r=!(a=e.sent).done)){e.next=13;break}return a.value,e.abrupt("return",!0);case 10:r=!1,e.next=5;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),i=!0,o=e.t0;case 19:if(e.prev=19,e.prev=20,!r||null==s.return){e.next=24;break}return e.next=24,s.return();case 24:if(e.prev=24,!i){e.next=27;break}throw o;case 27:return e.finish(24);case 28:return e.finish(19);case 29:return e.abrupt("return",!1);case 30:case"end":return e.stop()}}),e,this,[[3,15,19,29],[20,,24,28]])}))),Y.apply(this,arguments)}function K(){return K=c(u().mark((function e(t){var n,r=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]?r[1]:void 0,"function"==typeof t){e.next=3;break}throw new y("fn",["Function","AsyncFunction"],t);case 3:return e.next=5,$.call(this,c(u().mark((function e(){var n=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.apply(void 0,n);case 2:return e.abrupt("return",!e.sent);case 3:case"end":return e.stop()}}),e)}))),n);case 5:return e.abrupt("return",!e.sent);case 6:case"end":return e.stop()}}),e,this)}))),K.apply(this,arguments)}function Q(){return(Q=c(u().mark((function e(t,n){var r,i,o,s,a,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!1,i=!1,e.prev=2,s=h(ee.call(this,t,n));case 4:return e.next=6,s.next();case 6:if(!(r=!(a=e.sent).done)){e.next=12;break}return c=a.value,e.abrupt("return",c);case 9:r=!1,e.next=4;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),i=!0,o=e.t0;case 18:if(e.prev=18,e.prev=19,!r||null==s.return){e.next=23;break}return e.next=23,s.return();case 23:if(e.prev=23,!i){e.next=26;break}throw o;case 26:return e.finish(23);case 27:return e.finish(18);case 28:return e.abrupt("return",void 0);case 29:case"end":return e.stop()}}),e,this,[[2,14,18,28],[19,,23,27]])})))).apply(this,arguments)}function J(){return J=c(u().mark((function e(t,n){var r,i,o,s,a,l,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=function(){return i=c(u().mark((function e(n,r){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(n,r);case 2:return e.abrupt("return",q);case 3:case"end":return e.stop()}}),e)}))),i.apply(this,arguments)},r=function(e,t){return i.apply(this,arguments)},"function"==typeof t){e.next=4;break}throw new y("fn",["Function","AsyncFunction"],t);case 4:o=!1,s=!1,e.prev=6,l=h(Z.call(this,r,n));case 8:return e.next=10,l.next();case 10:if(!(o=!(d=e.sent).done)){e.next=16;break}d.value;case 13:o=!1,e.next=8;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(6),s=!0,a=e.t0;case 22:if(e.prev=22,e.prev=23,!o||null==l.return){e.next=27;break}return e.next=27,l.return();case 27:if(e.prev=27,!s){e.next=30;break}throw a;case 30:return e.finish(27);case 31:return e.finish(22);case 32:case"end":return e.stop()}}),e,this,[[6,18,22,32],[23,,27,31]])}))),J.apply(this,arguments)}function ee(e,t){if("function"!=typeof e)throw new y("fn",["Function","AsyncFunction"],e);function n(){return n=c(u().mark((function t(n,r){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(n,r);case 2:if(!t.sent){t.next=4;break}return t.abrupt("return",n);case 4:return t.abrupt("return",q);case 5:case"end":return t.stop()}}),t)}))),n.apply(this,arguments)}return Z.call(this,(function(e,t){return n.apply(this,arguments)}),t)}var te=function(e){s(n,e);var t=a(n);function n(){var e;return o(this,n),(e=t.call(this,"reduce")).message="Reduce of an empty stream requires an initial value",e}return i(n)}(b);function ne(){return ne=c(u().mark((function e(t,n,i){var o,s,a,c,l,d,f,m,g,v,b,_,w,E,O=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"==typeof t){e.next=2;break}throw new y("reducer",["Function","AsyncFunction"],t);case 2:if(null!=i&&T(i,"options"),null!=(null==i?void 0:i.signal)&&S(i.signal,"options.signal"),s=O.length>1,null==i||null===(o=i.signal)||void 0===o||!o.aborted){e.next=11;break}return a=new x(void 0,{cause:i.signal.reason}),this.once("error",(function(){})),e.next=10,C(this.destroy(a));case 10:throw a;case 11:c=new p,l=c.signal,null!=i&&i.signal&&(d=r(r({once:!0},M,this),A,!0),i.signal.addEventListener("abort",(function(){return c.abort()}),d)),f=!1,e.prev=15,m=!1,g=!1,e.prev=18,b=h(this);case 20:return e.next=22,b.next();case 22:if(!(m=!(_=e.sent).done)){e.next=38;break}if(w=_.value,f=!0,null==i||null===(E=i.signal)||void 0===E||!E.aborted){e.next=27;break}throw new x;case 27:if(s){e.next=32;break}n=w,s=!0,e.next=35;break;case 32:return e.next=34,t(n,w,{signal:l});case 34:n=e.sent;case 35:m=!1,e.next=20;break;case 38:e.next=44;break;case 40:e.prev=40,e.t0=e.catch(18),g=!0,v=e.t0;case 44:if(e.prev=44,e.prev=45,!m||null==b.return){e.next=49;break}return e.next=49,b.return();case 49:if(e.prev=49,!g){e.next=52;break}throw v;case 52:return e.finish(49);case 53:return e.finish(44);case 54:if(f||s){e.next=56;break}throw new te;case 56:return e.prev=56,c.abort(),e.finish(56);case 59:return e.abrupt("return",n);case 60:case"end":return e.stop()}}),e,this,[[15,,56,59],[18,40,44,54],[45,,49,53]])}))),ne.apply(this,arguments)}function re(){return(re=c(u().mark((function e(t){var n,r,i,o,s,a,c,l;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null!=t&&T(t,"options"),null!=(null==t?void 0:t.signal)&&S(t.signal,"options.signal"),n=[],r=!1,i=!1,e.prev=5,s=h(this);case 7:return e.next=9,s.next();case 9:if(!(r=!(a=e.sent).done)){e.next=17;break}if(c=a.value,null==t||null===(l=t.signal)||void 0===l||!l.aborted){e.next=13;break}throw new x(void 0,{cause:t.signal.reason});case 13:L(n,c);case 14:r=!1,e.next=7;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(5),i=!0,o=e.t0;case 23:if(e.prev=23,e.prev=24,!r||null==s.return){e.next=28;break}return e.next=28,s.return();case 28:if(e.prev=28,!i){e.next=31;break}throw o;case 31:return e.finish(28);case 32:return e.finish(23);case 33:return e.abrupt("return",n);case 34:case"end":return e.stop()}}),e,this,[[5,19,23,33],[24,,28,32]])})))).apply(this,arguments)}function ie(e){if(e=B(e),z(e))return 0;if(e<0)throw new _("number",">= 0",e);return e}e.exports.streamReturningOperators={asIndexedPairs:k((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return null!=e&&T(e,"options"),null!=(null==e?void 0:e.signal)&&S(e.signal,"options.signal"),function(){var t=f(u().mark((function t(){var n,r,i,o,s,a,c,l;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0,r=!1,i=!1,t.prev=3,s=h(this);case 5:return t.next=7,d(s.next());case 7:if(!(r=!(a=t.sent).done)){t.next=16;break}if(c=a.value,null==e||null===(l=e.signal)||void 0===l||!l.aborted){t.next=11;break}throw new x({cause:e.signal.reason});case 11:return t.next=13,[n++,c];case 13:r=!1,t.next=5;break;case 16:t.next=22;break;case 18:t.prev=18,t.t0=t.catch(3),i=!0,o=t.t0;case 22:if(t.prev=22,t.prev=23,!r||null==s.return){t.next=27;break}return t.next=27,d(s.return());case 27:if(t.prev=27,!i){t.next=30;break}throw o;case 30:return t.finish(27);case 31:return t.finish(22);case 32:case"end":return t.stop()}}),t,this,[[3,18,22,32],[23,,27,31]])})));return function(){return t.apply(this,arguments)}}().call(this)}),"readable.asIndexedPairs will be removed in a future version."),drop:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return null!=t&&T(t,"options"),null!=(null==t?void 0:t.signal)&&S(t.signal,"options.signal"),e=ie(e),function(){var n=f(u().mark((function n(){var r,i,o,s,a,c,l,f;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null==t||null===(r=t.signal)||void 0===r||!r.aborted){n.next=2;break}throw new x;case 2:i=!1,o=!1,n.prev=4,a=h(this);case 6:return n.next=8,d(a.next());case 8:if(!(i=!(c=n.sent).done)){n.next=18;break}if(l=c.value,null==t||null===(f=t.signal)||void 0===f||!f.aborted){n.next=12;break}throw new x;case 12:if(!(e--<=0)){n.next=15;break}return n.next=15,l;case 15:i=!1,n.next=6;break;case 18:n.next=24;break;case 20:n.prev=20,n.t0=n.catch(4),o=!0,s=n.t0;case 24:if(n.prev=24,n.prev=25,!i||null==a.return){n.next=29;break}return n.next=29,d(a.return());case 29:if(n.prev=29,!o){n.next=32;break}throw s;case 32:return n.finish(29);case 33:return n.finish(24);case 34:case"end":return n.stop()}}),n,this,[[4,20,24,34],[25,,29,33]])})));return function(){return n.apply(this,arguments)}}().call(this)},filter:ee,flatMap:function(e,t){var n=Z.call(this,e,t);return function(){var e=f(u().mark((function e(){var t,r,i,o,s,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!1,r=!1,e.prev=2,o=h(n);case 4:return e.next=6,d(o.next());case 6:if(!(t=!(s=e.sent).done)){e.next=12;break}return a=s.value,e.delegateYield(l(h(a),d),"t0",9);case 9:t=!1,e.next=4;break;case 12:e.next=18;break;case 14:e.prev=14,e.t1=e.catch(2),r=!0,i=e.t1;case 18:if(e.prev=18,e.prev=19,!t||null==o.return){e.next=23;break}return e.next=23,d(o.return());case 23:if(e.prev=23,!r){e.next=26;break}throw i;case 26:return e.finish(23);case 27:return e.finish(18);case 28:case"end":return e.stop()}}),e,null,[[2,14,18,28],[19,,23,27]])})));return function(){return e.apply(this,arguments)}}().call(this)},map:Z,take:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return null!=t&&T(t,"options"),null!=(null==t?void 0:t.signal)&&S(t.signal,"options.signal"),e=ie(e),function(){var n=f(u().mark((function n(){var r,i,o,s,a,c,l,f;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null==t||null===(r=t.signal)||void 0===r||!r.aborted){n.next=2;break}throw new x;case 2:i=!1,o=!1,n.prev=4,a=h(this);case 6:return n.next=8,d(a.next());case 8:if(!(i=!(c=n.sent).done)){n.next=20;break}if(l=c.value,null==t||null===(f=t.signal)||void 0===f||!f.aborted){n.next=12;break}throw new x;case 12:if(!(e-- >0)){n.next=15;break}return n.next=15,l;case 15:if(!(e<=0)){n.next=17;break}return n.abrupt("return");case 17:i=!1,n.next=6;break;case 20:n.next=26;break;case 22:n.prev=22,n.t0=n.catch(4),o=!0,s=n.t0;case 26:if(n.prev=26,n.prev=27,!i||null==a.return){n.next=31;break}return n.next=31,d(a.return());case 31:if(n.prev=31,!o){n.next=34;break}throw s;case 34:return n.finish(31);case 35:return n.finish(26);case 36:case"end":return n.stop()}}),n,this,[[4,22,26,36],[27,,31,35]])})));return function(){return n.apply(this,arguments)}}().call(this)},compose:function(e,t){if(null!=t&&T(t,"options"),null!=(null==t?void 0:t.signal)&&S(t.signal,"options.signal"),I(e)&&!N(e))throw new v("stream",e,"must be writable");var n=O(this,e);return null!=t&&t.signal&&P(t.signal,n),n}},e.exports.promiseReturningOperators={every:function(e){return K.apply(this,arguments)},forEach:function(e,t){return J.apply(this,arguments)},reduce:function(e,t,n){return ne.apply(this,arguments)},toArray:function(e){return re.apply(this,arguments)},some:$,find:function(e,t){return Q.apply(this,arguments)}}},12610:function(e,t,n){"use strict";var r=n(69153).ObjectSetPrototypeOf;e.exports=o;var i=n(35378);function o(e){if(!(this instanceof o))return new o(e);i.call(this,e)}r(o.prototype,i.prototype),r(o,i),o.prototype._transform=function(e,t,n){n(null,e)}},93864:function(e,t,n){var r,i,o,s=n(87999).default,a=n(90228).default,u=n(24661).default,c=n(34067).default,l=n(56751).default,h=n(75487).default,d=n(14224),f=n(69153),p=f.ArrayIsArray,m=f.Promise,g=f.SymbolAsyncIterator,v=f.SymbolDispose,y=n(42415),b=n(61601).once,_=n(44659),x=n(80881),w=n(61714),S=w.aggregateTwoErrors,E=w.codes,T=E.ERR_INVALID_ARG_TYPE,M=E.ERR_INVALID_RETURN_VALUE,A=E.ERR_MISSING_ARGS,C=E.ERR_STREAM_DESTROYED,O=E.ERR_STREAM_PREMATURE_CLOSE,P=w.AbortError,R=n(8568),N=R.validateFunction,I=R.validateAbortSignal,k=n(39033),D=k.isIterable,L=k.isReadable,U=k.isReadableNodeStream,F=k.isNodeStream,B=k.isTransformStream,z=k.isWebStream,j=k.isReadableStream,V=k.isReadableFinished,G=globalThis.AbortController||n(20366).AbortController;function H(e,t,n){var r=!1;return e.on("close",(function(){r=!0})),{destroy:function(t){r||(r=!0,_.destroyer(e,t||new C("pipe")))},cleanup:y(e,{readable:t,writable:n},(function(e){r=!e}))}}function W(e){return N(e[e.length-1],"streams[stream.length - 1]"),e.pop()}function q(e){if(D(e))return e;if(U(e))return function(e){return X.apply(this,arguments)}(e);throw new T("val",["Readable","Iterable","AsyncIterable"],e)}function X(){return(X=u(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i||(i=n(1105)),e.delegateYield(l(h(i.prototype[g].call(t)),c),"t0",2);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e,t,n,r){return $.apply(this,arguments)}function $(){return($=s(a().mark((function e(t,n,r,i){var o,s,u,c,l,d,f,p,g,v,b,_;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=i.end,u=null,c=function(e){if(e&&(s=e),u){var t=u;u=null,t()}},l=function(){return new m((function(e,t){s?t(s):u=function(){s?t(s):e()}}))},n.on("drain",c),d=y(n,{readable:!1},c),e.prev=6,!n.writableNeedDrain){e.next=10;break}return e.next=10,l();case 10:f=!1,p=!1,e.prev=12,v=h(t);case 14:return e.next=16,v.next();case 16:if(!(f=!(b=e.sent).done)){e.next=24;break}if(_=b.value,n.write(_)){e.next=21;break}return e.next=21,l();case 21:f=!1,e.next=14;break;case 24:e.next=30;break;case 26:e.prev=26,e.t0=e.catch(12),p=!0,g=e.t0;case 30:if(e.prev=30,e.prev=31,!f||null==v.return){e.next=35;break}return e.next=35,v.return();case 35:if(e.prev=35,!p){e.next=38;break}throw g;case 38:return e.finish(35);case 39:return e.finish(30);case 40:if(!o){e.next=44;break}return n.end(),e.next=44,l();case 44:r(),e.next=50;break;case 47:e.prev=47,e.t1=e.catch(6),r(s!==e.t1?S(s,e.t1):e.t1);case 50:return e.prev=50,d(),n.off("drain",c),e.finish(50);case 54:case"end":return e.stop()}}),e,null,[[6,47,50,54],[12,26,30,40],[31,,35,39]])})))).apply(this,arguments)}function Y(e,t,n,r){return K.apply(this,arguments)}function K(){return(K=s(a().mark((function e(t,n,r,i){var o,s,u,c,l,d,f,p;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=i.end,B(n)&&(n=n.writable),s=n.getWriter(),e.prev=3,u=!1,c=!1,e.prev=6,d=h(t);case 8:return e.next=10,d.next();case 10:if(!(u=!(f=e.sent).done)){e.next=18;break}return p=f.value,e.next=14,s.ready;case 14:s.write(p).catch((function(){}));case 15:u=!1,e.next=8;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(6),c=!0,l=e.t0;case 24:if(e.prev=24,e.prev=25,!u||null==d.return){e.next=29;break}return e.next=29,d.return();case 29:if(e.prev=29,!c){e.next=32;break}throw l;case 32:return e.finish(29);case 33:return e.finish(24);case 34:return e.next=36,s.ready;case 36:if(!o){e.next=39;break}return e.next=39,s.close();case 39:r(),e.next=53;break;case 42:return e.prev=42,e.t1=e.catch(3),e.prev=44,e.next=47,s.abort(e.t1);case 47:r(e.t1),e.next=53;break;case 50:e.prev=50,e.t2=e.catch(44),r(e.t2);case 53:case"end":return e.stop()}}),e,null,[[3,42],[6,20,24,34],[25,,29,33],[44,50]])})))).apply(this,arguments)}function Q(e,t,i){if(1===e.length&&p(e[0])&&(e=e[0]),e.length<2)throw new A("streams");var s,a,u,c=new G,l=c.signal,h=null==i?void 0:i.signal,f=[];function m(){S(new P)}I(h,"options.signal"),o=o||n(61601).addAbortListener,h&&(s=o(h,m));var g,b=[],_=0;function w(e){S(e,0==--_)}function S(e,n){var r;if(!e||a&&"ERR_STREAM_PREMATURE_CLOSE"!==a.code||(a=e),a||n){for(;b.length;)b.shift()(a);null===(r=s)||void 0===r||r[v](),c.abort(),n&&(a||f.forEach((function(e){return e()})),d.nextTick(t,a,u))}}for(var E,C,R=function(){var t=e[N],o=N<e.length-1,s=N>0,a=o||!1!==(null==i?void 0:i.end),c=N===e.length-1;if(F(t)){var h=function(e){e&&"AbortError"!==e.name&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code&&w(e)};if(a){var p=H(t,o,s),m=p.destroy,v=p.cleanup;b.push(m),L(t)&&c&&f.push(v)}t.on("error",h),L(t)&&c&&f.push((function(){t.removeListener("error",h)}))}if(0===N)if("function"==typeof t){if(g=t({signal:l}),!D(g))throw new M("Iterable, AsyncIterable or Stream","source",g)}else g=D(t)||U(t)||B(t)?t:x.from(t);else if("function"==typeof t)if(g=B(g)?q(null===(E=g)||void 0===E?void 0:E.readable):q(g),g=t(g,{signal:l}),o){if(!D(g,!0))throw new M("AsyncIterable","transform[".concat(N-1,"]"),g)}else{r||(r=n(12610));var S=new r({objectMode:!0}),A=null===(C=g)||void 0===C?void 0:C.then;if("function"==typeof A)_++,A.call(g,(function(e){u=e,null!=e&&S.write(e),a&&S.end(),d.nextTick(w)}),(function(e){S.destroy(e),d.nextTick(w,e)}));else if(D(g,!0))_++,Z(g,S,w,{end:a});else{if(!j(g)&&!B(g))throw new M("AsyncIterable or Promise","destination",g);var P=g.readable||g;_++,Z(P,S,w,{end:a})}var R=H(g=S,!1,!0),I=R.destroy,k=R.cleanup;b.push(I),c&&f.push(k)}else if(F(t)){if(U(g)){_+=2;var G=function(e,t,n,r){var i=r.end,o=!1;if(t.on("close",(function(){o||n(new O)})),e.pipe(t,{end:!1}),i){var s=function(){o=!0,t.end()};V(e)?d.nextTick(s):e.once("end",s)}else n();return y(e,{readable:!0,writable:!1},(function(t){var r=e._readableState;t&&"ERR_STREAM_PREMATURE_CLOSE"===t.code&&r&&r.ended&&!r.errored&&!r.errorEmitted?e.once("end",n).once("error",n):n(t)})),y(t,{readable:!1,writable:!0},n)}(g,t,w,{end:a});L(t)&&c&&f.push(G)}else if(B(g)||j(g)){var W=g.readable||g;_++,Z(W,t,w,{end:a})}else{if(!D(g))throw new T("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],g);_++,Z(g,t,w,{end:a})}g=t}else if(z(t)){if(U(g))_++,Y(q(g),t,w,{end:a});else if(j(g)||D(g))_++,Y(g,t,w,{end:a});else{if(!B(g))throw new T("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],g);_++,Y(g.readable,t,w,{end:a})}g=t}else g=x.from(t)},N=0;N<e.length;N++)R();return(null!=l&&l.aborted||null!=h&&h.aborted)&&d.nextTick(m),g}e.exports={pipelineImpl:Q,pipeline:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Q(t,b(W(t)))}}},1105:function(e,t,n){var r=n(26068).default,i=n(90228).default,o=n(335).default,s=n(34067).default,a=n(24661).default,u=n(14224),c=n(69153),l=c.ArrayPrototypeIndexOf,h=c.NumberIsInteger,d=c.NumberIsNaN,f=c.NumberParseInt,p=c.ObjectDefineProperties,m=c.ObjectKeys,g=c.ObjectSetPrototypeOf,v=c.Promise,y=c.SafeSet,b=c.SymbolAsyncDispose,_=c.SymbolAsyncIterator,x=c.Symbol;e.exports=ee,ee.ReadableState=J;var w=n(72100).EventEmitter,S=n(604),E=S.Stream,T=S.prependListener,M=n(55872).Buffer,A=n(69272).addAbortSignal,C=n(42415),O=n(61601).debuglog("stream",(function(e){O=e})),P=n(33558),R=n(44659),N=n(28662),I=N.getHighWaterMark,k=N.getDefaultHighWaterMark,D=n(61714),L=D.aggregateTwoErrors,U=D.codes,F=U.ERR_INVALID_ARG_TYPE,B=U.ERR_METHOD_NOT_IMPLEMENTED,z=U.ERR_OUT_OF_RANGE,j=U.ERR_STREAM_PUSH_AFTER_EOF,V=U.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,G=D.AbortError,H=n(8568).validateObject,W=x("kPaused"),q=n(72699).StringDecoder,X=n(64599);g(ee.prototype,E.prototype),g(ee,E);var Z=function(){},$=R.errorOrDestroy,Y=2048,K=4096;function Q(e){return{enumerable:!1,get:function(){return 0!=(this.state&e)},set:function(t){t?this.state|=e:this.state&=~e}}}function J(e,t,r){"boolean"!=typeof r&&(r=t instanceof n(80881)),this.state=6192,e&&e.objectMode&&(this.state|=1),r&&e&&e.readableObjectMode&&(this.state|=1),this.highWaterMark=e?I(this,e,"readableHighWaterMark",r):k(!1),this.buffer=new P,this.length=0,this.pipes=[],this.flowing=null,this[W]=null,e&&!1===e.emitClose&&(this.state&=-2049),e&&!1===e.autoDestroy&&(this.state&=-4097),this.errored=null,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,e&&e.encoding&&(this.decoder=new q(e.encoding),this.encoding=e.encoding)}function ee(e){var t=this;if(!(this instanceof ee))return new ee(e);var r=this instanceof n(80881);this._readableState=new J(e,this,r),e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&!r&&A(e.signal,this)),E.call(this,e),R.construct(this,(function(){t._readableState.needReadable&&ae(t,t._readableState)}))}function te(e,t,n,r){O("readableAddChunk",t);var i,o=e._readableState;if(0==(1&o.state)&&("string"==typeof t?(n=n||o.defaultEncoding,o.encoding!==n&&(r&&o.encoding?t=M.from(t,n).toString(o.encoding):(t=M.from(t,n),n=""))):t instanceof M?n="":E._isUint8Array(t)?(t=E._uint8ArrayToBuffer(t),n=""):null!=t&&(i=new F("chunk",["string","Buffer","Uint8Array"],t))),i)$(e,i);else if(null===t)o.state&=-9,function(e,t){if(O("onEofChunk"),t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?oe(e):(t.needReadable=!1,t.emittedReadable=!0,se(e))}(e,o);else if(0!=(1&o.state)||t&&t.length>0)if(r)if(0!=(4&o.state))$(e,new V);else{if(o.destroyed||o.errored)return!1;ne(e,o,t,!0)}else if(o.ended)$(e,new j);else{if(o.destroyed||o.errored)return!1;o.state&=-9,o.decoder&&!n?(t=o.decoder.write(t),o.objectMode||0!==t.length?ne(e,o,t,!1):ae(e,o)):ne(e,o,t,!1)}else r||(o.state&=-9,ae(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function ne(e,t,n,r){t.flowing&&0===t.length&&!t.sync&&e.listenerCount("data")>0?(0!=(65536&t.state)?t.awaitDrainWriters.clear():t.awaitDrainWriters=null,t.dataEmitted=!0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),0!=(64&t.state)&&oe(e)),ae(e,t)}p(J.prototype,{objectMode:Q(1),ended:Q(2),endEmitted:Q(4),reading:Q(8),constructed:Q(16),sync:Q(32),needReadable:Q(64),emittedReadable:Q(128),readableListening:Q(256),resumeScheduled:Q(512),errorEmitted:Q(1024),emitClose:Q(Y),autoDestroy:Q(K),destroyed:Q(8192),closed:Q(16384),closeEmitted:Q(32768),multiAwaitDrain:Q(65536),readingMore:Q(1<<17),dataEmitted:Q(1<<18)}),ee.prototype.destroy=R.destroy,ee.prototype._undestroy=R.undestroy,ee.prototype._destroy=function(e,t){t(e)},ee.prototype[w.captureRejectionSymbol]=function(e){this.destroy(e)},ee.prototype[b]=function(){var e,t=this;return this.destroyed||(e=this.readableEnded?null:new G,this.destroy(e)),new v((function(n,r){return C(t,(function(t){return t&&t!==e?r(t):n(null)}))}))},ee.prototype.push=function(e,t){return te(this,e,t,!1)},ee.prototype.unshift=function(e,t){return te(this,e,t,!0)},ee.prototype.isPaused=function(){var e=this._readableState;return!0===e[W]||!1===e.flowing},ee.prototype.setEncoding=function(e){var t=new q(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;var n,r=this._readableState.buffer,i="",s=o(r);try{for(s.s();!(n=s.n()).done;){var a=n.value;i+=t.write(a)}}catch(e){s.e(e)}finally{s.f()}return r.clear(),""!==i&&r.push(i),this._readableState.length=i.length,this};var re;function ie(e,t){return e<=0||0===t.length&&t.ended?0:0!=(1&t.state)?1:d(e)?t.flowing&&t.length?t.buffer.first().length:t.length:e<=t.length?e:t.ended?t.length:0}function oe(e){var t=e._readableState;O("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(O("emitReadable",t.flowing),t.emittedReadable=!0,u.nextTick(se,e))}function se(e){var t=e._readableState;O("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||t.errored||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,de(e)}function ae(e,t){!t.readingMore&&t.constructed&&(t.readingMore=!0,u.nextTick(ue,e,t))}function ue(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(O("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function ce(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!1===t[W]?t.flowing=!0:e.listenerCount("data")>0?e.resume():t.readableListening||(t.flowing=null)}function le(e){O("readable nexttick read 0"),e.read(0)}function he(e,t){O("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),de(e),t.flowing&&!t.reading&&e.read(0)}function de(e){var t=e._readableState;for(O("flow",t.flowing);t.flowing&&null!==e.read(););}function fe(e,t){"function"!=typeof e.read&&(e=ee.wrap(e,{objectMode:!0}));var n=function(e,t){return pe.apply(this,arguments)}(e,t);return n.stream=e,n}function pe(){return(pe=a(i().mark((function e(t,n){var r,o,a,u,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=function(e){this===t?(r(),r=Z):r=e},r=Z,t.on("readable",o),u=C(t,{writable:!1},(function(e){a=e?L(a,e):null,r(),r=Z})),e.prev=4;case 5:if(null===(c=t.destroyed?null:t.read())){e.next=12;break}return e.next=10,c;case 10:e.next=22;break;case 12:if(!a){e.next=16;break}throw a;case 16:if(null!==a){e.next=20;break}return e.abrupt("return");case 20:return e.next=22,s(new v(o));case 22:e.next=5;break;case 24:e.next=30;break;case 26:throw e.prev=26,e.t0=e.catch(4),a=L(a,e.t0);case 30:return e.prev=30,!a&&!1===(null==n?void 0:n.destroyOnReturn)||void 0!==a&&!t._readableState.autoDestroy?(t.off("readable",o),u()):R.destroyer(t,null),e.finish(30);case 33:case"end":return e.stop()}}),e,null,[[4,26,30,33]])})))).apply(this,arguments)}function me(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function ge(e){var t=e._readableState;O("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,u.nextTick(ve,t,e))}function ve(e,t){if(O("endReadableNT",e.endEmitted,e.length),!e.errored&&!e.closeEmitted&&!e.endEmitted&&0===e.length)if(e.endEmitted=!0,t.emit("end"),t.writable&&!1===t.allowHalfOpen)u.nextTick(ye,t);else if(e.autoDestroy){var n=t._writableState;(!n||n.autoDestroy&&(n.finished||!1===n.writable))&&t.destroy()}}function ye(e){e.writable&&!e.writableEnded&&!e.destroyed&&e.end()}function be(){return void 0===re&&(re={}),re}ee.prototype.read=function(e){O("read",e),void 0===e?e=NaN:h(e)||(e=f(e,10));var t=this._readableState,n=e;if(e>t.highWaterMark&&(t.highWaterMark=function(e){if(e>1073741824)throw new z("size","<= 1GiB",e);return e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e}(e)),0!==e&&(t.state&=-129),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return O("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?ge(this):oe(this),null;if(0===(e=ie(e,t))&&t.ended)return 0===t.length&&ge(this),null;var r,i=0!=(64&t.state);if(O("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&O("length less than watermark",i=!0),t.ended||t.reading||t.destroyed||t.errored||!t.constructed)O("reading, ended or constructing",i=!1);else if(i){O("do read"),t.state|=40,0===t.length&&(t.state|=64);try{this._read(t.highWaterMark)}catch(e){$(this,e)}t.state&=-33,t.reading||(e=ie(n,t))}return null===(r=e>0?me(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&ge(this)),null===r||t.errorEmitted||t.closeEmitted||(t.dataEmitted=!0,this.emit("data",r)),r},ee.prototype._read=function(e){throw new B("_read()")},ee.prototype.pipe=function(e,t){var n=this,r=this._readableState;1===r.pipes.length&&(r.multiAwaitDrain||(r.multiAwaitDrain=!0,r.awaitDrainWriters=new y(r.awaitDrainWriters?[r.awaitDrainWriters]:[]))),r.pipes.push(e),O("pipe count=%d opts=%j",r.pipes.length,t);var i,o=(!t||!1!==t.end)&&e!==u.stdout&&e!==u.stderr?a:m;function s(t,o){O("onunpipe"),t===n&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,function(){O("cleanup"),e.removeListener("close",f),e.removeListener("finish",p),i&&e.removeListener("drain",i);e.removeListener("error",d),e.removeListener("unpipe",s),n.removeListener("end",a),n.removeListener("end",m),n.removeListener("data",h),c=!0,i&&r.awaitDrainWriters&&(!e._writableState||e._writableState.needDrain)&&i()}())}function a(){O("onend"),e.end()}r.endEmitted?u.nextTick(o):n.once("end",o),e.on("unpipe",s);var c=!1;function l(){c||(1===r.pipes.length&&r.pipes[0]===e?(O("false write response, pause",0),r.awaitDrainWriters=e,r.multiAwaitDrain=!1):r.pipes.length>1&&r.pipes.includes(e)&&(O("false write response, pause",r.awaitDrainWriters.size),r.awaitDrainWriters.add(e)),n.pause()),i||(i=function(e,t){return function(){var n=e._readableState;n.awaitDrainWriters===t?(O("pipeOnDrain",1),n.awaitDrainWriters=null):n.multiAwaitDrain&&(O("pipeOnDrain",n.awaitDrainWriters.size),n.awaitDrainWriters.delete(t)),n.awaitDrainWriters&&0!==n.awaitDrainWriters.size||!e.listenerCount("data")||e.resume()}}(n,e),e.on("drain",i))}function h(t){O("ondata");var n=e.write(t);O("dest.write",n),!1===n&&l()}function d(t){if(O("onerror",t),m(),e.removeListener("error",d),0===e.listenerCount("error")){var n=e._writableState||e._readableState;n&&!n.errorEmitted?$(e,t):e.emit("error",t)}}function f(){e.removeListener("finish",p),m()}function p(){O("onfinish"),e.removeListener("close",f),m()}function m(){O("unpipe"),n.unpipe(e)}return n.on("data",h),T(e,"error",d),e.once("close",f),e.once("finish",p),e.emit("pipe",n),!0===e.writableNeedDrain?l():r.flowing||(O("pipe resume"),n.resume()),e},ee.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipes.length)return this;if(!e){var n=t.pipes;t.pipes=[],this.pause();for(var r=0;r<n.length;r++)n[r].emit("unpipe",this,{hasUnpiped:!1});return this}var i=l(t.pipes,e);return-1===i||(t.pipes.splice(i,1),0===t.pipes.length&&this.pause(),e.emit("unpipe",this,{hasUnpiped:!1})),this},ee.prototype.on=function(e,t){var n=E.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,O("on readable",r.length,r.reading),r.length?oe(this):r.reading||u.nextTick(le,this))),n},ee.prototype.addListener=ee.prototype.on,ee.prototype.removeListener=function(e,t){var n=E.prototype.removeListener.call(this,e,t);return"readable"===e&&u.nextTick(ce,this),n},ee.prototype.off=ee.prototype.removeListener,ee.prototype.removeAllListeners=function(e){var t=E.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||u.nextTick(ce,this),t},ee.prototype.resume=function(){var e=this._readableState;return e.flowing||(O("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,u.nextTick(he,e,t))}(this,e)),e[W]=!1,this},ee.prototype.pause=function(){return O("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(O("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[W]=!0,this},ee.prototype.wrap=function(e){var t=this,n=!1;e.on("data",(function(r){!t.push(r)&&e.pause&&(n=!0,e.pause())})),e.on("end",(function(){t.push(null)})),e.on("error",(function(e){$(t,e)})),e.on("close",(function(){t.destroy()})),e.on("destroy",(function(){t.destroy()})),this._read=function(){n&&e.resume&&(n=!1,e.resume())};for(var r=m(e),i=1;i<r.length;i++){var o=r[i];void 0===this[o]&&"function"==typeof e[o]&&(this[o]=e[o].bind(e))}return this},ee.prototype[_]=function(){return fe(this)},ee.prototype.iterator=function(e){return void 0!==e&&H(e,"options"),fe(this,e)},p(ee.prototype,{readable:{__proto__:null,get:function(){var e=this._readableState;return!(!e||!1===e.readable||e.destroyed||e.errorEmitted||e.endEmitted)},set:function(e){this._readableState&&(this._readableState.readable=!!e)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._readableState.readable||!this._readableState.destroyed&&!this._readableState.errored||this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}},readableLength:{__proto__:null,enumerable:!1,get:function(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get:function(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get:function(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get:function(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get:function(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get:function(){return!!this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}},readableEnded:{__proto__:null,enumerable:!1,get:function(){return!!this._readableState&&this._readableState.endEmitted}}}),p(J.prototype,{pipesCount:{__proto__:null,get:function(){return this.pipes.length}},paused:{__proto__:null,get:function(){return!1!==this[W]},set:function(e){this[W]=!!e}}}),ee._fromList=me,ee.from=function(e,t){return X(ee,e,t)},ee.fromWeb=function(e,t){return be().newStreamReadableFromReadableStream(e,t)},ee.toWeb=function(e,t){return be().newReadableStreamFromStreamReadable(e,t)},ee.wrap=function(e,t){var n,i;return new ee(r(r({objectMode:null===(n=null!==(i=e.readableObjectMode)&&void 0!==i?i:e.objectMode)||void 0===n||n},t),{},{destroy:function(t,n){R.destroyer(e,t),n(t)}})).wrap(e)}},28662:function(e,t,n){"use strict";var r=n(69153),i=r.MathFloor,o=r.NumberIsInteger,s=n(8568).validateInteger,a=n(61714).codes.ERR_INVALID_ARG_VALUE,u=16384,c=16;function l(e){return e?c:u}e.exports={getHighWaterMark:function(e,t,n,r){var s=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,r,n);if(null!=s){if(!o(s)||s<0){var u=r?"options.".concat(n):"options.highWaterMark";throw new a(u,s)}return i(s)}return l(e.objectMode)},getDefaultHighWaterMark:l,setDefaultHighWaterMark:function(e,t){s(t,"value",0),e?c=t:u=t}}},35378:function(e,t,n){"use strict";var r=n(26068).default,i=n(69153),o=i.ObjectSetPrototypeOf,s=i.Symbol;e.exports=h;var a=n(61714).codes.ERR_METHOD_NOT_IMPLEMENTED,u=n(80881),c=n(28662).getHighWaterMark;o(h.prototype,u.prototype),o(h,u);var l=s("kCallback");function h(e){if(!(this instanceof h))return new h(e);var t=e?c(this,e,"readableHighWaterMark",!0):null;0===t&&(e=r(r({},e),{},{highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0})),u.call(this,e),this._readableState.sync=!1,this[l]=null,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",f)}function d(e){var t=this;"function"!=typeof this._flush||this.destroyed?(this.push(null),e&&e()):this._flush((function(n,r){n?e?e(n):t.destroy(n):(null!=r&&t.push(r),t.push(null),e&&e())}))}function f(){this._final!==d&&d.call(this)}h.prototype._final=d,h.prototype._transform=function(e,t,n){throw new a("_transform()")},h.prototype._write=function(e,t,n){var r=this,i=this._readableState,o=this._writableState,s=i.length;this._transform(e,t,(function(e,t){e?n(e):(null!=t&&r.push(t),o.ended||s===i.length||i.length<i.highWaterMark?n():r[l]=n)}))},h.prototype._read=function(){if(this[l]){var e=this[l];this[l]=null,e()}}},39033:function(e,t,n){"use strict";var r=n(31759).default,i=n(69153),o=i.SymbolAsyncIterator,s=i.SymbolIterator,a=i.SymbolFor,u=a("nodejs.stream.destroyed"),c=a("nodejs.stream.errored"),l=a("nodejs.stream.readable"),h=a("nodejs.stream.writable"),d=a("nodejs.stream.disturbed"),f=a("nodejs.webstream.isClosedPromise"),p=a("nodejs.webstream.controllerErrorFunction");function m(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!(!e||"function"!=typeof e.pipe||"function"!=typeof e.on||n&&("function"!=typeof e.pause||"function"!=typeof e.resume)||e._writableState&&!1===(null===(t=e._readableState)||void 0===t?void 0:t.readable)||e._writableState&&!e._readableState)}function g(e){var t;return!(!e||"function"!=typeof e.write||"function"!=typeof e.on||e._readableState&&!1===(null===(t=e._writableState)||void 0===t?void 0:t.writable))}function v(e){return e&&(e._readableState||e._writableState||"function"==typeof e.write&&"function"==typeof e.on||"function"==typeof e.pipe&&"function"==typeof e.on)}function y(e){return!(!e||v(e)||"function"!=typeof e.pipeThrough||"function"!=typeof e.getReader||"function"!=typeof e.cancel)}function b(e){return!(!e||v(e)||"function"!=typeof e.getWriter||"function"!=typeof e.abort)}function _(e){return!(!e||v(e)||"object"!==r(e.readable)||"object"!==r(e.writable))}function x(e){if(!v(e))return null;var t=e._writableState,n=e._readableState,r=t||n;return!!(e.destroyed||e[u]||null!=r&&r.destroyed)}function w(e){if(!g(e))return null;if(!0===e.writableEnded)return!0;var t=e._writableState;return(null==t||!t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)}function S(e,t){if(!m(e))return null;var n=e._readableState;return(null==n||!n.errored)&&("boolean"!=typeof(null==n?void 0:n.endEmitted)?null:!!(n.endEmitted||!1===t&&!0===n.ended&&0===n.length))}function E(e){return e&&null!=e[l]?e[l]:"boolean"!=typeof(null==e?void 0:e.readable)?null:!x(e)&&(m(e)&&e.readable&&!S(e))}function T(e){return e&&null!=e[h]?e[h]:"boolean"!=typeof(null==e?void 0:e.writable)?null:!x(e)&&(g(e)&&e.writable&&!w(e))}function M(e){return"boolean"==typeof e._closed&&"boolean"==typeof e._defaultKeepAlive&&"boolean"==typeof e._removedConnection&&"boolean"==typeof e._removedContLen}function A(e){return"boolean"==typeof e._sent100&&M(e)}e.exports={isDestroyed:x,kIsDestroyed:u,isDisturbed:function(e){var t;return!(!e||!(null!==(t=e[d])&&void 0!==t?t:e.readableDidRead||e.readableAborted))},kIsDisturbed:d,isErrored:function(e){var t,n,r,i,o,s,a,u,l,h;return!(!e||!(null!==(t=null!==(n=null!==(r=null!==(i=null!==(o=null!==(s=e[c])&&void 0!==s?s:e.readableErrored)&&void 0!==o?o:e.writableErrored)&&void 0!==i?i:null===(a=e._readableState)||void 0===a?void 0:a.errorEmitted)&&void 0!==r?r:null===(u=e._writableState)||void 0===u?void 0:u.errorEmitted)&&void 0!==n?n:null===(l=e._readableState)||void 0===l?void 0:l.errored)&&void 0!==t?t:null===(h=e._writableState)||void 0===h?void 0:h.errored))},kIsErrored:c,isReadable:E,kIsReadable:l,kIsClosedPromise:f,kControllerErrorFunction:p,kIsWritable:h,isClosed:function(e){if(!v(e))return null;if("boolean"==typeof e.closed)return e.closed;var t=e._writableState,n=e._readableState;return"boolean"==typeof(null==t?void 0:t.closed)||"boolean"==typeof(null==n?void 0:n.closed)?(null==t?void 0:t.closed)||(null==n?void 0:n.closed):"boolean"==typeof e._closed&&M(e)?e._closed:null},isDuplexNodeStream:function(e){return!(!e||"function"!=typeof e.pipe||!e._readableState||"function"!=typeof e.on||"function"!=typeof e.write)},isFinished:function(e,t){return v(e)?!!x(e)||(!1===(null==t?void 0:t.readable)||!E(e))&&(!1===(null==t?void 0:t.writable)||!T(e)):null},isIterable:function(e,t){return null!=e&&(!0===t?"function"==typeof e[o]:!1===t?"function"==typeof e[s]:"function"==typeof e[o]||"function"==typeof e[s])},isReadableNodeStream:m,isReadableStream:y,isReadableEnded:function(e){if(!m(e))return null;if(!0===e.readableEnded)return!0;var t=e._readableState;return!(!t||t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)},isReadableFinished:S,isReadableErrored:function(e){var t,n;return v(e)?e.readableErrored?e.readableErrored:null!==(t=null===(n=e._readableState)||void 0===n?void 0:n.errored)&&void 0!==t?t:null:null},isNodeStream:v,isWebStream:function(e){return y(e)||b(e)||_(e)},isWritable:T,isWritableNodeStream:g,isWritableStream:b,isWritableEnded:w,isWritableFinished:function(e,t){if(!g(e))return null;if(!0===e.writableFinished)return!0;var n=e._writableState;return(null==n||!n.errored)&&("boolean"!=typeof(null==n?void 0:n.finished)?null:!!(n.finished||!1===t&&!0===n.ended&&0===n.length))},isWritableErrored:function(e){var t,n;return v(e)?e.writableErrored?e.writableErrored:null!==(t=null===(n=e._writableState)||void 0===n?void 0:n.errored)&&void 0!==t?t:null:null},isServerRequest:function(e){var t;return"boolean"==typeof e._consuming&&"boolean"==typeof e._dumped&&void 0===(null===(t=e.req)||void 0===t?void 0:t.upgradeOrConnect)},isServerResponse:A,willEmitClose:function(e){if(!v(e))return null;var t=e._writableState,n=e._readableState,r=t||n;return!r&&A(e)||!!(r&&r.autoDestroy&&r.emitClose&&!1===r.closed)},isTransformStream:_}},29840:function(e,t,n){var r=n(14224),i=n(69153),o=i.ArrayPrototypeSlice,s=i.Error,a=i.FunctionPrototypeSymbolHasInstance,u=i.ObjectDefineProperty,c=i.ObjectDefineProperties,l=i.ObjectSetPrototypeOf,h=i.StringPrototypeToLowerCase,d=i.Symbol,f=i.SymbolHasInstance;e.exports=U,U.WritableState=D;var p=n(72100).EventEmitter,m=n(604).Stream,g=n(55872).Buffer,v=n(44659),y=n(69272).addAbortSignal,b=n(28662),_=b.getHighWaterMark,x=b.getDefaultHighWaterMark,w=n(61714).codes,S=w.ERR_INVALID_ARG_TYPE,E=w.ERR_METHOD_NOT_IMPLEMENTED,T=w.ERR_MULTIPLE_CALLBACK,M=w.ERR_STREAM_CANNOT_PIPE,A=w.ERR_STREAM_DESTROYED,C=w.ERR_STREAM_ALREADY_FINISHED,O=w.ERR_STREAM_NULL_VALUES,P=w.ERR_STREAM_WRITE_AFTER_END,R=w.ERR_UNKNOWN_ENCODING,N=v.errorOrDestroy;function I(){}l(U.prototype,m.prototype),l(U,m);var k=d("kOnFinished");function D(e,t,r){"boolean"!=typeof r&&(r=t instanceof n(80881)),this.objectMode=!(!e||!e.objectMode),r&&(this.objectMode=this.objectMode||!(!e||!e.writableObjectMode)),this.highWaterMark=e?_(this,e,"writableHighWaterMark",r):x(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=!(!e||!1!==e.decodeStrings);this.decodeStrings=!i,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=j.bind(void 0,t),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,L(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[k]=[]}function L(e){e.buffered=[],e.bufferedIndex=0,e.allBuffers=!0,e.allNoop=!0}function U(e){var t=this,r=this instanceof n(80881);if(!r&&!a(U,this))return new U(e);this._writableState=new D(e,this,r),e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&y(e.signal,this)),m.call(this,e),v.construct(this,(function(){var e=t._writableState;e.writing||W(t,e),Z(t,e)}))}function F(e,t,n,i){var o,s=e._writableState;if("function"==typeof n)i=n,n=s.defaultEncoding;else{if(n){if("buffer"!==n&&!g.isEncoding(n))throw new R(n)}else n=s.defaultEncoding;"function"!=typeof i&&(i=I)}if(null===t)throw new O;if(!s.objectMode)if("string"==typeof t)!1!==s.decodeStrings&&(t=g.from(t,n),n="buffer");else if(t instanceof g)n="buffer";else{if(!m._isUint8Array(t))throw new S("chunk",["string","Buffer","Uint8Array"],t);t=m._uint8ArrayToBuffer(t),n="buffer"}return s.ending?o=new P:s.destroyed&&(o=new A("write")),o?(r.nextTick(i,o),N(e,o,!0),o):(s.pendingcb++,function(e,t,n,r,i){var o=t.objectMode?1:n.length;t.length+=o;var s=t.length<t.highWaterMark;s||(t.needDrain=!0);t.writing||t.corked||t.errored||!t.constructed?(t.buffered.push({chunk:n,encoding:r,callback:i}),t.allBuffers&&"buffer"!==r&&(t.allBuffers=!1),t.allNoop&&i!==I&&(t.allNoop=!1)):(t.writelen=o,t.writecb=i,t.writing=!0,t.sync=!0,e._write(n,r,t.onwrite),t.sync=!1);return s&&!t.errored&&!t.destroyed}(e,s,t,n,i))}function B(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new A("write")):n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function z(e,t,n,r){--t.pendingcb,r(n),H(t),N(e,n)}function j(e,t){var n=e._writableState,i=n.sync,o=n.writecb;"function"==typeof o?(n.writing=!1,n.writecb=null,n.length-=n.writelen,n.writelen=0,t?(t.stack,n.errored||(n.errored=t),e._readableState&&!e._readableState.errored&&(e._readableState.errored=t),i?r.nextTick(z,e,n,t,o):z(e,n,t,o)):(n.buffered.length>n.bufferedIndex&&W(e,n),i?null!==n.afterWriteTickInfo&&n.afterWriteTickInfo.cb===o?n.afterWriteTickInfo.count++:(n.afterWriteTickInfo={count:1,cb:o,stream:e,state:n},r.nextTick(V,n.afterWriteTickInfo)):G(e,n,1,o))):N(e,new T)}function V(e){var t=e.stream,n=e.state,r=e.count,i=e.cb;return n.afterWriteTickInfo=null,G(t,n,r,i)}function G(e,t,n,r){for(!t.ending&&!e.destroyed&&0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"));n-- >0;)t.pendingcb--,r();t.destroyed&&H(t),Z(e,t)}function H(e){if(!e.writing){for(var t=e.bufferedIndex;t<e.buffered.length;++t){var n,r=e.buffered[t],i=r.chunk,o=r.callback,s=e.objectMode?1:i.length;e.length-=s,o(null!==(n=e.errored)&&void 0!==n?n:new A("write"))}for(var a=e[k].splice(0),u=0;u<a.length;u++){var c;a[u](null!==(c=e.errored)&&void 0!==c?c:new A("end"))}L(e)}}function W(e,t){if(!(t.corked||t.bufferProcessing||t.destroyed)&&t.constructed){var n=t.buffered,r=t.bufferedIndex,i=t.objectMode,s=n.length-r;if(s){var a=r;if(t.bufferProcessing=!0,s>1&&e._writev){t.pendingcb-=s-1;var u=t.allNoop?I:function(e){for(var t=a;t<n.length;++t)n[t].callback(e)},c=t.allNoop&&0===a?n:o(n,a);c.allBuffers=t.allBuffers,B(e,t,!0,t.length,c,"",u),L(t)}else{do{var l=n[a],h=l.chunk,d=l.encoding,f=l.callback;n[a++]=null,B(e,t,!1,i?1:h.length,h,d,f)}while(a<n.length&&!t.writing);a===n.length?L(t):a>256?(n.splice(0,a),t.bufferedIndex=0):t.bufferedIndex=a}t.bufferProcessing=!1}}}function q(e){return e.ending&&!e.destroyed&&e.constructed&&0===e.length&&!e.errored&&0===e.buffered.length&&!e.finished&&!e.writing&&!e.errorEmitted&&!e.closeEmitted}function X(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.finalCalled=!0,function(e,t){var n=!1;function i(i){if(n)N(e,null!=i?i:T());else if(n=!0,t.pendingcb--,i){for(var o=t[k].splice(0),s=0;s<o.length;s++)o[s](i);N(e,i,t.sync)}else q(t)&&(t.prefinished=!0,e.emit("prefinish"),t.pendingcb++,r.nextTick($,e,t))}t.sync=!0,t.pendingcb++;try{e._final(i)}catch(e){i(e)}t.sync=!1}(e,t)))}function Z(e,t,n){q(t)&&(X(e,t),0===t.pendingcb&&(n?(t.pendingcb++,r.nextTick((function(e,t){q(t)?$(e,t):t.pendingcb--}),e,t)):q(t)&&(t.pendingcb++,$(e,t))))}function $(e,t){t.pendingcb--,t.finished=!0;for(var n=t[k].splice(0),r=0;r<n.length;r++)n[r]();if(e.emit("finish"),t.autoDestroy){var i=e._readableState;(!i||i.autoDestroy&&(i.endEmitted||!1===i.readable))&&e.destroy()}}D.prototype.getBuffer=function(){return o(this.buffered,this.bufferedIndex)},u(D.prototype,"bufferedRequestCount",{__proto__:null,get:function(){return this.buffered.length-this.bufferedIndex}}),u(U,f,{__proto__:null,value:function(e){return!!a(this,e)||this===U&&(e&&e._writableState instanceof D)}}),U.prototype.pipe=function(){N(this,new M)},U.prototype.write=function(e,t,n){return!0===F(this,e,t,n)},U.prototype.cork=function(){this._writableState.corked++},U.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||W(this,e))},U.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=h(e)),!g.isEncoding(e))throw new R(e);return this._writableState.defaultEncoding=e,this},U.prototype._write=function(e,t,n){if(!this._writev)throw new E("_write()");this._writev([{chunk:e,encoding:t}],n)},U.prototype._writev=null,U.prototype.end=function(e,t,n){var i,o=this._writableState;if("function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e){var a=F(this,e,t);a instanceof s&&(i=a)}return o.corked&&(o.corked=1,this.uncork()),i||(o.errored||o.ending?o.finished?i=new C("end"):o.destroyed&&(i=new A("end")):(o.ending=!0,Z(this,o,!0),o.ended=!0)),"function"==typeof n&&(i||o.finished?r.nextTick(n,i):o[k].push(n)),this},c(U.prototype,{closed:{__proto__:null,get:function(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get:function(){return!!this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}},writable:{__proto__:null,get:function(){var e=this._writableState;return!(!e||!1===e.writable||e.destroyed||e.errored||e.ending||e.ended)},set:function(e){this._writableState&&(this._writableState.writable=!!e)}},writableFinished:{__proto__:null,get:function(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get:function(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get:function(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get:function(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get:function(){var e=this._writableState;return!!e&&(!e.destroyed&&!e.ending&&e.needDrain)}},writableHighWaterMark:{__proto__:null,get:function(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get:function(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get:function(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get:function(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._writableState.writable||!this._writableState.destroyed&&!this._writableState.errored||this._writableState.finished)}}});var Y,K=v.destroy;function Q(){return void 0===Y&&(Y={}),Y}U.prototype.destroy=function(e,t){var n=this._writableState;return!n.destroyed&&(n.bufferedIndex<n.buffered.length||n[k].length)&&r.nextTick(H,n),K.call(this,e,t),this},U.prototype._undestroy=v.undestroy,U.prototype._destroy=function(e,t){t(e)},U.prototype[p.captureRejectionSymbol]=function(e){this.destroy(e)},U.fromWeb=function(e,t){return Q().newStreamWritableFromWritableStream(e,t)},U.toWeb=function(e){return Q().newWritableStreamFromStreamWritable(e)}},8568:function(e,t,n){"use strict";var r=n(31759).default,i=n(69153),o=i.ArrayIsArray,s=i.ArrayPrototypeIncludes,a=i.ArrayPrototypeJoin,u=i.ArrayPrototypeMap,c=i.NumberIsInteger,l=i.NumberIsNaN,h=i.NumberMAX_SAFE_INTEGER,d=i.NumberMIN_SAFE_INTEGER,f=i.NumberParseInt,p=i.ObjectPrototypeHasOwnProperty,m=i.RegExpPrototypeExec,g=i.String,v=i.StringPrototypeToUpperCase,y=i.StringPrototypeTrim,b=n(61714),_=b.hideStackFrames,x=b.codes,w=x.ERR_SOCKET_BAD_PORT,S=x.ERR_INVALID_ARG_TYPE,E=x.ERR_INVALID_ARG_VALUE,T=x.ERR_OUT_OF_RANGE,M=x.ERR_UNKNOWN_SIGNAL,A=n(61601).normalizeEncoding,C=n(61601).types,O=C.isAsyncFunction,P=C.isArrayBufferView,R={};var N=/^[0-7]+$/;var I=_((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:h;if("number"!=typeof e)throw new S(t,"number",e);if(!c(e))throw new T(t,"an integer",e);if(e<n||e>r)throw new T(t,">= ".concat(n," && <= ").concat(r),e)})),k=_((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-2147483648,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2147483647;if("number"!=typeof e)throw new S(t,"number",e);if(!c(e))throw new T(t,"an integer",e);if(e<n||e>r)throw new T(t,">= ".concat(n," && <= ").concat(r),e)})),D=_((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"!=typeof e)throw new S(t,"number",e);if(!c(e))throw new T(t,"an integer",e);var r=n?1:0,i=4294967295;if(e<r||e>i)throw new T(t,">= ".concat(r," && <= ").concat(i),e)}));function L(e,t){if("string"!=typeof e)throw new S(t,"string",e)}var U=_((function(e,t,n){if(!s(n,e)){var r=a(u(n,(function(e){return"string"==typeof e?"'".concat(e,"'"):g(e)})),", ");throw new E(t,e,"must be one of: "+r)}}));function F(e,t){if("boolean"!=typeof e)throw new S(t,"boolean",e)}function B(e,t,n){return null!=e&&p(e,t)?e[t]:n}var z=_((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=B(n,"allowArray",!1),s=B(n,"allowFunction",!1),a=B(n,"nullable",!1);if(!a&&null===e||!i&&o(e)||"object"!==r(e)&&(!s||"function"!=typeof e))throw new S(t,"Object",e)})),j=_((function(e,t){if(null!=e&&"object"!==r(e)&&"function"!=typeof e)throw new S(t,"a dictionary",e)})),V=_((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!o(e))throw new S(t,"Array",e);if(e.length<n){var r="must be longer than ".concat(n);throw new E(t,e,r)}}));var G=_((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"buffer";if(!P(e))throw new S(t,["Buffer","TypedArray","DataView"],e)}));var H=_((function(e,t){if(void 0!==e&&(null===e||"object"!==r(e)||!("aborted"in e)))throw new S(t,"AbortSignal",e)})),W=_((function(e,t){if("function"!=typeof e)throw new S(t,"Function",e)})),q=_((function(e,t){if("function"!=typeof e||O(e))throw new S(t,"Function",e)})),X=_((function(e,t){if(void 0!==e)throw new S(t,"undefined",e)}));var Z=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function $(e,t){if(void 0===e||!m(Z,e))throw new E(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}e.exports={isInt32:function(e){return e===(0|e)},isUint32:function(e){return e===e>>>0},parseFileMode:function(e,t,n){if(void 0===e&&(e=n),"string"==typeof e){if(null===m(N,e))throw new E(t,e,"must be a 32-bit unsigned integer or an octal string");e=f(e,8)}return D(e,t),e},validateArray:V,validateStringArray:function(e,t){V(e,t);for(var n=0;n<e.length;n++)L(e[n],"".concat(t,"[").concat(n,"]"))},validateBooleanArray:function(e,t){V(e,t);for(var n=0;n<e.length;n++)F(e[n],"".concat(t,"[").concat(n,"]"))},validateAbortSignalArray:function(e,t){V(e,t);for(var n=0;n<e.length;n++){var r=e[n],i="".concat(t,"[").concat(n,"]");if(null==r)throw new S(i,"AbortSignal",r);H(r,i)}},validateBoolean:F,validateBuffer:G,validateDictionary:j,validateEncoding:function(e,t){var n=A(t),r=e.length;if("hex"===n&&r%2!=0)throw new E("encoding",t,"is invalid for data of length ".concat(r))},validateFunction:W,validateInt32:k,validateInteger:I,validateNumber:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if("number"!=typeof e)throw new S(t,"number",e);if(null!=n&&e<n||null!=r&&e>r||(null!=n||null!=r)&&l(e))throw new T(t,"".concat(null!=n?">= ".concat(n):"").concat(null!=n&&null!=r?" && ":"").concat(null!=r?"<= ".concat(r):""),e)},validateObject:z,validateOneOf:U,validatePlainFunction:q,validatePort:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Port",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if("number"!=typeof e&&"string"!=typeof e||"string"==typeof e&&0===y(e).length||+e!=+e>>>0||e>65535||0===e&&!n)throw new w(t,e,n);return 0|e},validateSignalName:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"signal";if(L(e,t),void 0===R[e]){if(void 0!==R[v(e)])throw new M(e+" (signals must use all capital letters)");throw new M(e)}},validateString:L,validateUint32:D,validateUndefined:X,validateUnion:function(e,t,n){if(!s(n,e))throw new S(t,"('".concat(a(n,"|"),"')"),e)},validateAbortSignal:H,validateLinkHeaderValue:function(e){if("string"==typeof e)return $(e,"hints"),e;if(o(e)){var t=e.length,n="";if(0===t)return n;for(var r=0;r<t;r++){var i=e[r];$(i,"hints"),n+=i,r!==t-1&&(n+=", ")}return n}throw new E("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}}},34654:function(e,t,n){"use strict";var r=n(20408),i=n(88954),o=r.Readable.destroy;e.exports=r.Readable,e.exports._uint8ArrayToBuffer=r._uint8ArrayToBuffer,e.exports._isUint8Array=r._isUint8Array,e.exports.isDisturbed=r.isDisturbed,e.exports.isErrored=r.isErrored,e.exports.isReadable=r.isReadable,e.exports.Readable=r.Readable,e.exports.Writable=r.Writable,e.exports.Duplex=r.Duplex,e.exports.Transform=r.Transform,e.exports.PassThrough=r.PassThrough,e.exports.addAbortSignal=r.addAbortSignal,e.exports.finished=r.finished,e.exports.destroy=r.destroy,e.exports.destroy=o,e.exports.pipeline=r.pipeline,e.exports.compose=r.compose,Object.defineProperty(r,"promises",{configurable:!0,enumerable:!0,get:function(){return i}}),e.exports.Stream=r.Stream,e.exports.default=e.exports},61714:function(e,t,n){"use strict";var r=n(335).default,i=n(31759).default,o=n(53318).default,s=n(25298).default,a=n(17069).default,u=n(21742).default,c=n(83136).default,l=n(15558).default,h=n(61601),d=h.format,f=h.inspect,p=h.AggregateError,m=globalThis.AggregateError||p,g=Symbol("kIsNodeError"),v=["string","function","number","object","Function","Object","boolean","bigint","symbol"],y=/^([A-Z][a-z0-9]*)+$/,b={};function _(e,t){if(!e)throw new b.ERR_INTERNAL_ASSERTION(t)}function x(e){for(var t="",n=e.length,r="-"===e[0]?1:0;n>=r+4;n-=3)t="_".concat(e.slice(n-3,n)).concat(t);return"".concat(e.slice(0,n)).concat(t)}function w(e,t,n){if("function"==typeof t)return _(t.length<=n.length,"Code: ".concat(e,"; The provided arguments length (").concat(n.length,") does not match the required ones (").concat(t.length,").")),t.apply(void 0,l(n));var r=(t.match(/%[dfijoOs]/g)||[]).length;return _(r===n.length,"Code: ".concat(e,"; The provided arguments length (").concat(n.length,") does not match the required ones (").concat(r,").")),0===n.length?t:d.apply(void 0,[t].concat(l(n)))}function S(e,t,n){n||(n=Error);var r=function(n){u(i,n);var r=c(i);function i(){s(this,i);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return r.call(this,w(e,t,o))}return a(i,[{key:"toString",value:function(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}}]),i}(n);Object.defineProperties(r.prototype,{name:{value:n.name,writable:!0,enumerable:!1,configurable:!0},toString:{value:function(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)},writable:!0,enumerable:!1,configurable:!0}}),r.prototype.code=e,r.prototype[g]=!0,b[e]=r}function E(e){var t="__node_internal_"+e.name;return Object.defineProperty(e,"name",{value:t}),e}var T=function(e){u(n,e);var t=c(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(s(this,n),void 0!==o&&"object"!==i(o))throw new b.ERR_INVALID_ARG_TYPE("options","Object",o);return(e=t.call(this,r,o)).code="ABORT_ERR",e.name="AbortError",e}return a(n)}(o(Error));S("ERR_ASSERTION","%s",Error),S("ERR_INVALID_ARG_TYPE",(function(e,t,n){_("string"==typeof e,"'name' must be a string"),Array.isArray(t)||(t=[t]);var o="The ";e.endsWith(" argument")?o+="".concat(e," "):o+='"'.concat(e,'" ').concat(e.includes(".")?"property":"argument"," "),o+="must be ";var s,a=[],u=[],c=[],l=r(t);try{for(l.s();!(s=l.n()).done;){var h=s.value;_("string"==typeof h,"All expected entries have to be of type string"),v.includes(h)?a.push(h.toLowerCase()):y.test(h)?u.push(h):(_("object"!==h,'The value "object" should be written as "Object"'),c.push(h))}}catch(e){l.e(e)}finally{l.f()}if(u.length>0){var d=a.indexOf("object");-1!==d&&(a.splice(a,d,1),u.push("Object"))}if(a.length>0){switch(a.length){case 1:o+="of type ".concat(a[0]);break;case 2:o+="one of type ".concat(a[0]," or ").concat(a[1]);break;default:var p=a.pop();o+="one of type ".concat(a.join(", "),", or ").concat(p)}(u.length>0||c.length>0)&&(o+=" or ")}if(u.length>0){switch(u.length){case 1:o+="an instance of ".concat(u[0]);break;case 2:o+="an instance of ".concat(u[0]," or ").concat(u[1]);break;default:var m=u.pop();o+="an instance of ".concat(u.join(", "),", or ").concat(m)}c.length>0&&(o+=" or ")}switch(c.length){case 0:break;case 1:c[0].toLowerCase()!==c[0]&&(o+="an "),o+="".concat(c[0]);break;case 2:o+="one of ".concat(c[0]," or ").concat(c[1]);break;default:var g=c.pop();o+="one of ".concat(c.join(", "),", or ").concat(g)}if(null==n)o+=". Received ".concat(n);else if("function"==typeof n&&n.name)o+=". Received function ".concat(n.name);else if("object"===i(n)){var b;if(null!==(b=n.constructor)&&void 0!==b&&b.name)o+=". Received an instance of ".concat(n.constructor.name);else{var x=f(n,{depth:-1});o+=". Received ".concat(x)}}else{var w=f(n,{colors:!1});w.length>25&&(w="".concat(w.slice(0,25),"...")),o+=". Received type ".concat(i(n)," (").concat(w,")")}return o}),TypeError),S("ERR_INVALID_ARG_VALUE",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"is invalid",r=f(t);r.length>128&&(r=r.slice(0,128)+"...");var i=e.includes(".")?"property":"argument";return"The ".concat(i," '").concat(e,"' ").concat(n,". Received ").concat(r)}),TypeError),S("ERR_INVALID_RETURN_VALUE",(function(e,t,n){var r,o=null!=n&&null!==(r=n.constructor)&&void 0!==r&&r.name?"instance of ".concat(n.constructor.name):"type ".concat(i(n));return"Expected ".concat(e,' to be returned from the "').concat(t,'"')+" function but got ".concat(o,".")}),TypeError),S("ERR_MISSING_ARGS",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r;_(t.length>0,"At least one arg needs to be specified");var i=t.length;switch(t=(Array.isArray(t)?t:[t]).map((function(e){return'"'.concat(e,'"')})).join(" or "),i){case 1:r+="The ".concat(t[0]," argument");break;case 2:r+="The ".concat(t[0]," and ").concat(t[1]," arguments");break;default:var o=t.pop();r+="The ".concat(t.join(", "),", and ").concat(o," arguments")}return"".concat(r," must be specified")}),TypeError),S("ERR_OUT_OF_RANGE",(function(e,t,n){var r;return _(t,'Missing "range" argument'),Number.isInteger(n)&&Math.abs(n)>Math.pow(2,32)?r=x(String(n)):"bigint"==typeof n?(r=String(n),(n>Math.pow(2n,32n)||n<-Math.pow(2n,32n))&&(r=x(r)),r+="n"):r=f(n),'The value of "'.concat(e,'" is out of range. It must be ').concat(t,". Received ").concat(r)}),RangeError),S("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),S("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),S("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),S("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),S("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),S("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),S("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),S("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),S("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),S("ERR_STREAM_WRITE_AFTER_END","write after end",Error),S("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),e.exports={AbortError:T,aggregateTwoErrors:E((function(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;var n=new m([t,e],t.message);return n.code=t.code,n}return e||t})),hideStackFrames:E,codes:b}},69153:function(e){"use strict";e.exports={ArrayIsArray:function(e){return Array.isArray(e)},ArrayPrototypeIncludes:function(e,t){return e.includes(t)},ArrayPrototypeIndexOf:function(e,t){return e.indexOf(t)},ArrayPrototypeJoin:function(e,t){return e.join(t)},ArrayPrototypeMap:function(e,t){return e.map(t)},ArrayPrototypePop:function(e,t){return e.pop(t)},ArrayPrototypePush:function(e,t){return e.push(t)},ArrayPrototypeSlice:function(e,t,n){return e.slice(t,n)},Error:Error,FunctionPrototypeCall:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return e.call.apply(e,[t].concat(r))},FunctionPrototypeSymbolHasInstance:function(e,t){return Function.prototype[Symbol.hasInstance].call(e,t)},MathFloor:Math.floor,Number:Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties:function(e,t){return Object.defineProperties(e,t)},ObjectDefineProperty:function(e,t,n){return Object.defineProperty(e,t,n)},ObjectGetOwnPropertyDescriptor:function(e,t){return Object.getOwnPropertyDescriptor(e,t)},ObjectKeys:function(e){return Object.keys(e)},ObjectSetPrototypeOf:function(e,t){return Object.setPrototypeOf(e,t)},Promise:Promise,PromisePrototypeCatch:function(e,t){return e.catch(t)},PromisePrototypeThen:function(e,t,n){return e.then(t,n)},PromiseReject:function(e){return Promise.reject(e)},PromiseResolve:function(e){return Promise.resolve(e)},ReflectApply:Reflect.apply,RegExpPrototypeTest:function(e,t){return e.test(t)},SafeSet:Set,String:String,StringPrototypeSlice:function(e,t,n){return e.slice(t,n)},StringPrototypeToLowerCase:function(e){return e.toLowerCase()},StringPrototypeToUpperCase:function(e){return e.toUpperCase()},StringPrototypeTrim:function(e){return e.trim()},Symbol:Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet:function(e,t,n){return e.set(t,n)},Boolean:Boolean,Uint8Array:Uint8Array}},61601:function(e,t,n){"use strict";var r=n(82092).default,i=n(17069).default,o=n(25298).default,s=n(21742).default,a=n(83136).default,u=n(53318).default,c=n(31759).default,l=n(90228).default,h=n(87999).default,d=n(55872),f=n(69153),p=f.kResistStopPropagation,m=f.SymbolDispose,g=globalThis.AbortSignal||n(20366).AbortSignal,v=globalThis.AbortController||n(20366).AbortController,y=Object.getPrototypeOf(h(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))).constructor,b=globalThis.Blob||d.Blob,_=void 0!==b?function(e){return e instanceof b}:function(e){return!1},x=function(e,t){if(void 0!==e&&(null===e||"object"!==c(e)||!("aborted"in e)))throw new ERR_INVALID_ARG_TYPE(t,"AbortSignal",e)},w=function(e){s(n,e);var t=a(n);function n(e){var r;if(o(this,n),!Array.isArray(e))throw new TypeError("Expected input to be an Array, got ".concat(c(e)));for(var i="",s=0;s<e.length;s++)i+="    ".concat(e[s].stack,"\n");return(r=t.call(this,i)).name="AggregateError",r.errors=e,r}return i(n)}(u(Error));e.exports={AggregateError:w,kEmptyObject:Object.freeze({}),once:function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r)}}},createDeferredPromise:function(){var e,t;return{promise:new Promise((function(n,r){e=n,t=r})),resolve:e,reject:t}},promisify:function(e){return new Promise((function(t,n){e((function(e){if(e)return n(e);for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return t.apply(void 0,i)}))}))},debuglog:function(){return function(){}},format:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.replace(/%([sdifj])/g,(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t[0];var i=t[1],o=n.shift();if("f"===i)return o.toFixed(6);if("j"===i)return JSON.stringify(o);if("s"===i&&"object"===c(o)){var s=o.constructor!==Object?o.constructor.name:"";return"".concat(s," {}").trim()}return o.toString()}))},inspect:function(e){switch(c(e)){case"string":if(e.includes("'")){if(!e.includes('"'))return'"'.concat(e,'"');if(!e.includes("`")&&!e.includes("${"))return"`".concat(e,"`")}return"'".concat(e,"'");case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return"".concat(String(e),"n");case"boolean":case"undefined":return String(e);case"object":return"{}"}},types:{isAsyncFunction:function(e){return e instanceof y},isArrayBufferView:function(e){return ArrayBuffer.isView(e)}},isBlob:_,deprecate:function(e,t){return e},addAbortListener:n(72100).addAbortListener||function(e,t){if(void 0===e)throw new ERR_INVALID_ARG_TYPE("signal","AbortSignal",e);var n;return x(e,"signal"),function(e,t){if("function"!=typeof e)throw new ERR_INVALID_ARG_TYPE(t,"Function",e)}(t,"listener"),e.aborted?queueMicrotask((function(){return t()})):(e.addEventListener("abort",t,r({__proto__:null,once:!0},p,!0)),n=function(){e.removeEventListener("abort",t)}),r({__proto__:null},m,(function(){var e;null===(e=n)||void 0===e||e()}))},AbortSignalAny:g.any||function(e){if(1===e.length)return e[0];var t=new v,n=function(){return t.abort()};return e.forEach((function(e){x(e,"signals"),e.addEventListener("abort",n,{once:!0})})),t.signal.addEventListener("abort",(function(){e.forEach((function(e){return e.removeEventListener("abort",n)}))}),{once:!0}),t.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")},20408:function(e,t,n){var r=n(335).default,i=n(55872).Buffer,o=n(69153),s=o.ObjectDefineProperty,a=o.ObjectKeys,u=o.ReflectApply,c=n(61601).promisify.custom,l=n(84990),h=l.streamReturningOperators,d=l.promiseReturningOperators,f=n(61714).codes.ERR_ILLEGAL_CONSTRUCTOR,p=n(79746),m=n(28662),g=m.setDefaultHighWaterMark,v=m.getDefaultHighWaterMark,y=n(93864).pipeline,b=n(44659).destroyer,_=n(42415),x=n(88954),w=n(39033),S=e.exports=n(604).Stream;S.isDestroyed=w.isDestroyed,S.isDisturbed=w.isDisturbed,S.isErrored=w.isErrored,S.isReadable=w.isReadable,S.isWritable=w.isWritable,S.Readable=n(1105);var E,T=r(a(h));try{var M=function(){var e=E.value,t=h[e];function n(){if(this instanceof n?this.constructor:void 0)throw f();for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return S.Readable.from(u(t,this,r))}s(n,"name",{__proto__:null,value:t.name}),s(n,"length",{__proto__:null,value:t.length}),s(S.Readable.prototype,e,{__proto__:null,value:n,enumerable:!1,configurable:!0,writable:!0})};for(T.s();!(E=T.n()).done;)M()}catch(e){T.e(e)}finally{T.f()}var A,C=r(a(d));try{var O=function(){var e=A.value,t=d[e];function n(){if(this instanceof n?this.constructor:void 0)throw f();for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return u(t,this,r)}s(n,"name",{__proto__:null,value:t.name}),s(n,"length",{__proto__:null,value:t.length}),s(S.Readable.prototype,e,{__proto__:null,value:n,enumerable:!1,configurable:!0,writable:!0})};for(C.s();!(A=C.n()).done;)O()}catch(e){C.e(e)}finally{C.f()}S.Writable=n(29840),S.Duplex=n(80881),S.Transform=n(35378),S.PassThrough=n(12610),S.pipeline=y;var P=n(69272).addAbortSignal;S.addAbortSignal=P,S.finished=_,S.destroy=b,S.compose=p,S.setDefaultHighWaterMark=g,S.getDefaultHighWaterMark=v,s(S,"promises",{__proto__:null,configurable:!0,enumerable:!0,get:function(){return x}}),s(y,c,{__proto__:null,enumerable:!0,get:function(){return x.pipeline}}),s(_,c,{__proto__:null,enumerable:!0,get:function(){return x.finished}}),S.Stream=S,S._isUint8Array=function(e){return e instanceof Uint8Array},S._uint8ArrayToBuffer=function(e){return i.from(e.buffer,e.byteOffset,e.byteLength)}},88954:function(e,t,n){"use strict";var r=n(31759).default,i=n(69153),o=i.ArrayPrototypePop,s=i.Promise,a=n(39033),u=a.isIterable,c=a.isNodeStream,l=a.isWebStream,h=n(93864).pipelineImpl,d=n(42415).finished;n(20408),e.exports={finished:d,pipeline:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new s((function(e,n){var i,s,a=t[t.length-1];if(a&&"object"===r(a)&&!c(a)&&!u(a)&&!l(a)){var d=o(t);i=d.signal,s=d.end}h(t,(function(t,r){t?n(t):e(r)}),{signal:i,end:s})}))}}},21679:function(e,t,n){var r;!function(i){"use strict";var o,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,a=Math.ceil,u=Math.floor,c="[BigNumber Error] ",l=c+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,f=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],m=1e7,g=1e9;function v(e){var t=0|e;return e>0||e===t?t:t-1}function y(e){for(var t,n,r=1,i=e.length,o=e[0]+"";r<i;){for(t=e[r++]+"",n=d-t.length;n--;t="0"+t);o+=t}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function b(e,t){var n,r,i=e.c,o=t.c,s=e.s,a=t.s,u=e.e,c=t.e;if(!s||!a)return null;if(n=i&&!i[0],r=o&&!o[0],n||r)return n?r?0:-a:s;if(s!=a)return s;if(n=s<0,r=u==c,!i||!o)return r?0:!i^n?1:-1;if(!r)return u>c^n?1:-1;for(a=(u=i.length)<(c=o.length)?u:c,s=0;s<a;s++)if(i[s]!=o[s])return i[s]>o[s]^n?1:-1;return u==c?0:u>c^n?1:-1}function _(e,t,n,r){if(e<t||e>n||e!==u(e))throw Error(c+(r||"Argument")+("number"==typeof e?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function x(e){var t=e.c.length-1;return v(e.e/d)==t&&e.c[t]%2!=0}function w(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function S(e,t,n){var r,i;if(t<0){for(i=n+".";++t;i+=n);e=i+e}else if(++t>(r=e.length)){for(i=n,t-=r;--t;i+=n);e+=i}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}o=function e(t){var n,r,i,o,E,T,M,A,C,O,P=H.prototype={constructor:H,toString:null,valueOf:null},R=new H(1),N=20,I=4,k=-7,D=21,L=-1e7,U=1e7,F=!1,B=1,z=0,j={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},V="0123456789abcdefghijklmnopqrstuvwxyz",G=!0;function H(e,t){var n,o,a,c,h,p,m,g,v=this;if(!(v instanceof H))return new H(e,t);if(null==t){if(e&&!0===e._isBigNumber)return v.s=e.s,void(!e.c||e.e>U?v.c=v.e=null:e.e<L?v.c=[v.e=0]:(v.e=e.e,v.c=e.c.slice()));if((p="number"==typeof e)&&0*e==0){if(v.s=1/e<0?(e=-e,-1):1,e===~~e){for(c=0,h=e;h>=10;h/=10,c++);return void(c>U?v.c=v.e=null:(v.e=c,v.c=[e]))}g=String(e)}else{if(!s.test(g=String(e)))return i(v,g,p);v.s=45==g.charCodeAt(0)?(g=g.slice(1),-1):1}(c=g.indexOf("."))>-1&&(g=g.replace(".","")),(h=g.search(/e/i))>0?(c<0&&(c=h),c+=+g.slice(h+1),g=g.substring(0,h)):c<0&&(c=g.length)}else{if(_(t,2,V.length,"Base"),10==t&&G)return Z(v=new H(e),N+v.e+1,I);if(g=String(e),p="number"==typeof e){if(0*e!=0)return i(v,g,p,t);if(v.s=1/e<0?(g=g.slice(1),-1):1,H.DEBUG&&g.replace(/^0\.0*|\./,"").length>15)throw Error(l+e)}else v.s=45===g.charCodeAt(0)?(g=g.slice(1),-1):1;for(n=V.slice(0,t),c=h=0,m=g.length;h<m;h++)if(n.indexOf(o=g.charAt(h))<0){if("."==o){if(h>c){c=m;continue}}else if(!a&&(g==g.toUpperCase()&&(g=g.toLowerCase())||g==g.toLowerCase()&&(g=g.toUpperCase()))){a=!0,h=-1,c=0;continue}return i(v,String(e),p,t)}p=!1,(c=(g=r(g,t,10,v.s)).indexOf("."))>-1?g=g.replace(".",""):c=g.length}for(h=0;48===g.charCodeAt(h);h++);for(m=g.length;48===g.charCodeAt(--m););if(g=g.slice(h,++m)){if(m-=h,p&&H.DEBUG&&m>15&&(e>f||e!==u(e)))throw Error(l+v.s*e);if((c=c-h-1)>U)v.c=v.e=null;else if(c<L)v.c=[v.e=0];else{if(v.e=c,v.c=[],h=(c+1)%d,c<0&&(h+=d),h<m){for(h&&v.c.push(+g.slice(0,h)),m-=d;h<m;)v.c.push(+g.slice(h,h+=d));h=d-(g=g.slice(h)).length}else h-=m;for(;h--;g+="0");v.c.push(+g)}}else v.c=[v.e=0]}function W(e,t,n,r){var i,o,s,a,u;if(null==n?n=I:_(n,0,8),!e.c)return e.toString();if(i=e.c[0],s=e.e,null==t)u=y(e.c),u=1==r||2==r&&(s<=k||s>=D)?w(u,s):S(u,s,"0");else if(o=(e=Z(new H(e),t,n)).e,a=(u=y(e.c)).length,1==r||2==r&&(t<=o||o<=k)){for(;a<t;u+="0",a++);u=w(u,o)}else if(t-=s,u=S(u,o,"0"),o+1>a){if(--t>0)for(u+=".";t--;u+="0");}else if((t+=o-a)>0)for(o+1==a&&(u+=".");t--;u+="0");return e.s<0&&i?"-"+u:u}function q(e,t){for(var n,r,i=1,o=new H(e[0]);i<e.length;i++)(!(r=new H(e[i])).s||(n=b(o,r))===t||0===n&&o.s===t)&&(o=r);return o}function X(e,t,n){for(var r=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,r++);return(n=r+n*d-1)>U?e.c=e.e=null:n<L?e.c=[e.e=0]:(e.e=n,e.c=t),e}function Z(e,t,n,r){var i,o,s,c,l,f,m,g=e.c,v=p;if(g){e:{for(i=1,c=g[0];c>=10;c/=10,i++);if((o=t-i)<0)o+=d,s=t,l=g[f=0],m=u(l/v[i-s-1]%10);else if((f=a((o+1)/d))>=g.length){if(!r)break e;for(;g.length<=f;g.push(0));l=m=0,i=1,s=(o%=d)-d+1}else{for(l=c=g[f],i=1;c>=10;c/=10,i++);m=(s=(o%=d)-d+i)<0?0:u(l/v[i-s-1]%10)}if(r=r||t<0||null!=g[f+1]||(s<0?l:l%v[i-s-1]),r=n<4?(m||r)&&(0==n||n==(e.s<0?3:2)):m>5||5==m&&(4==n||r||6==n&&(o>0?s>0?l/v[i-s]:0:g[f-1])%10&1||n==(e.s<0?8:7)),t<1||!g[0])return g.length=0,r?(t-=e.e+1,g[0]=v[(d-t%d)%d],e.e=-t||0):g[0]=e.e=0,e;if(0==o?(g.length=f,c=1,f--):(g.length=f+1,c=v[d-o],g[f]=s>0?u(l/v[i-s]%v[s])*c:0),r)for(;;){if(0==f){for(o=1,s=g[0];s>=10;s/=10,o++);for(s=g[0]+=c,c=1;s>=10;s/=10,c++);o!=c&&(e.e++,g[0]==h&&(g[0]=1));break}if(g[f]+=c,g[f]!=h)break;g[f--]=0,c=1}for(o=g.length;0===g[--o];g.pop());}e.e>U?e.c=e.e=null:e.e<L&&(e.c=[e.e=0])}return e}function $(e){var t,n=e.e;return null===n?e.toString():(t=y(e.c),t=n<=k||n>=D?w(t,n):S(t,n,"0"),e.s<0?"-"+t:t)}return H.clone=e,H.ROUND_UP=0,H.ROUND_DOWN=1,H.ROUND_CEIL=2,H.ROUND_FLOOR=3,H.ROUND_HALF_UP=4,H.ROUND_HALF_DOWN=5,H.ROUND_HALF_EVEN=6,H.ROUND_HALF_CEIL=7,H.ROUND_HALF_FLOOR=8,H.EUCLID=9,H.config=H.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(c+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(_(n=e[t],0,g,t),N=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(_(n=e[t],0,8,t),I=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(_(n[0],-g,0,t),_(n[1],0,g,t),k=n[0],D=n[1]):(_(n,-g,g,t),k=-(D=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)_(n[0],-g,-1,t),_(n[1],1,g,t),L=n[0],U=n[1];else{if(_(n,-g,g,t),!n)throw Error(c+t+" cannot be zero: "+n);L=-(U=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(c+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw F=!n,Error(c+"crypto unavailable");F=n}else F=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(_(n=e[t],0,9,t),B=n),e.hasOwnProperty(t="POW_PRECISION")&&(_(n=e[t],0,g,t),z=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(c+t+" not an object: "+n);j=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error(c+t+" invalid: "+n);G="0123456789"==n.slice(0,10),V=n}}return{DECIMAL_PLACES:N,ROUNDING_MODE:I,EXPONENTIAL_AT:[k,D],RANGE:[L,U],CRYPTO:F,MODULO_MODE:B,POW_PRECISION:z,FORMAT:j,ALPHABET:V}},H.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!H.DEBUG)return!0;var t,n,r=e.c,i=e.e,o=e.s;e:if("[object Array]"=={}.toString.call(r)){if((1===o||-1===o)&&i>=-g&&i<=g&&i===u(i)){if(0===r[0]){if(0===i&&1===r.length)return!0;break e}if((t=(i+1)%d)<1&&(t+=d),String(r[0]).length==t){for(t=0;t<r.length;t++)if((n=r[t])<0||n>=h||n!==u(n))break e;if(0!==n)return!0}}}else if(null===r&&null===i&&(null===o||1===o||-1===o))return!0;throw Error(c+"Invalid BigNumber: "+e)},H.maximum=H.max=function(){return q(arguments,-1)},H.minimum=H.min=function(){return q(arguments,1)},H.random=(o=9007199254740992,E=Math.random()*o&2097151?function(){return u(Math.random()*o)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,r,i,o,s=0,l=[],h=new H(R);if(null==e?e=N:_(e,0,g),i=a(e/d),F)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(i*=2));s<i;)(o=131072*t[s]+(t[s+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),t[s]=n[0],t[s+1]=n[1]):(l.push(o%1e14),s+=2);s=i/2}else{if(!crypto.randomBytes)throw F=!1,Error(c+"crypto unavailable");for(t=crypto.randomBytes(i*=7);s<i;)(o=281474976710656*(31&t[s])+1099511627776*t[s+1]+4294967296*t[s+2]+16777216*t[s+3]+(t[s+4]<<16)+(t[s+5]<<8)+t[s+6])>=9e15?crypto.randomBytes(7).copy(t,s):(l.push(o%1e14),s+=7);s=i/7}if(!F)for(;s<i;)(o=E())<9e15&&(l[s++]=o%1e14);for(i=l[--s],e%=d,i&&e&&(o=p[d-e],l[s]=u(i/o)*o);0===l[s];l.pop(),s--);if(s<0)l=[r=0];else{for(r=-1;0===l[0];l.splice(0,1),r-=d);for(s=1,o=l[0];o>=10;o/=10,s++);s<d&&(r-=d-s)}return h.e=r,h.c=l,h}),H.sum=function(){for(var e=1,t=arguments,n=new H(t[0]);e<t.length;)n=n.plus(t[e++]);return n},r=function(){var e="0123456789";function t(e,t,n,r){for(var i,o,s=[0],a=0,u=e.length;a<u;){for(o=s.length;o--;s[o]*=t);for(s[0]+=r.indexOf(e.charAt(a++)),i=0;i<s.length;i++)s[i]>n-1&&(null==s[i+1]&&(s[i+1]=0),s[i+1]+=s[i]/n|0,s[i]%=n)}return s.reverse()}return function(r,i,o,s,a){var u,c,l,h,d,f,p,m,g=r.indexOf("."),v=N,b=I;for(g>=0&&(h=z,z=0,r=r.replace(".",""),f=(m=new H(i)).pow(r.length-g),z=h,m.c=t(S(y(f.c),f.e,"0"),10,o,e),m.e=m.c.length),l=h=(p=t(r,i,o,a?(u=V,e):(u=e,V))).length;0==p[--h];p.pop());if(!p[0])return u.charAt(0);if(g<0?--l:(f.c=p,f.e=l,f.s=s,p=(f=n(f,m,v,b,o)).c,d=f.r,l=f.e),g=p[c=l+v+1],h=o/2,d=d||c<0||null!=p[c+1],d=b<4?(null!=g||d)&&(0==b||b==(f.s<0?3:2)):g>h||g==h&&(4==b||d||6==b&&1&p[c-1]||b==(f.s<0?8:7)),c<1||!p[0])r=d?S(u.charAt(1),-v,u.charAt(0)):u.charAt(0);else{if(p.length=c,d)for(--o;++p[--c]>o;)p[c]=0,c||(++l,p=[1].concat(p));for(h=p.length;!p[--h];);for(g=0,r="";g<=h;r+=u.charAt(p[g++]));r=S(r,l,u.charAt(0))}return r}}(),n=function(){function e(e,t,n){var r,i,o,s,a=0,u=e.length,c=t%m,l=t/m|0;for(e=e.slice();u--;)a=((i=c*(o=e[u]%m)+(r=l*o+(s=e[u]/m|0)*c)%m*m+a)/n|0)+(r/m|0)+l*s,e[u]=i%n;return a&&(e=[a].concat(e)),e}function t(e,t,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;i<n;i++)if(e[i]!=t[i]){o=e[i]>t[i]?1:-1;break}return o}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(r,i,o,s,a){var c,l,f,p,m,g,y,b,_,x,w,S,E,T,M,A,C,O=r.s==i.s?1:-1,P=r.c,R=i.c;if(!(P&&P[0]&&R&&R[0]))return new H(r.s&&i.s&&(P?!R||P[0]!=R[0]:R)?P&&0==P[0]||!R?0*O:O/0:NaN);for(_=(b=new H(O)).c=[],O=o+(l=r.e-i.e)+1,a||(a=h,l=v(r.e/d)-v(i.e/d),O=O/d|0),f=0;R[f]==(P[f]||0);f++);if(R[f]>(P[f]||0)&&l--,O<0)_.push(1),p=!0;else{for(T=P.length,A=R.length,f=0,O+=2,(m=u(a/(R[0]+1)))>1&&(R=e(R,m,a),P=e(P,m,a),A=R.length,T=P.length),E=A,w=(x=P.slice(0,A)).length;w<A;x[w++]=0);C=R.slice(),C=[0].concat(C),M=R[0],R[1]>=a/2&&M++;do{if(m=0,(c=t(R,x,A,w))<0){if(S=x[0],A!=w&&(S=S*a+(x[1]||0)),(m=u(S/M))>1)for(m>=a&&(m=a-1),y=(g=e(R,m,a)).length,w=x.length;1==t(g,x,y,w);)m--,n(g,A<y?C:R,y,a),y=g.length,c=1;else 0==m&&(c=m=1),y=(g=R.slice()).length;if(y<w&&(g=[0].concat(g)),n(x,g,w,a),w=x.length,-1==c)for(;t(R,x,A,w)<1;)m++,n(x,A<w?C:R,w,a),w=x.length}else 0===c&&(m++,x=[0]);_[f++]=m,x[0]?x[w++]=P[E]||0:(x=[P[E]],w=1)}while((E++<T||null!=x[0])&&O--);p=null!=x[0],_[0]||_.splice(0,1)}if(a==h){for(f=1,O=_[0];O>=10;O/=10,f++);Z(b,o+(b.e=f+l*d-1)+1,s,p)}else b.e=l,b.r=+p;return b}}(),T=/^(-?)0([xbo])(?=\w[\w.]*$)/i,M=/^([^.]+)\.$/,A=/^\.([^.]+)$/,C=/^-?(Infinity|NaN)$/,O=/^\s*\+(?=[\w.])|^\s+|\s+$/g,i=function(e,t,n,r){var i,o=n?t:t.replace(O,"");if(C.test(o))e.s=isNaN(o)?null:o<0?-1:1;else{if(!n&&(o=o.replace(T,(function(e,t,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=i?e:t})),r&&(i=r,o=o.replace(M,"$1").replace(A,"0.$1")),t!=o))return new H(o,i);if(H.DEBUG)throw Error(c+"Not a"+(r?" base "+r:"")+" number: "+t);e.s=null}e.c=e.e=null},P.absoluteValue=P.abs=function(){var e=new H(this);return e.s<0&&(e.s=1),e},P.comparedTo=function(e,t){return b(this,new H(e,t))},P.decimalPlaces=P.dp=function(e,t){var n,r,i,o=this;if(null!=e)return _(e,0,g),null==t?t=I:_(t,0,8),Z(new H(o),e+o.e+1,t);if(!(n=o.c))return null;if(r=((i=n.length-1)-v(this.e/d))*d,i=n[i])for(;i%10==0;i/=10,r--);return r<0&&(r=0),r},P.dividedBy=P.div=function(e,t){return n(this,new H(e,t),N,I)},P.dividedToIntegerBy=P.idiv=function(e,t){return n(this,new H(e,t),0,1)},P.exponentiatedBy=P.pow=function(e,t){var n,r,i,o,s,l,h,f,p=this;if((e=new H(e)).c&&!e.isInteger())throw Error(c+"Exponent not an integer: "+$(e));if(null!=t&&(t=new H(t)),s=e.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!e.c||!e.c[0])return f=new H(Math.pow(+$(p),s?e.s*(2-x(e)):+$(e))),t?f.mod(t):f;if(l=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new H(NaN);(r=!l&&p.isInteger()&&t.isInteger())&&(p=p.mod(t))}else{if(e.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||s&&p.c[1]>=24e7:p.c[0]<8e13||s&&p.c[0]<=9999975e7)))return o=p.s<0&&x(e)?-0:0,p.e>-1&&(o=1/o),new H(l?1/o:o);z&&(o=a(z/d+2))}for(s?(n=new H(.5),l&&(e.s=1),h=x(e)):h=(i=Math.abs(+$(e)))%2,f=new H(R);;){if(h){if(!(f=f.times(p)).c)break;o?f.c.length>o&&(f.c.length=o):r&&(f=f.mod(t))}if(i){if(0===(i=u(i/2)))break;h=i%2}else if(Z(e=e.times(n),e.e+1,1),e.e>14)h=x(e);else{if(0===(i=+$(e)))break;h=i%2}p=p.times(p),o?p.c&&p.c.length>o&&(p.c.length=o):r&&(p=p.mod(t))}return r?f:(l&&(f=R.div(f)),t?f.mod(t):o?Z(f,z,I,undefined):f)},P.integerValue=function(e){var t=new H(this);return null==e?e=I:_(e,0,8),Z(t,t.e+1,e)},P.isEqualTo=P.eq=function(e,t){return 0===b(this,new H(e,t))},P.isFinite=function(){return!!this.c},P.isGreaterThan=P.gt=function(e,t){return b(this,new H(e,t))>0},P.isGreaterThanOrEqualTo=P.gte=function(e,t){return 1===(t=b(this,new H(e,t)))||0===t},P.isInteger=function(){return!!this.c&&v(this.e/d)>this.c.length-2},P.isLessThan=P.lt=function(e,t){return b(this,new H(e,t))<0},P.isLessThanOrEqualTo=P.lte=function(e,t){return-1===(t=b(this,new H(e,t)))||0===t},P.isNaN=function(){return!this.s},P.isNegative=function(){return this.s<0},P.isPositive=function(){return this.s>0},P.isZero=function(){return!!this.c&&0==this.c[0]},P.minus=function(e,t){var n,r,i,o,s=this,a=s.s;if(t=(e=new H(e,t)).s,!a||!t)return new H(NaN);if(a!=t)return e.s=-t,s.plus(e);var u=s.e/d,c=e.e/d,l=s.c,f=e.c;if(!u||!c){if(!l||!f)return l?(e.s=-t,e):new H(f?s:NaN);if(!l[0]||!f[0])return f[0]?(e.s=-t,e):new H(l[0]?s:3==I?-0:0)}if(u=v(u),c=v(c),l=l.slice(),a=u-c){for((o=a<0)?(a=-a,i=l):(c=u,i=f),i.reverse(),t=a;t--;i.push(0));i.reverse()}else for(r=(o=(a=l.length)<(t=f.length))?a:t,a=t=0;t<r;t++)if(l[t]!=f[t]){o=l[t]<f[t];break}if(o&&(i=l,l=f,f=i,e.s=-e.s),(t=(r=f.length)-(n=l.length))>0)for(;t--;l[n++]=0);for(t=h-1;r>a;){if(l[--r]<f[r]){for(n=r;n&&!l[--n];l[n]=t);--l[n],l[r]+=h}l[r]-=f[r]}for(;0==l[0];l.splice(0,1),--c);return l[0]?X(e,l,c):(e.s=3==I?-1:1,e.c=[e.e=0],e)},P.modulo=P.mod=function(e,t){var r,i,o=this;return e=new H(e,t),!o.c||!e.s||e.c&&!e.c[0]?new H(NaN):!e.c||o.c&&!o.c[0]?new H(o):(9==B?(i=e.s,e.s=1,r=n(o,e,0,3),e.s=i,r.s*=i):r=n(o,e,0,B),(e=o.minus(r.times(e))).c[0]||1!=B||(e.s=o.s),e)},P.multipliedBy=P.times=function(e,t){var n,r,i,o,s,a,u,c,l,f,p,g,y,b,_,x=this,w=x.c,S=(e=new H(e,t)).c;if(!(w&&S&&w[0]&&S[0]))return!x.s||!e.s||w&&!w[0]&&!S||S&&!S[0]&&!w?e.c=e.e=e.s=null:(e.s*=x.s,w&&S?(e.c=[0],e.e=0):e.c=e.e=null),e;for(r=v(x.e/d)+v(e.e/d),e.s*=x.s,(u=w.length)<(f=S.length)&&(y=w,w=S,S=y,i=u,u=f,f=i),i=u+f,y=[];i--;y.push(0));for(b=h,_=m,i=f;--i>=0;){for(n=0,p=S[i]%_,g=S[i]/_|0,o=i+(s=u);o>i;)n=((c=p*(c=w[--s]%_)+(a=g*c+(l=w[s]/_|0)*p)%_*_+y[o]+n)/b|0)+(a/_|0)+g*l,y[o--]=c%b;y[o]=n}return n?++r:y.splice(0,1),X(e,y,r)},P.negated=function(){var e=new H(this);return e.s=-e.s||null,e},P.plus=function(e,t){var n,r=this,i=r.s;if(t=(e=new H(e,t)).s,!i||!t)return new H(NaN);if(i!=t)return e.s=-t,r.minus(e);var o=r.e/d,s=e.e/d,a=r.c,u=e.c;if(!o||!s){if(!a||!u)return new H(i/0);if(!a[0]||!u[0])return u[0]?e:new H(a[0]?r:0*i)}if(o=v(o),s=v(s),a=a.slice(),i=o-s){for(i>0?(s=o,n=u):(i=-i,n=a),n.reverse();i--;n.push(0));n.reverse()}for((i=a.length)-(t=u.length)<0&&(n=u,u=a,a=n,t=i),i=0;t;)i=(a[--t]=a[t]+u[t]+i)/h|0,a[t]=h===a[t]?0:a[t]%h;return i&&(a=[i].concat(a),++s),X(e,a,s)},P.precision=P.sd=function(e,t){var n,r,i,o=this;if(null!=e&&e!==!!e)return _(e,1,g),null==t?t=I:_(t,0,8),Z(new H(o),e,t);if(!(n=o.c))return null;if(r=(i=n.length-1)*d+1,i=n[i]){for(;i%10==0;i/=10,r--);for(i=n[0];i>=10;i/=10,r++);}return e&&o.e+1>r&&(r=o.e+1),r},P.shiftedBy=function(e){return _(e,-9007199254740991,f),this.times("1e"+e)},P.squareRoot=P.sqrt=function(){var e,t,r,i,o,s=this,a=s.c,u=s.s,c=s.e,l=N+4,h=new H("0.5");if(1!==u||!a||!a[0])return new H(!u||u<0&&(!a||a[0])?NaN:a?s:1/0);if(0==(u=Math.sqrt(+$(s)))||u==1/0?(((t=y(a)).length+c)%2==0&&(t+="0"),u=Math.sqrt(+t),c=v((c+1)/2)-(c<0||c%2),r=new H(t=u==1/0?"5e"+c:(t=u.toExponential()).slice(0,t.indexOf("e")+1)+c)):r=new H(u+""),r.c[0])for((u=(c=r.e)+l)<3&&(u=0);;)if(o=r,r=h.times(o.plus(n(s,o,l,1))),y(o.c).slice(0,u)===(t=y(r.c)).slice(0,u)){if(r.e<c&&--u,"9999"!=(t=t.slice(u-3,u+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(Z(r,r.e+N+2,1),e=!r.times(r).eq(s));break}if(!i&&(Z(o,o.e+N+2,0),o.times(o).eq(s))){r=o;break}l+=4,u+=4,i=1}return Z(r,r.e+N+1,I,e)},P.toExponential=function(e,t){return null!=e&&(_(e,0,g),e++),W(this,e,t,1)},P.toFixed=function(e,t){return null!=e&&(_(e,0,g),e=e+this.e+1),W(this,e,t)},P.toFormat=function(e,t,n){var r,i=this;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=j;else if("object"!=typeof n)throw Error(c+"Argument not an object: "+n);if(r=i.toFixed(e,t),i.c){var o,s=r.split("."),a=+n.groupSize,u=+n.secondaryGroupSize,l=n.groupSeparator||"",h=s[0],d=s[1],f=i.s<0,p=f?h.slice(1):h,m=p.length;if(u&&(o=a,a=u,u=o,m-=o),a>0&&m>0){for(o=m%a||a,h=p.substr(0,o);o<m;o+=a)h+=l+p.substr(o,a);u>0&&(h+=l+p.slice(o)),f&&(h="-"+h)}r=d?h+(n.decimalSeparator||"")+((u=+n.fractionGroupSize)?d.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):d):h}return(n.prefix||"")+r+(n.suffix||"")},P.toFraction=function(e){var t,r,i,o,s,a,u,l,h,f,m,g,v=this,b=v.c;if(null!=e&&(!(u=new H(e)).isInteger()&&(u.c||1!==u.s)||u.lt(R)))throw Error(c+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+$(u));if(!b)return new H(v);for(t=new H(R),h=r=new H(R),i=l=new H(R),g=y(b),s=t.e=g.length-v.e-1,t.c[0]=p[(a=s%d)<0?d+a:a],e=!e||u.comparedTo(t)>0?s>0?t:h:u,a=U,U=1/0,u=new H(g),l.c[0]=0;f=n(u,t,0,1),1!=(o=r.plus(f.times(i))).comparedTo(e);)r=i,i=o,h=l.plus(f.times(o=h)),l=o,t=u.minus(f.times(o=t)),u=o;return o=n(e.minus(r),i,0,1),l=l.plus(o.times(h)),r=r.plus(o.times(i)),l.s=h.s=v.s,m=n(h,i,s*=2,I).minus(v).abs().comparedTo(n(l,r,s,I).minus(v).abs())<1?[h,i]:[l,r],U=a,m},P.toNumber=function(){return+$(this)},P.toPrecision=function(e,t){return null!=e&&_(e,1,g),W(this,e,t,2)},P.toString=function(e){var t,n=this,i=n.s,o=n.e;return null===o?i?(t="Infinity",i<0&&(t="-"+t)):t="NaN":(null==e?t=o<=k||o>=D?w(y(n.c),o):S(y(n.c),o,"0"):10===e&&G?t=S(y((n=Z(new H(n),N+o+1,I)).c),n.e,"0"):(_(e,2,V.length,"Base"),t=r(S(y(n.c),o,"0"),10,e,i,!0)),i<0&&n.c[0]&&(t="-"+t)),t},P.valueOf=P.toJSON=function(){return $(this)},P._isBigNumber=!0,null!=t&&H.set(t),H}(),o.default=o.BigNumber=o,void 0===(r=function(){return o}.call(t,n,t,e))||(e.exports=r)}()},6724:function(e,t,n){e.exports={graphlib:n(68509),layout:n(13104),debug:n(36939),util:{time:n(92304).time,notime:n(92304).notime},version:n(90975)}},93143:function(e,t,n){"use strict";var r=n(8217),i=n(23742);e.exports={run:function(e){var t="greedy"===e.graph().acyclicer?i(e,function(e){return function(t){return e.edge(t).weight}}(e)):function(e){var t=[],n={},i={};function o(s){r.has(i,s)||(i[s]=!0,n[s]=!0,r.forEach(e.outEdges(s),(function(e){r.has(n,e.w)?t.push(e):o(e.w)})),delete n[s])}return r.forEach(e.nodes(),o),t}(e);r.forEach(t,(function(t){var n=e.edge(t);e.removeEdge(t),n.forwardName=t.name,n.reversed=!0,e.setEdge(t.w,t.v,n,r.uniqueId("rev"))}))},undo:function(e){r.forEach(e.edges(),(function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}}))}}},24186:function(e,t,n){var r=n(8217),i=n(92304);function o(e,t,n,r,o,s){var a={width:0,height:0,rank:s,borderType:t},u=o[t][s-1],c=i.addDummyNode(e,"border",a,n);o[t][s]=c,e.setParent(c,r),u&&e.setEdge(u,c,{weight:1})}e.exports=function(e){r.forEach(e.children(),(function t(n){var i=e.children(n),s=e.node(n);if(i.length&&r.forEach(i,t),r.has(s,"minRank")){s.borderLeft=[],s.borderRight=[];for(var a=s.minRank,u=s.maxRank+1;a<u;++a)o(e,"borderLeft","_bl",n,s,a),o(e,"borderRight","_br",n,s,a)}}))}},83032:function(e,t,n){"use strict";var r=n(8217);function i(e){r.forEach(e.nodes(),(function(t){o(e.node(t))})),r.forEach(e.edges(),(function(t){o(e.edge(t))}))}function o(e){var t=e.width;e.width=e.height,e.height=t}function s(e){e.y=-e.y}function a(e){var t=e.x;e.x=e.y,e.y=t}e.exports={adjust:function(e){var t=e.graph().rankdir.toLowerCase();"lr"!==t&&"rl"!==t||i(e)},undo:function(e){var t=e.graph().rankdir.toLowerCase();"bt"!==t&&"rl"!==t||function(e){r.forEach(e.nodes(),(function(t){s(e.node(t))})),r.forEach(e.edges(),(function(t){var n=e.edge(t);r.forEach(n.points,s),r.has(n,"y")&&s(n)}))}(e);"lr"!==t&&"rl"!==t||(!function(e){r.forEach(e.nodes(),(function(t){a(e.node(t))})),r.forEach(e.edges(),(function(t){var n=e.edge(t);r.forEach(n.points,a),r.has(n,"x")&&a(n)}))}(e),i(e))}}},40094:function(e){function t(){var e={};e._next=e._prev=e,this._sentinel=e}function n(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function r(e,t){if("_next"!==e&&"_prev"!==e)return t}e.exports=t,t.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return n(t),t},t.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&n(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t},t.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,r)),n=n._prev;return"["+e.join(", ")+"]"}},36939:function(e,t,n){var r=n(8217),i=n(92304),o=n(68509).Graph;e.exports={debugOrdering:function(e){var t=i.buildLayerMatrix(e),n=new o({compound:!0,multigraph:!0}).setGraph({});return r.forEach(e.nodes(),(function(t){n.setNode(t,{label:t}),n.setParent(t,"layer"+e.node(t).rank)})),r.forEach(e.edges(),(function(e){n.setEdge(e.v,e.w,{},e.name)})),r.forEach(t,(function(e,t){var i="layer"+t;n.setNode(i,{rank:"same"}),r.reduce(e,(function(e,t){return n.setEdge(e,t,{style:"invis"}),t}))})),n}}},68509:function(e,t,n){var r;try{r=n(16239)}catch(e){}r||(r=window.graphlib),e.exports=r},23742:function(e,t,n){var r=n(8217),i=n(68509).Graph,o=n(40094);e.exports=function(e,t){if(e.nodeCount()<=1)return[];var n=function(e,t){var n=new i,s=0,a=0;r.forEach(e.nodes(),(function(e){n.setNode(e,{v:e,in:0,out:0})})),r.forEach(e.edges(),(function(e){var r=n.edge(e.v,e.w)||0,i=t(e),o=r+i;n.setEdge(e.v,e.w,o),a=Math.max(a,n.node(e.v).out+=i),s=Math.max(s,n.node(e.w).in+=i)}));var c=r.range(a+s+3).map((function(){return new o})),l=s+1;return r.forEach(n.nodes(),(function(e){u(c,l,n.node(e))})),{graph:n,buckets:c,zeroIdx:l}}(e,t||s),c=function(e,t,n){var r,i=[],o=t[t.length-1],s=t[0];for(;e.nodeCount();){for(;r=s.dequeue();)a(e,t,n,r);for(;r=o.dequeue();)a(e,t,n,r);if(e.nodeCount())for(var u=t.length-2;u>0;--u)if(r=t[u].dequeue()){i=i.concat(a(e,t,n,r,!0));break}}return i}(n.graph,n.buckets,n.zeroIdx);return r.flatten(r.map(c,(function(t){return e.outEdges(t.v,t.w)})),!0)};var s=r.constant(1);function a(e,t,n,i,o){var s=o?[]:void 0;return r.forEach(e.inEdges(i.v),(function(r){var i=e.edge(r),a=e.node(r.v);o&&s.push({v:r.v,w:r.w}),a.out-=i,u(t,n,a)})),r.forEach(e.outEdges(i.v),(function(r){var i=e.edge(r),o=r.w,s=e.node(o);s.in-=i,u(t,n,s)})),e.removeNode(i.v),s}function u(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}},13104:function(e,t,n){"use strict";var r=n(8217),i=n(93143),o=n(67099),s=n(65511),a=n(92304).normalizeRanks,u=n(24685),c=n(92304).removeEmptyRanks,l=n(59832),h=n(24186),d=n(83032),f=n(89717),p=n(63363),m=n(92304),g=n(68509).Graph;e.exports=function(e,t){var n=t&&t.debugTiming?m.time:m.notime;n("layout",(function(){var t=n("  buildLayoutGraph",(function(){return function(e){var t=new g({multigraph:!0,compound:!0}),n=M(e.graph());return t.setGraph(r.merge({},y,T(n,v),r.pick(n,b))),r.forEach(e.nodes(),(function(n){var i=M(e.node(n));t.setNode(n,r.defaults(T(i,_),x)),t.setParent(n,e.parent(n))})),r.forEach(e.edges(),(function(n){var i=M(e.edge(n));t.setEdge(n,r.merge({},S,T(i,w),r.pick(i,E)))})),t}(e)}));n("  runLayout",(function(){!function(e,t){t("    makeSpaceForEdgeLabels",(function(){!function(e){var t=e.graph();t.ranksep/=2,r.forEach(e.edges(),(function(n){var r=e.edge(n);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===t.rankdir||"BT"===t.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)}))}(e)})),t("    removeSelfEdges",(function(){!function(e){r.forEach(e.edges(),(function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}}))}(e)})),t("    acyclic",(function(){i.run(e)})),t("    nestingGraph.run",(function(){l.run(e)})),t("    rank",(function(){s(m.asNonCompoundGraph(e))})),t("    injectEdgeLabelProxies",(function(){!function(e){r.forEach(e.edges(),(function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),i={rank:(e.node(t.w).rank-r.rank)/2+r.rank,e:t};m.addDummyNode(e,"edge-proxy",i,"_ep")}}))}(e)})),t("    removeEmptyRanks",(function(){c(e)})),t("    nestingGraph.cleanup",(function(){l.cleanup(e)})),t("    normalizeRanks",(function(){a(e)})),t("    assignRankMinMax",(function(){!function(e){var t=0;r.forEach(e.nodes(),(function(n){var i=e.node(n);i.borderTop&&(i.minRank=e.node(i.borderTop).rank,i.maxRank=e.node(i.borderBottom).rank,t=r.max(t,i.maxRank))})),e.graph().maxRank=t}(e)})),t("    removeEdgeLabelProxies",(function(){!function(e){r.forEach(e.nodes(),(function(t){var n=e.node(t);"edge-proxy"===n.dummy&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))}))}(e)})),t("    normalize.run",(function(){o.run(e)})),t("    parentDummyChains",(function(){u(e)})),t("    addBorderSegments",(function(){h(e)})),t("    order",(function(){f(e)})),t("    insertSelfEdges",(function(){!function(e){var t=m.buildLayerMatrix(e);r.forEach(t,(function(t){var n=0;r.forEach(t,(function(t,i){var o=e.node(t);o.order=i+n,r.forEach(o.selfEdges,(function(t){m.addDummyNode(e,"selfedge",{width:t.label.width,height:t.label.height,rank:o.rank,order:i+ ++n,e:t.e,label:t.label},"_se")})),delete o.selfEdges}))}))}(e)})),t("    adjustCoordinateSystem",(function(){d.adjust(e)})),t("    position",(function(){p(e)})),t("    positionSelfEdges",(function(){!function(e){r.forEach(e.nodes(),(function(t){var n=e.node(t);if("selfedge"===n.dummy){var r=e.node(n.e.v),i=r.x+r.width/2,o=r.y,s=n.x-i,a=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*s/3,y:o-a},{x:i+5*s/6,y:o-a},{x:i+s,y:o},{x:i+5*s/6,y:o+a},{x:i+2*s/3,y:o+a}],n.label.x=n.x,n.label.y=n.y}}))}(e)})),t("    removeBorderNodes",(function(){!function(e){r.forEach(e.nodes(),(function(t){if(e.children(t).length){var n=e.node(t),i=e.node(n.borderTop),o=e.node(n.borderBottom),s=e.node(r.last(n.borderLeft)),a=e.node(r.last(n.borderRight));n.width=Math.abs(a.x-s.x),n.height=Math.abs(o.y-i.y),n.x=s.x+n.width/2,n.y=i.y+n.height/2}})),r.forEach(e.nodes(),(function(t){"border"===e.node(t).dummy&&e.removeNode(t)}))}(e)})),t("    normalize.undo",(function(){o.undo(e)})),t("    fixupEdgeLabelCoords",(function(){!function(e){r.forEach(e.edges(),(function(t){var n=e.edge(t);if(r.has(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}))}(e)})),t("    undoCoordinateSystem",(function(){d.undo(e)})),t("    translateGraph",(function(){!function(e){var t=Number.POSITIVE_INFINITY,n=0,i=Number.POSITIVE_INFINITY,o=0,s=e.graph(),a=s.marginx||0,u=s.marginy||0;function c(e){var r=e.x,s=e.y,a=e.width,u=e.height;t=Math.min(t,r-a/2),n=Math.max(n,r+a/2),i=Math.min(i,s-u/2),o=Math.max(o,s+u/2)}r.forEach(e.nodes(),(function(t){c(e.node(t))})),r.forEach(e.edges(),(function(t){var n=e.edge(t);r.has(n,"x")&&c(n)})),t-=a,i-=u,r.forEach(e.nodes(),(function(n){var r=e.node(n);r.x-=t,r.y-=i})),r.forEach(e.edges(),(function(n){var o=e.edge(n);r.forEach(o.points,(function(e){e.x-=t,e.y-=i})),r.has(o,"x")&&(o.x-=t),r.has(o,"y")&&(o.y-=i)})),s.width=n-t+a,s.height=o-i+u}(e)})),t("    assignNodeIntersects",(function(){!function(e){r.forEach(e.edges(),(function(t){var n,r,i=e.edge(t),o=e.node(t.v),s=e.node(t.w);i.points?(n=i.points[0],r=i.points[i.points.length-1]):(i.points=[],n=s,r=o),i.points.unshift(m.intersectRect(o,n)),i.points.push(m.intersectRect(s,r))}))}(e)})),t("    reversePoints",(function(){!function(e){r.forEach(e.edges(),(function(t){var n=e.edge(t);n.reversed&&n.points.reverse()}))}(e)})),t("    acyclic.undo",(function(){i.undo(e)}))}(t,n)})),n("  updateInputGraph",(function(){!function(e,t){r.forEach(e.nodes(),(function(n){var r=e.node(n),i=t.node(n);r&&(r.x=i.x,r.y=i.y,t.children(n).length&&(r.width=i.width,r.height=i.height))})),r.forEach(e.edges(),(function(n){var i=e.edge(n),o=t.edge(n);i.points=o.points,r.has(o,"x")&&(i.x=o.x,i.y=o.y)})),e.graph().width=t.graph().width,e.graph().height=t.graph().height}(e,t)}))}))};var v=["nodesep","edgesep","ranksep","marginx","marginy"],y={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},b=["acyclicer","ranker","rankdir","align"],_=["width","height"],x={width:0,height:0},w=["minlen","weight","width","height","labeloffset"],S={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},E=["labelpos"];function T(e,t){return r.mapValues(r.pick(e,t),Number)}function M(e){var t={};return r.forEach(e,(function(e,n){t[n.toLowerCase()]=e})),t}},8217:function(e,t,n){var r;try{r={cloneDeep:n(32222),constant:n(64806),defaults:n(91099),each:n(15828),filter:n(3149),find:n(33170),flatten:n(22612),forEach:n(17489),forIn:n(37229),has:n(56611),isUndefined:n(89300),last:n(25674),map:n(65512),mapValues:n(65632),max:n(80212),merge:n(67929),min:n(71516),minBy:n(88371),now:n(76668),pick:n(19334),range:n(61178),reduce:n(6355),sortBy:n(84715),uniqueId:n(53274),values:n(61017),zipObject:n(64058)}}catch(e){}r||(r=window._),e.exports=r},59832:function(e,t,n){var r=n(8217),i=n(92304);function o(e,t,n,s,a,u,c){var l=e.children(c);if(l.length){var h=i.addBorderNode(e,"_bt"),d=i.addBorderNode(e,"_bb"),f=e.node(c);e.setParent(h,c),f.borderTop=h,e.setParent(d,c),f.borderBottom=d,r.forEach(l,(function(r){o(e,t,n,s,a,u,r);var i=e.node(r),l=i.borderTop?i.borderTop:r,f=i.borderBottom?i.borderBottom:r,p=i.borderTop?s:2*s,m=l!==f?1:a-u[c]+1;e.setEdge(h,l,{weight:p,minlen:m,nestingEdge:!0}),e.setEdge(f,d,{weight:p,minlen:m,nestingEdge:!0})})),e.parent(c)||e.setEdge(t,h,{weight:0,minlen:a+u[c]})}else c!==t&&e.setEdge(t,c,{weight:0,minlen:n})}e.exports={run:function(e){var t=i.addDummyNode(e,"root",{},"_root"),n=function(e){var t={};function n(i,o){var s=e.children(i);s&&s.length&&r.forEach(s,(function(e){n(e,o+1)})),t[i]=o}return r.forEach(e.children(),(function(e){n(e,1)})),t}(e),s=r.max(r.values(n))-1,a=2*s+1;e.graph().nestingRoot=t,r.forEach(e.edges(),(function(t){e.edge(t).minlen*=a}));var u=function(e){return r.reduce(e.edges(),(function(t,n){return t+e.edge(n).weight}),0)}(e)+1;r.forEach(e.children(),(function(r){o(e,t,a,u,s,n,r)})),e.graph().nodeRankFactor=a},cleanup:function(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,r.forEach(e.edges(),(function(t){e.edge(t).nestingEdge&&e.removeEdge(t)}))}}},67099:function(e,t,n){"use strict";var r=n(8217),i=n(92304);e.exports={run:function(e){e.graph().dummyChains=[],r.forEach(e.edges(),(function(t){!function(e,t){var n,r,o,s=t.v,a=e.node(s).rank,u=t.w,c=e.node(u).rank,l=t.name,h=e.edge(t),d=h.labelRank;if(c===a+1)return;for(e.removeEdge(t),o=0,++a;a<c;++o,++a)h.points=[],r={width:0,height:0,edgeLabel:h,edgeObj:t,rank:a},n=i.addDummyNode(e,"edge",r,"_d"),a===d&&(r.width=h.width,r.height=h.height,r.dummy="edge-label",r.labelpos=h.labelpos),e.setEdge(s,n,{weight:h.weight},l),0===o&&e.graph().dummyChains.push(n),s=n;e.setEdge(s,u,{weight:h.weight},l)}(e,t)}))},undo:function(e){r.forEach(e.graph().dummyChains,(function(t){var n,r=e.node(t),i=r.edgeLabel;for(e.setEdge(r.edgeObj,i);r.dummy;)n=e.successors(t)[0],e.removeNode(t),i.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),t=n,r=e.node(t)}))}}},72952:function(e,t,n){var r=n(8217);e.exports=function(e,t,n){var i,o={};r.forEach(n,(function(n){for(var r,s,a=e.parent(n);a;){if((r=e.parent(a))?(s=o[r],o[r]=a):(s=i,i=a),s&&s!==a)return void t.setEdge(s,a);a=r}}))}},22207:function(e,t,n){var r=n(8217);e.exports=function(e,t){return r.map(t,(function(t){var n=e.inEdges(t);if(n.length){var i=r.reduce(n,(function(t,n){var r=e.edge(n),i=e.node(n.v);return{sum:t.sum+r.weight*i.order,weight:t.weight+r.weight}}),{sum:0,weight:0});return{v:t,barycenter:i.sum/i.weight,weight:i.weight}}return{v:t}}))}},9643:function(e,t,n){var r=n(8217),i=n(68509).Graph;e.exports=function(e,t,n){var o=function(e){var t;for(;e.hasNode(t=r.uniqueId("_root")););return t}(e),s=new i({compound:!0}).setGraph({root:o}).setDefaultNodeLabel((function(t){return e.node(t)}));return r.forEach(e.nodes(),(function(i){var a=e.node(i),u=e.parent(i);(a.rank===t||a.minRank<=t&&t<=a.maxRank)&&(s.setNode(i),s.setParent(i,u||o),r.forEach(e[n](i),(function(t){var n=t.v===i?t.w:t.v,o=s.edge(n,i),a=r.isUndefined(o)?0:o.weight;s.setEdge(n,i,{weight:e.edge(t).weight+a})})),r.has(a,"minRank")&&s.setNode(i,{borderLeft:a.borderLeft[t],borderRight:a.borderRight[t]}))})),s}},51094:function(e,t,n){"use strict";var r=n(8217);function i(e,t,n){for(var i=r.zipObject(n,r.map(n,(function(e,t){return t}))),o=r.flatten(r.map(t,(function(t){return r.sortBy(r.map(e.outEdges(t),(function(t){return{pos:i[t.w],weight:e.edge(t).weight}})),"pos")})),!0),s=1;s<n.length;)s<<=1;var a=2*s-1;s-=1;var u=r.map(new Array(a),(function(){return 0})),c=0;return r.forEach(o.forEach((function(e){var t=e.pos+s;u[t]+=e.weight;for(var n=0;t>0;)t%2&&(n+=u[t+1]),u[t=t-1>>1]+=e.weight;c+=e.weight*n}))),c}e.exports=function(e,t){for(var n=0,r=1;r<t.length;++r)n+=i(e,t[r-1],t[r]);return n}},89717:function(e,t,n){"use strict";var r=n(8217),i=n(89853),o=n(51094),s=n(66675),a=n(9643),u=n(72952),c=n(68509).Graph,l=n(92304);function h(e,t,n){return r.map(t,(function(t){return a(e,t,n)}))}function d(e,t){var n=new c;r.forEach(e,(function(e){var i=e.graph().root,o=s(e,i,n,t);r.forEach(o.vs,(function(t,n){e.node(t).order=n})),u(e,n,o.vs)}))}function f(e,t){r.forEach(t,(function(t){r.forEach(t,(function(t,n){e.node(t).order=n}))}))}e.exports=function(e){var t=l.maxRank(e),n=h(e,r.range(1,t+1),"inEdges"),s=h(e,r.range(t-1,-1,-1),"outEdges"),a=i(e);f(e,a);for(var u,c=Number.POSITIVE_INFINITY,p=0,m=0;m<4;++p,++m){d(p%2?n:s,p%4>=2),a=l.buildLayerMatrix(e);var g=o(e,a);g<c&&(m=0,u=r.cloneDeep(a),c=g)}f(e,u)}},89853:function(e,t,n){"use strict";var r=n(8217);e.exports=function(e){var t={},n=r.filter(e.nodes(),(function(t){return!e.children(t).length})),i=r.max(r.map(n,(function(t){return e.node(t).rank}))),o=r.map(r.range(i+1),(function(){return[]}));var s=r.sortBy(n,(function(t){return e.node(t).rank}));return r.forEach(s,(function n(i){if(r.has(t,i))return;t[i]=!0;var s=e.node(i);o[s.rank].push(i),r.forEach(e.successors(i),n)})),o}},5171:function(e,t,n){"use strict";var r=n(8217);e.exports=function(e,t){var n={};return r.forEach(e,(function(e,t){var i=n[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};r.isUndefined(e.barycenter)||(i.barycenter=e.barycenter,i.weight=e.weight)})),r.forEach(t.edges(),(function(e){var t=n[e.v],i=n[e.w];r.isUndefined(t)||r.isUndefined(i)||(i.indegree++,t.out.push(n[e.w]))})),function(e){var t=[];function n(e){return function(t){t.merged||(r.isUndefined(t.barycenter)||r.isUndefined(e.barycenter)||t.barycenter>=e.barycenter)&&function(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight);t.weight&&(n+=t.barycenter*t.weight,r+=t.weight);e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}(e,t)}}function i(t){return function(n){n.in.push(t),0==--n.indegree&&e.push(n)}}for(;e.length;){var o=e.pop();t.push(o),r.forEach(o.in.reverse(),n(o)),r.forEach(o.out,i(o))}return r.map(r.filter(t,(function(e){return!e.merged})),(function(e){return r.pick(e,["vs","i","barycenter","weight"])}))}(r.filter(n,(function(e){return!e.indegree})))}},66675:function(e,t,n){var r=n(8217),i=n(22207),o=n(5171),s=n(45737);e.exports=function e(t,n,a,u){var c=t.children(n),l=t.node(n),h=l?l.borderLeft:void 0,d=l?l.borderRight:void 0,f={};h&&(c=r.filter(c,(function(e){return e!==h&&e!==d})));var p=i(t,c);r.forEach(p,(function(n){if(t.children(n.v).length){var i=e(t,n.v,a,u);f[n.v]=i,r.has(i,"barycenter")&&(o=n,s=i,r.isUndefined(o.barycenter)?(o.barycenter=s.barycenter,o.weight=s.weight):(o.barycenter=(o.barycenter*o.weight+s.barycenter*s.weight)/(o.weight+s.weight),o.weight+=s.weight))}var o,s}));var m=o(p,a);!function(e,t){r.forEach(e,(function(e){e.vs=r.flatten(e.vs.map((function(e){return t[e]?t[e].vs:e})),!0)}))}(m,f);var g=s(m,u);if(h&&(g.vs=r.flatten([h,g.vs,d],!0),t.predecessors(h).length)){var v=t.node(t.predecessors(h)[0]),y=t.node(t.predecessors(d)[0]);r.has(g,"barycenter")||(g.barycenter=0,g.weight=0),g.barycenter=(g.barycenter*g.weight+v.order+y.order)/(g.weight+2),g.weight+=2}return g}},45737:function(e,t,n){var r=n(8217),i=n(92304);function o(e,t,n){for(var i;t.length&&(i=r.last(t)).i<=n;)t.pop(),e.push(i.vs),n++;return n}e.exports=function(e,t){var n=i.partition(e,(function(e){return r.has(e,"barycenter")})),s=n.lhs,a=r.sortBy(n.rhs,(function(e){return-e.i})),u=[],c=0,l=0,h=0;s.sort((d=!!t,function(e,t){return e.barycenter<t.barycenter?-1:e.barycenter>t.barycenter?1:d?t.i-e.i:e.i-t.i})),h=o(u,a,h),r.forEach(s,(function(e){h+=e.vs.length,u.push(e.vs),c+=e.barycenter*e.weight,l+=e.weight,h=o(u,a,h)}));var d;var f={vs:r.flatten(u,!0)};l&&(f.barycenter=c/l,f.weight=l);return f}},24685:function(e,t,n){var r=n(8217);e.exports=function(e){var t=function(e){var t={},n=0;function i(o){var s=n;r.forEach(e.children(o),i),t[o]={low:s,lim:n++}}return r.forEach(e.children(),i),t}(e);r.forEach(e.graph().dummyChains,(function(n){for(var r=e.node(n),i=r.edgeObj,o=function(e,t,n,r){var i,o,s=[],a=[],u=Math.min(t[n].low,t[r].low),c=Math.max(t[n].lim,t[r].lim);i=n;do{i=e.parent(i),s.push(i)}while(i&&(t[i].low>u||c>t[i].lim));o=i,i=r;for(;(i=e.parent(i))!==o;)a.push(i);return{path:s.concat(a.reverse()),lca:o}}(e,t,i.v,i.w),s=o.path,a=o.lca,u=0,c=s[u],l=!0;n!==i.w;){if(r=e.node(n),l){for(;(c=s[u])!==a&&e.node(c).maxRank<r.rank;)u++;c===a&&(l=!1)}if(!l){for(;u<s.length-1&&e.node(c=s[u+1]).minRank<=r.rank;)u++;c=s[u]}e.setParent(n,c),n=e.successors(n)[0]}}))}},21006:function(e,t,n){"use strict";var r=n(8217),i=n(68509).Graph,o=n(92304);function s(e,t){var n={};return r.reduce(t,(function(t,i){var o=0,s=0,a=t.length,c=r.last(i);return r.forEach(i,(function(t,l){var h=function(e,t){if(e.node(t).dummy)return r.find(e.predecessors(t),(function(t){return e.node(t).dummy}))}(e,t),d=h?e.node(h).order:a;(h||t===c)&&(r.forEach(i.slice(s,l+1),(function(t){r.forEach(e.predecessors(t),(function(r){var i=e.node(r),s=i.order;!(s<o||d<s)||i.dummy&&e.node(t).dummy||u(n,r,t)}))})),s=l+1,o=d)})),i})),n}function a(e,t){var n={};function i(t,i,o,s,a){var c;r.forEach(r.range(i,o),(function(i){c=t[i],e.node(c).dummy&&r.forEach(e.predecessors(c),(function(t){var r=e.node(t);r.dummy&&(r.order<s||r.order>a)&&u(n,t,c)}))}))}return r.reduce(t,(function(t,n){var o,s=-1,a=0;return r.forEach(n,(function(r,u){if("border"===e.node(r).dummy){var c=e.predecessors(r);c.length&&(o=e.node(c[0]).order,i(n,a,u,s,o),a=u,s=o)}i(n,a,n.length,o,t.length)})),n})),n}function u(e,t,n){if(t>n){var r=t;t=n,n=r}var i=e[t];i||(e[t]=i={}),i[n]=!0}function c(e,t,n){if(t>n){var i=t;t=n,n=i}return r.has(e[t],n)}function l(e,t,n,i){var o={},s={},a={};return r.forEach(t,(function(e){r.forEach(e,(function(e,t){o[e]=e,s[e]=e,a[e]=t}))})),r.forEach(t,(function(e){var t=-1;r.forEach(e,(function(e){var u=i(e);if(u.length){u=r.sortBy(u,(function(e){return a[e]}));for(var l=(u.length-1)/2,h=Math.floor(l),d=Math.ceil(l);h<=d;++h){var f=u[h];s[e]===e&&t<a[f]&&!c(n,e,f)&&(s[f]=e,s[e]=o[e]=o[f],t=a[f])}}}))})),{root:o,align:s}}function h(e,t,n,o,s){var a={},u=function(e,t,n,o){var s=new i,a=e.graph(),u=function(e,t,n){return function(i,o,s){var a,u=i.node(o),c=i.node(s),l=0;if(l+=u.width/2,r.has(u,"labelpos"))switch(u.labelpos.toLowerCase()){case"l":a=-u.width/2;break;case"r":a=u.width/2}if(a&&(l+=n?a:-a),a=0,l+=(u.dummy?t:e)/2,l+=(c.dummy?t:e)/2,l+=c.width/2,r.has(c,"labelpos"))switch(c.labelpos.toLowerCase()){case"l":a=c.width/2;break;case"r":a=-c.width/2}return a&&(l+=n?a:-a),a=0,l}}(a.nodesep,a.edgesep,o);return r.forEach(t,(function(t){var i;r.forEach(t,(function(t){var r=n[t];if(s.setNode(r),i){var o=n[i],a=s.edge(o,r);s.setEdge(o,r,Math.max(u(e,t,i),a||0))}i=t}))})),s}(e,t,n,s),c=s?"borderLeft":"borderRight";function l(e,t){for(var n=u.nodes(),r=n.pop(),i={};r;)i[r]?e(r):(i[r]=!0,n.push(r),n=n.concat(t(r))),r=n.pop()}return l((function(e){a[e]=u.inEdges(e).reduce((function(e,t){return Math.max(e,a[t.v]+u.edge(t))}),0)}),u.predecessors.bind(u)),l((function(t){var n=u.outEdges(t).reduce((function(e,t){return Math.min(e,a[t.w]-u.edge(t))}),Number.POSITIVE_INFINITY),r=e.node(t);n!==Number.POSITIVE_INFINITY&&r.borderType!==c&&(a[t]=Math.max(a[t],n))}),u.successors.bind(u)),r.forEach(o,(function(e){a[e]=a[n[e]]})),a}function d(e,t){return r.minBy(r.values(t),(function(t){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return r.forIn(t,(function(t,r){var o=function(e,t){return e.node(t).width}(e,r)/2;n=Math.max(t+o,n),i=Math.min(t-o,i)})),n-i}))}function f(e,t){var n=r.values(t),i=r.min(n),o=r.max(n);r.forEach(["u","d"],(function(n){r.forEach(["l","r"],(function(s){var a,u=n+s,c=e[u];if(c!==t){var l=r.values(c);(a="l"===s?i-r.min(l):o-r.max(l))&&(e[u]=r.mapValues(c,(function(e){return e+a})))}}))}))}function p(e,t){return r.mapValues(e.ul,(function(n,i){if(t)return e[t.toLowerCase()][i];var o=r.sortBy(r.map(e,i));return(o[1]+o[2])/2}))}e.exports={positionX:function(e){var t,n=o.buildLayerMatrix(e),i=r.merge(s(e,n),a(e,n)),u={};r.forEach(["u","d"],(function(o){t="u"===o?n:r.values(n).reverse(),r.forEach(["l","r"],(function(n){"r"===n&&(t=r.map(t,(function(e){return r.values(e).reverse()})));var s=("u"===o?e.predecessors:e.successors).bind(e),a=l(e,t,i,s),c=h(e,t,a.root,a.align,"r"===n);"r"===n&&(c=r.mapValues(c,(function(e){return-e}))),u[o+n]=c}))}));var c=d(e,u);return f(u,c),p(u,e.graph().align)},findType1Conflicts:s,findType2Conflicts:a,addConflict:u,hasConflict:c,verticalAlignment:l,horizontalCompaction:h,alignCoordinates:f,findSmallestWidthAlignment:d,balance:p}},63363:function(e,t,n){"use strict";var r=n(8217),i=n(92304),o=n(21006).positionX;e.exports=function(e){(function(e){var t=i.buildLayerMatrix(e),n=e.graph().ranksep,o=0;r.forEach(t,(function(t){var i=r.max(r.map(t,(function(t){return e.node(t).height})));r.forEach(t,(function(t){e.node(t).y=o+i/2})),o+=i+n}))})(e=i.asNonCompoundGraph(e)),r.forEach(o(e),(function(t,n){e.node(n).x=t}))}},31848:function(e,t,n){"use strict";var r=n(8217),i=n(68509).Graph,o=n(74211).slack;function s(e,t){return r.forEach(e.nodes(),(function n(i){r.forEach(t.nodeEdges(i),(function(r){var s=r.v,a=i===s?r.w:s;e.hasNode(a)||o(t,r)||(e.setNode(a,{}),e.setEdge(i,a,{}),n(a))}))})),e.nodeCount()}function a(e,t){return r.minBy(t.edges(),(function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return o(t,n)}))}function u(e,t,n){r.forEach(e.nodes(),(function(e){t.node(e).rank+=n}))}e.exports=function(e){var t,n,r=new i({directed:!1}),c=e.nodes()[0],l=e.nodeCount();r.setNode(c,{});for(;s(r,e)<l;)t=a(r,e),n=r.hasNode(t.v)?o(e,t):-o(e,t),u(r,e,n);return r}},65511:function(e,t,n){"use strict";var r=n(74211).longestPath,i=n(31848),o=n(37736);e.exports=function(e){switch(e.graph().ranker){case"network-simplex":default:a(e);break;case"tight-tree":!function(e){r(e),i(e)}(e);break;case"longest-path":s(e)}};var s=r;function a(e){o(e)}},37736:function(e,t,n){"use strict";var r=n(8217),i=n(31848),o=n(74211).slack,s=n(74211).longestPath,a=n(68509).alg.preorder,u=n(68509).alg.postorder,c=n(92304).simplify;function l(e){e=c(e),s(e);var t,n=i(e);for(f(n),h(n,e);t=m(n);)v(n,e,t,g(n,e,t))}function h(e,t){var n=u(e,e.nodes());n=n.slice(0,n.length-1),r.forEach(n,(function(n){!function(e,t,n){var r=e.node(n),i=r.parent;e.edge(n,i).cutvalue=d(e,t,n)}(e,t,n)}))}function d(e,t,n){var i=e.node(n).parent,o=!0,s=t.edge(n,i),a=0;return s||(o=!1,s=t.edge(i,n)),a=s.weight,r.forEach(t.nodeEdges(n),(function(r){var s,u,c=r.v===n,l=c?r.w:r.v;if(l!==i){var h=c===o,d=t.edge(r).weight;if(a+=h?d:-d,s=n,u=l,e.hasEdge(s,u)){var f=e.edge(n,l).cutvalue;a+=h?-f:f}}})),a}function f(e,t){arguments.length<2&&(t=e.nodes()[0]),p(e,{},1,t)}function p(e,t,n,i,o){var s=n,a=e.node(i);return t[i]=!0,r.forEach(e.neighbors(i),(function(o){r.has(t,o)||(n=p(e,t,n,o,i))})),a.low=s,a.lim=n++,o?a.parent=o:delete a.parent,n}function m(e){return r.find(e.edges(),(function(t){return e.edge(t).cutvalue<0}))}function g(e,t,n){var i=n.v,s=n.w;t.hasEdge(i,s)||(i=n.w,s=n.v);var a=e.node(i),u=e.node(s),c=a,l=!1;a.lim>u.lim&&(c=u,l=!0);var h=r.filter(t.edges(),(function(t){return l===y(e,e.node(t.v),c)&&l!==y(e,e.node(t.w),c)}));return r.minBy(h,(function(e){return o(t,e)}))}function v(e,t,n,i){var o=n.v,s=n.w;e.removeEdge(o,s),e.setEdge(i.v,i.w,{}),f(e),h(e,t),function(e,t){var n=r.find(e.nodes(),(function(e){return!t.node(e).parent})),i=a(e,n);i=i.slice(1),r.forEach(i,(function(n){var r=e.node(n).parent,i=t.edge(n,r),o=!1;i||(i=t.edge(r,n),o=!0),t.node(n).rank=t.node(r).rank+(o?i.minlen:-i.minlen)}))}(e,t)}function y(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}e.exports=l,l.initLowLimValues=f,l.initCutValues=h,l.calcCutValue=d,l.leaveEdge=m,l.enterEdge=g,l.exchangeEdges=v},74211:function(e,t,n){"use strict";var r=n(8217);e.exports={longestPath:function(e){var t={};r.forEach(e.sources(),(function n(i){var o=e.node(i);if(r.has(t,i))return o.rank;t[i]=!0;var s=r.min(r.map(e.outEdges(i),(function(t){return n(t.w)-e.edge(t).minlen})));return s!==Number.POSITIVE_INFINITY&&null!=s||(s=0),o.rank=s}))},slack:function(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}}},92304:function(e,t,n){"use strict";var r=n(8217),i=n(68509).Graph;function o(e,t,n,i){var o;do{o=r.uniqueId(i)}while(e.hasNode(o));return n.dummy=t,e.setNode(o,n),o}function s(e){return r.max(r.map(e.nodes(),(function(t){var n=e.node(t).rank;if(!r.isUndefined(n))return n})))}e.exports={addDummyNode:o,simplify:function(e){var t=(new i).setGraph(e.graph());return r.forEach(e.nodes(),(function(n){t.setNode(n,e.node(n))})),r.forEach(e.edges(),(function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})})),t},asNonCompoundGraph:function(e){var t=new i({multigraph:e.isMultigraph()}).setGraph(e.graph());return r.forEach(e.nodes(),(function(n){e.children(n).length||t.setNode(n,e.node(n))})),r.forEach(e.edges(),(function(n){t.setEdge(n,e.edge(n))})),t},successorWeights:function(e){var t=r.map(e.nodes(),(function(t){var n={};return r.forEach(e.outEdges(t),(function(t){n[t.w]=(n[t.w]||0)+e.edge(t).weight})),n}));return r.zipObject(e.nodes(),t)},predecessorWeights:function(e){var t=r.map(e.nodes(),(function(t){var n={};return r.forEach(e.inEdges(t),(function(t){n[t.v]=(n[t.v]||0)+e.edge(t).weight})),n}));return r.zipObject(e.nodes(),t)},intersectRect:function(e,t){var n,r,i=e.x,o=e.y,s=t.x-i,a=t.y-o,u=e.width/2,c=e.height/2;if(!s&&!a)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(a)*u>Math.abs(s)*c?(a<0&&(c=-c),n=c*s/a,r=c):(s<0&&(u=-u),n=u,r=u*a/s);return{x:i+n,y:o+r}},buildLayerMatrix:function(e){var t=r.map(r.range(s(e)+1),(function(){return[]}));return r.forEach(e.nodes(),(function(n){var i=e.node(n),o=i.rank;r.isUndefined(o)||(t[o][i.order]=n)})),t},normalizeRanks:function(e){var t=r.min(r.map(e.nodes(),(function(t){return e.node(t).rank})));r.forEach(e.nodes(),(function(n){var i=e.node(n);r.has(i,"rank")&&(i.rank-=t)}))},removeEmptyRanks:function(e){var t=r.min(r.map(e.nodes(),(function(t){return e.node(t).rank}))),n=[];r.forEach(e.nodes(),(function(r){var i=e.node(r).rank-t;n[i]||(n[i]=[]),n[i].push(r)}));var i=0,o=e.graph().nodeRankFactor;r.forEach(n,(function(t,n){r.isUndefined(t)&&n%o!=0?--i:i&&r.forEach(t,(function(t){e.node(t).rank+=i}))}))},addBorderNode:function(e,t,n,r){var i={width:0,height:0};arguments.length>=4&&(i.rank=n,i.order=r);return o(e,"border",i,t)},maxRank:s,partition:function(e,t){var n={lhs:[],rhs:[]};return r.forEach(e,(function(e){t(e)?n.lhs.push(e):n.rhs.push(e)})),n},time:function(e,t){var n=r.now();try{return t()}finally{console.log(e+" time: "+(r.now()-n)+"ms")}},notime:function(e,t){return t()}}},90975:function(e){e.exports="0.8.5"},2337:function(e){"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new i(r,o||e,s),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],a]:e._events[u].push(a):(e._events[u]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,s=new Array(o);i<o;i++)s[i]=r[i].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,i,o,s){var a=n?n+e:e;if(!this._events[a])return!1;var u,c,l=this._events[a],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,i),!0;case 5:return l.fn.call(l.context,t,r,i,o),!0;case 6:return l.fn.call(l.context,t,r,i,o,s),!0}for(c=1,u=new Array(h-1);c<h;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var d,f=l.length;for(c=0;c<f;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),h){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,r);break;case 4:l[c].fn.call(l[c].context,t,r,i);break;default:if(!u)for(d=1,u=new Array(h-1);d<h;d++)u[d-1]=arguments[d];l[c].fn.apply(l[c].context,u)}}return!0},a.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||s(this,o);else{for(var u=0,c=[],l=a.length;u<l;u++)(a[u].fn!==t||i&&!a[u].once||r&&a[u].context!==r)&&c.push(a[u]);c.length?this._events[o]=1===c.length?c[0]:c:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},72100:function(e){"use strict";var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}m(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&m(e,"error",t,n)}(e,i,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function c(e,t,n,r){var i,o,s,c;if(a(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=u(e))>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,c=l,console&&console.warn&&console.warn(c)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=l.bind(r);return i.listener=n,r.wrapFn=i,i}function d(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):p(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function m(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var u=o[e];if(void 0===u)return!1;if("function"==typeof u)r(u,this,t);else{var c=u.length,l=p(u,c);for(n=0;n<c;++n)r(l[n],this,t)}return!0},o.prototype.addListener=function(e,t){return c(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return c(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,h(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,h(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,r,i,o,s;if(a(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return d(this,e,!0)},o.prototype.rawListeners=function(e){return d(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},16239:function(e,t,n){var r=n(23617);e.exports={Graph:r.Graph,json:n(53988),alg:n(92010),version:r.version}},49004:function(e,t,n){var r=n(91124);e.exports=function(e){var t,n={},i=[];function o(i){r.has(n,i)||(n[i]=!0,t.push(i),r.each(e.successors(i),o),r.each(e.predecessors(i),o))}return r.each(e.nodes(),(function(e){t=[],o(e),t.length&&i.push(t)})),i}},10689:function(e,t,n){var r=n(91124);function i(e,t,n,o,s,a){r.has(o,t)||(o[t]=!0,n||a.push(t),r.each(s(t),(function(t){i(e,t,n,o,s,a)})),n&&a.push(t))}e.exports=function(e,t,n){r.isArray(t)||(t=[t]);var o=(e.isDirected()?e.successors:e.neighbors).bind(e),s=[],a={};return r.each(t,(function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);i(e,t,"post"===n,a,o,s)})),s}},53659:function(e,t,n){var r=n(95070),i=n(91124);e.exports=function(e,t,n){return i.transform(e.nodes(),(function(i,o){i[o]=r(e,o,t,n)}),{})}},95070:function(e,t,n){var r=n(91124),i=n(60392);e.exports=function(e,t,n,r){return function(e,t,n,r){var o,s,a={},u=new i,c=function(e){var t=e.v!==o?e.v:e.w,r=a[t],i=n(e),c=s.distance+i;if(i<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+i);c<r.distance&&(r.distance=c,r.predecessor=o,u.decrease(t,c))};e.nodes().forEach((function(e){var n=e===t?0:Number.POSITIVE_INFINITY;a[e]={distance:n},u.add(e,n)}));for(;u.size()>0&&(o=u.removeMin(),(s=a[o]).distance!==Number.POSITIVE_INFINITY);)r(o).forEach(c);return a}(e,String(t),n||o,r||function(t){return e.outEdges(t)})};var o=r.constant(1)},53548:function(e,t,n){var r=n(91124),i=n(87299);e.exports=function(e){return r.filter(i(e),(function(t){return t.length>1||1===t.length&&e.hasEdge(t[0],t[0])}))}},1637:function(e,t,n){var r=n(91124);e.exports=function(e,t,n){return function(e,t,n){var r={},i=e.nodes();return i.forEach((function(e){r[e]={},r[e][e]={distance:0},i.forEach((function(t){e!==t&&(r[e][t]={distance:Number.POSITIVE_INFINITY})})),n(e).forEach((function(n){var i=n.v===e?n.w:n.v,o=t(n);r[e][i]={distance:o,predecessor:e}}))})),i.forEach((function(e){var t=r[e];i.forEach((function(n){var o=r[n];i.forEach((function(n){var r=o[e],i=t[n],s=o[n],a=r.distance+i.distance;a<s.distance&&(s.distance=a,s.predecessor=i.predecessor)}))}))})),r}(e,t||i,n||function(t){return e.outEdges(t)})};var i=r.constant(1)},92010:function(e,t,n){e.exports={components:n(49004),dijkstra:n(95070),dijkstraAll:n(53659),findCycles:n(53548),floydWarshall:n(1637),isAcyclic:n(52974),postorder:n(88021),preorder:n(35954),prim:n(61102),tarjan:n(87299),topsort:n(12177)}},52974:function(e,t,n){var r=n(12177);e.exports=function(e){try{r(e)}catch(e){if(e instanceof r.CycleException)return!1;throw e}return!0}},88021:function(e,t,n){var r=n(10689);e.exports=function(e,t){return r(e,t,"post")}},35954:function(e,t,n){var r=n(10689);e.exports=function(e,t){return r(e,t,"pre")}},61102:function(e,t,n){var r=n(91124),i=n(58415),o=n(60392);e.exports=function(e,t){var n,s=new i,a={},u=new o;function c(e){var r=e.v===n?e.w:e.v,i=u.priority(r);if(void 0!==i){var o=t(e);o<i&&(a[r]=n,u.decrease(r,o))}}if(0===e.nodeCount())return s;r.each(e.nodes(),(function(e){u.add(e,Number.POSITIVE_INFINITY),s.setNode(e)})),u.decrease(e.nodes()[0],0);var l=!1;for(;u.size()>0;){if(n=u.removeMin(),r.has(a,n))s.setEdge(n,a[n]);else{if(l)throw new Error("Input graph is not connected: "+e);l=!0}e.nodeEdges(n).forEach(c)}return s}},87299:function(e,t,n){var r=n(91124);e.exports=function(e){var t=0,n=[],i={},o=[];function s(a){var u=i[a]={onStack:!0,lowlink:t,index:t++};if(n.push(a),e.successors(a).forEach((function(e){r.has(i,e)?i[e].onStack&&(u.lowlink=Math.min(u.lowlink,i[e].index)):(s(e),u.lowlink=Math.min(u.lowlink,i[e].lowlink))})),u.lowlink===u.index){var c,l=[];do{c=n.pop(),i[c].onStack=!1,l.push(c)}while(a!==c);o.push(l)}}return e.nodes().forEach((function(e){r.has(i,e)||s(e)})),o}},12177:function(e,t,n){var r=n(91124);function i(e){var t={},n={},i=[];if(r.each(e.sinks(),(function s(a){if(r.has(n,a))throw new o;r.has(t,a)||(n[a]=!0,t[a]=!0,r.each(e.predecessors(a),s),delete n[a],i.push(a))})),r.size(t)!==e.nodeCount())throw new o;return i}function o(){}e.exports=i,i.CycleException=o,o.prototype=new Error},60392:function(e,t,n){var r=n(91124);function i(){this._arr=[],this._keyIndices={}}e.exports=i,i.prototype.size=function(){return this._arr.length},i.prototype.keys=function(){return this._arr.map((function(e){return e.key}))},i.prototype.has=function(e){return r.has(this._keyIndices,e)},i.prototype.priority=function(e){var t=this._keyIndices[e];if(void 0!==t)return this._arr[t].priority},i.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},i.prototype.add=function(e,t){var n=this._keyIndices;if(e=String(e),!r.has(n,e)){var i=this._arr,o=i.length;return n[e]=o,i.push({key:e,priority:t}),this._decrease(o),!0}return!1},i.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},i.prototype.decrease=function(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)},i.prototype._heapify=function(e){var t=this._arr,n=2*e,r=n+1,i=e;n<t.length&&(i=t[n].priority<t[i].priority?n:i,r<t.length&&(i=t[r].priority<t[i].priority?r:i),i!==e&&(this._swap(e,i),this._heapify(i)))},i.prototype._decrease=function(e){for(var t,n=this._arr,r=n[e].priority;0!==e&&!(n[t=e>>1].priority<r);)this._swap(e,t),e=t},i.prototype._swap=function(e,t){var n=this._arr,r=this._keyIndices,i=n[e],o=n[t];n[e]=o,n[t]=i,r[o.key]=e,r[i.key]=t}},58415:function(e,t,n){"use strict";var r=n(91124);e.exports=o;var i="\0";function o(e){this._isDirected=!r.has(e,"directed")||e.directed,this._isMultigraph=!!r.has(e,"multigraph")&&e.multigraph,this._isCompound=!!r.has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=r.constant(void 0),this._defaultEdgeLabelFn=r.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[i]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function s(e,t){e[t]?e[t]++:e[t]=1}function a(e,t){--e[t]||delete e[t]}function u(e,t,n,i){var o=""+t,s=""+n;if(!e&&o>s){var a=o;o=s,s=a}return o+""+s+""+(r.isUndefined(i)?"\0":i)}function c(e,t,n,r){var i=""+t,o=""+n;if(!e&&i>o){var s=i;i=o,o=s}var a={v:i,w:o};return r&&(a.name=r),a}function l(e,t){return u(e,t.v,t.w,t.name)}o.prototype._nodeCount=0,o.prototype._edgeCount=0,o.prototype.isDirected=function(){return this._isDirected},o.prototype.isMultigraph=function(){return this._isMultigraph},o.prototype.isCompound=function(){return this._isCompound},o.prototype.setGraph=function(e){return this._label=e,this},o.prototype.graph=function(){return this._label},o.prototype.setDefaultNodeLabel=function(e){return r.isFunction(e)||(e=r.constant(e)),this._defaultNodeLabelFn=e,this},o.prototype.nodeCount=function(){return this._nodeCount},o.prototype.nodes=function(){return r.keys(this._nodes)},o.prototype.sources=function(){var e=this;return r.filter(this.nodes(),(function(t){return r.isEmpty(e._in[t])}))},o.prototype.sinks=function(){var e=this;return r.filter(this.nodes(),(function(t){return r.isEmpty(e._out[t])}))},o.prototype.setNodes=function(e,t){var n=arguments,i=this;return r.each(e,(function(e){n.length>1?i.setNode(e,t):i.setNode(e)})),this},o.prototype.setNode=function(e,t){return r.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=i,this._children[e]={},this._children[i][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},o.prototype.node=function(e){return this._nodes[e]},o.prototype.hasNode=function(e){return r.has(this._nodes,e)},o.prototype.removeNode=function(e){var t=this;if(r.has(this._nodes,e)){var n=function(e){t.removeEdge(t._edgeObjs[e])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],r.each(this.children(e),(function(e){t.setParent(e)})),delete this._children[e]),r.each(r.keys(this._in[e]),n),delete this._in[e],delete this._preds[e],r.each(r.keys(this._out[e]),n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},o.prototype.setParent=function(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(r.isUndefined(t))t=i;else{for(var n=t+="";!r.isUndefined(n);n=this.parent(n))if(n===e)throw new Error("Setting "+t+" as parent of "+e+" would create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this},o.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},o.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if(t!==i)return t}},o.prototype.children=function(e){if(r.isUndefined(e)&&(e=i),this._isCompound){var t=this._children[e];if(t)return r.keys(t)}else{if(e===i)return this.nodes();if(this.hasNode(e))return[]}},o.prototype.predecessors=function(e){var t=this._preds[e];if(t)return r.keys(t)},o.prototype.successors=function(e){var t=this._sucs[e];if(t)return r.keys(t)},o.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return r.union(t,this.successors(e))},o.prototype.isLeaf=function(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length},o.prototype.filterNodes=function(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;r.each(this._nodes,(function(n,r){e(r)&&t.setNode(r,n)})),r.each(this._edgeObjs,(function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,n.edge(e))}));var i={};function o(e){var r=n.parent(e);return void 0===r||t.hasNode(r)?(i[e]=r,r):r in i?i[r]:o(r)}return this._isCompound&&r.each(t.nodes(),(function(e){t.setParent(e,o(e))})),t},o.prototype.setDefaultEdgeLabel=function(e){return r.isFunction(e)||(e=r.constant(e)),this._defaultEdgeLabelFn=e,this},o.prototype.edgeCount=function(){return this._edgeCount},o.prototype.edges=function(){return r.values(this._edgeObjs)},o.prototype.setPath=function(e,t){var n=this,i=arguments;return r.reduce(e,(function(e,r){return i.length>1?n.setEdge(e,r,t):n.setEdge(e,r),r})),this},o.prototype.setEdge=function(){var e,t,n,i,o=!1,a=arguments[0];"object"==typeof a&&null!==a&&"v"in a?(e=a.v,t=a.w,n=a.name,2===arguments.length&&(i=arguments[1],o=!0)):(e=a,t=arguments[1],n=arguments[3],arguments.length>2&&(i=arguments[2],o=!0)),e=""+e,t=""+t,r.isUndefined(n)||(n=""+n);var l=u(this._isDirected,e,t,n);if(r.has(this._edgeLabels,l))return o&&(this._edgeLabels[l]=i),this;if(!r.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[l]=o?i:this._defaultEdgeLabelFn(e,t,n);var h=c(this._isDirected,e,t,n);return e=h.v,t=h.w,Object.freeze(h),this._edgeObjs[l]=h,s(this._preds[t],e),s(this._sucs[e],t),this._in[t][l]=h,this._out[e][l]=h,this._edgeCount++,this},o.prototype.edge=function(e,t,n){var r=1===arguments.length?l(this._isDirected,arguments[0]):u(this._isDirected,e,t,n);return this._edgeLabels[r]},o.prototype.hasEdge=function(e,t,n){var i=1===arguments.length?l(this._isDirected,arguments[0]):u(this._isDirected,e,t,n);return r.has(this._edgeLabels,i)},o.prototype.removeEdge=function(e,t,n){var r=1===arguments.length?l(this._isDirected,arguments[0]):u(this._isDirected,e,t,n),i=this._edgeObjs[r];return i&&(e=i.v,t=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],a(this._preds[t],e),a(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this},o.prototype.inEdges=function(e,t){var n=this._in[e];if(n){var i=r.values(n);return t?r.filter(i,(function(e){return e.v===t})):i}},o.prototype.outEdges=function(e,t){var n=this._out[e];if(n){var i=r.values(n);return t?r.filter(i,(function(e){return e.w===t})):i}},o.prototype.nodeEdges=function(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))}},23617:function(e,t,n){e.exports={Graph:n(58415),version:n(58183)}},53988:function(e,t,n){var r=n(91124),i=n(58415);function o(e){return r.map(e.nodes(),(function(t){var n=e.node(t),i=e.parent(t),o={v:t};return r.isUndefined(n)||(o.value=n),r.isUndefined(i)||(o.parent=i),o}))}function s(e){return r.map(e.edges(),(function(t){var n=e.edge(t),i={v:t.v,w:t.w};return r.isUndefined(t.name)||(i.name=t.name),r.isUndefined(n)||(i.value=n),i}))}e.exports={write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:o(e),edges:s(e)};r.isUndefined(e.graph())||(t.value=r.clone(e.graph()));return t},read:function(e){var t=new i(e.options).setGraph(e.value);return r.each(e.nodes,(function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent)})),r.each(e.edges,(function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value)})),t}}},91124:function(e,t,n){var r;try{r={clone:n(55824),constant:n(64806),each:n(15828),filter:n(3149),has:n(56611),isArray:n(24669),isEmpty:n(82691),isFunction:n(92042),isUndefined:n(89300),keys:n(50579),map:n(65512),reduce:n(6355),size:n(81430),transform:n(68742),union:n(29974),values:n(61017)}}catch(e){}r||(r=window._),e.exports=r},58183:function(e){e.exports="2.1.8"},5490:function(e,t,n){"use strict";n.d(t,{KT:function(){return F}});const r=(()=>{let e=0;return()=>(e+=1,`u${`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4)}${e}`)})();function i(e){const t=[];for(let n=0,r=e.length;n<r;n++)t.push(e[n]);return t}function o(e,t){const n=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return n?parseFloat(n.replace("px","")):0}function s(e,t={}){return{width:t.width||function(e){const t=o(e,"border-left-width"),n=o(e,"border-right-width");return e.clientWidth+t+n}(e),height:t.height||function(e){const t=o(e,"border-top-width"),n=o(e,"border-bottom-width");return e.clientHeight+t+n}(e)}}function a(e){return new Promise(((t,n)=>{const r=new Image;r.decode=()=>t(r),r.onload=()=>t(r),r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=e}))}async function u(e,t,n){const r="http://www.w3.org/2000/svg",i=document.createElementNS(r,"svg"),o=document.createElementNS(r,"foreignObject");return i.setAttribute("width",`${t}`),i.setAttribute("height",`${n}`),i.setAttribute("viewBox",`0 0 ${t} ${n}`),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("x","0"),o.setAttribute("y","0"),o.setAttribute("externalResourcesRequired","true"),i.appendChild(o),o.appendChild(e),async function(e){return Promise.resolve().then((()=>(new XMLSerializer).serializeToString(e))).then(encodeURIComponent).then((e=>`data:image/svg+xml;charset=utf-8,${e}`))}(i)}const c=(e,t)=>{if(e instanceof t)return!0;const n=Object.getPrototypeOf(e);return null!==n&&(n.constructor.name===t.name||c(n,t))};function l(e,t,n){const r=`.${e}:${t}`,o=n.cssText?function(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}(n):function(e){return i(e).map((t=>`${t}: ${e.getPropertyValue(t)}${e.getPropertyPriority(t)?" !important":""};`)).join(" ")}(n);return document.createTextNode(`${r}{${o}}`)}function h(e,t,n){const i=window.getComputedStyle(e,n),o=i.getPropertyValue("content");if(""===o||"none"===o)return;const s=r();try{t.className=`${t.className} ${s}`}catch(e){return}const a=document.createElement("style");a.appendChild(l(s,n,i)),t.appendChild(a)}const d="application/font-woff",f="image/jpeg",p={woff:d,woff2:d,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:f,jpeg:f,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function m(e){const t=function(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}(e).toLowerCase();return p[t]||""}function g(e){return-1!==e.search(/^(data:)/)}function v(e,t){return`data:${t};base64,${e}`}async function y(e,t,n){const r=await fetch(e,t);if(404===r.status)throw new Error(`Resource "${r.url}" not found`);const i=await r.blob();return new Promise(((e,t)=>{const o=new FileReader;o.onerror=t,o.onloadend=()=>{try{e(n({res:r,result:o.result}))}catch(e){t(e)}},o.readAsDataURL(i)}))}const b={};async function _(e,t,n){const r=function(e,t,n){let r=e.replace(/\?.*/,"");return n&&(r=e),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),t?`[${t}]${r}`:r}(e,t,n.includeQueryParams);if(null!=b[r])return b[r];let i;n.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+(new Date).getTime());try{const r=await y(e,n.fetchRequestInit,(({res:e,result:n})=>(t||(t=e.headers.get("Content-Type")||""),function(e){return e.split(/,/)[1]}(n))));i=v(r,t)}catch(t){i=n.imagePlaceholder||"";let r=`Failed to fetch resource: ${e}`;t&&(r="string"==typeof t?t:t.message),r&&console.warn(r)}return b[r]=i,i}async function x(e,t){return c(e,HTMLCanvasElement)?async function(e){const t=e.toDataURL();return"data:,"===t?e.cloneNode(!1):a(t)}(e):c(e,HTMLVideoElement)?async function(e,t){if(e.currentSrc){const t=document.createElement("canvas"),n=t.getContext("2d");return t.width=e.clientWidth,t.height=e.clientHeight,null==n||n.drawImage(e,0,0,t.width,t.height),a(t.toDataURL())}const n=e.poster,r=m(n);return a(await _(n,r,t))}(e,t):c(e,HTMLIFrameElement)?async function(e){var t;try{if(null===(t=null==e?void 0:e.contentDocument)||void 0===t?void 0:t.body)return await S(e.contentDocument.body,{},!0)}catch(e){}return e.cloneNode(!1)}(e):e.cloneNode(!1)}function w(e,t){return c(t,Element)&&(function(e,t){const n=t.style;if(!n)return;const r=window.getComputedStyle(e);r.cssText?(n.cssText=r.cssText,n.transformOrigin=r.transformOrigin):i(r).forEach((i=>{let o=r.getPropertyValue(i);if("font-size"===i&&o.endsWith("px")){const e=Math.floor(parseFloat(o.substring(0,o.length-2)))-.1;o=`${e}px`}c(e,HTMLIFrameElement)&&"display"===i&&"inline"===o&&(o="block"),"d"===i&&t.getAttribute("d")&&(o=`path(${t.getAttribute("d")})`),n.setProperty(i,o,r.getPropertyPriority(i))}))}(e,t),function(e,t){h(e,t,":before"),h(e,t,":after")}(e,t),function(e,t){c(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),c(e,HTMLInputElement)&&t.setAttribute("value",e.value)}(e,t),function(e,t){if(c(e,HTMLSelectElement)){const n=t,r=Array.from(n.children).find((t=>e.value===t.getAttribute("value")));r&&r.setAttribute("selected","")}}(e,t)),t}async function S(e,t,n){return n||!t.filter||t.filter(e)?Promise.resolve(e).then((e=>x(e,t))).then((n=>async function(e,t,n){var r,o;let s=[];var a;return s=null!=(a=e).tagName&&"SLOT"===a.tagName.toUpperCase()&&e.assignedNodes?i(e.assignedNodes()):c(e,HTMLIFrameElement)&&(null===(r=e.contentDocument)||void 0===r?void 0:r.body)?i(e.contentDocument.body.childNodes):i((null!==(o=e.shadowRoot)&&void 0!==o?o:e).childNodes),0===s.length||c(e,HTMLVideoElement)||await s.reduce(((e,r)=>e.then((()=>S(r,n))).then((e=>{e&&t.appendChild(e)}))),Promise.resolve()),t}(e,n,t))).then((t=>w(e,t))).then((e=>async function(e,t){const n=e.querySelectorAll?e.querySelectorAll("use"):[];if(0===n.length)return e;const r={};for(let i=0;i<n.length;i++){const o=n[i].getAttribute("xlink:href");if(o){const n=e.querySelector(o),i=document.querySelector(o);n||!i||r[o]||(r[o]=await S(i,t,!0))}}const i=Object.values(r);if(i.length){const t="http://www.w3.org/1999/xhtml",n=document.createElementNS(t,"svg");n.setAttribute("xmlns",t),n.style.position="absolute",n.style.width="0",n.style.height="0",n.style.overflow="hidden",n.style.display="none";const r=document.createElementNS(t,"defs");n.appendChild(r);for(let e=0;e<i.length;e++)r.appendChild(i[e]);e.appendChild(n)}return e}(e,t))):null}const E=/url\((['"]?)([^'"]+?)\1\)/g,T=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,M=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;async function A(e,t,n,r,i){try{const o=n?function(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),i=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(i),t&&(r.href=t),i.href=e,i.href}(t,n):t,s=m(t);let a;if(i){a=v(await i(o),s)}else a=await _(o,s,r);return e.replace(function(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}(t),`$1${a}$3`)}catch(e){}return e}function C(e){return-1!==e.search(E)}async function O(e,t,n){if(!C(e))return e;const r=function(e,{preferredFontFormat:t}){return t?e.replace(M,(e=>{for(;;){const[n,,r]=T.exec(e)||[];if(!r)return"";if(r===t)return`src: ${n};`}})):e}(e,n),i=function(e){const t=[];return e.replace(E,((e,n,r)=>(t.push(r),e))),t.filter((e=>!g(e)))}(r);return i.reduce(((e,r)=>e.then((e=>A(e,r,t,n)))),Promise.resolve(r))}async function P(e,t,n){var r;const i=null===(r=t.style)||void 0===r?void 0:r.getPropertyValue(e);if(i){const r=await O(i,null,n);return t.style.setProperty(e,r,t.style.getPropertyPriority(e)),!0}return!1}async function R(e,t){c(e,Element)&&(await async function(e,t){await P("background",e,t)||await P("background-image",e,t),await P("mask",e,t)||await P("mask-image",e,t)}(e,t),await async function(e,t){const n=c(e,HTMLImageElement);if((!n||g(e.src))&&(!c(e,SVGImageElement)||g(e.href.baseVal)))return;const r=n?e.src:e.href.baseVal,i=await _(r,m(r),t);await new Promise(((t,r)=>{e.onload=t,e.onerror=r;const o=e;o.decode&&(o.decode=t),"lazy"===o.loading&&(o.loading="eager"),n?(e.srcset="",e.src=i):e.href.baseVal=i}))}(e,t),await async function(e,t){const n=i(e.childNodes).map((e=>R(e,t)));await Promise.all(n).then((()=>e))}(e,t))}const N={};async function I(e){let t=N[e];if(null!=t)return t;const n=await fetch(e);return t={url:e,cssText:await n.text()},N[e]=t,t}async function k(e,t){let n=e.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,i=(n.match(/url\([^)]+\)/g)||[]).map((async i=>{let o=i.replace(r,"$1");return o.startsWith("https://")||(o=new URL(o,e.url).href),y(o,t.fetchRequestInit,(({result:e})=>(n=n.replace(i,`url(${e})`),[i,e])))}));return Promise.all(i).then((()=>n))}function D(e){if(null==e)return[];const t=[];let n=e.replace(/(\/\*[\s\S]*?\*\/)/gi,"");const r=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const e=r.exec(n);if(null===e)break;t.push(e[0])}n=n.replace(r,"");const i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,o=new RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");for(;;){let e=i.exec(n);if(null===e){if(e=o.exec(n),null===e)break;i.lastIndex=o.lastIndex}else o.lastIndex=i.lastIndex;t.push(e[0])}return t}async function L(e,t){if(null==e.ownerDocument)throw new Error("Provided element is not within a Document");const n=i(e.ownerDocument.styleSheets),r=await async function(e,t){const n=[],r=[];return e.forEach((n=>{if("cssRules"in n)try{i(n.cssRules||[]).forEach(((e,i)=>{if(e.type===CSSRule.IMPORT_RULE){let o=i+1;const s=I(e.href).then((e=>k(e,t))).then((e=>D(e).forEach((e=>{try{n.insertRule(e,e.startsWith("@import")?o+=1:n.cssRules.length)}catch(t){console.error("Error inserting rule from remote css",{rule:e,error:t})}})))).catch((e=>{console.error("Error loading remote css",e.toString())}));r.push(s)}}))}catch(i){const o=e.find((e=>null==e.href))||document.styleSheets[0];null!=n.href&&r.push(I(n.href).then((e=>k(e,t))).then((e=>D(e).forEach((e=>{o.insertRule(e,n.cssRules.length)})))).catch((e=>{console.error("Error loading remote stylesheet",e)}))),console.error("Error inlining remote css file",i)}})),Promise.all(r).then((()=>(e.forEach((e=>{if("cssRules"in e)try{i(e.cssRules||[]).forEach((e=>{n.push(e)}))}catch(t){console.error(`Error while reading CSS rules from ${e.href}`,t)}})),n)))}(n,t);return function(e){return e.filter((e=>e.type===CSSRule.FONT_FACE_RULE)).filter((e=>C(e.style.getPropertyValue("src"))))}(r)}async function U(e,t){const n=null!=t.fontEmbedCSS?t.fontEmbedCSS:t.skipFonts?null:await async function(e,t){const n=await L(e,t);return(await Promise.all(n.map((e=>{const n=e.parentStyleSheet?e.parentStyleSheet.href:null;return O(e.cssText,n,t)})))).join("\n")}(e,t);if(n){const t=document.createElement("style"),r=document.createTextNode(n);t.appendChild(r),e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)}}async function F(e,t={}){const{width:n,height:r}=s(e,t),i=await S(e,t,!0);await U(i,t),await R(i,t),function(e,t){const{style:n}=e;t.backgroundColor&&(n.backgroundColor=t.backgroundColor),t.width&&(n.width=`${t.width}px`),t.height&&(n.height=`${t.height}px`);const r=t.style;null!=r&&Object.keys(r).forEach((e=>{n[e]=r[e]}))}(i,t);return await u(i,n,r)}},38023:function(e,t,n){var r=n(15123).stringify,i=n(75710);e.exports=function(e){return{parse:i(e),stringify:r}},e.exports.parse=i(),e.exports.stringify=r},75710:function(e,t,n){var r=null;const i=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,o=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;e.exports=function(e){"use strict";var t={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(null!=e){if(!0===e.strict&&(t.strict=!0),!0===e.storeAsString&&(t.storeAsString=!0),t.alwaysParseAsBig=!0===e.alwaysParseAsBig&&e.alwaysParseAsBig,t.useNativeBigInt=!0===e.useNativeBigInt&&e.useNativeBigInt,void 0!==e.constructorAction){if("error"!==e.constructorAction&&"ignore"!==e.constructorAction&&"preserve"!==e.constructorAction)throw new Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${e.constructorAction}`);t.constructorAction=e.constructorAction}if(void 0!==e.protoAction){if("error"!==e.protoAction&&"ignore"!==e.protoAction&&"preserve"!==e.protoAction)throw new Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${e.protoAction}`);t.protoAction=e.protoAction}}var s,a,u,c,l={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},h=function(e){throw{name:"SyntaxError",message:e,at:s,text:u}},d=function(e){return e&&e!==a&&h("Expected '"+e+"' instead of '"+a+"'"),a=u.charAt(s),s+=1,a},f=function(){var e,i="";for("-"===a&&(i="-",d("-"));a>="0"&&a<="9";)i+=a,d();if("."===a)for(i+=".";d()&&a>="0"&&a<="9";)i+=a;if("e"===a||"E"===a)for(i+=a,d(),"-"!==a&&"+"!==a||(i+=a,d());a>="0"&&a<="9";)i+=a,d();if(e=+i,isFinite(e))return null==r&&(r=n(21679)),i.length>15?t.storeAsString?i:t.useNativeBigInt?BigInt(i):new r(i):t.alwaysParseAsBig?t.useNativeBigInt?BigInt(e):new r(e):e;h("Bad number")},p=function(){var e,t,n,r="";if('"'===a)for(var i=s;d();){if('"'===a)return s-1>i&&(r+=u.substring(i,s-1)),d(),r;if("\\"===a){if(s-1>i&&(r+=u.substring(i,s-1)),d(),"u"===a){for(n=0,t=0;t<4&&(e=parseInt(d(),16),isFinite(e));t+=1)n=16*n+e;r+=String.fromCharCode(n)}else{if("string"!=typeof l[a])break;r+=l[a]}i=s}}h("Bad string")},m=function(){for(;a&&a<=" ";)d()};return c=function(){switch(m(),a){case"{":return function(){var e,n=Object.create(null);if("{"===a){if(d("{"),m(),"}"===a)return d("}"),n;for(;a;){if(e=p(),m(),d(":"),!0===t.strict&&Object.hasOwnProperty.call(n,e)&&h('Duplicate key "'+e+'"'),!0===i.test(e)?"error"===t.protoAction?h("Object contains forbidden prototype property"):"ignore"===t.protoAction?c():n[e]=c():!0===o.test(e)?"error"===t.constructorAction?h("Object contains forbidden constructor property"):"ignore"===t.constructorAction?c():n[e]=c():n[e]=c(),m(),"}"===a)return d("}"),n;d(","),m()}}h("Bad object")}();case"[":return function(){var e=[];if("["===a){if(d("["),m(),"]"===a)return d("]"),e;for(;a;){if(e.push(c()),m(),"]"===a)return d("]"),e;d(","),m()}}h("Bad array")}();case'"':return p();case"-":return f();default:return a>="0"&&a<="9"?f():function(){switch(a){case"t":return d("t"),d("r"),d("u"),d("e"),!0;case"f":return d("f"),d("a"),d("l"),d("s"),d("e"),!1;case"n":return d("n"),d("u"),d("l"),d("l"),null}h("Unexpected '"+a+"'")}()}},function(e,t){var n;return u=e+"",s=0,a=" ",n=c(),m(),a&&h("Syntax error"),"function"==typeof t?function e(n,r){var i,o=n[r];return o&&"object"==typeof o&&Object.keys(o).forEach((function(t){void 0!==(i=e(o,t))?o[t]=i:delete o[t]})),t.call(n,r,o)}({"":n},""):n}}},15123:function(e,t,n){var r=n(21679),i=e.exports;!function(){"use strict";var e,t,n,o=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function a(e){return o.lastIndex=0,o.test(e)?'"'+e.replace(o,(function(e){var t=s[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}function u(i,o){var s,c,l,h,d,f=e,p=o[i],m=null!=p&&(p instanceof r||r.isBigNumber(p));switch(p&&"object"==typeof p&&"function"==typeof p.toJSON&&(p=p.toJSON(i)),"function"==typeof n&&(p=n.call(o,i,p)),typeof p){case"string":return m?p:a(p);case"number":return isFinite(p)?String(p):"null";case"boolean":case"null":case"bigint":return String(p);case"object":if(!p)return"null";if(e+=t,d=[],"[object Array]"===Object.prototype.toString.apply(p)){for(h=p.length,s=0;s<h;s+=1)d[s]=u(s,p)||"null";return l=0===d.length?"[]":e?"[\n"+e+d.join(",\n"+e)+"\n"+f+"]":"["+d.join(",")+"]",e=f,l}if(n&&"object"==typeof n)for(h=n.length,s=0;s<h;s+=1)"string"==typeof n[s]&&(l=u(c=n[s],p))&&d.push(a(c)+(e?": ":":")+l);else Object.keys(p).forEach((function(t){var n=u(t,p);n&&d.push(a(t)+(e?": ":":")+n)}));return l=0===d.length?"{}":e?"{\n"+e+d.join(",\n"+e)+"\n"+f+"}":"{"+d.join(",")+"}",e=f,l}}"function"!=typeof i.stringify&&(i.stringify=function(r,i,o){var s;if(e="",t="","number"==typeof o)for(s=0;s<o;s+=1)t+=" ";else"string"==typeof o&&(t=o);if(n=i,i&&"function"!=typeof i&&("object"!=typeof i||"number"!=typeof i.length))throw new Error("JSON.stringify");return u("",{"":r})})}()},87269:function(e,t,n){var r=n(47758)(n(29165),"DataView");e.exports=r},88987:function(e,t,n){var r=n(71519),i=n(82999),o=n(76111),s=n(50506),a=n(80845);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,e.exports=u},175:function(e,t,n){var r=n(2173),i=n(33752),o=n(10548),s=n(63410),a=n(3564);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,e.exports=u},35922:function(e,t,n){var r=n(47758)(n(29165),"Map");e.exports=r},9440:function(e,t,n){var r=n(7140),i=n(56504),o=n(88833),s=n(80953),a=n(70724);function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=s,u.prototype.set=a,e.exports=u},6795:function(e,t,n){var r=n(47758)(n(29165),"Promise");e.exports=r},81956:function(e,t,n){var r=n(47758)(n(29165),"Set");e.exports=r},78188:function(e,t,n){var r=n(9440),i=n(96659),o=n(97230);function s(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}s.prototype.add=s.prototype.push=i,s.prototype.has=o,e.exports=s},5929:function(e,t,n){var r=n(175),i=n(40551),o=n(4090),s=n(47694),a=n(86220),u=n(68958);function c(e){var t=this.__data__=new r(e);this.size=t.size}c.prototype.clear=i,c.prototype.delete=o,c.prototype.get=s,c.prototype.has=a,c.prototype.set=u,e.exports=c},74396:function(e,t,n){var r=n(29165).Symbol;e.exports=r},92210:function(e,t,n){var r=n(29165).Uint8Array;e.exports=r},69477:function(e,t,n){var r=n(47758)(n(29165),"WeakMap");e.exports=r},93501:function(e){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},21662:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},48969:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}},45170:function(e,t,n){var r=n(13807);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},94936:function(e){e.exports=function(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}},79809:function(e,t,n){var r=n(39739),i=n(30353),o=n(24669),s=n(61563),a=n(91010),u=n(73806),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=o(e),l=!n&&i(e),h=!n&&!l&&s(e),d=!n&&!l&&!h&&u(e),f=n||l||h||d,p=f?r(e.length,String):[],m=p.length;for(var g in e)!t&&!c.call(e,g)||f&&("length"==g||h&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||a(g,m))||p.push(g);return p}},75697:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},28486:function(e){e.exports=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}},30695:function(e){e.exports=function(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}},84330:function(e){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},15989:function(e,t,n){var r=n(17498)("length");e.exports=r},72340:function(e,t,n){var r=n(30404),i=n(42448);e.exports=function(e,t,n){(void 0!==n&&!i(e[t],n)||void 0===n&&!(t in e))&&r(e,t,n)}},93719:function(e,t,n){var r=n(30404),i=n(42448),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var s=e[t];o.call(e,t)&&i(s,n)&&(void 0!==n||t in e)||r(e,t,n)}},62718:function(e,t,n){var r=n(42448);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},43472:function(e,t,n){var r=n(92434),i=n(50579);e.exports=function(e,t){return e&&r(t,i(t),e)}},7254:function(e,t,n){var r=n(92434),i=n(37390);e.exports=function(e,t){return e&&r(t,i(t),e)}},30404:function(e,t,n){var r=n(34082);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},67410:function(e,t,n){var r=n(5929),i=n(21662),o=n(93719),s=n(43472),a=n(7254),u=n(39767),c=n(47165),l=n(8782),h=n(2667),d=n(69698),f=n(21699),p=n(81887),m=n(12195),g=n(46740),v=n(36404),y=n(24669),b=n(61563),_=n(32924),x=n(36838),w=n(45380),S=n(50579),E=n(37390),T="[object Arguments]",M="[object Function]",A="[object Object]",C={};C[T]=C["[object Array]"]=C["[object ArrayBuffer]"]=C["[object DataView]"]=C["[object Boolean]"]=C["[object Date]"]=C["[object Float32Array]"]=C["[object Float64Array]"]=C["[object Int8Array]"]=C["[object Int16Array]"]=C["[object Int32Array]"]=C["[object Map]"]=C["[object Number]"]=C[A]=C["[object RegExp]"]=C["[object Set]"]=C["[object String]"]=C["[object Symbol]"]=C["[object Uint8Array]"]=C["[object Uint8ClampedArray]"]=C["[object Uint16Array]"]=C["[object Uint32Array]"]=!0,C["[object Error]"]=C[M]=C["[object WeakMap]"]=!1,e.exports=function e(t,n,O,P,R,N){var I,k=1&n,D=2&n,L=4&n;if(O&&(I=R?O(t,P,R,N):O(t)),void 0!==I)return I;if(!x(t))return t;var U=y(t);if(U){if(I=m(t),!k)return c(t,I)}else{var F=p(t),B=F==M||"[object GeneratorFunction]"==F;if(b(t))return u(t,k);if(F==A||F==T||B&&!R){if(I=D||B?{}:v(t),!k)return D?h(t,a(I,t)):l(t,s(I,t))}else{if(!C[F])return R?t:{};I=g(t,F,k)}}N||(N=new r);var z=N.get(t);if(z)return z;N.set(t,I),w(t)?t.forEach((function(r){I.add(e(r,n,O,r,t,N))})):_(t)&&t.forEach((function(r,i){I.set(i,e(r,n,O,i,t,N))}));var j=U?void 0:(L?D?f:d:D?E:S)(t);return i(j||t,(function(r,i){j&&(r=t[i=r]),o(I,i,e(r,n,O,i,t,N))})),I}},91348:function(e,t,n){var r=n(36838),i=Object.create,o=function(){function e(){}return function(t){if(!r(t))return{};if(i)return i(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=o},30438:function(e,t,n){var r=n(61343),i=n(4118)(r);e.exports=i},24210:function(e,t,n){var r=n(16764);e.exports=function(e,t,n){for(var i=-1,o=e.length;++i<o;){var s=e[i],a=t(s);if(null!=a&&(void 0===u?a==a&&!r(a):n(a,u)))var u=a,c=s}return c}},88286:function(e,t,n){var r=n(30438);e.exports=function(e,t){var n=[];return r(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}},92504:function(e){e.exports=function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}},98768:function(e,t,n){var r=n(28486),i=n(89465);e.exports=function e(t,n,o,s,a){var u=-1,c=t.length;for(o||(o=i),a||(a=[]);++u<c;){var l=t[u];n>0&&o(l)?n>1?e(l,n-1,o,s,a):r(a,l):s||(a[a.length]=l)}return a}},91030:function(e,t,n){var r=n(29)();e.exports=r},61343:function(e,t,n){var r=n(91030),i=n(50579);e.exports=function(e,t){return e&&r(e,t,i)}},97499:function(e,t,n){var r=n(60399),i=n(77817);e.exports=function(e,t){for(var n=0,o=(t=r(t,e)).length;null!=e&&n<o;)e=e[i(t[n++])];return n&&n==o?e:void 0}},38084:function(e,t,n){var r=n(28486),i=n(24669);e.exports=function(e,t,n){var o=t(e);return i(e)?o:r(o,n(e))}},80732:function(e,t,n){var r=n(74396),i=n(31239),o=n(57058),s=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?i(e):o(e)}},39491:function(e){e.exports=function(e,t){return e>t}},45435:function(e){var t=Object.prototype.hasOwnProperty;e.exports=function(e,n){return null!=e&&t.call(e,n)}},71664:function(e){e.exports=function(e,t){return null!=e&&t in Object(e)}},13807:function(e,t,n){var r=n(92504),i=n(99940),o=n(3729);e.exports=function(e,t,n){return t==t?o(e,t,n):r(e,i,n)}},84742:function(e,t,n){var r=n(80732),i=n(55073);e.exports=function(e){return i(e)&&"[object Arguments]"==r(e)}},6620:function(e,t,n){var r=n(83977),i=n(55073);e.exports=function e(t,n,o,s,a){return t===n||(null==t||null==n||!i(t)&&!i(n)?t!=t&&n!=n:r(t,n,o,s,e,a))}},83977:function(e,t,n){var r=n(5929),i=n(22684),o=n(7456),s=n(18120),a=n(81887),u=n(24669),c=n(61563),l=n(73806),h="[object Arguments]",d="[object Array]",f="[object Object]",p=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,m,g,v){var y=u(e),b=u(t),_=y?d:a(e),x=b?d:a(t),w=(_=_==h?f:_)==f,S=(x=x==h?f:x)==f,E=_==x;if(E&&c(e)){if(!c(t))return!1;y=!0,w=!1}if(E&&!w)return v||(v=new r),y||l(e)?i(e,t,n,m,g,v):o(e,t,_,n,m,g,v);if(!(1&n)){var T=w&&p.call(e,"__wrapped__"),M=S&&p.call(t,"__wrapped__");if(T||M){var A=T?e.value():e,C=M?t.value():t;return v||(v=new r),g(A,C,n,m,v)}}return!!E&&(v||(v=new r),s(e,t,n,m,g,v))}},64033:function(e,t,n){var r=n(81887),i=n(55073);e.exports=function(e){return i(e)&&"[object Map]"==r(e)}},27122:function(e,t,n){var r=n(5929),i=n(6620);e.exports=function(e,t,n,o){var s=n.length,a=s,u=!o;if(null==e)return!a;for(e=Object(e);s--;){var c=n[s];if(u&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++s<a;){var l=(c=n[s])[0],h=e[l],d=c[1];if(u&&c[2]){if(void 0===h&&!(l in e))return!1}else{var f=new r;if(o)var p=o(h,d,l,e,t,f);if(!(void 0===p?i(d,h,3,o,f):p))return!1}}return!0}},99940:function(e){e.exports=function(e){return e!=e}},58939:function(e,t,n){var r=n(92042),i=n(90654),o=n(36838),s=n(51059),a=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,l=u.toString,h=c.hasOwnProperty,d=RegExp("^"+l.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(r(e)?d:a).test(s(e))}},28264:function(e,t,n){var r=n(81887),i=n(55073);e.exports=function(e){return i(e)&&"[object Set]"==r(e)}},22882:function(e,t,n){var r=n(80732),i=n(17216),o=n(55073),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!s[r(e)]}},5673:function(e,t,n){var r=n(3772),i=n(30493),o=n(48148),s=n(24669),a=n(51798);e.exports=function(e){return"function"==typeof e?e:null==e?o:"object"==typeof e?s(e)?i(e[0],e[1]):r(e):a(e)}},87473:function(e,t,n){var r=n(92963),i=n(14457),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},52506:function(e,t,n){var r=n(36838),i=n(92963),o=n(10814),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=i(e),n=[];for(var a in e)("constructor"!=a||!t&&s.call(e,a))&&n.push(a);return n}},42800:function(e){e.exports=function(e,t){return e<t}},66494:function(e,t,n){var r=n(30438),i=n(47428);e.exports=function(e,t){var n=-1,o=i(e)?Array(e.length):[];return r(e,(function(e,r,i){o[++n]=t(e,r,i)})),o}},3772:function(e,t,n){var r=n(27122),i=n(67487),o=n(78857);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},30493:function(e,t,n){var r=n(6620),i=n(65439),o=n(28281),s=n(2610),a=n(92769),u=n(78857),c=n(77817);e.exports=function(e,t){return s(e)&&a(t)?u(c(e),t):function(n){var s=i(n,e);return void 0===s&&s===t?o(n,e):r(t,s,3)}}},97254:function(e,t,n){var r=n(5929),i=n(72340),o=n(91030),s=n(10715),a=n(36838),u=n(37390),c=n(72014);e.exports=function e(t,n,l,h,d){t!==n&&o(n,(function(o,u){if(d||(d=new r),a(o))s(t,n,u,l,e,h,d);else{var f=h?h(c(t,u),o,u+"",t,n,d):void 0;void 0===f&&(f=o),i(t,u,f)}}),u)}},10715:function(e,t,n){var r=n(72340),i=n(39767),o=n(27136),s=n(47165),a=n(36404),u=n(30353),c=n(24669),l=n(57348),h=n(61563),d=n(92042),f=n(36838),p=n(69143),m=n(73806),g=n(72014),v=n(85111);e.exports=function(e,t,n,y,b,_,x){var w=g(e,n),S=g(t,n),E=x.get(S);if(E)r(e,n,E);else{var T=_?_(w,S,n+"",e,t,x):void 0,M=void 0===T;if(M){var A=c(S),C=!A&&h(S),O=!A&&!C&&m(S);T=S,A||C||O?c(w)?T=w:l(w)?T=s(w):C?(M=!1,T=i(S,!0)):O?(M=!1,T=o(S,!0)):T=[]:p(S)||u(S)?(T=w,u(w)?T=v(w):f(w)&&!d(w)||(T=a(S))):M=!1}M&&(x.set(S,T),b(T,S,y,_,x),x.delete(S)),r(e,n,T)}}},84994:function(e,t,n){var r=n(75697),i=n(97499),o=n(5673),s=n(66494),a=n(16584),u=n(58792),c=n(35395),l=n(48148),h=n(24669);e.exports=function(e,t,n){t=t.length?r(t,(function(e){return h(e)?function(t){return i(t,1===e.length?e[0]:e)}:e})):[l];var d=-1;t=r(t,u(o));var f=s(e,(function(e,n,i){return{criteria:r(t,(function(t){return t(e)})),index:++d,value:e}}));return a(f,(function(e,t){return c(e,t,n)}))}},54822:function(e,t,n){var r=n(32648),i=n(28281);e.exports=function(e,t){return r(e,t,(function(t,n){return i(e,n)}))}},32648:function(e,t,n){var r=n(97499),i=n(85713),o=n(60399);e.exports=function(e,t,n){for(var s=-1,a=t.length,u={};++s<a;){var c=t[s],l=r(e,c);n(l,c)&&i(u,o(c,e),l)}return u}},17498:function(e){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},71e3:function(e,t,n){var r=n(97499);e.exports=function(e){return function(t){return r(t,e)}}},5108:function(e){var t=Math.ceil,n=Math.max;e.exports=function(e,r,i,o){for(var s=-1,a=n(t((r-e)/(i||1)),0),u=Array(a);a--;)u[o?a:++s]=e,e+=i;return u}},75857:function(e){e.exports=function(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}},5125:function(e,t,n){var r=n(48148),i=n(20323),o=n(71564);e.exports=function(e,t){return o(i(e,t,r),e+"")}},85713:function(e,t,n){var r=n(93719),i=n(60399),o=n(91010),s=n(36838),a=n(77817);e.exports=function(e,t,n,u){if(!s(e))return e;for(var c=-1,l=(t=i(t,e)).length,h=l-1,d=e;null!=d&&++c<l;){var f=a(t[c]),p=n;if("__proto__"===f||"constructor"===f||"prototype"===f)return e;if(c!=h){var m=d[f];void 0===(p=u?u(m,f,d):void 0)&&(p=s(m)?m:o(t[c+1])?[]:{})}r(d,f,p),d=d[f]}return e}},56447:function(e,t,n){var r=n(64806),i=n(34082),o=n(48148),s=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:o;e.exports=s},16584:function(e){e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},39739:function(e){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},73150:function(e,t,n){var r=n(74396),i=n(75697),o=n(24669),s=n(16764),a=r?r.prototype:void 0,u=a?a.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return i(t,e)+"";if(s(t))return u?u.call(t):"";var n=t+"";return"0"==n&&1/t==-Infinity?"-0":n}},33124:function(e,t,n){var r=n(82996),i=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(i,""):e}},58792:function(e){e.exports=function(e){return function(t){return e(t)}}},95453:function(e,t,n){var r=n(78188),i=n(45170),o=n(94936),s=n(29880),a=n(17319),u=n(79967);e.exports=function(e,t,n){var c=-1,l=i,h=e.length,d=!0,f=[],p=f;if(n)d=!1,l=o;else if(h>=200){var m=t?null:a(e);if(m)return u(m);d=!1,l=s,p=new r}else p=t?[]:f;e:for(;++c<h;){var g=e[c],v=t?t(g):g;if(g=n||0!==g?g:0,d&&v==v){for(var y=p.length;y--;)if(p[y]===v)continue e;t&&p.push(v),f.push(g)}else l(p,v,n)||(p!==f&&p.push(v),f.push(g))}return f}},44290:function(e,t,n){var r=n(75697);e.exports=function(e,t){return r(t,(function(t){return e[t]}))}},59654:function(e){e.exports=function(e,t,n){for(var r=-1,i=e.length,o=t.length,s={};++r<i;){var a=r<o?t[r]:void 0;n(s,e[r],a)}return s}},29880:function(e){e.exports=function(e,t){return e.has(t)}},97008:function(e,t,n){var r=n(48148);e.exports=function(e){return"function"==typeof e?e:r}},60399:function(e,t,n){var r=n(24669),i=n(2610),o=n(77057),s=n(8389);e.exports=function(e,t){return r(e)?e:i(e,t)?[e]:o(s(e))}},78925:function(e,t,n){var r=n(92210);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},39767:function(e,t,n){e=n.nmd(e);var r=n(29165),i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,s=o&&o.exports===i?r.Buffer:void 0,a=s?s.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=a?a(n):new e.constructor(n);return e.copy(r),r}},56157:function(e,t,n){var r=n(78925);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},80101:function(e){var t=/\w*$/;e.exports=function(e){var n=new e.constructor(e.source,t.exec(e));return n.lastIndex=e.lastIndex,n}},54920:function(e,t,n){var r=n(74396),i=r?r.prototype:void 0,o=i?i.valueOf:void 0;e.exports=function(e){return o?Object(o.call(e)):{}}},27136:function(e,t,n){var r=n(78925);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},24687:function(e,t,n){var r=n(16764);e.exports=function(e,t){if(e!==t){var n=void 0!==e,i=null===e,o=e==e,s=r(e),a=void 0!==t,u=null===t,c=t==t,l=r(t);if(!u&&!l&&!s&&e>t||s&&a&&c&&!u&&!l||i&&a&&c||!n&&c||!o)return 1;if(!i&&!s&&!l&&e<t||l&&n&&o&&!i&&!s||u&&n&&o||!a&&o||!c)return-1}return 0}},35395:function(e,t,n){var r=n(24687);e.exports=function(e,t,n){for(var i=-1,o=e.criteria,s=t.criteria,a=o.length,u=n.length;++i<a;){var c=r(o[i],s[i]);if(c)return i>=u?c:c*("desc"==n[i]?-1:1)}return e.index-t.index}},47165:function(e){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},92434:function(e,t,n){var r=n(93719),i=n(30404);e.exports=function(e,t,n,o){var s=!n;n||(n={});for(var a=-1,u=t.length;++a<u;){var c=t[a],l=o?o(n[c],e[c],c,n,e):void 0;void 0===l&&(l=e[c]),s?i(n,c,l):r(n,c,l)}return n}},8782:function(e,t,n){var r=n(92434),i=n(97482);e.exports=function(e,t){return r(e,i(e),t)}},2667:function(e,t,n){var r=n(92434),i=n(41288);e.exports=function(e,t){return r(e,i(e),t)}},36633:function(e,t,n){var r=n(29165)["__core-js_shared__"];e.exports=r},77991:function(e,t,n){var r=n(5125),i=n(97616);e.exports=function(e){return r((function(t,n){var r=-1,o=n.length,s=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(s=e.length>3&&"function"==typeof s?(o--,s):void 0,a&&i(n[0],n[1],a)&&(s=o<3?void 0:s,o=1),t=Object(t);++r<o;){var u=n[r];u&&e(t,u,r,s)}return t}))}},4118:function(e,t,n){var r=n(47428);e.exports=function(e,t){return function(n,i){if(null==n)return n;if(!r(n))return e(n,i);for(var o=n.length,s=t?o:-1,a=Object(n);(t?s--:++s<o)&&!1!==i(a[s],s,a););return n}}},29:function(e){e.exports=function(e){return function(t,n,r){for(var i=-1,o=Object(t),s=r(t),a=s.length;a--;){var u=s[e?a:++i];if(!1===n(o[u],u,o))break}return t}}},34715:function(e,t,n){var r=n(5673),i=n(47428),o=n(50579);e.exports=function(e){return function(t,n,s){var a=Object(t);if(!i(t)){var u=r(n,3);t=o(t),n=function(e){return u(a[e],e,a)}}var c=e(t,n,s);return c>-1?a[u?t[c]:c]:void 0}}},1293:function(e,t,n){var r=n(5108),i=n(97616),o=n(70986);e.exports=function(e){return function(t,n,s){return s&&"number"!=typeof s&&i(t,n,s)&&(n=s=void 0),t=o(t),void 0===n?(n=t,t=0):n=o(n),s=void 0===s?t<n?1:-1:o(s),r(t,n,s,e)}}},17319:function(e,t,n){var r=n(81956),i=n(43226),o=n(79967),s=r&&1/o(new r([,-0]))[1]==1/0?function(e){return new r(e)}:i;e.exports=s},34082:function(e,t,n){var r=n(47758),i=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},22684:function(e,t,n){var r=n(78188),i=n(84330),o=n(29880);e.exports=function(e,t,n,s,a,u){var c=1&n,l=e.length,h=t.length;if(l!=h&&!(c&&h>l))return!1;var d=u.get(e),f=u.get(t);if(d&&f)return d==t&&f==e;var p=-1,m=!0,g=2&n?new r:void 0;for(u.set(e,t),u.set(t,e);++p<l;){var v=e[p],y=t[p];if(s)var b=c?s(y,v,p,t,e,u):s(v,y,p,e,t,u);if(void 0!==b){if(b)continue;m=!1;break}if(g){if(!i(t,(function(e,t){if(!o(g,t)&&(v===e||a(v,e,n,s,u)))return g.push(t)}))){m=!1;break}}else if(v!==y&&!a(v,y,n,s,u)){m=!1;break}}return u.delete(e),u.delete(t),m}},7456:function(e,t,n){var r=n(74396),i=n(92210),o=n(42448),s=n(22684),a=n(7523),u=n(79967),c=r?r.prototype:void 0,l=c?c.valueOf:void 0;e.exports=function(e,t,n,r,c,h,d){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!h(new i(e),new i(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var f=a;case"[object Set]":var p=1&r;if(f||(f=u),e.size!=t.size&&!p)return!1;var m=d.get(e);if(m)return m==t;r|=2,d.set(e,t);var g=s(f(e),f(t),r,c,h,d);return d.delete(e),g;case"[object Symbol]":if(l)return l.call(e)==l.call(t)}return!1}},18120:function(e,t,n){var r=n(69698),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,o,s,a){var u=1&n,c=r(e),l=c.length;if(l!=r(t).length&&!u)return!1;for(var h=l;h--;){var d=c[h];if(!(u?d in t:i.call(t,d)))return!1}var f=a.get(e),p=a.get(t);if(f&&p)return f==t&&p==e;var m=!0;a.set(e,t),a.set(t,e);for(var g=u;++h<l;){var v=e[d=c[h]],y=t[d];if(o)var b=u?o(y,v,d,t,e,a):o(v,y,d,e,t,a);if(!(void 0===b?v===y||s(v,y,n,o,a):b)){m=!1;break}g||(g="constructor"==d)}if(m&&!g){var _=e.constructor,x=t.constructor;_==x||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof x&&x instanceof x||(m=!1)}return a.delete(e),a.delete(t),m}},54874:function(e,t,n){var r=n(22612),i=n(20323),o=n(71564);e.exports=function(e){return o(i(e,void 0,r),e+"")}},96476:function(e,t,n){var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},69698:function(e,t,n){var r=n(38084),i=n(97482),o=n(50579);e.exports=function(e){return r(e,o,i)}},21699:function(e,t,n){var r=n(38084),i=n(41288),o=n(37390);e.exports=function(e){return r(e,o,i)}},67707:function(e,t,n){var r=n(3880);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},67487:function(e,t,n){var r=n(92769),i=n(50579);e.exports=function(e){for(var t=i(e),n=t.length;n--;){var o=t[n],s=e[o];t[n]=[o,s,r(s)]}return t}},47758:function(e,t,n){var r=n(58939),i=n(9149);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},11389:function(e,t,n){var r=n(75542)(Object.getPrototypeOf,Object);e.exports=r},31239:function(e,t,n){var r=n(74396),i=Object.prototype,o=i.hasOwnProperty,s=i.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var i=s.call(e);return r&&(t?e[a]=n:delete e[a]),i}},97482:function(e,t,n){var r=n(48969),i=n(68036),o=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(e){return null==e?[]:(e=Object(e),r(s(e),(function(t){return o.call(e,t)})))}:i;e.exports=a},41288:function(e,t,n){var r=n(28486),i=n(11389),o=n(97482),s=n(68036),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,o(e)),e=i(e);return t}:s;e.exports=a},81887:function(e,t,n){var r=n(87269),i=n(35922),o=n(6795),s=n(81956),a=n(69477),u=n(80732),c=n(51059),l="[object Map]",h="[object Promise]",d="[object Set]",f="[object WeakMap]",p="[object DataView]",m=c(r),g=c(i),v=c(o),y=c(s),b=c(a),_=u;(r&&_(new r(new ArrayBuffer(1)))!=p||i&&_(new i)!=l||o&&_(o.resolve())!=h||s&&_(new s)!=d||a&&_(new a)!=f)&&(_=function(e){var t=u(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case m:return p;case g:return l;case v:return h;case y:return d;case b:return f}return t}),e.exports=_},9149:function(e){e.exports=function(e,t){return null==e?void 0:e[t]}},3638:function(e,t,n){var r=n(60399),i=n(30353),o=n(24669),s=n(91010),a=n(17216),u=n(77817);e.exports=function(e,t,n){for(var c=-1,l=(t=r(t,e)).length,h=!1;++c<l;){var d=u(t[c]);if(!(h=null!=e&&n(e,d)))break;e=e[d]}return h||++c!=l?h:!!(l=null==e?0:e.length)&&a(l)&&s(d,l)&&(o(e)||i(e))}},30080:function(e){var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return t.test(e)}},71519:function(e,t,n){var r=n(37722);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},82999:function(e){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},76111:function(e,t,n){var r=n(37722),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},50506:function(e,t,n){var r=n(37722),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},80845:function(e,t,n){var r=n(37722);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},12195:function(e){var t=Object.prototype.hasOwnProperty;e.exports=function(e){var n=e.length,r=new e.constructor(n);return n&&"string"==typeof e[0]&&t.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},46740:function(e,t,n){var r=n(78925),i=n(56157),o=n(80101),s=n(54920),a=n(27136);e.exports=function(e,t,n){var u=e.constructor;switch(t){case"[object ArrayBuffer]":return r(e);case"[object Boolean]":case"[object Date]":return new u(+e);case"[object DataView]":return i(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(e,n);case"[object Map]":case"[object Set]":return new u;case"[object Number]":case"[object String]":return new u(e);case"[object RegExp]":return o(e);case"[object Symbol]":return s(e)}}},36404:function(e,t,n){var r=n(91348),i=n(11389),o=n(92963);e.exports=function(e){return"function"!=typeof e.constructor||o(e)?{}:r(i(e))}},89465:function(e,t,n){var r=n(74396),i=n(30353),o=n(24669),s=r?r.isConcatSpreadable:void 0;e.exports=function(e){return o(e)||i(e)||!!(s&&e&&e[s])}},91010:function(e){var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var r=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&t.test(e))&&e>-1&&e%1==0&&e<n}},97616:function(e,t,n){var r=n(42448),i=n(47428),o=n(91010),s=n(36838);e.exports=function(e,t,n){if(!s(n))return!1;var a=typeof t;return!!("number"==a?i(n)&&o(t,n.length):"string"==a&&t in n)&&r(n[t],e)}},2610:function(e,t,n){var r=n(24669),i=n(16764),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!i(e))||(s.test(e)||!o.test(e)||null!=t&&e in Object(t))}},3880:function(e){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},90654:function(e,t,n){var r,i=n(36633),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!o&&o in e}},92963:function(e){var t=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}},92769:function(e,t,n){var r=n(36838);e.exports=function(e){return e==e&&!r(e)}},2173:function(e){e.exports=function(){this.__data__=[],this.size=0}},33752:function(e,t,n){var r=n(62718),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():i.call(t,n,1),--this.size,!0)}},10548:function(e,t,n){var r=n(62718);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},63410:function(e,t,n){var r=n(62718);e.exports=function(e){return r(this.__data__,e)>-1}},3564:function(e,t,n){var r=n(62718);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},7140:function(e,t,n){var r=n(88987),i=n(175),o=n(35922);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},56504:function(e,t,n){var r=n(67707);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},88833:function(e,t,n){var r=n(67707);e.exports=function(e){return r(this,e).get(e)}},80953:function(e,t,n){var r=n(67707);e.exports=function(e){return r(this,e).has(e)}},70724:function(e,t,n){var r=n(67707);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},7523:function(e){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},78857:function(e){e.exports=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}},45171:function(e,t,n){var r=n(34736);e.exports=function(e){var t=r(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}},37722:function(e,t,n){var r=n(47758)(Object,"create");e.exports=r},14457:function(e,t,n){var r=n(75542)(Object.keys,Object);e.exports=r},10814:function(e){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},8478:function(e,t,n){e=n.nmd(e);var r=n(96476),i=t&&!t.nodeType&&t,o=i&&e&&!e.nodeType&&e,s=o&&o.exports===i&&r.process,a=function(){try{var e=o&&o.require&&o.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=a},57058:function(e){var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},75542:function(e){e.exports=function(e,t){return function(n){return e(t(n))}}},20323:function(e,t,n){var r=n(93501),i=Math.max;e.exports=function(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var o=arguments,s=-1,a=i(o.length-t,0),u=Array(a);++s<a;)u[s]=o[t+s];s=-1;for(var c=Array(t+1);++s<t;)c[s]=o[s];return c[t]=n(u),r(e,this,c)}}},29165:function(e,t,n){var r=n(96476),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},72014:function(e){e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},96659:function(e){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},97230:function(e){e.exports=function(e){return this.__data__.has(e)}},79967:function(e){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},71564:function(e,t,n){var r=n(56447),i=n(15509)(r);e.exports=i},15509:function(e){var t=Date.now;e.exports=function(e){var n=0,r=0;return function(){var i=t(),o=16-(i-r);if(r=i,o>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}},40551:function(e,t,n){var r=n(175);e.exports=function(){this.__data__=new r,this.size=0}},4090:function(e){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},47694:function(e){e.exports=function(e){return this.__data__.get(e)}},86220:function(e){e.exports=function(e){return this.__data__.has(e)}},68958:function(e,t,n){var r=n(175),i=n(35922),o=n(9440);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var s=n.__data__;if(!i||s.length<199)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new o(s)}return n.set(e,t),this.size=n.size,this}},3729:function(e){e.exports=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}},68905:function(e,t,n){var r=n(15989),i=n(30080),o=n(43352);e.exports=function(e){return i(e)?o(e):r(e)}},77057:function(e,t,n){var r=n(45171),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,s=r((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,(function(e,n,r,i){t.push(r?i.replace(o,"$1"):n||e)})),t}));e.exports=s},77817:function(e,t,n){var r=n(16764);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}},51059:function(e){var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},82996:function(e){var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},43352:function(e){var t="\\ud800-\\udfff",n="["+t+"]",r="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",o="[^"+t+"]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",u="(?:"+r+"|"+i+")"+"?",c="[\\ufe0e\\ufe0f]?",l=c+u+("(?:\\u200d(?:"+[o,s,a].join("|")+")"+c+u+")*"),h="(?:"+[o+r+"?",r,s,a,n].join("|")+")",d=RegExp(i+"(?="+i+")|"+h+l,"g");e.exports=function(e){for(var t=d.lastIndex=0;d.test(e);)++t;return t}},55824:function(e,t,n){var r=n(67410);e.exports=function(e){return r(e,4)}},32222:function(e,t,n){var r=n(67410);e.exports=function(e){return r(e,5)}},64806:function(e){e.exports=function(e){return function(){return e}}},91099:function(e,t,n){var r=n(5125),i=n(42448),o=n(97616),s=n(37390),a=Object.prototype,u=a.hasOwnProperty,c=r((function(e,t){e=Object(e);var n=-1,r=t.length,c=r>2?t[2]:void 0;for(c&&o(t[0],t[1],c)&&(r=1);++n<r;)for(var l=t[n],h=s(l),d=-1,f=h.length;++d<f;){var p=h[d],m=e[p];(void 0===m||i(m,a[p])&&!u.call(e,p))&&(e[p]=l[p])}return e}));e.exports=c},15828:function(e,t,n){e.exports=n(17489)},42448:function(e){e.exports=function(e,t){return e===t||e!=e&&t!=t}},3149:function(e,t,n){var r=n(48969),i=n(88286),o=n(5673),s=n(24669);e.exports=function(e,t){return(s(e)?r:i)(e,o(t,3))}},33170:function(e,t,n){var r=n(34715)(n(33886));e.exports=r},33886:function(e,t,n){var r=n(92504),i=n(5673),o=n(20426),s=Math.max;e.exports=function(e,t,n){var a=null==e?0:e.length;if(!a)return-1;var u=null==n?0:o(n);return u<0&&(u=s(a+u,0)),r(e,i(t,3),u)}},22612:function(e,t,n){var r=n(98768);e.exports=function(e){return(null==e?0:e.length)?r(e,1):[]}},17489:function(e,t,n){var r=n(21662),i=n(30438),o=n(97008),s=n(24669);e.exports=function(e,t){return(s(e)?r:i)(e,o(t))}},37229:function(e,t,n){var r=n(91030),i=n(97008),o=n(37390);e.exports=function(e,t){return null==e?e:r(e,i(t),o)}},65439:function(e,t,n){var r=n(97499);e.exports=function(e,t,n){var i=null==e?void 0:r(e,t);return void 0===i?n:i}},56611:function(e,t,n){var r=n(45435),i=n(3638);e.exports=function(e,t){return null!=e&&i(e,t,r)}},28281:function(e,t,n){var r=n(71664),i=n(3638);e.exports=function(e,t){return null!=e&&i(e,t,r)}},48148:function(e){e.exports=function(e){return e}},30353:function(e,t,n){var r=n(84742),i=n(55073),o=Object.prototype,s=o.hasOwnProperty,a=o.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(e){return i(e)&&s.call(e,"callee")&&!a.call(e,"callee")};e.exports=u},24669:function(e){var t=Array.isArray;e.exports=t},47428:function(e,t,n){var r=n(92042),i=n(17216);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},57348:function(e,t,n){var r=n(47428),i=n(55073);e.exports=function(e){return i(e)&&r(e)}},61563:function(e,t,n){e=n.nmd(e);var r=n(29165),i=n(84193),o=t&&!t.nodeType&&t,s=o&&e&&!e.nodeType&&e,a=s&&s.exports===o?r.Buffer:void 0,u=(a?a.isBuffer:void 0)||i;e.exports=u},82691:function(e,t,n){var r=n(87473),i=n(81887),o=n(30353),s=n(24669),a=n(47428),u=n(61563),c=n(92963),l=n(73806),h=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(a(e)&&(s(e)||"string"==typeof e||"function"==typeof e.splice||u(e)||l(e)||o(e)))return!e.length;var t=i(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!r(e).length;for(var n in e)if(h.call(e,n))return!1;return!0}},92042:function(e,t,n){var r=n(80732),i=n(36838);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},17216:function(e){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},32924:function(e,t,n){var r=n(64033),i=n(58792),o=n(8478),s=o&&o.isMap,a=s?i(s):r;e.exports=a},36838:function(e){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},55073:function(e){e.exports=function(e){return null!=e&&"object"==typeof e}},69143:function(e,t,n){var r=n(80732),i=n(11389),o=n(55073),s=Function.prototype,a=Object.prototype,u=s.toString,c=a.hasOwnProperty,l=u.call(Object);e.exports=function(e){if(!o(e)||"[object Object]"!=r(e))return!1;var t=i(e);if(null===t)return!0;var n=c.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&u.call(n)==l}},45380:function(e,t,n){var r=n(28264),i=n(58792),o=n(8478),s=o&&o.isSet,a=s?i(s):r;e.exports=a},56549:function(e,t,n){var r=n(80732),i=n(24669),o=n(55073);e.exports=function(e){return"string"==typeof e||!i(e)&&o(e)&&"[object String]"==r(e)}},16764:function(e,t,n){var r=n(80732),i=n(55073);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e)}},73806:function(e,t,n){var r=n(22882),i=n(58792),o=n(8478),s=o&&o.isTypedArray,a=s?i(s):r;e.exports=a},89300:function(e){e.exports=function(e){return void 0===e}},50579:function(e,t,n){var r=n(79809),i=n(87473),o=n(47428);e.exports=function(e){return o(e)?r(e):i(e)}},37390:function(e,t,n){var r=n(79809),i=n(52506),o=n(47428);e.exports=function(e){return o(e)?r(e,!0):i(e)}},25674:function(e){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},65512:function(e,t,n){var r=n(75697),i=n(5673),o=n(66494),s=n(24669);e.exports=function(e,t){return(s(e)?r:o)(e,i(t,3))}},65632:function(e,t,n){var r=n(30404),i=n(61343),o=n(5673);e.exports=function(e,t){var n={};return t=o(t,3),i(e,(function(e,i,o){r(n,i,t(e,i,o))})),n}},80212:function(e,t,n){var r=n(24210),i=n(39491),o=n(48148);e.exports=function(e){return e&&e.length?r(e,o,i):void 0}},34736:function(e,t,n){var r=n(9440);function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(i.Cache||r),n}i.Cache=r,e.exports=i},67929:function(e,t,n){var r=n(97254),i=n(77991)((function(e,t,n){r(e,t,n)}));e.exports=i},71516:function(e,t,n){var r=n(24210),i=n(42800),o=n(48148);e.exports=function(e){return e&&e.length?r(e,o,i):void 0}},88371:function(e,t,n){var r=n(24210),i=n(5673),o=n(42800);e.exports=function(e,t){return e&&e.length?r(e,i(t,2),o):void 0}},43226:function(e){e.exports=function(){}},76668:function(e,t,n){var r=n(29165);e.exports=function(){return r.Date.now()}},19334:function(e,t,n){var r=n(54822),i=n(54874)((function(e,t){return null==e?{}:r(e,t)}));e.exports=i},51798:function(e,t,n){var r=n(17498),i=n(71e3),o=n(2610),s=n(77817);e.exports=function(e){return o(e)?r(s(e)):i(e)}},61178:function(e,t,n){var r=n(1293)();e.exports=r},6355:function(e,t,n){var r=n(30695),i=n(30438),o=n(5673),s=n(75857),a=n(24669);e.exports=function(e,t,n){var u=a(e)?r:s,c=arguments.length<3;return u(e,o(t,4),n,c,i)}},81430:function(e,t,n){var r=n(87473),i=n(81887),o=n(47428),s=n(56549),a=n(68905);e.exports=function(e){if(null==e)return 0;if(o(e))return s(e)?a(e):e.length;var t=i(e);return"[object Map]"==t||"[object Set]"==t?e.size:r(e).length}},84715:function(e,t,n){var r=n(98768),i=n(84994),o=n(5125),s=n(97616),a=o((function(e,t){if(null==e)return[];var n=t.length;return n>1&&s(e,t[0],t[1])?t=[]:n>2&&s(t[0],t[1],t[2])&&(t=[t[0]]),i(e,r(t,1),[])}));e.exports=a},68036:function(e){e.exports=function(){return[]}},84193:function(e){e.exports=function(){return!1}},70986:function(e,t,n){var r=n(12448),i=1/0;e.exports=function(e){return e?(e=r(e))===i||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},20426:function(e,t,n){var r=n(70986);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},12448:function(e,t,n){var r=n(33124),i=n(36838),o=n(16764),s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=a.test(e);return n||u.test(e)?c(e.slice(2),n?2:8):s.test(e)?NaN:+e}},85111:function(e,t,n){var r=n(92434),i=n(37390);e.exports=function(e){return r(e,i(e))}},8389:function(e,t,n){var r=n(73150);e.exports=function(e){return null==e?"":r(e)}},68742:function(e,t,n){var r=n(21662),i=n(91348),o=n(61343),s=n(5673),a=n(11389),u=n(24669),c=n(61563),l=n(92042),h=n(36838),d=n(73806);e.exports=function(e,t,n){var f=u(e),p=f||c(e)||d(e);if(t=s(t,4),null==n){var m=e&&e.constructor;n=p?f?new m:[]:h(e)&&l(m)?i(a(e)):{}}return(p?r:o)(e,(function(e,r,i){return t(n,e,r,i)})),n}},29974:function(e,t,n){var r=n(98768),i=n(5125),o=n(95453),s=n(57348),a=i((function(e){return o(r(e,1,s,!0))}));e.exports=a},53274:function(e,t,n){var r=n(8389),i=0;e.exports=function(e){var t=++i;return r(e)+t}},61017:function(e,t,n){var r=n(44290),i=n(50579);e.exports=function(e){return null==e?[]:r(e,i(e))}},64058:function(e,t,n){var r=n(93719),i=n(59654);e.exports=function(e,t){return i(e||[],t||[],r)}},49589:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertNotificationFilterIsEmpty=t.assertImpersonatedUserIsEmpty=t.assertTxConfigIsEmpty=t.assertDatabaseIsEmpty=void 0;var r=n(41264);n(6599);t.assertTxConfigIsEmpty=function(e,t,n){if(void 0===t&&(t=function(){}),e&&!e.isEmpty()){var i=(0,r.newError)("Driver is connected to the database that does not support transaction configuration. Please upgrade to neo4j 3.5.0 or later in order to use this functionality");throw t(i.message),n.onError(i),i}},t.assertDatabaseIsEmpty=function(e,t,n){if(void 0===t&&(t=function(){}),e){var i=(0,r.newError)("Driver is connected to the database that does not support multiple databases. Please upgrade to neo4j 4.0.0 or later in order to use this functionality");throw t(i.message),n.onError(i),i}},t.assertImpersonatedUserIsEmpty=function(e,t,n){if(void 0===t&&(t=function(){}),e){var i=(0,r.newError)("Driver is connected to the database that does not support user impersonation. Please upgrade to neo4j 4.4.0 or later in order to use this functionality. "+"Trying to impersonate ".concat(e,"."));throw t(i.message),n.onError(i),i}},t.assertNotificationFilterIsEmpty=function(e,t,n){if(void 0===t&&(t=function(){}),void 0!==e){var i=(0,r.newError)("Driver is connected to a database that does not support user notification filters. Please upgrade to Neo4j 5.7.0 or later in order to use this functionality. "+"Trying to set notifications to ".concat(r.json.stringify(e),"."));throw t(i.message),n.onError(i),i}}},39582:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(49589),c=(n(68768),n(62047)),l=s(n(38640)),h=n(6599),d=n(41264),f=a(n(98004)),p=a(n(1120)),m=d.internal.bookmarks.Bookmarks,g=d.internal.constants,v=g.ACCESS_MODE_WRITE,y=g.BOLT_PROTOCOL_V1,b=(d.internal.logger.Logger,d.internal.txConfig.TxConfig),_=Object.freeze({OPERATION:"",OPERATION_CODE:"0",CURRENT_SCHEMA:"/"}),x=function(){function e(e,t,n,r,i,o){var s=void 0===n?{}:n,a=s.disableLosslessIntegers,u=s.useBigInt;void 0===r&&(r=function(){return null}),this._server=e||{},this._chunker=t,this._packer=this._createPacker(t),this._unpacker=this._createUnpacker(a,u),this._responseHandler=r(this),this._log=i,this._onProtocolError=o,this._fatalError=null,this._lastMessageSignature=null,this._config={disableLosslessIntegers:a,useBigInt:u}}return Object.defineProperty(e.prototype,"transformer",{get:function(){var e=this;return void 0===this._transformer&&(this._transformer=new p.default(Object.values(f.default).map((function(t){return t(e._config,e._log)})))),this._transformer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"supportsReAuth",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"initialized",{get:function(){return!!this._initialized},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authToken",{get:function(){return this._authToken},enumerable:!1,configurable:!0}),e.prototype.packer=function(){return this._packer},e.prototype.packable=function(e){return this._packer.packable(e,this.transformer.toStructure)},e.prototype.unpacker=function(){return this._unpacker},e.prototype.unpack=function(e){return this._unpacker.unpack(e,this.transformer.fromStructure)},e.prototype.transformMetadata=function(e){return e},e.prototype.enrichErrorMetadata=function(e){return r(r({},e),{diagnostic_record:null!==e.diagnostic_record?r(r({},_),e.diagnostic_record):null})},e.prototype.initialize=function(e){var t=this,n=void 0===e?{}:e,r=n.userAgent,i=(n.boltAgent,n.authToken),o=n.notificationFilter,s=n.onError,a=n.onComplete,c=new h.LoginObserver({onError:function(e){return t._onLoginError(e,s)},onCompleted:function(e){return t._onLoginCompleted(e,a)}});return(0,u.assertNotificationFilterIsEmpty)(o,this._onProtocolError,c),this.write(l.default.init(r,i),c,!0),c},e.prototype.logoff=function(e){var t=void 0===e?{}:e,n=t.onComplete,r=t.onError,i=(t.flush,new h.LogoffObserver({onCompleted:n,onError:r})),o=(0,d.newError)("Driver is connected to a database that does not support logoff. Please upgrade to Neo4j 5.5.0 or later in order to use this functionality.");throw this._onProtocolError(o.message),i.onError(o),o},e.prototype.logon=function(e){var t=this,n=void 0===e?{}:e,r=n.authToken,i=n.onComplete,o=n.onError,s=(n.flush,new h.LoginObserver({onCompleted:function(){return t._onLoginCompleted({},r,i)},onError:function(e){return t._onLoginError(e,o)}})),a=(0,d.newError)("Driver is connected to a database that does not support logon. Please upgrade to Neo4j 5.5.0 or later in order to use this functionality.");throw this._onProtocolError(a.message),s.onError(a),a},e.prototype.prepareToClose=function(){},e.prototype.beginTransaction=function(e){var t=void 0===e?{}:e,n=t.bookmarks,r=t.txConfig,i=t.database,o=t.mode,s=t.impersonatedUser,a=t.notificationFilter,u=t.beforeError,c=t.afterError,l=t.beforeComplete,h=t.afterComplete;return this.run("BEGIN",n?n.asBeginTransactionParameters():{},{bookmarks:n,txConfig:r,database:i,mode:o,impersonatedUser:s,notificationFilter:a,beforeError:u,afterError:c,beforeComplete:l,afterComplete:h,flush:!1})},e.prototype.commitTransaction=function(e){var t=void 0===e?{}:e,n=t.beforeError,r=t.afterError,i=t.beforeComplete,o=t.afterComplete;return this.run("COMMIT",{},{bookmarks:m.empty(),txConfig:b.empty(),mode:v,beforeError:n,afterError:r,beforeComplete:i,afterComplete:o})},e.prototype.rollbackTransaction=function(e){var t=void 0===e?{}:e,n=t.beforeError,r=t.afterError,i=t.beforeComplete,o=t.afterComplete;return this.run("ROLLBACK",{},{bookmarks:m.empty(),txConfig:b.empty(),mode:v,beforeError:n,afterError:r,beforeComplete:i,afterComplete:o})},e.prototype.run=function(e,t,n){var r=void 0===n?{}:n,i=(r.bookmarks,r.txConfig),o=r.database,s=(r.mode,r.impersonatedUser),a=r.notificationFilter,c=r.beforeKeys,d=r.afterKeys,f=r.beforeError,p=r.afterError,m=r.beforeComplete,g=r.afterComplete,v=r.flush,y=void 0===v||v,b=r.highRecordWatermark,_=void 0===b?Number.MAX_VALUE:b,x=r.lowRecordWatermark,w=void 0===x?Number.MAX_VALUE:x,S=new h.ResultStreamObserver({server:this._server,beforeKeys:c,afterKeys:d,beforeError:f,afterError:p,beforeComplete:m,afterComplete:g,highRecordWatermark:_,lowRecordWatermark:w});return(0,u.assertTxConfigIsEmpty)(i,this._onProtocolError,S),(0,u.assertDatabaseIsEmpty)(o,this._onProtocolError,S),(0,u.assertImpersonatedUserIsEmpty)(s,this._onProtocolError,S),(0,u.assertNotificationFilterIsEmpty)(a,this._onProtocolError,S),this.write(l.default.run(e,t),S,!1),this.write(l.default.pullAll(),S,y),S},Object.defineProperty(e.prototype,"currentFailure",{get:function(){return this._responseHandler.currentFailure},enumerable:!1,configurable:!0}),e.prototype.reset=function(e){var t=void 0===e?{}:e,n=t.onError,r=t.onComplete,i=new h.ResetObserver({onProtocolError:this._onProtocolError,onError:n,onComplete:r});return this.write(l.default.reset(),i,!0),i},e.prototype.telemetry=function(e,t){e.api;var n=void 0===t?{}:t,r=(n.onError,n.onCompleted),i=new h.CompletedObserver;return r&&r(),i},e.prototype._createPacker=function(e){return new c.v1.Packer(e)},e.prototype._createUnpacker=function(e,t){return new c.v1.Unpacker(e,t)},e.prototype.write=function(e,t,n){if(this.queueObserverIfProtocolIsNotBroken(t)){this._log.isDebugEnabled()&&this._log.debug("C: ".concat(e)),this._lastMessageSignature=e.signature;var r=new c.structure.Structure(e.signature,e.fields);this.packable(r)(),this._chunker.messageBoundary(),n&&this._chunker.flush()}},e.prototype.isLastMessageLogon=function(){return this._lastMessageSignature===l.SIGNATURES.HELLO||this._lastMessageSignature===l.SIGNATURES.LOGON},e.prototype.isLastMessageReset=function(){return this._lastMessageSignature===l.SIGNATURES.RESET},e.prototype.notifyFatalError=function(e){return this._fatalError=e,this._responseHandler._notifyErrorToObservers(e)},e.prototype.updateCurrentObserver=function(){return this._responseHandler._updateCurrentObserver()},e.prototype.hasOngoingObservableRequests=function(){return this._responseHandler.hasOngoingObservableRequests()},e.prototype.queueObserverIfProtocolIsNotBroken=function(e){return this.isBroken()?(this.notifyFatalErrorToObserver(e),!1):this._responseHandler._queueObserver(e)},e.prototype.isBroken=function(){return!!this._fatalError},e.prototype.notifyFatalErrorToObserver=function(e){e&&e.onError&&e.onError(this._fatalError)},e.prototype.resetFailure=function(){this._responseHandler._resetFailure()},e.prototype._onLoginCompleted=function(e,t,n){if(this._initialized=!0,this._authToken=t,e){var r=e.server;this._server.version||(this._server.version=r)}n&&n(e)},e.prototype._onLoginError=function(e,t){this._onProtocolError(e.message),t&&t(e)},e}();t.default=x},98004:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s};Object.defineProperty(t,"__esModule",{value:!0});var i=n(41264),o=n(62047),s=n(1120),a=i.error.PROTOCOL_ERROR;t.default={createNodeTransformer:function(){return new s.TypeTransformer({signature:78,isTypeInstance:function(e){return e instanceof i.Node},toStructure:function(e){throw(0,i.newError)("It is not allowed to pass nodes in query parameters, given: ".concat(e),a)},fromStructure:function(e){o.structure.verifyStructSize("Node",3,e.size);var t=r(e.fields,3),n=t[0],s=t[1],a=t[2];return new i.Node(n,s,a)}})},createRelationshipTransformer:function(){return new s.TypeTransformer({signature:82,isTypeInstance:function(e){return e instanceof i.Relationship},toStructure:function(e){throw(0,i.newError)("It is not allowed to pass relationships in query parameters, given: ".concat(e),a)},fromStructure:function(e){o.structure.verifyStructSize("Relationship",5,e.size);var t=r(e.fields,5),n=t[0],s=t[1],a=t[2],u=t[3],c=t[4];return new i.Relationship(n,s,a,u,c)}})},createUnboundRelationshipTransformer:function(){return new s.TypeTransformer({signature:114,isTypeInstance:function(e){return e instanceof i.UnboundRelationship},toStructure:function(e){throw(0,i.newError)("It is not allowed to pass unbound relationships in query parameters, given: ".concat(e),a)},fromStructure:function(e){o.structure.verifyStructSize("UnboundRelationship",3,e.size);var t=r(e.fields,3),n=t[0],s=t[1],a=t[2];return new i.UnboundRelationship(n,s,a)}})},createPathTransformer:function(){return new s.TypeTransformer({signature:80,isTypeInstance:function(e){return e instanceof i.Path},toStructure:function(e){throw(0,i.newError)("It is not allowed to pass paths in query parameters, given: ".concat(e),a)},fromStructure:function(e){o.structure.verifyStructSize("Path",3,e.size);for(var t=r(e.fields,3),n=t[0],s=t[1],a=t[2],u=[],c=n[0],l=0;l<a.length;l+=2){var h=n[a[l+1]],d=(0,i.toNumber)(a[l]),f=void 0;d>0?(f=s[d-1])instanceof i.UnboundRelationship&&(s[d-1]=f=f.bindTo(c,h)):(f=s[-d-1])instanceof i.UnboundRelationship&&(s[-d-1]=f=f.bindTo(h,c)),u.push(new i.PathSegment(c,f,h)),c=h}return new i.Path(n[0],n[n.length-1],u)}})}}},74886:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(39582)),a=o(n(62047)),u=n(41264),c=o(n(87937)),l=o(n(1120)),h=u.internal.constants.BOLT_PROTOCOL_V2,d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype._createPacker=function(e){return new a.default.Packer(e)},t.prototype._createUnpacker=function(e,t){return new a.default.Unpacker(e,t)},Object.defineProperty(t.prototype,"transformer",{get:function(){var e=this;return void 0===this._transformer&&(this._transformer=new l.default(Object.values(c.default).map((function(t){return t(e._config,e._log)})))),this._transformer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return h},enumerable:!1,configurable:!0}),t}(s.default);t.default=d},87937:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(41264),a=n(62047),u=n(1120),c=n(2253),l=o(n(98004)),h=s.internal.temporalUtil,d=h.dateToEpochDay,f=h.localDateTimeToEpochSecond,p=h.localTimeToNanoOfDay;function m(e,t,n){if(!t&&!n)return e;var r=function(e){return n?e.toBigInt():e.toNumberOrInfinity()},i=Object.create(Object.getPrototypeOf(e));for(var o in e)if(!0===Object.prototype.hasOwnProperty.call(e,o)){var a=e[o];i[o]=(0,s.isInt)(a)?r(a):a}return Object.freeze(i),i}t.default=r(r({},l.default),{createPoint2DTransformer:function(){return new u.TypeTransformer({signature:88,isTypeInstance:function(e){return(0,s.isPoint)(e)&&(null===e.z||void 0===e.z)},toStructure:function(e){return new a.structure.Structure(88,[(0,s.int)(e.srid),e.x,e.y])},fromStructure:function(e){a.structure.verifyStructSize("Point2D",3,e.size);var t=i(e.fields,3),n=t[0],r=t[1],o=t[2];return new s.Point(n,r,o,void 0)}})},createPoint3DTransformer:function(){return new u.TypeTransformer({signature:89,isTypeInstance:function(e){return(0,s.isPoint)(e)&&null!==e.z&&void 0!==e.z},toStructure:function(e){return new a.structure.Structure(89,[(0,s.int)(e.srid),e.x,e.y,e.z])},fromStructure:function(e){a.structure.verifyStructSize("Point3D",4,e.size);var t=i(e.fields,4),n=t[0],r=t[1],o=t[2],u=t[3];return new s.Point(n,r,o,u)}})},createDurationTransformer:function(){return new u.TypeTransformer({signature:69,isTypeInstance:s.isDuration,toStructure:function(e){var t=(0,s.int)(e.months),n=(0,s.int)(e.days),r=(0,s.int)(e.seconds),i=(0,s.int)(e.nanoseconds);return new a.structure.Structure(69,[t,n,r,i])},fromStructure:function(e){a.structure.verifyStructSize("Duration",4,e.size);var t=i(e.fields,4),n=t[0],r=t[1],o=t[2],u=t[3];return new s.Duration(n,r,o,u)}})},createLocalTimeTransformer:function(e){var t=e.disableLosslessIntegers,n=e.useBigInt;return new u.TypeTransformer({signature:116,isTypeInstance:s.isLocalTime,toStructure:function(e){var t=p(e.hour,e.minute,e.second,e.nanosecond);return new a.structure.Structure(116,[t])},fromStructure:function(e){a.structure.verifyStructSize("LocalTime",1,e.size);var r=i(e.fields,1)[0];return m((0,c.nanoOfDayToLocalTime)(r),t,n)}})},createTimeTransformer:function(e){var t=e.disableLosslessIntegers,n=e.useBigInt;return new u.TypeTransformer({signature:84,isTypeInstance:s.isTime,toStructure:function(e){var t=p(e.hour,e.minute,e.second,e.nanosecond),n=(0,s.int)(e.timeZoneOffsetSeconds);return new a.structure.Structure(84,[t,n])},fromStructure:function(e){a.structure.verifyStructSize("Time",2,e.size);var r=i(e.fields,2),o=r[0],u=r[1],l=(0,c.nanoOfDayToLocalTime)(o);return m(new s.Time(l.hour,l.minute,l.second,l.nanosecond,u),t,n)}})},createDateTransformer:function(e){var t=e.disableLosslessIntegers,n=e.useBigInt;return new u.TypeTransformer({signature:68,isTypeInstance:s.isDate,toStructure:function(e){var t=d(e.year,e.month,e.day);return new a.structure.Structure(68,[t])},fromStructure:function(e){a.structure.verifyStructSize("Date",1,e.size);var r=i(e.fields,1)[0];return m((0,c.epochDayToDate)(r),t,n)}})},createLocalDateTimeTransformer:function(e){var t=e.disableLosslessIntegers,n=e.useBigInt;return new u.TypeTransformer({signature:100,isTypeInstance:s.isLocalDateTime,toStructure:function(e){var t=f(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),n=(0,s.int)(e.nanosecond);return new a.structure.Structure(100,[t,n])},fromStructure:function(e){a.structure.verifyStructSize("LocalDateTime",2,e.size);var r=i(e.fields,2),o=r[0],s=r[1];return m((0,c.epochSecondAndNanoToLocalDateTime)(o,s),t,n)}})},createDateTimeWithZoneIdTransformer:function(e){var t=e.disableLosslessIntegers,n=e.useBigInt;return new u.TypeTransformer({signature:102,isTypeInstance:function(e){return(0,s.isDateTime)(e)&&null!=e.timeZoneId},toStructure:function(e){var t=f(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),n=(0,s.int)(e.nanosecond),r=e.timeZoneId;return new a.structure.Structure(102,[t,n,r])},fromStructure:function(e){a.structure.verifyStructSize("DateTimeWithZoneId",3,e.size);var r=i(e.fields,3),o=r[0],u=r[1],l=r[2],h=(0,c.epochSecondAndNanoToLocalDateTime)(o,u);return m(new s.DateTime(h.year,h.month,h.day,h.hour,h.minute,h.second,h.nanosecond,null,l),t,n)}})},createDateTimeWithOffsetTransformer:function(e){var t=e.disableLosslessIntegers,n=e.useBigInt;return new u.TypeTransformer({signature:70,isTypeInstance:function(e){return(0,s.isDateTime)(e)&&null==e.timeZoneId},toStructure:function(e){var t=f(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),n=(0,s.int)(e.nanosecond),r=(0,s.int)(e.timeZoneOffsetSeconds);return new a.structure.Structure(70,[t,n,r])},fromStructure:function(e){a.structure.verifyStructSize("DateTimeWithZoneOffset",3,e.size);var r=i(e.fields,3),o=r[0],u=r[1],l=r[2],h=(0,c.epochSecondAndNanoToLocalDateTime)(o,u);return m(new s.DateTime(h.year,h.month,h.day,h.hour,h.minute,h.second,h.nanosecond,l,null),t,n)}})}})},63009:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(74886)),u=s(n(38640)),c=n(49589),l=n(6599),h=s(n(2389)),d=s(n(1120)),f=n(41264),p=(f.internal.bookmarks.Bookmarks,f.internal.constants.BOLT_PROTOCOL_V3),m=f.internal.txConfig.TxConfig,g="context",v="CALL dbms.cluster.routing.getRoutingTable($".concat(g,")"),y=new l.StreamObserver,b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return p},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var e=this;return void 0===this._transformer&&(this._transformer=new d.default(Object.values(h.default).map((function(t){return t(e._config,e._log)})))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.transformMetadata=function(e){return"t_first"in e&&(e.result_available_after=e.t_first,delete e.t_first),"t_last"in e&&(e.result_consumed_after=e.t_last,delete e.t_last),e},t.prototype.initialize=function(e){var t=this,n=void 0===e?{}:e,r=n.userAgent,i=(n.boltAgent,n.authToken),o=n.notificationFilter,s=n.onError,a=n.onComplete,h=new l.LoginObserver({onError:function(e){return t._onLoginError(e,s)},onCompleted:function(e){return t._onLoginCompleted(e,i,a)}});return(0,c.assertNotificationFilterIsEmpty)(o,this._onProtocolError,h),this.write(u.default.hello(r,i),h,!0),h},t.prototype.prepareToClose=function(){this.write(u.default.goodbye(),y,!0)},t.prototype.beginTransaction=function(e){var t=void 0===e?{}:e,n=t.bookmarks,r=t.txConfig,i=t.database,o=t.impersonatedUser,s=t.notificationFilter,a=t.mode,h=t.beforeError,d=t.afterError,f=t.beforeComplete,p=t.afterComplete,m=new l.ResultStreamObserver({server:this._server,beforeError:h,afterError:d,beforeComplete:f,afterComplete:p});return m.prepareToHandleSingleResponse(),(0,c.assertDatabaseIsEmpty)(i,this._onProtocolError,m),(0,c.assertImpersonatedUserIsEmpty)(o,this._onProtocolError,m),(0,c.assertNotificationFilterIsEmpty)(s,this._onProtocolError,m),this.write(u.default.begin({bookmarks:n,txConfig:r,mode:a}),m,!0),m},t.prototype.commitTransaction=function(e){var t=void 0===e?{}:e,n=t.beforeError,r=t.afterError,i=t.beforeComplete,o=t.afterComplete,s=new l.ResultStreamObserver({server:this._server,beforeError:n,afterError:r,beforeComplete:i,afterComplete:o});return s.prepareToHandleSingleResponse(),this.write(u.default.commit(),s,!0),s},t.prototype.rollbackTransaction=function(e){var t=void 0===e?{}:e,n=t.beforeError,r=t.afterError,i=t.beforeComplete,o=t.afterComplete,s=new l.ResultStreamObserver({server:this._server,beforeError:n,afterError:r,beforeComplete:i,afterComplete:o});return s.prepareToHandleSingleResponse(),this.write(u.default.rollback(),s,!0),s},t.prototype.run=function(e,t,n){var r=void 0===n?{}:n,i=r.bookmarks,o=r.txConfig,s=r.database,a=r.impersonatedUser,h=r.notificationFilter,d=r.mode,f=r.beforeKeys,p=r.afterKeys,m=r.beforeError,g=r.afterError,v=r.beforeComplete,y=r.afterComplete,b=r.flush,_=void 0===b||b,x=r.highRecordWatermark,w=void 0===x?Number.MAX_VALUE:x,S=r.lowRecordWatermark,E=void 0===S?Number.MAX_VALUE:S,T=new l.ResultStreamObserver({server:this._server,beforeKeys:f,afterKeys:p,beforeError:m,afterError:g,beforeComplete:v,afterComplete:y,highRecordWatermark:w,lowRecordWatermark:E});return(0,c.assertDatabaseIsEmpty)(s,this._onProtocolError,T),(0,c.assertImpersonatedUserIsEmpty)(a,this._onProtocolError,T),(0,c.assertNotificationFilterIsEmpty)(h,this._onProtocolError,T),this.write(u.default.runWithMetadata(e,t,{bookmarks:i,txConfig:o,mode:d}),T,!1),this.write(u.default.pullAll(),T,_),T},t.prototype.requestRoutingInformation=function(e){var t,n=e.routingContext,r=void 0===n?{}:n,i=e.sessionContext,s=void 0===i?{}:i,a=e.onError,u=e.onCompleted,c=this.run(v,((t={})[g]=r,t),o(o({},s),{txConfig:m.empty()}));return new l.ProcedureRouteObserver({resultObserver:c,onProtocolError:this._onProtocolError,onError:a,onCompleted:u})},t}(a.default);t.default=b},2389:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(87937));t.default=r({},o.default)},98969:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(63009)),u=s(n(38640)),c=n(49589),l=n(6599),h=s(n(80372)),d=s(n(1120)),f=n(41264),p=(f.internal.bookmarks.Bookmarks,f.internal.constants),m=p.BOLT_PROTOCOL_V4_0,g=p.FETCH_ALL,v=f.internal.txConfig.TxConfig,y="context",b="database",_="CALL dbms.routing.getRoutingTable($".concat(y,", $").concat(b,")"),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return m},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var e=this;return void 0===this._transformer&&(this._transformer=new d.default(Object.values(h.default).map((function(t){return t(e._config,e._log)})))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.beginTransaction=function(e){var t=void 0===e?{}:e,n=t.bookmarks,r=t.txConfig,i=t.database,o=t.impersonatedUser,s=t.notificationFilter,a=t.mode,h=t.beforeError,d=t.afterError,f=t.beforeComplete,p=t.afterComplete,m=new l.ResultStreamObserver({server:this._server,beforeError:h,afterError:d,beforeComplete:f,afterComplete:p});return m.prepareToHandleSingleResponse(),(0,c.assertImpersonatedUserIsEmpty)(o,this._onProtocolError,m),(0,c.assertNotificationFilterIsEmpty)(s,this._onProtocolError,m),this.write(u.default.begin({bookmarks:n,txConfig:r,database:i,mode:a}),m,!0),m},t.prototype.run=function(e,t,n){var r=void 0===n?{}:n,i=r.bookmarks,o=r.txConfig,s=r.database,a=r.impersonatedUser,h=r.notificationFilter,d=r.mode,f=r.beforeKeys,p=r.afterKeys,m=r.beforeError,v=r.afterError,y=r.beforeComplete,b=r.afterComplete,_=r.flush,x=void 0===_||_,w=r.reactive,S=void 0!==w&&w,E=r.fetchSize,T=void 0===E?g:E,M=r.highRecordWatermark,A=void 0===M?Number.MAX_VALUE:M,C=r.lowRecordWatermark,O=void 0===C?Number.MAX_VALUE:C,P=new l.ResultStreamObserver({server:this._server,reactive:S,fetchSize:T,moreFunction:this._requestMore.bind(this),discardFunction:this._requestDiscard.bind(this),beforeKeys:f,afterKeys:p,beforeError:m,afterError:v,beforeComplete:y,afterComplete:b,highRecordWatermark:A,lowRecordWatermark:O});(0,c.assertImpersonatedUserIsEmpty)(a,this._onProtocolError,P),(0,c.assertNotificationFilterIsEmpty)(h,this._onProtocolError,P);var R=S;return this.write(u.default.runWithMetadata(e,t,{bookmarks:i,txConfig:o,database:s,mode:d}),P,R&&x),S||this.write(u.default.pull({n:T}),P,x),P},t.prototype._requestMore=function(e,t,n){this.write(u.default.pull({stmtId:e,n:t}),n,!0)},t.prototype._requestDiscard=function(e,t){this.write(u.default.discard({stmtId:e}),t,!0)},t.prototype._noOp=function(){},t.prototype.requestRoutingInformation=function(e){var t,n=e.routingContext,r=void 0===n?{}:n,i=e.databaseName,s=void 0===i?null:i,a=e.sessionContext,u=void 0===a?{}:a,c=e.onError,h=e.onCompleted,d=this.run(_,((t={})[y]=r,t[b]=s,t),o(o({},u),{txConfig:v.empty()}));return new l.ProcedureRouteObserver({resultObserver:d,onProtocolError:this._onProtocolError,onError:c,onCompleted:h})},t}(a.default);t.default=x},80372:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(2389));t.default=r({},o.default)},7599:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(98969)),a=o(n(38640)),u=n(6599),c=n(41264),l=n(49589),h=o(n(11296)),d=o(n(1120)),f=c.internal.constants.BOLT_PROTOCOL_V4_1,p=function(e){function t(t,n,r,i,o,s,a){void 0===i&&(i=function(){return null});var u=e.call(this,t,n,r,i,o,s)||this;return u._serversideRouting=a,u}return i(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return f},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var e=this;return void 0===this._transformer&&(this._transformer=new d.default(Object.values(h.default).map((function(t){return t(e._config,e._log)})))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e){var t=this,n=void 0===e?{}:e,r=n.userAgent,i=(n.boltAgent,n.authToken),o=n.notificationFilter,s=n.onError,c=n.onComplete,h=new u.LoginObserver({onError:function(e){return t._onLoginError(e,s)},onCompleted:function(e){return t._onLoginCompleted(e,i,c)}});return(0,l.assertNotificationFilterIsEmpty)(o,this._onProtocolError,h),this.write(a.default.hello(r,i,this._serversideRouting),h,!0),h},t}(s.default);t.default=p},11296:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(80372));t.default=r({},o.default)},76098:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(7599)),a=n(41264),u=o(n(90627)),c=o(n(1120)),l=a.internal.constants.BOLT_PROTOCOL_V4_2,h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return l},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var e=this;return void 0===this._transformer&&(this._transformer=new c.default(Object.values(u.default).map((function(t){return t(e._config,e._log)})))),this._transformer},enumerable:!1,configurable:!0}),t}(s.default);t.default=h},90627:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(11296));t.default=r({},o.default)},36859:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(76098)),u=s(n(38640)),c=n(6599),l=n(49589),h=s(n(60281)),d=s(n(44569)),f=s(n(1120)),p=n(41264),m=p.internal.bookmarks.Bookmarks,g=p.internal.constants.BOLT_PROTOCOL_V4_3,v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return g},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var e=this;return void 0===this._transformer&&(this._transformer=new f.default(Object.values(h.default).map((function(t){return t(e._config,e._log)})))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.requestRoutingInformation=function(e){var t=e.routingContext,n=void 0===t?{}:t,r=e.databaseName,i=void 0===r?null:r,o=e.sessionContext,s=void 0===o?{}:o,a=e.onError,l=e.onCompleted,h=new c.RouteObserver({onProtocolError:this._onProtocolError,onError:a,onCompleted:l}),d=s.bookmarks||m.empty();return this.write(u.default.route(n,d.values(),i),h,!0),h},t.prototype.initialize=function(e){var t=this,n=void 0===e?{}:e,r=n.userAgent,i=(n.boltAgent,n.authToken),o=n.notificationFilter,s=n.onError,a=n.onComplete,h=new c.LoginObserver({onError:function(e){return t._onLoginError(e,s)},onCompleted:function(e){return void 0!==e.patch_bolt&&t._applyPatches(e.patch_bolt),t._onLoginCompleted(e,i,a)}});return(0,l.assertNotificationFilterIsEmpty)(o,this._onProtocolError,h),this.write(u.default.hello(r,i,this._serversideRouting,["utc"]),h,!0),h},t.prototype._applyPatches=function(e){e.includes("utc")&&this._applyUtcPatch()},t.prototype._applyUtcPatch=function(){var e=this;this._transformer=new f.default(Object.values(o(o({},h.default),d.default)).map((function(t){return t(e._config,e._log)})))},t}(a.default);t.default=v},60281:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(90627));t.default=r({},o.default)},62891:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(36859)),u=n(41264),c=s(n(38640)),l=n(6599),h=n(49589),d=s(n(41549)),f=s(n(44569)),p=s(n(1120)),m=u.internal.constants,g=m.BOLT_PROTOCOL_V4_4,v=m.FETCH_ALL,y=u.internal.bookmarks.Bookmarks,b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return g},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var e=this;return void 0===this._transformer&&(this._transformer=new p.default(Object.values(d.default).map((function(t){return t(e._config,e._log)})))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.requestRoutingInformation=function(e){var t=e.routingContext,n=void 0===t?{}:t,r=e.databaseName,i=void 0===r?null:r,o=e.impersonatedUser,s=void 0===o?null:o,a=e.sessionContext,u=void 0===a?{}:a,h=e.onError,d=e.onCompleted,f=new l.RouteObserver({onProtocolError:this._onProtocolError,onError:h,onCompleted:d}),p=u.bookmarks||y.empty();return this.write(c.default.routeV4x4(n,p.values(),{databaseName:i,impersonatedUser:s}),f,!0),f},t.prototype.run=function(e,t,n){var r=void 0===n?{}:n,i=r.bookmarks,o=r.txConfig,s=r.database,a=r.mode,u=r.impersonatedUser,d=r.notificationFilter,f=r.beforeKeys,p=r.afterKeys,m=r.beforeError,g=r.afterError,y=r.beforeComplete,b=r.afterComplete,_=r.flush,x=void 0===_||_,w=r.reactive,S=void 0!==w&&w,E=r.fetchSize,T=void 0===E?v:E,M=r.highRecordWatermark,A=void 0===M?Number.MAX_VALUE:M,C=r.lowRecordWatermark,O=void 0===C?Number.MAX_VALUE:C,P=new l.ResultStreamObserver({server:this._server,reactive:S,fetchSize:T,moreFunction:this._requestMore.bind(this),discardFunction:this._requestDiscard.bind(this),beforeKeys:f,afterKeys:p,beforeError:m,afterError:g,beforeComplete:y,afterComplete:b,highRecordWatermark:A,lowRecordWatermark:O});(0,h.assertNotificationFilterIsEmpty)(d,this._onProtocolError,P);var R=S;return this.write(c.default.runWithMetadata(e,t,{bookmarks:i,txConfig:o,database:s,mode:a,impersonatedUser:u}),P,R&&x),S||this.write(c.default.pull({n:T}),P,x),P},t.prototype.beginTransaction=function(e){var t=void 0===e?{}:e,n=t.bookmarks,r=t.txConfig,i=t.database,o=t.mode,s=t.impersonatedUser,a=t.notificationFilter,u=t.beforeError,d=t.afterError,f=t.beforeComplete,p=t.afterComplete,m=new l.ResultStreamObserver({server:this._server,beforeError:u,afterError:d,beforeComplete:f,afterComplete:p});return m.prepareToHandleSingleResponse(),(0,h.assertNotificationFilterIsEmpty)(a,this._onProtocolError,m),this.write(c.default.begin({bookmarks:n,txConfig:r,database:i,mode:o,impersonatedUser:s}),m,!0),m},t.prototype._applyUtcPatch=function(){var e=this;this._transformer=new p.default(Object.values(o(o({},d.default),f.default)).map((function(t){return t(e._config,e._log)})))},t}(a.default);t.default=b},41549:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(60281));t.default=r({},o.default)},95632:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(62891)),a=n(49589),u=o(n(26990)),c=o(n(1120)),l=o(n(38640)),h=n(6599),d=n(41264).internal.constants.BOLT_PROTOCOL_V5_0,f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return d},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var e=this;return void 0===this._transformer&&(this._transformer=new c.default(Object.values(u.default).map((function(t){return t(e._config,e._log)})))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e){var t=this,n=void 0===e?{}:e,r=n.userAgent,i=(n.boltAgent,n.authToken),o=n.notificationFilter,s=n.onError,u=n.onComplete,c=new h.LoginObserver({onError:function(e){return t._onLoginError(e,s)},onCompleted:function(e){return t._onLoginCompleted(e,i,u)}});return(0,a.assertNotificationFilterIsEmpty)(o,this._onProtocolError,c),this.write(l.default.hello(r,i,this._serversideRouting),c,!0),c},t}(s.default);t.default=f},26990:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(62047),a=n(41264),u=o(n(41549)),c=o(n(44569));t.default=r(r(r({},u.default),c.default),{createNodeTransformer:function(e){return u.default.createNodeTransformer(e).extendsWith({fromStructure:function(e){s.structure.verifyStructSize("Node",4,e.size);var t=i(e.fields,4),n=t[0],r=t[1],o=t[2],u=t[3];return new a.Node(n,r,o,u)}})},createRelationshipTransformer:function(e){return u.default.createRelationshipTransformer(e).extendsWith({fromStructure:function(e){s.structure.verifyStructSize("Relationship",8,e.size);var t=i(e.fields,8),n=t[0],r=t[1],o=t[2],u=t[3],c=t[4],l=t[5],h=t[6],d=t[7];return new a.Relationship(n,r,o,u,c,l,h,d)}})},createUnboundRelationshipTransformer:function(e){return u.default.createUnboundRelationshipTransformer(e).extendsWith({fromStructure:function(e){s.structure.verifyStructSize("UnboundRelationship",4,e.size);var t=i(e.fields,4),n=t[0],r=t[1],o=t[2],u=t[3];return new a.UnboundRelationship(n,r,o,u)}})}})},44569:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(62047),s=n(41264),a=i(n(41549)),u=n(2253),c=n(33420),l=s.internal.temporalUtil.localDateTimeToEpochSecond;var h=new Map;function d(e,t,n){var r=function(e){if(!h.has(e)){var t=new Intl.DateTimeFormat("en-US",{timeZone:e,year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1,era:"narrow"});h.set(e,t)}return h.get(e)}(e),i=(0,s.int)(t).multiply(1e3).add((0,s.int)(n).div(1e6)).toNumber(),o=r.formatToParts(i).reduce((function(e,t){return"era"===t.type?e.adjustEra="B"===t.value.toUpperCase()?function(e){return e.subtract(1).negate()}:c.identity:"hour"===t.type?e.hour=(0,s.int)(t.value).modulo(24):"literal"!==t.type&&(e[t.type]=(0,s.int)(t.value)),e}),{});o.year=o.adjustEra(o.year);var a=l(o.year,o.month,o.day,o.hour,o.minute,o.second,o.nanosecond);return o.timeZoneOffsetSeconds=a.subtract(t),o.hour=o.hour.modulo(24),o}function f(e,t,n){if(!t&&!n)return e;var r=function(e){return n?e.toBigInt():e.toNumberOrInfinity()},i=Object.create(Object.getPrototypeOf(e));for(var o in e)if(!0===Object.prototype.hasOwnProperty.call(e,o)){var a=e[o];i[o]=(0,s.isInt)(a)?r(a):a}return Object.freeze(i),i}t.default={createDateTimeWithZoneIdTransformer:function(e,t){var n=e.disableLosslessIntegers,i=e.useBigInt;return a.default.createDateTimeWithZoneIdTransformer(e).extendsWith({signature:105,fromStructure:function(e){o.structure.verifyStructSize("DateTimeWithZoneId",3,e.size);var t=r(e.fields,3),a=t[0],u=t[1],c=t[2],l=d(c,a,u);return f(new s.DateTime(l.year,l.month,l.day,l.hour,l.minute,l.second,(0,s.int)(u),l.timeZoneOffsetSeconds,c),n,i)},toStructure:function(e){var n=l(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=null!=e.timeZoneOffsetSeconds?e.timeZoneOffsetSeconds:function(e,t,n){var r=d(e,t,n),i=l(r.year,r.month,r.day,r.hour,r.minute,r.second,n).subtract(t),o=t.subtract(i),s=d(e,o,n),a=l(s.year,s.month,s.day,s.hour,s.minute,s.second,n).subtract(o);return a}(e.timeZoneId,n,e.nanosecond);null==e.timeZoneOffsetSeconds&&t.warn('DateTime objects without "timeZoneOffsetSeconds" property are prune to bugs related to ambiguous times. For instance, 2022-10-30T2:30:00[Europe/Berlin] could be GMT+1 or GMT+2.');var i=n.subtract(r),a=(0,s.int)(e.nanosecond),u=e.timeZoneId;return new o.structure.Structure(105,[i,a,u])}})},createDateTimeWithOffsetTransformer:function(e){var t=e.disableLosslessIntegers,n=e.useBigInt;return a.default.createDateTimeWithOffsetTransformer(e).extendsWith({signature:73,toStructure:function(e){var t=l(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),n=(0,s.int)(e.nanosecond),r=(0,s.int)(e.timeZoneOffsetSeconds),i=t.subtract(r);return new o.structure.Structure(73,[i,n,r])},fromStructure:function(e){o.structure.verifyStructSize("DateTimeWithZoneOffset",3,e.size);var i=r(e.fields,3),a=i[0],c=i[1],l=i[2],h=(0,s.int)(a).add(l),d=(0,u.epochSecondAndNanoToLocalDateTime)(h,c);return f(new s.DateTime(d.year,d.month,d.day,d.hour,d.minute,d.second,d.nanosecond,l,null),t,n)}})}}},44302:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(95632)),u=n(49589),c=s(n(37259)),l=s(n(1120)),h=s(n(38640)),d=n(6599),f=n(41264).internal.constants.BOLT_PROTOCOL_V5_1,p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return f},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var e=this;return void 0===this._transformer&&(this._transformer=new l.default(Object.values(c.default).map((function(t){return t(e._config,e._log)})))),this._transformer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportsReAuth",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e){var t=this,n=void 0===e?{}:e,r=n.userAgent,i=(n.boltAgent,n.authToken),s=n.notificationFilter,a=n.onError,c=n.onComplete,l={},f=new d.LoginObserver({onError:function(e){return t._onLoginError(e,a)},onCompleted:function(e){return l.metadata=e,t._onLoginCompleted(e)}});return(0,u.assertNotificationFilterIsEmpty)(s,this._onProtocolError,f),this.write(h.default.hello5x1(r,this._serversideRouting),f,!1),this.logon({authToken:i,onComplete:function(e){return c(o(o({},e),l.metadata))},onError:a,flush:!0})},t.prototype.logon=function(e){var t=this,n=void 0===e?{}:e,r=n.authToken,i=n.onComplete,o=n.onError,s=n.flush,a=new d.LoginObserver({onCompleted:function(){return t._onLoginCompleted(null,r,i)},onError:function(e){return t._onLoginError(e,o)}});return this.write(h.default.logon(r),a,s),a},t.prototype.logoff=function(e){var t=void 0===e?{}:e,n=t.onComplete,r=t.onError,i=t.flush,o=new d.LogoffObserver({onCompleted:n,onError:r});return this.write(h.default.logoff(),o,i),o},t}(a.default);t.default=p},37259:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(26990));t.default=r({},o.default)},58849:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(44302)),u=s(n(86443)),c=s(n(1120)),l=s(n(38640)),h=n(6599),d=n(41264).internal.constants,f=d.BOLT_PROTOCOL_V5_2,p=d.FETCH_ALL,m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return f},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var e=this;return void 0===this._transformer&&(this._transformer=new c.default(Object.values(u.default).map((function(t){return t(e._config,e._log)})))),this._transformer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportsReAuth",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e){var t=this,n=void 0===e?{}:e,r=n.userAgent,i=(n.boltAgent,n.authToken),s=n.notificationFilter,a=n.onError,u=n.onComplete,c={},d=new h.LoginObserver({onError:function(e){return t._onLoginError(e,a)},onCompleted:function(e){return c.metadata=e,t._onLoginCompleted(e)}});return this.write(l.default.hello5x2(r,s,this._serversideRouting),d,!1),this.logon({authToken:i,onComplete:function(e){return u(o(o({},e),c.metadata))},onError:a,flush:!0})},t.prototype.beginTransaction=function(e){var t=void 0===e?{}:e,n=t.bookmarks,r=t.txConfig,i=t.database,o=t.mode,s=t.impersonatedUser,a=t.notificationFilter,u=t.beforeError,c=t.afterError,d=t.beforeComplete,f=t.afterComplete,p=new h.ResultStreamObserver({server:this._server,beforeError:u,afterError:c,beforeComplete:d,afterComplete:f});return p.prepareToHandleSingleResponse(),this.write(l.default.begin({bookmarks:n,txConfig:r,database:i,mode:o,impersonatedUser:s,notificationFilter:a}),p,!0),p},t.prototype.run=function(e,t,n){var r=void 0===n?{}:n,i=r.bookmarks,o=r.txConfig,s=r.database,a=r.mode,u=r.impersonatedUser,c=r.notificationFilter,d=r.beforeKeys,f=r.afterKeys,m=r.beforeError,g=r.afterError,v=r.beforeComplete,y=r.afterComplete,b=r.flush,_=void 0===b||b,x=r.reactive,w=void 0!==x&&x,S=r.fetchSize,E=void 0===S?p:S,T=r.highRecordWatermark,M=void 0===T?Number.MAX_VALUE:T,A=r.lowRecordWatermark,C=void 0===A?Number.MAX_VALUE:A,O=new h.ResultStreamObserver({server:this._server,reactive:w,fetchSize:E,moreFunction:this._requestMore.bind(this),discardFunction:this._requestDiscard.bind(this),beforeKeys:d,afterKeys:f,beforeError:m,afterError:g,beforeComplete:v,afterComplete:y,highRecordWatermark:M,lowRecordWatermark:C}),P=w;return this.write(l.default.runWithMetadata(e,t,{bookmarks:i,txConfig:o,database:s,mode:a,impersonatedUser:u,notificationFilter:c}),O,P&&_),w||this.write(l.default.pull({n:E}),O,_),O},t}(a.default);t.default=m},86443:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(37259));t.default=r({},o.default)},25864:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(58849)),u=s(n(89407)),c=s(n(1120)),l=s(n(38640)),h=n(6599),d=n(41264).internal.constants.BOLT_PROTOCOL_V5_3,f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return d},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var e=this;return void 0===this._transformer&&(this._transformer=new c.default(Object.values(u.default).map((function(t){return t(e._config,e._log)})))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e){var t=this,n=void 0===e?{}:e,r=n.userAgent,i=n.boltAgent,s=n.authToken,a=n.notificationFilter,u=n.onError,c=n.onComplete,d={},f=new h.LoginObserver({onError:function(e){return t._onLoginError(e,u)},onCompleted:function(e){return d.metadata=e,t._onLoginCompleted(e)}});return this.write(l.default.hello5x3(r,i,a,this._serversideRouting),f,!1),this.logon({authToken:s,onComplete:function(e){return c(o(o({},e),d.metadata))},onError:u,flush:!0})},t}(a.default);t.default=f},89407:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(86443));t.default=r({},o.default)},14498:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(25864)),a=o(n(41463)),u=o(n(38640)),c=n(6599),l=o(n(1120)),h=n(41264).internal.constants.BOLT_PROTOCOL_V5_4,d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return h},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var e=this;return void 0===this._transformer&&(this._transformer=new l.default(Object.values(a.default).map((function(t){return t(e._config,e._log)})))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.telemetry=function(e,t){var n=e.api,r=void 0===t?{}:t,i=r.onError,o=r.onCompleted,s=new c.TelemetryObserver({onCompleted:o,onError:i});return this.write(u.default.telemetry({api:n}),s,!1),s},t}(s.default);t.default=d},41463:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(89407));t.default=r({},o.default)},17539:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(14498)),u=s(n(87739)),c=s(n(1120)),l=s(n(38640)),h=n(6599),d=n(41264).internal.constants,f=d.BOLT_PROTOCOL_V5_5,p=d.FETCH_ALL,m=Object.freeze({OPERATION:"",OPERATION_CODE:"0",CURRENT_SCHEMA:"/"}),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return f},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var e=this;return void 0===this._transformer&&(this._transformer=new c.default(Object.values(u.default).map((function(t){return t(e._config,e._log)})))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e){var t=this,n=void 0===e?{}:e,r=n.userAgent,i=n.boltAgent,s=n.authToken,a=n.notificationFilter,u=n.onError,c=n.onComplete,d={},f=new h.LoginObserver({onError:function(e){return t._onLoginError(e,u)},onCompleted:function(e){return d.metadata=e,t._onLoginCompleted(e)}});return this.write(l.default.hello5x5(r,i,a,this._serversideRouting),f,!1),this.logon({authToken:s,onComplete:function(e){return c(o(o({},e),d.metadata))},onError:u,flush:!0})},t.prototype.beginTransaction=function(e){var t=void 0===e?{}:e,n=t.bookmarks,r=t.txConfig,i=t.database,o=t.mode,s=t.impersonatedUser,a=t.notificationFilter,u=t.beforeError,c=t.afterError,d=t.beforeComplete,f=t.afterComplete,p=new h.ResultStreamObserver({server:this._server,beforeError:u,afterError:c,beforeComplete:d,afterComplete:f});return p.prepareToHandleSingleResponse(),this.write(l.default.begin5x5({bookmarks:n,txConfig:r,database:i,mode:o,impersonatedUser:s,notificationFilter:a}),p,!0),p},t.prototype.run=function(e,t,n){var r=void 0===n?{}:n,i=r.bookmarks,o=r.txConfig,s=r.database,a=r.mode,u=r.impersonatedUser,c=r.notificationFilter,d=r.beforeKeys,f=r.afterKeys,m=r.beforeError,g=r.afterError,v=r.beforeComplete,y=r.afterComplete,b=r.flush,_=void 0===b||b,x=r.reactive,w=void 0!==x&&x,S=r.fetchSize,E=void 0===S?p:S,T=r.highRecordWatermark,M=void 0===T?Number.MAX_VALUE:T,A=r.lowRecordWatermark,C=void 0===A?Number.MAX_VALUE:A,O=new h.ResultStreamObserver({server:this._server,reactive:w,fetchSize:E,moreFunction:this._requestMore.bind(this),discardFunction:this._requestDiscard.bind(this),beforeKeys:d,afterKeys:f,beforeError:m,afterError:g,beforeComplete:v,afterComplete:y,highRecordWatermark:M,lowRecordWatermark:C,enrichMetadata:this._enrichMetadata}),P=w;return this.write(l.default.runWithMetadata5x5(e,t,{bookmarks:i,txConfig:o,database:s,mode:a,impersonatedUser:u,notificationFilter:c}),O,P&&_),w||this.write(l.default.pull({n:E}),O,_),O},t.prototype._enrichMetadata=function(e){return Array.isArray(e.statuses)&&(e.statuses=e.statuses.map((function(e){return o(o({},e),{description:null!=e.neo4j_code?e.status_description:e.description,diagnostic_record:null!==e.diagnostic_record?o(o({},m),e.diagnostic_record):null})}))),e},t}(a.default);t.default=g},87739:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(41463));t.default=r({},o.default)},9212:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(17539)),u=s(n(87739)),c=s(n(1120)),l=n(41264).internal.constants.BOLT_PROTOCOL_V5_6,h=Object.freeze({OPERATION:"",OPERATION_CODE:"0",CURRENT_SCHEMA:"/"}),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return l},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var e=this;return void 0===this._transformer&&(this._transformer=new c.default(Object.values(u.default).map((function(t){return t(e._config,e._log)})))),this._transformer},enumerable:!1,configurable:!0}),t.prototype._enrichMetadata=function(e){return Array.isArray(e.statuses)&&(e.statuses=e.statuses.map((function(e){return o(o({},e),{diagnostic_record:null!==e.diagnostic_record?o(o({},h),e.diagnostic_record):null})}))),e},t}(a.default);t.default=d},38609:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(9212)),u=s(n(87739)),c=s(n(1120)),l=n(41264).internal.constants.BOLT_PROTOCOL_V5_7,h=Object.freeze({OPERATION:"",OPERATION_CODE:"0",CURRENT_SCHEMA:"/"}),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return l},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var e=this;return void 0===this._transformer&&(this._transformer=new c.default(Object.values(u.default).map((function(t){return t(e._config,e._log)})))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.enrichErrorMetadata=function(e){return o(o({},e),{cause:null!==e.cause&&void 0!==e.cause?this.enrichErrorMetadata(e.cause):null,code:e.neo4j_code,diagnostic_record:null!==e.diagnostic_record?o(o({},h),e.diagnostic_record):null})},t}(a.default);t.default=d},91436:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(41264),o=r(n(39582)),s=r(n(74886)),a=r(n(63009)),u=r(n(98969)),c=r(n(7599)),l=r(n(76098)),h=r(n(36859)),d=r(n(62891)),f=r(n(95632)),p=r(n(44302)),m=r(n(58849)),g=r(n(25864)),v=r(n(14498)),y=r(n(17539)),b=r(n(9212)),_=r(n(38609)),x=(n(68768),r(n(28851)));t.default=function(e){var t=void 0===e?{}:e,n=t.version,r=t.chunker,w=t.dechunker,S=t.channel,E=t.disableLosslessIntegers,T=t.useBigInt,M=t.serversideRouting,A=t.server,C=t.log,O=t.observer;return function(e,t,n,r,x,w,S,E){switch(e){case 1:return new o.default(t,n,r,w,E,S);case 2:return new s.default(t,n,r,w,E,S);case 3:return new a.default(t,n,r,w,E,S);case 4:return new u.default(t,n,r,w,E,S);case 4.1:return new c.default(t,n,r,w,E,S,x);case 4.2:return new l.default(t,n,r,w,E,S,x);case 4.3:return new h.default(t,n,r,w,E,S,x);case 4.4:return new d.default(t,n,r,w,E,S,x);case 5:return new f.default(t,n,r,w,E,S,x);case 5.1:return new p.default(t,n,r,w,E,S,x);case 5.2:return new m.default(t,n,r,w,E,S,x);case 5.3:return new g.default(t,n,r,w,E,S,x);case 5.4:return new v.default(t,n,r,w,E,S,x);case 5.5:return new y.default(t,n,r,w,E,S,x);case 5.6:return new b.default(t,n,r,w,E,S,x);case 5.7:return new _.default(t,n,r,w,E,S,x);default:throw(0,i.newError)("Unknown Bolt protocol version: "+e)}}(n,A,r,{disableLosslessIntegers:E,useBigInt:T},M,(function(e){var t=new x.default({transformMetadata:e.transformMetadata.bind(e),enrichErrorMetadata:e.enrichErrorMetadata.bind(e),log:C,observer:O});return S.onerror=O.onError.bind(O),S.onmessage=function(e){return w.write(e)},w.onmessage=function(n){try{t.handleResponse(e.unpack(n))}catch(e){return O.onError(e)}},t}),O.onProtocolError.bind(O),C)}},49447:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(68768),i=n(41264);function o(e,t){return{major:e,minor:t}}function s(){return function(e){if(e.length>4)throw(0,i.newError)("It should not have more than 4 versions of the protocol");var t=(0,r.alloc)(20);return t.writeInt32(1616949271),e.forEach((function(e){if(e instanceof Array){var n=e[0],r=n.major,i=(o=n.minor)-e[1].minor;t.writeInt32(i<<16|o<<8|r)}else{r=e.major;var o=e.minor;t.writeInt32(o<<8|r)}})),t.reset(),t}([[o(5,7),o(5,0)],[o(4,4),o(4,2)],o(4,1),o(3,0)])}t.default=function(e,t){var n=this;return new Promise((function(r,o){var a=function(e){o(e)};e.onerror=a.bind(n),e._error&&a(e._error),e.onmessage=function(e){try{var n=function(e,t){var n=[e.readUInt8(),e.readUInt8(),e.readUInt8(),e.readUInt8()];if(72===n[0]&&84===n[1]&&84===n[2]&&80===n[3])throw t.error("Handshake failed since server responded with HTTP."),(0,i.newError)("Server responded HTTP. Make sure you are not trying to connect to the http endpoint (HTTP defaults to port 7474 whereas BOLT defaults to port 7687)");return Number(n[3]+"."+n[2])}(e,t);r({protocolVersion:n,consumeRemainingBuffer:function(t){e.hasRemaining()&&t(e.readSlice(e.remaining()))}})}catch(e){o(e)}},e.write(s())}))}},6101:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RawRoutingTable=t.BoltProtocol=void 0;var s=o(n(49447)),a=o(n(91436)),u=o(n(36859)),c=o(n(72225));i(n(6599),t),t.BoltProtocol=u.default,t.RawRoutingTable=c.default,t.default={handshake:s.default,create:a.default}},38640:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SIGNATURES=void 0;var r=n(41264),i=r.internal.constants,o=i.ACCESS_MODE_READ,s=i.FETCH_ALL,a=r.internal.util.assertString,u=Object.freeze({INIT:1,RESET:15,RUN:16,PULL_ALL:63,HELLO:1,GOODBYE:2,BEGIN:17,COMMIT:18,ROLLBACK:19,TELEMETRY:84,ROUTE:102,LOGON:106,LOGOFF:107,DISCARD:47,PULL:63});t.SIGNATURES=u;var c=function(){function e(e,t,n){this.signature=e,this.fields=t,this.toString=n}return e.init=function(t,n){return new e(1,[t,n],(function(){return"INIT ".concat(t," {...}")}))},e.run=function(t,n){return new e(16,[t,n],(function(){return"RUN ".concat(t," ").concat(r.json.stringify(n))}))},e.pullAll=function(){return p},e.reset=function(){return m},e.hello=function(t,n,r,i){void 0===r&&(r=null),void 0===i&&(i=null);var o=Object.assign({user_agent:t},n);return r&&(o.routing=r),i&&(o.patch_bolt=i),new e(1,[o],(function(){return"HELLO {user_agent: '".concat(t,"', ...}")}))},e.hello5x1=function(t,n){void 0===n&&(n=null);var r={user_agent:t};return n&&(r.routing=n),new e(1,[r],(function(){return"HELLO {user_agent: '".concat(t,"', ...}")}))},e.hello5x2=function(t,n,i){void 0===n&&(n=null),void 0===i&&(i=null);var o={user_agent:t};return d(o,n),i&&(o.routing=i),new e(1,[o],(function(){return"HELLO ".concat(r.json.stringify(o))}))},e.hello5x3=function(t,n,i,o){void 0===i&&(i=null),void 0===o&&(o=null);var s={};return t&&(s.user_agent=t),n&&(s.bolt_agent={product:n.product,platform:n.platform,language:n.language,language_details:n.languageDetails}),d(s,i),o&&(s.routing=o),new e(1,[s],(function(){return"HELLO ".concat(r.json.stringify(s))}))},e.hello5x5=function(t,n,i,o){void 0===i&&(i=null),void 0===o&&(o=null);var s={};return t&&(s.user_agent=t),n&&(s.bolt_agent={product:n.product,platform:n.platform,language:n.language,language_details:n.languageDetails}),f(s,i),o&&(s.routing=o),new e(1,[s],(function(){return"HELLO ".concat(r.json.stringify(s))}))},e.logon=function(t){return new e(106,[t],(function(){return"LOGON { ... }"}))},e.logoff=function(){return new e(107,[],(function(){return"LOGOFF"}))},e.begin=function(t){var n=void 0===t?{}:t,i=l(n.bookmarks,n.txConfig,n.database,n.mode,n.impersonatedUser,n.notificationFilter);return new e(17,[i],(function(){return"BEGIN ".concat(r.json.stringify(i))}))},e.begin5x5=function(t){var n=void 0===t?{}:t,i=l(n.bookmarks,n.txConfig,n.database,n.mode,n.impersonatedUser,n.notificationFilter,{appendNotificationFilter:f});return new e(17,[i],(function(){return"BEGIN ".concat(r.json.stringify(i))}))},e.commit=function(){return g},e.rollback=function(){return v},e.runWithMetadata=function(t,n,i){var o=void 0===i?{}:i,s=l(o.bookmarks,o.txConfig,o.database,o.mode,o.impersonatedUser,o.notificationFilter);return new e(16,[t,n,s],(function(){return"RUN ".concat(t," ").concat(r.json.stringify(n)," ").concat(r.json.stringify(s))}))},e.runWithMetadata5x5=function(t,n,i){var o=void 0===i?{}:i,s=l(o.bookmarks,o.txConfig,o.database,o.mode,o.impersonatedUser,o.notificationFilter,{appendNotificationFilter:f});return new e(16,[t,n,s],(function(){return"RUN ".concat(t," ").concat(r.json.stringify(n)," ").concat(r.json.stringify(s))}))},e.goodbye=function(){return y},e.pull=function(t){var n=void 0===t?{}:t,i=n.stmtId,o=void 0===i?-1:i,a=n.n,u=h(null==o?-1:o,(void 0===a?s:a)||s);return new e(63,[u],(function(){return"PULL ".concat(r.json.stringify(u))}))},e.discard=function(t){var n=void 0===t?{}:t,i=n.stmtId,o=void 0===i?-1:i,a=n.n,u=h(null==o?-1:o,(void 0===a?s:a)||s);return new e(47,[u],(function(){return"DISCARD ".concat(r.json.stringify(u))}))},e.telemetry=function(t){var n=t.api,i=(0,r.int)(n);return new e(84,[i],(function(){return"TELEMETRY ".concat(i.toString())}))},e.route=function(t,n,i){return void 0===t&&(t={}),void 0===n&&(n=[]),void 0===i&&(i=null),new e(102,[t,n,i],(function(){return"ROUTE ".concat(r.json.stringify(t)," ").concat(r.json.stringify(n)," ").concat(i)}))},e.routeV4x4=function(t,n,i){void 0===t&&(t={}),void 0===n&&(n=[]),void 0===i&&(i={});var o={};return i.databaseName&&(o.db=i.databaseName),i.impersonatedUser&&(o.imp_user=i.impersonatedUser),new e(102,[t,n,o],(function(){return"ROUTE ".concat(r.json.stringify(t)," ").concat(r.json.stringify(n)," ").concat(r.json.stringify(o))}))},e}();function l(e,t,n,r,i,s,u){var c;void 0===u&&(u={});var l={};return e.isEmpty()||(l.bookmarks=e.values()),null!==t.timeout&&(l.tx_timeout=t.timeout),t.metadata&&(l.tx_metadata=t.metadata),n&&(l.db=a(n,"database")),i&&(l.imp_user=a(i,"impersonatedUser")),r===o&&(l.mode="r"),(null!==(c=u.appendNotificationFilter)&&void 0!==c?c:d)(l,s),l}function h(e,t){var n={n:(0,r.int)(t)};return-1!==e&&(n.qid=(0,r.int)(e)),n}function d(e,t){t&&(t.minimumSeverityLevel&&(e.notifications_minimum_severity=t.minimumSeverityLevel),t.disabledCategories&&(e.notifications_disabled_categories=t.disabledCategories),t.disabledClassifications&&(e.notifications_disabled_categories=t.disabledClassifications))}function f(e,t){t&&(t.minimumSeverityLevel&&(e.notifications_minimum_severity=t.minimumSeverityLevel),t.disabledCategories&&(e.notifications_disabled_classifications=t.disabledCategories),t.disabledClassifications&&(e.notifications_disabled_classifications=t.disabledClassifications))}t.default=c;var p=new c(63,[],(function(){return"PULL_ALL"})),m=new c(15,[],(function(){return"RESET"})),g=new c(18,[],(function(){return"COMMIT"})),v=new c(19,[],(function(){return"ROLLBACK"})),y=new c(2,[],(function(){return"GOODBYE"}))},28851:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(41264);function i(){}function o(e){return e}var s={onNext:i,onCompleted:i,onError:i},a=function(){function e(e){var t=void 0===e?{}:e,n=t.transformMetadata,r=t.enrichErrorMetadata,s=t.log,a=t.observer;this._pendingObservers=[],this._log=s,this._transformMetadata=n||o,this._enrichErrorMetadata=r||o,this._observer=Object.assign({onObserversCountChange:i,onError:i,onFailure:i,onErrorApplyTransformation:o},a)}return Object.defineProperty(e.prototype,"currentFailure",{get:function(){return this._currentFailure},enumerable:!1,configurable:!0}),e.prototype.handleResponse=function(e){var t=e.fields[0];switch(e.signature){case 113:this._log.isDebugEnabled()&&this._log.debug("S: RECORD ".concat(r.json.stringify(e))),this._currentObserver.onNext(t);break;case 112:this._log.isDebugEnabled()&&this._log.debug("S: SUCCESS ".concat(r.json.stringify(e)));try{var n=this._transformMetadata(t);this._currentObserver.onCompleted(n)}finally{this._updateCurrentObserver()}break;case 127:this._log.isDebugEnabled()&&this._log.debug("S: FAILURE ".concat(r.json.stringify(e)));try{this._currentFailure=this._handleErrorPayload(this._enrichErrorMetadata(t)),this._currentObserver.onError(this._currentFailure)}finally{this._updateCurrentObserver(),this._observer.onFailure(this._currentFailure)}break;case 126:this._log.isDebugEnabled()&&this._log.debug("S: IGNORED ".concat(r.json.stringify(e)));try{this._currentFailure&&this._currentObserver.onError?this._currentObserver.onError(this._currentFailure):this._currentObserver.onError&&this._currentObserver.onError((0,r.newError)("Ignored either because of an error or RESET"))}finally{this._updateCurrentObserver()}break;default:this._observer.onError((0,r.newError)("Unknown Bolt protocol message: "+e))}},e.prototype._updateCurrentObserver=function(){this._currentObserver=this._pendingObservers.shift(),this._observer.onObserversCountChange(this._observersCount)},Object.defineProperty(e.prototype,"_observersCount",{get:function(){return null==this._currentObserver?this._pendingObservers.length:this._pendingObservers.length+1},enumerable:!1,configurable:!0}),e.prototype._queueObserver=function(e){return(e=e||s).onCompleted=e.onCompleted||i,e.onError=e.onError||i,e.onNext=e.onNext||i,void 0===this._currentObserver?this._currentObserver=e:this._pendingObservers.push(e),this._observer.onObserversCountChange(this._observersCount),!0},e.prototype._notifyErrorToObservers=function(e){for(this._currentObserver&&this._currentObserver.onError&&this._currentObserver.onError(e);this._pendingObservers.length>0;){var t=this._pendingObservers.shift();t&&t.onError&&t.onError(e)}},e.prototype.hasOngoingObservableRequests=function(){return null!=this._currentObserver||this._pendingObservers.length>0},e.prototype._resetFailure=function(){this._currentFailure=null},e.prototype._handleErrorPayload=function(e){var t=function(e){if("Neo.TransientError.Transaction.Terminated"===e)return"Neo.ClientError.Transaction.Terminated";if("Neo.TransientError.Transaction.LockClientStopped"===e)return"Neo.ClientError.Transaction.LockClientStopped";return e}(e.code),n=null!=e.cause?this._handleErrorCause(e.cause):void 0,i=(0,r.newError)(e.message,t,n,e.gql_status,e.description,e.diagnostic_record);return this._observer.onErrorApplyTransformation(i)},e.prototype._handleErrorCause=function(e){var t=null!=e.cause?this._handleErrorCause(e.cause):void 0,n=(0,r.newGQLError)(e.message,t,e.gql_status,e.description,e.diagnostic_record);return this._observer.onErrorApplyTransformation(n)},e}();t.default=a},72225:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});o(n(41264));var s=function(){function e(){}return e.ofRecord=function(t){return null===t?e.ofNull():new c(t)},e.ofMessageResponse=function(t){return null===t?e.ofNull():new a(t)},e.ofNull=function(){return new u},Object.defineProperty(e.prototype,"ttl",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"db",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"servers",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isNull",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),e}();t.default=s;var a=function(e){function t(t){var n=e.call(this)||this;return n._response=t,n}return i(t,e),Object.defineProperty(t.prototype,"ttl",{get:function(){return this._response.rt.ttl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"servers",{get:function(){return this._response.rt.servers},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"db",{get:function(){return this._response.rt.db},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isNull",{get:function(){return null===this._response},enumerable:!1,configurable:!0}),t}(s),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"isNull",{get:function(){return!0},enumerable:!1,configurable:!0}),t}(s),c=function(e){function t(t){var n=e.call(this)||this;return n._record=t,n}return i(t,e),Object.defineProperty(t.prototype,"ttl",{get:function(){return this._record.get("ttl")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"servers",{get:function(){return this._record.get("servers")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"db",{get:function(){return this._record.has("db")?this._record.get("db"):null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isNull",{get:function(){return null===this._record},enumerable:!1,configurable:!0}),t}(s)},6599:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryObserver=t.ProcedureRouteObserver=t.RouteObserver=t.CompletedObserver=t.FailedObserver=t.ResetObserver=t.LogoffObserver=t.LoginObserver=t.ResultStreamObserver=t.StreamObserver=void 0;var s=n(41264),a=o(n(72225)),u=n(31028),c=s.internal.constants.FETCH_ALL,l=s.error.PROTOCOL_ERROR,h=function(){function e(){}return e.prototype.onNext=function(e){},e.prototype.onError=function(e){},e.prototype.onCompleted=function(e){},e}();t.StreamObserver=h;var d=function(e){function t(t){var n=void 0===t?{}:t,r=n.reactive,i=void 0!==r&&r,o=n.moreFunction,s=n.discardFunction,a=n.fetchSize,l=void 0===a?c:a,h=n.beforeError,d=n.afterError,f=n.beforeKeys,p=n.afterKeys,m=n.beforeComplete,g=n.afterComplete,v=n.server,y=n.highRecordWatermark,b=void 0===y?Number.MAX_VALUE:y,_=n.lowRecordWatermark,w=void 0===_?Number.MAX_VALUE:_,S=n.enrichMetadata,E=e.call(this)||this;return E._fieldKeys=null,E._fieldLookup=null,E._head=null,E._queuedRecords=[],E._tail=null,E._error=null,E._observers=[],E._meta={},E._server=v,E._beforeError=h,E._afterError=d,E._beforeKeys=f,E._afterKeys=p,E._beforeComplete=m,E._afterComplete=g,E._enrichMetadata=S||u.functional.identity,E._queryId=null,E._moreFunction=o,E._discardFunction=s,E._discard=!1,E._fetchSize=l,E._lowRecordWatermark=w,E._highRecordWatermark=b,E._setState(i?x.READY:x.READY_STREAMING),E._setupAutoPull(),E._paused=!1,E._pulled=!i,E._haveRecordStreamed=!1,E}return i(t,e),t.prototype.pause=function(){this._paused=!0},t.prototype.resume=function(){this._paused=!1,this._setupAutoPull(!0),this._state.pull(this)},t.prototype.onNext=function(e){this._haveRecordStreamed=!0;var t=new s.Record(this._fieldKeys,e,this._fieldLookup);this._observers.some((function(e){return e.onNext}))?this._observers.forEach((function(e){e.onNext&&e.onNext(t)})):(this._queuedRecords.push(t),this._queuedRecords.length>this._highRecordWatermark&&(this._autoPull=!1))},t.prototype.onCompleted=function(e){this._state.onSuccess(this,e)},t.prototype.onError=function(e){this._state.onError(this,e)},t.prototype.cancel=function(){this._discard=!0},t.prototype.prepareToHandleSingleResponse=function(){this._head=[],this._fieldKeys=[],this._setState(x.STREAMING)},t.prototype.markCompleted=function(){this._head=[],this._fieldKeys=[],this._tail={},this._setState(x.SUCCEEDED)},t.prototype.subscribe=function(e){if(this._head&&e.onKeys&&e.onKeys(this._head),this._queuedRecords.length>0&&e.onNext)for(var t=0;t<this._queuedRecords.length;t++)e.onNext(this._queuedRecords[t]),this._queuedRecords.length-t-1<=this._lowRecordWatermark&&(this._autoPull=!0,this._state===x.READY&&this._handleStreaming());this._tail&&e.onCompleted&&e.onCompleted(this._tail),this._error&&e.onError(this._error),this._observers.push(e),this._state===x.READY&&this._handleStreaming()},t.prototype._handleHasMore=function(e){this._setState(x.READY),this._handleStreaming(),delete e.has_more},t.prototype._handlePullSuccess=function(e){var t=this,n=this._enrichMetadata(Object.assign(this._server?{server:this._server}:{},this._meta,{stream_summary:{have_records_streamed:this._haveRecordStreamed,pulled:this._pulled,has_keys:this._fieldKeys.length>0}},e));if([void 0,null,"r","w","rw","s"].includes(n.type)){this._setState(x.SUCCEEDED);var r=null;this._beforeComplete&&(r=this._beforeComplete(n));var i=function(){t._tail=n,t._observers.some((function(e){return e.onCompleted}))&&t._observers.forEach((function(e){e.onCompleted&&e.onCompleted(n)})),t._afterComplete&&t._afterComplete(n)};r?Promise.resolve(r).then((function(){return i()})):i()}else this.onError((0,s.newError)('Server returned invalid query type. Expected one of [undefined, null, "r", "w", "rw", "s"] but got \''.concat(n.type,"'"),l))},t.prototype._handleRunSuccess=function(e,t){var n=this;if(null===this._fieldKeys){if(this._fieldKeys=[],this._fieldLookup={},e.fields&&e.fields.length>0){this._fieldKeys=e.fields;for(var r=0;r<e.fields.length;r++)this._fieldLookup[e.fields[r]]=r}null!=e.fields&&delete e.fields,null!==e.qid&&void 0!==e.qid&&(this._queryId=e.qid,delete e.qid),this._storeMetadataForCompletion(e);var i=null;this._beforeKeys&&(i=this._beforeKeys(this._fieldKeys));var o=function(){n._head=n._fieldKeys,n._observers.some((function(e){return e.onKeys}))&&n._observers.forEach((function(e){e.onKeys&&e.onKeys(n._fieldKeys)})),n._afterKeys&&n._afterKeys(n._fieldKeys),t()};i?Promise.resolve(i).then((function(){return o()})):o()}},t.prototype._handleError=function(e){var t=this;this._setState(x.FAILED),this._error=e;var n=null;this._beforeError&&(n=this._beforeError(e));var r=function(){t._observers.some((function(e){return e.onError}))&&t._observers.forEach((function(t){t.onError&&t.onError(e)})),t._afterError&&t._afterError(e)};n?Promise.resolve(n).then((function(){return r()})):r()},t.prototype._handleStreaming=function(){this._head&&this._observers.some((function(e){return e.onNext||e.onCompleted}))&&(this._paused||!this._discard&&!this._autoPull||this._more())},t.prototype._more=function(){this._discard?this._discardFunction(this._queryId,this):(this._pulled=!0,this._moreFunction(this._queryId,this._fetchSize,this)),this._setState(x.STREAMING)},t.prototype._storeMetadataForCompletion=function(e){for(var t=Object.keys(e),n=t.length,r="";n--;)r=t[n],this._meta[r]=e[r]},t.prototype._setState=function(e){this._state=e},t.prototype._setupAutoPull=function(){this._autoPull=!0},t}(h);t.ResultStreamObserver=d;var f=function(e){function t(t){var n=void 0===t?{}:t,r=n.onError,i=n.onCompleted,o=e.call(this)||this;return o._onError=r,o._onCompleted=i,o}return i(t,e),t.prototype.onNext=function(e){this.onError((0,s.newError)("Received RECORD when initializing "+s.json.stringify(e)))},t.prototype.onError=function(e){this._onError&&this._onError(e)},t.prototype.onCompleted=function(e){this._onCompleted&&this._onCompleted(e)},t}(h);t.LoginObserver=f;var p=function(e){function t(t){var n=void 0===t?{}:t,r=n.onError,i=n.onCompleted,o=e.call(this)||this;return o._onError=r,o._onCompleted=i,o}return i(t,e),t.prototype.onNext=function(e){this.onError((0,s.newError)("Received RECORD when logging off "+s.json.stringify(e)))},t.prototype.onError=function(e){this._onError&&this._onError(e)},t.prototype.onCompleted=function(e){this._onCompleted&&this._onCompleted(e)},t}(h);t.LogoffObserver=p;var m=function(e){function t(t){var n=void 0===t?{}:t,r=n.onProtocolError,i=n.onError,o=n.onComplete,s=e.call(this)||this;return s._onProtocolError=r,s._onError=i,s._onComplete=o,s}return i(t,e),t.prototype.onNext=function(e){this.onError((0,s.newError)("Received RECORD when resetting: received record is: "+s.json.stringify(e),l))},t.prototype.onError=function(e){e.code===l&&this._onProtocolError&&this._onProtocolError(e.message),this._onError&&this._onError(e)},t.prototype.onCompleted=function(e){this._onComplete&&this._onComplete(e)},t}(h);t.ResetObserver=m;var g=function(e){function t(t){var n=void 0===t?{}:t,r=n.onError,i=n.onCompleted,o=e.call(this)||this;return o._onError=r,o._onCompleted=i,o}return i(t,e),t.prototype.onNext=function(e){this.onError((0,s.newError)("Received RECORD when sending telemetry "+s.json.stringify(e),l))},t.prototype.onError=function(e){this._onError&&this._onError(e)},t.prototype.onCompleted=function(e){this._onCompleted&&this._onCompleted(e)},t}(d);t.TelemetryObserver=g;var v=function(e){function t(t){var n=t.error,r=t.onError,i=e.call(this,{beforeError:r})||this;return i.onError(n),i}return i(t,e),t}(d);t.FailedObserver=v;var y=function(e){function t(){var t=e.call(this)||this;return e.prototype.markCompleted.call(t),t}return i(t,e),t}(d);t.CompletedObserver=y;var b=function(e){function t(t){var n=t.resultObserver,r=t.onProtocolError,i=t.onError,o=t.onCompleted,s=e.call(this)||this;return s._resultObserver=n,s._onError=i,s._onCompleted=o,s._records=[],s._onProtocolError=r,n.subscribe(s),s}return i(t,e),t.prototype.onNext=function(e){this._records.push(e)},t.prototype.onError=function(e){e.code===l&&this._onProtocolError&&this._onProtocolError(e.message),this._onError&&this._onError(e)},t.prototype.onCompleted=function(){null===this._records||1===this._records.length?this._onCompleted&&this._onCompleted(a.default.ofRecord(this._records[0])):this.onError((0,s.newError)("Illegal response from router. Received "+this._records.length+" records but expected only one.\n"+s.json.stringify(this._records),l))},t}(h);t.ProcedureRouteObserver=b;var _=function(e){function t(t){var n=void 0===t?{}:t,r=n.onProtocolError,i=n.onError,o=n.onCompleted,s=e.call(this)||this;return s._onProtocolError=r,s._onError=i,s._onCompleted=o,s}return i(t,e),t.prototype.onNext=function(e){this.onError((0,s.newError)("Received RECORD when resetting: received record is: "+s.json.stringify(e),l))},t.prototype.onError=function(e){e.code===l&&this._onProtocolError&&this._onProtocolError(e.message),this._onError&&this._onError(e)},t.prototype.onCompleted=function(e){this._onCompleted&&this._onCompleted(a.default.ofMessageResponse(e))},t}(h);t.RouteObserver=_;var x={READY_STREAMING:{onSuccess:function(e,t){e._handleRunSuccess(t,(function(){e._setState(x.STREAMING)}))},onError:function(e,t){e._handleError(t)},name:function(){return"READY_STREAMING"},pull:function(){}},READY:{onSuccess:function(e,t){e._handleRunSuccess(t,(function(){return e._handleStreaming()}))},onError:function(e,t){e._handleError(t)},name:function(){return"READY"},pull:function(e){return e._more()}},STREAMING:{onSuccess:function(e,t){t.has_more?e._handleHasMore(t):e._handlePullSuccess(t)},onError:function(e,t){e._handleError(t)},name:function(){return"STREAMING"},pull:function(){}},FAILED:{onError:function(e){},name:function(){return"FAILED"},pull:function(){}},SUCCEEDED:{name:function(){return"SUCCEEDED"},pull:function(){}}}},2253:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.epochSecondAndNanoToLocalDateTime=t.nanoOfDayToLocalTime=t.epochDayToDate=void 0;var r=n(41264),i=r.internal.temporalUtil,o=i.DAYS_0000_TO_1970,s=i.DAYS_PER_400_YEAR_CYCLE,a=i.NANOS_PER_HOUR,u=i.NANOS_PER_MINUTE,c=i.NANOS_PER_SECOND,l=i.SECONDS_PER_DAY,h=i.floorDiv,d=i.floorMod;function f(e){var t=(e=(0,r.int)(e)).add(o).subtract(60),n=(0,r.int)(0);if(t.lessThan(0)){var i=t.add(1).div(s).subtract(1);n=i.multiply(400),t=t.add(i.multiply(-s))}var a=t.multiply(400).add(591).div(s),u=t.subtract(a.multiply(365).add(a.div(4)).subtract(a.div(100)).add(a.div(400)));u.lessThan(0)&&(a=a.subtract(1),u=t.subtract(a.multiply(365).add(a.div(4)).subtract(a.div(100)).add(a.div(400)))),a=a.add(n);var c=u,l=c.multiply(5).add(2).div(153),h=l.add(2).modulo(12).add(1),d=c.subtract(l.multiply(306).add(5).div(10)).add(1);return a=a.add(l.div(10)),new r.Date(a,h,d)}function p(e){var t=(e=(0,r.int)(e)).div(a),n=(e=e.subtract(t.multiply(a))).div(u),i=(e=e.subtract(n.multiply(u))).div(c),o=e.subtract(i.multiply(c));return new r.LocalTime(t,n,i,o)}t.epochDayToDate=f,t.nanoOfDayToLocalTime=p,t.epochSecondAndNanoToLocalDateTime=function(e,t){var n=h(e,l),i=d(e,l).multiply(c).add(t),o=f(n),s=p(i);return new r.LocalDateTime(o.year,o.month,o.day,s.hour,s.minute,s.second,s.nanosecond)}},1120:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeTransformer=void 0;var r=n(62047),i=n(41264).internal.objectUtil,o=function(){function e(e){this._transformers=e,this._transformersPerSignature=new Map(e.map((function(e){return[e.signature,e]}))),this.fromStructure=this.fromStructure.bind(this),this.toStructure=this.toStructure.bind(this),Object.freeze(this)}return e.prototype.fromStructure=function(e){try{return e instanceof r.structure.Structure&&this._transformersPerSignature.has(e.signature)?(0,this._transformersPerSignature.get(e.signature).fromStructure)(e):e}catch(e){return i.createBrokenObject(e)}},e.prototype.toStructure=function(e){var t=this._transformers.find((function(t){return(0,t.isTypeInstance)(e)}));return void 0!==t?t.toStructure(e):e},e}();t.default=o;var s=function(){function e(e){var t=e.signature,n=e.fromStructure,r=e.toStructure,i=e.isTypeInstance;this.signature=t,this.isTypeInstance=i,this.fromStructure=n,this.toStructure=r,Object.freeze(this)}return e.prototype.extendsWith=function(t){var n=t.signature,r=t.fromStructure,i=t.toStructure,o=t.isTypeInstance;return new e({signature:n||this.signature,fromStructure:r||this.fromStructure,toStructure:i||this.toStructure,isTypeInstance:o||this.isTypeInstance})},e}();t.TypeTransformer=s},40966:function(e,t){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.position=0,this.length=e}return e.prototype.getUInt8=function(e){throw new Error("Not implemented")},e.prototype.getInt8=function(e){throw new Error("Not implemented")},e.prototype.getFloat64=function(e){throw new Error("Not implemented")},e.prototype.putUInt8=function(e,t){throw new Error("Not implemented")},e.prototype.putInt8=function(e,t){throw new Error("Not implemented")},e.prototype.putFloat64=function(e,t){throw new Error("Not implemented")},e.prototype.getInt16=function(e){return this.getInt8(e)<<8|this.getUInt8(e+1)},e.prototype.getUInt16=function(e){return this.getUInt8(e)<<8|this.getUInt8(e+1)},e.prototype.getInt32=function(e){return this.getInt8(e)<<24|this.getUInt8(e+1)<<16|this.getUInt8(e+2)<<8|this.getUInt8(e+3)},e.prototype.getUInt32=function(e){return this.getUInt8(e)<<24|this.getUInt8(e+1)<<16|this.getUInt8(e+2)<<8|this.getUInt8(e+3)},e.prototype.getInt64=function(e){return this.getInt8(e)<<56|this.getUInt8(e+1)<<48|this.getUInt8(e+2)<<40|this.getUInt8(e+3)<<32|this.getUInt8(e+4)<<24|this.getUInt8(e+5)<<16|this.getUInt8(e+6)<<8|this.getUInt8(e+7)},e.prototype.getSlice=function(e,t){return new o(e,t,this)},e.prototype.putInt16=function(e,t){this.putInt8(e,t>>8),this.putUInt8(e+1,255&t)},e.prototype.putUInt16=function(e,t){this.putUInt8(e,t>>8&255),this.putUInt8(e+1,255&t)},e.prototype.putInt32=function(e,t){this.putInt8(e,t>>24),this.putUInt8(e+1,t>>16&255),this.putUInt8(e+2,t>>8&255),this.putUInt8(e+3,255&t)},e.prototype.putUInt32=function(e,t){this.putUInt8(e,t>>24&255),this.putUInt8(e+1,t>>16&255),this.putUInt8(e+2,t>>8&255),this.putUInt8(e+3,255&t)},e.prototype.putInt64=function(e,t){this.putInt8(e,t>>48),this.putUInt8(e+1,t>>42&255),this.putUInt8(e+2,t>>36&255),this.putUInt8(e+3,t>>30&255),this.putUInt8(e+4,t>>24&255),this.putUInt8(e+5,t>>16&255),this.putUInt8(e+6,t>>8&255),this.putUInt8(e+7,255&t)},e.prototype.putBytes=function(e,t){for(var n=0,r=t.remaining();n<r;n++)this.putUInt8(e+n,t.readUInt8())},e.prototype.readUInt8=function(){return this.getUInt8(this._updatePos(1))},e.prototype.readInt8=function(){return this.getInt8(this._updatePos(1))},e.prototype.readUInt16=function(){return this.getUInt16(this._updatePos(2))},e.prototype.readUInt32=function(){return this.getUInt32(this._updatePos(4))},e.prototype.readInt16=function(){return this.getInt16(this._updatePos(2))},e.prototype.readInt32=function(){return this.getInt32(this._updatePos(4))},e.prototype.readInt64=function(){return this.getInt32(this._updatePos(8))},e.prototype.readFloat64=function(){return this.getFloat64(this._updatePos(8))},e.prototype.writeUInt8=function(e){this.putUInt8(this._updatePos(1),e)},e.prototype.writeInt8=function(e){this.putInt8(this._updatePos(1),e)},e.prototype.writeInt16=function(e){this.putInt16(this._updatePos(2),e)},e.prototype.writeInt32=function(e){this.putInt32(this._updatePos(4),e)},e.prototype.writeUInt32=function(e){this.putUInt32(this._updatePos(4),e)},e.prototype.writeInt64=function(e){this.putInt64(this._updatePos(8),e)},e.prototype.writeFloat64=function(e){this.putFloat64(this._updatePos(8),e)},e.prototype.writeBytes=function(e){this.putBytes(this._updatePos(e.remaining()),e)},e.prototype.readSlice=function(e){return this.getSlice(this._updatePos(e),e)},e.prototype._updatePos=function(e){var t=this.position;return this.position+=e,t},e.prototype.remaining=function(){return this.length-this.position},e.prototype.hasRemaining=function(){return this.remaining()>0},e.prototype.reset=function(){this.position=0},e.prototype.toString=function(){return this.constructor.name+"( position="+this.position+" )\n  "+this.toHex()},e.prototype.toHex=function(){for(var e="",t=0;t<this.length;t++){var n=this.getUInt8(t).toString(16);1===n.length&&(n="0"+n),e+=n,t!==this.length-1&&(e+=" ")}return e},e}();t.default=i;var o=function(e){function t(t,n,r){var i=e.call(this,n)||this;return i._start=t,i._inner=r,i}return r(t,e),t.prototype.putUInt8=function(e,t){this._inner.putUInt8(this._start+e,t)},t.prototype.getUInt8=function(e){return this._inner.getUInt8(this._start+e)},t.prototype.putInt8=function(e,t){this._inner.putInt8(this._start+e,t)},t.prototype.putFloat64=function(e,t){this._inner.putFloat64(this._start+e,t)},t.prototype.getInt8=function(e){return this._inner.getInt8(this._start+e)},t.prototype.getFloat64=function(e){return this._inner.getFloat64(this._start+e)},t}(i)},16026:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseBuffer=void 0;var i=r(n(40966));t.BaseBuffer=i.default,t.default=i.default},35057:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(49235)),o=n(41264),s=o.internal.util,a=s.ENCRYPTION_OFF,u=s.ENCRYPTION_ON,c=function(){function e(e,t,n){void 0===t&&(t=l),void 0===n&&(n=function(e){return new WebSocket(e)});var r=this;this._open=!0,this._pending=[],this._error=null,this._handleConnectionError=this._handleConnectionError.bind(this),this._config=e,this._receiveTimeout=null,this._receiveTimeoutStarted=!1,this._receiveTimeoutId=null,this._closingPromise=null;var s=function(e,t){var n=function(e){return!0===e.encrypted||e.encrypted===u}(e),r=function(e){return!1===e.encrypted||e.encrypted===a}(e),i=e.trust,s=function(e){var t="function"==typeof e?e():"";return t&&t.toLowerCase().indexOf("https")>=0}(t);if(function(e,t,n){null===n||(e&&!n?console.warn("Neo4j driver is configured to use secure WebSocket on a HTTP web page. WebSockets might not work in a mixed content environment. Please consider configuring driver to not use encryption."):t&&n&&console.warn("Neo4j driver is configured to use insecure WebSocket on a HTTPS web page. WebSockets might not work in a mixed content environment. Please consider configuring driver to use encryption."))}(n,r,s),r)return{scheme:"ws",error:null};if(s)return{scheme:"wss",error:null};if(n){return i&&"TRUST_SYSTEM_CA_SIGNED_CERTIFICATES"!==i?{scheme:null,error:(0,o.newError)("The browser version of this driver only supports one trust strategy, 'TRUST_SYSTEM_CA_SIGNED_CERTIFICATES'. "+i+' is not supported. Please either use TRUST_SYSTEM_CA_SIGNED_CERTIFICATES or disable encryption by setting `encrypted:"'+a+'"` in the driver configuration.')}:{scheme:"wss",error:null}}return{scheme:"ws",error:null}}(e,t),c=s.scheme,h=s.error;if(h)this._error=h;else{this._ws=function(e,t,n){var r=e+"://"+t.asHostPort();try{return n(r)}catch(r){if(function(e,t){return"SyntaxError"===e.name&&(n=t.asHostPort(),"["===n.charAt(0)&&-1!==n.indexOf("]"));var n}(r,t)){var i=function(e,t){var n=t.host().replace(/:/g,"-"),r=n.replace("%","s")+".ipv6-literal.net";return"".concat(e,"://").concat(r,":").concat(t.port())}(e,t);return n(i)}throw r}}(c,e.address,n),this._ws.binaryType="arraybuffer";var d=this;this._ws.onclose=function(e){e&&!e.wasClean&&d._handleConnectionError(),d._open=!1},this._ws.onopen=function(){d._clearConnectionTimeout();var e=d._pending;d._pending=null;for(var t=0;t<e.length;t++)d.write(e[t])},this._ws.onmessage=function(e){if(r._resetTimeout(),d.onmessage){var t=new i.default(e.data);d.onmessage(t)}},this._ws.onerror=this._handleConnectionError,this._connectionTimeoutFired=!1,this._connectionTimeoutId=this._setupConnectionTimeout()}}return e.prototype._handleConnectionError=function(){if(this._connectionTimeoutFired)return this._error=(0,o.newError)("Failed to establish connection in ".concat(this._config.connectionTimeout,"ms"),this._config.connectionErrorCode),void(this.onerror&&this.onerror(this._error));this._open&&!this._timedout&&(this._error=(0,o.newError)("WebSocket connection failure. Due to security constraints in your web browser, the reason for the failure is not available to this Neo4j Driver. Please use your browsers development console to determine the root cause of the failure. Common reasons include the database being unavailable, using the wrong connection URL or temporary network problems. If you have enabled encryption, ensure your browser is configured to trust the certificate Neo4j is configured to use. WebSocket `readyState` is: "+this._ws.readyState,this._config.connectionErrorCode),this.onerror&&this.onerror(this._error))},e.prototype.write=function(e){if(null!==this._pending)this._pending.push(e);else{if(!(e instanceof i.default))throw(0,o.newError)("Don't know how to send buffer: "+e);try{this._ws.send(e._buffer)}catch(e){if(1===this._ws.readyState)throw e;this._handleConnectionError()}}},e.prototype.close=function(){var e=this;return null===this._closingPromise&&(this._closingPromise=new Promise((function(t,n){e._clearConnectionTimeout(),e._ws&&3!==e._ws.readyState?(e._open=!1,e.stopReceiveTimeout(),e._ws.onclose=function(){t()},e._ws.close()):t()}))),this._closingPromise},e.prototype.setupReceiveTimeout=function(e){this._receiveTimeout=e},e.prototype.stopReceiveTimeout=function(){null!==this._receiveTimeout&&this._receiveTimeoutStarted&&(this._receiveTimeoutStarted=!1,null!=this._receiveTimeoutId&&clearTimeout(this._receiveTimeoutId),this._receiveTimeoutId=null)},e.prototype.startReceiveTimeout=function(){this._open&&null!==this._receiveTimeout&&!this._receiveTimeoutStarted&&(this._receiveTimeoutStarted=!0,this._resetTimeout())},e.prototype._resetTimeout=function(){var e=this;this._receiveTimeoutStarted&&(null!==this._receiveTimeoutId&&clearTimeout(this._receiveTimeoutId),this._receiveTimeoutId=setTimeout((function(){e._receiveTimeoutId=null,e._timedout=!0,e.stopReceiveTimeout(),e._error=(0,o.newError)("Connection lost. Server didn't respond in ".concat(e._receiveTimeout,"ms"),e._config.connectionErrorCode),e.close(),e.onerror&&e.onerror(e._error)}),this._receiveTimeout))},e.prototype._setupConnectionTimeout=function(){var e=this,t=this._config.connectionTimeout;if(t){var n=this._ws;return setTimeout((function(){1!==n.readyState&&(e._connectionTimeoutFired=!0,n.close())}),t)}return null},e.prototype._clearConnectionTimeout=function(){var e=this._connectionTimeoutId;(e||0===e)&&(this._connectionTimeoutFired=!1,this._connectionTimeoutId=null,clearTimeout(e))},e}();function l(){return"undefined"!=typeof window&&window.location?window.location.protocol:null}t.default=c},47029:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.default={load:function(e){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2,e]}))}))}}},21524:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.resolve=function(e){return this._resolveToItself(e)},t}(n(41264).internal.resolver.BaseHostNameResolver);t.default=o},58194:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ClientCertificatesLoader=t.HostNameResolver=t.Channel=void 0;var i=r(n(35057)),o=r(n(21524)),s=r(n(47029));t.Channel=i.default,t.HostNameResolver=o.default,t.ClientCertificatesLoader=s.default},49235:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.alloc=void 0;var s=o(n(55872)),a=function(e){function t(t){var n=this,r=function(e){return e instanceof s.default.Buffer?e:"number"==typeof e&&"function"==typeof s.default.Buffer.alloc?s.default.Buffer.alloc(e):new s.default.Buffer(e)}(t);return(n=e.call(this,r.length)||this)._buffer=r,n}return i(t,e),t.prototype.getUInt8=function(e){return this._buffer.readUInt8(e)},t.prototype.getInt8=function(e){return this._buffer.readInt8(e)},t.prototype.getFloat64=function(e){return this._buffer.readDoubleBE(e)},t.prototype.putUInt8=function(e,t){this._buffer.writeUInt8(t,e)},t.prototype.putInt8=function(e,t){this._buffer.writeInt8(t,e)},t.prototype.putFloat64=function(e,t){this._buffer.writeDoubleBE(t,e)},t.prototype.putBytes=function(n,r){if(r instanceof t){var i=Math.min(r.length-r.position,this.length-n);r._buffer.copy(this._buffer,n,r.position,r.position+i),r.position+=i}else e.prototype.putBytes.call(this,n,r)},t.prototype.getSlice=function(e,n){return new t(this._buffer.slice(e,e+n))},t}(o(n(16026)).default);t.default=a,t.alloc=function(e){return new a(e)}},67414:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(41264),i=r.internal.util,o=i.ENCRYPTION_OFF,s=i.ENCRYPTION_ON,a=r.error.SERVICE_UNAVAILABLE,u=[null,void 0,!0,!1,s,o],c=[null,void 0,"TRUST_ALL_CERTIFICATES","TRUST_CUSTOM_CA_SIGNED_CERTIFICATES","TRUST_SYSTEM_CA_SIGNED_CERTIFICATES"],l=function(e,t,n,i){this.address=e,this.encrypted=function(e){var t=e.encrypted;if(-1===u.indexOf(t))throw(0,r.newError)("Illegal value of the encrypted setting ".concat(t,". Expected one of ").concat(u));return t}(t),this.trust=function(e){var t=e.trust;if(-1===c.indexOf(t))throw(0,r.newError)("Illegal value of the trust setting ".concat(t,". Expected one of ").concat(c));return t}(t),this.trustedCertificates=function(e){return e.trustedCertificates||[]}(t),this.knownHostsPath=function(e){return e.knownHosts||null}(t),this.connectionErrorCode=n||a,this.connectionTimeout=t.connectionTimeout,this.clientCertificate=i};t.default=l},15949:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Dechunker=t.Chunker=void 0;var s=o(n(40966)),a=n(49235),u=o(n(14485)),c=function(e){function t(t,n){var r=e.call(this,0)||this;return r._bufferSize=n||1400,r._ch=t,r._buffer=(0,a.alloc)(r._bufferSize),r._currentChunkStart=0,r._chunkOpen=!1,r}return i(t,e),t.prototype.putUInt8=function(e,t){this._ensure(1),this._buffer.writeUInt8(t)},t.prototype.putInt8=function(e,t){this._ensure(1),this._buffer.writeInt8(t)},t.prototype.putFloat64=function(e,t){this._ensure(8),this._buffer.writeFloat64(t)},t.prototype.putBytes=function(e,t){for(;t.remaining()>0;)this._ensure(1),this._buffer.remaining()>t.remaining()?this._buffer.writeBytes(t):this._buffer.writeBytes(t.readSlice(this._buffer.remaining()));return this},t.prototype.flush=function(){if(this._buffer.position>0){this._closeChunkIfOpen();var e=this._buffer;this._buffer=null,this._ch.write(e.getSlice(0,e.position)),this._buffer=(0,a.alloc)(this._bufferSize),this._chunkOpen=!1}return this},t.prototype.messageBoundary=function(){this._closeChunkIfOpen(),this._buffer.remaining()<2&&this.flush(),this._buffer.writeInt16(0)},t.prototype._ensure=function(e){var t=this._chunkOpen?e:e+2;this._buffer.remaining()<t&&this.flush(),this._chunkOpen||(this._currentChunkStart=this._buffer.position,this._buffer.position=this._buffer.position+2,this._chunkOpen=!0)},t.prototype._closeChunkIfOpen=function(){if(this._chunkOpen){var e=this._buffer.position-(this._currentChunkStart+2);this._buffer.putUInt16(this._currentChunkStart,e),this._chunkOpen=!1}},t}(s.default);t.Chunker=c;var l=function(){function e(){this._currentMessage=[],this._partialChunkHeader=0,this._state=this.AWAITING_CHUNK}return e.prototype.AWAITING_CHUNK=function(e){return e.remaining()>=2?this._onHeader(e.readUInt16()):(this._partialChunkHeader=e.readUInt8()<<8,this.IN_HEADER)},e.prototype.IN_HEADER=function(e){return this._onHeader(65535&(this._partialChunkHeader|e.readUInt8()))},e.prototype.IN_CHUNK=function(e){return this._chunkSize<=e.remaining()?(this._currentMessage.push(e.readSlice(this._chunkSize)),this.AWAITING_CHUNK):(this._chunkSize-=e.remaining(),this._currentMessage.push(e.readSlice(e.remaining())),this.IN_CHUNK)},e.prototype.CLOSED=function(e){},e.prototype._onHeader=function(e){if(0===e){var t=void 0;switch(this._currentMessage.length){case 0:return this.AWAITING_CHUNK;case 1:t=this._currentMessage[0];break;default:t=new u.default(this._currentMessage)}return this._currentMessage=[],this.onmessage(t),this.AWAITING_CHUNK}return this._chunkSize=e,this.IN_CHUNK},e.prototype.write=function(e){for(;e.hasRemaining();)this._state=this._state(e)},e}();t.Dechunker=l},14485:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(16026),s=n(49235),a=function(e){function t(t){for(var n=this,r=0,i=0;i<t.length;i++)r+=t[i].length;return(n=e.call(this,r)||this)._buffers=t,n}return i(t,e),t.prototype.getUInt8=function(e){for(var t=0;t<this._buffers.length;t++){var n=this._buffers[t];if(!(e>=n.length))return n.getUInt8(e);e-=n.length}},t.prototype.getInt8=function(e){for(var t=0;t<this._buffers.length;t++){var n=this._buffers[t];if(!(e>=n.length))return n.getInt8(e);e-=n.length}},t.prototype.getFloat64=function(e){for(var t=(0,s.alloc)(8),n=0;n<8;n++)t.putUInt8(n,this.getUInt8(e+n));return t.getFloat64(0)},t}(o.BaseBuffer);t.default=a},68768:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.utf8=t.alloc=t.ChannelConfig=void 0,i(n(58194),t),i(n(15949),t);var s=n(67414);Object.defineProperty(t,"ChannelConfig",{enumerable:!0,get:function(){return o(s).default}});var a=n(49235);Object.defineProperty(t,"alloc",{enumerable:!0,get:function(){return a.alloc}});var u=n(26189);Object.defineProperty(t,"utf8",{enumerable:!0,get:function(){return o(u).default}})},26189:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(49235)),o=n(41264),s=r(n(55872)),a=new(n(72699).StringDecoder)("utf8");t.default={encode:function(e){return new i.default(function(e){return"function"==typeof s.default.Buffer.from?s.default.Buffer.from(e,"utf8"):new s.default.Buffer(e,"utf8")}(e))},decode:function(e,t){if(Object.prototype.hasOwnProperty.call(e,"_buffer"))return function(e,t){var n=e.position,r=n+t;return e.position=Math.min(r,e.length),e._buffer.toString("utf8",n,r)}(e,t);if(Object.prototype.hasOwnProperty.call(e,"_buffers"))return function(e,t){return function(e,t,n,r){var i=t,o=e.position;return e._updatePos(Math.min(t,e.length-o)),e._buffers.reduce((function(e,t){if(i<=0)return e;if(o>=t.length)return o-=t.length,"";t._updatePos(o-t.position);var r=Math.min(t.length-o,i),s=t.readSlice(r);return t._updatePos(r),i=Math.max(i-s.length,0),o=0,e+n(s)}),"")+r()}(e,t,(function(e){return a.write(e._buffer)}),(function(){return a.end()}))}(e,t);throw(0,o.newError)("Don't know how to decode strings from '".concat(e,"'"))}}},87100:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(41264),s=n(31028),a=function(){function e(e){var t=e.authTokenManager,n=e.userAgent,r=e.boltAgent;this._authTokenManager=t||(0,o.staticAuthTokenManager)({}),this._userAgent=n,this._boltAgent=r}return e.prototype.authenticate=function(e){var t=e.connection,n=e.auth,o=e.skipReAuth,a=e.waitReAuth,u=e.forceReAuth;return r(this,void 0,void 0,(function(){var e,r;return i(this,(function(i){switch(i.label){case 0:return null==n?[3,3]:(e=!0===t.supportsReAuth&&(!s.object.equals(t.authToken,n)&&!0!==o||!0===u),null==t.authToken||e?[4,t.connect(this._userAgent,this._boltAgent,n,a||!1)]:[3,2]);case 1:case 5:return[2,i.sent()];case 2:case 6:return[2,t];case 3:return[4,this._authTokenManager.getToken()];case 4:return r=i.sent(),s.object.equals(r,t.authToken)?[3,6]:[4,t.connect(this._userAgent,this._boltAgent,r,!1)]}}))}))},e.prototype.handleError=function(e){var t=e.connection,n=e.code;return!(!t||!n.startsWith("Neo.ClientError.Security."))&&this._authTokenManager.handleSecurityException(t.authToken,n)},e}();t.default=a},29859:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(68768),s=function(){function e(e){var t=e.clientCertificateProvider,n=e.loader;this._clientCertificateProvider=t,this._loader=n||o.ClientCertificatesLoader,this._clientCertificate=null}return e.prototype.getClientCertificate=function(){return r(this,void 0,void 0,(function(){var e,t,n=this;return i(this,(function(r){switch(r.label){case 0:return(e=null!=this._clientCertificateProvider)?(t=null==this._clientCertificate)?[3,2]:[4,this._clientCertificateProvider.hasUpdate()]:[3,3];case 1:t=r.sent(),r.label=2;case 2:e=t,r.label=3;case 3:return e&&(this._clientCertificate=Promise.resolve(this._clientCertificateProvider.getClientCertificate()).then(this._loader.load).then((function(e){return n._clientCertificate=e,n._clientCertificate})).catch((function(e){throw n._clientCertificate=null,e}))),[2,this._clientCertificate]}}))}))},e}();t.default=s},78216:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=a(n(56301)),c=n(39238),l=n(41264),h=l.internal.constants,d=h.BOLT_PROTOCOL_V3,f=h.BOLT_PROTOCOL_V4_0,p=h.BOLT_PROTOCOL_V4_4,m=h.BOLT_PROTOCOL_V5_1,g=l.error.SERVICE_UNAVAILABLE,v=function(e){function t(t){var n=t.id,r=t.config,i=t.log,o=t.address,s=t.userAgent,a=t.boltAgent,u=t.authTokenManager,c=t.newPool,l=e.call(this,{id:n,config:r,log:i,userAgent:s,boltAgent:a,authTokenManager:u,newPool:c})||this;return l._address=o,l}return i(t,e),t.prototype.acquireConnection=function(e){var t=void 0===e?{}:e,n=(t.accessMode,t.database),r=(t.bookmarks,t.auth),i=t.forceReAuth;return o(this,void 0,void 0,(function(){var e,t,o=this;return s(this,(function(s){switch(s.label){case 0:return e=c.ConnectionErrorHandler.create({errorCode:g,handleSecurityError:function(e,t,r){return o._handleSecurityError(e,t,r,n)}}),[4,this._connectionPool.acquire({auth:r,forceReAuth:i},this._address)];case 1:return t=s.sent(),r?[4,this._verifyStickyConnection({auth:r,connection:t,address:this._address})]:[3,3];case 2:return s.sent(),[2,t];case 3:return[2,new c.DelegateConnection(t,e)]}}))}))},t.prototype._handleSecurityError=function(t,n,r,i){return this._log.warn("Direct driver ".concat(this._id," will close connection to ").concat(n," for database '").concat(i,"' because of an error ").concat(t.code," '").concat(t.message,"'")),e.prototype._handleSecurityError.call(this,t,n,r)},t.prototype._hasProtocolVersion=function(e){return o(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return[4,this._createChannelConnection(this._address)];case 1:return t=r.sent(),n=t.protocol()?t.protocol().version:null,[4,t.close()];case 2:return r.sent(),n?[2,e(n)]:[2,!1]}}))}))},t.prototype.supportsMultiDb=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion((function(e){return e>=f}))];case 1:return[2,e.sent()]}}))}))},t.prototype.getNegotiatedProtocolVersion=function(){var e=this;return new Promise((function(t,n){e._hasProtocolVersion(t).catch(n)}))},t.prototype.supportsTransactionConfig=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion((function(e){return e>=d}))];case 1:return[2,e.sent()]}}))}))},t.prototype.supportsUserImpersonation=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion((function(e){return e>=p}))];case 1:return[2,e.sent()]}}))}))},t.prototype.supportsSessionAuth=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion((function(e){return e>=m}))];case 1:return[2,e.sent()]}}))}))},t.prototype.verifyAuthentication=function(e){var t=e.auth;return o(this,void 0,void 0,(function(){var e=this;return s(this,(function(n){return[2,this._verifyAuthentication({auth:t,getAddress:function(){return e._address}})]}))}))},t.prototype.verifyConnectivityAndGetServerInfo=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this._verifyConnectivityAndGetServerVersion({address:this._address})];case 1:return[2,e.sent()]}}))}))},t}(u.default);t.default=v},56301:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},u=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=n(39238),h=n(41264),d=c(n(87100)),f=n(31028),p=c(n(93210)),m=c(n(29859)),g=h.error.SERVICE_UNAVAILABLE,v=["Neo.ClientError.Security.CredentialsExpired","Neo.ClientError.Security.Forbidden","Neo.ClientError.Security.TokenExpired","Neo.ClientError.Security.Unauthorized"],y=h.internal.pool,b=y.Pool,_=y.PoolConfig,x=function(e){function t(n,r){var i=n.id,c=n.config,h=n.log,f=n.userAgent,g=n.boltAgent,v=n.authTokenManager,y=n.newPool,x=void 0===y?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(b.bind.apply(b,u([void 0],a(e),!1)))}:y;void 0===r&&(r=null);var w=e.call(this)||this;return w._id=i,w._config=c,w._log=h,w._clientCertificateHolder=new m.default({clientCertificateProvider:w._config.clientCertificate}),w._authenticationProvider=new d.default({authTokenManager:v,userAgent:f,boltAgent:g}),w._livenessCheckProvider=new p.default({connectionLivenessCheckTimeout:c.connectionLivenessCheckTimeout}),w._userAgent=f,w._boltAgent=g,w._createChannelConnection=r||function(e){return o(w,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return t=l.createChannelConnection,n=[e,this._config,this._createConnectionErrorHandler(),this._log],[4,this._clientCertificateHolder.getClientCertificate()];case 1:return[2,t.apply(void 0,n.concat([r.sent()]))]}}))}))},w._connectionPool=x({create:w._createConnection.bind(w),destroy:w._destroyConnection.bind(w),validateOnAcquire:w._validateConnectionOnAcquire.bind(w),validateOnRelease:w._validateConnectionOnRelease.bind(w),installIdleObserver:t._installIdleObserverOnConnection.bind(w),removeIdleObserver:t._removeIdleObserverOnConnection.bind(w),config:_.fromDriverConfig(c),log:w._log}),w._openConnections={},w}return i(t,e),t.prototype._createConnectionErrorHandler=function(){return new l.ConnectionErrorHandler(g)},t.prototype._getClientCertificate=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2,this._config.clientCertificate.getClientCertificate()]}))}))},t.prototype._createConnection=function(e,t,n){var r=this,i=e.auth;return this._createChannelConnection(t).then((function(e){return e.release=function(){return e.idleTimestamp=Date.now(),n(t,e)},r._openConnections[e.id]=e,r._authenticationProvider.authenticate({connection:e,auth:i}).catch((function(t){throw r._destroyConnection(e),t}))}))},t.prototype._validateConnectionOnAcquire=function(e,t){var n=e.auth,r=e.skipReAuth;return o(this,void 0,void 0,(function(){var e,i;return s(this,(function(o){switch(o.label){case 0:if(!this._validateConnection(t))return[2,!1];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._livenessCheckProvider.check(t)];case 2:return o.sent(),[3,4];case 3:return e=o.sent(),this._log.debug("The connection ".concat(t.id," is not alive because of an error ").concat(e.code," '").concat(e.message,"'")),[2,!1];case 4:return o.trys.push([4,6,,7]),[4,this._authenticationProvider.authenticate({connection:t,auth:n,skipReAuth:r})];case 5:return o.sent(),[2,!0];case 6:return i=o.sent(),this._log.debug("The connection ".concat(t.id," is not valid because of an error ").concat(i.code," '").concat(i.message,"'")),[2,!1];case 7:return[2]}}))}))},t.prototype._validateConnectionOnRelease=function(e){return!0!==e._sticky&&this._validateConnection(e)},t.prototype._validateConnection=function(e){if(!e.isOpen())return!1;var t=this._config.maxConnectionLifetime;return!(Date.now()-e.creationTimestamp>t)},t.prototype._destroyConnection=function(e){return delete this._openConnections[e.id],e.close()},t.prototype._verifyConnectivityAndGetServerVersion=function(e){var t=e.address;return o(this,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:return[4,this._connectionPool.acquire({},t)];case 1:e=r.sent(),n=new h.ServerInfo(e.server,e.protocol().version),r.label=2;case 2:return r.trys.push([2,,5,7]),e.protocol().isLastMessageLogon()?[3,4]:[4,e.resetAndFlush()];case 3:r.sent(),r.label=4;case 4:return[3,7];case 5:return[4,e.release()];case 6:return r.sent(),[7];case 7:return[2,n]}}))}))},t.prototype._verifyAuthentication=function(e){var t=e.getAddress,n=e.auth;return o(this,void 0,void 0,(function(){var e,r,i,o,a,u;return s(this,(function(s){switch(s.label){case 0:e=[],s.label=1;case 1:return s.trys.push([1,8,9,11]),[4,t()];case 2:return r=s.sent(),[4,this._connectionPool.acquire({auth:n,skipReAuth:!0},r)];case 3:if(i=s.sent(),e.push(i),o=!i.protocol().isLastMessageLogon(),!i.supportsReAuth)throw(0,h.newError)("Driver is connected to a database that does not support user switch.");return o&&i.supportsReAuth?[4,this._authenticationProvider.authenticate({connection:i,auth:n,waitReAuth:!0,forceReAuth:!0})]:[3,5];case 4:return s.sent(),[3,7];case 5:return!o||i.supportsReAuth?[3,7]:[4,this._connectionPool.acquire({auth:n},r,{requireNew:!0})];case 6:(a=s.sent())._sticky=!0,e.push(a),s.label=7;case 7:return[2,!0];case 8:if(u=s.sent(),v.includes(u.code))return[2,!1];throw u;case 9:return[4,Promise.all(e.map((function(e){return e.release()})))];case 10:return s.sent(),[7];case 11:return[2]}}))}))},t.prototype._verifyStickyConnection=function(e){var t=e.auth,n=e.connection;e.address;return o(this,void 0,void 0,(function(){var e,r;return s(this,(function(i){switch(i.label){case 0:return e=f.object.equals(t,n.authToken),r=!e,n._sticky=e&&!n.supportsReAuth,r||n._sticky?[4,n.release()]:[3,2];case 1:throw i.sent(),(0,h.newError)("Driver is connected to a database that does not support user switch.");case 2:return[2]}}))}))},t.prototype.close=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this._connectionPool.close()];case 1:return e.sent(),[4,Promise.all(Object.values(this._openConnections).map((function(e){return e.close()})))];case 2:return e.sent(),[2]}}))}))},t._installIdleObserverOnConnection=function(e,t){e._setIdle(t)},t._removeIdleObserverOnConnection=function(e){e._unsetIdle()},t.prototype._handleSecurityError=function(e,t,n){return this._authenticationProvider.handleError({connection:n,code:e.code})&&(e.retriable=!0),"Neo.ClientError.Security.AuthorizationExpired"===e.code&&this._connectionPool.apply(t,(function(e){e.authToken=null})),n&&n.close().catch((function(){})),e},t}(h.ConnectionProvider);t.default=x},91094:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return a(t,e),t},c=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},h=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},d=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var p=n(41264),m=u(n(24480)),g=n(68768),v=f(n(16152)),y=f(n(56301)),b=n(59943),_=n(39238),x=n(31028),w=p.error.SERVICE_UNAVAILABLE,S=p.error.SESSION_EXPIRED,E=p.internal.bookmarks.Bookmarks,T=p.internal.constants,M=T.ACCESS_MODE_READ,A=T.ACCESS_MODE_WRITE,C=T.BOLT_PROTOCOL_V3,O=T.BOLT_PROTOCOL_V4_0,P=T.BOLT_PROTOCOL_V4_4,R=T.BOLT_PROTOCOL_V5_1,N="Neo.ClientError.Database.DatabaseNotFound",I="Neo.ClientError.Transaction.InvalidBookmark",k="Neo.ClientError.Transaction.InvalidBookmarkMixture",D="Neo.ClientError.Security.AuthorizationExpired",L="Neo.ClientError.Statement.ArgumentError",U="Neo.ClientError.Request.Invalid",F="Neo.ClientError.Statement.TypeError",B="N/A",z=null,j=(0,p.int)(3e4),V=function(e){function t(t){var n=t.id,r=t.address,i=t.routingContext,s=t.hostNameResolver,a=t.config,u=t.log,h=t.userAgent,d=t.boltAgent,f=t.authTokenManager,v=t.routingTablePurgeDelay,y=t.newPool,w=e.call(this,{id:n,config:a,log:u,userAgent:h,boltAgent:d,authTokenManager:f,newPool:y},(function(e){return c(w,void 0,void 0,(function(){var t,n;return l(this,(function(r){switch(r.label){case 0:return t=_.createChannelConnection,n=[e,this._config,this._createConnectionErrorHandler(),this._log],[4,this._clientCertificateHolder.getClientCertificate()];case 1:return[2,t.apply(void 0,n.concat([r.sent(),this._routingContext]))]}}))}))}))||this;return w._routingContext=o(o({},i),{address:r.toString()}),w._seedRouter=r,w._rediscovery=new m.default(w._routingContext),w._loadBalancingStrategy=new b.LeastConnectedLoadBalancingStrategy(w._connectionPool),w._hostNameResolver=s,w._dnsResolver=new g.HostNameResolver,w._log=u,w._useSeedRouter=!0,w._routingTableRegistry=new G(v?(0,p.int)(v):j),w._refreshRoutingTable=x.functional.reuseOngoingRequest(w._refreshRoutingTable,w),w}return i(t,e),t.prototype._createConnectionErrorHandler=function(){return new _.ConnectionErrorHandler(S)},t.prototype._handleUnavailability=function(e,t,n){return this._log.warn("Routing driver ".concat(this._id," will forget ").concat(t," for database '").concat(n,"' because of an error ").concat(e.code," '").concat(e.message,"'")),this.forget(t,n||z),e},t.prototype._handleSecurityError=function(t,n,r,i){return this._log.warn("Routing driver ".concat(this._id," will close connections to ").concat(n," for database '").concat(i,"' because of an error ").concat(t.code," '").concat(t.message,"'")),e.prototype._handleSecurityError.call(this,t,n,r,i)},t.prototype._handleWriteFailure=function(e,t,n){return this._log.warn("Routing driver ".concat(this._id," will forget writer ").concat(t," for database '").concat(n,"' because of an error ").concat(e.code," '").concat(e.message,"'")),this.forgetWriter(t,n||z),(0,p.newError)("No longer possible to write to server at "+t,S,e)},t.prototype.acquireConnection=function(e){var t=void 0===e?{}:e,n=t.accessMode,r=t.database,i=t.bookmarks,o=t.impersonatedUser,s=t.onDatabaseNameResolved,a=t.auth;return c(this,void 0,void 0,(function(){var e,t,u,c,h,d,f,m=this;return l(this,(function(l){switch(l.label){case 0:return u={database:r||z},c=new _.ConnectionErrorHandler(S,(function(e,t){return m._handleUnavailability(e,t,u.database)}),(function(e,t){return m._handleWriteFailure(e,t,u.database)}),(function(e,t,n){return m._handleSecurityError(e,t,n,u.database)})),[4,this._freshRoutingTable({accessMode:n,database:u.database,bookmarks:i,impersonatedUser:o,auth:a,onDatabaseNameResolved:function(e){u.database=u.database||e,s&&s(e)}})];case 1:if(h=l.sent(),n===M)t=this._loadBalancingStrategy.selectReader(h.readers),e="read";else{if(n!==A)throw(0,p.newError)("Illegal mode "+n);t=this._loadBalancingStrategy.selectWriter(h.writers),e="write"}if(!t)throw(0,p.newError)("Failed to obtain connection towards ".concat(e," server. Known routing table is: ").concat(h),S);l.label=2;case 2:return l.trys.push([2,6,,7]),[4,this._connectionPool.acquire({auth:a},t)];case 3:return d=l.sent(),a?[4,this._verifyStickyConnection({auth:a,connection:d,address:t})]:[3,5];case 4:return l.sent(),[2,d];case 5:return[2,new _.DelegateConnection(d,c)];case 6:throw f=l.sent(),c.handleAndTransformError(f,t);case 7:return[2]}}))}))},t.prototype._hasProtocolVersion=function(e){return c(this,void 0,void 0,(function(){var t,n,r,i,o,s;return l(this,(function(a){switch(a.label){case 0:return[4,this._resolveSeedRouter(this._seedRouter)];case 1:t=a.sent(),r=0,a.label=2;case 2:if(!(r<t.length))return[3,8];a.label=3;case 3:return a.trys.push([3,6,,7]),[4,this._createChannelConnection(t[r])];case 4:return i=a.sent(),o=i.protocol()?i.protocol().version:null,[4,i.close()];case 5:return a.sent(),o?[2,e(o)]:[2,!1];case 6:return s=a.sent(),n=s,[3,7];case 7:return r++,[3,2];case 8:if(n)throw n;return[2,!1]}}))}))},t.prototype.supportsMultiDb=function(){return c(this,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion((function(e){return e>=O}))];case 1:return[2,e.sent()]}}))}))},t.prototype.supportsTransactionConfig=function(){return c(this,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion((function(e){return e>=C}))];case 1:return[2,e.sent()]}}))}))},t.prototype.supportsUserImpersonation=function(){return c(this,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion((function(e){return e>=P}))];case 1:return[2,e.sent()]}}))}))},t.prototype.supportsSessionAuth=function(){return c(this,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion((function(e){return e>=R}))];case 1:return[2,e.sent()]}}))}))},t.prototype.getNegotiatedProtocolVersion=function(){var e=this;return new Promise((function(t,n){e._hasProtocolVersion(t).catch(n)}))},t.prototype.verifyAuthentication=function(e){var t=e.database,n=e.accessMode,r=e.auth;return c(this,void 0,void 0,(function(){var e=this;return l(this,(function(i){return[2,this._verifyAuthentication({auth:r,getAddress:function(){return c(e,void 0,void 0,(function(){var e,i,o;return l(this,(function(s){switch(s.label){case 0:return e={database:t||z},[4,this._freshRoutingTable({accessMode:n,database:e.database,auth:r,onDatabaseNameResolved:function(t){e.database=e.database||t}})];case 1:if(i=s.sent(),0===(o=n===A?i.writers:i.readers).length)throw(0,p.newError)("No servers available for database '".concat(e.database,"' with access mode '").concat(n,"'"),w);return[2,o[0]]}}))}))}})]}))}))},t.prototype.verifyConnectivityAndGetServerInfo=function(e){var t=e.database,n=e.accessMode;return c(this,void 0,void 0,(function(){var e,r,i,o,s,a,u,c,d,f,m;return l(this,(function(l){switch(l.label){case 0:return e={database:t||z},[4,this._freshRoutingTable({accessMode:n,database:e.database,onDatabaseNameResolved:function(t){e.database=e.database||t}})];case 1:r=l.sent(),i=n===A?r.writers:r.readers,o=(0,p.newError)("No servers available for database '".concat(e.database,"' with access mode '").concat(n,"'"),w),l.label=2;case 2:l.trys.push([2,9,10,11]),s=h(i),a=s.next(),l.label=3;case 3:if(a.done)return[3,8];u=a.value,l.label=4;case 4:return l.trys.push([4,6,,7]),[4,this._verifyConnectivityAndGetServerVersion({address:u})];case 5:return[2,l.sent()];case 6:return c=l.sent(),o=c,[3,7];case 7:return a=s.next(),[3,3];case 8:return[3,11];case 9:return d=l.sent(),f={error:d},[3,11];case 10:try{a&&!a.done&&(m=s.return)&&m.call(s)}finally{if(f)throw f.error}return[7];case 11:throw o}}))}))},t.prototype.forget=function(e,t){this._routingTableRegistry.apply(t,{applyWhenExists:function(t){return t.forget(e)}}),this._connectionPool.purge(e).catch((function(){}))},t.prototype.forgetWriter=function(e,t){this._routingTableRegistry.apply(t,{applyWhenExists:function(t){return t.forgetWriter(e)}})},t.prototype._freshRoutingTable=function(e){var t=void 0===e?{}:e,n=t.accessMode,r=t.database,i=t.bookmarks,o=t.impersonatedUser,s=t.onDatabaseNameResolved,a=t.auth,u=this._routingTableRegistry.get(r,(function(){return new m.RoutingTable({database:r})}));return u.isStaleFor(n)?(this._log.info('Routing table is stale for database: "'.concat(r,'" and access mode: "').concat(n,'": ').concat(u)),this._refreshRoutingTable(u,i,o,a).then((function(e){return s(e.database),e}))):u},t.prototype._refreshRoutingTable=function(e,t,n,r){var i=e.routers;return this._useSeedRouter?this._fetchRoutingTableFromSeedRouterFallbackToKnownRouters(i,e,t,n,r):this._fetchRoutingTableFromKnownRoutersFallbackToSeedRouter(i,e,t,n,r)},t.prototype._fetchRoutingTableFromSeedRouterFallbackToKnownRouters=function(e,t,n,r,i){return c(this,void 0,void 0,(function(){var o,s,a,u,c,h,f;return l(this,(function(l){switch(l.label){case 0:return o=[],[4,this._fetchRoutingTableUsingSeedRouter(o,this._seedRouter,t,n,r,i)];case 1:return s=d.apply(void 0,[l.sent(),2]),a=s[0],u=s[1],a?(this._useSeedRouter=!1,[3,4]):[3,2];case 2:return[4,this._fetchRoutingTableUsingKnownRouters(e,t,n,r,i)];case 3:c=d.apply(void 0,[l.sent(),2]),h=c[0],f=c[1],a=h,u=f||u,l.label=4;case 4:return[4,this._applyRoutingTableIfPossible(t,a,u)];case 5:return[2,l.sent()]}}))}))},t.prototype._fetchRoutingTableFromKnownRoutersFallbackToSeedRouter=function(e,t,n,r,i){return c(this,void 0,void 0,(function(){var o,s,a,u;return l(this,(function(c){switch(c.label){case 0:return[4,this._fetchRoutingTableUsingKnownRouters(e,t,n,r,i)];case 1:return o=d.apply(void 0,[c.sent(),2]),s=o[0],a=o[1],s?[3,3]:[4,this._fetchRoutingTableUsingSeedRouter(e,this._seedRouter,t,n,r,i)];case 2:u=d.apply(void 0,[c.sent(),2]),s=u[0],a=u[1],c.label=3;case 3:return[4,this._applyRoutingTableIfPossible(t,s,a)];case 4:return[2,c.sent()]}}))}))},t.prototype._fetchRoutingTableUsingKnownRouters=function(e,n,r,i,o){return c(this,void 0,void 0,(function(){var s,a,u,c;return l(this,(function(l){switch(l.label){case 0:return[4,this._fetchRoutingTable(e,n,r,i,o)];case 1:return s=d.apply(void 0,[l.sent(),2]),a=s[0],u=s[1],a?[2,[a,null]]:(c=e.length-1,t._forgetRouter(n,e,c),[2,[null,u]])}}))}))},t.prototype._fetchRoutingTableUsingSeedRouter=function(e,t,n,r,i,o){return c(this,void 0,void 0,(function(){var s,a;return l(this,(function(u){switch(u.label){case 0:return[4,this._resolveSeedRouter(t)];case 1:return s=u.sent(),a=s.filter((function(t){return e.indexOf(t)<0})),[4,this._fetchRoutingTable(a,n,r,i,o)];case 2:return[2,u.sent()]}}))}))},t.prototype._resolveSeedRouter=function(e){return c(this,void 0,void 0,(function(){var t,n,r=this;return l(this,(function(i){switch(i.label){case 0:return[4,this._hostNameResolver.resolve(e)];case 1:return t=i.sent(),[4,Promise.all(t.map((function(e){return r._dnsResolver.resolve(e)})))];case 2:return n=i.sent(),[2,[].concat.apply([],n)]}}))}))},t.prototype._fetchRoutingTable=function(e,n,r,i,o){return c(this,void 0,void 0,(function(){var s=this;return l(this,(function(a){return[2,e.reduce((function(a,u,h){return c(s,void 0,void 0,(function(){var s,c,f,p,m,g,v;return l(this,(function(l){switch(l.label){case 0:return[4,a];case 1:return s=d.apply(void 0,[l.sent(),1]),(c=s[0])?[2,[c,null]]:(f=h-1,t._forgetRouter(n,e,f),[4,this._createSessionForRediscovery(u,r,i,o)]);case 2:if(p=d.apply(void 0,[l.sent(),2]),m=p[0],g=p[1],!m)return[3,8];l.label=3;case 3:return l.trys.push([3,5,6,7]),[4,this._rediscovery.lookupRoutingTableOnRouter(m,n.database,u,i)];case 4:return[2,[l.sent(),null]];case 5:return v=l.sent(),[2,this._handleRediscoveryError(v,u)];case 6:return m.close(),[7];case 7:return[3,9];case 8:return[2,[null,g]];case 9:return[2]}}))}))}),Promise.resolve([null,null]))]}))}))},t.prototype._createSessionForRediscovery=function(e,t,n,r){return c(this,void 0,void 0,(function(){var i,o,s,a,u,c=this;return l(this,(function(l){switch(l.label){case 0:return l.trys.push([0,4,,5]),[4,this._connectionPool.acquire({auth:r},e)];case 1:return i=l.sent(),r?[4,this._verifyStickyConnection({auth:r,connection:i,address:e})]:[3,3];case 2:l.sent(),l.label=3;case 3:return o=_.ConnectionErrorHandler.create({errorCode:S,handleSecurityError:function(e,t,n){return c._handleSecurityError(e,t,n)}}),s=i._sticky?new _.DelegateConnection(i):new _.DelegateConnection(i,o),a=new v.default(s),i.protocol().version<4?[2,[new p.Session({mode:A,bookmarks:E.empty(),connectionProvider:a}),null]]:[2,[new p.Session({mode:M,database:"system",bookmarks:t,connectionProvider:a,impersonatedUser:n}),null]];case 4:return u=l.sent(),[2,this._handleRediscoveryError(u,e)];case 5:return[2]}}))}))},t.prototype._handleRediscoveryError=function(e,t){if(function(e){return[N,I,k,L,U,F,B].includes(e.code)}(e)||function(e){return e.code.startsWith("Neo.ClientError.Security.")&&![D].includes(e.code)}(e))throw e;if("Neo.ClientError.Procedure.ProcedureNotFound"===e.code)throw(0,p.newError)("Server at ".concat(t.asHostPort()," can't perform routing. Make sure you are connecting to a causal cluster"),w,e);return this._log.warn("unable to fetch routing table because of an error ".concat(e)),[null,e]},t.prototype._applyRoutingTableIfPossible=function(e,t,n){return c(this,void 0,void 0,(function(){return l(this,(function(r){switch(r.label){case 0:if(!t)throw(0,p.newError)("Could not perform discovery. No routing servers available. Known routing table: ".concat(e),w,n);return 0===t.writers.length&&(this._useSeedRouter=!0),[4,this._updateRoutingTable(t)];case 1:return r.sent(),[2,t]}}))}))},t.prototype._updateRoutingTable=function(e){return c(this,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return[4,this._connectionPool.keepAll(e.allServers())];case 1:return t.sent(),this._routingTableRegistry.removeExpired(),this._routingTableRegistry.register(e),this._log.info("Updated routing table ".concat(e)),[2]}}))}))},t._forgetRouter=function(e,t,n){var r=t[n];e&&r&&e.forgetRouter(r)},t}(y.default);t.default=V;var G=function(){function e(e){this._tables=new Map,this._routingTablePurgeDelay=e}return e.prototype.register=function(e){return this._tables.set(e.database,e),this},e.prototype.apply=function(e,t){var n=void 0===t?{}:t,r=n.applyWhenExists,i=n.applyWhenDontExists,o=void 0===i?function(){}:i;return this._tables.has(e)?r(this._tables.get(e)):"string"==typeof e||null===e?o():this._forEach(r),this},e.prototype.get=function(e,t){return this._tables.has(e)?this._tables.get(e):"function"==typeof t?t():t},e.prototype.removeExpired=function(){var e=this;return this._removeIf((function(t){return t.isExpiredFor(e._routingTablePurgeDelay)}))},e.prototype._forEach=function(e){var t,n;try{for(var r=h(this._tables),i=r.next();!i.done;i=r.next()){e(d(i.value,2)[1])}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return this},e.prototype._remove=function(e){return this._tables.delete(e),this},e.prototype._removeIf=function(e){var t,n;try{for(var r=h(this._tables),i=r.next();!i.done;i=r.next()){var o=d(i.value,2),s=o[0];e(o[1])&&this._remove(s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return this},e}()},16152:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var n=e.call(this)||this;return n._connection=t,n}return i(t,e),t.prototype.acquireConnection=function(e){var t=void 0===e?{}:e,n=(t.accessMode,t.database,t.bookmarks,this._connection);return this._connection=null,Promise.resolve(n)},t}(n(41264).ConnectionProvider);t.default=o},36428:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RoutingConnectionProvider=t.DirectConnectionProvider=t.PooledConnectionProvider=t.SingleConnectionProvider=void 0;var i=n(16152);Object.defineProperty(t,"SingleConnectionProvider",{enumerable:!0,get:function(){return r(i).default}});var o=n(56301);Object.defineProperty(t,"PooledConnectionProvider",{enumerable:!0,get:function(){return r(o).default}});var s=n(78216);Object.defineProperty(t,"DirectConnectionProvider",{enumerable:!0,get:function(){return r(s).default}});var a=n(91094);Object.defineProperty(t,"RoutingConnectionProvider",{enumerable:!0,get:function(){return r(a).default}})},93210:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){var t=e.connectionLivenessCheckTimeout;this._connectionLivenessCheckTimeout=t}return e.prototype.check=function(e){return n(this,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return this._isCheckDisabled||this._isNewlyCreatedConnection(e)?[2,!0]:(t=Date.now()-e.idleTimestamp,0===this._connectionLivenessCheckTimeout||t>this._connectionLivenessCheckTimeout?[4,e.resetAndFlush().then((function(){return!0}))]:[3,2]);case 1:return[2,n.sent()];case 2:return[2,!0]}}))}))},Object.defineProperty(e.prototype,"_isCheckDisabled",{get:function(){return null==this._connectionLivenessCheckTimeout||this._connectionLivenessCheckTimeout<0},enumerable:!1,configurable:!0}),e.prototype._isNewlyCreatedConnection=function(e){return null==e.authToken},e}();t.default=i},8433:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createChannelConnection=void 0;var u=n(68768),c=n(41264),l=a(n(78875)),h=a(n(6101)),d=c.error.PROTOCOL_ERROR,f=c.internal.logger.Logger,p=0;t.createChannelConnection=function(e,t,n,r,i,o,s){void 0===o&&(o=null),void 0===s&&(s=function(e){return new u.Channel(e)});var a=s(new u.ChannelConfig(e,t,n.errorCode(),i));return h.default.handshake(a,r).then((function(i){var s=i.protocolVersion,c=i.consumeRemainingBuffer,l=new u.Chunker(a),d=new u.Dechunker,f=new m(a,n,e,r,t.disableLosslessIntegers,o,l,t.notificationFilter,(function(e){return h.default.create({version:s,channel:a,chunker:l,dechunker:d,disableLosslessIntegers:t.disableLosslessIntegers,useBigInt:t.useBigInt,serversideRouting:o,server:e.server,log:e.logger,observer:{onObserversCountChange:e._handleOngoingRequestsNumberChange.bind(e),onError:e._handleFatalError.bind(e),onFailure:e._resetOnFailure.bind(e),onProtocolError:e._handleProtocolError.bind(e),onErrorApplyTransformation:function(t){return e.handleAndTransformError(t,e._address)}}})}),t.telemetryDisabled);return c((function(e){return d.write(e)})),f})).catch((function(e){return a.close().then((function(){throw e}))}))};var m=function(e){function t(t,n,r,i,o,s,a,u,c,l){void 0===o&&(o=!1),void 0===s&&(s=null);var h,d,m=e.call(this,n)||this;return m._authToken=null,m._idle=!1,m._reseting=!1,m._resetObservers=[],m._id=p++,m._address=r,m._server={address:r.asHostPort()},m._creationTimestamp=Date.now(),m._disableLosslessIntegers=o,m._ch=t,m._chunker=a,m._log=(h=m,new f((d=i)._level,(function(e,t){return d._loggerFunction(e,"".concat(h," ").concat(t))}))),m._serversideRouting=s,m._notificationFilter=u,m._telemetryDisabledDriverConfig=!0===l,m._telemetryDisabledConnection=!0,m._dbConnectionId=null,m._protocol=c(m),m._isBroken=!1,m._log.isDebugEnabled()&&m._log.debug("created towards ".concat(r)),m}return i(t,e),t.prototype.beginTransaction=function(e){return this._sendTelemetryIfEnabled(e),this._protocol.beginTransaction(e)},t.prototype.run=function(e,t,n){return this._sendTelemetryIfEnabled(n),this._protocol.run(e,t,n)},t.prototype._sendTelemetryIfEnabled=function(e){this._telemetryDisabledConnection||this._telemetryDisabledDriverConfig||null==e||null==e.apiTelemetryConfig||this._protocol.telemetry({api:e.apiTelemetryConfig.api},{onCompleted:e.apiTelemetryConfig.onTelemetrySuccess,onError:e.beforeError})},t.prototype.commitTransaction=function(e){return this._protocol.commitTransaction(e)},t.prototype.rollbackTransaction=function(e){return this._protocol.rollbackTransaction(e)},t.prototype.getProtocolVersion=function(){return this._protocol.version},Object.defineProperty(t.prototype,"authToken",{get:function(){return this._authToken},set:function(e){this._authToken=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportsReAuth",{get:function(){return this._protocol.supportsReAuth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"databaseId",{get:function(){return this._dbConnectionId},set:function(e){this._dbConnectionId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idleTimestamp",{get:function(){return this._idleTimestamp},set:function(e){this._idleTimestamp=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"creationTimestamp",{get:function(){return this._creationTimestamp},enumerable:!1,configurable:!0}),t.prototype.connect=function(e,t,n,r){return o(this,void 0,void 0,(function(){var i=this;return s(this,(function(o){switch(o.label){case 0:if(this._protocol.initialized&&!this._protocol.supportsReAuth)throw(0,c.newError)("Connection does not support re-auth");return this._authToken=n,this._protocol.initialized?[3,2]:[4,this._initialize(e,t,n)];case 1:case 3:return[2,o.sent()];case 2:return r?[4,new Promise((function(e,t){i._protocol.logoff({onError:t}),i._protocol.logon({authToken:n,onError:t,onComplete:function(){return e(i)},flush:!0})}))]:[3,4];case 4:return this._protocol.logoff(),this._protocol.logon({authToken:n,flush:!0}),[2,this]}}))}))},t.prototype._initialize=function(e,t,n){var r=this,i=this;return new Promise((function(o,s){r._protocol.initialize({userAgent:e,boltAgent:t,authToken:n,notificationFilter:r._notificationFilter,onError:function(e){return s(e)},onComplete:function(e){if(e){var t=e.server;r.version&&!t||(r.version=t);var n=e.connection_id;if(r.databaseId||(r.databaseId=n),e.hints){var s=e.hints["connection.recv_timeout_seconds"];if(null!=s){var a=(0,c.toNumber)(s);Number.isInteger(a)&&a>0?r._ch.setupReceiveTimeout(1e3*a):r._log.info("Server located at ".concat(r._address," supplied an invalid connection receive timeout value (").concat(a,"). ")+"Please, verify the server configuration and status because this can be the symptom of a bigger issue.")}!0===e.hints["telemetry.enabled"]&&(r._telemetryDisabledConnection=!1)}}o(i)}})}))},t.prototype.protocol=function(){return this._protocol},Object.defineProperty(t.prototype,"address",{get:function(){return this._address},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._server.version},set:function(e){this._server.version=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"server",{get:function(){return this._server},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"logger",{get:function(){return this._log},enumerable:!1,configurable:!0}),t.prototype._handleFatalError=function(e){this._isBroken=!0,this._error=this.handleAndTransformError(this._protocol.currentFailure||e,this._address),this._log.isErrorEnabled()&&this._log.error("experienced a fatal error caused by ".concat(this._error," (").concat(c.json.stringify(this._error),")")),this._protocol.notifyFatalError(this._error)},t.prototype._setIdle=function(e){this._idle=!0,this._ch.stopReceiveTimeout(),this._protocol.queueObserverIfProtocolIsNotBroken(e)},t.prototype._unsetIdle=function(){this._idle=!1,this._updateCurrentObserver()},t.prototype._queueObserver=function(e){return this._protocol.queueObserverIfProtocolIsNotBroken(e)},t.prototype.hasOngoingObservableRequests=function(){return!this._idle&&this._protocol.hasOngoingObservableRequests()},t.prototype.resetAndFlush=function(){var e=this;return new Promise((function(t,n){e._reset({onError:function(t){if(e._isBroken)n(t);else{var r=e._handleProtocolError("Received FAILURE as a response for RESET: ".concat(t));n(r)}},onComplete:function(){t()}})}))},t.prototype._resetOnFailure=function(){var e=this;this.isOpen()&&this._reset({onError:function(){e._protocol.resetFailure()},onComplete:function(){e._protocol.resetFailure()}})},t.prototype._reset=function(e){var t=this;if(this._reseting)this._protocol.isLastMessageReset()?this._resetObservers.push(e):this._protocol.reset({onError:function(t){e.onError(t)},onComplete:function(){e.onComplete()}});else{this._resetObservers.push(e),this._reseting=!0;var n=function(e){t._reseting=!1;var n=t._resetObservers;t._resetObservers=[],n.forEach(e)};this._protocol.reset({onError:function(e){n((function(t){return t.onError(e)}))},onComplete:function(){n((function(e){return e.onComplete()}))}})}},t.prototype._updateCurrentObserver=function(){this._protocol.updateCurrentObserver()},t.prototype.isOpen=function(){return!this._isBroken&&this._ch._open},t.prototype._handleOngoingRequestsNumberChange=function(e){this._idle||(0===e?this._ch.stopReceiveTimeout():this._ch.startReceiveTimeout())},t.prototype.close=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this._log.isDebugEnabled()&&this._log.debug("closing"),this._protocol&&this.isOpen()&&this._protocol.prepareToClose(),[4,this._ch.close()];case 1:return e.sent(),this._log.isDebugEnabled()&&this._log.debug("closed"),[2]}}))}))},t.prototype.toString=function(){return"Connection [".concat(this.id,"][").concat(this.databaseId||"","]")},t.prototype._handleProtocolError=function(e){this._protocol.resetFailure(),this._updateCurrentObserver();var t=(0,c.newError)(e,d);return this._handleFatalError(t),t},t}(l.default);t.default=m},18657:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t,n){var r=e.call(this,n)||this;return n&&(r._originalErrorHandler=t._errorHandler,t._errorHandler=r._errorHandler),r._delegate=t,r}return i(t,e),t.prototype.beginTransaction=function(e){return this._delegate.beginTransaction(e)},t.prototype.run=function(e,t,n){return this._delegate.run(e,t,n)},t.prototype.commitTransaction=function(e){return this._delegate.commitTransaction(e)},t.prototype.rollbackTransaction=function(e){return this._delegate.rollbackTransaction(e)},t.prototype.getProtocolVersion=function(){return this._delegate.getProtocolVersion()},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"databaseId",{get:function(){return this._delegate.databaseId},set:function(e){this._delegate.databaseId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"server",{get:function(){return this._delegate.server},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authToken",{get:function(){return this._delegate.authToken},set:function(e){this._delegate.authToken=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportsReAuth",{get:function(){return this._delegate.supportsReAuth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"address",{get:function(){return this._delegate.address},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._delegate.version},set:function(e){this._delegate.version=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"creationTimestamp",{get:function(){return this._delegate.creationTimestamp},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idleTimestamp",{get:function(){return this._delegate.idleTimestamp},set:function(e){this._delegate.idleTimestamp=e},enumerable:!1,configurable:!0}),t.prototype.isOpen=function(){return this._delegate.isOpen()},t.prototype.protocol=function(){return this._delegate.protocol()},t.prototype.connect=function(e,t,n,r){return this._delegate.connect(e,t,n,r)},t.prototype.write=function(e,t,n){return this._delegate.write(e,t,n)},t.prototype.resetAndFlush=function(){return this._delegate.resetAndFlush()},t.prototype.hasOngoingObservableRequests=function(){return this._delegate.hasOngoingObservableRequests()},t.prototype.close=function(){return this._delegate.close()},t.prototype.release=function(){return this._originalErrorHandler&&(this._delegate._errorHandler=this._originalErrorHandler),this._delegate.release()},t}(o(n(78875)).default);t.default=s},60015:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(41264),i=r.error.SERVICE_UNAVAILABLE,o=r.error.SESSION_EXPIRED,s=function(){function e(e,t,n,r){this._errorCode=e,this._handleUnavailability=t||a,this._handleWriteFailure=n||a,this._handleSecurityError=r||a}return e.create=function(t){return new e(t.errorCode,t.handleUnavailability,t.handleWriteFailure,t.handleSecurityError)},e.prototype.errorCode=function(){return this._errorCode},e.prototype.handleAndTransformError=function(e,t,n){return function(e){return null!=e&&null!=e.code&&e.code.startsWith("Neo.ClientError.Security.")}(e)?this._handleSecurityError(e,t,n):function(e){if(e)return e.code===o||e.code===i||"Neo.TransientError.General.DatabaseUnavailable"===e.code;return!1}(e)?this._handleUnavailability(e,t,n):function(e){if(e)return"Neo.ClientError.Cluster.NotALeader"===e.code||"Neo.ClientError.General.ForbiddenOnReadOnlyDatabase"===e.code;return!1}(e)?this._handleWriteFailure(e,t,n):e},e}();function a(e){return e}t.default=s},78875:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});n(6101);var o=function(e){function t(t){var n=e.call(this)||this;return n._errorHandler=t,n}return i(t,e),Object.defineProperty(t.prototype,"id",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"databaseId",{get:function(){throw new Error("not implemented")},set:function(e){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authToken",{get:function(){throw new Error("not implemented")},set:function(e){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportsReAuth",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"creationTimestamp",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idleTimestamp",{get:function(){throw new Error("not implemented")},set:function(e){throw new Error("not implemented")},enumerable:!1,configurable:!0}),t.prototype.protocol=function(){throw new Error("not implemented")},Object.defineProperty(t.prototype,"address",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){throw new Error("not implemented")},set:function(e){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"server",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),t.prototype.connect=function(e,t,n,r){throw new Error("not implemented")},t.prototype.write=function(e,t,n){throw new Error("not implemented")},t.prototype.close=function(){throw new Error("not implemented")},t.prototype.handleAndTransformError=function(e,t){return this._errorHandler?this._errorHandler.handleAndTransformError(e,t,this):e},t}(n(41264).Connection);t.default=o},39238:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createChannelConnection=t.ConnectionErrorHandler=t.DelegateConnection=t.ChannelConnection=t.Connection=void 0;var a=s(n(78875));t.Connection=a.default;var u=o(n(8433));t.ChannelConnection=u.default,Object.defineProperty(t,"createChannelConnection",{enumerable:!0,get:function(){return u.createChannelConnection}});var c=s(n(18657));t.DelegateConnection=c.default;var l=s(n(60015));t.ConnectionErrorHandler=l.default,t.default=a.default},97584:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.packstream=t.channel=t.buf=t.bolt=t.loadBalancing=void 0,t.loadBalancing=o(n(59943)),t.bolt=o(n(6101)),t.buf=o(n(16026)),t.channel=o(n(68768)),t.packstream=o(n(62047)),s(n(36428),t)},33420:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reuseOngoingRequest=t.identity=void 0;var r=n(41264);t.identity=function(e){return e},t.reuseOngoingRequest=function(e,t){void 0===t&&(t=null);var n=new Map;return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var s=r.json.stringify(i);if(n.has(s))return n.get(s);var a=e.apply(t,i);return n.set(s,a),a.finally((function(){n.delete(s)}))}}},31028:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.object=t.functional=void 0,t.functional=o(n(33420)),t.object=o(n(13086))},13086:function(e,t){"use strict";var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.equals=void 0,t.equals=function(e,t){var r,i;if(e===t)return!0;if(null===e||null===t)return!1;if("object"==typeof e&&"object"==typeof t){var o=Object.keys(e),s=Object.keys(t);if(o.length!==s.length)return!1;try{for(var a=n(o),u=a.next();!u.done;u=a.next()){var c=u.value;if(e[c]!==t[c])return!1}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return!0}return!1}},59943:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LeastConnectedLoadBalancingStrategy=t.LoadBalancingStrategy=void 0;var i=r(n(38213));t.LoadBalancingStrategy=i.default;var o=r(n(45879));t.LeastConnectedLoadBalancingStrategy=o.default,t.default=o.default},45879:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(79573)),a=function(e){function t(t){var n=e.call(this)||this;return n._readersIndex=new s.default,n._writersIndex=new s.default,n._connectionPool=t,n}return i(t,e),t.prototype.selectReader=function(e){return this._select(e,this._readersIndex)},t.prototype.selectWriter=function(e){return this._select(e,this._writersIndex)},t.prototype._select=function(e,t){var n=e.length;if(0===n)return null;var r=t.next(n),i=r,o=null,s=Number.MAX_SAFE_INTEGER;do{var a=e[i],u=this._connectionPool.activeResourceCount(a);u<s&&(o=a,s=u),i===n-1?i=0:i++}while(i!==r);return o},t}(o(n(38213)).default);t.default=a},38213:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.selectReader=function(e){throw new Error("Abstract function")},e.prototype.selectWriter=function(e){throw new Error("Abstract function")},e}();t.default=n},79573:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._offset=e||0}return e.prototype.next=function(e){if(0===e)return-1;var t=this._offset;return this._offset+=1,this._offset===Number.MAX_SAFE_INTEGER&&(this._offset=0),t%e},e}();t.default=n},62047:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.structure=t.v2=t.v1=void 0;var s=o(n(38286));t.v1=s;var a=o(n(62674));t.v2=a;var u=o(n(43306));t.structure=u,t.default=a},38286:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Unpacker=t.Packer=void 0;var r=n(68768),i=n(31028),o=n(43306),s=n(41264),a=s.error.PROTOCOL_ERROR,u=function(){function e(e){this._ch=e,this._byteArraysSupported=!0}return e.prototype.packable=function(e,t){var n=this;void 0===t&&(t=i.functional.identity);try{e=t(e)}catch(e){return function(){throw e}}if(null===e)return function(){return n._ch.writeUInt8(192)};if(!0===e)return function(){return n._ch.writeUInt8(195)};if(!1===e)return function(){return n._ch.writeUInt8(194)};if("number"==typeof e)return function(){return n.packFloat(e)};if("string"==typeof e)return function(){return n.packString(e)};if("bigint"==typeof e)return function(){return n.packInteger((0,s.int)(e))};if((0,s.isInt)(e))return function(){return n.packInteger(e)};if(e instanceof Int8Array)return function(){return n.packBytes(e)};if(e instanceof Array)return function(){n.packListHeader(e.length);for(var r=0;r<e.length;r++)n.packable(void 0===e[r]?null:e[r],t)()};if(function(e){if(null==e)return!1;return"function"==typeof e[Symbol.iterator]}(e))return this.packableIterable(e,t);if(e instanceof o.Structure){for(var r=[],a=0;a<e.fields.length;a++)r[a]=this.packable(e.fields[a],t);return function(){return n.packStruct(e.signature,r)}}return"object"==typeof e?function(){for(var r=Object.keys(e),i=0,o=0;o<r.length;o++)void 0!==e[r[o]]&&i++;n.packMapHeader(i);for(o=0;o<r.length;o++){var s=r[o];void 0!==e[s]&&(n.packString(s),n.packable(e[s],t)())}}:this._nonPackableValue("Unable to pack the given value: ".concat(e))},e.prototype.packableIterable=function(e,t){try{var n=Array.from(e);return this.packable(n,t)}catch(t){throw(0,s.newError)("Cannot pack given iterable, ".concat(t.message,": ").concat(e))}},e.prototype.packStruct=function(e,t){t=t||[],this.packStructHeader(t.length,e);for(var n=0;n<t.length;n++)t[n]()},e.prototype.packInteger=function(e){var t=e.high,n=e.low;e.greaterThanOrEqual(-16)&&e.lessThan(128)?this._ch.writeInt8(n):e.greaterThanOrEqual(-128)&&e.lessThan(-16)?(this._ch.writeUInt8(200),this._ch.writeInt8(n)):e.greaterThanOrEqual(-32768)&&e.lessThan(32768)?(this._ch.writeUInt8(201),this._ch.writeInt16(n)):e.greaterThanOrEqual(-2147483648)&&e.lessThan(2147483648)?(this._ch.writeUInt8(202),this._ch.writeInt32(n)):(this._ch.writeUInt8(203),this._ch.writeInt32(t),this._ch.writeInt32(n))},e.prototype.packFloat=function(e){this._ch.writeUInt8(193),this._ch.writeFloat64(e)},e.prototype.packString=function(e){var t=r.utf8.encode(e),n=t.length;if(n<16)this._ch.writeUInt8(128|n),this._ch.writeBytes(t);else if(n<256)this._ch.writeUInt8(208),this._ch.writeUInt8(n),this._ch.writeBytes(t);else if(n<65536)this._ch.writeUInt8(209),this._ch.writeUInt8(n/256>>0),this._ch.writeUInt8(n%256),this._ch.writeBytes(t);else{if(!(n<4294967296))throw(0,s.newError)("UTF-8 strings of size "+n+" are not supported");this._ch.writeUInt8(210),this._ch.writeUInt8((n/16777216>>0)%256),this._ch.writeUInt8((n/65536>>0)%256),this._ch.writeUInt8((n/256>>0)%256),this._ch.writeUInt8(n%256),this._ch.writeBytes(t)}},e.prototype.packListHeader=function(e){if(e<16)this._ch.writeUInt8(144|e);else if(e<256)this._ch.writeUInt8(212),this._ch.writeUInt8(e);else if(e<65536)this._ch.writeUInt8(213),this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256);else{if(!(e<4294967296))throw(0,s.newError)("Lists of size "+e+" are not supported");this._ch.writeUInt8(214),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256),this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256)}},e.prototype.packBytes=function(e){if(!this._byteArraysSupported)throw(0,s.newError)("Byte arrays are not supported by the database this driver is connected to");this.packBytesHeader(e.length);for(var t=0;t<e.length;t++)this._ch.writeInt8(e[t])},e.prototype.packBytesHeader=function(e){if(e<256)this._ch.writeUInt8(204),this._ch.writeUInt8(e);else if(e<65536)this._ch.writeUInt8(205),this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256);else{if(!(e<4294967296))throw(0,s.newError)("Byte arrays of size "+e+" are not supported");this._ch.writeUInt8(206),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256),this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256)}},e.prototype.packMapHeader=function(e){if(e<16)this._ch.writeUInt8(160|e);else if(e<256)this._ch.writeUInt8(216),this._ch.writeUInt8(e);else if(e<65536)this._ch.writeUInt8(217),this._ch.writeUInt8(e/256>>0),this._ch.writeUInt8(e%256);else{if(!(e<4294967296))throw(0,s.newError)("Maps of size "+e+" are not supported");this._ch.writeUInt8(218),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256),this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256)}},e.prototype.packStructHeader=function(e,t){if(e<16)this._ch.writeUInt8(176|e),this._ch.writeUInt8(t);else if(e<256)this._ch.writeUInt8(220),this._ch.writeUInt8(e),this._ch.writeUInt8(t);else{if(!(e<65536))throw(0,s.newError)("Structures of size "+e+" are not supported");this._ch.writeUInt8(221),this._ch.writeUInt8(e/256>>0),this._ch.writeUInt8(e%256)}},e.prototype.disableByteArrays=function(){this._byteArraysSupported=!1},e.prototype._nonPackableValue=function(e){return function(){throw(0,s.newError)(e,a)}},e}();t.Packer=u;var c=function(){function e(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),this._disableLosslessIntegers=e,this._useBigInt=t}return e.prototype.unpack=function(e,t){void 0===t&&(t=i.functional.identity);var n=e.readUInt8(),r=240&n,o=15&n;if(192===n)return null;var a=this._unpackBoolean(n);if(null!==a)return a;var u=this._unpackNumberOrInteger(n,e);if(null!==u){if((0,s.isInt)(u)){if(this._useBigInt)return u.toBigInt();if(this._disableLosslessIntegers)return u.toNumberOrInfinity()}return u}var c=this._unpackString(n,r,o,e);if(null!==c)return c;var l=this._unpackList(n,r,o,e,t);if(null!==l)return l;var h=this._unpackByteArray(n,e);if(null!==h)return h;var d=this._unpackMap(n,r,o,e,t);if(null!==d)return d;var f=this._unpackStruct(n,r,o,e,t);if(null!==f)return f;throw(0,s.newError)("Unknown packed value with marker "+n.toString(16))},e.prototype.unpackInteger=function(e){var t=e.readUInt8(),n=this._unpackInteger(t,e);if(null==n)throw(0,s.newError)("Unable to unpack integer value with marker "+t.toString(16));return n},e.prototype._unpackBoolean=function(e){return 195===e||194!==e&&null},e.prototype._unpackNumberOrInteger=function(e,t){return 193===e?t.readFloat64():this._unpackInteger(e,t)},e.prototype._unpackInteger=function(e,t){if(e>=0&&e<128)return(0,s.int)(e);if(e>=240&&e<256)return(0,s.int)(e-256);if(200===e)return(0,s.int)(t.readInt8());if(201===e)return(0,s.int)(t.readInt16());if(202===e){var n=t.readInt32();return(0,s.int)(n)}if(203===e){var r=t.readInt32(),i=t.readInt32();return new s.Integer(i,r)}return null},e.prototype._unpackString=function(e,t,n,i){return 128===t?r.utf8.decode(i,n):208===e?r.utf8.decode(i,i.readUInt8()):209===e?r.utf8.decode(i,i.readUInt16()):210===e?r.utf8.decode(i,i.readUInt32()):null},e.prototype._unpackList=function(e,t,n,r,i){return 144===t?this._unpackListWithSize(n,r,i):212===e?this._unpackListWithSize(r.readUInt8(),r,i):213===e?this._unpackListWithSize(r.readUInt16(),r,i):214===e?this._unpackListWithSize(r.readUInt32(),r,i):null},e.prototype._unpackListWithSize=function(e,t,n){for(var r=[],i=0;i<e;i++)r.push(this.unpack(t,n));return r},e.prototype._unpackByteArray=function(e,t){return 204===e?this._unpackByteArrayWithSize(t.readUInt8(),t):205===e?this._unpackByteArrayWithSize(t.readUInt16(),t):206===e?this._unpackByteArrayWithSize(t.readUInt32(),t):null},e.prototype._unpackByteArrayWithSize=function(e,t){for(var n=new Int8Array(e),r=0;r<e;r++)n[r]=t.readInt8();return n},e.prototype._unpackMap=function(e,t,n,r,i){return 160===t?this._unpackMapWithSize(n,r,i):216===e?this._unpackMapWithSize(r.readUInt8(),r,i):217===e?this._unpackMapWithSize(r.readUInt16(),r,i):218===e?this._unpackMapWithSize(r.readUInt32(),r,i):null},e.prototype._unpackMapWithSize=function(e,t,n){for(var r={},i=0;i<e;i++){r[this.unpack(t,n)]=this.unpack(t,n)}return r},e.prototype._unpackStruct=function(e,t,n,r,i){return 176===t?this._unpackStructWithSize(n,r,i):220===e?this._unpackStructWithSize(r.readUInt8(),r,i):221===e?this._unpackStructWithSize(r.readUInt16(),r,i):null},e.prototype._unpackStructWithSize=function(e,t,n){for(var r=t.readUInt8(),i=new o.Structure(r,[]),s=0;s<e;s++)i.fields.push(this.unpack(t,n));return n(i)},e}();t.Unpacker=c},62674:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Unpacker=t.Packer=void 0;var u=a(n(38286)),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.disableByteArrays=function(){throw new Error("Bolt V2 should always support byte arrays")},t}(u.Packer);t.Packer=c;var l=function(e){function t(t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),e.call(this,t,n)||this}return i(t,e),t}(u.Unpacker);t.Unpacker=l},43306:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.verifyStructSize=t.Structure=void 0;var r=n(41264),i=r.error.PROTOCOL_ERROR,o=function(){function e(e,t){this.signature=e,this.fields=t}return Object.defineProperty(e.prototype,"size",{get:function(){return this.fields.length},enumerable:!1,configurable:!0}),e.prototype.toString=function(){for(var e="",t=0;t<this.fields.length;t++)t>0&&(e+=", "),e+=this.fields[t];return"Structure("+this.signature+", ["+e+"])"},e}();t.Structure=o,t.verifyStructSize=function(e,t,n){if(t!==n)throw(0,r.newError)("Wrong struct size for ".concat(e,", expected ").concat(t," but was ").concat(n),i)},t.default=o},24480:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RoutingTable=t.Rediscovery=void 0;var i=r(n(90528));t.Rediscovery=i.default;var o=r(n(4580));t.RoutingTable=o.default,t.default=i.default},90528:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(4580)),o=(n(41264),function(){function e(e){this._routingContext=e}return e.prototype.lookupRoutingTableOnRouter=function(e,t,n,r){var o=this;return e._acquireConnection((function(s){return o._requestRawRoutingTable(s,e,t,n,r).then((function(e){return e.isNull?null:i.default.fromRawRoutingTable(t,n,e)}))}))},e.prototype._requestRawRoutingTable=function(e,t,n,r,i){var o=this;return new Promise((function(r,s){e.protocol().requestRoutingInformation({routingContext:o._routingContext,databaseName:n,impersonatedUser:i,sessionContext:{bookmarks:t._lastBookmarks,mode:t._mode,database:t._database,afterComplete:t._onComplete},onCompleted:r,onError:s})}))},e}());t.default=o},4580:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.createValidRoutingTable=void 0;var o=n(41264),s=o.internal.constants,a=s.ACCESS_MODE_WRITE,u=s.ACCESS_MODE_READ,c=o.internal.serverAddress.ServerAddress,l=o.error.PROTOCOL_ERROR,h=function(){function e(e){var t=void 0===e?{}:e,n=t.database,r=t.routers,i=t.readers,s=t.writers,a=t.expirationTime,u=t.ttl;this.database=n||null,this.databaseName=n||"default database",this.routers=r||[],this.readers=i||[],this.writers=s||[],this.expirationTime=a||(0,o.int)(0),this.ttl=u}return e.fromRawRoutingTable=function(e,t,n){return f(e,t,n)},e.prototype.forget=function(e){this.readers=d(this.readers,e),this.writers=d(this.writers,e)},e.prototype.forgetRouter=function(e){this.routers=d(this.routers,e)},e.prototype.forgetWriter=function(e){this.writers=d(this.writers,e)},e.prototype.isStaleFor=function(e){return this.expirationTime.lessThan(Date.now())||this.routers.length<1||e===u&&0===this.readers.length||e===a&&0===this.writers.length},e.prototype.isExpiredFor=function(e){return this.expirationTime.add(e).lessThan(Date.now())},e.prototype.allServers=function(){return i(i(i([],r(this.routers),!1),r(this.readers),!1),r(this.writers),!1)},e.prototype.toString=function(){return"RoutingTable["+"database=".concat(this.databaseName,", ")+"expirationTime=".concat(this.expirationTime,", ")+"currentTime=".concat(Date.now(),", ")+"routers=[".concat(this.routers,"], ")+"readers=[".concat(this.readers,"], ")+"writers=[".concat(this.writers,"]]")},e}();function d(e,t){return e.filter((function(e){return e.asKey()!==t.asKey()}))}function f(e,t,n){var r=n.ttl,i=function(e,t){try{var n=(0,o.int)(Date.now()),r=(0,o.int)(e.ttl).multiply(1e3).add(n);return r.lessThan(n)?o.Integer.MAX_VALUE:r}catch(n){throw(0,o.newError)("Unable to parse TTL entry from router ".concat(t," from raw routing table:\n").concat(o.json.stringify(e),"\nError message: ").concat(n.message),l)}}(n,t),s=function(e,t){try{var n=[],r=[],i=[];return e.servers.forEach((function(e){var t=e.role,o=e.addresses;"ROUTE"===t?n=m(o).map((function(e){return c.fromUrl(e)})):"WRITE"===t?i=m(o).map((function(e){return c.fromUrl(e)})):"READ"===t&&(r=m(o).map((function(e){return c.fromUrl(e)})))})),{routers:n,readers:r,writers:i}}catch(n){throw(0,o.newError)("Unable to parse servers entry from router ".concat(t," from addresses:\n").concat(o.json.stringify(e.servers),"\nError message: ").concat(n.message),l)}}(n,t),a=s.routers,u=s.readers,d=s.writers;return p(a,"routers",t),p(u,"readers",t),new h({database:e||n.db,routers:a,readers:u,writers:d,expirationTime:i,ttl:r})}function p(e,t,n){if(0===e.length)throw(0,o.newError)("Received no "+t+" from router "+n,l)}function m(e){if(!Array.isArray(e))throw new TypeError("Array expected but got: "+e);return Array.from(e)}t.default=h,t.createValidRoutingTable=f},83423:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.staticAuthTokenManager=t.authTokenManagers=t.AuthTokenAndExpiration=void 0;var s=o(n(60654)),a=n(7705),u=function(){function e(){}return e.prototype.getToken=function(){throw new Error("Not Implemented")},e.prototype.handleSecurityException=function(e,t){throw new Error("Not implemented")},e}();t.default=u;var c=function(){this.token=s.default.none(),this.expiration=void 0};t.AuthTokenAndExpiration=c;var l=new(function(){function e(){}return e.prototype.bearer=function(e){var t=e.tokenProvider;if("function"!=typeof t)throw new TypeError("tokenProvider should be function, but got: ".concat(typeof t));return new d(t,["Neo.ClientError.Security.Unauthorized","Neo.ClientError.Security.TokenExpired"])},e.prototype.basic=function(e){var t=this,n=e.tokenProvider;if("function"!=typeof n)throw new TypeError("tokenProvider should be function, but got: ".concat(typeof n));return new d((function(){return r(t,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return e={},[4,n()];case 1:return[2,(e.token=t.sent(),e)]}}))}))}),["Neo.ClientError.Security.Unauthorized"])},e}());t.authTokenManagers=l,Object.freeze(l),t.staticAuthTokenManager=function(e){var t=e.authToken;return new f(t)};var h=function(){function e(e){void 0===e&&(e=[]),this._subscribers=e}return e.prototype.subscribe=function(e){this._subscribers.push(e)},e.prototype.onCompleted=function(e){this._subscribers.forEach((function(t){return t.onCompleted(e)}))},e.prototype.onError=function(e){this._subscribers.forEach((function(t){return t.onError(e)}))},e}(),d=function(){function e(e,t,n,r){this._tokenProvider=e,this._handledSecurityCodes=t,this._currentAuthData=n,this._refreshObservable=r}return e.prototype.getToken=function(){var e;return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return void 0===this._currentAuthData||void 0!==this._currentAuthData.expiration&&this._currentAuthData.expiration<new Date?[4,this._refreshAuthToken()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2,null===(e=this._currentAuthData)||void 0===e?void 0:e.token]}}))}))},e.prototype.handleSecurityException=function(e,t){var n;return!!this._handledSecurityCodes.includes(t)&&(a.util.equals(e,null===(n=this._currentAuthData)||void 0===n?void 0:n.token)&&this._scheduleRefreshAuthToken(),!0)},e.prototype._scheduleRefreshAuthToken=function(e){var t=this;void 0===this._refreshObservable&&(this._currentAuthData=void 0,this._refreshObservable=new h,Promise.resolve(this._tokenProvider()).then((function(e){var n;t._currentAuthData=e,null===(n=t._refreshObservable)||void 0===n||n.onCompleted(e)})).catch((function(e){var n;null===(n=t._refreshObservable)||void 0===n||n.onError(e)})).finally((function(){t._refreshObservable=void 0}))),void 0!==e&&this._refreshObservable.subscribe(e)},e.prototype._refreshAuthToken=function(){return r(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,n){e._scheduleRefreshAuthToken({onCompleted:t,onError:n})}))];case 1:return[2,t.sent()]}}))}))},e}(),f=function(){function e(e){this._authToken=e}return e.prototype.getToken=function(){return this._authToken},e.prototype.handleSecurityException=function(e,t){return!1},e}()},60654:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={basic:function(e,t,n){return null!=n?{scheme:"basic",principal:e,credentials:t,realm:n}:{scheme:"basic",principal:e,credentials:t}},kerberos:function(e){return{scheme:"kerberos",principal:"",credentials:e}},bearer:function(e){return{scheme:"bearer",credentials:e}},none:function(){return{scheme:"none"}},custom:function(e,t,n,i,o){var s={scheme:i,principal:e};return r(t)&&(s.credentials=t),r(n)&&(s.realm=n),r(o)&&(s.parameters=o),s}};function r(e){return!(null==e||""===e||Object.getPrototypeOf(e)===Object.prototype&&0===Object.keys(e).length)}t.default=n},63515:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.bookmarkManager=void 0;var a=function(){function e(){throw new Error("Not implemented")}return e.prototype.updateBookmarks=function(e,t){return n(this,void 0,void 0,(function(){return r(this,(function(e){throw new Error("Not implemented")}))}))},e.prototype.getBookmarks=function(){return n(this,void 0,void 0,(function(){return r(this,(function(e){throw new Error("Not implemented")}))}))},e}();t.default=a,t.bookmarkManager=function(e){void 0===e&&(e={});var t=new Set(e.initialBookmarks);return new u(t,e.bookmarksSupplier,e.bookmarksConsumer)};var u=function(){function e(e,t,n){this._bookmarks=e,this._bookmarksSupplier=t,this._bookmarksConsumer=n}return e.prototype.updateBookmarks=function(e,t){return n(this,void 0,void 0,(function(){var n,a,u,c,l,h,d,f,p,m;return r(this,(function(r){switch(r.label){case 0:n=this._bookmarks;try{for(a=i(e),u=a.next();!u.done;u=a.next())h=u.value,n.delete(h)}catch(e){d={error:e}}finally{try{u&&!u.done&&(f=a.return)&&f.call(a)}finally{if(d)throw d.error}}try{for(c=i(t),l=c.next();!l.done;l=c.next())h=l.value,n.add(h)}catch(e){p={error:e}}finally{try{l&&!l.done&&(m=c.return)&&m.call(c)}finally{if(p)throw p.error}}return"function"!=typeof this._bookmarksConsumer?[3,2]:[4,this._bookmarksConsumer(s([],o(n),!1))];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},e.prototype.getBookmarks=function(){var e;return n(this,void 0,void 0,(function(){var t,n,a,u,c,l,h;return r(this,(function(r){switch(r.label){case 0:return t=new Set(this._bookmarks),"function"!=typeof this._bookmarksSupplier?[3,2]:[4,this._bookmarksSupplier()];case 1:n=null!==(e=r.sent())&&void 0!==e?e:[];try{for(a=i(n),u=a.next();!u.done;u=a.next())c=u.value,t.add(c)}catch(e){l={error:e}}finally{try{u&&!u.done&&(h=a.return)&&h.call(a)}finally{if(l)throw l.error}}r.label=2;case 2:return[2,s([],o(t),!1)]}}))}))},e}()},77153:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.resolveCertificateProvider=t.clientCertificateProviders=t.RotatingClientCertificateProvider=t.ClientCertificateProvider=void 0;var c=u(n(90831)),l=function(){this.certfile="",this.keyfile="",this.password=void 0};t.default=l;var h=function(){function e(){}return e.prototype.hasUpdate=function(){throw new Error("Not Implemented")},e.prototype.getClientCertificate=function(){throw new Error("Not Implemented")},e}();t.ClientCertificateProvider=h;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.updateCertificate=function(e){throw new Error("Not implemented")},t}(h);t.RotatingClientCertificateProvider=d;var f=new(function(){function e(){}return e.prototype.rotating=function(e){var t=e.initialCertificate;if(null==t||!p(t))throw new TypeError("initialCertificate should be ClientCertificate, but got ".concat(c.stringify(t)));var n=o({},t);return new y(n)},e}());function p(e){return null!=e&&"object"==typeof e&&"certfile"in e&&(m(t=e.certfile)||g(t,m))&&"keyfile"in e&&function(e){function t(e){return"string"==typeof e||null!=e&&"object"==typeof e&&"path"in e&&"string"==typeof e.path&&v("password",e)}return t(e)||g(e,t)}(e.keyfile)&&v("password",e);var t}function m(e){return"string"==typeof e}function g(e,t,n){return void 0===n&&(n=!1),Array.isArray(e)&&(n||e.length>0)&&e.filter(t).length===e.length}function v(e,t){return!(e in t)||null==t[e]||"string"==typeof t[e]}t.clientCertificateProviders=f,Object.freeze(f),t.resolveCertificateProvider=function(e){if(null!=e){if("object"==typeof e&&"hasUpdate"in e&&"getClientCertificate"in e&&"function"==typeof e.getClientCertificate&&"function"==typeof e.hasUpdate)return e;if(p(e)){var t=o({},e);return{getClientCertificate:function(){return t},hasUpdate:function(){return!1}}}throw new TypeError("clientCertificate should be configured with ClientCertificate or ClientCertificateProvider, but got ".concat(c.stringify(e)))}};var y=function(){function e(e,t){void 0===t&&(t=!1),this._certificate=e,this._updated=t}return e.prototype.hasUpdate=function(){try{return this._updated}finally{this._updated=!1}},e.prototype.getClientCertificate=function(){return this._certificate},e.prototype.updateCertificate=function(e){if(!p(e))throw new TypeError("certificate should be ClientCertificate, but got ".concat(c.stringify(e)));this._certificate=o({},e),this._updated=!0},e}()},37273:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Releasable=void 0;var n=function(){function e(){}return e.prototype.release=function(){throw new Error("Not implemented")},e}();t.Releasable=n;var r=function(){function e(){}return e.prototype.acquireConnection=function(e){throw Error("Not implemented")},e.prototype.supportsMultiDb=function(){throw Error("Not implemented")},e.prototype.supportsTransactionConfig=function(){throw Error("Not implemented")},e.prototype.supportsUserImpersonation=function(){throw Error("Not implemented")},e.prototype.supportsSessionAuth=function(){throw Error("Not implemented")},e.prototype.verifyConnectivityAndGetServerInfo=function(e){throw Error("Not implemented")},e.prototype.verifyAuthentication=function(e){throw Error("Not implemented")},e.prototype.getNegotiatedProtocolVersion=function(){throw Error("Not Implemented")},e.prototype.close=function(){throw Error("Not implemented")},e}();t.default=r},24230:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.beginTransaction=function(e){throw new Error("Not implemented")},e.prototype.run=function(e,t,n){throw new Error("Not implemented")},e.prototype.commitTransaction=function(e){throw new Error("Not implemented")},e.prototype.rollbackTransaction=function(e){throw new Error("Not implemented")},e.prototype.resetAndFlush=function(){throw new Error("Not implemented")},e.prototype.isOpen=function(){throw new Error("Not implemented")},e.prototype.getProtocolVersion=function(){throw new Error("Not implemented")},e.prototype.hasOngoingObservableRequests=function(){throw new Error("Not implemented")},e}();t.default=n},49672:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.QueryConfig=t.SessionConfig=t.routing=t.WRITE=t.READ=t.Driver=void 0;var s=n(29350),a=o(n(23878)),u=n(83019),c=n(22541),l=o(n(48044)),h=n(83755),d=n(63515),f=o(n(76362)),p=o(n(61346)),m=n(40351),g=36e5,v=u.ACCESS_MODE_READ;t.READ=v;var y=u.ACCESS_MODE_WRITE;t.WRITE=y;var b=0,_=function(){this.defaultAccessMode=y,this.bookmarks=[],this.database="",this.impersonatedUser=void 0,this.auth=void 0,this.fetchSize=void 0,this.bookmarkManager=void 0,this.notificationFilter=void 0};t.SessionConfig=_;var x={WRITE:"WRITE",READ:"READ"};t.routing=x,Object.freeze(x);var w=function(){this.routing=x.WRITE,this.resultTransformer=void 0,this.database="",this.impersonatedUser=void 0,this.bookmarkManager=void 0,this.transactionConfig=void 0,this.auth=void 0,this.signal=void 0};t.QueryConfig=w;var S=function(){function e(e,t,n,r,i){void 0===t&&(t={}),void 0===r&&(r=function(e){return new l.default(e)}),void 0===i&&(i=function(e){return new p.default(e)}),function(e){e.maxConnectionLifetime=E(e.maxConnectionLifetime,g),e.maxConnectionPoolSize=E(e.maxConnectionPoolSize,u.DEFAULT_POOL_MAX_SIZE),e.connectionAcquisitionTimeout=E(e.connectionAcquisitionTimeout,u.DEFAULT_POOL_ACQUISITION_TIMEOUT),e.fetchSize=T(e.fetchSize,1e3),e.connectionTimeout=function(e){var t=parseInt(e.connectionTimeout,10);return 0===t||!isNaN(t)&&t<0?null:isNaN(t)?u.DEFAULT_CONNECTION_TIMEOUT_MILLIS:t}(e),e.connectionLivenessCheckTimeout=function(e){if(null==e)return;var t=parseInt(e,10);if(t<0||Number.isNaN(t))throw new Error("The connectionLivenessCheckTimeout can only be a positive value or 0 for always. However connectionLivenessCheckTimeout = ".concat(t));return t}(e.connectionLivenessCheckTimeout)}(t);var o=c.Logger.create(t);!function(e,t){var n,r,i=e.resolver;if(null!=i&&"function"!=typeof i)throw new TypeError("Configured resolver should be a function. Got: ".concat(typeof i));e.connectionAcquisitionTimeout<e.connectionTimeout&&t.warn('Configuration for "connectionAcquisitionTimeout" should be greater than or equal to "connectionTimeout". Otherwise, the connection acquisition timeout will take precedence for over the connection timeout in scenarios where a new connection is created while it is acquired');if(null!=(null===(n=e.notificationFilter)||void 0===n?void 0:n.disabledCategories)&&null!=(null===(r=e.notificationFilter)||void 0===r?void 0:r.disabledClassifications))throw new Error('The notificationFilter can\'t have both "disabledCategories" and  "disabledClassifications" configured at the same time.')}(t,o),this._id=b++,this._meta=e,this._config=t,this._log=o,this._createConnectionProvider=n,this._createSession=r,this._defaultExecuteQueryBookmarkManager=(0,d.bookmarkManager)(),this._queryExecutor=i(this.session.bind(this)),this._connectionProvider=null,this._afterConstruction()}return Object.defineProperty(e.prototype,"executeQueryBookmarkManager",{get:function(){return this._defaultExecuteQueryBookmarkManager},enumerable:!1,configurable:!0}),e.prototype.executeQuery=function(e,t,n){var o,s,a;return void 0===n&&(n={}),r(this,void 0,void 0,(function(){var r,u,c;return i(this,(function(i){switch(i.label){case 0:if(r=null===n.bookmarkManager?void 0:null!==(o=n.bookmarkManager)&&void 0!==o?o:this.executeQueryBookmarkManager,u=null!==(s=n.resultTransformer)&&void 0!==s?s:f.default.eagerResultTransformer(),(c=null!==(a=n.routing)&&void 0!==a?a:x.WRITE)!==x.READ&&c!==x.WRITE)throw(0,m.newError)('Illegal query routing config: "'.concat(c,'"'));return[4,this._queryExecutor.execute({resultTransformer:u,bookmarkManager:r,routing:c,database:n.database,impersonatedUser:n.impersonatedUser,transactionConfig:n.transactionConfig,auth:n.auth,signal:n.signal},e,t)];case 1:return[2,i.sent()]}}))}))},e.prototype.verifyConnectivity=function(e){var t=(void 0===e?{}:e).database,n=void 0===t?"":t;return this._getOrCreateConnectionProvider().verifyConnectivityAndGetServerInfo({database:n,accessMode:v})},e.prototype.verifyAuthentication=function(e){var t=void 0===e?{}:e,n=t.database,o=t.auth;return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this._getOrCreateConnectionProvider().verifyAuthentication({database:null!=n?n:"system",auth:o,accessMode:v})];case 1:return[2,e.sent()]}}))}))},e.prototype.getServerInfo=function(e){var t=(void 0===e?{}:e).database,n=void 0===t?"":t;return this._getOrCreateConnectionProvider().verifyConnectivityAndGetServerInfo({database:n,accessMode:v})},e.prototype.supportsMultiDb=function(){return this._getOrCreateConnectionProvider().supportsMultiDb()},e.prototype.supportsTransactionConfig=function(){return this._getOrCreateConnectionProvider().supportsTransactionConfig()},e.prototype.supportsUserImpersonation=function(){return this._getOrCreateConnectionProvider().supportsUserImpersonation()},e.prototype.supportsSessionAuth=function(){return this._getOrCreateConnectionProvider().supportsSessionAuth()},e.prototype.getNegotiatedProtocolVersion=function(){return this._getOrCreateConnectionProvider().getNegotiatedProtocolVersion()},e.prototype.isEncrypted=function(){return this._isEncrypted()},e.prototype._supportsRouting=function(){return this._meta.routing},e.prototype._isEncrypted=function(){return this._config.encrypted===h.ENCRYPTION_ON||!0===this._config.encrypted},e.prototype._getTrust=function(){return this._config.trust},e.prototype.session=function(e){var t=void 0===e?{}:e,n=t.defaultAccessMode,r=void 0===n?y:n,i=t.bookmarks,o=t.database,s=void 0===o?"":o,a=t.impersonatedUser,u=t.fetchSize,c=t.bookmarkManager,l=t.notificationFilter,h=t.auth;return this._newSession({defaultAccessMode:r,bookmarkOrBookmarks:i,database:s,reactive:!1,impersonatedUser:a,fetchSize:T(u,this._config.fetchSize),bookmarkManager:c,notificationFilter:l,auth:h})},e.prototype.close=function(){return this._log.info("Driver ".concat(this._id," closing")),null!=this._connectionProvider?this._connectionProvider.close():Promise.resolve()},e.prototype[Symbol.asyncDispose]=function(){return this.close()},e.prototype._afterConstruction=function(){this._log.info("".concat(this._meta.typename," driver ").concat(this._id," created for server address ").concat(this._meta.address.toString()))},e.prototype._newSession=function(e){var t=e.defaultAccessMode,n=e.bookmarkOrBookmarks,r=e.database,i=e.reactive,o=e.impersonatedUser,a=e.fetchSize,u=e.bookmarkManager,c=e.notificationFilter,h=e.auth,d=l.default._validateSessionMode(t),f=this._getOrCreateConnectionProvider(),p=null!=n?new s.Bookmarks(n):s.Bookmarks.empty();return this._createSession({mode:d,database:null!=r?r:"",connectionProvider:f,bookmarks:p,config:this._config,reactive:i,impersonatedUser:o,fetchSize:a,bookmarkManager:u,notificationFilter:c,auth:h,log:this._log})},e.prototype._getOrCreateConnectionProvider=function(){var e;return null==this._connectionProvider&&(this._connectionProvider=this._createConnectionProvider(this._id,this._config,this._log,(e=this._config,new a.default(e.resolver)))),this._connectionProvider},e}();function E(e,t){var n=parseInt(e,10);return n>0||0===n?n:n<0?Number.MAX_SAFE_INTEGER:t}function T(e,t){var n=parseInt(e,10);if(n>0||n===u.FETCH_ALL)return n;if(0===n||n<0)throw new Error("The fetch size can only be a positive value or ".concat(u.FETCH_ALL," for ALL. However fetchSize = ").concat(n));return t}t.Driver=S,t.default=S},40351:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.PROTOCOL_ERROR=t.SESSION_EXPIRED=t.SERVICE_UNAVAILABLE=t.GQLError=t.Neo4jError=t.isRetriableError=t.newGQLError=t.newError=void 0;var u=a(n(90831)),c=n(99364),l={DATABASE_ERROR:"DATABASE_ERROR",CLIENT_ERROR:"CLIENT_ERROR",TRANSIENT_ERROR:"TRANSIENT_ERROR",UNKNOWN:"UNKNOWN"};Object.freeze(l);var h=Object.values(l),d="ServiceUnavailable";t.SERVICE_UNAVAILABLE=d;var f="SessionExpired";t.SESSION_EXPIRED=f;t.PROTOCOL_ERROR="ProtocolError";var p=function(e){function t(n,r,i,o,s){var a,u=this;return(u=e.call(this,n,null!=s?{cause:s}:void 0)||this).constructor=t,u.__proto__=t.prototype,u.cause=null!=s?s:void 0,u.gqlStatus=r,u.gqlStatusDescription=i,u.diagnosticRecord=o,u.classification=function(e){if(void 0===e||void 0===e._classification)return"UNKNOWN";return h.includes(e._classification)?null==e?void 0:e._classification:"UNKNOWN"}(u.diagnosticRecord),u.rawClassification=null!==(a=null==o?void 0:o._classification)&&void 0!==a?a:void 0,u.name="GQLError",u}return i(t,e),Object.defineProperty(t.prototype,"diagnosticRecordAsJsonString",{get:function(){return u.stringify(this.diagnosticRecord,{useCustomToString:!0})},enumerable:!1,configurable:!0}),t}(Error);t.GQLError=p;var m=function(e){function t(n,r,i,o,s,a){var u=e.call(this,n,i,o,s,a)||this;return u.constructor=t,u.__proto__=t.prototype,u.code=r,u.name="Neo4jError",u.retriable=function(e){return e===d||e===f||function(e){return"Neo.ClientError.Security.AuthorizationExpired"===e}(e)||function(e){return!0===(null==e?void 0:e.includes("TransientError"))}(e)}(r),u}return i(t,e),t.isRetriable=function(e){return null!=e&&e instanceof t&&e.retriable},t}(p);t.Neo4jError=m,t.newError=function(e,t,n,r,i,o){return new m(e,null!=t?t:"N/A",null!=r?r:"50N42",null!=i?i:"error: general processing exception - unexpected error. "+e,null!=o?o:c.rawPolyfilledDiagnosticRecord,n)},t.newGQLError=function(e,t,n,r,i){return new p(e,null!=n?n:"50N42",null!=r?r:"error: general processing exception - unexpected error. "+e,null!=i?i:c.rawPolyfilledDiagnosticRecord,t)};var g=m.isRetriable;t.isRetriableError=g},99364:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rawPolyfilledDiagnosticRecord=void 0,t.rawPolyfilledDiagnosticRecord={OPERATION:"",OPERATION_CODE:"0",CURRENT_SCHEMA:"/"},Object.freeze(t.rawPolyfilledDiagnosticRecord)},13114:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPathSegment=t.PathSegment=t.isPath=t.Path=t.isUnboundRelationship=t.UnboundRelationship=t.isRelationship=t.Relationship=t.isNode=t.Node=void 0;var r=n(90831),i={value:!0,enumerable:!1,configurable:!1,writable:!1},o="__isNode__",s="__isRelationship__",a="__isUnboundRelationship__",u="__isPath__",c="__isPathSegment__";function l(e,t){return null!=e&&!0===e[t]}var h=function(){function e(e,t,n,r){this.identity=e,this.labels=t,this.properties=n,this.elementId=g(r,(function(){return e.toString()}))}return e.prototype.toString=function(){for(var e="("+this.elementId,t=0;t<this.labels.length;t++)e+=":"+this.labels[t];var n=Object.keys(this.properties);if(n.length>0){e+=" {";for(t=0;t<n.length;t++)t>0&&(e+=","),e+=n[t]+":"+(0,r.stringify)(this.properties[n[t]]);e+="}"}return e+=")"},e}();t.Node=h,Object.defineProperty(h.prototype,o,i),t.isNode=function(e){return l(e,o)};var d=function(){function e(e,t,n,r,i,o,s,a){this.identity=e,this.start=t,this.end=n,this.type=r,this.properties=i,this.elementId=g(o,(function(){return e.toString()})),this.startNodeElementId=g(s,(function(){return t.toString()})),this.endNodeElementId=g(a,(function(){return n.toString()}))}return e.prototype.toString=function(){var e="("+this.startNodeElementId+")-[:"+this.type,t=Object.keys(this.properties);if(t.length>0){e+=" {";for(var n=0;n<t.length;n++)n>0&&(e+=","),e+=t[n]+":"+(0,r.stringify)(this.properties[t[n]]);e+="}"}return e+="]->("+this.endNodeElementId+")"},e}();t.Relationship=d,Object.defineProperty(d.prototype,s,i),t.isRelationship=function(e){return l(e,s)};var f=function(){function e(e,t,n,r){this.identity=e,this.type=t,this.properties=n,this.elementId=g(r,(function(){return e.toString()}))}return e.prototype.bind=function(e,t){return new d(this.identity,e,t,this.type,this.properties,this.elementId)},e.prototype.bindTo=function(e,t){return new d(this.identity,e.identity,t.identity,this.type,this.properties,this.elementId,e.elementId,t.elementId)},e.prototype.toString=function(){var e="-[:"+this.type,t=Object.keys(this.properties);if(t.length>0){e+=" {";for(var n=0;n<t.length;n++)n>0&&(e+=","),e+=t[n]+":"+(0,r.stringify)(this.properties[t[n]]);e+="}"}return e+="]->"},e}();t.UnboundRelationship=f,Object.defineProperty(f.prototype,a,i),t.isUnboundRelationship=function(e){return l(e,a)};var p=function(e,t,n){this.start=e,this.relationship=t,this.end=n};t.PathSegment=p,Object.defineProperty(p.prototype,c,i),t.isPathSegment=function(e){return l(e,c)};var m=function(e,t,n){this.start=e,this.end=t,this.segments=n,this.length=n.length};function g(e,t){return null==e?t():e}t.Path=m,Object.defineProperty(m.prototype,u,i),t.isPath=function(e){return l(e,u)}},41264:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.EagerResult=t.Result=t.Stats=t.QueryStatistics=t.ProfiledPlan=t.Plan=t.GqlStatusObject=t.Notification=t.ServerInfo=t.queryType=t.ResultSummary=t.Record=t.isPathSegment=t.PathSegment=t.isPath=t.Path=t.isUnboundRelationship=t.UnboundRelationship=t.isRelationship=t.Relationship=t.isNode=t.Node=t.Time=t.LocalTime=t.LocalDateTime=t.isTime=t.isLocalTime=t.isLocalDateTime=t.isDuration=t.isDateTime=t.isDate=t.Duration=t.DateTime=t.Date=t.Point=t.isPoint=t.internal=t.toString=t.toNumber=t.inSafeRange=t.isInt=t.int=t.Integer=t.error=t.isRetriableError=t.GQLError=t.newGQLError=t.Neo4jError=t.newError=t.authTokenManagers=void 0,t.resolveCertificateProvider=t.clientCertificateProviders=t.notificationFilterMinimumSeverityLevel=t.notificationFilterDisabledClassification=t.notificationFilterDisabledCategory=t.notificationSeverityLevel=t.notificationClassification=t.notificationCategory=t.resultTransformers=t.routing=t.staticAuthTokenManager=t.bookmarkManager=t.auth=t.json=t.driver=t.types=t.Driver=t.Session=t.TransactionPromise=t.ManagedTransaction=t.Transaction=t.Connection=t.Releasable=t.ConnectionProvider=void 0;var a=n(40351);Object.defineProperty(t,"newError",{enumerable:!0,get:function(){return a.newError}}),Object.defineProperty(t,"Neo4jError",{enumerable:!0,get:function(){return a.Neo4jError}}),Object.defineProperty(t,"newGQLError",{enumerable:!0,get:function(){return a.newGQLError}}),Object.defineProperty(t,"GQLError",{enumerable:!0,get:function(){return a.GQLError}}),Object.defineProperty(t,"isRetriableError",{enumerable:!0,get:function(){return a.isRetriableError}});var u=o(n(45884));t.Integer=u.default,Object.defineProperty(t,"int",{enumerable:!0,get:function(){return u.int}}),Object.defineProperty(t,"isInt",{enumerable:!0,get:function(){return u.isInt}}),Object.defineProperty(t,"inSafeRange",{enumerable:!0,get:function(){return u.inSafeRange}}),Object.defineProperty(t,"toNumber",{enumerable:!0,get:function(){return u.toNumber}}),Object.defineProperty(t,"toString",{enumerable:!0,get:function(){return u.toString}});var c=n(33501);Object.defineProperty(t,"Date",{enumerable:!0,get:function(){return c.Date}}),Object.defineProperty(t,"DateTime",{enumerable:!0,get:function(){return c.DateTime}}),Object.defineProperty(t,"Duration",{enumerable:!0,get:function(){return c.Duration}}),Object.defineProperty(t,"isDate",{enumerable:!0,get:function(){return c.isDate}}),Object.defineProperty(t,"isDateTime",{enumerable:!0,get:function(){return c.isDateTime}}),Object.defineProperty(t,"isDuration",{enumerable:!0,get:function(){return c.isDuration}}),Object.defineProperty(t,"isLocalDateTime",{enumerable:!0,get:function(){return c.isLocalDateTime}}),Object.defineProperty(t,"isLocalTime",{enumerable:!0,get:function(){return c.isLocalTime}}),Object.defineProperty(t,"isTime",{enumerable:!0,get:function(){return c.isTime}}),Object.defineProperty(t,"LocalDateTime",{enumerable:!0,get:function(){return c.LocalDateTime}}),Object.defineProperty(t,"LocalTime",{enumerable:!0,get:function(){return c.LocalTime}}),Object.defineProperty(t,"Time",{enumerable:!0,get:function(){return c.Time}});var l=n(13114);Object.defineProperty(t,"Node",{enumerable:!0,get:function(){return l.Node}}),Object.defineProperty(t,"isNode",{enumerable:!0,get:function(){return l.isNode}}),Object.defineProperty(t,"Relationship",{enumerable:!0,get:function(){return l.Relationship}}),Object.defineProperty(t,"isRelationship",{enumerable:!0,get:function(){return l.isRelationship}}),Object.defineProperty(t,"UnboundRelationship",{enumerable:!0,get:function(){return l.UnboundRelationship}}),Object.defineProperty(t,"isUnboundRelationship",{enumerable:!0,get:function(){return l.isUnboundRelationship}}),Object.defineProperty(t,"Path",{enumerable:!0,get:function(){return l.Path}}),Object.defineProperty(t,"isPath",{enumerable:!0,get:function(){return l.isPath}}),Object.defineProperty(t,"PathSegment",{enumerable:!0,get:function(){return l.PathSegment}}),Object.defineProperty(t,"isPathSegment",{enumerable:!0,get:function(){return l.isPathSegment}});var h=s(n(85011));t.Record=h.default;var d=n(26061);Object.defineProperty(t,"isPoint",{enumerable:!0,get:function(){return d.isPoint}}),Object.defineProperty(t,"Point",{enumerable:!0,get:function(){return d.Point}});var f=o(n(69742));t.ResultSummary=f.default,Object.defineProperty(t,"queryType",{enumerable:!0,get:function(){return f.queryType}}),Object.defineProperty(t,"ServerInfo",{enumerable:!0,get:function(){return f.ServerInfo}}),Object.defineProperty(t,"Plan",{enumerable:!0,get:function(){return f.Plan}}),Object.defineProperty(t,"ProfiledPlan",{enumerable:!0,get:function(){return f.ProfiledPlan}}),Object.defineProperty(t,"QueryStatistics",{enumerable:!0,get:function(){return f.QueryStatistics}}),Object.defineProperty(t,"Stats",{enumerable:!0,get:function(){return f.Stats}});var p=o(n(64256));t.Notification=p.default,Object.defineProperty(t,"GqlStatusObject",{enumerable:!0,get:function(){return p.GqlStatusObject}}),Object.defineProperty(t,"notificationCategory",{enumerable:!0,get:function(){return p.notificationCategory}}),Object.defineProperty(t,"notificationClassification",{enumerable:!0,get:function(){return p.notificationClassification}}),Object.defineProperty(t,"notificationSeverityLevel",{enumerable:!0,get:function(){return p.notificationSeverityLevel}});var m=n(24649);Object.defineProperty(t,"notificationFilterDisabledCategory",{enumerable:!0,get:function(){return m.notificationFilterDisabledCategory}}),Object.defineProperty(t,"notificationFilterDisabledClassification",{enumerable:!0,get:function(){return m.notificationFilterDisabledClassification}}),Object.defineProperty(t,"notificationFilterMinimumSeverityLevel",{enumerable:!0,get:function(){return m.notificationFilterMinimumSeverityLevel}});var g=s(n(22548));t.Result=g.default;var v=s(n(85140));t.EagerResult=v.default;var y=o(n(37273));t.ConnectionProvider=y.default,Object.defineProperty(t,"Releasable",{enumerable:!0,get:function(){return y.Releasable}});var b=s(n(24230));t.Connection=b.default;var _=s(n(29708));t.Transaction=_.default;var x=s(n(14347));t.ManagedTransaction=x.default;var w=s(n(7602));t.TransactionPromise=w.default;var S=s(n(48044));t.Session=S.default;var E=o(n(49672)),T=E;t.Driver=E.default,t.driver=T;var M=s(n(60654));t.auth=M.default;var A=n(63515);Object.defineProperty(t,"bookmarkManager",{enumerable:!0,get:function(){return A.bookmarkManager}});var C=n(83423);Object.defineProperty(t,"authTokenManagers",{enumerable:!0,get:function(){return C.authTokenManagers}}),Object.defineProperty(t,"staticAuthTokenManager",{enumerable:!0,get:function(){return C.staticAuthTokenManager}});var O=n(49672);Object.defineProperty(t,"routing",{enumerable:!0,get:function(){return O.routing}});var P=o(n(52563));t.types=P;var R=o(n(90831));t.json=R;var N=s(n(76362));t.resultTransformers=N.default;var I=n(77153);Object.defineProperty(t,"clientCertificateProviders",{enumerable:!0,get:function(){return I.clientCertificateProviders}}),Object.defineProperty(t,"resolveCertificateProvider",{enumerable:!0,get:function(){return I.resolveCertificateProvider}});var k=o(n(7705));t.internal=k;var D={SERVICE_UNAVAILABLE:a.SERVICE_UNAVAILABLE,SESSION_EXPIRED:a.SESSION_EXPIRED,PROTOCOL_ERROR:a.PROTOCOL_ERROR};t.error=D;var L={authTokenManagers:C.authTokenManagers,newError:a.newError,Neo4jError:a.Neo4jError,newGQLError:a.newGQLError,GQLError:a.GQLError,isRetriableError:a.isRetriableError,error:D,Integer:u.default,int:u.int,isInt:u.isInt,inSafeRange:u.inSafeRange,toNumber:u.toNumber,toString:u.toString,internal:k,isPoint:d.isPoint,Point:d.Point,Date:c.Date,DateTime:c.DateTime,Duration:c.Duration,isDate:c.isDate,isDateTime:c.isDateTime,isDuration:c.isDuration,isLocalDateTime:c.isLocalDateTime,isLocalTime:c.isLocalTime,isTime:c.isTime,LocalDateTime:c.LocalDateTime,LocalTime:c.LocalTime,Time:c.Time,Node:l.Node,isNode:l.isNode,Relationship:l.Relationship,isRelationship:l.isRelationship,UnboundRelationship:l.UnboundRelationship,isUnboundRelationship:l.isUnboundRelationship,Path:l.Path,isPath:l.isPath,PathSegment:l.PathSegment,isPathSegment:l.isPathSegment,Record:h.default,ResultSummary:f.default,queryType:f.queryType,ServerInfo:f.ServerInfo,Notification:p.default,GqlStatusObject:p.GqlStatusObject,Plan:f.Plan,ProfiledPlan:f.ProfiledPlan,QueryStatistics:f.QueryStatistics,Stats:f.Stats,Result:g.default,EagerResult:v.default,Transaction:_.default,ManagedTransaction:x.default,TransactionPromise:w.default,Session:S.default,Driver:E.default,Connection:b.default,Releasable:y.Releasable,types:P,driver:T,json:R,auth:M.default,bookmarkManager:A.bookmarkManager,routing:O.routing,resultTransformers:N.default,notificationCategory:p.notificationCategory,notificationClassification:p.notificationClassification,notificationSeverityLevel:p.notificationSeverityLevel,notificationFilterDisabledCategory:m.notificationFilterDisabledCategory,notificationFilterDisabledClassification:m.notificationFilterDisabledClassification,notificationFilterMinimumSeverityLevel:m.notificationFilterMinimumSeverityLevel,clientCertificateProviders:I.clientCertificateProviders,resolveCertificateProvider:I.resolveCertificateProvider};t.default=L},45884:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toString=t.toNumber=t.inSafeRange=t.isInt=t.int=void 0;var r=n(40351),i=new Map,o=function(){function e(e,t){this.low=null!=e?e:0,this.high=null!=t?t:0}return e.prototype.inSafeRange=function(){return this.greaterThanOrEqual(e.MIN_SAFE_VALUE)&&this.lessThanOrEqual(e.MAX_SAFE_VALUE)},e.prototype.toInt=function(){return this.low},e.prototype.toNumber=function(){return this.high*a+(this.low>>>0)},e.prototype.toBigInt=function(){if(this.isZero())return BigInt(0);if(this.isPositive())return BigInt(this.high>>>0)*BigInt(a)+BigInt(this.low>>>0);var e=this.negate();return BigInt(-1)*(BigInt(e.high>>>0)*BigInt(a)+BigInt(e.low>>>0))},e.prototype.toNumberOrInfinity=function(){return this.lessThan(e.MIN_SAFE_VALUE)?Number.NEGATIVE_INFINITY:this.greaterThan(e.MAX_SAFE_VALUE)?Number.POSITIVE_INFINITY:this.toNumber()},e.prototype.toString=function(t){if((t=null!=t?t:10)<2||t>36)throw RangeError("radix out of range: "+t.toString());if(this.isZero())return"0";var n;if(this.isNegative()){if(this.equals(e.MIN_VALUE)){var r=e.fromNumber(t),i=this.div(r);return n=i.multiply(r).subtract(this),i.toString(t)+n.toInt().toString(t)}return"-"+this.negate().toString(t)}var o=e.fromNumber(Math.pow(t,6));n=this;for(var s="";;){var a=n.div(o),u=(n.subtract(a.multiply(o)).toInt()>>>0).toString(t);if((n=a).isZero())return u+s;for(;u.length<6;)u="0"+u;s=""+u+s}},e.prototype.valueOf=function(){return this.toBigInt()},e.prototype.getHighBits=function(){return this.high},e.prototype.getLowBits=function(){return this.low},e.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(e.MIN_VALUE)?64:this.negate().getNumBitsAbs();var t=0!==this.high?this.high:this.low,n=0;for(n=31;n>0&&0==(t&1<<n);n--);return 0!==this.high?n+33:n+1},e.prototype.isZero=function(){return 0===this.high&&0===this.low},e.prototype.isNegative=function(){return this.high<0},e.prototype.isPositive=function(){return this.high>=0},e.prototype.isOdd=function(){return 1==(1&this.low)},e.prototype.isEven=function(){return 0==(1&this.low)},e.prototype.equals=function(t){var n=e.fromValue(t);return this.high===n.high&&this.low===n.low},e.prototype.notEquals=function(e){return!this.equals(e)},e.prototype.lessThan=function(e){return this.compare(e)<0},e.prototype.lessThanOrEqual=function(e){return this.compare(e)<=0},e.prototype.greaterThan=function(e){return this.compare(e)>0},e.prototype.greaterThanOrEqual=function(e){return this.compare(e)>=0},e.prototype.compare=function(t){var n=e.fromValue(t);if(this.equals(n))return 0;var r=this.isNegative(),i=n.isNegative();return r&&!i?-1:!r&&i?1:this.subtract(n).isNegative()?-1:1},e.prototype.negate=function(){return this.equals(e.MIN_VALUE)?e.MIN_VALUE:this.not().add(e.ONE)},e.prototype.add=function(t){var n=e.fromValue(t),r=this.high>>>16,i=65535&this.high,o=this.low>>>16,s=65535&this.low,a=n.high>>>16,u=65535&n.high,c=n.low>>>16,l=0,h=0,d=0,f=0;return d+=(f+=s+(65535&n.low))>>>16,f&=65535,h+=(d+=o+c)>>>16,d&=65535,l+=(h+=i+u)>>>16,h&=65535,l+=r+a,l&=65535,e.fromBits(d<<16|f,l<<16|h)},e.prototype.subtract=function(t){var n=e.fromValue(t);return this.add(n.negate())},e.prototype.multiply=function(t){if(this.isZero())return e.ZERO;var n=e.fromValue(t);if(n.isZero())return e.ZERO;if(this.equals(e.MIN_VALUE))return n.isOdd()?e.MIN_VALUE:e.ZERO;if(n.equals(e.MIN_VALUE))return this.isOdd()?e.MIN_VALUE:e.ZERO;if(this.isNegative())return n.isNegative()?this.negate().multiply(n.negate()):this.negate().multiply(n).negate();if(n.isNegative())return this.multiply(n.negate()).negate();if(this.lessThan(c)&&n.lessThan(c))return e.fromNumber(this.toNumber()*n.toNumber());var r=this.high>>>16,i=65535&this.high,o=this.low>>>16,s=65535&this.low,a=n.high>>>16,u=65535&n.high,l=n.low>>>16,h=65535&n.low,d=0,f=0,p=0,m=0;return p+=(m+=s*h)>>>16,m&=65535,f+=(p+=o*h)>>>16,p&=65535,f+=(p+=s*l)>>>16,p&=65535,d+=(f+=i*h)>>>16,f&=65535,d+=(f+=o*l)>>>16,f&=65535,d+=(f+=s*u)>>>16,f&=65535,d+=r*h+i*l+o*u+s*a,d&=65535,e.fromBits(p<<16|m,d<<16|f)},e.prototype.div=function(t){var n,i,o,s=e.fromValue(t);if(s.isZero())throw(0,r.newError)("division by zero");if(this.isZero())return e.ZERO;if(this.equals(e.MIN_VALUE))return s.equals(e.ONE)||s.equals(e.NEG_ONE)?e.MIN_VALUE:s.equals(e.MIN_VALUE)?e.ONE:(n=this.shiftRight(1).div(s).shiftLeft(1)).equals(e.ZERO)?s.isNegative()?e.ONE:e.NEG_ONE:(i=this.subtract(s.multiply(n)),o=n.add(i.div(s)));if(s.equals(e.MIN_VALUE))return e.ZERO;if(this.isNegative())return s.isNegative()?this.negate().div(s.negate()):this.negate().div(s).negate();if(s.isNegative())return this.div(s.negate()).negate();for(o=e.ZERO,i=this;i.greaterThanOrEqual(s);){n=Math.max(1,Math.floor(i.toNumber()/s.toNumber()));for(var a=Math.ceil(Math.log(n)/Math.LN2),u=a<=48?1:Math.pow(2,a-48),c=e.fromNumber(n),l=c.multiply(s);l.isNegative()||l.greaterThan(i);)n-=u,l=(c=e.fromNumber(n)).multiply(s);c.isZero()&&(c=e.ONE),o=o.add(c),i=i.subtract(l)}return o},e.prototype.modulo=function(t){var n=e.fromValue(t);return this.subtract(this.div(n).multiply(n))},e.prototype.not=function(){return e.fromBits(~this.low,~this.high)},e.prototype.and=function(t){var n=e.fromValue(t);return e.fromBits(this.low&n.low,this.high&n.high)},e.prototype.or=function(t){var n=e.fromValue(t);return e.fromBits(this.low|n.low,this.high|n.high)},e.prototype.xor=function(t){var n=e.fromValue(t);return e.fromBits(this.low^n.low,this.high^n.high)},e.prototype.shiftLeft=function(t){var n=e.toNumber(t);return 0==(n&=63)?e.ZERO:n<32?e.fromBits(this.low<<n,this.high<<n|this.low>>>32-n):e.fromBits(0,this.low<<n-32)},e.prototype.shiftRight=function(t){var n=e.toNumber(t),r=e.toNumber(t);return 0==(n&=63)?e.ZERO:r<32?e.fromBits(this.low>>>n|this.high<<32-n,this.high>>n):e.fromBits(this.high>>n-32,this.high>=0?0:-1)},e.isInteger=function(e){return!0===(null==e?void 0:e.__isInteger__)},e.fromInt=function(t){var n;if((t|=0)>=-128&&t<128&&null!=(n=i.get(t)))return n;var r=new e(t,t<0?-1:0);return t>=-128&&t<128&&i.set(t,r),r},e.fromBits=function(t,n){return new e(t,n)},e.fromNumber=function(t){return isNaN(t)||!isFinite(t)?e.ZERO:t<=-u?e.MIN_VALUE:t+1>=u?e.MAX_VALUE:t<0?e.fromNumber(-t).negate():new e(t%a|0,t/a|0)},e.fromString=function(t,n,i){var o,a=(void 0===i?{}:i).strictStringValidation;if(0===t.length)throw(0,r.newError)("number format error: empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return e.ZERO;if((n=null!=n?n:10)<2||n>36)throw(0,r.newError)("radix out of range: "+n.toString());if((o=t.indexOf("-"))>0)throw(0,r.newError)('number format error: interior "-" character: '+t);if(0===o)return e.fromString(t.substring(1),n).negate();for(var u=e.fromNumber(Math.pow(n,8)),c=e.ZERO,l=0;l<t.length;l+=8){var h=Math.min(8,t.length-l),d=t.substring(l,l+h),f=parseInt(d,n);if(!0===a&&!s(d,f,n))throw(0,r.newError)('number format error: "'.concat(d,'" is NaN in radix ').concat(n,": ").concat(t));if(h<8){var p=e.fromNumber(Math.pow(n,h));c=c.multiply(p).add(e.fromNumber(f))}else c=(c=c.multiply(u)).add(e.fromNumber(f))}return c},e.fromValue=function(t,n){return void 0===n&&(n={}),t instanceof e?t:"number"==typeof t?(!0===n.ceilFloat&&(t=Math.ceil(t)),e.fromNumber(t)):"string"==typeof t?e.fromString(t,void 0,n):"bigint"==typeof t?e.fromString(t.toString()):new e(t.low,t.high)},e.toNumber=function(t){switch(typeof t){case"number":return t;case"bigint":return Number(t);default:return e.fromValue(t).toNumber()}},e.toString=function(t,n){return e.fromValue(t).toString(n)},e.inSafeRange=function(t){return e.fromValue(t).inSafeRange()},e.ZERO=e.fromInt(0),e.ONE=e.fromInt(1),e.NEG_ONE=e.fromInt(-1),e.MAX_VALUE=e.fromBits(-1,2147483647),e.MIN_VALUE=e.fromBits(0,-2147483648),e.MIN_SAFE_VALUE=e.fromBits(1,-2097152),e.MAX_SAFE_VALUE=e.fromBits(-1,2097151),e.__isInteger__=!0,e}();function s(e,t,n){return!Number.isNaN(e)&&!Number.isNaN(t)&&function(e,t,n){var r=e.toString(t),i=Math.max(n-r.length,0),o="0".repeat(i);return"".concat(o).concat(r)}(t,n,e.length)===e.toLowerCase()}Object.defineProperty(o.prototype,"__isInteger__",{value:!0,enumerable:!1,configurable:!1});var a=4294967296,u=a*a/2,c=o.fromInt(1<<24),l=o.fromValue;t.int=l;var h=o.isInteger;t.isInt=h;var d=o.inSafeRange;t.inSafeRange=d;var f=o.toNumber;t.toNumber=f;var p=o.toString;t.toString=p,t.default=o},37464:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromVersion=void 0,t.fromVersion=function(e,t){void 0===t&&(t=function(){return{get userAgent(){}}});var n=t(),r=null!=n.userAgent?n.userAgent.split("(")[1].split(")")[0]:void 0,i=n.userAgent||void 0;return{product:"neo4j-javascript/".concat(e),platform:r,languageDetails:i}}},13498:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(37464),t)},29350:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.Bookmarks=void 0;var u=o(n(83755)),c=function(){function e(e){this._values=function(e){if(null==e||""===e)return[];if(u.isString(e))return[e];if(Array.isArray(e)){for(var t=new Set,n=h(e),r=0;r<n.length;r++){var i=n[r];if(null!=i){if(!u.isString(i))throw new TypeError("Bookmark value should be a string, given: '".concat(i,"'"));t.add(i)}}return a([],s(t),!1)}throw new TypeError("Bookmarks should either be a string or a string array, given: '".concat(e,"'"))}(e)}return e.empty=function(){return l},e.prototype.isEmpty=function(){return 0===this._values.length},e.prototype.values=function(){return this._values},e.prototype[Symbol.iterator]=function(){return this._values[Symbol.iterator]()},e.prototype.asBeginTransactionParameters=function(){var e;return this.isEmpty()?{}:((e={}).bookmarks=this._values,e)},e}();t.Bookmarks=c;var l=new c(null);function h(e){return e.reduce((function(e,t){return Array.isArray(t)?e.concat(h(t)):e.concat(t)}),[])}},29265:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY_CONNECTION_HOLDER=t.ReadOnlyConnectionHolder=t.ConnectionHolder=void 0;var a=n(40351),u=n(83755),c=n(83019),l=n(29350),h=n(22541),d=function(){function e(e){var t=e.mode,n=e.database,r=void 0===n?"":n,i=e.bookmarks,o=e.connectionProvider,s=e.impersonatedUser,a=e.onDatabaseNameResolved,h=e.getConnectionAcquistionBookmarks,d=e.auth,f=e.log;this._mode=null!=t?t:c.ACCESS_MODE_WRITE,this._closed=!1,this._database=null!=r?(0,u.assertString)(r,"database"):"",this._bookmarks=null!=i?i:l.Bookmarks.empty(),this._connectionProvider=o,this._impersonatedUser=s,this._referenceCount=0,this._connectionPromise=Promise.resolve(null),this._onDatabaseNameResolved=a,this._auth=d,this._log=f,this._logError=this._logError.bind(this),this._getConnectionAcquistionBookmarks=null!=h?h:function(){return Promise.resolve(l.Bookmarks.empty())}}return e.prototype.mode=function(){return this._mode},e.prototype.database=function(){return this._database},e.prototype.setDatabase=function(e){this._database=e},e.prototype.bookmarks=function(){return this._bookmarks},e.prototype.connectionProvider=function(){return this._connectionProvider},e.prototype.referenceCount=function(){return this._referenceCount},e.prototype.initializeConnection=function(){return 0!==this._referenceCount||null==this._connectionProvider?(this._referenceCount++,!1):(this._connectionPromise=this._createConnectionPromise(this._connectionProvider),this._referenceCount++,!0)},e.prototype._createConnectionPromise=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return s(this,(function(i){switch(i.label){case 0:return n=(t=e).acquireConnection,r={accessMode:this._mode,database:this._database},[4,this._getBookmarks()];case 1:return[4,n.apply(t,[(r.bookmarks=i.sent(),r.impersonatedUser=this._impersonatedUser,r.onDatabaseNameResolved=this._onDatabaseNameResolved,r.auth=this._auth,r)])];case 2:return[2,i.sent()]}}))}))},e.prototype._getBookmarks=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this._getConnectionAcquistionBookmarks()];case 1:return[2,e.sent()]}}))}))},e.prototype.getConnection=function(){return this._connectionPromise},e.prototype.releaseConnection=function(){return 0===this._referenceCount?this._connectionPromise:(this._referenceCount--,0===this._referenceCount?this._releaseConnection():this._connectionPromise)},e.prototype.close=function(e){return this._closed=!0,0===this._referenceCount?this._connectionPromise:(this._referenceCount=0,this._releaseConnection(e))},e.prototype.log=function(){return this._log},e.prototype._releaseConnection=function(e){return this._connectionPromise=this._connectionPromise.then((function(t){return null!=t?t.isOpen()&&(t.hasOngoingObservableRequests()||!0===e)?t.resetAndFlush().catch(m).then((function(){return t.release().then((function(){return null}))})):t.release().then((function(){return null})):Promise.resolve(null)})).catch(this._logError),this._connectionPromise},e.prototype._logError=function(e){return this._log.isWarnEnabled()&&this._log.warn("ConnectionHolder got an error while releasing the connection. Error ".concat(e,". Stacktrace: ").concat(e.stack)),null},e}();t.ConnectionHolder=d;var f=function(e){function t(t){var n=e.call(this,{mode:t.mode(),database:t.database(),bookmarks:t.bookmarks(),getConnectionAcquistionBookmarks:t._getConnectionAcquistionBookmarks,connectionProvider:t.connectionProvider(),log:t.log()})||this;return n._connectionHolder=t,n}return i(t,e),t.prototype.initializeConnection=function(){return 0!==this._connectionHolder.referenceCount()},t.prototype.getConnection=function(){return this._connectionHolder.getConnection()},t.prototype.releaseConnection=function(){return this._connectionHolder.getConnection().catch((function(){return Promise.resolve(null)}))},t.prototype.close=function(){return this._connectionHolder.getConnection().catch((function(){return Promise.resolve(null)}))},t}(d);t.ReadOnlyConnectionHolder=f,t.default=f;var p=new(function(e){function t(){return e.call(this,{log:h.Logger.create({})})||this}return i(t,e),t.prototype.mode=function(){},t.prototype.database=function(){},t.prototype.initializeConnection=function(){return!0},t.prototype.getConnection=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,Promise.reject((0,a.newError)("This connection holder does not serve connections"))];case 1:return[2,e.sent()]}}))}))},t.prototype.releaseConnection=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,Promise.resolve(null)];case 1:return[2,e.sent()]}}))}))},t.prototype.close=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,Promise.resolve(null)];case 1:return[2,e.sent()]}}))}))},t}(d));function m(e){return null}t.EMPTY_CONNECTION_HOLDER=p},83019:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TELEMETRY_APIS=t.BOLT_PROTOCOL_V5_7=t.BOLT_PROTOCOL_V5_6=t.BOLT_PROTOCOL_V5_5=t.BOLT_PROTOCOL_V5_4=t.BOLT_PROTOCOL_V5_3=t.BOLT_PROTOCOL_V5_2=t.BOLT_PROTOCOL_V5_1=t.BOLT_PROTOCOL_V5_0=t.BOLT_PROTOCOL_V4_4=t.BOLT_PROTOCOL_V4_3=t.BOLT_PROTOCOL_V4_2=t.BOLT_PROTOCOL_V4_1=t.BOLT_PROTOCOL_V4_0=t.BOLT_PROTOCOL_V3=t.BOLT_PROTOCOL_V2=t.BOLT_PROTOCOL_V1=t.DEFAULT_POOL_MAX_SIZE=t.DEFAULT_POOL_ACQUISITION_TIMEOUT=t.DEFAULT_CONNECTION_TIMEOUT_MILLIS=t.ACCESS_MODE_WRITE=t.ACCESS_MODE_READ=t.FETCH_ALL=void 0;t.FETCH_ALL=-1;t.DEFAULT_POOL_ACQUISITION_TIMEOUT=6e4;t.DEFAULT_POOL_MAX_SIZE=100;t.DEFAULT_CONNECTION_TIMEOUT_MILLIS=3e4;t.ACCESS_MODE_READ="READ";t.ACCESS_MODE_WRITE="WRITE";t.BOLT_PROTOCOL_V1=1;t.BOLT_PROTOCOL_V2=2;t.BOLT_PROTOCOL_V3=3;t.BOLT_PROTOCOL_V4_0=4;t.BOLT_PROTOCOL_V4_1=4.1;t.BOLT_PROTOCOL_V4_2=4.2;t.BOLT_PROTOCOL_V4_3=4.3;t.BOLT_PROTOCOL_V4_4=4.4;t.BOLT_PROTOCOL_V5_0=5;t.BOLT_PROTOCOL_V5_1=5.1;t.BOLT_PROTOCOL_V5_2=5.2;t.BOLT_PROTOCOL_V5_3=5.3;t.BOLT_PROTOCOL_V5_4=5.4;t.BOLT_PROTOCOL_V5_5=5.5;t.BOLT_PROTOCOL_V5_6=5.6;t.BOLT_PROTOCOL_V5_7=5.7;t.TELEMETRY_APIS={MANAGED_TRANSACTION:0,UNMANAGED_TRANSACTION:1,AUTO_COMMIT_TRANSACTION:2,EXECUTE_QUERY:3}},7705:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.pool=t.boltAgent=t.objectUtil=t.resolver=t.serverAddress=t.urlUtil=t.logger=t.transactionExecutor=t.txConfig=t.connectionHolder=t.constants=t.bookmarks=t.observer=t.temporalUtil=t.util=void 0;var s=o(n(83755));t.util=s;var a=o(n(53799));t.temporalUtil=a;var u=o(n(48743));t.observer=u;var c=o(n(29350));t.bookmarks=c;var l=o(n(83019));t.constants=l;var h=o(n(29265));t.connectionHolder=h;var d=o(n(76857));t.txConfig=d;var f=o(n(93954));t.transactionExecutor=f;var p=o(n(22541));t.logger=p;var m=o(n(2209));t.urlUtil=m;var g=o(n(26220));t.serverAddress=g;var v=o(n(33895));t.resolver=v;var y=o(n(44510));t.objectUtil=y;var b=o(n(13498));t.boltAgent=b;var _=o(n(2990));t.pool=_},22541:function(e,t,n){"use strict";var r,i,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;var s=n(40351),a="error",u="warn",c="info",l="debug",h=c,d=((i={})[a]=0,i[u]=1,i[c]=2,i[l]=3,i),f=function(){function e(e,t){this._level=e,this._loggerFunction=t}return e.create=function(t){if(null!=(null==t?void 0:t.logging)){var n=t.logging,r=function(e){if(null!=(null==e?void 0:e.level)){var t=e.level,n=d[t];if(null==n&&0!==n)throw(0,s.newError)("Illegal logging level: ".concat(t,". Supported levels are: ").concat(Object.keys(d).toString()));return t}return h}(n),i=function(e){var t,n;if(null!=(null==e?void 0:e.logger)){var r=e.logger;if(null!=r&&"function"==typeof r)return r}throw(0,s.newError)("Illegal logger function: ".concat(null!==(n=null===(t=null==e?void 0:e.logger)||void 0===t?void 0:t.toString())&&void 0!==n?n:"undefined"))}(n);return new e(r,i)}return this.noOp()},e.noOp=function(){return p},e.prototype.isErrorEnabled=function(){return m(this._level,a)},e.prototype.error=function(e){this.isErrorEnabled()&&this._loggerFunction(a,e)},e.prototype.isWarnEnabled=function(){return m(this._level,u)},e.prototype.warn=function(e){this.isWarnEnabled()&&this._loggerFunction(u,e)},e.prototype.isInfoEnabled=function(){return m(this._level,c)},e.prototype.info=function(e){this.isInfoEnabled()&&this._loggerFunction(c,e)},e.prototype.isDebugEnabled=function(){return m(this._level,l)},e.prototype.debug=function(e){this.isDebugEnabled()&&this._loggerFunction(l,e)},e}();t.Logger=f;var p=new(function(e){function t(){return e.call(this,c,(function(e,t){}))||this}return o(t,e),t.prototype.isErrorEnabled=function(){return!1},t.prototype.error=function(e){},t.prototype.isWarnEnabled=function(){return!1},t.prototype.warn=function(e){},t.prototype.isInfoEnabled=function(){return!1},t.prototype.info=function(e){},t.prototype.isDebugEnabled=function(){return!1},t.prototype.debug=function(e){},t}(f));function m(e,t){return d[e]>=d[t]}},44510:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBrokenObjectReason=t.isBrokenObject=t.createBrokenObject=void 0;var n="__isBrokenObject__",r="__reason__";t.createBrokenObject=function(e,t){void 0===t&&(t={});var i=function(){throw e};return new Proxy(t,{get:function(t,o){return o===n||(o===r?e:void("toJSON"!==o&&i()))},set:i,apply:i,construct:i,defineProperty:i,deleteProperty:i,getOwnPropertyDescriptor:i,getPrototypeOf:i,has:i,isExtensible:i,ownKeys:i,preventExtensions:i,setPrototypeOf:i})},t.isBrokenObject=function(e){return null!==e&&"object"==typeof e&&!0===e[n]},t.getBrokenObjectReason=function(e){return e[r]}},48743:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FailedObserver=t.CompletedObserver=void 0;var n=function(){function e(){}return e.prototype.subscribe=function(e){i(e,e.onKeys,[]),i(e,e.onCompleted,{})},e.prototype.cancel=function(){},e.prototype.pause=function(){},e.prototype.resume=function(){},e.prototype.prepareToHandleSingleResponse=function(){},e.prototype.markCompleted=function(){},e.prototype.onError=function(e){throw new Error("CompletedObserver not supposed to call onError",{cause:e})},e}();t.CompletedObserver=n;var r=function(){function e(e){var t=e.error,n=e.onError;this._error=t,this._beforeError=n,this._observers=[],this.onError(t)}return e.prototype.subscribe=function(e){i(e,e.onError,this._error),this._observers.push(e)},e.prototype.onError=function(e){i(this,this._beforeError,e),this._observers.forEach((function(t){return i(t,t.onError,e)}))},e.prototype.cancel=function(){},e.prototype.pause=function(){},e.prototype.resume=function(){},e.prototype.markCompleted=function(){},e.prototype.prepareToHandleSingleResponse=function(){},e}();function i(e,t,n){null!=t&&t.bind(e)(n)}t.FailedObserver=r},2990:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_MAX_SIZE=t.DEFAULT_ACQUISITION_TIMEOUT=t.PoolConfig=t.Pool=void 0;var a=o(n(21557));t.PoolConfig=a.default,Object.defineProperty(t,"DEFAULT_ACQUISITION_TIMEOUT",{enumerable:!0,get:function(){return a.DEFAULT_ACQUISITION_TIMEOUT}}),Object.defineProperty(t,"DEFAULT_MAX_SIZE",{enumerable:!0,get:function(){return a.DEFAULT_MAX_SIZE}});var u=s(n(25218));t.Pool=u.default,t.default=u.default},21557:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_ACQUISITION_TIMEOUT=t.DEFAULT_MAX_SIZE=void 0;var n=100;t.DEFAULT_MAX_SIZE=n;var r=6e4;t.DEFAULT_ACQUISITION_TIMEOUT=r;var i=function(){function e(e,t){this.maxSize=o(e,n),this.acquisitionTimeout=o(t,r)}return e.defaultConfig=function(){return new e(n,r)},e.fromDriverConfig=function(t){return new e(s(t.maxConnectionPoolSize)?t.maxConnectionPoolSize:n,s(t.connectionAcquisitionTimeout)?t.connectionAcquisitionTimeout:r)},e}();function o(e,t){return s(e)?e:t}function s(e){return 0===e||null!=e}t.default=i},25218:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(21557)),a=n(40351),u=n(22541),c=function(){function e(e){var t=e.create,n=void 0===t?function(e,t,n){return r(x,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,Promise.reject(new Error("Not implemented"))];case 1:return[2,e.sent()]}}))}))}:t,o=e.destroy,a=void 0===o?function(e){return r(x,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,Promise.resolve()];case 1:return[2,e.sent()]}}))}))}:o,c=e.validateOnAcquire,l=void 0===c?function(e,t){return!0}:c,h=e.validateOnRelease,d=void 0===h?function(e){return!0}:h,f=e.installIdleObserver,p=void 0===f?function(e,t){}:f,m=e.removeIdleObserver,g=void 0===m?function(e){}:m,v=e.config,y=void 0===v?s.default.defaultConfig():v,b=e.log,_=void 0===b?u.Logger.noOp():b,x=this;this._create=n,this._destroy=a,this._validateOnAcquire=l,this._validateOnRelease=d,this._installIdleObserver=p,this._removeIdleObserver=g,this._maxSize=y.maxSize,this._acquisitionTimeout=y.acquisitionTimeout,this._pools={},this._pendingCreates={},this._acquireRequests={},this._activeResourceCounts={},this._release=this._release.bind(this),this._log=_,this._closed=!1}return e.prototype.acquire=function(e,t,n){return r(this,void 0,void 0,(function(){var r,o,s=this;return i(this,(function(i){switch(i.label){case 0:return r=t.asKey(),o=this._acquireRequests,null==o[r]&&(o[r]=[]),[4,new Promise((function(i,u){var c=setTimeout((function(){var e=o[r];if(null!=e&&(o[r]=e.filter((function(e){return e!==l}))),l.isCompleted());else{var n=s.activeResourceCount(t),i=s.has(t)?s._pools[r].length:0;l.reject((0,a.newError)("Connection acquisition timed out in ".concat(s._acquisitionTimeout," ms. Pool status: Active conn count = ").concat(n,", Idle conn count = ").concat(i,".")))}}),s._acquisitionTimeout);"object"==typeof c&&c.unref();var l=new d(r,e,n,i,u,c,s._log);o[r].push(l),s._processPendingAcquireRequests(t)}))];case 1:return[2,i.sent()]}}))}))},e.prototype.purge=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this._purgeKey(e.asKey())];case 1:return[2,t.sent()]}}))}))},e.prototype.apply=function(e,t){var n=e.asKey();n in this._pools&&this._pools[n].apply(t)},e.prototype.close=function(){return r(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){switch(t.label){case 0:return this._closed=!0,[4,Promise.all(Object.keys(this._pools).map((function(t){return r(e,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this._purgeKey(t)];case 1:return[2,e.sent()]}}))}))}))).then()];case 1:return[2,t.sent()]}}))}))},e.prototype.keepAll=function(e){return r(this,void 0,void 0,(function(){var t,n,o,s=this;return i(this,(function(a){switch(a.label){case 0:return t=e.map((function(e){return e.asKey()})),n=Object.keys(this._pools),o=n.filter((function(e){return!t.includes(e)})),[4,Promise.all(o.map((function(e){return r(s,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this._purgeKey(e)];case 1:return[2,t.sent()]}}))}))}))).then()];case 1:return[2,a.sent()]}}))}))},e.prototype.has=function(e){return e.asKey()in this._pools},e.prototype.activeResourceCount=function(e){var t;return null!==(t=this._activeResourceCounts[e.asKey()])&&void 0!==t?t:0},e.prototype._getOrInitializePoolFor=function(e){var t=this._pools[e];return null==t&&(t=new f,this._pools[e]=t,this._pendingCreates[e]=0),t},e.prototype._acquire=function(e,t,n){return r(this,void 0,void 0,(function(){var o,s,u,c,d,f,p,m=this;return i(this,(function(g){switch(g.label){case 0:if(this._closed)throw(0,a.newError)("Pool is closed, it is no more able to serve requests.");if(o=t.asKey(),s=this._getOrInitializePoolFor(o),n)return[3,10];g.label=1;case 1:if(!(s.length>0))return[3,10];if(null==(u=s.pop()))return[3,1];l(o,this._activeResourceCounts),null!=this._removeIdleObserver&&this._removeIdleObserver(u),c=!1,g.label=2;case 2:return g.trys.push([2,4,,6]),[4,this._validateOnAcquire(e,u)];case 3:return c=g.sent(),[3,6];case 4:return d=g.sent(),h(o,this._activeResourceCounts),s.removeInUse(u),[4,this._destroy(u)];case 5:throw g.sent(),d;case 6:return c?(this._log.isDebugEnabled()&&this._log.debug("".concat(u," acquired from the pool ").concat(o)),[2,{resource:u,pool:s}]):[3,7];case 7:return h(o,this._activeResourceCounts),s.removeInUse(u),[4,this._destroy(u)];case 8:g.sent(),g.label=9;case 9:return[3,1];case 10:if(this._maxSize>0&&this.activeResourceCount(t)+this._pendingCreates[o]>=this._maxSize)return[2,{resource:null,pool:s}];this._pendingCreates[o]=this._pendingCreates[o]+1,g.label=11;case 11:return g.trys.push([11,,15,16]),this.activeResourceCount(t)+s.length>=this._maxSize&&n?null==(p=s.pop())?[3,13]:(null!=this._removeIdleObserver&&this._removeIdleObserver(p),s.removeInUse(p),[4,this._destroy(p)]):[3,13];case 12:g.sent(),g.label=13;case 13:return[4,this._create(e,t,(function(e,t){return r(m,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,this._release(e,t,s)];case 1:return[2,n.sent()]}}))}))}))];case 14:return f=g.sent(),s.pushInUse(f),l(o,this._activeResourceCounts),this._log.isDebugEnabled()&&this._log.debug("".concat(f," created for the pool ").concat(o)),[3,16];case 15:return this._pendingCreates[o]=this._pendingCreates[o]-1,[7];case 16:return[2,{resource:f,pool:s}]}}))}))},e.prototype._release=function(e,t,n){return r(this,void 0,void 0,(function(){var r,o=this;return i(this,(function(i){switch(i.label){case 0:r=e.asKey(),i.label=1;case 1:return i.trys.push([1,,9,10]),n.isActive()?[4,this._validateOnRelease(t)]:[3,6];case 2:return i.sent()?[3,4]:(this._log.isDebugEnabled()&&this._log.debug("".concat(t," destroyed and can't be released to the pool ").concat(r," because it is not functional")),n.removeInUse(t),[4,this._destroy(t)]);case 3:return i.sent(),[3,5];case 4:null!=this._installIdleObserver&&this._installIdleObserver(t,{onError:function(e){o._log.debug("Idle connection ".concat(t," destroyed because of error: ").concat(e));var n=o._pools[r];null!=n&&(o._pools[r]=n.filter((function(e){return e!==t})),n.removeInUse(t)),o._destroy(t).catch((function(){}))}}),n.push(t),this._log.isDebugEnabled()&&this._log.debug("".concat(t," released to the pool ").concat(r)),i.label=5;case 5:return[3,8];case 6:return this._log.isDebugEnabled()&&this._log.debug("".concat(t," destroyed and can't be released to the pool ").concat(r," because pool has been purged")),n.removeInUse(t),[4,this._destroy(t)];case 7:i.sent(),i.label=8;case 8:return[3,10];case 9:return h(r,this._activeResourceCounts),this._processPendingAcquireRequests(e),[7];case 10:return[2]}}))}))},e.prototype._purgeKey=function(e){return r(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(i){switch(i.label){case 0:if(t=this._pools[e],n=[],null==t)return[3,2];for(;t.length>0;)null!=(r=t.pop())&&(null!=this._removeIdleObserver&&this._removeIdleObserver(r),n.push(this._destroy(r)));return t.close(),delete this._pools[e],[4,Promise.all(n)];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))},e.prototype._processPendingAcquireRequests=function(e){var t=this,n=e.asKey(),r=this._acquireRequests[n];if(null!=r){var i=r.shift();null!=i?this._acquire(i.context,e,i.requireNew).catch((function(e){return i.reject(e),{resource:null,pool:null}})).then((function(r){var o=r.resource,s=r.pool;null!=o&&null!=s?i.isCompleted()?t._release(e,o,s).catch((function(e){t._log.isDebugEnabled()&&t._log.debug("".concat(o," could not be release back to the pool. Cause: ").concat(e))})):i.resolve(o):i.isCompleted()||(null==t._acquireRequests[n]&&(t._acquireRequests[n]=[]),t._acquireRequests[n].unshift(i))})).catch((function(e){return i.reject(e)})):delete this._acquireRequests[n]}},e}();function l(e,t){var n,r=null!==(n=t[e])&&void 0!==n?n:0;t[e]=r+1}function h(e,t){var n,r=(null!==(n=t[e])&&void 0!==n?n:0)-1;r>0?t[e]=r:delete t[e]}var d=function(){function e(e,t,n,r,i,o,s){this._key=e,this._context=t,this._resolve=r,this._reject=i,this._timeoutId=o,this._log=s,this._completed=!1,this._config=null!=n?n:{}}return Object.defineProperty(e.prototype,"context",{get:function(){return this._context},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"requireNew",{get:function(){var e;return null!==(e=this._config.requireNew)&&void 0!==e&&e},enumerable:!1,configurable:!0}),e.prototype.isCompleted=function(){return this._completed},e.prototype.resolve=function(e){this._completed||(this._completed=!0,clearTimeout(this._timeoutId),this._log.isDebugEnabled()&&this._log.debug("".concat(e," acquired from the pool ").concat(this._key)),this._resolve(e))},e.prototype.reject=function(e){this._completed||(this._completed=!0,clearTimeout(this._timeoutId),this._reject(e))},e}(),f=function(){function e(){this._active=!0,this._elements=[],this._elementsInUse=new Set}return e.prototype.isActive=function(){return this._active},e.prototype.close=function(){this._active=!1,this._elements=[],this._elementsInUse=new Set},e.prototype.filter=function(e){return this._elements=this._elements.filter(e),this},e.prototype.apply=function(e){this._elements.forEach(e),this._elementsInUse.forEach(e)},Object.defineProperty(e.prototype,"length",{get:function(){return this._elements.length},enumerable:!1,configurable:!0}),e.prototype.pop=function(){var e=this._elements.pop();return null!=e&&this._elementsInUse.add(e),e},e.prototype.push=function(e){return this._elementsInUse.delete(e),this._elements.push(e)},e.prototype.pushInUse=function(e){this._elementsInUse.add(e)},e.prototype.removeInUse=function(e){this._elementsInUse.delete(e)},e}();t.default=c},61346:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(83019),s=function(){function e(e){this._createSession=e}return e.prototype.execute=function(e,t,n){return r(this,void 0,void 0,(function(){var s,a,u=this;return i(this,(function(c){switch(c.label){case 0:s=this._createSession({database:e.database,bookmarkManager:e.bookmarkManager,impersonatedUser:e.impersonatedUser,auth:e.auth}),a=function(e,t,n){"function"==typeof(null==e?void 0:e.addEventListener)&&e.addEventListener(t,n);return{uninstall:function(){"function"==typeof(null==e?void 0:e.removeEventListener)&&e.removeEventListener(t,n)}}}(e.signal,"abort",(function(){return r(u,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,s.close()];case 1:return[2,e.sent()]}}))}))})),s._configureTransactionExecutor(!0,o.TELEMETRY_APIS.EXECUTE_QUERY),c.label=1;case 1:return c.trys.push([1,,3,5]),[4,("READ"===e.routing?s.executeRead.bind(s):s.executeWrite.bind(s))((function(o){return r(u,void 0,void 0,(function(){var r;return i(this,(function(i){switch(i.label){case 0:return r=o.run(t,n),[4,e.resultTransformer(r)];case 1:return[2,i.sent()]}}))}))}),e.transactionConfig)];case 2:return[2,c.sent()];case 3:return a.uninstall(),[4,s.close()];case 4:return c.sent(),[7];case 5:return[2]}}))}))},e}();t.default=s},24927:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.resolve=function(){throw new Error("Abstract function")},e.prototype._resolveToItself=function(e){return Promise.resolve([e])},e}();t.default=n},23878:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(26220);function i(e){return Promise.resolve([e])}var o=function(){function e(e){this._resolverFunction=null!=e?e:i}return e.prototype.resolve=function(e){var t=this;return new Promise((function(n){return n(t._resolverFunction(e.asHostPort()))})).then((function(e){if(!Array.isArray(e))throw new TypeError("Configured resolver function should either return an array of addresses or a Promise resolved with an array of addresses."+"Each address is '<host>:<port>'. Got: ".concat(e));return e.map((function(e){return r.ServerAddress.fromUrl(e)}))}))},e}();t.default=o},33895:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ConfiguredCustomResolver=t.BaseHostNameResolver=void 0;var i=r(n(24927));t.BaseHostNameResolver=i.default;var o=r(n(23878));t.ConfiguredCustomResolver=o.default},26220:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ServerAddress=void 0;var s=n(83755),a=o(n(2209)),u=function(){function e(e,t,n,r){this._host=(0,s.assertString)(e,"host"),this._resolved=null!=t?(0,s.assertString)(t,"resolved"):null,this._port=(0,s.assertNumber)(n,"port"),this._hostPort=r,this._stringValue=null!=t?"".concat(r,"(").concat(t,")"):"".concat(r)}return e.prototype.host=function(){return this._host},e.prototype.resolvedHost=function(){return null!=this._resolved?this._resolved:this._host},e.prototype.port=function(){return this._port},e.prototype.resolveWith=function(t){return new e(this._host,t,this._port,this._hostPort)},e.prototype.asHostPort=function(){return this._hostPort},e.prototype.asKey=function(){return this._hostPort},e.prototype.toString=function(){return this._stringValue},e.fromUrl=function(t){var n=a.parseDatabaseUrl(t);return new e(n.host,null,n.port,n.hostAndPort)},e}();t.ServerAddress=u},53799:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.floorMod=t.floorDiv=t.assertValidZoneId=t.assertValidNanosecond=t.assertValidSecond=t.assertValidMinute=t.assertValidHour=t.assertValidDay=t.assertValidMonth=t.assertValidYear=t.timeZoneOffsetInSeconds=t.totalNanoseconds=t.newDate=t.toStandardDate=t.isoStringToStandardDate=t.dateToIsoString=t.timeZoneOffsetToIsoString=t.timeToIsoString=t.durationToIsoString=t.dateToEpochDay=t.localDateTimeToEpochSecond=t.localTimeToNanoOfDay=t.normalizeNanosecondsForDuration=t.normalizeSecondsForDuration=t.SECONDS_PER_DAY=t.DAYS_PER_400_YEAR_CYCLE=t.DAYS_0000_TO_1970=t.NANOS_PER_HOUR=t.NANOS_PER_MINUTE=t.NANOS_PER_MILLISECOND=t.NANOS_PER_SECOND=t.SECONDS_PER_HOUR=t.SECONDS_PER_MINUTE=t.MINUTES_PER_HOUR=t.NANOSECOND_OF_SECOND_RANGE=t.SECOND_OF_MINUTE_RANGE=t.MINUTE_OF_HOUR_RANGE=t.HOUR_OF_DAY_RANGE=t.DAY_OF_MONTH_RANGE=t.MONTH_OF_YEAR_RANGE=t.YEAR_RANGE=void 0;var s=o(n(45884)),a=n(40351),u=n(83755),c=function(){function e(e,t){this._minNumber=e,this._maxNumber=t,this._minInteger=(0,s.int)(e),this._maxInteger=(0,s.int)(t)}return e.prototype.contains=function(e){if((0,s.isInt)(e)&&e instanceof s.default)return e.greaterThanOrEqual(this._minInteger)&&e.lessThanOrEqual(this._maxInteger);if("bigint"==typeof e){var t=(0,s.int)(e);return t.greaterThanOrEqual(this._minInteger)&&t.lessThanOrEqual(this._maxInteger)}return e>=this._minNumber&&e<=this._maxNumber},e.prototype.toString=function(){return"[".concat(this._minNumber,", ").concat(this._maxNumber,"]")},e}();function l(e,n,r){e=(0,s.int)(e),n=(0,s.int)(n),r=(0,s.int)(r);var i=e.multiply(365);return i=(i=(i=e.greaterThanOrEqual(0)?i.add(e.add(3).div(4).subtract(e.add(99).div(100)).add(e.add(399).div(400))):i.subtract(e.div(-4).subtract(e.div(-100)).add(e.div(-400)))).add(n.multiply(367).subtract(362).div(12))).add(r.subtract(1)),n.greaterThan(2)&&(i=i.subtract(1),function(e){return e=(0,s.int)(e),!!e.modulo(4).equals(0)&&(!e.modulo(100).equals(0)||!!e.modulo(400).equals(0))}(e)||(i=i.subtract(1))),i.subtract(t.DAYS_0000_TO_1970)}t.YEAR_RANGE=new c(-999999999,999999999),t.MONTH_OF_YEAR_RANGE=new c(1,12),t.DAY_OF_MONTH_RANGE=new c(1,31),t.HOUR_OF_DAY_RANGE=new c(0,23),t.MINUTE_OF_HOUR_RANGE=new c(0,59),t.SECOND_OF_MINUTE_RANGE=new c(0,59),t.NANOSECOND_OF_SECOND_RANGE=new c(0,999999999),t.MINUTES_PER_HOUR=60,t.SECONDS_PER_MINUTE=60,t.SECONDS_PER_HOUR=t.SECONDS_PER_MINUTE*t.MINUTES_PER_HOUR,t.NANOS_PER_SECOND=1e9,t.NANOS_PER_MILLISECOND=1e6,t.NANOS_PER_MINUTE=t.NANOS_PER_SECOND*t.SECONDS_PER_MINUTE,t.NANOS_PER_HOUR=t.NANOS_PER_MINUTE*t.MINUTES_PER_HOUR,t.DAYS_0000_TO_1970=719528,t.DAYS_PER_400_YEAR_CYCLE=146097,t.SECONDS_PER_DAY=86400,t.normalizeSecondsForDuration=function(e,n){return(0,s.int)(e).add(p(n,t.NANOS_PER_SECOND))},t.normalizeNanosecondsForDuration=function(e){return m(e,t.NANOS_PER_SECOND)},t.localTimeToNanoOfDay=function(e,n,r,i){e=(0,s.int)(e),n=(0,s.int)(n),r=(0,s.int)(r),i=(0,s.int)(i);var o=e.multiply(t.NANOS_PER_HOUR);return(o=(o=o.add(n.multiply(t.NANOS_PER_MINUTE))).add(r.multiply(t.NANOS_PER_SECOND))).add(i)},t.localDateTimeToEpochSecond=function(e,n,r,i,o,a,u){var c=l(e,n,r),h=function(e,n,r){e=(0,s.int)(e),n=(0,s.int)(n),r=(0,s.int)(r);var i=e.multiply(t.SECONDS_PER_HOUR);return i=i.add(n.multiply(t.SECONDS_PER_MINUTE)),i.add(r)}(i,o,a);return c.multiply(t.SECONDS_PER_DAY).add(h)},t.dateToEpochDay=l,t.durationToIsoString=function(e,n,r,i){var o=v(e),a=v(n),u=function(e,n){var r,i;e=(0,s.int)(e),n=(0,s.int)(n);var o=e.isNegative(),a=n.greaterThan(0);r=o&&a?e.equals(-1)?"-0":e.add(1).toString():e.toString();a&&(i=g(o?n.negate().add(2*t.NANOS_PER_SECOND).modulo(t.NANOS_PER_SECOND):n.add(t.NANOS_PER_SECOND).modulo(t.NANOS_PER_SECOND)));return null!=i?r+i:r}(r,i);return"P".concat(o,"M").concat(a,"DT").concat(u,"S")},t.timeToIsoString=function(e,t,n,r){var i=v(e,2),o=v(t,2),s=v(n,2),a=g(r);return"".concat(i,":").concat(o,":").concat(s).concat(a)},t.timeZoneOffsetToIsoString=function(e){if((e=(0,s.int)(e)).equals(0))return"Z";var n=e.isNegative();n&&(e=e.multiply(-1));var r=n?"-":"+",i=v(e.div(t.SECONDS_PER_HOUR),2),o=v(e.div(t.SECONDS_PER_MINUTE).modulo(t.MINUTES_PER_HOUR),2),a=e.modulo(t.SECONDS_PER_MINUTE),u=a.equals(0)?null:v(a,2);return null!=u?"".concat(r).concat(i,":").concat(o,":").concat(u):"".concat(r).concat(i,":").concat(o)},t.dateToIsoString=function(e,t,n){var r=function(e){var t=(0,s.int)(e);if(t.isNegative()||t.greaterThan(9999))return v(t,6,{usePositiveSign:!0});return v(t,4)}(e),i=v(t,2),o=v(n,2);return"".concat(r,"-").concat(i,"-").concat(o)},t.isoStringToStandardDate=function(e){return new Date(e)},t.toStandardDate=function(e){return new Date(e)},t.newDate=function(e){return new Date(e)},t.totalNanoseconds=function(e,n){return function(e,t){if(e instanceof s.default)return e.add(t);if("bigint"==typeof e)return e+BigInt(t);return e+t}(n=null!=n?n:0,e.getMilliseconds()*t.NANOS_PER_MILLISECOND)},t.timeZoneOffsetInSeconds=function(e){var n=e.getSeconds()>=e.getUTCSeconds()?e.getSeconds()-e.getUTCSeconds():e.getSeconds()-e.getUTCSeconds()+60,r=e.getTimezoneOffset();return 0===r?0+n:-1*r*t.SECONDS_PER_MINUTE+n},t.assertValidYear=function(e){return f(e,t.YEAR_RANGE,"Year")},t.assertValidMonth=function(e){return f(e,t.MONTH_OF_YEAR_RANGE,"Month")},t.assertValidDay=function(e){return f(e,t.DAY_OF_MONTH_RANGE,"Day")},t.assertValidHour=function(e){return f(e,t.HOUR_OF_DAY_RANGE,"Hour")},t.assertValidMinute=function(e){return f(e,t.MINUTE_OF_HOUR_RANGE,"Minute")},t.assertValidSecond=function(e){return f(e,t.SECOND_OF_MINUTE_RANGE,"Second")},t.assertValidNanosecond=function(e){return f(e,t.NANOSECOND_OF_SECOND_RANGE,"Nanosecond")};var h=new Map,d=function(e,t){return(0,a.newError)("".concat(t,' is expected to be a valid ZoneId but was: "').concat(e,'"'))};function f(e,t,n){if((0,u.assertNumberOrInteger)(e,n),!t.contains(e))throw(0,a.newError)("".concat(n," is expected to be in range ").concat(t.toString()," but was: ").concat(e.toString()));return e}function p(e,t){e=(0,s.int)(e),t=(0,s.int)(t);var n=e.div(t);return e.isPositive()!==t.isPositive()&&n.multiply(t).notEquals(e)&&(n=n.subtract(1)),n}function m(e,t){return e=(0,s.int)(e),t=(0,s.int)(t),e.subtract(p(e,t).multiply(t))}function g(e){return(e=(0,s.int)(e)).equals(0)?"":"."+v(e,9)}function v(e,t,n){var r=(e=(0,s.int)(e)).isNegative();r&&(e=e.negate());var i=e.toString();if(null!=t)for(;i.length<t;)i="0"+i;return r?"-"+i:!0===(null==n?void 0:n.usePositiveSign)?"+"+i:i}t.assertValidZoneId=function(e,t){var n=h.get(t);if(!0!==n){if(!1===n)throw d(t,e);try{Intl.DateTimeFormat(void 0,{timeZone:t}),h.set(t,!0)}catch(n){throw h.set(t,!1),d(t,e)}}},t.floorDiv=p,t.floorMod=m},93954:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},s=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.TransactionExecutor=void 0;var u=n(40351),c=n(83019);function l(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,a([e,t],s(n),!1))}function h(e){return clearTimeout(e)}var d=function(){function e(e,t,n,r,i){void 0===i&&(i={setTimeout:l,clearTimeout:h}),this._maxRetryTimeMs=f(e,3e4),this._initialRetryDelayMs=f(t,1e3),this._multiplier=f(n,2),this._jitterFactor=f(r,.2),this._setTimeout=i.setTimeout,this._clearTimeout=i.clearTimeout,this._inFlightTimeoutIds=[],this.pipelineBegin=!1,this.telemetryApi=c.TELEMETRY_APIS.MANAGED_TRANSACTION,this._verifyAfterConstruction()}return e.prototype.execute=function(e,t,n){var r=this,i={apiTransactionConfig:{api:this.telemetryApi,onTelemetrySuccess:function(){i.apiTransactionConfig=void 0}}};return new Promise((function(o,s){r._executeTransactionInsidePromise(e,t,o,s,n,i).catch(s)})).catch((function(o){var s=Date.now(),a=r._initialRetryDelayMs;return r._retryTransactionPromise(e,t,o,s,a,n,i)}))},e.prototype.close=function(){var e=this;this._inFlightTimeoutIds.forEach((function(t){return e._clearTimeout(t)})),this._inFlightTimeoutIds=[]},e.prototype._retryTransactionPromise=function(e,t,n,r,i,o,s){var a=this;return Date.now()-r>this._maxRetryTimeMs||!(0,u.isRetriableError)(n)?Promise.reject(n):new Promise((function(n,r){var u=a._computeDelayWithJitter(i),c=a._setTimeout((function(){a._inFlightTimeoutIds=a._inFlightTimeoutIds.filter((function(e){return e!==c})),a._executeTransactionInsidePromise(e,t,n,r,o,s).catch(r)}),u);a._inFlightTimeoutIds.push(c)})).catch((function(n){var u=i*a._multiplier;return a._retryTransactionPromise(e,t,n,r,u,o,s)}))},e.prototype._executeTransactionInsidePromise=function(e,t,n,s,a,u){return i(this,void 0,void 0,(function(){var i,c,l,h,d,f,p=this;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),c=e(null!=(null==u?void 0:u.apiTransactionConfig)?r({},null==u?void 0:u.apiTransactionConfig):void 0),this.pipelineBegin?(l=c,[3,3]):[3,1];case 1:return[4,c];case 2:l=o.sent(),o.label=3;case 3:return i=l,[3,5];case 4:return h=o.sent(),s(h),[2];case 5:return d=null!=a?a:function(e){return e},f=d(i),this._safeExecuteTransactionWork(f,t).then((function(e){return p._handleTransactionWorkSuccess(e,i,n,s)})).catch((function(e){return p._handleTransactionWorkFailure(e,i,s)})),[2]}}))}))},e.prototype._safeExecuteTransactionWork=function(e,t){try{var n=t(e);return Promise.resolve(n)}catch(e){return Promise.reject(e)}},e.prototype._handleTransactionWorkSuccess=function(e,t,n,r){t.isOpen()?t.commit().then((function(){n(e)})).catch((function(e){r(e)})):n(e)},e.prototype._handleTransactionWorkFailure=function(e,t,n){t.isOpen()?t.rollback().catch((function(e){})).then((function(){return n(e)})).catch(n):n(e)},e.prototype._computeDelayWithJitter=function(e){var t=e*this._jitterFactor,n=e-t,r=e+t;return Math.random()*(r-n)+n},e.prototype._verifyAfterConstruction=function(){if(this._maxRetryTimeMs<0)throw(0,u.newError)("Max retry time should be >= 0: "+this._maxRetryTimeMs.toString());if(this._initialRetryDelayMs<0)throw(0,u.newError)("Initial retry delay should >= 0: "+this._initialRetryDelayMs.toString());if(this._multiplier<1)throw(0,u.newError)("Multiplier should be >= 1.0: "+this._multiplier.toString());if(this._jitterFactor<0||this._jitterFactor>1)throw(0,u.newError)("Jitter factor should be in [0.0, 1.0]: "+this._jitterFactor.toFixed())},e}();function f(e,t){return null!=e?e:t}t.TransactionExecutor=d},76857:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.TxConfig=void 0;var s=o(n(83755)),a=n(40351),u=n(45884),c=function(){function e(e,t){!function(e){null!=e&&s.assertObject(e,"Transaction config")}(e),this.timeout=function(e,t){if(s.isObject(e)&&null!=e.timeout){s.assertNumberOrInteger(e.timeout,"Transaction timeout"),function(e){return"number"==typeof e.timeout&&!Number.isInteger(e.timeout)}(e)&&!0===(null==t?void 0:t.isInfoEnabled())&&(null==t||t.info("Transaction timeout expected to be an integer, got: ".concat(e.timeout,". The value will be rounded up.")));var n=(0,u.int)(e.timeout,{ceilFloat:!0});if(n.isNegative())throw(0,a.newError)("Transaction timeout should not be negative");return n}return null}(e,t),this.metadata=function(e){if(s.isObject(e)&&null!=e.metadata){var t=e.metadata;if(s.assertObject(t,"config.metadata"),0!==Object.keys(t).length)return t}return null}(e)}return e.empty=function(){return l},e.prototype.isEmpty=function(){return Object.values(this).every((function(e){return null==e}))},e}();t.TxConfig=c;var l=new c({})},2209:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s};Object.defineProperty(t,"__esModule",{value:!0}),t.Url=t.formatIPv6Address=t.formatIPv4Address=t.defaultPortForScheme=t.parseDatabaseUrl=void 0;var o=n(83755),s=function(e,t,n,r,i){this.scheme=e,this.host=t,this.port=n,this.hostAndPort=r,this.query=i};function a(e,t,n){if(""===(e=(null!=e?e:"").trim()))throw new Error("Illegal empty ".concat(t," in URL query '").concat(n,"'"));return e}function u(e){var t="["===e.charAt(0),n="]"===e.charAt(e.length-1);if(t||n){if(t&&n)return e;throw new Error("Illegal IPv6 address ".concat(e))}return"[".concat(e,"]")}function c(e){return"http"===e?7474:"https"===e?7473:7687}t.Url=s,t.parseDatabaseUrl=function(e){var t;(0,o.assertString)(e,"URL");var n=function(e){if(e=e.trim(),!e.includes("://"))return{schemeMissing:!0,url:"none://".concat(e)};return{schemeMissing:!1,url:e}}(e),l=function(e){function t(e,t){var n=e.indexOf(t);return n>=0?[e.substring(0,n),e[n],e.substring(n+1)]:[e,"",""]}function n(e,t){var n=e.lastIndexOf(t);return n>=0?[e.substring(0,n),e[n],e.substring(n+1)]:["","",e]}function o(e,n,r){var i=t(e,n),o=t(i[2],r);return[o[0],o[2]]}function s(e){var r,s={};"@"===(r=n(e,"@"))[1]&&(s.userInfo=decodeURIComponent(r[0]),e=r[2]);var a=i(o(e,"[","]"),2),u=a[0],c=a[1];return""!==u?(s.host=u,r=t(c,":")):(r=t(e,":"),s.host=r[0]),":"===r[1]&&(s.port=r[2]),s}var a,u={};":"===(a=t(e,":"))[1]&&(u.scheme=decodeURIComponent(a[0]),e=a[2]);"#"===(a=t(e,"#"))[1]&&(u.fragment=decodeURIComponent(a[2]),e=a[0]);"?"===(a=t(e,"?"))[1]&&(u.query=a[2],e=a[0]);e.startsWith("//")?(a=t(e.substr(2),"/"),(u=r(r({},u),s(a[0]))).path=a[1]+a[2]):u.path=e;return u}(n.url),h=n.schemeMissing?null:function(e){if(null!=e)return":"===(e=e.trim()).charAt(e.length-1)&&(e=e.substring(0,e.length-1)),e;return null}(l.scheme),d=function(e,t){if(null==e)throw new Error("Unable to extract host from null or undefined URL");return e.trim()}(l.host),f=function(e){if(""===e||null==e)throw new Error("Illegal host ".concat(e));var t=e.includes(":");return t?u(e):e}(d),p=function(e,t){var n="string"==typeof e?parseInt(e,10):e;return null==n||isNaN(n)?c(t):n}(l.port,h),m="".concat(f,":").concat(p),g=function(e,t){var n=null!=e?function(e){e=(null!=e?e:"").trim(),"?"===(null==e?void 0:e.charAt(0))&&(e=e.substring(1,e.length));return e}(e):null,r={};null!=n&&n.split("&").forEach((function(e){var n=e.split("=");if(2!==n.length)throw new Error("Invalid parameters: '".concat(n.toString(),"' in URL '").concat(t,"'."));var i=a(n[0],"key",t),o=a(n[1],"value",t);if(void 0!==r[i])throw new Error("Duplicated query parameters with key '".concat(i,"' in URL '").concat(t,"'"));r[i]=o}));return r}(null!==(t=l.query)&&void 0!==t?t:function(e){if("string"!=typeof e)return null;var t=i(e.split("?"),2),n=t[1];return n}(l.resourceName),e);return new s(h,d,p,m,g)},t.formatIPv4Address=function(e,t){return"".concat(e,":").concat(t)},t.formatIPv6Address=function(e,t){var n=u(e);return"".concat(n,":").concat(t)},t.defaultPortForScheme=c},83755:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.ENCRYPTION_OFF=t.ENCRYPTION_ON=t.equals=t.validateQueryAndParameters=t.toNumber=t.assertValidDate=t.assertNumberOrInteger=t.assertNumber=t.assertString=t.assertObject=t.isString=t.isObject=t.isEmptyObjectOrNull=void 0;var a=o(n(45884)),u=n(90831);t.ENCRYPTION_ON="ENCRYPTION_ON";function c(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e}function l(e,t){if(!h(e))throw new TypeError((0,u.stringify)(t)+" expected to be string but was: "+(0,u.stringify)(e));return e}function h(e){return"[object String]"===Object.prototype.toString.call(e)}t.ENCRYPTION_OFF="ENCRYPTION_OFF",t.isEmptyObjectOrNull=function(e){if(null===e)return!0;if(!c(e))return!1;for(var t in e)if(void 0!==e[t])return!1;return!0},t.isObject=c,t.validateQueryAndParameters=function(e,t,n){var r,i,o="",s=null!=t?t:{},a=null!==(r=null==n?void 0:n.skipAsserts)&&void 0!==r&&r;return"string"==typeof e?o=e:e instanceof String?o=e.toString():"object"==typeof e&&null!=e.text&&(o=e.text,s=null!==(i=e.parameters)&&void 0!==i?i:{}),a||(function(e){if(l(e,"Cypher query"),0===e.trim().length)throw new TypeError("Cypher query is expected to be a non-empty string.")}(o),function(e){if(!c(e)){var t=null!=e.constructor?" "+e.constructor.name:"";throw new TypeError("Query parameters are expected to either be undefined/null or an object, given:".concat(t," ").concat(JSON.stringify(e)))}}(s)),{validatedQuery:o,params:s}},t.assertObject=function(e,t){if(!c(e))throw new TypeError(t+" expected to be an object but was: "+(0,u.stringify)(e));return e},t.assertString=l,t.assertNumber=function(e,t){if("number"!=typeof e)throw new TypeError(t+" expected to be a number but was: "+(0,u.stringify)(e));return e},t.assertNumberOrInteger=function(e,t){if("number"!=typeof e&&"bigint"!=typeof e&&!(0,a.isInt)(e))throw new TypeError(t+" expected to be either a number or an Integer object but was: "+(0,u.stringify)(e));return e},t.assertValidDate=function(e,t){if("[object Date]"!==Object.prototype.toString.call(e))throw new TypeError(t+" expected to be a standard JavaScript Date but was: "+(0,u.stringify)(e));if(Number.isNaN(e.getTime()))throw new TypeError(t+" expected to be valid JavaScript Date but its time was NaN: "+(0,u.stringify)(e));return e},t.isString=h,t.equals=function e(t,n){var r,i;if(t===n)return!0;if(null===t||null===n)return!1;if("object"==typeof t&&"object"==typeof n){var o=Object.keys(t),a=Object.keys(n);if(o.length!==a.length)return!1;try{for(var u=s(o),c=u.next();!c.done;c=u.next()){var l=c.value;if(!e(t[l],n[l]))return!1}}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return!0}return!1},t.toNumber=function(e){return e instanceof a.default?e.toNumber():"bigint"==typeof e?(0,a.int)(e).toNumber():e}},90831:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringify=void 0;var r=n(44510);t.stringify=function(e,t){return JSON.stringify(e,(function(e,n){return(0,r.isBrokenObject)(n)?{__isBrokenObject__:!0,__reason__:(0,r.getBrokenObjectReason)(n)}:"bigint"==typeof n?"".concat(n,"n"):!0!==(null==t?void 0:t.useCustomToString)||"object"!=typeof n||Array.isArray(n)||"function"!=typeof n.toString||n.toString===Object.prototype.toString?n:null==n?void 0:n.toString()}))}},24649:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notificationFilterDisabledClassification=t.notificationFilterDisabledCategory=t.notificationFilterMinimumSeverityLevel=void 0;var n={OFF:"OFF",WARNING:"WARNING",INFORMATION:"INFORMATION"};t.notificationFilterMinimumSeverityLevel=n,Object.freeze(n);var r={HINT:"HINT",UNRECOGNIZED:"UNRECOGNIZED",UNSUPPORTED:"UNSUPPORTED",PERFORMANCE:"PERFORMANCE",TOPOLOGY:"TOPOLOGY",SECURITY:"SECURITY",DEPRECATION:"DEPRECATION",GENERIC:"GENERIC",SCHEMA:"SCHEMA"};t.notificationFilterDisabledCategory=r,Object.freeze(r);var i=r;t.notificationFilterDisabledClassification=i;var o=function(){throw this.minimumSeverityLevel=void 0,this.disabledCategories=void 0,this.disabledClassifications=void 0,new Error("Not implemented")};t.default=o},64256:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},u=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.buildNotificationsFromMetadata=t.buildGqlStatusObjectFromMetadata=t.polyfillNotification=t.polyfillGqlStatusObject=t.GqlStatusObject=t.Notification=t.notificationClassification=t.notificationCategory=t.notificationSeverityLevel=void 0;var c=s(n(90831)),l=n(7705),h=n(99364),d={WARNING:{gql_status:"01N42",status_description:"warn: unknown warning"},NO_DATA:{gql_status:"02N42",status_description:"note: no data - unknown subcondition"},INFORMATION:{gql_status:"03N42",status_description:"info: unknown notification"},ERROR:{gql_status:"50N42",status_description:"error: general processing exception - unexpected error"}},f={WARNING:"WARNING",INFORMATION:"INFORMATION",UNKNOWN:"UNKNOWN"};t.notificationSeverityLevel=f,Object.freeze(f);var p=Object.values(f),m={HINT:"HINT",UNRECOGNIZED:"UNRECOGNIZED",UNSUPPORTED:"UNSUPPORTED",PERFORMANCE:"PERFORMANCE",DEPRECATION:"DEPRECATION",TOPOLOGY:"TOPOLOGY",SECURITY:"SECURITY",GENERIC:"GENERIC",SCHEMA:"SCHEMA",UNKNOWN:"UNKNOWN"};t.notificationCategory=m,Object.freeze(m);var g=Object.values(m),v=m;t.notificationClassification=v;var y=function(e){this.code=e.code,this.title=e.title,this.description=e.description,this.severity=e.severity,this.position=T(e.position),this.severityLevel=M(e.severity),this.rawSeverityLevel=e.severity,this.category=A(e.category),this.rawCategory=e.category};t.Notification=y;var b=function(){function e(e){var t;this.gqlStatus=e.gql_status,this.statusDescription=e.status_description,this.diagnosticRecord=null!==(t=e.diagnostic_record)&&void 0!==t?t:{},this.position=null!=this.diagnosticRecord._position?T(this.diagnosticRecord._position):void 0,this.severity=M(this.diagnosticRecord._severity),this.rawSeverity=this.diagnosticRecord._severity,this.classification=A(this.diagnosticRecord._classification),this.rawClassification=this.diagnosticRecord._classification,this.isNotification=null!=e.neo4j_code,Object.freeze(this)}return Object.defineProperty(e.prototype,"diagnosticRecordAsJsonString",{get:function(){return c.stringify(this.diagnosticRecord,{useCustomToString:!0})},enumerable:!1,configurable:!0}),e}();function _(e){var t,n,r;if(null!=e.neo4j_code)return new y({code:e.neo4j_code,title:e.title,description:e.description,severity:null===(t=e.diagnostic_record)||void 0===t?void 0:t._severity,category:null===(n=e.diagnostic_record)||void 0===n?void 0:n._classification,position:null===(r=e.diagnostic_record)||void 0===r?void 0:r._position})}function x(e){var t,n=e.severity===f.WARNING?d.WARNING:d.INFORMATION,i={gql_status:n.gql_status,status_description:null!==(t=e.description)&&void 0!==t?t:n.status_description,neo4j_code:e.code,title:e.title,diagnostic_record:r({},h.rawPolyfilledDiagnosticRecord)};return null!=e.severity&&(i.diagnostic_record._severity=e.severity),null!=e.category&&(i.diagnostic_record._classification=e.category),null!=e.position&&(i.diagnostic_record._position=e.position),new b(i)}t.GqlStatusObject=b,t.polyfillNotification=_,t.polyfillGqlStatusObject=x;var w={SUCCESS:new b({gql_status:"00000",status_description:"note: successful completion",diagnostic_record:h.rawPolyfilledDiagnosticRecord}),NO_DATA:new b({gql_status:"02000",status_description:"note: no data",diagnostic_record:h.rawPolyfilledDiagnosticRecord}),NO_DATA_UNKNOWN_SUBCONDITION:new b(r(r({},d.NO_DATA),{diagnostic_record:h.rawPolyfilledDiagnosticRecord})),OMITTED_RESULT:new b({gql_status:"00001",status_description:"note: successful completion - omitted result",diagnostic_record:h.rawPolyfilledDiagnosticRecord})};Object.freeze(w),t.buildGqlStatusObjectFromMetadata=function(e){var t,n;if(null!=e.statuses)return e.statuses.map((function(e){return new b(e)}));var r,i=!0===(null==(r=e.stream_summary)?void 0:r.have_records_streamed)?w.SUCCESS:!1===(null==r?void 0:r.has_keys)?w.OMITTED_RESULT:!0===(null==r?void 0:r.pulled)?w.NO_DATA:w.NO_DATA_UNKNOWN_SUBCONDITION;return u([i],a(null!==(n=null===(t=e.notifications)||void 0===t?void 0:t.map(x))&&void 0!==n?n:[]),!1).sort((function(e,t){return E(e)-E(t)}))};var S=Object.freeze({"02":0,"01":1,"00":2});function E(e){var t,n,r=null===(t=e.gqlStatus)||void 0===t?void 0:t.slice(0,2);return null!==(n=S[r])&&void 0!==n?n:9999}function T(e){return null==e?{}:{offset:l.util.toNumber(e.offset),line:l.util.toNumber(e.line),column:l.util.toNumber(e.column)}}function M(e){return p.includes(e)?e:f.UNKNOWN}function A(e){return g.includes(e)?e:v.UNKNOWN}t.buildNotificationsFromMetadata=function(e){return null!=e.notifications?e.notifications.map((function(e){return new y(e)})):null!=e.statuses?e.statuses.map(_).filter((function(e){return null!=e})):[]},t.default=y},85011:function(e,t,n){"use strict";var r=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s};Object.defineProperty(t,"__esModule",{value:!0});var s=n(40351);var a=function(){function e(e,t,n){this.keys=e,this.length=e.length,this._fields=t,this._fieldLookup=null!=n?n:function(e){var t={};return e.forEach((function(e,n){t[e]=n})),t}(e)}return e.prototype.forEach=function(e){var t,n;try{for(var r=i(this.entries()),s=r.next();!s.done;s=r.next()){var a=o(s.value,2),u=a[0];e(a[1],u,this)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.map=function(e){var t,n,r=[];try{for(var s=i(this.entries()),a=s.next();!a.done;a=s.next()){var u=o(a.value,2),c=u[0],l=u[1];r.push(e(l,c,this))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return r},e.prototype.entries=function(){var e;return r(this,(function(t){switch(t.label){case 0:e=0,t.label=1;case 1:return e<this.keys.length?[4,[this.keys[e],this._fields[e]]]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}}))},e.prototype.values=function(){var e;return r(this,(function(t){switch(t.label){case 0:e=0,t.label=1;case 1:return e<this.keys.length?[4,this._fields[e]]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}}))},e.prototype[Symbol.iterator]=function(){var e;return r(this,(function(t){switch(t.label){case 0:e=0,t.label=1;case 1:return e<this.keys.length?[4,this._fields[e]]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}}))},e.prototype.toObject=function(){var e,t,n={};try{for(var r=i(this.entries()),s=r.next();!s.done;s=r.next()){var a=o(s.value,2),u=a[0],c=a[1];n[u]=c}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},e.prototype.get=function(e){var t;if("number"!=typeof e){if(void 0===(t=this._fieldLookup[e]))throw(0,s.newError)("This record has no field with key '".concat(e.toString(),"', available keys are: [")+this.keys.toString()+"].")}else t=e;if(t>this._fields.length-1||t<0)throw(0,s.newError)("This record has no field with index '"+t.toString()+"'. Remember that indexes start at `0`, and make sure your query returns records in the shape you meant it to.");return this._fields[t]},e.prototype.has=function(e){return"number"==typeof e?e>=0&&e<this._fields.length:void 0!==this._fieldLookup[e]},e}();t.default=a},85140:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t,n){this.keys=e,this.records=t,this.summary=n};t.default=n},69742:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stats=t.QueryStatistics=t.ProfiledPlan=t.Plan=t.ServerInfo=t.queryType=void 0;var r=n(7705),i=n(64256),o=function(){function e(e,t,n,r){var o,u,h;this.query={text:e,parameters:t},this.queryType=n.type,this.counters=new c(null!==(o=n.stats)&&void 0!==o?o:{}),this.updateStatistics=this.counters,this.plan=(null!=n.plan||null!=n.profile)&&new s(null!==(u=n.plan)&&void 0!==u?u:n.profile),this.profile=null!=n.profile&&new a(n.profile),this.notifications=(0,i.buildNotificationsFromMetadata)(n),this.gqlStatusObjects=(0,i.buildGqlStatusObjectFromMetadata)(n),this.server=new l(n.server,r),this.resultConsumedAfter=n.result_consumed_after,this.resultAvailableAfter=n.result_available_after,this.database={name:null!==(h=n.db)&&void 0!==h?h:null}}return e.prototype.hasPlan=function(){return this.plan instanceof s},e.prototype.hasProfile=function(){return this.profile instanceof a},e}(),s=function e(t){this.operatorType=t.operatorType,this.identifiers=t.identifiers,this.arguments=t.args,this.children=null!=t.children?t.children.map((function(t){return new e(t)})):[]};t.Plan=s;var a=function(){function e(t){this.operatorType=t.operatorType,this.identifiers=t.identifiers,this.arguments=t.args,this.dbHits=h("dbHits",t),this.rows=h("rows",t),this.pageCacheMisses=h("pageCacheMisses",t),this.pageCacheHits=h("pageCacheHits",t),this.pageCacheHitRatio=h("pageCacheHitRatio",t),this.time=h("time",t),this.children=null!=t.children?t.children.map((function(t){return new e(t)})):[]}return e.prototype.hasPageCacheStats=function(){return this.pageCacheMisses>0||this.pageCacheHits>0||this.pageCacheHitRatio>0},e}();t.ProfiledPlan=a;var u=function(){this.nodesCreated=0,this.nodesDeleted=0,this.relationshipsCreated=0,this.relationshipsDeleted=0,this.propertiesSet=0,this.labelsAdded=0,this.labelsRemoved=0,this.indexesAdded=0,this.indexesRemoved=0,this.constraintsAdded=0,this.constraintsRemoved=0};t.Stats=u;var c=function(){function e(e){var t=this;this._stats={nodesCreated:0,nodesDeleted:0,relationshipsCreated:0,relationshipsDeleted:0,propertiesSet:0,labelsAdded:0,labelsRemoved:0,indexesAdded:0,indexesRemoved:0,constraintsAdded:0,constraintsRemoved:0},this._systemUpdates=0,Object.keys(e).forEach((function(n){var i=n.replace(/(-\w)/g,(function(e){return e[1].toUpperCase()}));i in t._stats?t._stats[i]=r.util.toNumber(e[n]):"systemUpdates"===i?t._systemUpdates=r.util.toNumber(e[n]):"containsSystemUpdates"===i?t._containsSystemUpdates=e[n]:"containsUpdates"===i&&(t._containsUpdates=e[n])})),this._stats=Object.freeze(this._stats)}return e.prototype.containsUpdates=function(){var e=this;return void 0!==this._containsUpdates?this._containsUpdates:Object.keys(this._stats).reduce((function(t,n){return t+e._stats[n]}),0)>0},e.prototype.updates=function(){return this._stats},e.prototype.containsSystemUpdates=function(){return void 0!==this._containsSystemUpdates?this._containsSystemUpdates:this._systemUpdates>0},e.prototype.systemUpdates=function(){return this._systemUpdates},e}();t.QueryStatistics=c;var l=function(e,t){null!=e&&(this.address=e.address,this.agent=e.version),this.protocolVersion=t};function h(e,t,n){if(void 0===n&&(n=0),!1!==t&&e in t){var i=t[e];return r.util.toNumber(i)}return n}t.ServerInfo=l;t.queryType={READ_ONLY:"r",READ_WRITE:"rw",WRITE_ONLY:"w",SCHEMA_WRITE:"s"},t.default=o},76362:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(85140)),a=n(40351),u=new(function(){function e(){}return e.prototype.eagerResultTransformer=function(){return c},e.prototype.eager=function(){return c},e.prototype.mappedResultTransformer=function(e){return l(e)},e.prototype.mapped=function(e){return l(e)},e.prototype.first=function(){return h},e.prototype.summary=function(){return d},e}());function c(e){return r(this,void 0,void 0,(function(){var t,n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,e];case 1:return t=i.sent(),n=t.summary,r=t.records,[4,e.keys()];case 2:return o=i.sent(),[2,new s.default(o,r,n)]}}))}))}function l(e){var t=this;if(null==e||null==e.collect&&null==e.map)throw(0,a.newError)("Requires a map or/and a collect functions.");return function(n){return r(t,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t,r){var i={records:[],keys:[]};n.subscribe({onKeys:function(e){i.keys=e},onNext:function(t){if(null!=e.map){var n=e.map(t);void 0!==n&&i.records.push(n)}else i.records.push(t)},onCompleted:function(n){if(null!=e.collect)t(e.collect(i.records,n,i.keys));else{var r={records:i.records,summary:n,keys:i.keys};t(r)}},onError:function(e){r(e)}})}))];case 1:return[2,t.sent()]}}))}))}}function h(e){return r(this,void 0,void 0,(function(){var t,n,r,o;return i(this,(function(i){switch(i.label){case 0:return[4,(t=e[Symbol.asyncIterator]()).next()];case 1:n=i.sent(),r=n.value,o=n.done,i.label=2;case 2:return i.trys.push([2,,3,6]),!0===o?[2,void 0]:[2,r];case 3:return null==t.return?[3,5]:[4,t.return()];case 4:i.sent(),i.label=5;case 5:return[7];case 6:return[2]}}))}))}function d(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,e.summary()];case 1:return[2,t.sent()]}}))}))}Object.freeze(u),t.default=u},22548:function(e,t,n){"use strict";var r,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(69742)),u=n(7705),c=n(40351),l=u.connectionHolder.EMPTY_CONNECTION_HOLDER,h=function(e){console.log("Uncaught error when processing result: "+e)},d=function(e){},f=function(e){},p=function(){function e(e,t,n,i,o){void 0===o&&(o={high:Number.MAX_VALUE,low:Number.MAX_VALUE}),this[r]="Result",this._stack=function(){var e=new Error("");if(null!=e.stack)return e.stack.replace(/^Error(\n\r)*/,"");return null}(),this._streamObserverPromise=e,this._p=null,this._query=t,this._parameters=null!=n?n:{},this._connectionHolder=null!=i?i:l,this._keys=null,this._summary=null,this._error=null,this._watermarks=o}return e.prototype.keys=function(){var e=this;return null!==this._keys?Promise.resolve(this._keys):null!==this._error?Promise.reject(this._error):new Promise((function(t,n){e._streamObserverPromise.then((function(r){return r.subscribe(e._decorateObserver({onKeys:function(e){return t(e)},onError:function(e){return n(e)}}))})).catch(n)}))},e.prototype.summary=function(){var e=this;return null!==this._summary?Promise.resolve(this._summary):null!==this._error?Promise.reject(this._error):new Promise((function(t,n){e._streamObserverPromise.then((function(r){r.cancel(),r.subscribe(e._decorateObserver({onCompleted:function(e){return t(e)},onError:function(e){return n(e)}}))})).catch(n)}))},e.prototype._getOrCreatePromise=function(){var e=this;return null==this._p&&(this._p=new Promise((function(t,n){var r=[],i={onNext:function(e){r.push(e)},onCompleted:function(e){t({records:r,summary:e})},onError:function(e){n(e)}};e.subscribe(i)}))),this._p},e.prototype[Symbol.asyncIterator]=function(){var e=this;if(!this.isOpen()){var t=(0,c.newError)("Result is already consumed");return{next:function(){return Promise.reject(t)},peek:function(){return Promise.reject(t)}}}var n={paused:!0,firstRun:!0,finished:!1},r=function(){var t,r;if(null!=n.streaming){var i=null!==(r=null===(t=n.queuedObserver)||void 0===t?void 0:t.size)&&void 0!==r?r:0,o=i>=e._watermarks.high,s=i<=e._watermarks.low;o&&!n.paused?(n.paused=!0,n.streaming.pause()):(s&&n.paused||n.firstRun&&!o)&&(n.firstRun=!1,n.paused=!1,n.streaming.resume())}},s=function(){return i(e,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return void 0!==n.queuedObserver?[3,2]:(n.queuedObserver=this._createQueuedResultObserver(r),e=n,[4,this._subscribe(n.queuedObserver,!0).catch((function(){}))]);case 1:e.streaming=t.sent(),r(),t.label=2;case 2:return[2,n.queuedObserver]}}))}))},a=function(e){if(void 0===e)throw(0,c.newError)("InvalidState: Result stream finished without Summary",c.PROTOCOL_ERROR);return!0};return{next:function(){return i(e,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return n.finished&&a(n.summary)?[2,{done:!0,value:n.summary}]:[4,s()];case 1:return[4,t.sent().dequeue()];case 2:return!0===(e=t.sent()).done&&(n.finished=e.done,n.summary=e.value),[2,e]}}))}))},return:function(t){return i(e,void 0,void 0,(function(){var e,r;return o(this,(function(i){switch(i.label){case 0:return n.finished&&a(n.summary)?[2,{done:!0,value:null!=t?t:n.summary}]:(null===(r=n.streaming)||void 0===r||r.cancel(),[4,s()]);case 1:return[4,i.sent().dequeueUntilDone()];case 2:return e=i.sent(),n.finished=!0,e.value=null!=t?t:e.value,n.summary=e.value,[2,e]}}))}))},peek:function(){return i(e,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return n.finished&&a(n.summary)?[2,{done:!0,value:n.summary}]:[4,s()];case 1:return[4,e.sent().head()];case 2:return[2,e.sent()]}}))}))}}},e.prototype.then=function(e,t){return this._getOrCreatePromise().then(e,t)},e.prototype.catch=function(e){return this._getOrCreatePromise().catch(e)},e.prototype.finally=function(e){return this._getOrCreatePromise().finally(e)},e.prototype.subscribe=function(e){this._subscribe(e).catch((function(){}))},e.prototype.isOpen=function(){return null===this._summary&&null===this._error},e.prototype._subscribe=function(e,t){void 0===t&&(t=!1);var n=this._decorateObserver(e);return this._streamObserverPromise.then((function(e){return t&&e.pause(),e.subscribe(n),e})).catch((function(e){return null!=n.onError&&n.onError(e),Promise.reject(e)}))},e.prototype._decorateObserver=function(e){var t,n,r,i=this,o=null!==(t=e.onCompleted)&&void 0!==t?t:d,s=null!==(n=e.onError)&&void 0!==n?n:h,a=null!==(r=e.onKeys)&&void 0!==r?r:f;return{onNext:null!=e.onNext?e.onNext.bind(e):void 0,onKeys:function(t){return i._keys=t,a.call(e,t)},onCompleted:function(t){i._releaseConnectionAndGetSummary(t).then((function(t){return null!==i._summary?o.call(e,i._summary):(i._summary=t,o.call(e,t))})).catch(s)},onError:function(t){i._connectionHolder.releaseConnection().then((function(){!function(e,t){null!=t&&(e.stack=e.toString()+"\n"+t)}(t,i._stack),i._error=t,s.call(e,t)})).catch(s)}}},e.prototype._cancel=function(){null===this._summary&&null===this._error&&this._streamObserverPromise.then((function(e){return e.cancel()})).catch((function(){}))},e.prototype._releaseConnectionAndGetSummary=function(e){var t=u.util.validateQueryAndParameters(this._query,this._parameters,{skipAsserts:!0}),n=t.validatedQuery,r=t.params,i=this._connectionHolder;return i.getConnection().then((function(e){return i.releaseConnection().then((function(){return null==e?void 0:e.getProtocolVersion()}))}),(function(e){})).then((function(t){return new a.default(n,r,e,t)}))},e.prototype._createQueuedResultObserver=function(e){var t=this;function n(){var e={};return e.promise=new Promise((function(t,n){e.resolve=t,e.reject=n})),e}function r(e){return e instanceof Error}function s(){var t;return i(this,void 0,void 0,(function(){var i;return o(this,(function(o){switch(o.label){case 0:if(a.length>0){if(i=null!==(t=a.shift())&&void 0!==t?t:(0,c.newError)("Unexpected empty buffer",c.PROTOCOL_ERROR),e(),r(i))throw i;return[2,i]}return u.resolvable=n(),[4,u.resolvable.promise];case 1:return[2,o.sent()]}}))}))}var a=[],u={resolvable:null},l={onNext:function(e){l._push({done:!1,value:e})},onCompleted:function(e){l._push({done:!0,value:e})},onError:function(e){l._push(e)},_push:function(t){if(null!==u.resolvable){var n=u.resolvable;u.resolvable=null,r(t)?n.reject(t):n.resolve(t)}else a.push(t),e()},dequeue:s,dequeueUntilDone:function(){return i(t,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return[4,s()];case 1:return!0===(e=t.sent()).done?[2,e]:[3,0];case 2:return[2]}}))}))},head:function(){return i(t,void 0,void 0,(function(){var t,i;return o(this,(function(o){switch(o.label){case 0:if(a.length>0){if(r(t=a[0]))throw t;return[2,t]}u.resolvable=n(),o.label=1;case 1:return o.trys.push([1,3,4,5]),[4,u.resolvable.promise];case 2:return t=o.sent(),a.unshift(t),[2,t];case 3:throw i=o.sent(),a.unshift(i),i;case 4:return e(),[7];case 5:return[2]}}))}))},get size(){return a.length}};return l},e}();r=Symbol.toStringTag,t.default=p},48044:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(48743),c=n(83755),l=n(83019),h=n(40351),d=a(n(22548)),f=n(29265),p=n(93954),m=n(29350),g=n(76857),v=a(n(7602)),y=a(n(14347)),b=function(){function e(e){var t=e.mode,n=e.connectionProvider,r=e.bookmarks,i=e.database,o=e.config,s=e.reactive,a=e.fetchSize,u=e.impersonatedUser,c=e.bookmarkManager,h=e.notificationFilter,d=e.auth,g=e.log;this._mode=t,this._database=i,this._reactive=s,this._fetchSize=a,this._onDatabaseNameResolved=this._onDatabaseNameResolved.bind(this),this._getConnectionAcquistionBookmarks=this._getConnectionAcquistionBookmarks.bind(this),this._readConnectionHolder=new f.ConnectionHolder({mode:l.ACCESS_MODE_READ,auth:d,database:i,bookmarks:r,connectionProvider:n,impersonatedUser:u,onDatabaseNameResolved:this._onDatabaseNameResolved,getConnectionAcquistionBookmarks:this._getConnectionAcquistionBookmarks,log:g}),this._writeConnectionHolder=new f.ConnectionHolder({mode:l.ACCESS_MODE_WRITE,auth:d,database:i,bookmarks:r,connectionProvider:n,impersonatedUser:u,onDatabaseNameResolved:this._onDatabaseNameResolved,getConnectionAcquistionBookmarks:this._getConnectionAcquistionBookmarks,log:g}),this._open=!0,this._hasTx=!1,this._impersonatedUser=u,this._lastBookmarks=null!=r?r:m.Bookmarks.empty(),this._configuredBookmarks=this._lastBookmarks,this._transactionExecutor=function(e){var t,n=null!==(t=null==e?void 0:e.maxTransactionRetryTime)&&void 0!==t?t:null;return new p.TransactionExecutor(n)}(o),this._databaseNameResolved=""!==this._database;var v=this._calculateWatermaks();this._lowRecordWatermark=v.low,this._highRecordWatermark=v.high,this._results=[],this._bookmarkManager=c,this._notificationFilter=h,this._log=g}return e.prototype.run=function(e,t,n){var o=this,s=(0,c.validateQueryAndParameters)(e,t),a=s.validatedQuery,u=s.params,h=null!=n?new g.TxConfig(n,this._log):g.TxConfig.empty(),d=this._run(a,u,(function(e){return r(o,void 0,void 0,(function(){var t,n=this;return i(this,(function(r){switch(r.label){case 0:return[4,this._bookmarks()];case 1:return t=r.sent(),this._assertSessionIsOpen(),[2,e.run(a,u,{bookmarks:t,txConfig:h,mode:this._mode,database:this._database,apiTelemetryConfig:{api:l.TELEMETRY_APIS.AUTO_COMMIT_TRANSACTION},impersonatedUser:this._impersonatedUser,afterComplete:function(e){return n._onCompleteCallback(e,t)},reactive:this._reactive,fetchSize:this._fetchSize,lowRecordWatermark:this._lowRecordWatermark,highRecordWatermark:this._highRecordWatermark,notificationFilter:this._notificationFilter})]}}))}))}));return this._results.push(d),d},e.prototype._run=function(e,t,n){var r=this._acquireAndConsumeConnection(n),i=r.connectionHolder,o=r.resultPromise.catch((function(e){return Promise.resolve(new u.FailedObserver({error:e}))})),s={high:this._highRecordWatermark,low:this._lowRecordWatermark};return new d.default(o,e,t,i,s)},e.prototype._acquireConnection=function(e){var t=this,n=this._acquireAndConsumeConnection(e),o=n.connectionHolder;return n.resultPromise.then((function(e){return r(t,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,o.releaseConnection()];case 1:return t.sent(),[2,e]}}))}))}))},e.prototype._acquireAndConsumeConnection=function(e){var t,n=this._connectionHolderWithMode(this._mode);return t=this._open?!this._hasTx&&n.initializeConnection()?n.getConnection().then((function(t){return e(t)})):Promise.reject((0,h.newError)("Queries cannot be run directly on a session with an open transaction; either run from within the transaction or use a different session.")):Promise.reject((0,h.newError)("Cannot run query in a closed session.")),{connectionHolder:n,resultPromise:t}},e.prototype.beginTransaction=function(e){var t=e,n=g.TxConfig.empty();return null!=t&&(n=new g.TxConfig(t,this._log)),this._beginTransaction(this._mode,n,{api:l.TELEMETRY_APIS.UNMANAGED_TRANSACTION})},e.prototype._beginTransaction=function(t,n,r){var i=this;if(!this._open)throw(0,h.newError)("Cannot begin a transaction on a closed session.");if(this._hasTx)throw(0,h.newError)("You cannot begin a transaction on a session with an open transaction; either run from within the transaction or use a different session.");var o=e._validateSessionMode(t),s=this._connectionHolderWithMode(o);s.initializeConnection(),this._hasTx=!0;var a=new v.default({connectionHolder:s,impersonatedUser:this._impersonatedUser,onClose:this._transactionClosed.bind(this),onBookmarks:function(e,t,n){return i._updateBookmarks(e,t,n)},onConnection:this._assertSessionIsOpen.bind(this),reactive:this._reactive,fetchSize:this._fetchSize,lowRecordWatermark:this._lowRecordWatermark,highRecordWatermark:this._highRecordWatermark,notificationFilter:this._notificationFilter,apiTelemetryConfig:r});return a._begin((function(){return i._bookmarks()}),n),a},e.prototype._assertSessionIsOpen=function(){if(!this._open)throw(0,h.newError)("You cannot run more transactions on a closed session.")},e.prototype._transactionClosed=function(){this._hasTx=!1},e.prototype.lastBookmark=function(){return this.lastBookmarks()},e.prototype.lastBookmarks=function(){return this._lastBookmarks.values()},e.prototype._bookmarks=function(){var e;return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,null===(e=this._bookmarkManager)||void 0===e?void 0:e.getBookmarks()];case 1:return void 0===(t=n.sent())?[2,this._lastBookmarks]:[2,new m.Bookmarks(s(s([],o(t),!1),o(this._configuredBookmarks),!1))]}}))}))},e.prototype.readTransaction=function(e,t){var n=new g.TxConfig(t,this._log);return this._runTransaction(l.ACCESS_MODE_READ,n,e)},e.prototype.writeTransaction=function(e,t){var n=new g.TxConfig(t,this._log);return this._runTransaction(l.ACCESS_MODE_WRITE,n,e)},e.prototype._runTransaction=function(e,t,n){var r=this;return this._transactionExecutor.execute((function(n){return r._beginTransaction(e,t,n)}),n)},e.prototype.executeRead=function(e,t){var n=new g.TxConfig(t,this._log);return this._executeInTransaction(l.ACCESS_MODE_READ,n,e)},e.prototype.executeWrite=function(e,t){var n=new g.TxConfig(t,this._log);return this._executeInTransaction(l.ACCESS_MODE_WRITE,n,e)},e.prototype._executeInTransaction=function(e,t,n){var r=this;return this._transactionExecutor.execute((function(n){return r._beginTransaction(e,t,n)}),n,y.default.fromTransaction)},e.prototype._onDatabaseNameResolved=function(e){if(!this._databaseNameResolved){var t=null!=e?e:"";this._database=t,this._readConnectionHolder.setDatabase(t),this._writeConnectionHolder.setDatabase(t),this._databaseNameResolved=!0}},e.prototype._getConnectionAcquistionBookmarks=function(){var e;return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,null===(e=this._bookmarkManager)||void 0===e?void 0:e.getBookmarks()];case 1:return void 0===(t=n.sent())?[2,this._lastBookmarks]:[2,new m.Bookmarks(s(s([],o(this._configuredBookmarks),!1),o(t),!1))]}}))}))},e.prototype._updateBookmarks=function(e,t,n){var r,i,o;null==e||e.isEmpty()||(null===(r=this._bookmarkManager)||void 0===r||r.updateBookmarks(null!==(i=null==t?void 0:t.values())&&void 0!==i?i:[],null!==(o=null==e?void 0:e.values())&&void 0!==o?o:[]).catch((function(){})),this._lastBookmarks=e,this._configuredBookmarks=m.Bookmarks.empty())},e.prototype.close=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this._open?(this._open=!1,this._results.forEach((function(e){return e._cancel()})),this._transactionExecutor.close(),[4,this._readConnectionHolder.close(this._hasTx)]):[3,3];case 1:return e.sent(),[4,this._writeConnectionHolder.close(this._hasTx)];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},e.prototype[Symbol.asyncDispose]=function(){return this.close()},e.prototype._connectionHolderWithMode=function(e){if(e===l.ACCESS_MODE_READ)return this._readConnectionHolder;if(e===l.ACCESS_MODE_WRITE)return this._writeConnectionHolder;throw(0,h.newError)("Unknown access mode: "+e)},e.prototype._onCompleteCallback=function(e,t){this._updateBookmarks(new m.Bookmarks(e.bookmark),t,e.db)},e.prototype._calculateWatermaks=function(){return this._fetchSize===l.FETCH_ALL?{low:Number.MAX_VALUE,high:Number.MAX_VALUE}:{low:.3*this._fetchSize,high:.7*this._fetchSize}},e.prototype._configureTransactionExecutor=function(e,t){this._transactionExecutor.pipelineBegin=e,this._transactionExecutor.telemetryApi=t},e._validateSessionMode=function(e){var t=null!=e?e:l.ACCESS_MODE_WRITE;if(t!==l.ACCESS_MODE_READ&&t!==l.ACCESS_MODE_WRITE)throw(0,h.newError)("Illegal session mode "+t);return t},e}();t.default=b},26061:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPoint=t.Point=void 0;var r=n(83755),i="__isPoint__",o=function(){function e(e,t,n,i){this.srid=(0,r.assertNumberOrInteger)(e,"SRID"),this.x=(0,r.assertNumber)(t,"X coordinate"),this.y=(0,r.assertNumber)(n,"Y coordinate"),this.z=null==i?i:(0,r.assertNumber)(i,"Z coordinate"),Object.freeze(this)}return e.prototype.toString=function(){return null==this.z||isNaN(this.z)?"Point{srid=".concat(s(this.srid),", x=").concat(s(this.x),", y=").concat(s(this.y),"}"):"Point{srid=".concat(s(this.srid),", x=").concat(s(this.x),", y=").concat(s(this.y),", z=").concat(s(this.z),"}")},e}();function s(e){return Number.isInteger(e)?e.toString()+".0":e.toString()}t.Point=o,Object.defineProperty(o.prototype,i,{value:!0,enumerable:!1,configurable:!1,writable:!1}),t.isPoint=function(e){return null!=e&&!0===e[i]}},33501:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s};Object.defineProperty(t,"__esModule",{value:!0}),t.isDateTime=t.DateTime=t.isLocalDateTime=t.LocalDateTime=t.isDate=t.Date=t.isTime=t.Time=t.isLocalTime=t.LocalTime=t.isDuration=t.Duration=void 0;var a=o(n(53799)),u=n(83755),c=n(40351),l=o(n(45884)),h={value:!0,enumerable:!1,configurable:!1,writable:!1},d="__isDuration__",f="__isLocalTime__",p="__isTime__",m="__isDate__",g="__isLocalDateTime__",v="__isDateTime__",y=function(){function e(e,t,n,r){this.months=(0,u.assertNumberOrInteger)(e,"Months"),this.days=(0,u.assertNumberOrInteger)(t,"Days"),(0,u.assertNumberOrInteger)(n,"Seconds"),(0,u.assertNumberOrInteger)(r,"Nanoseconds"),this.seconds=a.normalizeSecondsForDuration(n,r),this.nanoseconds=a.normalizeNanosecondsForDuration(r),Object.freeze(this)}return e.prototype.toString=function(){return a.durationToIsoString(this.months,this.days,this.seconds,this.nanoseconds)},e}();t.Duration=y,Object.defineProperty(y.prototype,d,h),t.isDuration=function(e){return E(e,d)};var b=function(){function e(e,t,n,r){this.hour=a.assertValidHour(e),this.minute=a.assertValidMinute(t),this.second=a.assertValidSecond(n),this.nanosecond=a.assertValidNanosecond(r),Object.freeze(this)}return e.fromStandardDate=function(t,n){M(t,n);var r=a.totalNanoseconds(t,n);return new e(t.getHours(),t.getMinutes(),t.getSeconds(),r instanceof l.default?r.toInt():"bigint"==typeof r?(0,l.int)(r).toInt():r)},e.prototype.toString=function(){return a.timeToIsoString(this.hour,this.minute,this.second,this.nanosecond)},e}();t.LocalTime=b,Object.defineProperty(b.prototype,f,h),t.isLocalTime=function(e){return E(e,f)};var _=function(){function e(e,t,n,r,i){this.hour=a.assertValidHour(e),this.minute=a.assertValidMinute(t),this.second=a.assertValidSecond(n),this.nanosecond=a.assertValidNanosecond(r),this.timeZoneOffsetSeconds=(0,u.assertNumberOrInteger)(i,"Time zone offset in seconds"),Object.freeze(this)}return e.fromStandardDate=function(t,n){return M(t,n),new e(t.getHours(),t.getMinutes(),t.getSeconds(),(0,l.toNumber)(a.totalNanoseconds(t,n)),a.timeZoneOffsetInSeconds(t))},e.prototype.toString=function(){return a.timeToIsoString(this.hour,this.minute,this.second,this.nanosecond)+a.timeZoneOffsetToIsoString(this.timeZoneOffsetSeconds)},e}();t.Time=_,Object.defineProperty(_.prototype,p,h),t.isTime=function(e){return E(e,p)};var x=function(){function e(e,t,n){this.year=a.assertValidYear(e),this.month=a.assertValidMonth(t),this.day=a.assertValidDay(n),Object.freeze(this)}return e.fromStandardDate=function(t){return M(t),new e(t.getFullYear(),t.getMonth()+1,t.getDate())},e.prototype.toStandardDate=function(){return a.isoStringToStandardDate(this.toString())},e.prototype.toString=function(){return a.dateToIsoString(this.year,this.month,this.day)},e}();t.Date=x,Object.defineProperty(x.prototype,m,h),t.isDate=function(e){return E(e,m)};var w=function(){function e(e,t,n,r,i,o,s){this.year=a.assertValidYear(e),this.month=a.assertValidMonth(t),this.day=a.assertValidDay(n),this.hour=a.assertValidHour(r),this.minute=a.assertValidMinute(i),this.second=a.assertValidSecond(o),this.nanosecond=a.assertValidNanosecond(s),Object.freeze(this)}return e.fromStandardDate=function(t,n){return M(t,n),new e(t.getFullYear(),t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),(0,l.toNumber)(a.totalNanoseconds(t,n)))},e.prototype.toStandardDate=function(){return a.isoStringToStandardDate(this.toString())},e.prototype.toString=function(){return T(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond)},e}();t.LocalDateTime=w,Object.defineProperty(w.prototype,g,h),t.isLocalDateTime=function(e){return E(e,g)};var S=function(){function e(e,t,n,r,i,o,l,h,d){this.year=a.assertValidYear(e),this.month=a.assertValidMonth(t),this.day=a.assertValidDay(n),this.hour=a.assertValidHour(r),this.minute=a.assertValidMinute(i),this.second=a.assertValidSecond(o),this.nanosecond=a.assertValidNanosecond(l);var f=s(function(e,t){var n=null!=e,r=null!=t&&""!==t;if(!n&&!r)throw(0,c.newError)("Unable to create DateTime without either time zone offset or id. Please specify either of them. Given offset: ".concat(e," and id: ").concat(t));var i=[void 0,void 0];n&&((0,u.assertNumberOrInteger)(e,"Time zone offset in seconds"),i[0]=e);r&&((0,u.assertString)(t,"Time zone ID"),a.assertValidZoneId("Time zone ID",t),i[1]=t);return i}(h,d),2),p=f[0],m=f[1];this.timeZoneOffsetSeconds=p,this.timeZoneId=null!=m?m:void 0,Object.freeze(this)}return e.fromStandardDate=function(t,n){return M(t,n),new e(t.getFullYear(),t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),(0,l.toNumber)(a.totalNanoseconds(t,n)),a.timeZoneOffsetInSeconds(t),null)},e.prototype.toStandardDate=function(){return a.toStandardDate(this._toUTC())},e.prototype.toString=function(){var e;return T(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond)+(null!=this.timeZoneOffsetSeconds?a.timeZoneOffsetToIsoString(null!==(e=this.timeZoneOffsetSeconds)&&void 0!==e?e:0):"")+(null!=this.timeZoneId?"[".concat(this.timeZoneId,"]"):"")},e.prototype._toUTC=function(){var e;if(void 0===this.timeZoneOffsetSeconds)throw new Error("Requires DateTime created with time zone offset");var t=a.localDateTimeToEpochSecond(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond).subtract(null!==(e=this.timeZoneOffsetSeconds)&&void 0!==e?e:0);return(0,l.int)(t).multiply(1e3).add((0,l.int)(this.nanosecond).div(1e6)).toNumber()},e}();function E(e,t){return null!=e&&!0===e[t]}function T(e,t,n,r,i,o,s){return a.dateToIsoString(e,t,n)+"T"+a.timeToIsoString(r,i,o,s)}function M(e,t){(0,u.assertValidDate)(e,"Standard date"),null!=t&&(0,u.assertNumberOrInteger)(t,"Nanosecond")}t.DateTime=S,Object.defineProperty(S.prototype,v,h),t.isDateTime=function(e){return E(e,v)}},14347:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=e.run;this._run=t}return e.fromTransaction=function(t){return new e({run:t.run.bind(t)})},e.prototype.run=function(e,t){return this._run(e,t)},e}();t.default=n},7602:function(e,t,n){"use strict";var r,i,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(t){var n=t.connectionHolder,r=t.onClose,o=t.onBookmarks,s=t.onConnection,a=t.reactive,u=t.fetchSize,c=t.impersonatedUser,l=t.highRecordWatermark,h=t.lowRecordWatermark,d=t.notificationFilter,f=t.apiTelemetryConfig,p=e.call(this,{connectionHolder:n,onClose:r,onBookmarks:o,onConnection:s,reactive:a,fetchSize:u,impersonatedUser:c,highRecordWatermark:l,lowRecordWatermark:h,notificationFilter:d,apiTelemetryConfig:f})||this;return p[i]="TransactionPromise",p}return o(t,e),t.prototype.then=function(e,t){return this._getOrCreateBeginPromise().then(e,t)},t.prototype.catch=function(e){return this._getOrCreateBeginPromise().catch(e)},t.prototype.finally=function(e){return this._getOrCreateBeginPromise().finally(e)},t.prototype._getOrCreateBeginPromise=function(){var e=this;return null==this._beginPromise&&(this._beginPromise=new Promise((function(t,n){e._resolve=t,e._reject=n,null!=e._beginError&&n(e._beginError),null!=e._beginMetadata&&t(e._toTransaction())}))),this._beginPromise},t.prototype._toTransaction=function(){return s(s({},this),{run:e.prototype.run.bind(this),commit:e.prototype.commit.bind(this),rollback:e.prototype.rollback.bind(this),close:e.prototype.close.bind(this),isOpen:e.prototype.isOpen.bind(this),_begin:this._begin.bind(this)})},t.prototype._begin=function(t,n){return e.prototype._begin.call(this,t,n,{onError:this._onBeginError.bind(this),onComplete:this._onBeginMetadata.bind(this)})},t.prototype._onBeginError=function(e){this._beginError=e,null!=this._reject&&this._reject(e)},t.prototype._onBeginMetadata=function(e){this._beginMetadata=null!=e?e:{},null!=this._resolve&&this._resolve(this._toTransaction())},t}(a(n(29708)).default);i=Symbol.toStringTag,t.default=u},29708:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(83755),a=n(29265),u=n(29350),c=n(76857),l=n(48743),h=n(40351),d=o(n(22548)),f=function(){function e(e){var t=e.connectionHolder,n=e.onClose,r=e.onBookmarks,i=e.onConnection,o=e.reactive,s=e.fetchSize,a=e.impersonatedUser,c=e.highRecordWatermark,l=e.lowRecordWatermark,h=e.notificationFilter,d=e.apiTelemetryConfig,f=this;this._connectionHolder=t,this._reactive=o,this._state=p.ACTIVE,this._onClose=n,this._onBookmarks=r,this._onConnection=i,this._onError=this._onErrorCallback.bind(this),this._fetchSize=s,this._onComplete=this._onCompleteCallback.bind(this),this._results=[],this._impersonatedUser=a,this._lowRecordWatermak=l,this._highRecordWatermark=c,this._bookmarks=u.Bookmarks.empty(),this._notificationFilter=h,this._apiTelemetryConfig=d,this._acceptActive=function(){},this._activePromise=new Promise((function(e,t){f._acceptActive=e}))}return e.prototype._begin=function(e,t,n){var o=this;this._connectionHolder.getConnection().then((function(s){return r(o,void 0,void 0,(function(){var r,o=this;return i(this,(function(i){switch(i.label){case 0:return this._onConnection(),null==s?[3,2]:(r=this,[4,e()]);case 1:return r._bookmarks=i.sent(),[2,s.beginTransaction({bookmarks:this._bookmarks,txConfig:t,mode:this._connectionHolder.mode(),database:this._connectionHolder.database(),impersonatedUser:this._impersonatedUser,notificationFilter:this._notificationFilter,apiTelemetryConfig:this._apiTelemetryConfig,beforeError:function(e){null!=n&&n.onError(e),o._onError(e).catch((function(){}))},afterComplete:function(e){null!=n&&n.onComplete(e),o._onComplete(e)}})];case 2:throw(0,h.newError)("No connection available")}}))}))})).catch((function(e){null!=n&&n.onError(e),o._onError(e).catch((function(){}))})).finally((function(){return o._acceptActive()}))},e.prototype.run=function(e,t){var n=(0,s.validateQueryAndParameters)(e,t),r=n.validatedQuery,i=n.params,o=this._state.run(r,i,{connectionHolder:this._connectionHolder,onError:this._onError,onComplete:this._onComplete,onConnection:this._onConnection,reactive:this._reactive,fetchSize:this._fetchSize,highRecordWatermark:this._highRecordWatermark,lowRecordWatermark:this._lowRecordWatermak,preparationJob:this._activePromise});return this._results.push(o),o},e.prototype.commit=function(){var e=this,t=this._state.commit({connectionHolder:this._connectionHolder,onError:this._onError,onComplete:function(t){return e._onCompleteCallback(t,e._bookmarks)},onConnection:this._onConnection,pendingResults:this._results,preparationJob:this._activePromise});return this._state=t.state,this._onClose(),new Promise((function(e,n){t.result.subscribe({onCompleted:function(){return e()},onError:function(e){return n(e)}})}))},e.prototype.rollback=function(){var e=this._state.rollback({connectionHolder:this._connectionHolder,onError:this._onError,onComplete:this._onComplete,onConnection:this._onConnection,pendingResults:this._results,preparationJob:this._activePromise});return this._state=e.state,this._onClose(),new Promise((function(t,n){e.result.subscribe({onCompleted:function(){return t()},onError:function(e){return n(e)}})}))},e.prototype.isOpen=function(){return this._state===p.ACTIVE},e.prototype.close=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this.isOpen()?[4,this.rollback()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype[Symbol.asyncDispose]=function(){return this.close()},e.prototype._onErrorCallback=function(e){return this._state===p.FAILED?Promise.resolve(null):(this._state=p.FAILED,this._onClose(),this._results.forEach((function(t){t.isOpen()&&t._streamObserverPromise.then((function(t){return t.onError(e)})).catch((function(e){}))})),this._connectionHolder.releaseConnection())},e.prototype._onCompleteCallback=function(e,t){this._onBookmarks(new u.Bookmarks(null==e?void 0:e.bookmark),null!=t?t:u.Bookmarks.empty(),null==e?void 0:e.db)},e}(),p={ACTIVE:{commit:function(e){return{result:m(!0,e.connectionHolder,e.onError,e.onComplete,e.onConnection,e.pendingResults,e.preparationJob),state:p.SUCCEEDED}},rollback:function(e){return{result:m(!1,e.connectionHolder,e.onError,e.onComplete,e.onConnection,e.pendingResults,e.preparationJob),state:p.ROLLED_BACK}},run:function(e,t,n){var r=n.connectionHolder,i=n.onError,o=n.onComplete,s=n.onConnection,a=n.reactive,d=n.fetchSize,f=n.highRecordWatermark,p=n.lowRecordWatermark,m=n.preparationJob,v=null!=m?m:Promise.resolve();return g(r.getConnection().then((function(e){return v.then((function(){return e}))})).then((function(n){if(s(),null!=n)return n.run(e,t,{bookmarks:u.Bookmarks.empty(),txConfig:c.TxConfig.empty(),beforeError:i,afterComplete:o,reactive:a,fetchSize:d,highRecordWatermark:f,lowRecordWatermark:p});throw(0,h.newError)("No connection available")})).catch((function(e){return new l.FailedObserver({error:e,onError:i})})),e,t,r,f,p)}},FAILED:{commit:function(e){var t=e.connectionHolder,n=e.onError;e.onComplete;return{result:g(new l.FailedObserver({error:(0,h.newError)("Cannot commit this transaction, because it has been rolled back either because of an error or explicit termination."),onError:n}),"COMMIT",{},t,0,0),state:p.FAILED}},rollback:function(e){var t=e.connectionHolder;e.onError,e.onComplete;return{result:g(new l.CompletedObserver,"ROLLBACK",{},t,0,0),state:p.FAILED}},run:function(e,t,n){var r=n.connectionHolder,i=n.onError;n.onComplete;return g(new l.FailedObserver({error:(0,h.newError)("Cannot run query in this transaction, because it has been rolled back either because of an error or explicit termination."),onError:i}),e,t,r,0,0)}},SUCCEEDED:{commit:function(e){var t=e.connectionHolder,n=e.onError;e.onComplete;return{result:g(new l.FailedObserver({error:(0,h.newError)("Cannot commit this transaction, because it has already been committed."),onError:n}),"COMMIT",{},a.EMPTY_CONNECTION_HOLDER,0,0),state:p.SUCCEEDED,connectionHolder:t}},rollback:function(e){var t=e.connectionHolder,n=e.onError;e.onComplete;return{result:g(new l.FailedObserver({error:(0,h.newError)("Cannot rollback this transaction, because it has already been committed."),onError:n}),"ROLLBACK",{},a.EMPTY_CONNECTION_HOLDER,0,0),state:p.SUCCEEDED,connectionHolder:t}},run:function(e,t,n){var r=n.connectionHolder,i=n.onError;n.onComplete;return g(new l.FailedObserver({error:(0,h.newError)("Cannot run query in this transaction, because it has already been committed."),onError:i}),e,t,r,0,0)}},ROLLED_BACK:{commit:function(e){var t=e.connectionHolder,n=e.onError;e.onComplete;return{result:g(new l.FailedObserver({error:(0,h.newError)("Cannot commit this transaction, because it has already been rolled back."),onError:n}),"COMMIT",{},t,0,0),state:p.ROLLED_BACK}},rollback:function(e){var t=e.connectionHolder;e.onError,e.onComplete;return{result:g(new l.FailedObserver({error:(0,h.newError)("Cannot rollback this transaction, because it has already been rolled back.")}),"ROLLBACK",{},t,0,0),state:p.ROLLED_BACK}},run:function(e,t,n){var r=n.connectionHolder,i=n.onError;n.onComplete;return g(new l.FailedObserver({error:(0,h.newError)("Cannot run query in this transaction, because it has already been rolled back."),onError:i}),e,t,r,0,0)}}};function m(e,t,n,r,i,o,s){var a=null!=s?s:Promise.resolve(),u=t.getConnection().then((function(e){return a.then((function(){return e}))})).then((function(t){return i(),o.forEach((function(e){return e._cancel()})),Promise.all(o.map((function(e){return e.summary()}))).then((function(i){if(null!=t)return e?t.commitTransaction({beforeError:n,afterComplete:r}):t.rollbackTransaction({beforeError:n,afterComplete:r});throw(0,h.newError)("No connection available")}))})).catch((function(e){return new l.FailedObserver({error:e,onError:n})}));return new d.default(u,e?"COMMIT":"ROLLBACK",{},t,{high:Number.MAX_VALUE,low:Number.MAX_VALUE})}function g(e,t,n,r,i,o){return void 0===r&&(r=a.EMPTY_CONNECTION_HOLDER),new d.default(Promise.resolve(e),t,n,new a.ReadOnlyConnectionHolder(null!=r?r:a.EMPTY_CONNECTION_HOLDER),{low:o,high:i})}t.default=f},52563:function(e,t){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.InternalConfig=t.Config=void 0;var i=function(){this.encrypted=void 0,this.trust=void 0,this.trustedCertificates=[],this.maxConnectionPoolSize=100,this.maxConnectionLifetime=36e5,this.connectionAcquisitionTimeout=6e4,this.maxTransactionRetryTime=3e4,this.connectionLivenessCheckTimeout=void 0,this.connectionTimeout=3e4,this.disableLosslessIntegers=!1,this.useBigInt=!1,this.logging=void 0,this.resolver=void 0,this.notificationFilter=void 0,this.userAgent=void 0,this.telemetryDisabled=!1,this.clientCertificate=void 0};t.Config=i;var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(i);t.InternalConfig=o},23279:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WRITE=t.READ=t.Driver=void 0;var s=n(41264),a=o(n(29115)),u=s.internal.constants.FETCH_ALL,c=s.driver.READ,l=s.driver.WRITE;t.READ=c,t.WRITE=l;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.rxSession=function(e){var t=void 0===e?{}:e,n=t.defaultAccessMode,r=void 0===n?l:n,i=t.bookmarks,o=t.database,s=void 0===o?"":o,u=t.fetchSize,c=t.impersonatedUser,h=t.bookmarkManager,f=t.notificationFilter,p=t.auth;return new a.default({session:this._newSession({defaultAccessMode:r,bookmarkOrBookmarks:i,database:s,impersonatedUser:c,auth:p,reactive:!1,fetchSize:d(u,this._config.fetchSize),bookmarkManager:h,notificationFilter:f,log:this._log}),config:this._config,log:this._log})},t}(s.Driver);function d(e,t){var n=parseInt(e,10);if(n>0||n===u)return n;if(0===n||n<0)throw new Error("The fetch size can only be a positive value or ".concat(u," for ALL. However fetchSize = ").concat(n));return t}t.Driver=h,t.default=h},71909:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.UnboundRelationship=t.Relationship=t.Node=t.Record=t.ServerInfo=t.GqlStatusObject=t.Notification=t.QueryStatistics=t.ProfiledPlan=t.Plan=t.ResultSummary=t.RxResult=t.RxManagedTransaction=t.RxTransaction=t.RxSession=t.EagerResult=t.Result=t.ManagedTransaction=t.Transaction=t.Session=t.Driver=t.temporal=t.spatial=t.graph=t.error=t.routing=t.session=t.types=t.logging=t.auth=t.isRetryableError=t.Neo4jError=t.integer=t.isUnboundRelationship=t.isRelationship=t.isPathSegment=t.isPath=t.isNode=t.isDateTime=t.isLocalDateTime=t.isDate=t.isTime=t.isLocalTime=t.isDuration=t.isPoint=t.isInt=t.int=t.hasReachableServer=t.driver=t.authTokenManagers=void 0,t.clientCertificateProviders=t.notificationFilterMinimumSeverityLevel=t.notificationFilterDisabledClassification=t.notificationFilterDisabledCategory=t.notificationSeverityLevel=t.notificationClassification=t.notificationCategory=t.resultTransformers=t.bookmarkManager=t.DateTime=t.LocalDateTime=t.Date=t.Time=t.LocalTime=t.Duration=t.Integer=t.Point=t.PathSegment=t.Path=void 0;var s=n(23279);Object.defineProperty(t,"Driver",{enumerable:!0,get:function(){return s.Driver}});var a=o(n(35286)),u=n(41264);Object.defineProperty(t,"authTokenManagers",{enumerable:!0,get:function(){return u.authTokenManagers}}),Object.defineProperty(t,"Neo4jError",{enumerable:!0,get:function(){return u.Neo4jError}}),Object.defineProperty(t,"isRetryableError",{enumerable:!0,get:function(){return u.isRetryableError}}),Object.defineProperty(t,"error",{enumerable:!0,get:function(){return u.error}}),Object.defineProperty(t,"Integer",{enumerable:!0,get:function(){return u.Integer}}),Object.defineProperty(t,"int",{enumerable:!0,get:function(){return u.int}}),Object.defineProperty(t,"isInt",{enumerable:!0,get:function(){return u.isInt}}),Object.defineProperty(t,"isPoint",{enumerable:!0,get:function(){return u.isPoint}}),Object.defineProperty(t,"Point",{enumerable:!0,get:function(){return u.Point}}),Object.defineProperty(t,"Date",{enumerable:!0,get:function(){return u.Date}}),Object.defineProperty(t,"DateTime",{enumerable:!0,get:function(){return u.DateTime}}),Object.defineProperty(t,"Duration",{enumerable:!0,get:function(){return u.Duration}}),Object.defineProperty(t,"isDate",{enumerable:!0,get:function(){return u.isDate}}),Object.defineProperty(t,"isDateTime",{enumerable:!0,get:function(){return u.isDateTime}}),Object.defineProperty(t,"isDuration",{enumerable:!0,get:function(){return u.isDuration}}),Object.defineProperty(t,"isLocalDateTime",{enumerable:!0,get:function(){return u.isLocalDateTime}}),Object.defineProperty(t,"isLocalTime",{enumerable:!0,get:function(){return u.isLocalTime}}),Object.defineProperty(t,"isNode",{enumerable:!0,get:function(){return u.isNode}}),Object.defineProperty(t,"isPath",{enumerable:!0,get:function(){return u.isPath}}),Object.defineProperty(t,"isPathSegment",{enumerable:!0,get:function(){return u.isPathSegment}}),Object.defineProperty(t,"isRelationship",{enumerable:!0,get:function(){return u.isRelationship}}),Object.defineProperty(t,"isTime",{enumerable:!0,get:function(){return u.isTime}}),Object.defineProperty(t,"isUnboundRelationship",{enumerable:!0,get:function(){return u.isUnboundRelationship}}),Object.defineProperty(t,"LocalDateTime",{enumerable:!0,get:function(){return u.LocalDateTime}}),Object.defineProperty(t,"LocalTime",{enumerable:!0,get:function(){return u.LocalTime}}),Object.defineProperty(t,"Time",{enumerable:!0,get:function(){return u.Time}}),Object.defineProperty(t,"Node",{enumerable:!0,get:function(){return u.Node}}),Object.defineProperty(t,"Path",{enumerable:!0,get:function(){return u.Path}}),Object.defineProperty(t,"PathSegment",{enumerable:!0,get:function(){return u.PathSegment}}),Object.defineProperty(t,"Relationship",{enumerable:!0,get:function(){return u.Relationship}}),Object.defineProperty(t,"UnboundRelationship",{enumerable:!0,get:function(){return u.UnboundRelationship}}),Object.defineProperty(t,"Record",{enumerable:!0,get:function(){return u.Record}}),Object.defineProperty(t,"ResultSummary",{enumerable:!0,get:function(){return u.ResultSummary}}),Object.defineProperty(t,"Plan",{enumerable:!0,get:function(){return u.Plan}}),Object.defineProperty(t,"ProfiledPlan",{enumerable:!0,get:function(){return u.ProfiledPlan}}),Object.defineProperty(t,"QueryStatistics",{enumerable:!0,get:function(){return u.QueryStatistics}}),Object.defineProperty(t,"Notification",{enumerable:!0,get:function(){return u.Notification}}),Object.defineProperty(t,"GqlStatusObject",{enumerable:!0,get:function(){return u.GqlStatusObject}}),Object.defineProperty(t,"ServerInfo",{enumerable:!0,get:function(){return u.ServerInfo}}),Object.defineProperty(t,"Result",{enumerable:!0,get:function(){return u.Result}}),Object.defineProperty(t,"EagerResult",{enumerable:!0,get:function(){return u.EagerResult}}),Object.defineProperty(t,"auth",{enumerable:!0,get:function(){return u.auth}}),Object.defineProperty(t,"Session",{enumerable:!0,get:function(){return u.Session}}),Object.defineProperty(t,"Transaction",{enumerable:!0,get:function(){return u.Transaction}}),Object.defineProperty(t,"ManagedTransaction",{enumerable:!0,get:function(){return u.ManagedTransaction}}),Object.defineProperty(t,"bookmarkManager",{enumerable:!0,get:function(){return u.bookmarkManager}}),Object.defineProperty(t,"routing",{enumerable:!0,get:function(){return u.routing}}),Object.defineProperty(t,"resultTransformers",{enumerable:!0,get:function(){return u.resultTransformers}}),Object.defineProperty(t,"notificationCategory",{enumerable:!0,get:function(){return u.notificationCategory}}),Object.defineProperty(t,"notificationClassification",{enumerable:!0,get:function(){return u.notificationClassification}}),Object.defineProperty(t,"notificationSeverityLevel",{enumerable:!0,get:function(){return u.notificationSeverityLevel}}),Object.defineProperty(t,"notificationFilterDisabledCategory",{enumerable:!0,get:function(){return u.notificationFilterDisabledCategory}}),Object.defineProperty(t,"notificationFilterDisabledClassification",{enumerable:!0,get:function(){return u.notificationFilterDisabledClassification}}),Object.defineProperty(t,"notificationFilterMinimumSeverityLevel",{enumerable:!0,get:function(){return u.notificationFilterMinimumSeverityLevel}}),Object.defineProperty(t,"clientCertificateProviders",{enumerable:!0,get:function(){return u.clientCertificateProviders}});var c=n(97584),l=o(n(29115));t.RxSession=l.default;var h=o(n(62953));t.RxTransaction=h.default;var d=o(n(12316));t.RxManagedTransaction=d.default;var f=o(n(59784));t.RxResult=f.default;var p=u.internal.util,m=p.ENCRYPTION_ON,g=p.assertString,v=p.isEmptyObjectOrNull,y=u.internal.serverAddress.ServerAddress,b=u.internal.urlUtil,_="neo4j-javascript/"+a.default;function x(e,t,n){void 0===n&&(n={}),g(e,"Bolt URL");var r,i=b.parseDatabaseUrl(e),o=!1,l=!1;switch(i.scheme){case"bolt":break;case"bolt+s":l=!0,r="TRUST_SYSTEM_CA_SIGNED_CERTIFICATES";break;case"bolt+ssc":l=!0,r="TRUST_ALL_CERTIFICATES";break;case"neo4j":o=!0;break;case"neo4j+s":l=!0,r="TRUST_SYSTEM_CA_SIGNED_CERTIFICATES",o=!0;break;case"neo4j+ssc":l=!0,r="TRUST_ALL_CERTIFICATES",o=!0;break;default:throw new Error("Unknown scheme: ".concat(i.scheme))}if(l){if("encrypted"in n||"trust"in n)throw new Error("Encryption/trust can only be configured either through URL or config, not both");n.encrypted=m,n.trust=r,n.clientCertificate=(0,u.resolveCertificateProvider)(n.clientCertificate)}var h=function(e){if("object"==typeof(t=e)&&null!=t&&"getToken"in t&&"handleSecurityException"in t&&"function"==typeof t.getToken&&"function"==typeof t.handleSecurityException)return e;var t,n=e;return(n=n||{}).scheme=n.scheme||"none",(0,u.staticAuthTokenManager)({authToken:n})}(t);n.userAgent=n.userAgent||_,n.boltAgent=u.internal.boltAgent.fromVersion(a.default);var d=y.fromUrl(i.hostAndPort),f={address:d,typename:o?"Routing":"Direct",routing:o};return new s.Driver(f,n,function(){if(o)return function(e,t,n,r){return new c.RoutingConnectionProvider({id:e,config:t,log:n,hostNameResolver:r,authTokenManager:h,address:d,userAgent:t.userAgent,boltAgent:t.boltAgent,routingContext:i.query})};if(!v(i.query))throw new Error("Parameters are not supported with none routed scheme. Given URL: '".concat(e,"'"));return function(e,t,n){return new c.DirectConnectionProvider({id:e,config:t,log:n,authTokenManager:h,address:d,userAgent:t.userAgent,boltAgent:t.boltAgent})}}())}function w(e,t){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:n=x(e,{scheme:"none",principal:"",credentials:""},t),r.label=1;case 1:return r.trys.push([1,,3,5]),[4,n.getNegotiatedProtocolVersion()];case 2:return r.sent(),[2,!0];case 3:return[4,n.close()];case 4:return r.sent(),[7];case 5:return[2]}}))}))}t.driver=x,t.hasReachableServer=w;var S={console:function(e){return{level:e,logger:function(e,t){return console.log("".concat(n.g.Date.now()," ").concat(e.toUpperCase()," ").concat(t))}}}};t.logging=S;var E={Node:u.Node,Relationship:u.Relationship,UnboundRelationship:u.UnboundRelationship,PathSegment:u.PathSegment,Path:u.Path,Result:u.Result,EagerResult:u.EagerResult,ResultSummary:u.ResultSummary,Record:u.Record,Point:u.Point,Date:u.Date,DateTime:u.DateTime,Duration:u.Duration,LocalDateTime:u.LocalDateTime,LocalTime:u.LocalTime,Time:u.Time,Integer:u.Integer};t.types=E;var T={READ:s.READ,WRITE:s.WRITE};t.session=T;var M={toNumber:u.toNumber,toString:u.toString,inSafeRange:u.inSafeRange};t.integer=M;var A={isPoint:u.isPoint};t.spatial=A;var C={isDuration:u.isDuration,isLocalTime:u.isLocalTime,isTime:u.isTime,isDate:u.isDate,isLocalDateTime:u.isLocalDateTime,isDateTime:u.isDateTime};t.temporal=C;var O={isNode:u.isNode,isPath:u.isPath,isPathSegment:u.isPathSegment,isRelationship:u.isRelationship,isUnboundRelationship:u.isUnboundRelationship};t.graph=O;var P={authTokenManagers:u.authTokenManagers,driver:x,hasReachableServer:w,int:u.int,isInt:u.isInt,isPoint:u.isPoint,isDuration:u.isDuration,isLocalTime:u.isLocalTime,isTime:u.isTime,isDate:u.isDate,isLocalDateTime:u.isLocalDateTime,isDateTime:u.isDateTime,isNode:u.isNode,isPath:u.isPath,isPathSegment:u.isPathSegment,isRelationship:u.isRelationship,isUnboundRelationship:u.isUnboundRelationship,integer:M,Neo4jError:u.Neo4jError,isRetryableError:u.isRetryableError,auth:u.auth,logging:S,types:E,session:T,routing:u.routing,error:u.error,graph:O,spatial:A,temporal:C,Driver:s.Driver,Session:u.Session,Transaction:u.Transaction,ManagedTransaction:u.ManagedTransaction,Result:u.Result,EagerResult:u.EagerResult,RxSession:l.default,RxTransaction:h.default,RxManagedTransaction:d.default,RxResult:f.default,ResultSummary:u.ResultSummary,Plan:u.Plan,ProfiledPlan:u.ProfiledPlan,QueryStatistics:u.QueryStatistics,Notification:u.Notification,GqlStatusObject:u.GqlStatusObject,ServerInfo:u.ServerInfo,Record:u.Record,Node:u.Node,Relationship:u.Relationship,UnboundRelationship:u.UnboundRelationship,Path:u.Path,PathSegment:u.PathSegment,Point:u.Point,Integer:u.Integer,Duration:u.Duration,LocalTime:u.LocalTime,Time:u.Time,Date:u.Date,LocalDateTime:u.LocalDateTime,DateTime:u.DateTime,bookmarkManager:u.bookmarkManager,resultTransformers:u.resultTransformers,notificationCategory:u.notificationCategory,notificationSeverityLevel:u.notificationSeverityLevel,notificationFilterDisabledCategory:u.notificationFilterDisabledCategory,notificationFilterMinimumSeverityLevel:u.notificationFilterMinimumSeverityLevel,clientCertificateProviders:u.clientCertificateProviders};t.default=P},13223:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(41264),i=n(54041),o=n(7455),s=(r.internal.logger.Logger,r.error.SERVICE_UNAVAILABLE),a=function(){function e(e){var t=void 0===e?{}:e,n=t.maxRetryTimeout,r=void 0===n?3e4:n,i=t.initialDelay,o=void 0===i?1e3:i,s=t.delayMultiplier,a=void 0===s?2:s,c=t.delayJitter,l=void 0===c?.2:c,h=t.logger,d=void 0===h?null:h;this._maxRetryTimeout=u(r,3e4),this._initialDelay=u(o,1e3),this._delayMultiplier=u(a,2),this._delayJitter=u(l,.2),this._logger=d}return e.prototype.retry=function(e){var t=this;return e.pipe((0,o.retryWhen)((function(e){var n=[],a=Date.now(),u=1,c=t._initialDelay;return e.pipe((0,o.mergeMap)((function(e){if(!(0,r.isRetriableError)(e))return(0,i.throwError)((function(){return e}));if(n.push(e),u>=2&&Date.now()-a>=t._maxRetryTimeout){var l=(0,r.newError)("Failed after retried for ".concat(u," times in ").concat(t._maxRetryTimeout," ms. Make sure that your database is online and retry again."),s);return l.seenErrors=n,(0,i.throwError)((function(){return l}))}var h=t._computeNextDelay(c);return c*=t._delayMultiplier,u++,t._logger&&t._logger.warn("Transaction failed and will be retried in ".concat(h)),(0,i.of)(1).pipe((0,o.delay)(h))})))})))},e.prototype._computeNextDelay=function(e){var t=e*this._delayJitter;return e-t+2*t*Math.random()},e}();function u(e,t){return e||0===e?e:t}t.default=a},59784:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(41264),s=n(54041),a=n(7455),u=0,c=1,l=2,h=function(){function e(e,t){var n=e.pipe((0,a.publishReplay)(1),(0,a.refCount)());this._result=n,this._keys=n.pipe((0,a.mergeMap)((function(e){return(0,s.from)(e.keys())})),(0,a.publishReplay)(1),(0,a.refCount)()),this._records=void 0,this._controls=new d,this._summary=new s.ReplaySubject,this._state=t||u}return e.prototype.keys=function(){return this._keys},e.prototype.records=function(){var e=this,t=this._result.pipe((0,a.mergeMap)((function(t){return new s.Observable((function(n){return e._startStreaming({result:t,recordsObserver:n})}))})));return t.push=function(){return e._push()},t},e.prototype.consume=function(){var e=this;return this._result.pipe((0,a.mergeMap)((function(t){return new s.Observable((function(n){return e._startStreaming({result:t,summaryObserver:n})}))})))},e.prototype.pause=function(){this._controls.pause()},e.prototype.resume=function(){return this._controls.resume()},e.prototype.push=function(){return this._controls.push()},e.prototype._startStreaming=function(e){var t=void 0===e?{}:e,n=t.result,r=t.recordsObserver,i=void 0===r?null:r,s=t.summaryObserver,a=void 0===s?null:s,u=[];return a&&u.push(this._summary.subscribe(a)),this._state<c?(this._state=c,this._setupRecordsStream(n),i?u.push(this._records.subscribe(i)):n._cancel(),u.push({unsubscribe:function(){n._cancel&&n._cancel()}})):i&&i.error((0,o.newError)("Streaming has already started/consumed with a previous records or summary subscription.")),function(){u.forEach((function(e){return e.unsubscribe()}))}},e.prototype._toObservable=function(){var t=this;return new s.Observable((function(n){t._result.subscribe({complete:function(){return n.complete()},next:function(r){return n.next(new e(function(e){return new s.Observable((function(t){t.next(e),t.complete()}))}(r)),t._state)},error:function(e){return n.error(e)}})}))},e.prototype._setupRecordsStream=function(e){var t=this;return this._records||(this._records=function(e,t,n){var o=this;void 0===n&&(n=new d);var a=new s.Subject,u=function(s){return r(o,void 0,void 0,(function(){var r,o,c,l;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,3,4]),n.pushing=!0,[4,s];case 1:return r=i.sent(),o=r.done,c=r.value,o?(a.complete(),t.complete()):(a.next(c),n.paused||u(e.next()).catch((function(){}))),[3,4];case 2:return l=i.sent(),a.error(l),t.error(l),[3,4];case 3:return n.pushing=!1,[7];case 4:return[2]}}))}))};function c(t){return r(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,u(e.next(t))];case 1:return n.sent(),[2]}}))}))}return n.pusher=c,c(),a}(e[Symbol.asyncIterator](),{complete:function(){return r(t,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return this._state=l,n=(t=this._summary).next,[4,e.summary()];case 1:return n.apply(t,[r.sent()]),this._summary.complete(),[2]}}))}))},error:function(e){t._state=l,t._summary.error(e)}},this._controls)),this._records},e}();t.default=h;var d=function(){function e(e){void 0===e&&(e=function(){return r(t,void 0,void 0,(function(){return i(this,(function(e){return[2]}))}))});var t=this;this._paused=!1,this._pushing=!1,this._push=e}return e.prototype.pause=function(){this._paused=!0},Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pushing",{get:function(){return this._pushing},set:function(e){this._pushing=e},enumerable:!1,configurable:!0}),e.prototype.resume=function(){return r(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return e=this._paused,this._paused=!1,!e||this._pushing?[3,2]:[4,this._push()];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},e.prototype.push=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this.pause(),[4,this._push()];case 1:return[2,e.sent()]}}))}))},Object.defineProperty(e.prototype,"pusher",{get:function(){return this._push},set:function(e){this._push=e},enumerable:!1,configurable:!0}),e}()},29115:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(54041),o=n(7455),s=r(n(59784)),a=n(41264),u=r(n(62953)),c=r(n(12316)),l=r(n(13223)),h=a.internal.constants,d=h.ACCESS_MODE_READ,f=h.ACCESS_MODE_WRITE,p=h.TELEMETRY_APIS,m=a.internal.txConfig.TxConfig,g=function(){function e(e){var t=void 0===e?{}:e,n=t.session,r=t.config,i=t.log;this._session=n,this._retryLogic=function(e){var t=e&&e.maxTransactionRetryTime?e.maxTransactionRetryTime:null;return new l.default({maxRetryTimeout:t})}(r),this._log=i}return e.prototype.run=function(e,t,n){var r=this;return new s.default(new i.Observable((function(i){try{i.next(r._session.run(e,t,n)),i.complete()}catch(e){i.error(e)}return function(){}})))},e.prototype.beginTransaction=function(e){return this._beginTransaction(this._session._mode,e,{api:p.UNMANAGED_TRANSACTION})},e.prototype.readTransaction=function(e,t){return this._runTransaction(d,e,t)},e.prototype.writeTransaction=function(e,t){return this._runTransaction(f,e,t)},e.prototype.executeRead=function(e,t){return this._executeInTransaction(d,e,t)},e.prototype.executeWrite=function(e,t){return this._executeInTransaction(f,e,t)},e.prototype._executeInTransaction=function(e,t,n){return this._runTransaction(e,t,n,(function(e){return new c.default({run:e.run.bind(e)})}))},e.prototype.close=function(){var e=this;return new i.Observable((function(t){e._session.close().then((function(){t.complete()})).catch((function(e){return t.error(e)}))}))},e.prototype[Symbol.asyncDispose]=function(){return this.close()},e.prototype.lastBookmark=function(){return this.lastBookmarks()},e.prototype.lastBookmarks=function(){return this._session.lastBookmarks()},e.prototype._beginTransaction=function(e,t,n){var r=this,o=m.empty();return t&&(o=new m(t,this._log)),new i.Observable((function(t){try{r._session._beginTransaction(e,o,n).then((function(e){t.next(new u.default(e)),t.complete()})).catch((function(e){return t.error(e)}))}catch(e){t.error(e)}return function(){}}))},e.prototype._runTransaction=function(e,t,n,r){var s=this;void 0===r&&(r=function(e){return e});var a=m.empty();n&&(a=new m(n));var u={apiTelemetryConfig:{api:p.MANAGED_TRANSACTION,onTelemetrySuccess:function(){u.apiTelemetryConfig=void 0}}};return this._retryLogic.retry((0,i.of)(1).pipe((0,o.mergeMap)((function(){return s._beginTransaction(e,a,u.apiTelemetryConfig)})),(0,o.mergeMap)((function(e){return(0,i.defer)((function(){try{return t(r(e))}catch(e){return(0,i.throwError)((function(){return e}))}})).pipe((0,o.catchError)((function(t){return e.rollback().pipe((0,o.concatWith)((0,i.throwError)((function(){return t}))))})),(0,o.concatWith)(e.commit()))}))))},e}();t.default=g},12316:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});r(n(59784)),r(n(62953));var i=function(){function e(e){var t=e.run;this._run=t}return e.fromTransaction=function(t){return new e({run:t.run.bind(t)})},e.prototype.run=function(e,t){return this._run(e,t)},e}();t.default=i},62953:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(54041),o=r(n(59784)),s=(r(n(41264)),function(){function e(e){this._txc=e}return e.prototype.run=function(e,t){var n=this;return new o.default(new i.Observable((function(r){try{r.next(n._txc.run(e,t)),r.complete()}catch(e){r.error(e)}return function(){}})))},e.prototype.commit=function(){var e=this;return new i.Observable((function(t){e._txc.commit().then((function(){t.complete()})).catch((function(e){return t.error(e)}))}))},e.prototype.rollback=function(){var e=this;return new i.Observable((function(t){e._txc.rollback().then((function(){t.complete()})).catch((function(e){return t.error(e)}))}))},e.prototype.isOpen=function(){return this._txc.isOpen()},e.prototype.close=function(){var e=this;return new i.Observable((function(t){e._txc.close().then((function(){t.complete()})).catch((function(e){return t.error(e)}))}))},e}());t.default=s},35286:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="5.26.0"},73971:function(e){e.exports=function(e){!function(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var t=["on","fire","off"],n=0;n<t.length;++n)if(e.hasOwnProperty(t[n]))throw new Error("Subject cannot be eventified, since it already has property '"+t[n]+"'")}(e);var t=function(e){var t=Object.create(null);return{on:function(n,r,i){if("function"!=typeof r)throw new Error("callback is expected to be a function");var o=t[n];return o||(o=t[n]=[]),o.push({callback:r,ctx:i}),e},off:function(n,r){if(void 0===n)return t=Object.create(null),e;if(t[n])if("function"!=typeof r)delete t[n];else for(var i=t[n],o=0;o<i.length;++o)i[o].callback===r&&i.splice(o,1);return e},fire:function(n){var r,i=t[n];if(!i)return e;arguments.length>1&&(r=Array.prototype.splice.call(arguments,1));for(var o=0;o<i.length;++o){var s=i[o];s.callback.apply(s.ctx,r)}return e}}}(e);return e.on=t.on,e.off=t.off,e.fire=t.fire,e}},88291:function(e,t,n){e.exports=function(e,t){if(!e)throw new Error("Graph structure cannot be undefined");var o=(t&&t.createSimulator||n(71985))(t);if(Array.isArray(t))throw new Error("Physics settings is expected to be an object");var s=e.version>19?function(t){var n=e.getLinks(t);return n?1+n.size/3:1}:function(t){var n=e.getLinks(t);return n?1+n.length/3:1};t&&"function"==typeof t.nodeMass&&(s=t.nodeMass);var a=new Map,u={},c=0,l=o.settings.springTransform||i;c=0,e.forEachNode((function(e){g(e.id),c+=1})),e.forEachLink(y),e.on("changed",m);var h=!1,d={step:function(){if(0===c)return f(!0),!0;var e=o.step();d.lastMove=e,d.fire("step");var t=e/c<=.01;return f(t),t},getNodePosition:function(e){return x(e).pos},setNodePosition:function(e){var t=x(e);t.setPosition.apply(t,Array.prototype.slice.call(arguments,1))},getLinkPosition:function(e){var t=u[e];if(t)return{from:t.from.pos,to:t.to.pos}},getGraphRect:function(){return o.getBBox()},forEachBody:p,pinNode:function(e,t){x(e.id).isPinned=!!t},isNodePinned:function(e){return x(e.id).isPinned},dispose:function(){e.off("changed",m),d.fire("disposed")},getBody:function(e){return a.get(e)},getSpring:function(t,n){var r;if(void 0===n)r="object"!=typeof t?t:t.id;else{var i=e.hasLink(t,n);if(!i)return;r=i.id}return u[r]},getForceVectorLength:function(){var e=0,t=0;return p((function(n){e+=Math.abs(n.force.x),t+=Math.abs(n.force.y)})),Math.sqrt(e*e+t*t)},simulator:o,graph:e,lastMove:0};return r(d),d;function f(e){var t;h!==e&&(h=e,t=e,d.fire("stable",t))}function p(e){a.forEach(e)}function m(t){for(var n=0;n<t.length;++n){var r=t[n];"add"===r.changeType?(r.node&&g(r.node.id),r.link&&y(r.link)):"remove"===r.changeType&&(r.node&&v(r.node),r.link&&b(r.link))}c=e.getNodesCount()}function g(t){var n=a.get(t);if(!n){var r=e.getNode(t);if(!r)throw new Error("initBody() was called with unknown node id");var i=r.position;if(!i){var s=function(e){var t=[];if(!e.links)return t;for(var n=Math.min(e.links.length,2),r=0;r<n;++r){var i=e.links[r],o=i.fromId!==e.id?a.get(i.fromId):a.get(i.toId);o&&o.pos&&t.push(o)}return t}(r);i=o.getBestNewBodyPosition(s)}(n=o.addBodyAt(i)).id=t,a.set(t,n),_(t),function(e){return e&&(e.isPinned||e.data&&e.data.isPinned)}(r)&&(n.isPinned=!0)}}function v(e){var t=e.id,n=a.get(t);n&&(a.delete(t),o.removeBody(n))}function y(e){_(e.fromId),_(e.toId);var t=a.get(e.fromId),n=a.get(e.toId),r=o.addSpring(t,n,e.length);l(e,r),u[e.id]=r}function b(t){var n=u[t.id];if(n){var r=e.getNode(t.fromId),i=e.getNode(t.toId);r&&_(r.id),i&&_(i.id),delete u[t.id],o.removeSpring(n)}}function _(e){var t=a.get(e);if(t.mass=s(e),Number.isNaN(t.mass))throw new Error("Node mass should be a number")}function x(e){var t=a.get(e);return t||(g(e),t=a.get(e)),t}},e.exports.simulator=n(71985);var r=n(73971);function i(){}},36974:function(e,t,n){const r=n(40552);e.exports=function(e){return function(t,n){let i=n&&n.indent||0,o=n&&void 0!==n.join?n.join:"\n",s=Array(i+1).join(" "),a=[];for(let n=0;n<e;++n){let e=r(n),i=0===n?"":s;a.push(i+t.replace(/{var}/g,e))}return a.join(o)}}},62835:function(e,t,n){e.exports=function(e){let t=i(e);return new Function("bodies","settings","random",t)},e.exports.generateFunctionBody=i;const r=n(36974);function i(e){let t=r(e);return`\n  var boundingBox = {\n    ${t("min_{var}: 0, max_{var}: 0,",{indent:4})}\n  };\n\n  return {\n    box: boundingBox,\n\n    update: updateBoundingBox,\n\n    reset: resetBoundingBox,\n\n    getBestNewPosition: function (neighbors) {\n      var ${t("base_{var} = 0",{join:", "})};\n\n      if (neighbors.length) {\n        for (var i = 0; i < neighbors.length; ++i) {\n          let neighborPos = neighbors[i].pos;\n          ${t("base_{var} += neighborPos.{var};",{indent:10})}\n        }\n\n        ${t("base_{var} /= neighbors.length;",{indent:8})}\n      } else {\n        ${t("base_{var} = (boundingBox.min_{var} + boundingBox.max_{var}) / 2;",{indent:8})}\n      }\n\n      var springLength = settings.springLength;\n      return {\n        ${t("{var}: base_{var} + (random.nextDouble() - 0.5) * springLength,",{indent:8})}\n      };\n    }\n  };\n\n  function updateBoundingBox() {\n    var i = bodies.length;\n    if (i === 0) return; // No bodies - no borders.\n\n    ${t("var max_{var} = -Infinity;",{indent:4})}\n    ${t("var min_{var} = Infinity;",{indent:4})}\n\n    while(i--) {\n      // this is O(n), it could be done faster with quadtree, if we check the root node bounds\n      var bodyPos = bodies[i].pos;\n      ${t("if (bodyPos.{var} < min_{var}) min_{var} = bodyPos.{var};",{indent:6})}\n      ${t("if (bodyPos.{var} > max_{var}) max_{var} = bodyPos.{var};",{indent:6})}\n    }\n\n    ${t("boundingBox.min_{var} = min_{var};",{indent:4})}\n    ${t("boundingBox.max_{var} = max_{var};",{indent:4})}\n  }\n\n  function resetBoundingBox() {\n    ${t("boundingBox.min_{var} = boundingBox.max_{var} = 0;",{indent:4})}\n  }\n`}},54821:function(e,t,n){const r=n(36974);function i(e,t){return`\n${s(e,t)}\n${o(e)}\nreturn {Body: Body, Vector: Vector};\n`}function o(e){let t=r(e),n=t("{var}",{join:", "});return`\nfunction Body(${n}) {\n  this.isPinned = false;\n  this.pos = new Vector(${n});\n  this.force = new Vector();\n  this.velocity = new Vector();\n  this.mass = 1;\n\n  this.springCount = 0;\n  this.springLength = 0;\n}\n\nBody.prototype.reset = function() {\n  this.force.reset();\n  this.springCount = 0;\n  this.springLength = 0;\n}\n\nBody.prototype.setPosition = function (${n}) {\n  ${t("this.pos.{var} = {var} || 0;",{indent:2})}\n};`}function s(e,t){let n=r(e),i="";return t&&(i=`${n("\n   var v{var};\nObject.defineProperty(this, '{var}', {\n  set: function(v) { \n    if (!Number.isFinite(v)) throw new Error('Cannot set non-numbers to {var}');\n    v{var} = v; \n  },\n  get: function() { return v{var}; }\n});")}`),`function Vector(${n("{var}",{join:", "})}) {\n  ${i}\n    if (typeof arguments[0] === 'object') {\n      // could be another vector\n      let v = arguments[0];\n      ${n('if (!Number.isFinite(v.{var})) throw new Error("Expected value is not a finite number at Vector constructor ({var})");',{indent:4})}\n      ${n("this.{var} = v.{var};",{indent:4})}\n    } else {\n      ${n('this.{var} = typeof {var} === "number" ? {var} : 0;',{indent:4})}\n    }\n  }\n  \n  Vector.prototype.reset = function () {\n    ${n("this.{var} = ",{join:""})}0;\n  };`}e.exports=function(e,t){let n=i(e,t),{Body:r}=new Function(n)();return r},e.exports.generateCreateBodyFunctionBody=i,e.exports.getVectorCode=s,e.exports.getBodyCode=o},94176:function(e,t,n){const r=n(36974);function i(e){return`\n  if (!Number.isFinite(options.dragCoefficient)) throw new Error('dragCoefficient is not a finite number');\n\n  return {\n    update: function(body) {\n      ${r(e)("body.force.{var} -= options.dragCoefficient * body.velocity.{var};",{indent:6})}\n    }\n  };\n`}e.exports=function(e){let t=i(e);return new Function("options",t)},e.exports.generateCreateDragForceFunctionBody=i},62770:function(e,t,n){const r=n(36974);function i(e){let t=r(e);return`\n  if (!Number.isFinite(options.springCoefficient)) throw new Error('Spring coefficient is not a number');\n  if (!Number.isFinite(options.springLength)) throw new Error('Spring length is not a number');\n\n  return {\n    /**\n     * Updates forces acting on a spring\n     */\n    update: function (spring) {\n      var body1 = spring.from;\n      var body2 = spring.to;\n      var length = spring.length < 0 ? options.springLength : spring.length;\n      ${t("var d{var} = body2.pos.{var} - body1.pos.{var};",{indent:6})}\n      var r = Math.sqrt(${t("d{var} * d{var}",{join:" + "})});\n\n      if (r === 0) {\n        ${t("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:8})}\n        r = Math.sqrt(${t("d{var} * d{var}",{join:" + "})});\n      }\n\n      var d = r - length;\n      var coefficient = ((spring.coefficient > 0) ? spring.coefficient : options.springCoefficient) * d / r;\n\n      ${t("body1.force.{var} += coefficient * d{var}",{indent:6})};\n      body1.springCount += 1;\n      body1.springLength += r;\n\n      ${t("body2.force.{var} -= coefficient * d{var}",{indent:6})};\n      body2.springCount += 1;\n      body2.springLength += r;\n    }\n  };\n`}e.exports=function(e){let t=i(e);return new Function("options","random",t)},e.exports.generateCreateSpringForceFunctionBody=i},16008:function(e,t,n){const r=n(36974);function i(e){let t=r(e);return`\n  var length = bodies.length;\n  if (length === 0) return 0;\n\n  ${t("var d{var} = 0, t{var} = 0;",{indent:2})}\n\n  for (var i = 0; i < length; ++i) {\n    var body = bodies[i];\n    if (body.isPinned) continue;\n\n    if (adaptiveTimeStepWeight && body.springCount) {\n      timeStep = (adaptiveTimeStepWeight * body.springLength/body.springCount);\n    }\n\n    var coeff = timeStep / body.mass;\n\n    ${t("body.velocity.{var} += coeff * body.force.{var};",{indent:4})}\n    ${t("var v{var} = body.velocity.{var};",{indent:4})}\n    var v = Math.sqrt(${t("v{var} * v{var}",{join:" + "})});\n\n    if (v > 1) {\n      // We normalize it so that we move within timeStep range. \n      // for the case when v <= 1 - we let velocity to fade out.\n      ${t("body.velocity.{var} = v{var} / v;",{indent:6})}\n    }\n\n    ${t("d{var} = timeStep * body.velocity.{var};",{indent:4})}\n\n    ${t("body.pos.{var} += d{var};",{indent:4})}\n\n    ${t("t{var} += Math.abs(d{var});",{indent:4})}\n  }\n\n  return (${t("t{var} * t{var}",{join:" + "})})/length;\n`}e.exports=function(e){let t=i(e);return new Function("bodies","timeStep","adaptiveTimeStepWeight",t)},e.exports.generateIntegratorFunctionBody=i},84933:function(e,t,n){const r=n(36974),i=n(40552);function o(e){let t=r(e),n=Math.pow(2,e);return`\n${l()}\n${c(e)}\n${s(e)}\n${u(e)}\n${a(e)}\n\nfunction createQuadTree(options, random) {\n  options = options || {};\n  options.gravity = typeof options.gravity === 'number' ? options.gravity : -1;\n  options.theta = typeof options.theta === 'number' ? options.theta : 0.8;\n\n  var gravity = options.gravity;\n  var updateQueue = [];\n  var insertStack = new InsertStack();\n  var theta = options.theta;\n\n  var nodesCache = [];\n  var currentInCache = 0;\n  var root = newNode();\n\n  return {\n    insertBodies: insertBodies,\n\n    /**\n     * Gets root node if it is present\n     */\n    getRoot: function() {\n      return root;\n    },\n\n    updateBodyForce: update,\n\n    options: function(newOptions) {\n      if (newOptions) {\n        if (typeof newOptions.gravity === 'number') {\n          gravity = newOptions.gravity;\n        }\n        if (typeof newOptions.theta === 'number') {\n          theta = newOptions.theta;\n        }\n\n        return this;\n      }\n\n      return {\n        gravity: gravity,\n        theta: theta\n      };\n    }\n  };\n\n  function newNode() {\n    // To avoid pressure on GC we reuse nodes.\n    var node = nodesCache[currentInCache];\n    if (node) {\n${function(e){let t=[];for(let r=0;r<n;++r)t.push(`${e}quad${r} = null;`);return t.join("\n")}("      node.")}\n      node.body = null;\n      node.mass = ${t("node.mass_{var} = ",{join:""})}0;\n      ${t("node.min_{var} = node.max_{var} = ",{join:""})}0;\n    } else {\n      node = new QuadNode();\n      nodesCache[currentInCache] = node;\n    }\n\n    ++currentInCache;\n    return node;\n  }\n\n  function update(sourceBody) {\n    var queue = updateQueue;\n    var v;\n    ${t("var d{var};",{indent:4})}\n    var r; \n    ${t("var f{var} = 0;",{indent:4})}\n    var queueLength = 1;\n    var shiftIdx = 0;\n    var pushIdx = 1;\n\n    queue[0] = root;\n\n    while (queueLength) {\n      var node = queue[shiftIdx];\n      var body = node.body;\n\n      queueLength -= 1;\n      shiftIdx += 1;\n      var differentBody = (body !== sourceBody);\n      if (body && differentBody) {\n        // If the current node is a leaf node (and it is not source body),\n        // calculate the force exerted by the current node on body, and add this\n        // amount to body's net force.\n        ${t("d{var} = body.pos.{var} - sourceBody.pos.{var};",{indent:8})}\n        r = Math.sqrt(${t("d{var} * d{var}",{join:" + "})});\n\n        if (r === 0) {\n          // Poor man's protection against zero distance.\n          ${t("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}\n          r = Math.sqrt(${t("d{var} * d{var}",{join:" + "})});\n        }\n\n        // This is standard gravitation force calculation but we divide\n        // by r^3 to save two operations when normalizing force vector.\n        v = gravity * body.mass * sourceBody.mass / (r * r * r);\n        ${t("f{var} += v * d{var};",{indent:8})}\n      } else if (differentBody) {\n        // Otherwise, calculate the ratio s / r,  where s is the width of the region\n        // represented by the internal node, and r is the distance between the body\n        // and the node's center-of-mass\n        ${t("d{var} = node.mass_{var} / node.mass - sourceBody.pos.{var};",{indent:8})}\n        r = Math.sqrt(${t("d{var} * d{var}",{join:" + "})});\n\n        if (r === 0) {\n          // Sorry about code duplication. I don't want to create many functions\n          // right away. Just want to see performance first.\n          ${t("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}\n          r = Math.sqrt(${t("d{var} * d{var}",{join:" + "})});\n        }\n        // If s / r < θ, treat this internal node as a single body, and calculate the\n        // force it exerts on sourceBody, and add this amount to sourceBody's net force.\n        if ((node.max_${i(0)} - node.min_${i(0)}) / r < theta) {\n          // in the if statement above we consider node's width only\n          // because the region was made into square during tree creation.\n          // Thus there is no difference between using width or height.\n          v = gravity * node.mass * sourceBody.mass / (r * r * r);\n          ${t("f{var} += v * d{var};",{indent:10})}\n        } else {\n          // Otherwise, run the procedure recursively on each of the current node's children.\n\n          // I intentionally unfolded this loop, to save several CPU cycles.\n${function(){let e=Array(11).join(" "),t=[];for(let r=0;r<n;++r)t.push(e+`if (node.quad${r}) {`),t.push(e+`  queue[pushIdx] = node.quad${r};`),t.push(e+"  queueLength += 1;"),t.push(e+"  pushIdx += 1;"),t.push(e+"}");return t.join("\n")}()}\n        }\n      }\n    }\n\n    ${t("sourceBody.force.{var} += f{var};",{indent:4})}\n  }\n\n  function insertBodies(bodies) {\n    ${t("var {var}min = Number.MAX_VALUE;",{indent:4})}\n    ${t("var {var}max = Number.MIN_VALUE;",{indent:4})}\n    var i = bodies.length;\n\n    // To reduce quad tree depth we are looking for exact bounding box of all particles.\n    while (i--) {\n      var pos = bodies[i].pos;\n      ${t("if (pos.{var} < {var}min) {var}min = pos.{var};",{indent:6})}\n      ${t("if (pos.{var} > {var}max) {var}max = pos.{var};",{indent:6})}\n    }\n\n    // Makes the bounds square.\n    var maxSideLength = -Infinity;\n    ${t("if ({var}max - {var}min > maxSideLength) maxSideLength = {var}max - {var}min ;",{indent:4})}\n\n    currentInCache = 0;\n    root = newNode();\n    ${t("root.min_{var} = {var}min;",{indent:4})}\n    ${t("root.max_{var} = {var}min + maxSideLength;",{indent:4})}\n\n    i = bodies.length - 1;\n    if (i >= 0) {\n      root.body = bodies[i];\n    }\n    while (i--) {\n      insert(bodies[i], root);\n    }\n  }\n\n  function insert(newBody) {\n    insertStack.reset();\n    insertStack.push(root, newBody);\n\n    while (!insertStack.isEmpty()) {\n      var stackItem = insertStack.pop();\n      var node = stackItem.node;\n      var body = stackItem.body;\n\n      if (!node.body) {\n        // This is internal node. Update the total mass of the node and center-of-mass.\n        ${t("var {var} = body.pos.{var};",{indent:8})}\n        node.mass += body.mass;\n        ${t("node.mass_{var} += body.mass * {var};",{indent:8})}\n\n        // Recursively insert the body in the appropriate quadrant.\n        // But first find the appropriate quadrant.\n        var quadIdx = 0; // Assume we are in the 0's quad.\n        ${t("var min_{var} = node.min_{var};",{indent:8})}\n        ${t("var max_{var} = (min_{var} + node.max_{var}) / 2;",{indent:8})}\n\n${function(t){let n=[],r=Array(t+1).join(" ");for(let t=0;t<e;++t)n.push(r+`if (${i(t)} > max_${i(t)}) {`),n.push(r+`  quadIdx = quadIdx + ${Math.pow(2,t)};`),n.push(r+`  min_${i(t)} = max_${i(t)};`),n.push(r+`  max_${i(t)} = node.max_${i(t)};`),n.push(r+"}");return n.join("\n")}(8)}\n\n        var child = getChild(node, quadIdx);\n\n        if (!child) {\n          // The node is internal but this quadrant is not taken. Add\n          // subnode to it.\n          child = newNode();\n          ${t("child.min_{var} = min_{var};",{indent:10})}\n          ${t("child.max_{var} = max_{var};",{indent:10})}\n          child.body = body;\n\n          setChild(node, quadIdx, child);\n        } else {\n          // continue searching in this quadrant.\n          insertStack.push(child, body);\n        }\n      } else {\n        // We are trying to add to the leaf node.\n        // We have to convert current leaf into internal node\n        // and continue adding two nodes.\n        var oldBody = node.body;\n        node.body = null; // internal nodes do not cary bodies\n\n        if (isSamePosition(oldBody.pos, body.pos)) {\n          // Prevent infinite subdivision by bumping one node\n          // anywhere in this quadrant\n          var retriesCount = 3;\n          do {\n            var offset = random.nextDouble();\n            ${t("var d{var} = (node.max_{var} - node.min_{var}) * offset;",{indent:12})}\n\n            ${t("oldBody.pos.{var} = node.min_{var} + d{var};",{indent:12})}\n            retriesCount -= 1;\n            // Make sure we don't bump it out of the box. If we do, next iteration should fix it\n          } while (retriesCount > 0 && isSamePosition(oldBody.pos, body.pos));\n\n          if (retriesCount === 0 && isSamePosition(oldBody.pos, body.pos)) {\n            // This is very bad, we ran out of precision.\n            // if we do not return from the method we'll get into\n            // infinite loop here. So we sacrifice correctness of layout, and keep the app running\n            // Next layout iteration should get larger bounding box in the first step and fix this\n            return;\n          }\n        }\n        // Next iteration should subdivide node further.\n        insertStack.push(node, oldBody);\n        insertStack.push(node, body);\n      }\n    }\n  }\n}\nreturn createQuadTree;\n\n`}function s(e){let t=r(e);return`\n  function isSamePosition(point1, point2) {\n    ${t("var d{var} = Math.abs(point1.{var} - point2.{var});",{indent:2})}\n  \n    return ${t("d{var} < 1e-8",{join:" && "})};\n  }  \n`}function a(e){var t=Math.pow(2,e);return`\nfunction setChild(node, idx, child) {\n  ${function(){let e=[];for(let n=0;n<t;++n){let t=0===n?"  ":"  else ";e.push(`${t}if (idx === ${n}) node.quad${n} = child;`)}return e.join("\n")}()}\n}`}function u(e){return`function getChild(node, idx) {\n${function(){let t=[],n=Math.pow(2,e);for(let e=0;e<n;++e)t.push(`  if (idx === ${e}) return node.quad${e};`);return t.join("\n")}()}\n  return null;\n}`}function c(e){let t=r(e),n=Math.pow(2,e);return`\nfunction QuadNode() {\n  // body stored inside this node. In quad tree only leaf nodes (by construction)\n  // contain bodies:\n  this.body = null;\n\n  // Child nodes are stored in quads. Each quad is presented by number:\n  // 0 | 1\n  // -----\n  // 2 | 3\n${function(e){let t=[];for(let r=0;r<n;++r)t.push(`${e}quad${r} = null;`);return t.join("\n")}("  this.")}\n\n  // Total mass of current node\n  this.mass = 0;\n\n  // Center of mass coordinates\n  ${t("this.mass_{var} = 0;",{indent:2})}\n\n  // bounding box coordinates\n  ${t("this.min_{var} = 0;",{indent:2})}\n  ${t("this.max_{var} = 0;",{indent:2})}\n}\n`}function l(){return"\n/**\n * Our implementation of QuadTree is non-recursive to avoid GC hit\n * This data structure represent stack of elements\n * which we are trying to insert into quad tree.\n */\nfunction InsertStack () {\n    this.stack = [];\n    this.popIdx = 0;\n}\n\nInsertStack.prototype = {\n    isEmpty: function() {\n        return this.popIdx === 0;\n    },\n    push: function (node, body) {\n        var item = this.stack[this.popIdx];\n        if (!item) {\n            // we are trying to avoid memory pressure: create new element\n            // only when absolutely necessary\n            this.stack[this.popIdx] = new InsertStackElement(node, body);\n        } else {\n            item.node = node;\n            item.body = body;\n        }\n        ++this.popIdx;\n    },\n    pop: function () {\n        if (this.popIdx > 0) {\n            return this.stack[--this.popIdx];\n        }\n    },\n    reset: function () {\n        this.popIdx = 0;\n    }\n};\n\nfunction InsertStackElement(node, body) {\n    this.node = node; // QuadTree node\n    this.body = body; // physical body which needs to be inserted to node\n}\n"}e.exports=function(e){let t=o(e);return new Function(t)()},e.exports.generateQuadTreeFunctionBody=o,e.exports.getInsertStackCode=l,e.exports.getQuadNodeCode=c,e.exports.isSamePosition=s,e.exports.getChildBodyCode=u,e.exports.setChildBodyCode=a},40552:function(e){e.exports=function(e){return 0===e?"x":1===e?"y":2===e?"z":"c"+(e+1)}},71985:function(e,t,n){e.exports=function(e){var t=n(48235),h=n(77876),d=n(73971);if(e){if(void 0!==e.springCoeff)throw new Error("springCoeff was renamed to springCoefficient");if(void 0!==e.dragCoeff)throw new Error("dragCoeff was renamed to dragCoefficient")}e=h(e,{springLength:10,springCoefficient:.8,gravity:-12,theta:.8,dragCoefficient:.9,timeStep:.5,adaptiveTimeStepWeight:0,dimensions:2,debug:!1});var f=c[e.dimensions];if(!f){var p=e.dimensions;f={Body:r(p,e.debug),createQuadTree:i(p),createBounds:o(p),createDragForce:s(p),createSpringForce:a(p),integrate:u(p)},c[p]=f}var m=f.Body,g=f.createQuadTree,v=f.createBounds,y=f.createDragForce,b=f.createSpringForce,_=f.integrate,x=n(71951).random(42),w=[],S=[],E=g(e,x),T=v(w,e,x),M=b(e,x),A=y(e),C=[],O=new Map,P=0;I("nbody",(function(){if(0===w.length)return;E.insertBodies(w);var e=w.length;for(;e--;){var t=w[e];t.isPinned||(t.reset(),E.updateBodyForce(t),A.update(t))}})),I("spring",(function(){var e=S.length;for(;e--;)M.update(S[e])}));var R={bodies:w,quadTree:E,springs:S,settings:e,addForce:I,removeForce:function(e){var t=C.indexOf(O.get(e));if(t<0)return;C.splice(t,1),O.delete(e)},getForces:function(){return O},step:function(){for(var t=0;t<C.length;++t)C[t](P);var n=_(w,e.timeStep,e.adaptiveTimeStepWeight);return P+=1,n},addBody:function(e){if(!e)throw new Error("Body is required");return w.push(e),e},addBodyAt:function(e){if(!e)throw new Error("Body position is required");var t=(e=>new m(e))(e);return w.push(t),t},removeBody:function(e){if(e){var t=w.indexOf(e);if(!(t<0))return w.splice(t,1),0===w.length&&T.reset(),!0}},addSpring:function(e,n,r,i){if(!e||!n)throw new Error("Cannot add null spring to force simulator");"number"!=typeof r&&(r=-1);var o=new t(e,n,r,i>=0?i:-1);return S.push(o),o},getTotalMovement:function(){return 0},removeSpring:function(e){if(e){var t=S.indexOf(e);return t>-1?(S.splice(t,1),!0):void 0}},getBestNewBodyPosition:function(e){return T.getBestNewPosition(e)},getBBox:N,getBoundingBox:N,invalidateBBox:function(){console.warn("invalidateBBox() is deprecated, bounds always recomputed on `getBBox()` call")},gravity:function(t){return void 0!==t?(e.gravity=t,E.options({gravity:t}),this):e.gravity},theta:function(t){return void 0!==t?(e.theta=t,E.options({theta:t}),this):e.theta},random:x};return function(e,t){for(var n in e)l(e,t,n)}(e,R),d(R),R;function N(){return T.update(),T.box}function I(e,t){if(O.has(e))throw new Error("Force "+e+" is already added");O.set(e,t),C.push(t)}};var r=n(54821),i=n(84933),o=n(62835),s=n(94176),a=n(62770),u=n(16008),c={};function l(e,t,n){if(e.hasOwnProperty(n)&&"function"!=typeof t[n]){var r=Number.isFinite(e[n]);t[n]=r?function(r){if(void 0!==r){if(!Number.isFinite(r))throw new Error("Value of "+n+" should be a valid number.");return e[n]=r,t}return e[n]}:function(r){return void 0!==r?(e[n]=r,t):e[n]}}}},48235:function(e){e.exports=function(e,t,n,r){this.from=e,this.to=t,this.length=n,this.coefficient=r}},64794:function(e,t,n){e.exports=function(e){"uniqueLinkId"in(e=e||{})&&(console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\nUse `multigraph` option instead\n","\n","Note: there is also change in default behavior: From now on each graph\nis considered to be not a multigraph by default (each edge is unique)."),e.multigraph=e.uniqueLinkId);void 0===e.multigraph&&(e.multigraph=!1);if("function"!=typeof Map)throw new Error("ngraph.graph requires `Map` to be defined. Please polyfill it before using ngraph");var t=new Map,n=new Map,u={},c=0,l=e.multigraph?function(e,t,n){var r=a(e,t),i=u.hasOwnProperty(r);if(i||T(e,t)){i||(u[r]=0);var o="@"+ ++u[r];r=a(e+o,t+o)}return new s(e,t,n,r)}:function(e,t,r){var i=a(e,t),o=n.get(i);if(o)return o.data=r,o;return new s(e,t,r,i)},h=[],d=M,f=M,p=M,m=M,g={version:20,addNode:b,addLink:function(e,t,r){p();var i=_(e)||b(e),s=_(t)||b(t),a=l(e,t,r),u=n.has(a.id);n.set(a.id,a),o(i,a),e!==t&&o(s,a);return d(a,u?"update":"add"),m(),a},removeLink:function(e,t){void 0!==t&&(e=T(e,t));return E(e)},removeNode:x,getNode:_,getNodeCount:w,getLinkCount:S,getEdgeCount:S,getLinksCount:S,getNodesCount:w,getLinks:function(e){var t=_(e);return t?t.links:null},forEachNode:O,forEachLinkedNode:function(e,n,r){var i=_(e);if(i&&i.links&&"function"==typeof n)return r?function(e,n,r){var i=e.values(),o=i.next();for(;!o.done;){var s=o.value;if(s.fromId===n&&r(t.get(s.toId),s))return!0;o=i.next()}}(i.links,e,n):function(e,n,r){var i=e.values(),o=i.next();for(;!o.done;){var s=o.value,a=s.fromId===n?s.toId:s.fromId;if(r(t.get(a),s))return!0;o=i.next()}}(i.links,e,n)},forEachLink:function(e){if("function"==typeof e)for(var t=n.values(),r=t.next();!r.done;){if(e(r.value))return!0;r=t.next()}},beginUpdate:p,endUpdate:m,clear:function(){p(),O((function(e){x(e.id)})),m()},hasLink:T,hasNode:_,getLink:T};return r(g),function(){var e=g.on;function t(){return g.beginUpdate=p=A,g.endUpdate=m=C,d=v,f=y,g.on=e,e.apply(g,arguments)}g.on=t}(),g;function v(e,t){h.push({link:e,changeType:t})}function y(e,t){h.push({node:e,changeType:t})}function b(e,n){if(void 0===e)throw new Error("Invalid node identifier");p();var r=_(e);return r?(r.data=n,f(r,"update")):(r=new i(e,n),f(r,"add")),t.set(e,r),m(),r}function _(e){return t.get(e)}function x(e){var n=_(e);if(!n)return!1;p();var r=n.links;return r&&(r.forEach(E),n.links=null),t.delete(e),f(n,"remove"),m(),!0}function w(){return t.size}function S(){return n.size}function E(e){if(!e)return!1;if(!n.get(e.id))return!1;p(),n.delete(e.id);var t=_(e.fromId),r=_(e.toId);return t&&t.links.delete(e),r&&r.links.delete(e),d(e,"remove"),m(),!0}function T(e,t){if(void 0!==e&&void 0!==t)return n.get(a(e,t))}function M(){}function A(){c+=1}function C(){0===(c-=1)&&h.length>0&&(g.fire("changed",h),h.length=0)}function O(e){if("function"!=typeof e)throw new Error("Function is expected to iterate over graph nodes. You passed "+e);for(var n=t.values(),r=n.next();!r.done;){if(e(r.value))return!0;r=n.next()}}};var r=n(73971);function i(e,t){this.id=e,this.links=null,this.data=t}function o(e,t){e.links?e.links.add(t):e.links=new Set([t])}function s(e,t,n,r){this.fromId=e,this.toId=t,this.data=n,this.id=r}function a(e,t){return e.toString()+"👉 "+t.toString()}},77876:function(e){e.exports=function e(t,n){var r;t||(t={});if(n)for(r in n)if(n.hasOwnProperty(r)){var i=t.hasOwnProperty(r),o=typeof n[r];!i||typeof t[r]!==o?t[r]=n[r]:"object"===o&&(t[r]=e(t[r],n[r]))}return t}},71951:function(e){function t(e){return new n("number"==typeof e?e:+new Date)}function n(e){this.seed=e}function r(e){return Math.sqrt(2*Math.PI/e)*Math.pow(1/Math.E*(e+1/(12*e-1/(10*e))),e)}function i(){var e=this.seed;return e=4294967295&(3042594569^(e=(e=4294967295&((e=(e=4294967295&(3345072700^(e=e+2127912214+(e<<12)&4294967295)^e>>>19))+374761393+(e<<5)&4294967295)+3550635116^e<<9))+4251993797+(e<<3)&4294967295)^e>>>16),this.seed=e,(268435455&e)/268435456}e.exports=t,e.exports.random=t,e.exports.randomIterator=function(e,n){var r=n||t();if("function"!=typeof r.next)throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:function(t){var n,i,o;for(n=e.length-1;n>0;--n)i=r.next(n+1),o=e[i],e[i]=e[n],e[n]=o,t(o);e.length&&t(e[0])},shuffle:function(){var t,n,i;for(t=e.length-1;t>0;--t)n=r.next(t+1),i=e[n],e[n]=e[t],e[t]=i;return e}}},n.prototype.next=function(e){return Math.floor(this.nextDouble()*e)},n.prototype.nextDouble=i,n.prototype.uniform=i,n.prototype.gaussian=function(){var e,t,n;do{e=(t=2*this.nextDouble()-1)*t+(n=2*this.nextDouble()-1)*n}while(e>=1||0===e);return t*Math.sqrt(-2*Math.log(e)/e)},n.prototype.levy=function(){var e=1.5,t=Math.pow(r(2.5)*Math.sin(Math.PI*e/2)/(r(1.25)*e*Math.pow(2,.25)),1/e);return this.gaussian()*t/Math.pow(Math.abs(this.gaussian()),1/e)}},54041:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.interval=t.iif=t.generate=t.fromEventPattern=t.fromEvent=t.from=t.forkJoin=t.empty=t.defer=t.connectable=t.concat=t.combineLatest=t.bindNodeCallback=t.bindCallback=t.UnsubscriptionError=t.TimeoutError=t.SequenceError=t.ObjectUnsubscribedError=t.NotFoundError=t.EmptyError=t.ArgumentOutOfRangeError=t.firstValueFrom=t.lastValueFrom=t.isObservable=t.identity=t.noop=t.pipe=t.NotificationKind=t.Notification=t.Subscriber=t.Subscription=t.Scheduler=t.VirtualAction=t.VirtualTimeScheduler=t.animationFrameScheduler=t.animationFrame=t.queueScheduler=t.queue=t.asyncScheduler=t.async=t.asapScheduler=t.asap=t.AsyncSubject=t.ReplaySubject=t.BehaviorSubject=t.Subject=t.animationFrames=t.observable=t.ConnectableObservable=t.Observable=void 0,t.filter=t.expand=t.exhaustMap=t.exhaustAll=t.exhaust=t.every=t.endWith=t.elementAt=t.distinctUntilKeyChanged=t.distinctUntilChanged=t.distinct=t.dematerialize=t.delayWhen=t.delay=t.defaultIfEmpty=t.debounceTime=t.debounce=t.count=t.connect=t.concatWith=t.concatMapTo=t.concatMap=t.concatAll=t.combineLatestWith=t.combineLatestAll=t.combineAll=t.catchError=t.bufferWhen=t.bufferToggle=t.bufferTime=t.bufferCount=t.buffer=t.auditTime=t.audit=t.config=t.NEVER=t.EMPTY=t.scheduled=t.zip=t.using=t.timer=t.throwError=t.range=t.race=t.partition=t.pairs=t.onErrorResumeNext=t.of=t.never=t.merge=void 0,t.switchMap=t.switchAll=t.subscribeOn=t.startWith=t.skipWhile=t.skipUntil=t.skipLast=t.skip=t.single=t.shareReplay=t.share=t.sequenceEqual=t.scan=t.sampleTime=t.sample=t.refCount=t.retryWhen=t.retry=t.repeatWhen=t.repeat=t.reduce=t.raceWith=t.publishReplay=t.publishLast=t.publishBehavior=t.publish=t.pluck=t.pairwise=t.onErrorResumeNextWith=t.observeOn=t.multicast=t.min=t.mergeWith=t.mergeScan=t.mergeMapTo=t.mergeMap=t.flatMap=t.mergeAll=t.max=t.materialize=t.mapTo=t.map=t.last=t.isEmpty=t.ignoreElements=t.groupBy=t.first=t.findIndex=t.find=t.finalize=void 0,t.zipWith=t.zipAll=t.withLatestFrom=t.windowWhen=t.windowToggle=t.windowTime=t.windowCount=t.window=t.toArray=t.timestamp=t.timeoutWith=t.timeout=t.timeInterval=t.throwIfEmpty=t.throttleTime=t.throttle=t.tap=t.takeWhile=t.takeUntil=t.takeLast=t.take=t.switchScan=t.switchMapTo=void 0;var o=n(44623);Object.defineProperty(t,"Observable",{enumerable:!0,get:function(){return o.Observable}});var s=n(51384);Object.defineProperty(t,"ConnectableObservable",{enumerable:!0,get:function(){return s.ConnectableObservable}});var a=n(70552);Object.defineProperty(t,"observable",{enumerable:!0,get:function(){return a.observable}});var u=n(81806);Object.defineProperty(t,"animationFrames",{enumerable:!0,get:function(){return u.animationFrames}});var c=n(28530);Object.defineProperty(t,"Subject",{enumerable:!0,get:function(){return c.Subject}});var l=n(37724);Object.defineProperty(t,"BehaviorSubject",{enumerable:!0,get:function(){return l.BehaviorSubject}});var h=n(11798);Object.defineProperty(t,"ReplaySubject",{enumerable:!0,get:function(){return h.ReplaySubject}});var d=n(32939);Object.defineProperty(t,"AsyncSubject",{enumerable:!0,get:function(){return d.AsyncSubject}});var f=n(2418);Object.defineProperty(t,"asap",{enumerable:!0,get:function(){return f.asap}}),Object.defineProperty(t,"asapScheduler",{enumerable:!0,get:function(){return f.asapScheduler}});var p=n(42342);Object.defineProperty(t,"async",{enumerable:!0,get:function(){return p.async}}),Object.defineProperty(t,"asyncScheduler",{enumerable:!0,get:function(){return p.asyncScheduler}});var m=n(19064);Object.defineProperty(t,"queue",{enumerable:!0,get:function(){return m.queue}}),Object.defineProperty(t,"queueScheduler",{enumerable:!0,get:function(){return m.queueScheduler}});var g=n(69503);Object.defineProperty(t,"animationFrame",{enumerable:!0,get:function(){return g.animationFrame}}),Object.defineProperty(t,"animationFrameScheduler",{enumerable:!0,get:function(){return g.animationFrameScheduler}});var v=n(87411);Object.defineProperty(t,"VirtualTimeScheduler",{enumerable:!0,get:function(){return v.VirtualTimeScheduler}}),Object.defineProperty(t,"VirtualAction",{enumerable:!0,get:function(){return v.VirtualAction}});var y=n(8786);Object.defineProperty(t,"Scheduler",{enumerable:!0,get:function(){return y.Scheduler}});var b=n(62032);Object.defineProperty(t,"Subscription",{enumerable:!0,get:function(){return b.Subscription}});var _=n(654);Object.defineProperty(t,"Subscriber",{enumerable:!0,get:function(){return _.Subscriber}});var x=n(65193);Object.defineProperty(t,"Notification",{enumerable:!0,get:function(){return x.Notification}}),Object.defineProperty(t,"NotificationKind",{enumerable:!0,get:function(){return x.NotificationKind}});var w=n(52294);Object.defineProperty(t,"pipe",{enumerable:!0,get:function(){return w.pipe}});var S=n(96008);Object.defineProperty(t,"noop",{enumerable:!0,get:function(){return S.noop}});var E=n(79546);Object.defineProperty(t,"identity",{enumerable:!0,get:function(){return E.identity}});var T=n(56275);Object.defineProperty(t,"isObservable",{enumerable:!0,get:function(){return T.isObservable}});var M=n(31821);Object.defineProperty(t,"lastValueFrom",{enumerable:!0,get:function(){return M.lastValueFrom}});var A=n(1653);Object.defineProperty(t,"firstValueFrom",{enumerable:!0,get:function(){return A.firstValueFrom}});var C=n(31507);Object.defineProperty(t,"ArgumentOutOfRangeError",{enumerable:!0,get:function(){return C.ArgumentOutOfRangeError}});var O=n(10683);Object.defineProperty(t,"EmptyError",{enumerable:!0,get:function(){return O.EmptyError}});var P=n(63240);Object.defineProperty(t,"NotFoundError",{enumerable:!0,get:function(){return P.NotFoundError}});var R=n(87237);Object.defineProperty(t,"ObjectUnsubscribedError",{enumerable:!0,get:function(){return R.ObjectUnsubscribedError}});var N=n(50868);Object.defineProperty(t,"SequenceError",{enumerable:!0,get:function(){return N.SequenceError}});var I=n(13458);Object.defineProperty(t,"TimeoutError",{enumerable:!0,get:function(){return I.TimeoutError}});var k=n(33205);Object.defineProperty(t,"UnsubscriptionError",{enumerable:!0,get:function(){return k.UnsubscriptionError}});var D=n(2892);Object.defineProperty(t,"bindCallback",{enumerable:!0,get:function(){return D.bindCallback}});var L=n(2919);Object.defineProperty(t,"bindNodeCallback",{enumerable:!0,get:function(){return L.bindNodeCallback}});var U=n(73224);Object.defineProperty(t,"combineLatest",{enumerable:!0,get:function(){return U.combineLatest}});var F=n(55758);Object.defineProperty(t,"concat",{enumerable:!0,get:function(){return F.concat}});var B=n(32927);Object.defineProperty(t,"connectable",{enumerable:!0,get:function(){return B.connectable}});var z=n(88393);Object.defineProperty(t,"defer",{enumerable:!0,get:function(){return z.defer}});var j=n(68511);Object.defineProperty(t,"empty",{enumerable:!0,get:function(){return j.empty}});var V=n(81436);Object.defineProperty(t,"forkJoin",{enumerable:!0,get:function(){return V.forkJoin}});var G=n(6609);Object.defineProperty(t,"from",{enumerable:!0,get:function(){return G.from}});var H=n(23297);Object.defineProperty(t,"fromEvent",{enumerable:!0,get:function(){return H.fromEvent}});var W=n(66508);Object.defineProperty(t,"fromEventPattern",{enumerable:!0,get:function(){return W.fromEventPattern}});var q=n(8894);Object.defineProperty(t,"generate",{enumerable:!0,get:function(){return q.generate}});var X=n(49177);Object.defineProperty(t,"iif",{enumerable:!0,get:function(){return X.iif}});var Z=n(58892);Object.defineProperty(t,"interval",{enumerable:!0,get:function(){return Z.interval}});var $=n(13889);Object.defineProperty(t,"merge",{enumerable:!0,get:function(){return $.merge}});var Y=n(64968);Object.defineProperty(t,"never",{enumerable:!0,get:function(){return Y.never}});var K=n(29268);Object.defineProperty(t,"of",{enumerable:!0,get:function(){return K.of}});var Q=n(25857);Object.defineProperty(t,"onErrorResumeNext",{enumerable:!0,get:function(){return Q.onErrorResumeNext}});var J=n(13214);Object.defineProperty(t,"pairs",{enumerable:!0,get:function(){return J.pairs}});var ee=n(50867);Object.defineProperty(t,"partition",{enumerable:!0,get:function(){return ee.partition}});var te=n(41572);Object.defineProperty(t,"race",{enumerable:!0,get:function(){return te.race}});var ne=n(37265);Object.defineProperty(t,"range",{enumerable:!0,get:function(){return ne.range}});var re=n(23685);Object.defineProperty(t,"throwError",{enumerable:!0,get:function(){return re.throwError}});var ie=n(30885);Object.defineProperty(t,"timer",{enumerable:!0,get:function(){return ie.timer}});var oe=n(79342);Object.defineProperty(t,"using",{enumerable:!0,get:function(){return oe.using}});var se=n(30888);Object.defineProperty(t,"zip",{enumerable:!0,get:function(){return se.zip}});var ae=n(54363);Object.defineProperty(t,"scheduled",{enumerable:!0,get:function(){return ae.scheduled}});var ue=n(68511);Object.defineProperty(t,"EMPTY",{enumerable:!0,get:function(){return ue.EMPTY}});var ce=n(64968);Object.defineProperty(t,"NEVER",{enumerable:!0,get:function(){return ce.NEVER}}),i(n(56310),t);var le=n(15656);Object.defineProperty(t,"config",{enumerable:!0,get:function(){return le.config}});var he=n(49395);Object.defineProperty(t,"audit",{enumerable:!0,get:function(){return he.audit}});var de=n(97380);Object.defineProperty(t,"auditTime",{enumerable:!0,get:function(){return de.auditTime}});var fe=n(60366);Object.defineProperty(t,"buffer",{enumerable:!0,get:function(){return fe.buffer}});var pe=n(72847);Object.defineProperty(t,"bufferCount",{enumerable:!0,get:function(){return pe.bufferCount}});var me=n(7914);Object.defineProperty(t,"bufferTime",{enumerable:!0,get:function(){return me.bufferTime}});var ge=n(99347);Object.defineProperty(t,"bufferToggle",{enumerable:!0,get:function(){return ge.bufferToggle}});var ve=n(9901);Object.defineProperty(t,"bufferWhen",{enumerable:!0,get:function(){return ve.bufferWhen}});var ye=n(26324);Object.defineProperty(t,"catchError",{enumerable:!0,get:function(){return ye.catchError}});var be=n(46564);Object.defineProperty(t,"combineAll",{enumerable:!0,get:function(){return be.combineAll}});var _e=n(60681);Object.defineProperty(t,"combineLatestAll",{enumerable:!0,get:function(){return _e.combineLatestAll}});var xe=n(16014);Object.defineProperty(t,"combineLatestWith",{enumerable:!0,get:function(){return xe.combineLatestWith}});var we=n(89371);Object.defineProperty(t,"concatAll",{enumerable:!0,get:function(){return we.concatAll}});var Se=n(20929);Object.defineProperty(t,"concatMap",{enumerable:!0,get:function(){return Se.concatMap}});var Ee=n(1394);Object.defineProperty(t,"concatMapTo",{enumerable:!0,get:function(){return Ee.concatMapTo}});var Te=n(7695);Object.defineProperty(t,"concatWith",{enumerable:!0,get:function(){return Te.concatWith}});var Me=n(82602);Object.defineProperty(t,"connect",{enumerable:!0,get:function(){return Me.connect}});var Ae=n(31727);Object.defineProperty(t,"count",{enumerable:!0,get:function(){return Ae.count}});var Ce=n(3475);Object.defineProperty(t,"debounce",{enumerable:!0,get:function(){return Ce.debounce}});var Oe=n(97146);Object.defineProperty(t,"debounceTime",{enumerable:!0,get:function(){return Oe.debounceTime}});var Pe=n(23931);Object.defineProperty(t,"defaultIfEmpty",{enumerable:!0,get:function(){return Pe.defaultIfEmpty}});var Re=n(7165);Object.defineProperty(t,"delay",{enumerable:!0,get:function(){return Re.delay}});var Ne=n(14002);Object.defineProperty(t,"delayWhen",{enumerable:!0,get:function(){return Ne.delayWhen}});var Ie=n(85760);Object.defineProperty(t,"dematerialize",{enumerable:!0,get:function(){return Ie.dematerialize}});var ke=n(78160);Object.defineProperty(t,"distinct",{enumerable:!0,get:function(){return ke.distinct}});var De=n(9280);Object.defineProperty(t,"distinctUntilChanged",{enumerable:!0,get:function(){return De.distinctUntilChanged}});var Le=n(85358);Object.defineProperty(t,"distinctUntilKeyChanged",{enumerable:!0,get:function(){return Le.distinctUntilKeyChanged}});var Ue=n(76542);Object.defineProperty(t,"elementAt",{enumerable:!0,get:function(){return Ue.elementAt}});var Fe=n(41537);Object.defineProperty(t,"endWith",{enumerable:!0,get:function(){return Fe.endWith}});var Be=n(94971);Object.defineProperty(t,"every",{enumerable:!0,get:function(){return Be.every}});var ze=n(66375);Object.defineProperty(t,"exhaust",{enumerable:!0,get:function(){return ze.exhaust}});var je=n(17807);Object.defineProperty(t,"exhaustAll",{enumerable:!0,get:function(){return je.exhaustAll}});var Ve=n(52339);Object.defineProperty(t,"exhaustMap",{enumerable:!0,get:function(){return Ve.exhaustMap}});var Ge=n(94162);Object.defineProperty(t,"expand",{enumerable:!0,get:function(){return Ge.expand}});var He=n(36870);Object.defineProperty(t,"filter",{enumerable:!0,get:function(){return He.filter}});var We=n(36011);Object.defineProperty(t,"finalize",{enumerable:!0,get:function(){return We.finalize}});var qe=n(45575);Object.defineProperty(t,"find",{enumerable:!0,get:function(){return qe.find}});var Xe=n(9031);Object.defineProperty(t,"findIndex",{enumerable:!0,get:function(){return Xe.findIndex}});var Ze=n(93133);Object.defineProperty(t,"first",{enumerable:!0,get:function(){return Ze.first}});var $e=n(14307);Object.defineProperty(t,"groupBy",{enumerable:!0,get:function(){return $e.groupBy}});var Ye=n(82746);Object.defineProperty(t,"ignoreElements",{enumerable:!0,get:function(){return Ye.ignoreElements}});var Ke=n(39470);Object.defineProperty(t,"isEmpty",{enumerable:!0,get:function(){return Ke.isEmpty}});var Qe=n(17424);Object.defineProperty(t,"last",{enumerable:!0,get:function(){return Qe.last}});var Je=n(74633);Object.defineProperty(t,"map",{enumerable:!0,get:function(){return Je.map}});var et=n(61482);Object.defineProperty(t,"mapTo",{enumerable:!0,get:function(){return et.mapTo}});var tt=n(14335);Object.defineProperty(t,"materialize",{enumerable:!0,get:function(){return tt.materialize}});var nt=n(34792);Object.defineProperty(t,"max",{enumerable:!0,get:function(){return nt.max}});var rt=n(86960);Object.defineProperty(t,"mergeAll",{enumerable:!0,get:function(){return rt.mergeAll}});var it=n(60878);Object.defineProperty(t,"flatMap",{enumerable:!0,get:function(){return it.flatMap}});var ot=n(84096);Object.defineProperty(t,"mergeMap",{enumerable:!0,get:function(){return ot.mergeMap}});var st=n(18611);Object.defineProperty(t,"mergeMapTo",{enumerable:!0,get:function(){return st.mergeMapTo}});var at=n(19259);Object.defineProperty(t,"mergeScan",{enumerable:!0,get:function(){return at.mergeScan}});var ut=n(61353);Object.defineProperty(t,"mergeWith",{enumerable:!0,get:function(){return ut.mergeWith}});var ct=n(33807);Object.defineProperty(t,"min",{enumerable:!0,get:function(){return ct.min}});var lt=n(5912);Object.defineProperty(t,"multicast",{enumerable:!0,get:function(){return lt.multicast}});var ht=n(8987);Object.defineProperty(t,"observeOn",{enumerable:!0,get:function(){return ht.observeOn}});var dt=n(20555);Object.defineProperty(t,"onErrorResumeNextWith",{enumerable:!0,get:function(){return dt.onErrorResumeNextWith}});var ft=n(66821);Object.defineProperty(t,"pairwise",{enumerable:!0,get:function(){return ft.pairwise}});var pt=n(70339);Object.defineProperty(t,"pluck",{enumerable:!0,get:function(){return pt.pluck}});var mt=n(22448);Object.defineProperty(t,"publish",{enumerable:!0,get:function(){return mt.publish}});var gt=n(6306);Object.defineProperty(t,"publishBehavior",{enumerable:!0,get:function(){return gt.publishBehavior}});var vt=n(7161);Object.defineProperty(t,"publishLast",{enumerable:!0,get:function(){return vt.publishLast}});var yt=n(25962);Object.defineProperty(t,"publishReplay",{enumerable:!0,get:function(){return yt.publishReplay}});var bt=n(95391);Object.defineProperty(t,"raceWith",{enumerable:!0,get:function(){return bt.raceWith}});var _t=n(59425);Object.defineProperty(t,"reduce",{enumerable:!0,get:function(){return _t.reduce}});var xt=n(71220);Object.defineProperty(t,"repeat",{enumerable:!0,get:function(){return xt.repeat}});var wt=n(42948);Object.defineProperty(t,"repeatWhen",{enumerable:!0,get:function(){return wt.repeatWhen}});var St=n(24590);Object.defineProperty(t,"retry",{enumerable:!0,get:function(){return St.retry}});var Et=n(91213);Object.defineProperty(t,"retryWhen",{enumerable:!0,get:function(){return Et.retryWhen}});var Tt=n(56802);Object.defineProperty(t,"refCount",{enumerable:!0,get:function(){return Tt.refCount}});var Mt=n(25152);Object.defineProperty(t,"sample",{enumerable:!0,get:function(){return Mt.sample}});var At=n(66695);Object.defineProperty(t,"sampleTime",{enumerable:!0,get:function(){return At.sampleTime}});var Ct=n(99568);Object.defineProperty(t,"scan",{enumerable:!0,get:function(){return Ct.scan}});var Ot=n(30400);Object.defineProperty(t,"sequenceEqual",{enumerable:!0,get:function(){return Ot.sequenceEqual}});var Pt=n(67864);Object.defineProperty(t,"share",{enumerable:!0,get:function(){return Pt.share}});var Rt=n(84487);Object.defineProperty(t,"shareReplay",{enumerable:!0,get:function(){return Rt.shareReplay}});var Nt=n(28448);Object.defineProperty(t,"single",{enumerable:!0,get:function(){return Nt.single}});var It=n(96812);Object.defineProperty(t,"skip",{enumerable:!0,get:function(){return It.skip}});var kt=n(89115);Object.defineProperty(t,"skipLast",{enumerable:!0,get:function(){return kt.skipLast}});var Dt=n(56892);Object.defineProperty(t,"skipUntil",{enumerable:!0,get:function(){return Dt.skipUntil}});var Lt=n(34958);Object.defineProperty(t,"skipWhile",{enumerable:!0,get:function(){return Lt.skipWhile}});var Ut=n(3793);Object.defineProperty(t,"startWith",{enumerable:!0,get:function(){return Ut.startWith}});var Ft=n(45189);Object.defineProperty(t,"subscribeOn",{enumerable:!0,get:function(){return Ft.subscribeOn}});var Bt=n(12390);Object.defineProperty(t,"switchAll",{enumerable:!0,get:function(){return Bt.switchAll}});var zt=n(70511);Object.defineProperty(t,"switchMap",{enumerable:!0,get:function(){return zt.switchMap}});var jt=n(22723);Object.defineProperty(t,"switchMapTo",{enumerable:!0,get:function(){return jt.switchMapTo}});var Vt=n(98897);Object.defineProperty(t,"switchScan",{enumerable:!0,get:function(){return Vt.switchScan}});var Gt=n(23133);Object.defineProperty(t,"take",{enumerable:!0,get:function(){return Gt.take}});var Ht=n(36771);Object.defineProperty(t,"takeLast",{enumerable:!0,get:function(){return Ht.takeLast}});var Wt=n(38515);Object.defineProperty(t,"takeUntil",{enumerable:!0,get:function(){return Wt.takeUntil}});var qt=n(5471);Object.defineProperty(t,"takeWhile",{enumerable:!0,get:function(){return qt.takeWhile}});var Xt=n(83562);Object.defineProperty(t,"tap",{enumerable:!0,get:function(){return Xt.tap}});var Zt=n(11056);Object.defineProperty(t,"throttle",{enumerable:!0,get:function(){return Zt.throttle}});var $t=n(87981);Object.defineProperty(t,"throttleTime",{enumerable:!0,get:function(){return $t.throttleTime}});var Yt=n(79784);Object.defineProperty(t,"throwIfEmpty",{enumerable:!0,get:function(){return Yt.throwIfEmpty}});var Kt=n(47312);Object.defineProperty(t,"timeInterval",{enumerable:!0,get:function(){return Kt.timeInterval}});var Qt=n(13458);Object.defineProperty(t,"timeout",{enumerable:!0,get:function(){return Qt.timeout}});var Jt=n(82416);Object.defineProperty(t,"timeoutWith",{enumerable:!0,get:function(){return Jt.timeoutWith}});var en=n(68098);Object.defineProperty(t,"timestamp",{enumerable:!0,get:function(){return en.timestamp}});var tn=n(22666);Object.defineProperty(t,"toArray",{enumerable:!0,get:function(){return tn.toArray}});var nn=n(69227);Object.defineProperty(t,"window",{enumerable:!0,get:function(){return nn.window}});var rn=n(64805);Object.defineProperty(t,"windowCount",{enumerable:!0,get:function(){return rn.windowCount}});var on=n(44487);Object.defineProperty(t,"windowTime",{enumerable:!0,get:function(){return on.windowTime}});var sn=n(45891);Object.defineProperty(t,"windowToggle",{enumerable:!0,get:function(){return sn.windowToggle}});var an=n(78105);Object.defineProperty(t,"windowWhen",{enumerable:!0,get:function(){return an.windowWhen}});var un=n(93978);Object.defineProperty(t,"withLatestFrom",{enumerable:!0,get:function(){return un.withLatestFrom}});var cn=n(83380);Object.defineProperty(t,"zipAll",{enumerable:!0,get:function(){return cn.zipAll}});var ln=n(38815);Object.defineProperty(t,"zipWith",{enumerable:!0,get:function(){return ln.zipWith}})},32939:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncSubject=void 0;var o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._value=null,t._hasValue=!1,t._isComplete=!1,t}return i(t,e),t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t._hasValue,i=t._value,o=t.thrownError,s=t.isStopped,a=t._isComplete;n?e.error(o):(s||a)&&(r&&e.next(i),e.complete())},t.prototype.next=function(e){this.isStopped||(this._value=e,this._hasValue=!0)},t.prototype.complete=function(){var t=this,n=t._hasValue,r=t._value;t._isComplete||(this._isComplete=!0,n&&e.prototype.next.call(this,r),e.prototype.complete.call(this))},t}(n(28530).Subject);t.AsyncSubject=o},37724:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.BehaviorSubject=void 0;var o=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return i(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,r=e._value;if(t)throw n;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(n(28530).Subject);t.BehaviorSubject=o},65193:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.observeNotification=t.Notification=t.NotificationKind=void 0;var r=n(68511),i=n(29268),o=n(23685),s=n(23795);!function(e){e.NEXT="N",e.ERROR="E",e.COMPLETE="C"}(t.NotificationKind||(t.NotificationKind={}));var a=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){return u(this,e)},e.prototype.do=function(e,t,n){var r=this,i=r.kind,o=r.value,s=r.error;return"N"===i?null==e?void 0:e(o):"E"===i?null==t?void 0:t(s):null==n?void 0:n()},e.prototype.accept=function(e,t,n){var r;return s.isFunction(null===(r=e)||void 0===r?void 0:r.next)?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){var e=this,t=e.kind,n=e.value,s=e.error,a="N"===t?i.of(n):"E"===t?o.throwError((function(){return s})):"C"===t?r.EMPTY:0;if(!a)throw new TypeError("Unexpected notification kind "+t);return a},e.createNext=function(t){return new e("N",t)},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e}();function u(e,t){var n,r,i,o=e,s=o.kind,a=o.value,u=o.error;if("string"!=typeof s)throw new TypeError('Invalid notification, missing "kind"');"N"===s?null===(n=t.next)||void 0===n||n.call(t,a):"E"===s?null===(r=t.error)||void 0===r||r.call(t,u):null===(i=t.complete)||void 0===i||i.call(t)}t.Notification=a,t.observeNotification=u},14555:function(e,t){"use strict";function n(e,t,n){return{kind:e,value:t,error:n}}Object.defineProperty(t,"__esModule",{value:!0}),t.createNotification=t.nextNotification=t.errorNotification=t.COMPLETE_NOTIFICATION=void 0,t.COMPLETE_NOTIFICATION=n("C",void 0,void 0),t.errorNotification=function(e){return n("E",void 0,e)},t.nextNotification=function(e){return n("N",e,void 0)},t.createNotification=n},44623:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Observable=void 0;var r=n(654),i=n(62032),o=n(70552),s=n(52294),a=n(15656),u=n(23795),c=n(22766),l=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var o,s=this,a=(o=e)&&o instanceof r.Subscriber||function(e){return e&&u.isFunction(e.next)&&u.isFunction(e.error)&&u.isFunction(e.complete)}(o)&&i.isSubscription(o)?e:new r.SafeSubscriber(e,t,n);return c.errorContext((function(){var e=s,t=e.operator,n=e.source;a.add(t?t.call(a,n):n?s._subscribe(a):s._trySubscribe(a))})),a},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=h(t))((function(t,i){var o=new r.SafeSubscriber({next:function(t){try{e(t)}catch(e){i(e),o.unsubscribe()}},error:i,complete:t});n.subscribe(o)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[o.observable]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.pipeFromArray(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=h(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function h(e){var t;return null!==(t=null!=e?e:a.config.Promise)&&void 0!==t?t:Promise}t.Observable=l},11798:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ReplaySubject=void 0;var o=n(28530),s=n(57762),a=function(e){function t(t,n,r){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===r&&(r=s.dateTimestampProvider);var i=e.call(this)||this;return i._bufferSize=t,i._windowTime=n,i._timestampProvider=r,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=n===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,n),i}return i(t,e),t.prototype.next=function(t){var n=this,r=n.isStopped,i=n._buffer,o=n._infiniteTimeWindow,s=n._timestampProvider,a=n._windowTime;r||(i.push(t),!o&&i.push(s.now()+a)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,r=e._buffer,i=e._infiniteTimeWindow,o=(i?1:2)*t;if(t<1/0&&o<r.length&&r.splice(0,r.length-o),!i){for(var s=n.now(),a=0,u=1;u<r.length&&r[u]<=s;u+=2)a=u;a&&r.splice(0,a+1)}},t}(o.Subject);t.ReplaySubject=a},8786:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Scheduler=void 0;var r=n(57762),i=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=r.dateTimestampProvider.now,e}();t.Scheduler=i},28530:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.AnonymousSubject=t.Subject=void 0;var s=n(44623),a=n(62032),u=n(87237),c=n(51458),l=n(22766),h=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return i(t,e),t.prototype.lift=function(e){var t=new d(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new u.ObjectUnsubscribedError},t.prototype.next=function(e){var t=this;l.errorContext((function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=o(t.currentObservers),s=i.next();!s.done;s=i.next()){s.value.next(e)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;l.errorContext((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;l.errorContext((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,i=n.isStopped,o=n.observers;return r||i?a.EMPTY_SUBSCRIPTION:(this.currentObservers=null,o.push(e),new a.Subscription((function(){t.currentObservers=null,c.arrRemove(o,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,i=t.isStopped;n?e.error(r):i&&e.complete()},t.prototype.asObservable=function(){var e=new s.Observable;return e.source=this,e},t.create=function(e,t){return new d(e,t)},t}(s.Observable);t.Subject=h;var d=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return i(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:a.EMPTY_SUBSCRIPTION},t}(h);t.AnonymousSubject=d},654:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY_OBSERVER=t.SafeSubscriber=t.Subscriber=void 0;var o=n(23795),s=n(62032),a=n(15656),u=n(3423),c=n(96008),l=n(14555),h=n(69985),d=n(22766),f=function(e){function n(n){var r=e.call(this)||this;return r.isStopped=!1,n?(r.destination=n,s.isSubscription(n)&&n.add(r)):r.destination=t.EMPTY_OBSERVER,r}return i(n,e),n.create=function(e,t,n){return new v(e,t,n)},n.prototype.next=function(e){this.isStopped?b(l.nextNotification(e),this):this._next(e)},n.prototype.error=function(e){this.isStopped?b(l.errorNotification(e),this):(this.isStopped=!0,this._error(e))},n.prototype.complete=function(){this.isStopped?b(l.COMPLETE_NOTIFICATION,this):(this.isStopped=!0,this._complete())},n.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},n.prototype._next=function(e){this.destination.next(e)},n.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},n.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},n}(s.Subscription);t.Subscriber=f;var p=Function.prototype.bind;function m(e,t){return p.call(e,t)}var g=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){y(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){y(e)}else y(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){y(e)}},e}(),v=function(e){function t(t,n,r){var i,s,u=e.call(this)||this;o.isFunction(t)||!t?i={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:u&&a.config.useDeprecatedNextContext?((s=Object.create(t)).unsubscribe=function(){return u.unsubscribe()},i={next:t.next&&m(t.next,s),error:t.error&&m(t.error,s),complete:t.complete&&m(t.complete,s)}):i=t;return u.destination=new g(i),u}return i(t,e),t}(f);function y(e){a.config.useDeprecatedSynchronousErrorHandling?d.captureError(e):u.reportUnhandledError(e)}function b(e,t){var n=a.config.onStoppedNotification;n&&h.timeoutProvider.setTimeout((function(){return n(e,t)}))}t.SafeSubscriber=v,t.EMPTY_OBSERVER={closed:!0,next:c.noop,error:function(e){throw e},complete:c.noop}},62032:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},o=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.isSubscription=t.EMPTY_SUBSCRIPTION=t.Subscription=void 0;var s=n(23795),a=n(33205),u=n(51458),c=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,u,c;if(!this.closed){this.closed=!0;var h=this._parentage;if(h)if(this._parentage=null,Array.isArray(h))try{for(var d=r(h),f=d.next();!f.done;f=d.next()){f.value.remove(this)}}catch(t){e={error:t}}finally{try{f&&!f.done&&(t=d.return)&&t.call(d)}finally{if(e)throw e.error}}else h.remove(this);var p=this.initialTeardown;if(s.isFunction(p))try{p()}catch(e){c=e instanceof a.UnsubscriptionError?e.errors:[e]}var m=this._finalizers;if(m){this._finalizers=null;try{for(var g=r(m),v=g.next();!v.done;v=g.next()){var y=v.value;try{l(y)}catch(e){c=null!=c?c:[],e instanceof a.UnsubscriptionError?c=o(o([],i(c)),i(e.errors)):c.push(e)}}}catch(e){n={error:e}}finally{try{v&&!v.done&&(u=g.return)&&u.call(g)}finally{if(n)throw n.error}}}if(c)throw new a.UnsubscriptionError(c)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)l(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&u.arrRemove(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&u.arrRemove(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function l(e){s.isFunction(e)?e():e.unsubscribe()}t.Subscription=c,t.EMPTY_SUBSCRIPTION=c.EMPTY,t.isSubscription=function(e){return e instanceof c||e&&"closed"in e&&s.isFunction(e.remove)&&s.isFunction(e.add)&&s.isFunction(e.unsubscribe)}},15656:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0,t.config={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},1653:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.firstValueFrom=void 0;var r=n(10683),i=n(654);t.firstValueFrom=function(e,t){var n="object"==typeof t;return new Promise((function(o,s){var a=new i.SafeSubscriber({next:function(e){o(e),a.unsubscribe()},error:s,complete:function(){n?o(t.defaultValue):s(new r.EmptyError)}});e.subscribe(a)}))}},31821:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lastValueFrom=void 0;var r=n(10683);t.lastValueFrom=function(e,t){var n="object"==typeof t;return new Promise((function(i,o){var s,a=!1;e.subscribe({next:function(e){s=e,a=!0},error:o,complete:function(){a?i(s):n?i(t.defaultValue):o(new r.EmptyError)}})}))}},51384:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectableObservable=void 0;var o=n(44623),s=n(62032),a=n(56802),u=n(96603),c=n(80215),l=function(e){function t(t,n){var r=e.call(this)||this;return r.source=t,r.subjectFactory=n,r._subject=null,r._refCount=0,r._connection=null,c.hasLift(t)&&(r.lift=t.lift),r}return i(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype._teardown=function(){this._refCount=0;var e=this._connection;this._subject=this._connection=null,null==e||e.unsubscribe()},t.prototype.connect=function(){var e=this,t=this._connection;if(!t){t=this._connection=new s.Subscription;var n=this.getSubject();t.add(this.source.subscribe(u.createOperatorSubscriber(n,void 0,(function(){e._teardown(),n.complete()}),(function(t){e._teardown(),n.error(t)}),(function(){return e._teardown()})))),t.closed&&(this._connection=null,t=s.Subscription.EMPTY)}return t},t.prototype.refCount=function(){return a.refCount()(this)},t}(o.Observable);t.ConnectableObservable=l},2892:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bindCallback=void 0;var r=n(8);t.bindCallback=function(e,t,n){return r.bindCallbackInternals(!1,e,t,n)}},8:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.bindCallbackInternals=void 0;var o=n(50387),s=n(44623),a=n(45189),u=n(62571),c=n(8987),l=n(32939);t.bindCallbackInternals=function e(t,n,h,d){if(h){if(!o.isScheduler(h))return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return e(t,n,d).apply(this,r).pipe(u.mapOneOrManyArgs(h))};d=h}return d?function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return e(t,n).apply(this,r).pipe(a.subscribeOn(d),c.observeOn(d))}:function(){for(var e=this,o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];var u=new l.AsyncSubject,c=!0;return new s.Observable((function(s){var a=u.subscribe(s);if(c){c=!1;var l=!1,h=!1;n.apply(e,i(i([],r(o)),[function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(t){var r=e.shift();if(null!=r)return void u.error(r)}u.next(1<e.length?e:e[0]),h=!0,l&&u.complete()}])),h&&u.complete(),l=!0}return a}))}}},2919:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bindNodeCallback=void 0;var r=n(8);t.bindNodeCallback=function(e,t,n){return r.bindCallbackInternals(!0,e,t,n)}},73224:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combineLatestInit=t.combineLatest=void 0;var r=n(44623),i=n(91117),o=n(6609),s=n(79546),a=n(62571),u=n(59342),c=n(58405),l=n(96603),h=n(45752);function d(e,t,n){return void 0===n&&(n=s.identity),function(r){f(t,(function(){for(var i=e.length,s=new Array(i),a=i,u=i,c=function(i){f(t,(function(){var c=o.from(e[i],t),h=!1;c.subscribe(l.createOperatorSubscriber(r,(function(e){s[i]=e,h||(h=!0,u--),u||r.next(n(s.slice()))}),(function(){--a||r.complete()})))}),r)},h=0;h<i;h++)c(h)}),r)}}function f(e,t,n){e?h.executeSchedule(n,e,t):t()}t.combineLatest=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=u.popScheduler(e),l=u.popResultSelector(e),h=i.argsArgArrayOrObject(e),f=h.args,p=h.keys;if(0===f.length)return o.from([],n);var m=new r.Observable(d(f,n,p?function(e){return c.createObject(p,e)}:s.identity));return l?m.pipe(a.mapOneOrManyArgs(l)):m},t.combineLatestInit=d},55758:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concat=void 0;var r=n(89371),i=n(59342),o=n(6609);t.concat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.concatAll()(o.from(e,i.popScheduler(e)))}},32927:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.connectable=void 0;var r=n(28530),i=n(44623),o=n(88393),s={connector:function(){return new r.Subject},resetOnDisconnect:!0};t.connectable=function(e,t){void 0===t&&(t=s);var n=null,r=t.connector,a=t.resetOnDisconnect,u=void 0===a||a,c=r(),l=new i.Observable((function(e){return c.subscribe(e)}));return l.connect=function(){return n&&!n.closed||(n=o.defer((function(){return e})).subscribe(c),u&&n.add((function(){return c=r()}))),n},l}},88393:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defer=void 0;var r=n(44623),i=n(88415);t.defer=function(e){return new r.Observable((function(t){i.innerFrom(e()).subscribe(t)}))}},81806:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.animationFrames=void 0;var r=n(44623),i=n(54858),o=n(63305);function s(e){return new r.Observable((function(t){var n=e||i.performanceTimestampProvider,r=n.now(),s=0,a=function(){t.closed||(s=o.animationFrameProvider.requestAnimationFrame((function(i){s=0;var o=n.now();t.next({timestamp:e?o:i,elapsed:o-r}),a()})))};return a(),function(){s&&o.animationFrameProvider.cancelAnimationFrame(s)}}))}t.animationFrames=function(e){return e?s(e):a};var a=s()},68511:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.empty=t.EMPTY=void 0;var r=n(44623);t.EMPTY=new r.Observable((function(e){return e.complete()})),t.empty=function(e){return e?function(e){return new r.Observable((function(t){return e.schedule((function(){return t.complete()}))}))}(e):t.EMPTY}},81436:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forkJoin=void 0;var r=n(44623),i=n(91117),o=n(88415),s=n(59342),a=n(96603),u=n(62571),c=n(58405);t.forkJoin=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=s.popResultSelector(e),l=i.argsArgArrayOrObject(e),h=l.args,d=l.keys,f=new r.Observable((function(e){var t=h.length;if(t)for(var n=new Array(t),r=t,i=t,s=function(t){var s=!1;o.innerFrom(h[t]).subscribe(a.createOperatorSubscriber(e,(function(e){s||(s=!0,i--),n[t]=e}),(function(){return r--}),void 0,(function(){r&&s||(i||e.next(d?c.createObject(d,n):n),e.complete())})))},u=0;u<t;u++)s(u);else e.complete()}));return n?f.pipe(u.mapOneOrManyArgs(n)):f}},6609:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.from=void 0;var r=n(54363),i=n(88415);t.from=function(e,t){return t?r.scheduled(e,t):i.innerFrom(e)}},23297:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s};Object.defineProperty(t,"__esModule",{value:!0}),t.fromEvent=void 0;var i=n(88415),o=n(44623),s=n(84096),a=n(61329),u=n(23795),c=n(62571),l=["addListener","removeListener"],h=["addEventListener","removeEventListener"],d=["on","off"];function f(e,t){return function(n){return function(r){return e[n](t,r)}}}t.fromEvent=function e(t,n,p,m){if(u.isFunction(p)&&(m=p,p=void 0),m)return e(t,n,p).pipe(c.mapOneOrManyArgs(m));var g=r(function(e){return u.isFunction(e.addEventListener)&&u.isFunction(e.removeEventListener)}(t)?h.map((function(e){return function(r){return t[e](n,r,p)}})):function(e){return u.isFunction(e.addListener)&&u.isFunction(e.removeListener)}(t)?l.map(f(t,n)):function(e){return u.isFunction(e.on)&&u.isFunction(e.off)}(t)?d.map(f(t,n)):[],2),v=g[0],y=g[1];if(!v&&a.isArrayLike(t))return s.mergeMap((function(t){return e(t,n,p)}))(i.innerFrom(t));if(!v)throw new TypeError("Invalid event target");return new o.Observable((function(e){var t=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.next(1<t.length?t:t[0])};return v(t),function(){return y(t)}}))}},66508:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromEventPattern=void 0;var r=n(44623),i=n(23795),o=n(62571);t.fromEventPattern=function e(t,n,s){return s?e(t,n).pipe(o.mapOneOrManyArgs(s)):new r.Observable((function(e){var r=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.next(1===t.length?t[0]:t)},o=t(r);return i.isFunction(n)?function(){return n(r,o)}:void 0}))}},93863:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromSubscribable=void 0;var r=n(44623);t.fromSubscribable=function(e){return new r.Observable((function(t){return e.subscribe(t)}))}},8894:function(e,t,n){"use strict";var r=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.generate=void 0;var i=n(79546),o=n(50387),s=n(88393),a=n(31463);t.generate=function(e,t,n,u,c){var l,h,d,f;function p(){var e;return r(this,(function(r){switch(r.label){case 0:e=f,r.label=1;case 1:return t&&!t(e)?[3,4]:[4,d(e)];case 2:r.sent(),r.label=3;case 3:return e=n(e),[3,1];case 4:return[2]}}))}return 1===arguments.length?(f=(l=e).initialState,t=l.condition,n=l.iterate,h=l.resultSelector,d=void 0===h?i.identity:h,c=l.scheduler):(f=e,!u||o.isScheduler(u)?(d=i.identity,c=u):d=u),s.defer(c?function(){return a.scheduleIterable(p(),c)}:p)}},49177:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.iif=void 0;var r=n(88393);t.iif=function(e,t,n){return r.defer((function(){return e()?t:n}))}},88415:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},o=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof s?s(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}},s=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.fromReadableStreamLike=t.fromAsyncIterable=t.fromIterable=t.fromPromise=t.fromArrayLike=t.fromInteropObservable=t.innerFrom=void 0;var a=n(61329),u=n(1671),c=n(44623),l=n(45667),h=n(27037),d=n(81885),f=n(49616),p=n(73476),m=n(23795),g=n(3423),v=n(70552);function y(e){return new c.Observable((function(t){var n=e[v.observable]();if(m.isFunction(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")}))}function b(e){return new c.Observable((function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()}))}function _(e){return new c.Observable((function(t){e.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,g.reportUnhandledError)}))}function x(e){return new c.Observable((function(t){var n,r;try{for(var i=s(e),o=i.next();!o.done;o=i.next()){var a=o.value;if(t.next(a),t.closed)return}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}t.complete()}))}function w(e){return new c.Observable((function(t){(function(e,t){var n,s,a,u;return r(this,void 0,void 0,(function(){var r,c;return i(this,(function(i){switch(i.label){case 0:i.trys.push([0,5,6,11]),n=o(e),i.label=1;case 1:return[4,n.next()];case 2:if((s=i.sent()).done)return[3,4];if(r=s.value,t.next(r),t.closed)return[2];i.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=i.sent(),a={error:c},[3,11];case 6:return i.trys.push([6,,9,10]),s&&!s.done&&(u=n.return)?[4,u.call(n)]:[3,8];case 7:i.sent(),i.label=8;case 8:return[3,10];case 9:if(a)throw a.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function S(e){return w(p.readableStreamLikeToAsyncGenerator(e))}t.innerFrom=function(e){if(e instanceof c.Observable)return e;if(null!=e){if(l.isInteropObservable(e))return y(e);if(a.isArrayLike(e))return b(e);if(u.isPromise(e))return _(e);if(h.isAsyncIterable(e))return w(e);if(f.isIterable(e))return x(e);if(p.isReadableStreamLike(e))return S(e)}throw d.createInvalidObservableTypeError(e)},t.fromInteropObservable=y,t.fromArrayLike=b,t.fromPromise=_,t.fromIterable=x,t.fromAsyncIterable=w,t.fromReadableStreamLike=S},58892:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.interval=void 0;var r=n(42342),i=n(30885);t.interval=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=r.asyncScheduler),e<0&&(e=0),i.timer(e,e,t)}},13889:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.merge=void 0;var r=n(86960),i=n(88415),o=n(68511),s=n(59342),a=n(6609);t.merge=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=s.popScheduler(e),u=s.popNumber(e,1/0),c=e;return c.length?1===c.length?i.innerFrom(c[0]):r.mergeAll(u)(a.from(c,n)):o.EMPTY}},64968:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.never=t.NEVER=void 0;var r=n(44623),i=n(96008);t.NEVER=new r.Observable(i.noop),t.never=function(){return t.NEVER}},29268:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.of=void 0;var r=n(59342),i=n(6609);t.of=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=r.popScheduler(e);return i.from(e,n)}},25857:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onErrorResumeNext=void 0;var r=n(44623),i=n(41906),o=n(96603),s=n(96008),a=n(88415);t.onErrorResumeNext=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=i.argsOrArgArray(e);return new r.Observable((function(e){var t=0,r=function(){if(t<n.length){var i=void 0;try{i=a.innerFrom(n[t++])}catch(e){return void r()}var u=new o.OperatorSubscriber(e,void 0,s.noop,s.noop);i.subscribe(u),u.add(r)}else e.complete()};r()}))}},13214:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pairs=void 0;var r=n(6609);t.pairs=function(e,t){return r.from(Object.entries(e),t)}},50867:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.partition=void 0;var r=n(40642),i=n(36870),o=n(88415);t.partition=function(e,t,n){return[i.filter(t,n)(o.innerFrom(e)),i.filter(r.not(t,n))(o.innerFrom(e))]}},41572:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.raceInit=t.race=void 0;var r=n(44623),i=n(88415),o=n(41906),s=n(96603);function a(e){return function(t){for(var n=[],r=function(r){n.push(i.innerFrom(e[r]).subscribe(s.createOperatorSubscriber(t,(function(e){if(n){for(var i=0;i<n.length;i++)i!==r&&n[i].unsubscribe();n=null}t.next(e)}))))},o=0;n&&!t.closed&&o<e.length;o++)r(o)}}t.race=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 1===(e=o.argsOrArgArray(e)).length?i.innerFrom(e[0]):new r.Observable(a(e))},t.raceInit=a},37265:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.range=void 0;var r=n(44623),i=n(68511);t.range=function(e,t,n){if(null==t&&(t=e,e=0),t<=0)return i.EMPTY;var o=t+e;return new r.Observable(n?function(t){var r=e;return n.schedule((function(){r<o?(t.next(r++),this.schedule()):t.complete()}))}:function(t){for(var n=e;n<o&&!t.closed;)t.next(n++);t.complete()})}},23685:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throwError=void 0;var r=n(44623),i=n(23795);t.throwError=function(e,t){var n=i.isFunction(e)?e:function(){return e},o=function(e){return e.error(n())};return new r.Observable(t?function(e){return t.schedule(o,0,e)}:o)}},30885:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timer=void 0;var r=n(44623),i=n(42342),o=n(50387),s=n(74185);t.timer=function(e,t,n){void 0===e&&(e=0),void 0===n&&(n=i.async);var a=-1;return null!=t&&(o.isScheduler(t)?n=t:a=t),new r.Observable((function(t){var r=s.isValidDate(e)?+e-n.now():e;r<0&&(r=0);var i=0;return n.schedule((function(){t.closed||(t.next(i++),0<=a?this.schedule(void 0,a):t.complete())}),r)}))}},79342:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.using=void 0;var r=n(44623),i=n(88415),o=n(68511);t.using=function(e,t){return new r.Observable((function(n){var r=e(),s=t(r);return(s?i.innerFrom(s):o.EMPTY).subscribe(n),function(){r&&r.unsubscribe()}}))}},30888:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.zip=void 0;var o=n(44623),s=n(88415),a=n(41906),u=n(68511),c=n(96603),l=n(59342);t.zip=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=l.popResultSelector(e),h=a.argsOrArgArray(e);return h.length?new o.Observable((function(e){var t=h.map((function(){return[]})),o=h.map((function(){return!1}));e.add((function(){t=o=null}));for(var a=function(a){s.innerFrom(h[a]).subscribe(c.createOperatorSubscriber(e,(function(s){if(t[a].push(s),t.every((function(e){return e.length}))){var u=t.map((function(e){return e.shift()}));e.next(n?n.apply(void 0,i([],r(u))):u),t.some((function(e,t){return!e.length&&o[t]}))&&e.complete()}}),(function(){o[a]=!0,!t[a].length&&e.complete()})))},u=0;!e.closed&&u<h.length;u++)a(u);return function(){t=o=null}})):u.EMPTY}},96603:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.OperatorSubscriber=t.createOperatorSubscriber=void 0;var o=n(654);t.createOperatorSubscriber=function(e,t,n,r,i){return new s(e,t,n,r,i)};var s=function(e){function t(t,n,r,i,o,s){var a=e.call(this,t)||this;return a.onFinalize=o,a.shouldUnsubscribe=s,a._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return i(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(o.Subscriber);t.OperatorSubscriber=s},49395:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.audit=void 0;var r=n(80215),i=n(88415),o=n(96603);t.audit=function(e){return r.operate((function(t,n){var r=!1,s=null,a=null,u=!1,c=function(){if(null==a||a.unsubscribe(),a=null,r){r=!1;var e=s;s=null,n.next(e)}u&&n.complete()},l=function(){a=null,u&&n.complete()};t.subscribe(o.createOperatorSubscriber(n,(function(t){r=!0,s=t,a||i.innerFrom(e(t)).subscribe(a=o.createOperatorSubscriber(n,c,l))}),(function(){u=!0,(!r||!a||a.closed)&&n.complete()})))}))}},97380:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.auditTime=void 0;var r=n(42342),i=n(49395),o=n(30885);t.auditTime=function(e,t){return void 0===t&&(t=r.asyncScheduler),i.audit((function(){return o.timer(e,t)}))}},60366:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buffer=void 0;var r=n(80215),i=n(96008),o=n(96603),s=n(88415);t.buffer=function(e){return r.operate((function(t,n){var r=[];return t.subscribe(o.createOperatorSubscriber(n,(function(e){return r.push(e)}),(function(){n.next(r),n.complete()}))),s.innerFrom(e).subscribe(o.createOperatorSubscriber(n,(function(){var e=r;r=[],n.next(e)}),i.noop)),function(){r=null}}))}},72847:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.bufferCount=void 0;var i=n(80215),o=n(96603),s=n(51458);t.bufferCount=function(e,t){return void 0===t&&(t=null),t=null!=t?t:e,i.operate((function(n,i){var a=[],u=0;n.subscribe(o.createOperatorSubscriber(i,(function(n){var o,c,l,h,d=null;u++%t==0&&a.push([]);try{for(var f=r(a),p=f.next();!p.done;p=f.next()){(v=p.value).push(n),e<=v.length&&(d=null!=d?d:[]).push(v)}}catch(e){o={error:e}}finally{try{p&&!p.done&&(c=f.return)&&c.call(f)}finally{if(o)throw o.error}}if(d)try{for(var m=r(d),g=m.next();!g.done;g=m.next()){var v=g.value;s.arrRemove(a,v),i.next(v)}}catch(e){l={error:e}}finally{try{g&&!g.done&&(h=m.return)&&h.call(m)}finally{if(l)throw l.error}}}),(function(){var e,t;try{for(var n=r(a),o=n.next();!o.done;o=n.next()){var s=o.value;i.next(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}i.complete()}),void 0,(function(){a=null})))}))}},7914:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.bufferTime=void 0;var i=n(62032),o=n(80215),s=n(96603),a=n(51458),u=n(42342),c=n(59342),l=n(45752);t.bufferTime=function(e){for(var t,n,h=[],d=1;d<arguments.length;d++)h[d-1]=arguments[d];var f=null!==(t=c.popScheduler(h))&&void 0!==t?t:u.asyncScheduler,p=null!==(n=h[0])&&void 0!==n?n:null,m=h[1]||1/0;return o.operate((function(t,n){var o=[],u=!1,c=function(e){var t=e.buffer;e.subs.unsubscribe(),a.arrRemove(o,e),n.next(t),u&&h()},h=function(){if(o){var t=new i.Subscription;n.add(t);var r={buffer:[],subs:t};o.push(r),l.executeSchedule(t,f,(function(){return c(r)}),e)}};null!==p&&p>=0?l.executeSchedule(n,f,h,p,!0):u=!0,h();var d=s.createOperatorSubscriber(n,(function(e){var t,n,i=o.slice();try{for(var s=r(i),a=s.next();!a.done;a=s.next()){var u=a.value,l=u.buffer;l.push(e),m<=l.length&&c(u)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}}),(function(){for(;null==o?void 0:o.length;)n.next(o.shift().buffer);null==d||d.unsubscribe(),n.complete(),n.unsubscribe()}),void 0,(function(){return o=null}));t.subscribe(d)}))}},99347:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.bufferToggle=void 0;var i=n(62032),o=n(80215),s=n(88415),a=n(96603),u=n(96008),c=n(51458);t.bufferToggle=function(e,t){return o.operate((function(n,o){var l=[];s.innerFrom(e).subscribe(a.createOperatorSubscriber(o,(function(e){var n=[];l.push(n);var r=new i.Subscription;r.add(s.innerFrom(t(e)).subscribe(a.createOperatorSubscriber(o,(function(){c.arrRemove(l,n),o.next(n),r.unsubscribe()}),u.noop)))}),u.noop)),n.subscribe(a.createOperatorSubscriber(o,(function(e){var t,n;try{for(var i=r(l),o=i.next();!o.done;o=i.next()){o.value.push(e)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}),(function(){for(;l.length>0;)o.next(l.shift());o.complete()})))}))}},9901:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bufferWhen=void 0;var r=n(80215),i=n(96008),o=n(96603),s=n(88415);t.bufferWhen=function(e){return r.operate((function(t,n){var r=null,a=null,u=function(){null==a||a.unsubscribe();var t=r;r=[],t&&n.next(t),s.innerFrom(e()).subscribe(a=o.createOperatorSubscriber(n,u,i.noop))};u(),t.subscribe(o.createOperatorSubscriber(n,(function(e){return null==r?void 0:r.push(e)}),(function(){r&&n.next(r),n.complete()}),void 0,(function(){return r=a=null})))}))}},26324:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.catchError=void 0;var r=n(88415),i=n(96603),o=n(80215);t.catchError=function e(t){return o.operate((function(n,o){var s,a=null,u=!1;a=n.subscribe(i.createOperatorSubscriber(o,void 0,void 0,(function(i){s=r.innerFrom(t(i,e(t)(n))),a?(a.unsubscribe(),a=null,s.subscribe(o)):u=!0}))),u&&(a.unsubscribe(),a=null,s.subscribe(o))}))}},46564:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combineAll=void 0;var r=n(60681);t.combineAll=r.combineLatestAll},73504:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.combineLatest=void 0;var o=n(73224),s=n(80215),a=n(41906),u=n(62571),c=n(52294),l=n(59342);t.combineLatest=function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var h=l.popResultSelector(t);return h?c.pipe(e.apply(void 0,i([],r(t))),u.mapOneOrManyArgs(h)):s.operate((function(e,n){o.combineLatestInit(i([e],r(a.argsOrArgArray(t))))(n)}))}},60681:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combineLatestAll=void 0;var r=n(73224),i=n(92459);t.combineLatestAll=function(e){return i.joinAllInternals(r.combineLatest,e)}},16014:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.combineLatestWith=void 0;var o=n(73504);t.combineLatestWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.combineLatest.apply(void 0,i([],r(e)))}},2411:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.concat=void 0;var o=n(80215),s=n(89371),a=n(59342),u=n(6609);t.concat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=a.popScheduler(e);return o.operate((function(t,o){s.concatAll()(u.from(i([t],r(e)),n)).subscribe(o)}))}},89371:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concatAll=void 0;var r=n(86960);t.concatAll=function(){return r.mergeAll(1)}},20929:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concatMap=void 0;var r=n(84096),i=n(23795);t.concatMap=function(e,t){return i.isFunction(t)?r.mergeMap(e,t,1):r.mergeMap(e,1)}},1394:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concatMapTo=void 0;var r=n(20929),i=n(23795);t.concatMapTo=function(e,t){return i.isFunction(t)?r.concatMap((function(){return e}),t):r.concatMap((function(){return e}))}},7695:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.concatWith=void 0;var o=n(2411);t.concatWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.concat.apply(void 0,i([],r(e)))}},82602:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.connect=void 0;var r=n(28530),i=n(88415),o=n(80215),s=n(93863),a={connector:function(){return new r.Subject}};t.connect=function(e,t){void 0===t&&(t=a);var n=t.connector;return o.operate((function(t,r){var o=n();i.innerFrom(e(s.fromSubscribable(o))).subscribe(r),r.add(t.subscribe(o))}))}},31727:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.count=void 0;var r=n(59425);t.count=function(e){return r.reduce((function(t,n,r){return!e||e(n,r)?t+1:t}),0)}},3475:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=void 0;var r=n(80215),i=n(96008),o=n(96603),s=n(88415);t.debounce=function(e){return r.operate((function(t,n){var r=!1,a=null,u=null,c=function(){if(null==u||u.unsubscribe(),u=null,r){r=!1;var e=a;a=null,n.next(e)}};t.subscribe(o.createOperatorSubscriber(n,(function(t){null==u||u.unsubscribe(),r=!0,a=t,u=o.createOperatorSubscriber(n,c,i.noop),s.innerFrom(e(t)).subscribe(u)}),(function(){c(),n.complete()}),void 0,(function(){a=u=null})))}))}},97146:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debounceTime=void 0;var r=n(42342),i=n(80215),o=n(96603);t.debounceTime=function(e,t){return void 0===t&&(t=r.asyncScheduler),i.operate((function(n,r){var i=null,s=null,a=null,u=function(){if(i){i.unsubscribe(),i=null;var e=s;s=null,r.next(e)}};function c(){var n=a+e,o=t.now();if(o<n)return i=this.schedule(void 0,n-o),void r.add(i);u()}n.subscribe(o.createOperatorSubscriber(r,(function(n){s=n,a=t.now(),i||(i=t.schedule(c,e),r.add(i))}),(function(){u(),r.complete()}),void 0,(function(){s=i=null})))}))}},23931:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultIfEmpty=void 0;var r=n(80215),i=n(96603);t.defaultIfEmpty=function(e){return r.operate((function(t,n){var r=!1;t.subscribe(i.createOperatorSubscriber(n,(function(e){r=!0,n.next(e)}),(function(){r||n.next(e),n.complete()})))}))}},7165:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delay=void 0;var r=n(42342),i=n(14002),o=n(30885);t.delay=function(e,t){void 0===t&&(t=r.asyncScheduler);var n=o.timer(e,t);return i.delayWhen((function(){return n}))}},14002:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delayWhen=void 0;var r=n(55758),i=n(23133),o=n(82746),s=n(61482),a=n(84096),u=n(88415);t.delayWhen=function e(t,n){return n?function(s){return r.concat(n.pipe(i.take(1),o.ignoreElements()),s.pipe(e(t)))}:a.mergeMap((function(e,n){return u.innerFrom(t(e,n)).pipe(i.take(1),s.mapTo(e))}))}},85760:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dematerialize=void 0;var r=n(65193),i=n(80215),o=n(96603);t.dematerialize=function(){return i.operate((function(e,t){e.subscribe(o.createOperatorSubscriber(t,(function(e){return r.observeNotification(e,t)})))}))}},78160:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.distinct=void 0;var r=n(80215),i=n(96603),o=n(96008),s=n(88415);t.distinct=function(e,t){return r.operate((function(n,r){var a=new Set;n.subscribe(i.createOperatorSubscriber(r,(function(t){var n=e?e(t):t;a.has(n)||(a.add(n),r.next(t))}))),t&&s.innerFrom(t).subscribe(i.createOperatorSubscriber(r,(function(){return a.clear()}),o.noop))}))}},9280:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.distinctUntilChanged=void 0;var r=n(79546),i=n(80215),o=n(96603);function s(e,t){return e===t}t.distinctUntilChanged=function(e,t){return void 0===t&&(t=r.identity),e=null!=e?e:s,i.operate((function(n,r){var i,s=!0;n.subscribe(o.createOperatorSubscriber(r,(function(n){var o=t(n);!s&&e(i,o)||(s=!1,i=o,r.next(n))})))}))}},85358:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.distinctUntilKeyChanged=void 0;var r=n(9280);t.distinctUntilKeyChanged=function(e,t){return r.distinctUntilChanged((function(n,r){return t?t(n[e],r[e]):n[e]===r[e]}))}},76542:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.elementAt=void 0;var r=n(31507),i=n(36870),o=n(79784),s=n(23931),a=n(23133);t.elementAt=function(e,t){if(e<0)throw new r.ArgumentOutOfRangeError;var n=arguments.length>=2;return function(u){return u.pipe(i.filter((function(t,n){return n===e})),a.take(1),n?s.defaultIfEmpty(t):o.throwIfEmpty((function(){return new r.ArgumentOutOfRangeError})))}}},41537:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.endWith=void 0;var o=n(55758),s=n(29268);t.endWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return o.concat(t,s.of.apply(void 0,i([],r(e))))}}},94971:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.every=void 0;var r=n(80215),i=n(96603);t.every=function(e,t){return r.operate((function(n,r){var o=0;n.subscribe(i.createOperatorSubscriber(r,(function(i){e.call(t,i,o++,n)||(r.next(!1),r.complete())}),(function(){r.next(!0),r.complete()})))}))}},66375:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.exhaust=void 0;var r=n(17807);t.exhaust=r.exhaustAll},17807:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.exhaustAll=void 0;var r=n(52339),i=n(79546);t.exhaustAll=function(){return r.exhaustMap(i.identity)}},52339:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.exhaustMap=void 0;var r=n(74633),i=n(88415),o=n(80215),s=n(96603);t.exhaustMap=function e(t,n){return n?function(o){return o.pipe(e((function(e,o){return i.innerFrom(t(e,o)).pipe(r.map((function(t,r){return n(e,t,o,r)})))})))}:o.operate((function(e,n){var r=0,o=null,a=!1;e.subscribe(s.createOperatorSubscriber(n,(function(e){o||(o=s.createOperatorSubscriber(n,void 0,(function(){o=null,a&&n.complete()})),i.innerFrom(t(e,r++)).subscribe(o))}),(function(){a=!0,!o&&n.complete()})))}))}},94162:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expand=void 0;var r=n(80215),i=n(67156);t.expand=function(e,t,n){return void 0===t&&(t=1/0),t=(t||0)<1?1/0:t,r.operate((function(r,o){return i.mergeInternals(r,o,e,t,void 0,!0,n)}))}},36870:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filter=void 0;var r=n(80215),i=n(96603);t.filter=function(e,t){return r.operate((function(n,r){var o=0;n.subscribe(i.createOperatorSubscriber(r,(function(n){return e.call(t,n,o++)&&r.next(n)})))}))}},36011:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.finalize=void 0;var r=n(80215);t.finalize=function(e){return r.operate((function(t,n){try{t.subscribe(n)}finally{n.add(e)}}))}},45575:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createFind=t.find=void 0;var r=n(80215),i=n(96603);function o(e,t,n){var r="index"===n;return function(n,o){var s=0;n.subscribe(i.createOperatorSubscriber(o,(function(i){var a=s++;e.call(t,i,a,n)&&(o.next(r?a:i),o.complete())}),(function(){o.next(r?-1:void 0),o.complete()})))}}t.find=function(e,t){return r.operate(o(e,t,"value"))},t.createFind=o},9031:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findIndex=void 0;var r=n(80215),i=n(45575);t.findIndex=function(e,t){return r.operate(i.createFind(e,t,"index"))}},93133:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.first=void 0;var r=n(10683),i=n(36870),o=n(23133),s=n(23931),a=n(79784),u=n(79546);t.first=function(e,t){var n=arguments.length>=2;return function(c){return c.pipe(e?i.filter((function(t,n){return e(t,n,c)})):u.identity,o.take(1),n?s.defaultIfEmpty(t):a.throwIfEmpty((function(){return new r.EmptyError})))}}},60878:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flatMap=void 0;var r=n(84096);t.flatMap=r.mergeMap},14307:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.groupBy=void 0;var r=n(44623),i=n(88415),o=n(28530),s=n(80215),a=n(96603);t.groupBy=function(e,t,n,u){return s.operate((function(s,c){var l;t&&"function"!=typeof t?(n=t.duration,l=t.element,u=t.connector):l=t;var h=new Map,d=function(e){h.forEach(e),e(c)},f=function(e){return d((function(t){return t.error(e)}))},p=0,m=!1,g=new a.OperatorSubscriber(c,(function(t){try{var s=e(t),d=h.get(s);if(!d){h.set(s,d=u?u():new o.Subject);var v=(b=s,_=d,(x=new r.Observable((function(e){p++;var t=_.subscribe(e);return function(){t.unsubscribe(),0==--p&&m&&g.unsubscribe()}}))).key=b,x);if(c.next(v),n){var y=a.createOperatorSubscriber(d,(function(){d.complete(),null==y||y.unsubscribe()}),void 0,void 0,(function(){return h.delete(s)}));g.add(i.innerFrom(n(v)).subscribe(y))}}d.next(l?l(t):t)}catch(e){f(e)}var b,_,x}),(function(){return d((function(e){return e.complete()}))}),f,(function(){return h.clear()}),(function(){return m=!0,0===p}));s.subscribe(g)}))}},82746:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ignoreElements=void 0;var r=n(80215),i=n(96603),o=n(96008);t.ignoreElements=function(){return r.operate((function(e,t){e.subscribe(i.createOperatorSubscriber(t,o.noop))}))}},39470:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEmpty=void 0;var r=n(80215),i=n(96603);t.isEmpty=function(){return r.operate((function(e,t){e.subscribe(i.createOperatorSubscriber(t,(function(){t.next(!1),t.complete()}),(function(){t.next(!0),t.complete()})))}))}},92459:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.joinAllInternals=void 0;var r=n(79546),i=n(62571),o=n(52294),s=n(84096),a=n(22666);t.joinAllInternals=function(e,t){return o.pipe(a.toArray(),s.mergeMap((function(t){return e(t)})),t?i.mapOneOrManyArgs(t):r.identity)}},17424:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.last=void 0;var r=n(10683),i=n(36870),o=n(36771),s=n(79784),a=n(23931),u=n(79546);t.last=function(e,t){var n=arguments.length>=2;return function(c){return c.pipe(e?i.filter((function(t,n){return e(t,n,c)})):u.identity,o.takeLast(1),n?a.defaultIfEmpty(t):s.throwIfEmpty((function(){return new r.EmptyError})))}}},74633:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.map=void 0;var r=n(80215),i=n(96603);t.map=function(e,t){return r.operate((function(n,r){var o=0;n.subscribe(i.createOperatorSubscriber(r,(function(n){r.next(e.call(t,n,o++))})))}))}},61482:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapTo=void 0;var r=n(74633);t.mapTo=function(e){return r.map((function(){return e}))}},14335:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.materialize=void 0;var r=n(65193),i=n(80215),o=n(96603);t.materialize=function(){return i.operate((function(e,t){e.subscribe(o.createOperatorSubscriber(t,(function(e){t.next(r.Notification.createNext(e))}),(function(){t.next(r.Notification.createComplete()),t.complete()}),(function(e){t.next(r.Notification.createError(e)),t.complete()})))}))}},34792:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.max=void 0;var r=n(59425),i=n(23795);t.max=function(e){return r.reduce(i.isFunction(e)?function(t,n){return e(t,n)>0?t:n}:function(e,t){return e>t?e:t})}},23066:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.merge=void 0;var o=n(80215),s=n(41906),a=n(86960),u=n(59342),c=n(6609);t.merge=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=u.popScheduler(e),l=u.popNumber(e,1/0);return e=s.argsOrArgArray(e),o.operate((function(t,o){a.mergeAll(l)(c.from(i([t],r(e)),n)).subscribe(o)}))}},86960:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeAll=void 0;var r=n(84096),i=n(79546);t.mergeAll=function(e){return void 0===e&&(e=1/0),r.mergeMap(i.identity,e)}},67156:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeInternals=void 0;var r=n(88415),i=n(45752),o=n(96603);t.mergeInternals=function(e,t,n,s,a,u,c,l){var h=[],d=0,f=0,p=!1,m=function(){!p||h.length||d||t.complete()},g=function(e){return d<s?v(e):h.push(e)},v=function(e){u&&t.next(e),d++;var l=!1;r.innerFrom(n(e,f++)).subscribe(o.createOperatorSubscriber(t,(function(e){null==a||a(e),u?g(e):t.next(e)}),(function(){l=!0}),void 0,(function(){if(l)try{d--;for(var e=function(){var e=h.shift();c?i.executeSchedule(t,c,(function(){return v(e)})):v(e)};h.length&&d<s;)e();m()}catch(e){t.error(e)}})))};return e.subscribe(o.createOperatorSubscriber(t,g,(function(){p=!0,m()}))),function(){null==l||l()}}},84096:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeMap=void 0;var r=n(74633),i=n(88415),o=n(80215),s=n(67156),a=n(23795);t.mergeMap=function e(t,n,u){return void 0===u&&(u=1/0),a.isFunction(n)?e((function(e,o){return r.map((function(t,r){return n(e,t,o,r)}))(i.innerFrom(t(e,o)))}),u):("number"==typeof n&&(u=n),o.operate((function(e,n){return s.mergeInternals(e,n,t,u)})))}},18611:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeMapTo=void 0;var r=n(84096),i=n(23795);t.mergeMapTo=function(e,t,n){return void 0===n&&(n=1/0),i.isFunction(t)?r.mergeMap((function(){return e}),t,n):("number"==typeof t&&(n=t),r.mergeMap((function(){return e}),n))}},19259:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeScan=void 0;var r=n(80215),i=n(67156);t.mergeScan=function(e,t,n){return void 0===n&&(n=1/0),r.operate((function(r,o){var s=t;return i.mergeInternals(r,o,(function(t,n){return e(s,t,n)}),n,(function(e){s=e}),!1,void 0,(function(){return s=null}))}))}},61353:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.mergeWith=void 0;var o=n(23066);t.mergeWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.merge.apply(void 0,i([],r(e)))}},33807:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.min=void 0;var r=n(59425),i=n(23795);t.min=function(e){return r.reduce(i.isFunction(e)?function(t,n){return e(t,n)<0?t:n}:function(e,t){return e<t?e:t})}},5912:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.multicast=void 0;var r=n(51384),i=n(23795),o=n(82602);t.multicast=function(e,t){var n=i.isFunction(e)?e:function(){return e};return i.isFunction(t)?o.connect(t,{connector:n}):function(e){return new r.ConnectableObservable(e,n)}}},8987:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.observeOn=void 0;var r=n(45752),i=n(80215),o=n(96603);t.observeOn=function(e,t){return void 0===t&&(t=0),i.operate((function(n,i){n.subscribe(o.createOperatorSubscriber(i,(function(n){return r.executeSchedule(i,e,(function(){return i.next(n)}),t)}),(function(){return r.executeSchedule(i,e,(function(){return i.complete()}),t)}),(function(n){return r.executeSchedule(i,e,(function(){return i.error(n)}),t)})))}))}},20555:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.onErrorResumeNext=t.onErrorResumeNextWith=void 0;var o=n(41906),s=n(25857);function a(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=o.argsOrArgArray(e);return function(e){return s.onErrorResumeNext.apply(void 0,i([e],r(n)))}}t.onErrorResumeNextWith=a,t.onErrorResumeNext=a},66821:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pairwise=void 0;var r=n(80215),i=n(96603);t.pairwise=function(){return r.operate((function(e,t){var n,r=!1;e.subscribe(i.createOperatorSubscriber(t,(function(e){var i=n;n=e,r&&t.next([i,e]),r=!0})))}))}},102:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.partition=void 0;var r=n(40642),i=n(36870);t.partition=function(e,t){return function(n){return[i.filter(e,t)(n),i.filter(r.not(e,t))(n)]}}},70339:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pluck=void 0;var r=n(74633);t.pluck=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.length;if(0===n)throw new Error("list of properties cannot be empty.");return r.map((function(t){for(var r=t,i=0;i<n;i++){var o=null==r?void 0:r[e[i]];if(void 0===o)return;r=o}return r}))}},22448:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.publish=void 0;var r=n(28530),i=n(5912),o=n(82602);t.publish=function(e){return e?function(t){return o.connect(e)(t)}:function(e){return i.multicast(new r.Subject)(e)}}},6306:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.publishBehavior=void 0;var r=n(37724),i=n(51384);t.publishBehavior=function(e){return function(t){var n=new r.BehaviorSubject(e);return new i.ConnectableObservable(t,(function(){return n}))}}},7161:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.publishLast=void 0;var r=n(32939),i=n(51384);t.publishLast=function(){return function(e){var t=new r.AsyncSubject;return new i.ConnectableObservable(e,(function(){return t}))}}},25962:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.publishReplay=void 0;var r=n(11798),i=n(5912),o=n(23795);t.publishReplay=function(e,t,n,s){n&&!o.isFunction(n)&&(s=n);var a=o.isFunction(n)?n:void 0;return function(n){return i.multicast(new r.ReplaySubject(e,t,s),a)(n)}}},17527:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.race=void 0;var o=n(41906),s=n(95391);t.race=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.raceWith.apply(void 0,i([],r(o.argsOrArgArray(e))))}},95391:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.raceWith=void 0;var o=n(41572),s=n(80215),a=n(79546);t.raceWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length?s.operate((function(t,n){o.raceInit(i([t],r(e)))(n)})):a.identity}},59425:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reduce=void 0;var r=n(23155),i=n(80215);t.reduce=function(e,t){return i.operate(r.scanInternals(e,t,arguments.length>=2,!1,!0))}},56802:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.refCount=void 0;var r=n(80215),i=n(96603);t.refCount=function(){return r.operate((function(e,t){var n=null;e._refCount++;var r=i.createOperatorSubscriber(t,void 0,void 0,void 0,(function(){if(!e||e._refCount<=0||0<--e._refCount)n=null;else{var r=e._connection,i=n;n=null,!r||i&&r!==i||r.unsubscribe(),t.unsubscribe()}}));e.subscribe(r),r.closed||(n=e.connect())}))}},71220:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.repeat=void 0;var r=n(68511),i=n(80215),o=n(96603),s=n(88415),a=n(30885);t.repeat=function(e){var t,n,u=1/0;return null!=e&&("object"==typeof e?(t=e.count,u=void 0===t?1/0:t,n=e.delay):u=e),u<=0?function(){return r.EMPTY}:i.operate((function(e,t){var r,i=0,c=function(){if(null==r||r.unsubscribe(),r=null,null!=n){var e="number"==typeof n?a.timer(n):s.innerFrom(n(i)),u=o.createOperatorSubscriber(t,(function(){u.unsubscribe(),l()}));e.subscribe(u)}else l()},l=function(){var n=!1;r=e.subscribe(o.createOperatorSubscriber(t,void 0,(function(){++i<u?r?c():n=!0:t.complete()}))),n&&c()};l()}))}},42948:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.repeatWhen=void 0;var r=n(88415),i=n(28530),o=n(80215),s=n(96603);t.repeatWhen=function(e){return o.operate((function(t,n){var o,a,u=!1,c=!1,l=!1,h=function(){return l&&c&&(n.complete(),!0)},d=function(){l=!1,o=t.subscribe(s.createOperatorSubscriber(n,void 0,(function(){l=!0,!h()&&(a||(a=new i.Subject,r.innerFrom(e(a)).subscribe(s.createOperatorSubscriber(n,(function(){o?d():u=!0}),(function(){c=!0,h()})))),a).next()}))),u&&(o.unsubscribe(),o=null,u=!1,d())};d()}))}},24590:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.retry=void 0;var r=n(80215),i=n(96603),o=n(79546),s=n(30885),a=n(88415);t.retry=function(e){var t;void 0===e&&(e=1/0);var n=(t=e&&"object"==typeof e?e:{count:e}).count,u=void 0===n?1/0:n,c=t.delay,l=t.resetOnSuccess,h=void 0!==l&&l;return u<=0?o.identity:r.operate((function(e,t){var n,r=0,o=function(){var l=!1;n=e.subscribe(i.createOperatorSubscriber(t,(function(e){h&&(r=0),t.next(e)}),void 0,(function(e){if(r++<u){var h=function(){n?(n.unsubscribe(),n=null,o()):l=!0};if(null!=c){var d="number"==typeof c?s.timer(c):a.innerFrom(c(e,r)),f=i.createOperatorSubscriber(t,(function(){f.unsubscribe(),h()}),(function(){t.complete()}));d.subscribe(f)}else h()}else t.error(e)}))),l&&(n.unsubscribe(),n=null,o())};o()}))}},91213:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.retryWhen=void 0;var r=n(88415),i=n(28530),o=n(80215),s=n(96603);t.retryWhen=function(e){return o.operate((function(t,n){var o,a,u=!1,c=function(){o=t.subscribe(s.createOperatorSubscriber(n,void 0,void 0,(function(t){a||(a=new i.Subject,r.innerFrom(e(a)).subscribe(s.createOperatorSubscriber(n,(function(){return o?c():u=!0})))),a&&a.next(t)}))),u&&(o.unsubscribe(),o=null,u=!1,c())};c()}))}},25152:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sample=void 0;var r=n(88415),i=n(80215),o=n(96008),s=n(96603);t.sample=function(e){return i.operate((function(t,n){var i=!1,a=null;t.subscribe(s.createOperatorSubscriber(n,(function(e){i=!0,a=e}))),r.innerFrom(e).subscribe(s.createOperatorSubscriber(n,(function(){if(i){i=!1;var e=a;a=null,n.next(e)}}),o.noop))}))}},66695:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sampleTime=void 0;var r=n(42342),i=n(25152),o=n(58892);t.sampleTime=function(e,t){return void 0===t&&(t=r.asyncScheduler),i.sample(o.interval(e,t))}},99568:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scan=void 0;var r=n(80215),i=n(23155);t.scan=function(e,t){return r.operate(i.scanInternals(e,t,arguments.length>=2,!0))}},23155:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scanInternals=void 0;var r=n(96603);t.scanInternals=function(e,t,n,i,o){return function(s,a){var u=n,c=t,l=0;s.subscribe(r.createOperatorSubscriber(a,(function(t){var n=l++;c=u?e(c,t,n):(u=!0,t),i&&a.next(c)}),o&&function(){u&&a.next(c),a.complete()}))}}},30400:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sequenceEqual=void 0;var r=n(80215),i=n(96603),o=n(88415);t.sequenceEqual=function(e,t){return void 0===t&&(t=function(e,t){return e===t}),r.operate((function(n,r){var s={buffer:[],complete:!1},a={buffer:[],complete:!1},u=function(e){r.next(e),r.complete()},c=function(e,n){var o=i.createOperatorSubscriber(r,(function(r){var i=n.buffer,o=n.complete;0===i.length?o?u(!1):e.buffer.push(r):!t(r,i.shift())&&u(!1)}),(function(){e.complete=!0;var t=n.complete,r=n.buffer;t&&u(0===r.length),null==o||o.unsubscribe()}));return o};n.subscribe(c(s,a)),o.innerFrom(e).subscribe(c(a,s))}))}},67864:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.share=void 0;var o=n(88415),s=n(28530),a=n(654),u=n(80215);function c(e,t){for(var n=[],s=2;s<arguments.length;s++)n[s-2]=arguments[s];if(!0!==t){if(!1!==t){var u=new a.SafeSubscriber({next:function(){u.unsubscribe(),e()}});return o.innerFrom(t.apply(void 0,i([],r(n)))).subscribe(u)}}else e()}t.share=function(e){void 0===e&&(e={});var t=e.connector,n=void 0===t?function(){return new s.Subject}:t,r=e.resetOnError,i=void 0===r||r,l=e.resetOnComplete,h=void 0===l||l,d=e.resetOnRefCountZero,f=void 0===d||d;return function(e){var t,r,s,l=0,d=!1,p=!1,m=function(){null==r||r.unsubscribe(),r=void 0},g=function(){m(),t=s=void 0,d=p=!1},v=function(){var e=t;g(),null==e||e.unsubscribe()};return u.operate((function(e,u){l++,p||d||m();var y=s=null!=s?s:n();u.add((function(){0!==--l||p||d||(r=c(v,f))})),y.subscribe(u),!t&&l>0&&(t=new a.SafeSubscriber({next:function(e){return y.next(e)},error:function(e){p=!0,m(),r=c(g,i,e),y.error(e)},complete:function(){d=!0,m(),r=c(g,h),y.complete()}}),o.innerFrom(e).subscribe(t))}))(e)}}},84487:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shareReplay=void 0;var r=n(11798),i=n(67864);t.shareReplay=function(e,t,n){var o,s,a,u,c=!1;return e&&"object"==typeof e?(o=e.bufferSize,u=void 0===o?1/0:o,s=e.windowTime,t=void 0===s?1/0:s,c=void 0!==(a=e.refCount)&&a,n=e.scheduler):u=null!=e?e:1/0,i.share({connector:function(){return new r.ReplaySubject(u,t,n)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:c})}},28448:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.single=void 0;var r=n(10683),i=n(50868),o=n(63240),s=n(80215),a=n(96603);t.single=function(e){return s.operate((function(t,n){var s,u=!1,c=!1,l=0;t.subscribe(a.createOperatorSubscriber(n,(function(r){c=!0,e&&!e(r,l++,t)||(u&&n.error(new i.SequenceError("Too many matching values")),u=!0,s=r)}),(function(){u?(n.next(s),n.complete()):n.error(c?new o.NotFoundError("No matching values"):new r.EmptyError)})))}))}},96812:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.skip=void 0;var r=n(36870);t.skip=function(e){return r.filter((function(t,n){return e<=n}))}},89115:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.skipLast=void 0;var r=n(79546),i=n(80215),o=n(96603);t.skipLast=function(e){return e<=0?r.identity:i.operate((function(t,n){var r=new Array(e),i=0;return t.subscribe(o.createOperatorSubscriber(n,(function(t){var o=i++;if(o<e)r[o]=t;else{var s=o%e,a=r[s];r[s]=t,n.next(a)}}))),function(){r=null}}))}},56892:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.skipUntil=void 0;var r=n(80215),i=n(96603),o=n(88415),s=n(96008);t.skipUntil=function(e){return r.operate((function(t,n){var r=!1,a=i.createOperatorSubscriber(n,(function(){null==a||a.unsubscribe(),r=!0}),s.noop);o.innerFrom(e).subscribe(a),t.subscribe(i.createOperatorSubscriber(n,(function(e){return r&&n.next(e)})))}))}},34958:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.skipWhile=void 0;var r=n(80215),i=n(96603);t.skipWhile=function(e){return r.operate((function(t,n){var r=!1,o=0;t.subscribe(i.createOperatorSubscriber(n,(function(t){return(r||(r=!e(t,o++)))&&n.next(t)})))}))}},3793:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startWith=void 0;var r=n(55758),i=n(59342),o=n(80215);t.startWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=i.popScheduler(e);return o.operate((function(t,i){(n?r.concat(e,t,n):r.concat(e,t)).subscribe(i)}))}},45189:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeOn=void 0;var r=n(80215);t.subscribeOn=function(e,t){return void 0===t&&(t=0),r.operate((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}},12390:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.switchAll=void 0;var r=n(70511),i=n(79546);t.switchAll=function(){return r.switchMap(i.identity)}},70511:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.switchMap=void 0;var r=n(88415),i=n(80215),o=n(96603);t.switchMap=function(e,t){return i.operate((function(n,i){var s=null,a=0,u=!1,c=function(){return u&&!s&&i.complete()};n.subscribe(o.createOperatorSubscriber(i,(function(n){null==s||s.unsubscribe();var u=0,l=a++;r.innerFrom(e(n,l)).subscribe(s=o.createOperatorSubscriber(i,(function(e){return i.next(t?t(n,e,l,u++):e)}),(function(){s=null,c()})))}),(function(){u=!0,c()})))}))}},22723:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.switchMapTo=void 0;var r=n(70511),i=n(23795);t.switchMapTo=function(e,t){return i.isFunction(t)?r.switchMap((function(){return e}),t):r.switchMap((function(){return e}))}},98897:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.switchScan=void 0;var r=n(70511),i=n(80215);t.switchScan=function(e,t){return i.operate((function(n,i){var o=t;return r.switchMap((function(t,n){return e(o,t,n)}),(function(e,t){return o=t,t}))(n).subscribe(i),function(){o=null}}))}},23133:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.take=void 0;var r=n(68511),i=n(80215),o=n(96603);t.take=function(e){return e<=0?function(){return r.EMPTY}:i.operate((function(t,n){var r=0;t.subscribe(o.createOperatorSubscriber(n,(function(t){++r<=e&&(n.next(t),e<=r&&n.complete())})))}))}},36771:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.takeLast=void 0;var i=n(68511),o=n(80215),s=n(96603);t.takeLast=function(e){return e<=0?function(){return i.EMPTY}:o.operate((function(t,n){var i=[];t.subscribe(s.createOperatorSubscriber(n,(function(t){i.push(t),e<i.length&&i.shift()}),(function(){var e,t;try{for(var o=r(i),s=o.next();!s.done;s=o.next()){var a=s.value;n.next(a)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}n.complete()}),void 0,(function(){i=null})))}))}},38515:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.takeUntil=void 0;var r=n(80215),i=n(96603),o=n(88415),s=n(96008);t.takeUntil=function(e){return r.operate((function(t,n){o.innerFrom(e).subscribe(i.createOperatorSubscriber(n,(function(){return n.complete()}),s.noop)),!n.closed&&t.subscribe(n)}))}},5471:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.takeWhile=void 0;var r=n(80215),i=n(96603);t.takeWhile=function(e,t){return void 0===t&&(t=!1),r.operate((function(n,r){var o=0;n.subscribe(i.createOperatorSubscriber(r,(function(n){var i=e(n,o++);(i||t)&&r.next(n),!i&&r.complete()})))}))}},83562:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tap=void 0;var r=n(23795),i=n(80215),o=n(96603),s=n(79546);t.tap=function(e,t,n){var a=r.isFunction(e)||t||n?{next:e,error:t,complete:n}:e;return a?i.operate((function(e,t){var n;null===(n=a.subscribe)||void 0===n||n.call(a);var r=!0;e.subscribe(o.createOperatorSubscriber(t,(function(e){var n;null===(n=a.next)||void 0===n||n.call(a,e),t.next(e)}),(function(){var e;r=!1,null===(e=a.complete)||void 0===e||e.call(a),t.complete()}),(function(e){var n;r=!1,null===(n=a.error)||void 0===n||n.call(a,e),t.error(e)}),(function(){var e,t;r&&(null===(e=a.unsubscribe)||void 0===e||e.call(a)),null===(t=a.finalize)||void 0===t||t.call(a)})))})):s.identity}},11056:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=void 0;var r=n(80215),i=n(96603),o=n(88415);t.throttle=function(e,t){return r.operate((function(n,r){var s=null!=t?t:{},a=s.leading,u=void 0===a||a,c=s.trailing,l=void 0!==c&&c,h=!1,d=null,f=null,p=!1,m=function(){null==f||f.unsubscribe(),f=null,l&&(y(),p&&r.complete())},g=function(){f=null,p&&r.complete()},v=function(t){return f=o.innerFrom(e(t)).subscribe(i.createOperatorSubscriber(r,m,g))},y=function(){if(h){h=!1;var e=d;d=null,r.next(e),!p&&v(e)}};n.subscribe(i.createOperatorSubscriber(r,(function(e){h=!0,d=e,(!f||f.closed)&&(u?y():v(e))}),(function(){p=!0,(!(l&&h&&f)||f.closed)&&r.complete()})))}))}},87981:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throttleTime=void 0;var r=n(42342),i=n(11056),o=n(30885);t.throttleTime=function(e,t,n){void 0===t&&(t=r.asyncScheduler);var s=o.timer(e,t);return i.throttle((function(){return s}),n)}},79784:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throwIfEmpty=void 0;var r=n(10683),i=n(80215),o=n(96603);function s(){return new r.EmptyError}t.throwIfEmpty=function(e){return void 0===e&&(e=s),i.operate((function(t,n){var r=!1;t.subscribe(o.createOperatorSubscriber(n,(function(e){r=!0,n.next(e)}),(function(){return r?n.complete():n.error(e())})))}))}},47312:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TimeInterval=t.timeInterval=void 0;var r=n(42342),i=n(80215),o=n(96603);t.timeInterval=function(e){return void 0===e&&(e=r.asyncScheduler),i.operate((function(t,n){var r=e.now();t.subscribe(o.createOperatorSubscriber(n,(function(t){var i=e.now(),o=i-r;r=i,n.next(new s(t,o))})))}))};var s=function(e,t){this.value=e,this.interval=t};t.TimeInterval=s},13458:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timeout=t.TimeoutError=void 0;var r=n(42342),i=n(74185),o=n(80215),s=n(88415),a=n(21009),u=n(96603),c=n(45752);function l(e){throw new t.TimeoutError(e)}t.TimeoutError=a.createErrorClass((function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}})),t.timeout=function(e,t){var n=i.isValidDate(e)?{first:e}:"number"==typeof e?{each:e}:e,a=n.first,h=n.each,d=n.with,f=void 0===d?l:d,p=n.scheduler,m=void 0===p?null!=t?t:r.asyncScheduler:p,g=n.meta,v=void 0===g?null:g;if(null==a&&null==h)throw new TypeError("No timeout provided.");return o.operate((function(e,t){var n,r,i=null,o=0,l=function(e){r=c.executeSchedule(t,m,(function(){try{n.unsubscribe(),s.innerFrom(f({meta:v,lastValue:i,seen:o})).subscribe(t)}catch(e){t.error(e)}}),e)};n=e.subscribe(u.createOperatorSubscriber(t,(function(e){null==r||r.unsubscribe(),o++,t.next(i=e),h>0&&l(h)}),void 0,void 0,(function(){(null==r?void 0:r.closed)||null==r||r.unsubscribe(),i=null}))),!o&&l(null!=a?"number"==typeof a?a:+a-m.now():h)}))}},82416:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timeoutWith=void 0;var r=n(42342),i=n(74185),o=n(13458);t.timeoutWith=function(e,t,n){var s,a,u;if(n=null!=n?n:r.async,i.isValidDate(e)?s=e:"number"==typeof e&&(a=e),!t)throw new TypeError("No observable provided to switch to");if(u=function(){return t},null==s&&null==a)throw new TypeError("No timeout provided.");return o.timeout({first:s,each:a,scheduler:n,with:u})}},68098:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timestamp=void 0;var r=n(57762),i=n(74633);t.timestamp=function(e){return void 0===e&&(e=r.dateTimestampProvider),i.map((function(t){return{value:t,timestamp:e.now()}}))}},22666:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toArray=void 0;var r=n(59425),i=n(80215),o=function(e,t){return e.push(t),e};t.toArray=function(){return i.operate((function(e,t){r.reduce(o,[])(e).subscribe(t)}))}},69227:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.window=void 0;var r=n(28530),i=n(80215),o=n(96603),s=n(96008),a=n(88415);t.window=function(e){return i.operate((function(t,n){var i=new r.Subject;n.next(i.asObservable());var u=function(e){i.error(e),n.error(e)};return t.subscribe(o.createOperatorSubscriber(n,(function(e){return null==i?void 0:i.next(e)}),(function(){i.complete(),n.complete()}),u)),a.innerFrom(e).subscribe(o.createOperatorSubscriber(n,(function(){i.complete(),n.next(i=new r.Subject)}),s.noop,u)),function(){null==i||i.unsubscribe(),i=null}}))}},64805:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.windowCount=void 0;var i=n(28530),o=n(80215),s=n(96603);t.windowCount=function(e,t){void 0===t&&(t=0);var n=t>0?t:e;return o.operate((function(t,o){var a=[new i.Subject],u=0;o.next(a[0].asObservable()),t.subscribe(s.createOperatorSubscriber(o,(function(t){var s,c;try{for(var l=r(a),h=l.next();!h.done;h=l.next()){h.value.next(t)}}catch(e){s={error:e}}finally{try{h&&!h.done&&(c=l.return)&&c.call(l)}finally{if(s)throw s.error}}var d=u-e+1;if(d>=0&&d%n==0&&a.shift().complete(),++u%n==0){var f=new i.Subject;a.push(f),o.next(f.asObservable())}}),(function(){for(;a.length>0;)a.shift().complete();o.complete()}),(function(e){for(;a.length>0;)a.shift().error(e);o.error(e)}),(function(){null,a=null})))}))}},44487:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.windowTime=void 0;var r=n(28530),i=n(42342),o=n(62032),s=n(80215),a=n(96603),u=n(51458),c=n(59342),l=n(45752);t.windowTime=function(e){for(var t,n,h=[],d=1;d<arguments.length;d++)h[d-1]=arguments[d];var f=null!==(t=c.popScheduler(h))&&void 0!==t?t:i.asyncScheduler,p=null!==(n=h[0])&&void 0!==n?n:null,m=h[1]||1/0;return s.operate((function(t,n){var i=[],s=!1,c=function(e){var t=e.window,n=e.subs;t.complete(),n.unsubscribe(),u.arrRemove(i,e),s&&h()},h=function(){if(i){var t=new o.Subscription;n.add(t);var s=new r.Subject,a={window:s,subs:t,seen:0};i.push(a),n.next(s.asObservable()),l.executeSchedule(t,f,(function(){return c(a)}),e)}};null!==p&&p>=0?l.executeSchedule(n,f,h,p,!0):s=!0,h();var d=function(e){return i.slice().forEach(e)},g=function(e){d((function(t){var n=t.window;return e(n)})),e(n),n.unsubscribe()};return t.subscribe(a.createOperatorSubscriber(n,(function(e){d((function(t){t.window.next(e),m<=++t.seen&&c(t)}))}),(function(){return g((function(e){return e.complete()}))}),(function(e){return g((function(t){return t.error(e)}))}))),function(){i=null}}))}},45891:function(e,t,n){"use strict";var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.windowToggle=void 0;var i=n(28530),o=n(62032),s=n(80215),a=n(88415),u=n(96603),c=n(96008),l=n(51458);t.windowToggle=function(e,t){return s.operate((function(n,s){var h=[],d=function(e){for(;0<h.length;)h.shift().error(e);s.error(e)};a.innerFrom(e).subscribe(u.createOperatorSubscriber(s,(function(e){var n=new i.Subject;h.push(n);var r,f=new o.Subscription;try{r=a.innerFrom(t(e))}catch(e){return void d(e)}s.next(n.asObservable()),f.add(r.subscribe(u.createOperatorSubscriber(s,(function(){l.arrRemove(h,n),n.complete(),f.unsubscribe()}),c.noop,d)))}),c.noop)),n.subscribe(u.createOperatorSubscriber(s,(function(e){var t,n,i=h.slice();try{for(var o=r(i),s=o.next();!s.done;s=o.next()){s.value.next(e)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}),(function(){for(;0<h.length;)h.shift().complete();s.complete()}),d,(function(){for(;0<h.length;)h.shift().unsubscribe()})))}))}},78105:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.windowWhen=void 0;var r=n(28530),i=n(80215),o=n(96603),s=n(88415);t.windowWhen=function(e){return i.operate((function(t,n){var i,a,u=function(e){i.error(e),n.error(e)},c=function(){var t;null==a||a.unsubscribe(),null==i||i.complete(),i=new r.Subject,n.next(i.asObservable());try{t=s.innerFrom(e())}catch(e){return void u(e)}t.subscribe(a=o.createOperatorSubscriber(n,c,c,u))};c(),t.subscribe(o.createOperatorSubscriber(n,(function(e){return i.next(e)}),(function(){i.complete(),n.complete()}),u,(function(){null==a||a.unsubscribe(),i=null})))}))}},93978:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.withLatestFrom=void 0;var o=n(80215),s=n(96603),a=n(88415),u=n(79546),c=n(96008),l=n(59342);t.withLatestFrom=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=l.popResultSelector(e);return o.operate((function(t,o){for(var l=e.length,h=new Array(l),d=e.map((function(){return!1})),f=!1,p=function(t){a.innerFrom(e[t]).subscribe(s.createOperatorSubscriber(o,(function(e){h[t]=e,f||d[t]||(d[t]=!0,(f=d.every(u.identity))&&(d=null))}),c.noop))},m=0;m<l;m++)p(m);t.subscribe(s.createOperatorSubscriber(o,(function(e){if(f){var t=i([e],r(h));o.next(n?n.apply(void 0,i([],r(t))):t)}})))}))}},86215:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.zip=void 0;var o=n(30888),s=n(80215);t.zip=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.operate((function(t,n){o.zip.apply(void 0,i([t],r(e))).subscribe(n)}))}},83380:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipAll=void 0;var r=n(30888),i=n(92459);t.zipAll=function(e){return i.joinAllInternals(r.zip,e)}},38815:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.zipWith=void 0;var o=n(86215);t.zipWith=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.zip.apply(void 0,i([],r(e)))}},38071:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scheduleArray=void 0;var r=n(44623);t.scheduleArray=function(e,t){return new r.Observable((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}},30815:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scheduleAsyncIterable=void 0;var r=n(44623),i=n(45752);t.scheduleAsyncIterable=function(e,t){if(!e)throw new Error("Iterable cannot be null");return new r.Observable((function(n){i.executeSchedule(n,t,(function(){var r=e[Symbol.asyncIterator]();i.executeSchedule(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}},31463:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scheduleIterable=void 0;var r=n(44623),i=n(36617),o=n(23795),s=n(45752);t.scheduleIterable=function(e,t){return new r.Observable((function(n){var r;return s.executeSchedule(n,t,(function(){r=e[i.iterator](),s.executeSchedule(n,t,(function(){var e,t,i;try{t=(e=r.next()).value,i=e.done}catch(e){return void n.error(e)}i?n.complete():n.next(t)}),0,!0)})),function(){return o.isFunction(null==r?void 0:r.return)&&r.return()}}))}},61469:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scheduleObservable=void 0;var r=n(88415),i=n(8987),o=n(45189);t.scheduleObservable=function(e,t){return r.innerFrom(e).pipe(o.subscribeOn(t),i.observeOn(t))}},85435:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.schedulePromise=void 0;var r=n(88415),i=n(8987),o=n(45189);t.schedulePromise=function(e,t){return r.innerFrom(e).pipe(o.subscribeOn(t),i.observeOn(t))}},71400:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scheduleReadableStreamLike=void 0;var r=n(30815),i=n(73476);t.scheduleReadableStreamLike=function(e,t){return r.scheduleAsyncIterable(i.readableStreamLikeToAsyncGenerator(e),t)}},54363:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scheduled=void 0;var r=n(61469),i=n(85435),o=n(38071),s=n(31463),a=n(30815),u=n(45667),c=n(1671),l=n(61329),h=n(49616),d=n(27037),f=n(81885),p=n(73476),m=n(71400);t.scheduled=function(e,t){if(null!=e){if(u.isInteropObservable(e))return r.scheduleObservable(e,t);if(l.isArrayLike(e))return o.scheduleArray(e,t);if(c.isPromise(e))return i.schedulePromise(e,t);if(d.isAsyncIterable(e))return a.scheduleAsyncIterable(e,t);if(h.isIterable(e))return s.scheduleIterable(e,t);if(p.isReadableStreamLike(e))return m.scheduleReadableStreamLike(e,t)}throw f.createInvalidObservableTypeError(e)}},79552:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.Action=void 0;var o=function(e){function t(t,n){return e.call(this)||this}return i(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(n(62032).Subscription);t.Action=o},4169:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AnimationFrameAction=void 0;var o=n(91125),s=n(63305),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return i(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t._scheduled||(t._scheduled=s.animationFrameProvider.requestAnimationFrame((function(){return t.flush(void 0)}))))},t.prototype.recycleAsyncId=function(t,n,r){var i;if(void 0===r&&(r=0),null!=r?r>0:this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);var o=t.actions;null!=n&&(null===(i=o[o.length-1])||void 0===i?void 0:i.id)!==n&&(s.animationFrameProvider.cancelAnimationFrame(n),t._scheduled=void 0)},t}(o.AsyncAction);t.AnimationFrameAction=a},3104:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AnimationFrameScheduler=void 0;var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.flush=function(e){this._active=!0;var t=this._scheduled;this._scheduled=void 0;var n,r=this.actions;e=e||r.shift();do{if(n=e.execute(e.state,e.delay))break}while((e=r[0])&&e.id===t&&r.shift());if(this._active=!1,n){for(;(e=r[0])&&e.id===t&&r.shift();)e.unsubscribe();throw n}},t}(n(9377).AsyncScheduler);t.AnimationFrameScheduler=o},4346:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AsapAction=void 0;var o=n(91125),s=n(18396),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return i(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t._scheduled||(t._scheduled=s.immediateProvider.setImmediate(t.flush.bind(t,void 0))))},t.prototype.recycleAsyncId=function(t,n,r){var i;if(void 0===r&&(r=0),null!=r?r>0:this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);var o=t.actions;null!=n&&(null===(i=o[o.length-1])||void 0===i?void 0:i.id)!==n&&(s.immediateProvider.clearImmediate(n),t._scheduled===n&&(t._scheduled=void 0))},t}(o.AsyncAction);t.AsapAction=a},61003:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AsapScheduler=void 0;var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.flush=function(e){this._active=!0;var t=this._scheduled;this._scheduled=void 0;var n,r=this.actions;e=e||r.shift();do{if(n=e.execute(e.state,e.delay))break}while((e=r[0])&&e.id===t&&r.shift());if(this._active=!1,n){for(;(e=r[0])&&e.id===t&&r.shift();)e.unsubscribe();throw n}},t}(n(9377).AsyncScheduler);t.AsapScheduler=o},91125:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncAction=void 0;var o=n(79552),s=n(67448),a=n(51458),u=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return i(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),s.intervalProvider.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&s.intervalProvider.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,a.arrRemove(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(o.Action);t.AsyncAction=u},9377:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncScheduler=void 0;var o=n(8786),s=function(e){function t(t,n){void 0===n&&(n=o.Scheduler.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return i(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(o.Scheduler);t.AsyncScheduler=s},24233:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.QueueAction=void 0;var o=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return i(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!=r&&r>0||null==r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.flush(this),0)},t}(n(91125).AsyncAction);t.QueueAction=o},22887:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.QueueScheduler=void 0;var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(n(9377).AsyncScheduler);t.QueueScheduler=o},87411:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.VirtualAction=t.VirtualTimeScheduler=void 0;var o=n(91125),s=n(62032),a=function(e){function t(t,n){void 0===t&&(t=u),void 0===n&&(n=1/0);var r=e.call(this,t,(function(){return r.frame}))||this;return r.maxFrames=n,r.frame=0,r.index=-1,r}return i(t,e),t.prototype.flush=function(){for(var e,t,n=this.actions,r=this.maxFrames;(t=n[0])&&t.delay<=r&&(n.shift(),this.frame=t.delay,!(e=t.execute(t.state,t.delay))););if(e){for(;t=n.shift();)t.unsubscribe();throw e}},t.frameTimeFactor=10,t}(n(9377).AsyncScheduler);t.VirtualTimeScheduler=a;var u=function(e){function t(t,n,r){void 0===r&&(r=t.index+=1);var i=e.call(this,t,n)||this;return i.scheduler=t,i.work=n,i.index=r,i.active=!0,i.index=t.index=r,i}return i(t,e),t.prototype.schedule=function(n,r){if(void 0===r&&(r=0),Number.isFinite(r)){if(!this.id)return e.prototype.schedule.call(this,n,r);this.active=!1;var i=new t(this.scheduler,this.work);return this.add(i),i.schedule(n,r)}return s.Subscription.EMPTY},t.prototype.requestAsyncId=function(e,n,r){void 0===r&&(r=0),this.delay=e.frame+r;var i=e.actions;return i.push(this),i.sort(t.sortActions),1},t.prototype.recycleAsyncId=function(e,t,n){void 0===n&&(n=0)},t.prototype._execute=function(t,n){if(!0===this.active)return e.prototype._execute.call(this,t,n)},t.sortActions=function(e,t){return e.delay===t.delay?e.index===t.index?0:e.index>t.index?1:-1:e.delay>t.delay?1:-1},t}(o.AsyncAction);t.VirtualAction=u},69503:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.animationFrame=t.animationFrameScheduler=void 0;var r=n(4169),i=n(3104);t.animationFrameScheduler=new i.AnimationFrameScheduler(r.AnimationFrameAction),t.animationFrame=t.animationFrameScheduler},63305:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.animationFrameProvider=void 0;var o=n(62032);t.animationFrameProvider={schedule:function(e){var n=requestAnimationFrame,r=cancelAnimationFrame,i=t.animationFrameProvider.delegate;i&&(n=i.requestAnimationFrame,r=i.cancelAnimationFrame);var s=n((function(t){r=void 0,e(t)}));return new o.Subscription((function(){return null==r?void 0:r(s)}))},requestAnimationFrame:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=t.animationFrameProvider.delegate;return((null==o?void 0:o.requestAnimationFrame)||requestAnimationFrame).apply(void 0,i([],r(e)))},cancelAnimationFrame:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=t.animationFrameProvider.delegate;return((null==o?void 0:o.cancelAnimationFrame)||cancelAnimationFrame).apply(void 0,i([],r(e)))},delegate:void 0}},2418:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asap=t.asapScheduler=void 0;var r=n(4346),i=n(61003);t.asapScheduler=new i.AsapScheduler(r.AsapAction),t.asap=t.asapScheduler},42342:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.async=t.asyncScheduler=void 0;var r=n(91125),i=n(9377);t.asyncScheduler=new i.AsyncScheduler(r.AsyncAction),t.async=t.asyncScheduler},57762:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dateTimestampProvider=void 0,t.dateTimestampProvider={now:function(){return(t.dateTimestampProvider.delegate||Date).now()},delegate:void 0}},18396:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.immediateProvider=void 0;var o=n(39376),s=o.Immediate.setImmediate,a=o.Immediate.clearImmediate;t.immediateProvider={setImmediate:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var o=t.immediateProvider.delegate;return((null==o?void 0:o.setImmediate)||s).apply(void 0,i([],r(e)))},clearImmediate:function(e){var n=t.immediateProvider.delegate;return((null==n?void 0:n.clearImmediate)||a)(e)},delegate:void 0}},67448:function(e,t){"use strict";var n=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},r=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.intervalProvider=void 0,t.intervalProvider={setInterval:function(e,i){for(var o=[],s=2;s<arguments.length;s++)o[s-2]=arguments[s];var a=t.intervalProvider.delegate;return(null==a?void 0:a.setInterval)?a.setInterval.apply(a,r([e,i],n(o))):setInterval.apply(void 0,r([e,i],n(o)))},clearInterval:function(e){var n=t.intervalProvider.delegate;return((null==n?void 0:n.clearInterval)||clearInterval)(e)},delegate:void 0}},54858:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.performanceTimestampProvider=void 0,t.performanceTimestampProvider={now:function(){return(t.performanceTimestampProvider.delegate||performance).now()},delegate:void 0}},19064:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queue=t.queueScheduler=void 0;var r=n(24233),i=n(22887);t.queueScheduler=new i.QueueScheduler(r.QueueAction),t.queue=t.queueScheduler},69985:function(e,t){"use strict";var n=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},r=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.timeoutProvider=void 0,t.timeoutProvider={setTimeout:function(e,i){for(var o=[],s=2;s<arguments.length;s++)o[s-2]=arguments[s];var a=t.timeoutProvider.delegate;return(null==a?void 0:a.setTimeout)?a.setTimeout.apply(a,r([e,i],n(o))):setTimeout.apply(void 0,r([e,i],n(o)))},clearTimeout:function(e){var n=t.timeoutProvider.delegate;return((null==n?void 0:n.clearTimeout)||clearTimeout)(e)},delegate:void 0}},36617:function(e,t){"use strict";function n(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}Object.defineProperty(t,"__esModule",{value:!0}),t.iterator=t.getSymbolIterator=void 0,t.getSymbolIterator=n,t.iterator=n()},70552:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.observable=void 0,t.observable="function"==typeof Symbol&&Symbol.observable||"@@observable"},56310:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},31507:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArgumentOutOfRangeError=void 0;var r=n(21009);t.ArgumentOutOfRangeError=r.createErrorClass((function(e){return function(){e(this),this.name="ArgumentOutOfRangeError",this.message="argument out of range"}}))},10683:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyError=void 0;var r=n(21009);t.EmptyError=r.createErrorClass((function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}}))},39376:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TestTools=t.Immediate=void 0;var n,r=1,i={};function o(e){return e in i&&(delete i[e],!0)}t.Immediate={setImmediate:function(e){var t=r++;return i[t]=!0,n||(n=Promise.resolve()),n.then((function(){return o(t)&&e()})),t},clearImmediate:function(e){o(e)}},t.TestTools={pending:function(){return Object.keys(i).length}}},63240:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotFoundError=void 0;var r=n(21009);t.NotFoundError=r.createErrorClass((function(e){return function(t){e(this),this.name="NotFoundError",this.message=t}}))},87237:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectUnsubscribedError=void 0;var r=n(21009);t.ObjectUnsubscribedError=r.createErrorClass((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}))},50868:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SequenceError=void 0;var r=n(21009);t.SequenceError=r.createErrorClass((function(e){return function(t){e(this),this.name="SequenceError",this.message=t}}))},33205:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnsubscriptionError=void 0;var r=n(21009);t.UnsubscriptionError=r.createErrorClass((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}))},59342:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.popNumber=t.popScheduler=t.popResultSelector=void 0;var r=n(23795),i=n(50387);function o(e){return e[e.length-1]}t.popResultSelector=function(e){return r.isFunction(o(e))?e.pop():void 0},t.popScheduler=function(e){return i.isScheduler(o(e))?e.pop():void 0},t.popNumber=function(e,t){return"number"==typeof o(e)?e.pop():t}},91117:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.argsArgArrayOrObject=void 0;var n=Array.isArray,r=Object.getPrototypeOf,i=Object.prototype,o=Object.keys;t.argsArgArrayOrObject=function(e){if(1===e.length){var t=e[0];if(n(t))return{args:t,keys:null};if((a=t)&&"object"==typeof a&&r(a)===i){var s=o(t);return{args:s.map((function(e){return t[e]})),keys:s}}}var a;return{args:e,keys:null}}},41906:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.argsOrArgArray=void 0;var n=Array.isArray;t.argsOrArgArray=function(e){return 1===e.length&&n(e[0])?e[0]:e}},51458:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrRemove=void 0,t.arrRemove=function(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}},21009:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createErrorClass=void 0,t.createErrorClass=function(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}},58405:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createObject=void 0,t.createObject=function(e,t){return e.reduce((function(e,n,r){return e[n]=t[r],e}),{})}},22766:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.captureError=t.errorContext=void 0;var r=n(15656),i=null;t.errorContext=function(e){if(r.config.useDeprecatedSynchronousErrorHandling){var t=!i;if(t&&(i={errorThrown:!1,error:null}),e(),t){var n=i,o=n.errorThrown,s=n.error;if(i=null,o)throw s}}else e()},t.captureError=function(e){r.config.useDeprecatedSynchronousErrorHandling&&i&&(i.errorThrown=!0,i.error=e)}},45752:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.executeSchedule=void 0,t.executeSchedule=function(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var o=t.schedule((function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(o),!i)return o}},79546:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.identity=void 0,t.identity=function(e){return e}},61329:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isArrayLike=void 0,t.isArrayLike=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}},27037:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAsyncIterable=void 0;var r=n(23795);t.isAsyncIterable=function(e){return Symbol.asyncIterator&&r.isFunction(null==e?void 0:e[Symbol.asyncIterator])}},74185:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidDate=void 0,t.isValidDate=function(e){return e instanceof Date&&!isNaN(e)}},23795:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFunction=void 0,t.isFunction=function(e){return"function"==typeof e}},45667:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isInteropObservable=void 0;var r=n(70552),i=n(23795);t.isInteropObservable=function(e){return i.isFunction(e[r.observable])}},49616:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isIterable=void 0;var r=n(36617),i=n(23795);t.isIterable=function(e){return i.isFunction(null==e?void 0:e[r.iterator])}},56275:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isObservable=void 0;var r=n(44623),i=n(23795);t.isObservable=function(e){return!!e&&(e instanceof r.Observable||i.isFunction(e.lift)&&i.isFunction(e.subscribe))}},1671:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPromise=void 0;var r=n(23795);t.isPromise=function(e){return r.isFunction(null==e?void 0:e.then)}},73476:function(e,t,n){"use strict";var r=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},i=this&&this.__await||function(e){return this instanceof i?(this.v=e,this):new i(e)},o=this&&this.__asyncGenerator||function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),s=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){s.push([e,t,n,r])>1||u(e,t)}))})}function u(e,t){try{(n=o[e](t)).value instanceof i?Promise.resolve(n.value.v).then(c,l):h(s[0][2],n)}catch(e){h(s[0][3],e)}var n}function c(e){u("next",e)}function l(e){u("throw",e)}function h(e,t){e(t),s.shift(),s.length&&u(s[0][0],s[0][1])}};Object.defineProperty(t,"__esModule",{value:!0}),t.isReadableStreamLike=t.readableStreamLikeToAsyncGenerator=void 0;var s=n(23795);t.readableStreamLikeToAsyncGenerator=function(e){return o(this,arguments,(function(){var t,n,o;return r(this,(function(r){switch(r.label){case 0:t=e.getReader(),r.label=1;case 1:r.trys.push([1,,9,10]),r.label=2;case 2:return[4,i(t.read())];case 3:return n=r.sent(),o=n.value,n.done?[4,i(void 0)]:[3,5];case 4:return[2,r.sent()];case 5:return[4,i(o)];case 6:return[4,r.sent()];case 7:return r.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))},t.isReadableStreamLike=function(e){return s.isFunction(null==e?void 0:e.getReader)}},50387:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isScheduler=void 0;var r=n(23795);t.isScheduler=function(e){return e&&r.isFunction(e.schedule)}},80215:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.operate=t.hasLift=void 0;var r=n(23795);function i(e){return r.isFunction(null==e?void 0:e.lift)}t.hasLift=i,t.operate=function(e){return function(t){if(i(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}},62571:function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.mapOneOrManyArgs=void 0;var o=n(74633),s=Array.isArray;t.mapOneOrManyArgs=function(e){return o.map((function(t){return function(e,t){return s(t)?e.apply(void 0,i([],r(t))):e(t)}(e,t)}))}},96008:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.noop=void 0,t.noop=function(){}},40642:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.not=void 0,t.not=function(e,t){return function(n,r){return!e.call(t,n,r)}}},52294:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pipeFromArray=t.pipe=void 0;var r=n(79546);function i(e){return 0===e.length?r.identity:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}t.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i(e)},t.pipeFromArray=i},3423:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reportUnhandledError=void 0;var r=n(15656),i=n(69985);t.reportUnhandledError=function(e){i.timeoutProvider.setTimeout((function(){var t=r.config.onUnhandledError;if(!t)throw e;t(e)}))}},81885:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createInvalidObservableTypeError=void 0,t.createInvalidObservableTypeError=function(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}},7455:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeAll=t.merge=t.max=t.materialize=t.mapTo=t.map=t.last=t.isEmpty=t.ignoreElements=t.groupBy=t.first=t.findIndex=t.find=t.finalize=t.filter=t.expand=t.exhaustMap=t.exhaustAll=t.exhaust=t.every=t.endWith=t.elementAt=t.distinctUntilKeyChanged=t.distinctUntilChanged=t.distinct=t.dematerialize=t.delayWhen=t.delay=t.defaultIfEmpty=t.debounceTime=t.debounce=t.count=t.connect=t.concatWith=t.concatMapTo=t.concatMap=t.concatAll=t.concat=t.combineLatestWith=t.combineLatest=t.combineLatestAll=t.combineAll=t.catchError=t.bufferWhen=t.bufferToggle=t.bufferTime=t.bufferCount=t.buffer=t.auditTime=t.audit=void 0,t.timeInterval=t.throwIfEmpty=t.throttleTime=t.throttle=t.tap=t.takeWhile=t.takeUntil=t.takeLast=t.take=t.switchScan=t.switchMapTo=t.switchMap=t.switchAll=t.subscribeOn=t.startWith=t.skipWhile=t.skipUntil=t.skipLast=t.skip=t.single=t.shareReplay=t.share=t.sequenceEqual=t.scan=t.sampleTime=t.sample=t.refCount=t.retryWhen=t.retry=t.repeatWhen=t.repeat=t.reduce=t.raceWith=t.race=t.publishReplay=t.publishLast=t.publishBehavior=t.publish=t.pluck=t.partition=t.pairwise=t.onErrorResumeNext=t.observeOn=t.multicast=t.min=t.mergeWith=t.mergeScan=t.mergeMapTo=t.mergeMap=t.flatMap=void 0,t.zipWith=t.zipAll=t.zip=t.withLatestFrom=t.windowWhen=t.windowToggle=t.windowTime=t.windowCount=t.window=t.toArray=t.timestamp=t.timeoutWith=t.timeout=void 0;var r=n(49395);Object.defineProperty(t,"audit",{enumerable:!0,get:function(){return r.audit}});var i=n(97380);Object.defineProperty(t,"auditTime",{enumerable:!0,get:function(){return i.auditTime}});var o=n(60366);Object.defineProperty(t,"buffer",{enumerable:!0,get:function(){return o.buffer}});var s=n(72847);Object.defineProperty(t,"bufferCount",{enumerable:!0,get:function(){return s.bufferCount}});var a=n(7914);Object.defineProperty(t,"bufferTime",{enumerable:!0,get:function(){return a.bufferTime}});var u=n(99347);Object.defineProperty(t,"bufferToggle",{enumerable:!0,get:function(){return u.bufferToggle}});var c=n(9901);Object.defineProperty(t,"bufferWhen",{enumerable:!0,get:function(){return c.bufferWhen}});var l=n(26324);Object.defineProperty(t,"catchError",{enumerable:!0,get:function(){return l.catchError}});var h=n(46564);Object.defineProperty(t,"combineAll",{enumerable:!0,get:function(){return h.combineAll}});var d=n(60681);Object.defineProperty(t,"combineLatestAll",{enumerable:!0,get:function(){return d.combineLatestAll}});var f=n(73504);Object.defineProperty(t,"combineLatest",{enumerable:!0,get:function(){return f.combineLatest}});var p=n(16014);Object.defineProperty(t,"combineLatestWith",{enumerable:!0,get:function(){return p.combineLatestWith}});var m=n(2411);Object.defineProperty(t,"concat",{enumerable:!0,get:function(){return m.concat}});var g=n(89371);Object.defineProperty(t,"concatAll",{enumerable:!0,get:function(){return g.concatAll}});var v=n(20929);Object.defineProperty(t,"concatMap",{enumerable:!0,get:function(){return v.concatMap}});var y=n(1394);Object.defineProperty(t,"concatMapTo",{enumerable:!0,get:function(){return y.concatMapTo}});var b=n(7695);Object.defineProperty(t,"concatWith",{enumerable:!0,get:function(){return b.concatWith}});var _=n(82602);Object.defineProperty(t,"connect",{enumerable:!0,get:function(){return _.connect}});var x=n(31727);Object.defineProperty(t,"count",{enumerable:!0,get:function(){return x.count}});var w=n(3475);Object.defineProperty(t,"debounce",{enumerable:!0,get:function(){return w.debounce}});var S=n(97146);Object.defineProperty(t,"debounceTime",{enumerable:!0,get:function(){return S.debounceTime}});var E=n(23931);Object.defineProperty(t,"defaultIfEmpty",{enumerable:!0,get:function(){return E.defaultIfEmpty}});var T=n(7165);Object.defineProperty(t,"delay",{enumerable:!0,get:function(){return T.delay}});var M=n(14002);Object.defineProperty(t,"delayWhen",{enumerable:!0,get:function(){return M.delayWhen}});var A=n(85760);Object.defineProperty(t,"dematerialize",{enumerable:!0,get:function(){return A.dematerialize}});var C=n(78160);Object.defineProperty(t,"distinct",{enumerable:!0,get:function(){return C.distinct}});var O=n(9280);Object.defineProperty(t,"distinctUntilChanged",{enumerable:!0,get:function(){return O.distinctUntilChanged}});var P=n(85358);Object.defineProperty(t,"distinctUntilKeyChanged",{enumerable:!0,get:function(){return P.distinctUntilKeyChanged}});var R=n(76542);Object.defineProperty(t,"elementAt",{enumerable:!0,get:function(){return R.elementAt}});var N=n(41537);Object.defineProperty(t,"endWith",{enumerable:!0,get:function(){return N.endWith}});var I=n(94971);Object.defineProperty(t,"every",{enumerable:!0,get:function(){return I.every}});var k=n(66375);Object.defineProperty(t,"exhaust",{enumerable:!0,get:function(){return k.exhaust}});var D=n(17807);Object.defineProperty(t,"exhaustAll",{enumerable:!0,get:function(){return D.exhaustAll}});var L=n(52339);Object.defineProperty(t,"exhaustMap",{enumerable:!0,get:function(){return L.exhaustMap}});var U=n(94162);Object.defineProperty(t,"expand",{enumerable:!0,get:function(){return U.expand}});var F=n(36870);Object.defineProperty(t,"filter",{enumerable:!0,get:function(){return F.filter}});var B=n(36011);Object.defineProperty(t,"finalize",{enumerable:!0,get:function(){return B.finalize}});var z=n(45575);Object.defineProperty(t,"find",{enumerable:!0,get:function(){return z.find}});var j=n(9031);Object.defineProperty(t,"findIndex",{enumerable:!0,get:function(){return j.findIndex}});var V=n(93133);Object.defineProperty(t,"first",{enumerable:!0,get:function(){return V.first}});var G=n(14307);Object.defineProperty(t,"groupBy",{enumerable:!0,get:function(){return G.groupBy}});var H=n(82746);Object.defineProperty(t,"ignoreElements",{enumerable:!0,get:function(){return H.ignoreElements}});var W=n(39470);Object.defineProperty(t,"isEmpty",{enumerable:!0,get:function(){return W.isEmpty}});var q=n(17424);Object.defineProperty(t,"last",{enumerable:!0,get:function(){return q.last}});var X=n(74633);Object.defineProperty(t,"map",{enumerable:!0,get:function(){return X.map}});var Z=n(61482);Object.defineProperty(t,"mapTo",{enumerable:!0,get:function(){return Z.mapTo}});var $=n(14335);Object.defineProperty(t,"materialize",{enumerable:!0,get:function(){return $.materialize}});var Y=n(34792);Object.defineProperty(t,"max",{enumerable:!0,get:function(){return Y.max}});var K=n(23066);Object.defineProperty(t,"merge",{enumerable:!0,get:function(){return K.merge}});var Q=n(86960);Object.defineProperty(t,"mergeAll",{enumerable:!0,get:function(){return Q.mergeAll}});var J=n(60878);Object.defineProperty(t,"flatMap",{enumerable:!0,get:function(){return J.flatMap}});var ee=n(84096);Object.defineProperty(t,"mergeMap",{enumerable:!0,get:function(){return ee.mergeMap}});var te=n(18611);Object.defineProperty(t,"mergeMapTo",{enumerable:!0,get:function(){return te.mergeMapTo}});var ne=n(19259);Object.defineProperty(t,"mergeScan",{enumerable:!0,get:function(){return ne.mergeScan}});var re=n(61353);Object.defineProperty(t,"mergeWith",{enumerable:!0,get:function(){return re.mergeWith}});var ie=n(33807);Object.defineProperty(t,"min",{enumerable:!0,get:function(){return ie.min}});var oe=n(5912);Object.defineProperty(t,"multicast",{enumerable:!0,get:function(){return oe.multicast}});var se=n(8987);Object.defineProperty(t,"observeOn",{enumerable:!0,get:function(){return se.observeOn}});var ae=n(20555);Object.defineProperty(t,"onErrorResumeNext",{enumerable:!0,get:function(){return ae.onErrorResumeNext}});var ue=n(66821);Object.defineProperty(t,"pairwise",{enumerable:!0,get:function(){return ue.pairwise}});var ce=n(102);Object.defineProperty(t,"partition",{enumerable:!0,get:function(){return ce.partition}});var le=n(70339);Object.defineProperty(t,"pluck",{enumerable:!0,get:function(){return le.pluck}});var he=n(22448);Object.defineProperty(t,"publish",{enumerable:!0,get:function(){return he.publish}});var de=n(6306);Object.defineProperty(t,"publishBehavior",{enumerable:!0,get:function(){return de.publishBehavior}});var fe=n(7161);Object.defineProperty(t,"publishLast",{enumerable:!0,get:function(){return fe.publishLast}});var pe=n(25962);Object.defineProperty(t,"publishReplay",{enumerable:!0,get:function(){return pe.publishReplay}});var me=n(17527);Object.defineProperty(t,"race",{enumerable:!0,get:function(){return me.race}});var ge=n(95391);Object.defineProperty(t,"raceWith",{enumerable:!0,get:function(){return ge.raceWith}});var ve=n(59425);Object.defineProperty(t,"reduce",{enumerable:!0,get:function(){return ve.reduce}});var ye=n(71220);Object.defineProperty(t,"repeat",{enumerable:!0,get:function(){return ye.repeat}});var be=n(42948);Object.defineProperty(t,"repeatWhen",{enumerable:!0,get:function(){return be.repeatWhen}});var _e=n(24590);Object.defineProperty(t,"retry",{enumerable:!0,get:function(){return _e.retry}});var xe=n(91213);Object.defineProperty(t,"retryWhen",{enumerable:!0,get:function(){return xe.retryWhen}});var we=n(56802);Object.defineProperty(t,"refCount",{enumerable:!0,get:function(){return we.refCount}});var Se=n(25152);Object.defineProperty(t,"sample",{enumerable:!0,get:function(){return Se.sample}});var Ee=n(66695);Object.defineProperty(t,"sampleTime",{enumerable:!0,get:function(){return Ee.sampleTime}});var Te=n(99568);Object.defineProperty(t,"scan",{enumerable:!0,get:function(){return Te.scan}});var Me=n(30400);Object.defineProperty(t,"sequenceEqual",{enumerable:!0,get:function(){return Me.sequenceEqual}});var Ae=n(67864);Object.defineProperty(t,"share",{enumerable:!0,get:function(){return Ae.share}});var Ce=n(84487);Object.defineProperty(t,"shareReplay",{enumerable:!0,get:function(){return Ce.shareReplay}});var Oe=n(28448);Object.defineProperty(t,"single",{enumerable:!0,get:function(){return Oe.single}});var Pe=n(96812);Object.defineProperty(t,"skip",{enumerable:!0,get:function(){return Pe.skip}});var Re=n(89115);Object.defineProperty(t,"skipLast",{enumerable:!0,get:function(){return Re.skipLast}});var Ne=n(56892);Object.defineProperty(t,"skipUntil",{enumerable:!0,get:function(){return Ne.skipUntil}});var Ie=n(34958);Object.defineProperty(t,"skipWhile",{enumerable:!0,get:function(){return Ie.skipWhile}});var ke=n(3793);Object.defineProperty(t,"startWith",{enumerable:!0,get:function(){return ke.startWith}});var De=n(45189);Object.defineProperty(t,"subscribeOn",{enumerable:!0,get:function(){return De.subscribeOn}});var Le=n(12390);Object.defineProperty(t,"switchAll",{enumerable:!0,get:function(){return Le.switchAll}});var Ue=n(70511);Object.defineProperty(t,"switchMap",{enumerable:!0,get:function(){return Ue.switchMap}});var Fe=n(22723);Object.defineProperty(t,"switchMapTo",{enumerable:!0,get:function(){return Fe.switchMapTo}});var Be=n(98897);Object.defineProperty(t,"switchScan",{enumerable:!0,get:function(){return Be.switchScan}});var ze=n(23133);Object.defineProperty(t,"take",{enumerable:!0,get:function(){return ze.take}});var je=n(36771);Object.defineProperty(t,"takeLast",{enumerable:!0,get:function(){return je.takeLast}});var Ve=n(38515);Object.defineProperty(t,"takeUntil",{enumerable:!0,get:function(){return Ve.takeUntil}});var Ge=n(5471);Object.defineProperty(t,"takeWhile",{enumerable:!0,get:function(){return Ge.takeWhile}});var He=n(83562);Object.defineProperty(t,"tap",{enumerable:!0,get:function(){return He.tap}});var We=n(11056);Object.defineProperty(t,"throttle",{enumerable:!0,get:function(){return We.throttle}});var qe=n(87981);Object.defineProperty(t,"throttleTime",{enumerable:!0,get:function(){return qe.throttleTime}});var Xe=n(79784);Object.defineProperty(t,"throwIfEmpty",{enumerable:!0,get:function(){return Xe.throwIfEmpty}});var Ze=n(47312);Object.defineProperty(t,"timeInterval",{enumerable:!0,get:function(){return Ze.timeInterval}});var $e=n(13458);Object.defineProperty(t,"timeout",{enumerable:!0,get:function(){return $e.timeout}});var Ye=n(82416);Object.defineProperty(t,"timeoutWith",{enumerable:!0,get:function(){return Ye.timeoutWith}});var Ke=n(68098);Object.defineProperty(t,"timestamp",{enumerable:!0,get:function(){return Ke.timestamp}});var Qe=n(22666);Object.defineProperty(t,"toArray",{enumerable:!0,get:function(){return Qe.toArray}});var Je=n(69227);Object.defineProperty(t,"window",{enumerable:!0,get:function(){return Je.window}});var et=n(64805);Object.defineProperty(t,"windowCount",{enumerable:!0,get:function(){return et.windowCount}});var tt=n(44487);Object.defineProperty(t,"windowTime",{enumerable:!0,get:function(){return tt.windowTime}});var nt=n(45891);Object.defineProperty(t,"windowToggle",{enumerable:!0,get:function(){return nt.windowToggle}});var rt=n(78105);Object.defineProperty(t,"windowWhen",{enumerable:!0,get:function(){return rt.windowWhen}});var it=n(93978);Object.defineProperty(t,"withLatestFrom",{enumerable:!0,get:function(){return it.withLatestFrom}});var ot=n(86215);Object.defineProperty(t,"zip",{enumerable:!0,get:function(){return ot.zip}});var st=n(83380);Object.defineProperty(t,"zipAll",{enumerable:!0,get:function(){return st.zipAll}});var at=n(38815);Object.defineProperty(t,"zipWith",{enumerable:!0,get:function(){return at.zipWith}})},61874:function(e,t,n){var r=n(55872),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=s),s.prototype=Object.create(i.prototype),o(i,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},72699:function(e,t,n){"use strict";var r=n(61874).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=u,this.end=c,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=l,this.end=h,t=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function l(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=s(t[r]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if(i=s(t[r]),i>=0)return i>0&&(e.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if(i=s(t[r]),i>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},79627:function(e,t,n){"use strict";var r=n(50959);var i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=r.useState,s=r.useEffect,a=r.useLayoutEffect,u=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!i(e,n)}catch(e){return!0}}var l="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=o({inst:{value:n,getSnapshot:t}}),i=r[0].inst,l=r[1];return a((function(){i.value=n,i.getSnapshot=t,c(i)&&l({inst:i})}),[e,n,t]),s((function(){return c(i)&&l({inst:i}),e((function(){c(i)&&l({inst:i})}))}),[e]),u(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:l},56550:function(e,t,n){"use strict";var r=n(50959),i=n(87287);var o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=i.useSyncExternalStore,a=r.useRef,u=r.useEffect,c=r.useMemo,l=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var h=a(null);if(null===h.current){var d={hasValue:!1,value:null};h.current=d}else d=h.current;h=c((function(){function e(e){if(!u){if(u=!0,s=e,e=r(e),void 0!==i&&d.hasValue){var t=d.value;if(i(t,e))return a=t}return a=e}if(t=a,o(s,e))return t;var n=r(e);return void 0!==i&&i(t,n)?t:(s=e,a=n)}var s,a,u=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]}),[t,n,r,i]);var f=s(e,h[0],h[1]);return u((function(){d.hasValue=!0,d.value=f}),[f]),l(f),f}},87287:function(e,t,n){"use strict";e.exports=n(79627)},9714:function(e,t,n){"use strict";e.exports=n(56550)},15006:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return u.default}});var r=d(n(66733)),i=d(n(93762)),o=d(n(98845)),s=d(n(60017)),a=d(n(91373)),u=d(n(91952)),c=d(n(3988)),l=d(n(24497)),h=d(n(43816));function d(e){return e&&e.__esModule?e:{default:e}}},9415:function(e,t){"use strict";function n(e){return 14+(e+64>>>9<<4)+1}function r(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function i(e,t,n,i,o,s){return r((a=r(r(t,e),r(i,s)))<<(u=o)|a>>>32-u,n);var a,u}function o(e,t,n,r,o,s,a){return i(t&n|~t&r,e,t,o,s,a)}function s(e,t,n,r,o,s,a){return i(t&r|n&~r,e,t,o,s,a)}function a(e,t,n,r,o,s,a){return i(t^n^r,e,t,o,s,a)}function u(e,t,n,r,o,s,a){return i(n^(t|~r),e,t,o,s,a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){const t=[],n=32*e.length,r="0123456789abcdef";for(let i=0;i<n;i+=8){const n=e[i>>5]>>>i%32&255,o=parseInt(r.charAt(n>>>4&15)+r.charAt(15&n),16);t.push(o)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[n(t)-1]=t;let i=1732584193,c=-271733879,l=-1732584194,h=271733878;for(let t=0;t<e.length;t+=16){const n=i,d=c,f=l,p=h;i=o(i,c,l,h,e[t],7,-680876936),h=o(h,i,c,l,e[t+1],12,-389564586),l=o(l,h,i,c,e[t+2],17,606105819),c=o(c,l,h,i,e[t+3],22,-1044525330),i=o(i,c,l,h,e[t+4],7,-176418897),h=o(h,i,c,l,e[t+5],12,1200080426),l=o(l,h,i,c,e[t+6],17,-1473231341),c=o(c,l,h,i,e[t+7],22,-45705983),i=o(i,c,l,h,e[t+8],7,1770035416),h=o(h,i,c,l,e[t+9],12,-1958414417),l=o(l,h,i,c,e[t+10],17,-42063),c=o(c,l,h,i,e[t+11],22,-1990404162),i=o(i,c,l,h,e[t+12],7,1804603682),h=o(h,i,c,l,e[t+13],12,-40341101),l=o(l,h,i,c,e[t+14],17,-1502002290),c=o(c,l,h,i,e[t+15],22,1236535329),i=s(i,c,l,h,e[t+1],5,-165796510),h=s(h,i,c,l,e[t+6],9,-1069501632),l=s(l,h,i,c,e[t+11],14,643717713),c=s(c,l,h,i,e[t],20,-373897302),i=s(i,c,l,h,e[t+5],5,-701558691),h=s(h,i,c,l,e[t+10],9,38016083),l=s(l,h,i,c,e[t+15],14,-660478335),c=s(c,l,h,i,e[t+4],20,-405537848),i=s(i,c,l,h,e[t+9],5,568446438),h=s(h,i,c,l,e[t+14],9,-1019803690),l=s(l,h,i,c,e[t+3],14,-187363961),c=s(c,l,h,i,e[t+8],20,1163531501),i=s(i,c,l,h,e[t+13],5,-1444681467),h=s(h,i,c,l,e[t+2],9,-51403784),l=s(l,h,i,c,e[t+7],14,1735328473),c=s(c,l,h,i,e[t+12],20,-1926607734),i=a(i,c,l,h,e[t+5],4,-378558),h=a(h,i,c,l,e[t+8],11,-2022574463),l=a(l,h,i,c,e[t+11],16,1839030562),c=a(c,l,h,i,e[t+14],23,-35309556),i=a(i,c,l,h,e[t+1],4,-1530992060),h=a(h,i,c,l,e[t+4],11,1272893353),l=a(l,h,i,c,e[t+7],16,-155497632),c=a(c,l,h,i,e[t+10],23,-1094730640),i=a(i,c,l,h,e[t+13],4,681279174),h=a(h,i,c,l,e[t],11,-358537222),l=a(l,h,i,c,e[t+3],16,-722521979),c=a(c,l,h,i,e[t+6],23,76029189),i=a(i,c,l,h,e[t+9],4,-640364487),h=a(h,i,c,l,e[t+12],11,-421815835),l=a(l,h,i,c,e[t+15],16,530742520),c=a(c,l,h,i,e[t+2],23,-995338651),i=u(i,c,l,h,e[t],6,-198630844),h=u(h,i,c,l,e[t+7],10,1126891415),l=u(l,h,i,c,e[t+14],15,-1416354905),c=u(c,l,h,i,e[t+5],21,-57434055),i=u(i,c,l,h,e[t+12],6,1700485571),h=u(h,i,c,l,e[t+3],10,-1894986606),l=u(l,h,i,c,e[t+10],15,-1051523),c=u(c,l,h,i,e[t+1],21,-2054922799),i=u(i,c,l,h,e[t+8],6,1873313359),h=u(h,i,c,l,e[t+15],10,-30611744),l=u(l,h,i,c,e[t+6],15,-1560198380),c=u(c,l,h,i,e[t+13],21,1309151649),i=u(i,c,l,h,e[t+4],6,-145523070),h=u(h,i,c,l,e[t+11],10,-1120210379),l=u(l,h,i,c,e[t+2],15,718787259),c=u(c,l,h,i,e[t+9],21,-343485551),i=r(i,n),c=r(c,d),l=r(l,f),h=r(h,p)}return[i,c,l,h]}(function(e){if(0===e.length)return[];const t=8*e.length,r=new Uint32Array(n(t));for(let n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))};t.default=c},38445:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};t.default=n},91373:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="00000000-0000-0000-0000-000000000000"},43816:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n(3988))&&r.__esModule?r:{default:r};var o=function(e){if(!(0,i.default)(e))throw TypeError("Invalid UUID");let t;const n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n};t.default=o},43786:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},62063:function(e,t){"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(r)};const r=new Uint8Array(16)},84993:function(e,t){"use strict";function n(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:case 3:return t^n^r;case 2:return t&n^t&r^n&r}}function r(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e){const t=[1518500249,1859775393,2400959708,3395469782],i=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let n=0;n<t.length;++n)e.push(t.charCodeAt(n))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const o=e.length/4+2,s=Math.ceil(o/16),a=new Array(s);for(let t=0;t<s;++t){const n=new Uint32Array(16);for(let r=0;r<16;++r)n[r]=e[64*t+4*r]<<24|e[64*t+4*r+1]<<16|e[64*t+4*r+2]<<8|e[64*t+4*r+3];a[t]=n}a[s-1][14]=8*(e.length-1)/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<s;++e){const o=new Uint32Array(80);for(let t=0;t<16;++t)o[t]=a[e][t];for(let e=16;e<80;++e)o[e]=r(o[e-3]^o[e-8]^o[e-14]^o[e-16],1);let s=i[0],u=i[1],c=i[2],l=i[3],h=i[4];for(let e=0;e<80;++e){const i=Math.floor(e/20),a=r(s,5)+n(i,u,c,l)+h+t[i]+o[e]>>>0;h=l,l=c,c=r(u,30)>>>0,u=s,s=a}i[0]=i[0]+s>>>0,i[1]=i[1]+u>>>0,i[2]=i[2]+c>>>0,i[3]=i[3]+l>>>0,i[4]=i[4]+h>>>0}return[i[0]>>24&255,i[0]>>16&255,i[0]>>8&255,255&i[0],i[1]>>24&255,i[1]>>16&255,i[1]>>8&255,255&i[1],i[2]>>24&255,i[2]>>16&255,i[2]>>8&255,255&i[2],i[3]>>24&255,i[3]>>16&255,i[3]>>8&255,255&i[3],i[4]>>24&255,i[4]>>16&255,i[4]>>8&255,255&i[4]]};t.default=i},24497:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.unsafeStringify=s;var r,i=(r=n(3988))&&r.__esModule?r:{default:r};const o=[];for(let e=0;e<256;++e)o.push((e+256).toString(16).slice(1));function s(e,t=0){return o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]}var a=function(e,t=0){const n=s(e,t);if(!(0,i.default)(n))throw TypeError("Stringified UUID is invalid");return n};t.default=a},66733:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n(62063))&&r.__esModule?r:{default:r},o=n(24497);let s,a,u=0,c=0;var l=function(e,t,n){let r=t&&n||0;const l=t||new Array(16);let h=(e=e||{}).node||s,d=void 0!==e.clockseq?e.clockseq:a;if(null==h||null==d){const t=e.random||(e.rng||i.default)();null==h&&(h=s=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==d&&(d=a=16383&(t[6]<<8|t[7]))}let f=void 0!==e.msecs?e.msecs:Date.now(),p=void 0!==e.nsecs?e.nsecs:c+1;const m=f-u+(p-c)/1e4;if(m<0&&void 0===e.clockseq&&(d=d+1&16383),(m<0||f>u)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=f,c=p,a=d,f+=122192928e5;const g=(1e4*(268435455&f)+p)%4294967296;l[r++]=g>>>24&255,l[r++]=g>>>16&255,l[r++]=g>>>8&255,l[r++]=255&g;const v=f/4294967296*1e4&268435455;l[r++]=v>>>8&255,l[r++]=255&v,l[r++]=v>>>24&15|16,l[r++]=v>>>16&255,l[r++]=d>>>8|128,l[r++]=255&d;for(let e=0;e<6;++e)l[r+e]=h[e];return t||(0,o.unsafeStringify)(l)};t.default=l},93762:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(88340)),i=o(n(9415));function o(e){return e&&e.__esModule?e:{default:e}}var s=(0,r.default)("v3",48,i.default);t.default=s},88340:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0,t.default=function(e,t,n){function r(e,r,s,a){var u;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof r&&(r=(0,o.default)(r)),16!==(null===(u=r)||void 0===u?void 0:u.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+e.length);if(c.set(r),c.set(e,r.length),c=n(c),c[6]=15&c[6]|t,c[8]=63&c[8]|128,s){a=a||0;for(let e=0;e<16;++e)s[a+e]=c[e];return s}return(0,i.unsafeStringify)(c)}try{r.name=e}catch(e){}return r.DNS=s,r.URL=a,r};var r,i=n(24497),o=(r=n(43816))&&r.__esModule?r:{default:r};const s="6ba7b810-9dad-11d1-80b4-00c04fd430c8";t.DNS=s;const a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";t.URL=a},98845:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(n(38445)),i=s(n(62063)),o=n(24497);function s(e){return e&&e.__esModule?e:{default:e}}var a=function(e,t,n){if(r.default.randomUUID&&!t&&!e)return r.default.randomUUID();const s=(e=e||{}).random||(e.rng||i.default)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=s[e];return t}return(0,o.unsafeStringify)(s)};t.default=a},60017:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n(88340)),i=o(n(84993));function o(e){return e&&e.__esModule?e:{default:e}}var s=(0,r.default)("v5",80,i.default);t.default=s},3988:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n(43786))&&r.__esModule?r:{default:r};var o=function(e){return"string"==typeof e&&i.default.test(e)};t.default=o},91952:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,i=(r=n(3988))&&r.__esModule?r:{default:r};var o=function(e){if(!(0,i.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)};t.default=o},62950:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let i;const o=new Uint8Array(16);function s(){if(!i&&(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!i))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(o)}const a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));function u(e,t=0){return a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]}var c=function(e,t,n){if(r.randomUUID&&!t&&!e)return r.randomUUID();const i=(e=e||{}).random||(e.rng||s)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=i[e];return t}return u(i)}},62541:function(e,t,n){var r=n(88353);function i(e){var t,n;function i(t,n){try{var s=e[t](n),a=s.value,u=a instanceof r;Promise.resolve(u?a.v:a).then((function(n){if(u){var r="return"===t?"return":"next";if(!a.k||n.done)return i(r,n);n=e[r](n).value}o(s.done?"return":"normal",n)}),(function(e){i("throw",e)}))}catch(e){o("throw",e)}}function o(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?i(t.key,t.arg):n=null}this._invoke=function(e,r){return new Promise((function(o,s){var a={key:e,arg:r,resolve:o,reject:s,next:null};n?n=n.next=a:(t=n=a,i(e,r))}))},"function"!=typeof e.return&&(this.return=void 0)}i.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},i.prototype.next=function(e){return this._invoke("next",e)},i.prototype.throw=function(e){return this._invoke("throw",e)},i.prototype.return=function(e){return this._invoke("return",e)},e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},88353:function(e){e.exports=function(e,t){this.v=e,this.k=t},e.exports.__esModule=!0,e.exports.default=e.exports},38498:function(e,t,n){var r=n(78770);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},62657:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},56751:function(e,t,n){var r=n(88353);e.exports=function(e){var t={},n=!1;function i(t,i){return n=!0,i=new Promise((function(n){n(e[t](i))})),{done:!1,value:new r(i,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):i("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return i("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):i("return",e)}),t},e.exports.__esModule=!0,e.exports.default=e.exports},75487:function(e){function t(e){function n(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return t=function(e){this.s=e,this.n=e.next},t.prototype={s:null,n:null,next:function(){return n(this.n.apply(this.s,arguments))},return:function(e){var t=this.s.return;return void 0===t?Promise.resolve({value:e,done:!0}):n(t.apply(this.s,arguments))},throw:function(e){var t=this.s.return;return void 0===t?Promise.reject(e):n(t.apply(this.s,arguments))}},new t(e)}e.exports=function(e){var n,r,i,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,i=Symbol.iterator);o--;){if(r&&null!=(n=e[r]))return n.call(e);if(i&&null!=(n=e[i]))return new t(n.call(e));r="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")},e.exports.__esModule=!0,e.exports.default=e.exports},34067:function(e,t,n){var r=n(88353);e.exports=function(e){return new r(e,0)},e.exports.__esModule=!0,e.exports.default=e.exports},44279:function(e,t,n){var r=n(80038),i=n(68919);function o(t,n,s){return i()?(e.exports=o=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=o=function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&r(o,n.prototype),o},e.exports.__esModule=!0,e.exports.default=e.exports),o.apply(null,arguments)}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},335:function(e,t,n){var r=n(31479);e.exports=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw s}}}},e.exports.__esModule=!0,e.exports.default=e.exports},83136:function(e,t,n){var r=n(38836),i=n(68919),o=n(75254);e.exports=function(e){var t=i();return function(){var n,i=r(e);if(t){var s=r(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return o(this,n)}},e.exports.__esModule=!0,e.exports.default=e.exports},38836:function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},21742:function(e,t,n){var r=n(80038);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},18724:function(e){e.exports=function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}},e.exports.__esModule=!0,e.exports.default=e.exports},68919:function(e){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},20698:function(e){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},91162:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},75254:function(e,t,n){var r=n(31759).default,i=n(62657);e.exports=function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},80038:function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},15558:function(e,t,n){var r=n(38498),i=n(20698),o=n(31479),s=n(91162);e.exports=function(e){return r(e)||i(e)||o(e)||s()},e.exports.__esModule=!0,e.exports.default=e.exports},24661:function(e,t,n){var r=n(62541);e.exports=function(e){return function(){return new r(e.apply(this,arguments))}},e.exports.__esModule=!0,e.exports.default=e.exports},53318:function(e,t,n){var r=n(38836),i=n(80038),o=n(18724),s=n(44279);function a(t){var n="function"==typeof Map?new Map:void 0;return e.exports=a=function(e){if(null===e||!o(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return s(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},e.exports.__esModule=!0,e.exports.default=e.exports,a(t)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},19363:function(e,t,n){"use strict";n.d(t,{Z:function(){return qI}});const r="170",i={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},o=0,s=1,a=2,u=3,c=100,l=301,h=302,d=303,f=304,p=306,m=1e3,g=1001,v=1002,y=1003,b=1005,_=1006,x=1007,w=1008,S=1009,E=1010,T=1011,M=1012,A=1013,C=1014,O=1015,P=1016,R=1017,N=1018,I=1020,k=35902,D=1023,L=1026,U=1027,F=1028,B=1029,z=1031,j=1033,V=33776,G=33777,H=33778,W=33779,q=35840,X=35841,Z=35842,$=35843,Y=36196,K=37492,Q=37496,J=37808,ee=37809,te=37810,ne=37811,re=37812,ie=37813,oe=37814,se=37815,ae=37816,ue=37817,ce=37818,le=37819,he=37820,de=37821,fe=36492,pe=36494,me=36495,ge=36284,ve=36285,ye=36286,be=2300,_e=2301,xe=2302,we=2400,Se=2401,Ee=2402,Te="",Me="srgb",Ae="srgb-linear",Ce="linear",Oe="srgb",Pe=7680,Re=35044,Ne="300 es",Ie=2e3,ke=2001;class De{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e);e.target=null}}}const Le=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Ue=1234567;const Fe=Math.PI/180,Be=180/Math.PI;function ze(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Le[255&e]+Le[e>>8&255]+Le[e>>16&255]+Le[e>>24&255]+"-"+Le[255&t]+Le[t>>8&255]+"-"+Le[t>>16&15|64]+Le[t>>24&255]+"-"+Le[63&n|128]+Le[n>>8&255]+"-"+Le[n>>16&255]+Le[n>>24&255]+Le[255&r]+Le[r>>8&255]+Le[r>>16&255]+Le[r>>24&255]).toLowerCase()}function je(e,t,n){return Math.max(t,Math.min(n,e))}function Ve(e,t){return(e%t+t)%t}function Ge(e,t,n){return(1-n)*e+n*t}function He(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function We(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const qe={DEG2RAD:Fe,RAD2DEG:Be,generateUUID:ze,clamp:je,euclideanModulo:Ve,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:Ge,damp:function(e,t,n,r){return Ge(e,t,1-Math.exp(-n*r))},pingpong:function(e,t=1){return t-Math.abs(Ve(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(Ue=e);let t=Ue+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*Fe},radToDeg:function(e){return e*Be},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,i){const o=Math.cos,s=Math.sin,a=o(n/2),u=s(n/2),c=o((t+r)/2),l=s((t+r)/2),h=o((t-r)/2),d=s((t-r)/2),f=o((r-t)/2),p=s((r-t)/2);switch(i){case"XYX":e.set(a*l,u*h,u*d,a*c);break;case"YZY":e.set(u*d,a*l,u*h,a*c);break;case"ZXZ":e.set(u*h,u*d,a*l,a*c);break;case"XZX":e.set(a*l,u*p,u*f,a*c);break;case"YXY":e.set(u*f,a*l,u*p,a*c);break;case"ZYZ":e.set(u*p,u*f,a*l,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},normalize:We,denormalize:He};class Xe{constructor(e=0,t=0){Xe.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(je(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*n-o*r+e.x,this.y=i*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ze{constructor(e,t,n,r,i,o,s,a,u){Ze.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,o,s,a,u)}set(e,t,n,r,i,o,s,a,u){const c=this.elements;return c[0]=e,c[1]=r,c[2]=s,c[3]=t,c[4]=i,c[5]=a,c[6]=n,c[7]=o,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,o=n[0],s=n[3],a=n[6],u=n[1],c=n[4],l=n[7],h=n[2],d=n[5],f=n[8],p=r[0],m=r[3],g=r[6],v=r[1],y=r[4],b=r[7],_=r[2],x=r[5],w=r[8];return i[0]=o*p+s*v+a*_,i[3]=o*m+s*y+a*x,i[6]=o*g+s*b+a*w,i[1]=u*p+c*v+l*_,i[4]=u*m+c*y+l*x,i[7]=u*g+c*b+l*w,i[2]=h*p+d*v+f*_,i[5]=h*m+d*y+f*x,i[8]=h*g+d*b+f*w,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],u=e[7],c=e[8];return t*o*c-t*s*u-n*i*c+n*s*a+r*i*u-r*o*a}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],u=e[7],c=e[8],l=c*o-s*u,h=s*a-c*i,d=u*i-o*a,f=t*l+n*h+r*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);const p=1/f;return e[0]=l*p,e[1]=(r*u-c*n)*p,e[2]=(s*n-r*o)*p,e[3]=h*p,e[4]=(c*t-r*a)*p,e[5]=(r*i-s*t)*p,e[6]=d*p,e[7]=(n*a-u*t)*p,e[8]=(o*t-n*i)*p,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,o,s){const a=Math.cos(i),u=Math.sin(i);return this.set(n*a,n*u,-n*(a*o+u*s)+o+e,-r*u,r*a,-r*(-u*o+a*s)+s+t,0,0,1),this}scale(e,t){return this.premultiply($e.makeScale(e,t)),this}rotate(e){return this.premultiply($e.makeRotation(-e)),this}translate(e,t){return this.premultiply($e.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let e=0;e<9;e++)if(t[e]!==n[e])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const $e=new Ze;function Ye(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function Ke(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function Qe(){const e=Ke("canvas");return e.style.display="block",e}const Je={};function et(e){e in Je||(Je[e]=!0,console.warn(e))}const tt={enabled:!0,workingColorSpace:Ae,spaces:{},convert:function(e,t,n){return!1!==this.enabled&&t!==n&&t&&n?(this.spaces[t].transfer===Oe&&(e.r=nt(e.r),e.g=nt(e.g),e.b=nt(e.b)),this.spaces[t].primaries!==this.spaces[n].primaries&&(e.applyMatrix3(this.spaces[t].toXYZ),e.applyMatrix3(this.spaces[n].fromXYZ)),this.spaces[n].transfer===Oe&&(e.r=rt(e.r),e.g=rt(e.g),e.b=rt(e.b)),e):e},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)},getPrimaries:function(e){return this.spaces[e].primaries},getTransfer:function(e){return e===Te?Ce:this.spaces[e].transfer},getLuminanceCoefficients:function(e,t=this.workingColorSpace){return e.fromArray(this.spaces[t].luminanceCoefficients)},define:function(e){Object.assign(this.spaces,e)},_getMatrix:function(e,t,n){return e.copy(this.spaces[t].toXYZ).multiply(this.spaces[n].fromXYZ)},_getDrawingBufferColorSpace:function(e){return this.spaces[e].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(e=this.workingColorSpace){return this.spaces[e].workingColorSpaceConfig.unpackColorSpace}};function nt(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function rt(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}const it=[.64,.33,.3,.6,.15,.06],ot=[.2126,.7152,.0722],st=[.3127,.329],at=(new Ze).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),ut=(new Ze).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);let ct;tt.define({[Ae]:{primaries:it,whitePoint:st,transfer:Ce,toXYZ:at,fromXYZ:ut,luminanceCoefficients:ot,workingColorSpaceConfig:{unpackColorSpace:Me},outputColorSpaceConfig:{drawingBufferColorSpace:Me}},[Me]:{primaries:it,whitePoint:st,transfer:Oe,toXYZ:at,fromXYZ:ut,luminanceCoefficients:ot,outputColorSpaceConfig:{drawingBufferColorSpace:Me}}});class lt{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===ct&&(ct=Ke("canvas")),ct.width=e.width,ct.height=e.height;const n=ct.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=ct}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=Ke("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let e=0;e<i.length;e++)i[e]=255*nt(i[e]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*nt(t[e]/255)):t[e]=nt(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let ht=0;class dt{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:ht++}),this.uuid=ze(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)r[t].isDataTexture?e.push(ft(r[t].image)):e.push(ft(r[t]))}else e=ft(r);n.url=e}return t||(e.images[this.uuid]=n),n}}function ft(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?lt.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let pt=0;class mt extends De{constructor(e=mt.DEFAULT_IMAGE,t=mt.DEFAULT_MAPPING,n=1001,r=1001,i=1006,o=1008,s=1023,a=1009,u=mt.DEFAULT_ANISOTROPY,c=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:pt++}),this.uuid=ze(),this.name="",this.source=new dt(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=o,this.anisotropy=u,this.format=s,this.internalFormat=null,this.type=a,this.offset=new Xe(0,0),this.repeat=new Xe(1,1),this.center=new Xe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ze,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case m:e.x=e.x-Math.floor(e.x);break;case g:e.x=e.x<0?0:1;break;case v:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case m:e.y=e.y-Math.floor(e.y);break;case g:e.y=e.y<0?0:1;break;case v:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}mt.DEFAULT_IMAGE=null,mt.DEFAULT_MAPPING=300,mt.DEFAULT_ANISOTROPY=1;class gt{constructor(e=0,t=0,n=0,r=1){gt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*i,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const o=.01,s=.1,a=e.elements,u=a[0],c=a[4],l=a[8],h=a[1],d=a[5],f=a[9],p=a[2],m=a[6],g=a[10];if(Math.abs(c-h)<o&&Math.abs(l-p)<o&&Math.abs(f-m)<o){if(Math.abs(c+h)<s&&Math.abs(l+p)<s&&Math.abs(f+m)<s&&Math.abs(u+d+g-3)<s)return this.set(1,0,0,0),this;t=Math.PI;const e=(u+1)/2,a=(d+1)/2,v=(g+1)/2,y=(c+h)/4,b=(l+p)/4,_=(f+m)/4;return e>a&&e>v?e<o?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(e),r=y/n,i=b/n):a>v?a<o?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(a),n=y/r,i=_/r):v<o?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(v),n=b/i,r=_/i),this.set(n,r,i,t),this}let v=Math.sqrt((m-f)*(m-f)+(l-p)*(l-p)+(h-c)*(h-c));return Math.abs(v)<.001&&(v=1),this.x=(m-f)/v,this.y=(l-p)/v,this.z=(h-c)/v,this.w=Math.acos((u+d+g-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class vt extends De{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new gt(0,0,e,t),this.scissorTest=!1,this.viewport=new gt(0,0,e,t);const r={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:_,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const i=new mt(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);i.flipY=!1,i.generateMipmaps=n.generateMipmaps,i.internalFormat=n.internalFormat,this.textures=[];const o=n.count;for(let e=0;e<o;e++)this.textures[e]=i.clone(),this.textures[e].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.textures.length;r<i;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++)this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new dt(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class yt extends vt{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class bt extends mt{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=y,this.minFilter=y,this.wrapR=g,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class _t extends mt{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=y,this.minFilter=y,this.wrapR=g,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class xt{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,o,s){let a=n[r+0],u=n[r+1],c=n[r+2],l=n[r+3];const h=i[o+0],d=i[o+1],f=i[o+2],p=i[o+3];if(0===s)return e[t+0]=a,e[t+1]=u,e[t+2]=c,void(e[t+3]=l);if(1===s)return e[t+0]=h,e[t+1]=d,e[t+2]=f,void(e[t+3]=p);if(l!==p||a!==h||u!==d||c!==f){let e=1-s;const t=a*h+u*d+c*f+l*p,n=t>=0?1:-1,r=1-t*t;if(r>Number.EPSILON){const i=Math.sqrt(r),o=Math.atan2(i,t*n);e=Math.sin(e*o)/i,s=Math.sin(s*o)/i}const i=s*n;if(a=a*e+h*i,u=u*e+d*i,c=c*e+f*i,l=l*e+p*i,e===1-s){const e=1/Math.sqrt(a*a+u*u+c*c+l*l);a*=e,u*=e,c*=e,l*=e}}e[t]=a,e[t+1]=u,e[t+2]=c,e[t+3]=l}static multiplyQuaternionsFlat(e,t,n,r,i,o){const s=n[r],a=n[r+1],u=n[r+2],c=n[r+3],l=i[o],h=i[o+1],d=i[o+2],f=i[o+3];return e[t]=s*f+c*l+a*d-u*h,e[t+1]=a*f+c*h+u*l-s*d,e[t+2]=u*f+c*d+s*h-a*l,e[t+3]=c*f-s*l-a*h-u*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,i=e._z,o=e._order,s=Math.cos,a=Math.sin,u=s(n/2),c=s(r/2),l=s(i/2),h=a(n/2),d=a(r/2),f=a(i/2);switch(o){case"XYZ":this._x=h*c*l+u*d*f,this._y=u*d*l-h*c*f,this._z=u*c*f+h*d*l,this._w=u*c*l-h*d*f;break;case"YXZ":this._x=h*c*l+u*d*f,this._y=u*d*l-h*c*f,this._z=u*c*f-h*d*l,this._w=u*c*l+h*d*f;break;case"ZXY":this._x=h*c*l-u*d*f,this._y=u*d*l+h*c*f,this._z=u*c*f+h*d*l,this._w=u*c*l-h*d*f;break;case"ZYX":this._x=h*c*l-u*d*f,this._y=u*d*l+h*c*f,this._z=u*c*f-h*d*l,this._w=u*c*l+h*d*f;break;case"YZX":this._x=h*c*l+u*d*f,this._y=u*d*l+h*c*f,this._z=u*c*f-h*d*l,this._w=u*c*l-h*d*f;break;case"XZY":this._x=h*c*l-u*d*f,this._y=u*d*l-h*c*f,this._z=u*c*f+h*d*l,this._w=u*c*l+h*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],o=t[1],s=t[5],a=t[9],u=t[2],c=t[6],l=t[10],h=n+s+l;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-a)*e,this._y=(i-u)*e,this._z=(o-r)*e}else if(n>s&&n>l){const e=2*Math.sqrt(1+n-s-l);this._w=(c-a)/e,this._x=.25*e,this._y=(r+o)/e,this._z=(i+u)/e}else if(s>l){const e=2*Math.sqrt(1+s-n-l);this._w=(i-u)/e,this._x=(r+o)/e,this._y=.25*e,this._z=(a+c)/e}else{const e=2*Math.sqrt(1+l-n-s);this._w=(o-r)/e,this._x=(i+u)/e,this._y=(a+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(je(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,o=e._w,s=t._x,a=t._y,u=t._z,c=t._w;return this._x=n*c+o*s+r*u-i*a,this._y=r*c+o*a+i*s-n*u,this._z=i*c+o*u+n*a-r*s,this._w=o*c-n*s-r*a-i*u,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,i=this._z,o=this._w;let s=o*e._w+n*e._x+r*e._y+i*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;const a=1-s*s;if(a<=Number.EPSILON){const e=1-t;return this._w=e*o+t*this._w,this._x=e*n+t*this._x,this._y=e*r+t*this._y,this._z=e*i+t*this._z,this.normalize(),this}const u=Math.sqrt(a),c=Math.atan2(u,s),l=Math.sin((1-t)*c)/u,h=Math.sin(t*c)/u;return this._w=o*l+this._w*h,this._x=n*l+this._x*h,this._y=r*l+this._y*h,this._z=i*l+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class wt{constructor(e=0,t=0,n=0){wt.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Et.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Et.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,o=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,s=e.z,a=e.w,u=2*(o*r-s*n),c=2*(s*t-i*r),l=2*(i*n-o*t);return this.x=t+a*u+o*l-s*c,this.y=n+a*c+s*u-i*l,this.z=r+a*l+i*c-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,o=t.x,s=t.y,a=t.z;return this.x=r*a-i*s,this.y=i*o-n*a,this.z=n*s-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return St.copy(this).projectOnVector(e),this.sub(St)}reflect(e){return this.sub(St.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(je(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const St=new wt,Et=new xt;class Tt{constructor(e=new wt(1/0,1/0,1/0),t=new wt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(At.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(At.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=At.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n){const r=n.getAttribute("position");if(!0===t&&void 0!==r&&!0!==e.isInstancedMesh)for(let t=0,n=r.count;t<n;t++)!0===e.isMesh?e.getVertexPosition(t,At):At.fromBufferAttribute(r,t),At.applyMatrix4(e.matrixWorld),this.expandByPoint(At);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),Ct.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),Ct.copy(n.boundingBox)),Ct.applyMatrix4(e.matrixWorld),this.union(Ct)}const r=e.children;for(let e=0,n=r.length;e<n;e++)this.expandByObject(r[e],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,At),At.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Dt),Lt.subVectors(this.max,Dt),Ot.subVectors(e.a,Dt),Pt.subVectors(e.b,Dt),Rt.subVectors(e.c,Dt),Nt.subVectors(Pt,Ot),It.subVectors(Rt,Pt),kt.subVectors(Ot,Rt);let t=[0,-Nt.z,Nt.y,0,-It.z,It.y,0,-kt.z,kt.y,Nt.z,0,-Nt.x,It.z,0,-It.x,kt.z,0,-kt.x,-Nt.y,Nt.x,0,-It.y,It.x,0,-kt.y,kt.x,0];return!!Bt(t,Ot,Pt,Rt,Lt)&&(t=[1,0,0,0,1,0,0,0,1],!!Bt(t,Ot,Pt,Rt,Lt)&&(Ut.crossVectors(Nt,It),t=[Ut.x,Ut.y,Ut.z],Bt(t,Ot,Pt,Rt,Lt)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,At).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(At).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Mt[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Mt[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Mt[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Mt[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Mt[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Mt[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Mt[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Mt[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Mt)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Mt=[new wt,new wt,new wt,new wt,new wt,new wt,new wt,new wt],At=new wt,Ct=new Tt,Ot=new wt,Pt=new wt,Rt=new wt,Nt=new wt,It=new wt,kt=new wt,Dt=new wt,Lt=new wt,Ut=new wt,Ft=new wt;function Bt(e,t,n,r,i){for(let o=0,s=e.length-3;o<=s;o+=3){Ft.fromArray(e,o);const s=i.x*Math.abs(Ft.x)+i.y*Math.abs(Ft.y)+i.z*Math.abs(Ft.z),a=t.dot(Ft),u=n.dot(Ft),c=r.dot(Ft);if(Math.max(-Math.max(a,u,c),Math.min(a,u,c))>s)return!1}return!0}const zt=new Tt,jt=new wt,Vt=new wt;class Gt{constructor(e=new wt,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):zt.setFromPoints(e).getCenter(n);let r=0;for(let t=0,i=e.length;t<i;t++)r=Math.max(r,n.distanceToSquared(e[t]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;jt.subVectors(e,this.center);const t=jt.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(jt,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Vt.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(jt.copy(e.center).add(Vt)),this.expandByPoint(jt.copy(e.center).sub(Vt))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Ht=new wt,Wt=new wt,qt=new wt,Xt=new wt,Zt=new wt,$t=new wt,Yt=new wt;class Kt{constructor(e=new wt,t=new wt(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ht)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Ht.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Ht.copy(this.origin).addScaledVector(this.direction,t),Ht.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){Wt.copy(e).add(t).multiplyScalar(.5),qt.copy(t).sub(e).normalize(),Xt.copy(this.origin).sub(Wt);const i=.5*e.distanceTo(t),o=-this.direction.dot(qt),s=Xt.dot(this.direction),a=-Xt.dot(qt),u=Xt.lengthSq(),c=Math.abs(1-o*o);let l,h,d,f;if(c>0)if(l=o*a-s,h=o*s-a,f=i*c,l>=0)if(h>=-f)if(h<=f){const e=1/c;l*=e,h*=e,d=l*(l+o*h+2*s)+h*(o*l+h+2*a)+u}else h=i,l=Math.max(0,-(o*h+s)),d=-l*l+h*(h+2*a)+u;else h=-i,l=Math.max(0,-(o*h+s)),d=-l*l+h*(h+2*a)+u;else h<=-f?(l=Math.max(0,-(-o*i+s)),h=l>0?-i:Math.min(Math.max(-i,-a),i),d=-l*l+h*(h+2*a)+u):h<=f?(l=0,h=Math.min(Math.max(-i,-a),i),d=h*(h+2*a)+u):(l=Math.max(0,-(o*i+s)),h=l>0?i:Math.min(Math.max(-i,-a),i),d=-l*l+h*(h+2*a)+u);else h=o>0?-i:i,l=Math.max(0,-(o*h+s)),d=-l*l+h*(h+2*a)+u;return n&&n.copy(this.origin).addScaledVector(this.direction,l),r&&r.copy(Wt).addScaledVector(qt,h),d}intersectSphere(e,t){Ht.subVectors(e.center,this.origin);const n=Ht.dot(this.direction),r=Ht.dot(Ht)-n*n,i=e.radius*e.radius;if(r>i)return null;const o=Math.sqrt(i-r),s=n-o,a=n+o;return a<0?null:s<0?this.at(a,t):this.at(s,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,o,s,a;const u=1/this.direction.x,c=1/this.direction.y,l=1/this.direction.z,h=this.origin;return u>=0?(n=(e.min.x-h.x)*u,r=(e.max.x-h.x)*u):(n=(e.max.x-h.x)*u,r=(e.min.x-h.x)*u),c>=0?(i=(e.min.y-h.y)*c,o=(e.max.y-h.y)*c):(i=(e.max.y-h.y)*c,o=(e.min.y-h.y)*c),n>o||i>r?null:((i>n||isNaN(n))&&(n=i),(o<r||isNaN(r))&&(r=o),l>=0?(s=(e.min.z-h.z)*l,a=(e.max.z-h.z)*l):(s=(e.max.z-h.z)*l,a=(e.min.z-h.z)*l),n>a||s>r?null:((s>n||n!=n)&&(n=s),(a<r||r!=r)&&(r=a),r<0?null:this.at(n>=0?n:r,t)))}intersectsBox(e){return null!==this.intersectBox(e,Ht)}intersectTriangle(e,t,n,r,i){Zt.subVectors(t,e),$t.subVectors(n,e),Yt.crossVectors(Zt,$t);let o,s=this.direction.dot(Yt);if(s>0){if(r)return null;o=1}else{if(!(s<0))return null;o=-1,s=-s}Xt.subVectors(this.origin,e);const a=o*this.direction.dot($t.crossVectors(Xt,$t));if(a<0)return null;const u=o*this.direction.dot(Zt.cross(Xt));if(u<0)return null;if(a+u>s)return null;const c=-o*Xt.dot(Yt);return c<0?null:this.at(c/s,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Qt{constructor(e,t,n,r,i,o,s,a,u,c,l,h,d,f,p,m){Qt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,o,s,a,u,c,l,h,d,f,p,m)}set(e,t,n,r,i,o,s,a,u,c,l,h,d,f,p,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=s,g[13]=a,g[2]=u,g[6]=c,g[10]=l,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Qt).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/Jt.setFromMatrixColumn(e,0).length(),i=1/Jt.setFromMatrixColumn(e,1).length(),o=1/Jt.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,o=Math.cos(n),s=Math.sin(n),a=Math.cos(r),u=Math.sin(r),c=Math.cos(i),l=Math.sin(i);if("XYZ"===e.order){const e=o*c,n=o*l,r=s*c,i=s*l;t[0]=a*c,t[4]=-a*l,t[8]=u,t[1]=n+r*u,t[5]=e-i*u,t[9]=-s*a,t[2]=i-e*u,t[6]=r+n*u,t[10]=o*a}else if("YXZ"===e.order){const e=a*c,n=a*l,r=u*c,i=u*l;t[0]=e+i*s,t[4]=r*s-n,t[8]=o*u,t[1]=o*l,t[5]=o*c,t[9]=-s,t[2]=n*s-r,t[6]=i+e*s,t[10]=o*a}else if("ZXY"===e.order){const e=a*c,n=a*l,r=u*c,i=u*l;t[0]=e-i*s,t[4]=-o*l,t[8]=r+n*s,t[1]=n+r*s,t[5]=o*c,t[9]=i-e*s,t[2]=-o*u,t[6]=s,t[10]=o*a}else if("ZYX"===e.order){const e=o*c,n=o*l,r=s*c,i=s*l;t[0]=a*c,t[4]=r*u-n,t[8]=e*u+i,t[1]=a*l,t[5]=i*u+e,t[9]=n*u-r,t[2]=-u,t[6]=s*a,t[10]=o*a}else if("YZX"===e.order){const e=o*a,n=o*u,r=s*a,i=s*u;t[0]=a*c,t[4]=i-e*l,t[8]=r*l+n,t[1]=l,t[5]=o*c,t[9]=-s*c,t[2]=-u*c,t[6]=n*l+r,t[10]=e-i*l}else if("XZY"===e.order){const e=o*a,n=o*u,r=s*a,i=s*u;t[0]=a*c,t[4]=-l,t[8]=u*c,t[1]=e*l+i,t[5]=o*c,t[9]=n*l-r,t[2]=r*l-n,t[6]=s*c,t[10]=i*l+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(tn,e,nn)}lookAt(e,t,n){const r=this.elements;return sn.subVectors(e,t),0===sn.lengthSq()&&(sn.z=1),sn.normalize(),rn.crossVectors(n,sn),0===rn.lengthSq()&&(1===Math.abs(n.z)?sn.x+=1e-4:sn.z+=1e-4,sn.normalize(),rn.crossVectors(n,sn)),rn.normalize(),on.crossVectors(sn,rn),r[0]=rn.x,r[4]=on.x,r[8]=sn.x,r[1]=rn.y,r[5]=on.y,r[9]=sn.y,r[2]=rn.z,r[6]=on.z,r[10]=sn.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,o=n[0],s=n[4],a=n[8],u=n[12],c=n[1],l=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],b=n[11],_=n[15],x=r[0],w=r[4],S=r[8],E=r[12],T=r[1],M=r[5],A=r[9],C=r[13],O=r[2],P=r[6],R=r[10],N=r[14],I=r[3],k=r[7],D=r[11],L=r[15];return i[0]=o*x+s*T+a*O+u*I,i[4]=o*w+s*M+a*P+u*k,i[8]=o*S+s*A+a*R+u*D,i[12]=o*E+s*C+a*N+u*L,i[1]=c*x+l*T+h*O+d*I,i[5]=c*w+l*M+h*P+d*k,i[9]=c*S+l*A+h*R+d*D,i[13]=c*E+l*C+h*N+d*L,i[2]=f*x+p*T+m*O+g*I,i[6]=f*w+p*M+m*P+g*k,i[10]=f*S+p*A+m*R+g*D,i[14]=f*E+p*C+m*N+g*L,i[3]=v*x+y*T+b*O+_*I,i[7]=v*w+y*M+b*P+_*k,i[11]=v*S+y*A+b*R+_*D,i[15]=v*E+y*C+b*N+_*L,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],o=e[1],s=e[5],a=e[9],u=e[13],c=e[2],l=e[6],h=e[10],d=e[14];return e[3]*(+i*a*l-r*u*l-i*s*h+n*u*h+r*s*d-n*a*d)+e[7]*(+t*a*d-t*u*h+i*o*h-r*o*d+r*u*c-i*a*c)+e[11]*(+t*u*l-t*s*d-i*o*l+n*o*d+i*s*c-n*u*c)+e[15]*(-r*s*c-t*a*l+t*s*h+r*o*l-n*o*h+n*a*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],u=e[7],c=e[8],l=e[9],h=e[10],d=e[11],f=e[12],p=e[13],m=e[14],g=e[15],v=l*m*u-p*h*u+p*a*d-s*m*d-l*a*g+s*h*g,y=f*h*u-c*m*u-f*a*d+o*m*d+c*a*g-o*h*g,b=c*p*u-f*l*u+f*s*d-o*p*d-c*s*g+o*l*g,_=f*l*a-c*p*a-f*s*h+o*p*h+c*s*m-o*l*m,x=t*v+n*y+r*b+i*_;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/x;return e[0]=v*w,e[1]=(p*h*i-l*m*i-p*r*d+n*m*d+l*r*g-n*h*g)*w,e[2]=(s*m*i-p*a*i+p*r*u-n*m*u-s*r*g+n*a*g)*w,e[3]=(l*a*i-s*h*i-l*r*u+n*h*u+s*r*d-n*a*d)*w,e[4]=y*w,e[5]=(c*m*i-f*h*i+f*r*d-t*m*d-c*r*g+t*h*g)*w,e[6]=(f*a*i-o*m*i-f*r*u+t*m*u+o*r*g-t*a*g)*w,e[7]=(o*h*i-c*a*i+c*r*u-t*h*u-o*r*d+t*a*d)*w,e[8]=b*w,e[9]=(f*l*i-c*p*i-f*n*d+t*p*d+c*n*g-t*l*g)*w,e[10]=(o*p*i-f*s*i+f*n*u-t*p*u-o*n*g+t*s*g)*w,e[11]=(c*s*i-o*l*i-c*n*u+t*l*u+o*n*d-t*s*d)*w,e[12]=_*w,e[13]=(c*p*r-f*l*r+f*n*h-t*p*h-c*n*m+t*l*m)*w,e[14]=(f*s*r-o*p*r-f*n*a+t*p*a+o*n*m-t*s*m)*w,e[15]=(o*l*r-c*s*r+c*n*a-t*l*a-o*n*h+t*s*h)*w,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,o=e.x,s=e.y,a=e.z,u=i*o,c=i*s;return this.set(u*o+n,u*s-r*a,u*a+r*s,0,u*s+r*a,c*s+n,c*a-r*o,0,u*a-r*s,c*a+r*o,i*a*a+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,o){return this.set(1,n,i,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,o=t._y,s=t._z,a=t._w,u=i+i,c=o+o,l=s+s,h=i*u,d=i*c,f=i*l,p=o*c,m=o*l,g=s*l,v=a*u,y=a*c,b=a*l,_=n.x,x=n.y,w=n.z;return r[0]=(1-(p+g))*_,r[1]=(d+b)*_,r[2]=(f-y)*_,r[3]=0,r[4]=(d-b)*x,r[5]=(1-(h+g))*x,r[6]=(m+v)*x,r[7]=0,r[8]=(f+y)*w,r[9]=(m-v)*w,r[10]=(1-(h+p))*w,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let i=Jt.set(r[0],r[1],r[2]).length();const o=Jt.set(r[4],r[5],r[6]).length(),s=Jt.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],en.copy(this);const a=1/i,u=1/o,c=1/s;return en.elements[0]*=a,en.elements[1]*=a,en.elements[2]*=a,en.elements[4]*=u,en.elements[5]*=u,en.elements[6]*=u,en.elements[8]*=c,en.elements[9]*=c,en.elements[10]*=c,t.setFromRotationMatrix(en),n.x=i,n.y=o,n.z=s,this}makePerspective(e,t,n,r,i,o,s=2e3){const a=this.elements,u=2*i/(t-e),c=2*i/(n-r),l=(t+e)/(t-e),h=(n+r)/(n-r);let d,f;if(s===Ie)d=-(o+i)/(o-i),f=-2*o*i/(o-i);else{if(s!==ke)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);d=-o/(o-i),f=-o*i/(o-i)}return a[0]=u,a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=c,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,r,i,o,s=2e3){const a=this.elements,u=1/(t-e),c=1/(n-r),l=1/(o-i),h=(t+e)*u,d=(n+r)*c;let f,p;if(s===Ie)f=(o+i)*l,p=-2*l;else{if(s!==ke)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);f=i*l,p=-1*l}return a[0]=2*u,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=p,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let e=0;e<16;e++)if(t[e]!==n[e])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Jt=new wt,en=new Qt,tn=new wt(0,0,0),nn=new wt(1,1,1),rn=new wt,on=new wt,sn=new wt,an=new Qt,un=new xt;class cn{constructor(e=0,t=0,n=0,r=cn.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,i=r[0],o=r[4],s=r[8],a=r[1],u=r[5],c=r[9],l=r[2],h=r[6],d=r[10];switch(t){case"XYZ":this._y=Math.asin(je(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(h,u),this._z=0);break;case"YXZ":this._x=Math.asin(-je(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,d),this._z=Math.atan2(a,u)):(this._y=Math.atan2(-l,i),this._z=0);break;case"ZXY":this._x=Math.asin(je(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-l,d),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(a,i));break;case"ZYX":this._y=Math.asin(-je(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,i)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(je(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-l,i)):(this._x=0,this._y=Math.atan2(s,d));break;case"XZY":this._z=Math.asin(-je(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,u),this._y=Math.atan2(s,i)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return an.makeRotationFromQuaternion(e),this.setFromRotationMatrix(an,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return un.setFromEuler(this),this.setFromQuaternion(un,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}cn.DEFAULT_ORDER="XYZ";class ln{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let hn=0;const dn=new wt,fn=new xt,pn=new Qt,mn=new wt,gn=new wt,vn=new wt,yn=new xt,bn=new wt(1,0,0),_n=new wt(0,1,0),xn=new wt(0,0,1),wn={type:"added"},Sn={type:"removed"},En={type:"childadded",child:null},Tn={type:"childremoved",child:null};class Mn extends De{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:hn++}),this.uuid=ze(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Mn.DEFAULT_UP.clone();const e=new wt,t=new cn,n=new xt,r=new wt(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Qt},normalMatrix:{value:new Ze}}),this.matrix=new Qt,this.matrixWorld=new Qt,this.matrixAutoUpdate=Mn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Mn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new ln,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return fn.setFromAxisAngle(e,t),this.quaternion.multiply(fn),this}rotateOnWorldAxis(e,t){return fn.setFromAxisAngle(e,t),this.quaternion.premultiply(fn),this}rotateX(e){return this.rotateOnAxis(bn,e)}rotateY(e){return this.rotateOnAxis(_n,e)}rotateZ(e){return this.rotateOnAxis(xn,e)}translateOnAxis(e,t){return dn.copy(e).applyQuaternion(this.quaternion),this.position.add(dn.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(bn,e)}translateY(e){return this.translateOnAxis(_n,e)}translateZ(e){return this.translateOnAxis(xn,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(pn.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?mn.copy(e):mn.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),gn.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?pn.lookAt(gn,mn,this.up):pn.lookAt(mn,gn,this.up),this.quaternion.setFromRotationMatrix(pn),r&&(pn.extractRotation(r.matrixWorld),fn.setFromRotationMatrix(pn),this.quaternion.premultiply(fn.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(wn),En.child=e,this.dispatchEvent(En),En.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Sn),Tn.child=e,this.dispatchEvent(Tn),Tn.child=null),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),pn.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),pn.multiply(e.parent.matrixWorld)),e.applyMatrix4(pn),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(wn),En.child=e,this.dispatchEvent(En),En.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let i=0,o=r.length;i<o;i++)r[i].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gn,e,vn),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gn,yn,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++){t[n].updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++){e[t].updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map((e=>({boxInitialized:e.boxInitialized,boxMin:e.box.min.toArray(),boxMax:e.box.max.toArray(),sphereInitialized:e.sphereInitialized,sphereRadius:e.sphere.radius,sphereCenter:e.sphere.center.toArray()}))),r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),null!==this._colorsTexture&&(r.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),null!==this.boundingBox&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const r=n[t];i(e.shapes,r)}else i(e.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,r=this.material.length;n<r;n++)t.push(i(e.materials,this.material[n]));r.material=t}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let t=0;t<this.children.length;t++)r.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];r.animations.push(i(e.animations,n))}}if(t){const t=o(e.geometries),r=o(e.materials),i=o(e.textures),s=o(e.images),a=o(e.shapes),u=o(e.skeletons),c=o(e.animations),l=o(e.nodes);t.length>0&&(n.geometries=t),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),s.length>0&&(n.images=s),a.length>0&&(n.shapes=a),u.length>0&&(n.skeletons=u),c.length>0&&(n.animations=c),l.length>0&&(n.nodes=l)}return n.object=r,n;function o(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){const n=e.children[t];this.add(n.clone())}return this}}Mn.DEFAULT_UP=new wt(0,1,0),Mn.DEFAULT_MATRIX_AUTO_UPDATE=!0,Mn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const An=new wt,Cn=new wt,On=new wt,Pn=new wt,Rn=new wt,Nn=new wt,In=new wt,kn=new wt,Dn=new wt,Ln=new wt,Un=new gt,Fn=new gt,Bn=new gt;class zn{constructor(e=new wt,t=new wt,n=new wt){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),An.subVectors(e,t),r.cross(An);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){An.subVectors(r,t),Cn.subVectors(n,t),On.subVectors(e,t);const o=An.dot(An),s=An.dot(Cn),a=An.dot(On),u=Cn.dot(Cn),c=Cn.dot(On),l=o*u-s*s;if(0===l)return i.set(0,0,0),null;const h=1/l,d=(u*a-s*c)*h,f=(o*c-s*a)*h;return i.set(1-d-f,f,d)}static containsPoint(e,t,n,r){return null!==this.getBarycoord(e,t,n,r,Pn)&&(Pn.x>=0&&Pn.y>=0&&Pn.x+Pn.y<=1)}static getInterpolation(e,t,n,r,i,o,s,a){return null===this.getBarycoord(e,t,n,r,Pn)?(a.x=0,a.y=0,"z"in a&&(a.z=0),"w"in a&&(a.w=0),null):(a.setScalar(0),a.addScaledVector(i,Pn.x),a.addScaledVector(o,Pn.y),a.addScaledVector(s,Pn.z),a)}static getInterpolatedAttribute(e,t,n,r,i,o){return Un.setScalar(0),Fn.setScalar(0),Bn.setScalar(0),Un.fromBufferAttribute(e,t),Fn.fromBufferAttribute(e,n),Bn.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(Un,i.x),o.addScaledVector(Fn,i.y),o.addScaledVector(Bn,i.z),o}static isFrontFacing(e,t,n,r){return An.subVectors(n,t),Cn.subVectors(e,t),An.cross(Cn).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return An.subVectors(this.c,this.b),Cn.subVectors(this.a,this.b),.5*An.cross(Cn).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return zn.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return zn.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,i){return zn.getInterpolation(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return zn.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return zn.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let o,s;Rn.subVectors(r,n),Nn.subVectors(i,n),kn.subVectors(e,n);const a=Rn.dot(kn),u=Nn.dot(kn);if(a<=0&&u<=0)return t.copy(n);Dn.subVectors(e,r);const c=Rn.dot(Dn),l=Nn.dot(Dn);if(c>=0&&l<=c)return t.copy(r);const h=a*l-c*u;if(h<=0&&a>=0&&c<=0)return o=a/(a-c),t.copy(n).addScaledVector(Rn,o);Ln.subVectors(e,i);const d=Rn.dot(Ln),f=Nn.dot(Ln);if(f>=0&&d<=f)return t.copy(i);const p=d*u-a*f;if(p<=0&&u>=0&&f<=0)return s=u/(u-f),t.copy(n).addScaledVector(Nn,s);const m=c*f-d*l;if(m<=0&&l-c>=0&&d-f>=0)return In.subVectors(i,r),s=(l-c)/(l-c+(d-f)),t.copy(r).addScaledVector(In,s);const g=1/(m+p+h);return o=p*g,s=h*g,t.copy(n).addScaledVector(Rn,o).addScaledVector(Nn,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const jn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Vn={h:0,s:0,l:0},Gn={h:0,s:0,l:0};function Hn(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class Wn{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Me){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,tt.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=tt.workingColorSpace){return this.r=e,this.g=t,this.b=n,tt.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=tt.workingColorSpace){if(e=Ve(e,1),t=je(t,0,1),n=je(n,0,1),0===t)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=Hn(i,r,e+1/3),this.g=Hn(i,r,e),this.b=Hn(i,r,e-1/3)}return tt.toWorkingColorSpace(this,r),this}setStyle(e,t=Me){function n(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const o=r[1],s=r[2];switch(o){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,t);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const n=r[1],i=n.length;if(3===i)return this.setRGB(parseInt(n.charAt(0),16)/15,parseInt(n.charAt(1),16)/15,parseInt(n.charAt(2),16)/15,t);if(6===i)return this.setHex(parseInt(n,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Me){const n=jn[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=nt(e.r),this.g=nt(e.g),this.b=nt(e.b),this}copyLinearToSRGB(e){return this.r=rt(e.r),this.g=rt(e.g),this.b=rt(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Me){return tt.fromWorkingColorSpace(qn.copy(this),e),65536*Math.round(je(255*qn.r,0,255))+256*Math.round(je(255*qn.g,0,255))+Math.round(je(255*qn.b,0,255))}getHexString(e=Me){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=tt.workingColorSpace){tt.fromWorkingColorSpace(qn.copy(this),t);const n=qn.r,r=qn.g,i=qn.b,o=Math.max(n,r,i),s=Math.min(n,r,i);let a,u;const c=(s+o)/2;if(s===o)a=0,u=0;else{const e=o-s;switch(u=c<=.5?e/(o+s):e/(2-o-s),o){case n:a=(r-i)/e+(r<i?6:0);break;case r:a=(i-n)/e+2;break;case i:a=(n-r)/e+4}a/=6}return e.h=a,e.s=u,e.l=c,e}getRGB(e,t=tt.workingColorSpace){return tt.fromWorkingColorSpace(qn.copy(this),t),e.r=qn.r,e.g=qn.g,e.b=qn.b,e}getStyle(e=Me){tt.fromWorkingColorSpace(qn.copy(this),e);const t=qn.r,n=qn.g,r=qn.b;return e!==Me?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*n)},${Math.round(255*r)})`}offsetHSL(e,t,n){return this.getHSL(Vn),this.setHSL(Vn.h+e,Vn.s+t,Vn.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Vn),e.getHSL(Gn);const n=Ge(Vn.h,Gn.h,t),r=Ge(Vn.s,Gn.s,t),i=Ge(Vn.l,Gn.l,t);return this.setHSL(n,r,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const qn=new Wn;Wn.NAMES=jn;let Xn=0;class Zn extends De{static get type(){return"Material"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Xn++}),this.uuid=ze(),this.name="",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=c,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Wn(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Pe,this.stencilZFail=Pe,this.stencilZPass=Pe,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),204!==this.blendSrc&&(n.blendSrc=this.blendSrc),205!==this.blendDst&&(n.blendDst=this.blendDst),this.blendEquation!==c&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Pe&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Pe&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Pe&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const t=r(e.textures),i=r(e.images);t.length>0&&(n.textures=t),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let r=0;r!==e;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class $n extends Zn{static get type(){return"MeshBasicMaterial"}constructor(e){super(),this.isMeshBasicMaterial=!0,this.color=new Wn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new cn,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Yn=new wt,Kn=new Xe;class Qn{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=Re,this.updateRanges=[],this.gpuType=O,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)Kn.fromBufferAttribute(this,t),Kn.applyMatrix3(e),this.setXY(t,Kn.x,Kn.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)Yn.fromBufferAttribute(this,t),Yn.applyMatrix3(e),this.setXYZ(t,Yn.x,Yn.y,Yn.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Yn.fromBufferAttribute(this,t),Yn.applyMatrix4(e),this.setXYZ(t,Yn.x,Yn.y,Yn.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Yn.fromBufferAttribute(this,t),Yn.applyNormalMatrix(e),this.setXYZ(t,Yn.x,Yn.y,Yn.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Yn.fromBufferAttribute(this,t),Yn.transformDirection(e),this.setXYZ(t,Yn.x,Yn.y,Yn.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=He(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=We(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=He(t,this.array)),t}setX(e,t){return this.normalized&&(t=We(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=He(t,this.array)),t}setY(e,t){return this.normalized&&(t=We(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=He(t,this.array)),t}setZ(e,t){return this.normalized&&(t=We(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=He(t,this.array)),t}setW(e,t){return this.normalized&&(t=We(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=We(t,this.array),n=We(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=We(t,this.array),n=We(n,this.array),r=We(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=We(t,this.array),n=We(n,this.array),r=We(r,this.array),i=We(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Re&&(e.usage=this.usage),e}}class Jn extends Qn{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class er extends Qn{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class tr extends Qn{constructor(e,t,n){super(new Float32Array(e),t,n)}}let nr=0;const rr=new Qt,ir=new Mn,or=new wt,sr=new Tt,ar=new Tt,ur=new wt;class cr extends De{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:nr++}),this.uuid=ze(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Ye(e)?er:Jn)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new Ze).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return rr.makeRotationFromQuaternion(e),this.applyMatrix4(rr),this}rotateX(e){return rr.makeRotationX(e),this.applyMatrix4(rr),this}rotateY(e){return rr.makeRotationY(e),this.applyMatrix4(rr),this}rotateZ(e){return rr.makeRotationZ(e),this.applyMatrix4(rr),this}translate(e,t,n){return rr.makeTranslation(e,t,n),this.applyMatrix4(rr),this}scale(e,t,n){return rr.makeScale(e,t,n),this.applyMatrix4(rr),this}lookAt(e){return ir.lookAt(e),ir.updateMatrix(),this.applyMatrix4(ir.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(or).negate(),this.translate(or.x,or.y,or.z),this}setFromPoints(e){const t=this.getAttribute("position");if(void 0===t){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t.push(r.x,r.y,r.z||0)}this.setAttribute("position",new tr(t,3))}else{for(let n=0,r=t.count;n<r;n++){const r=e[n];t.setXYZ(n,r.x,r.y,r.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Tt);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new wt(-1/0,-1/0,-1/0),new wt(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];sr.setFromBufferAttribute(n),this.morphTargetsRelative?(ur.addVectors(this.boundingBox.min,sr.min),this.boundingBox.expandByPoint(ur),ur.addVectors(this.boundingBox.max,sr.max),this.boundingBox.expandByPoint(ur)):(this.boundingBox.expandByPoint(sr.min),this.boundingBox.expandByPoint(sr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Gt);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new wt,1/0);if(e){const n=this.boundingSphere.center;if(sr.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];ar.setFromBufferAttribute(n),this.morphTargetsRelative?(ur.addVectors(sr.min,ar.min),sr.expandByPoint(ur),ur.addVectors(sr.max,ar.max),sr.expandByPoint(ur)):(sr.expandByPoint(ar.min),sr.expandByPoint(ar.max))}sr.getCenter(n);let r=0;for(let t=0,i=e.count;t<i;t++)ur.fromBufferAttribute(e,t),r=Math.max(r,n.distanceToSquared(ur));if(t)for(let i=0,o=t.length;i<o;i++){const o=t[i],s=this.morphTargetsRelative;for(let t=0,i=o.count;t<i;t++)ur.fromBufferAttribute(o,t),s&&(or.fromBufferAttribute(e,t),ur.add(or)),r=Math.max(r,n.distanceToSquared(ur))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.position,r=t.normal,i=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Qn(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),s=[],a=[];for(let e=0;e<n.count;e++)s[e]=new wt,a[e]=new wt;const u=new wt,c=new wt,l=new wt,h=new Xe,d=new Xe,f=new Xe,p=new wt,m=new wt;function g(e,t,r){u.fromBufferAttribute(n,e),c.fromBufferAttribute(n,t),l.fromBufferAttribute(n,r),h.fromBufferAttribute(i,e),d.fromBufferAttribute(i,t),f.fromBufferAttribute(i,r),c.sub(u),l.sub(u),d.sub(h),f.sub(h);const o=1/(d.x*f.y-f.x*d.y);isFinite(o)&&(p.copy(c).multiplyScalar(f.y).addScaledVector(l,-d.y).multiplyScalar(o),m.copy(l).multiplyScalar(d.x).addScaledVector(c,-f.x).multiplyScalar(o),s[e].add(p),s[t].add(p),s[r].add(p),a[e].add(m),a[t].add(m),a[r].add(m))}let v=this.groups;0===v.length&&(v=[{start:0,count:e.count}]);for(let t=0,n=v.length;t<n;++t){const n=v[t],r=n.start;for(let t=r,i=r+n.count;t<i;t+=3)g(e.getX(t+0),e.getX(t+1),e.getX(t+2))}const y=new wt,b=new wt,_=new wt,x=new wt;function w(e){_.fromBufferAttribute(r,e),x.copy(_);const t=s[e];y.copy(t),y.sub(_.multiplyScalar(_.dot(t))).normalize(),b.crossVectors(x,t);const n=b.dot(a[e])<0?-1:1;o.setXYZW(e,y.x,y.y,y.z,n)}for(let t=0,n=v.length;t<n;++t){const n=v[t],r=n.start;for(let t=r,i=r+n.count;t<i;t+=3)w(e.getX(t+0)),w(e.getX(t+1)),w(e.getX(t+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new Qn(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const r=new wt,i=new wt,o=new wt,s=new wt,a=new wt,u=new wt,c=new wt,l=new wt;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),f=e.getX(h+1),p=e.getX(h+2);r.fromBufferAttribute(t,d),i.fromBufferAttribute(t,f),o.fromBufferAttribute(t,p),c.subVectors(o,i),l.subVectors(r,i),c.cross(l),s.fromBufferAttribute(n,d),a.fromBufferAttribute(n,f),u.fromBufferAttribute(n,p),s.add(c),a.add(c),u.add(c),n.setXYZ(d,s.x,s.y,s.z),n.setXYZ(f,a.x,a.y,a.z),n.setXYZ(p,u.x,u.y,u.z)}else for(let e=0,s=t.count;e<s;e+=3)r.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),o.fromBufferAttribute(t,e+2),c.subVectors(o,i),l.subVectors(r,i),c.cross(l),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)ur.fromBufferAttribute(e,t),ur.normalize(),e.setXYZ(t,ur.x,ur.y,ur.z)}toNonIndexed(){function e(e,t){const n=e.array,r=e.itemSize,i=e.normalized,o=new n.constructor(t.length*r);let s=0,a=0;for(let i=0,u=t.length;i<u;i++){s=e.isInterleavedBufferAttribute?t[i]*e.data.stride+e.offset:t[i]*r;for(let e=0;e<r;e++)o[a++]=n[s++]}return new Qn(o,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new cr,n=this.index.array,r=this.attributes;for(const i in r){const o=e(r[i],n);t.setAttribute(i,o)}const i=this.morphAttributes;for(const r in i){const o=[],s=i[r];for(let t=0,r=s.length;t<r;t++){const r=e(s[t],n);o.push(r)}t.morphAttributes[r]=o}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let e=0,n=o.length;e<n;e++){const n=o[e];t.addGroup(n.start,n.count,n.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const t in n){const r=n[t];e.data.attributes[t]=r.toJSON(e.data)}const r={};let i=!1;for(const t in this.morphAttributes){const n=this.morphAttributes[t],o=[];for(let t=0,r=n.length;t<r;t++){const r=n[t];o.push(r.toJSON(e.data))}o.length>0&&(r[t]=o,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const s=this.boundingSphere;return null!==s&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const e in r){const n=r[e];this.setAttribute(e,n.clone(t))}const i=e.morphAttributes;for(const e in i){const n=[],r=i[e];for(let e=0,i=r.length;e<i;e++)n.push(r[e].clone(t));this.morphAttributes[e]=n}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let e=0,t=o.length;e<t;e++){const t=o[e];this.addGroup(t.start,t.count,t.materialIndex)}const s=e.boundingBox;null!==s&&(this.boundingBox=s.clone());const a=e.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const lr=new Qt,hr=new Kt,dr=new Gt,fr=new wt,pr=new wt,mr=new wt,gr=new wt,vr=new wt,yr=new wt,br=new wt,_r=new wt;class xr extends Mn{constructor(e=new cr,t=new $n){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const s=this.morphTargetInfluences;if(i&&s){yr.set(0,0,0);for(let n=0,r=i.length;n<r;n++){const r=s[n],a=i[n];0!==r&&(vr.fromBufferAttribute(a,e),o?yr.addScaledVector(vr,r):yr.addScaledVector(vr.sub(t),r))}t.add(yr)}return t}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r){if(null===n.boundingSphere&&n.computeBoundingSphere(),dr.copy(n.boundingSphere),dr.applyMatrix4(i),hr.copy(e.ray).recast(e.near),!1===dr.containsPoint(hr.origin)){if(null===hr.intersectSphere(dr,fr))return;if(hr.origin.distanceToSquared(fr)>(e.far-e.near)**2)return}lr.copy(i).invert(),hr.copy(e.ray).applyMatrix4(lr),null!==n.boundingBox&&!1===hr.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,hr)}}_computeIntersections(e,t,n){let r;const i=this.geometry,o=this.material,s=i.index,a=i.attributes.position,u=i.attributes.uv,c=i.attributes.uv1,l=i.attributes.normal,h=i.groups,d=i.drawRange;if(null!==s)if(Array.isArray(o))for(let i=0,a=h.length;i<a;i++){const a=h[i],f=o[a.materialIndex];for(let i=Math.max(a.start,d.start),o=Math.min(s.count,Math.min(a.start+a.count,d.start+d.count));i<o;i+=3){r=wr(this,f,e,n,u,c,l,s.getX(i),s.getX(i+1),s.getX(i+2)),r&&(r.faceIndex=Math.floor(i/3),r.face.materialIndex=a.materialIndex,t.push(r))}}else{for(let i=Math.max(0,d.start),a=Math.min(s.count,d.start+d.count);i<a;i+=3){r=wr(this,o,e,n,u,c,l,s.getX(i),s.getX(i+1),s.getX(i+2)),r&&(r.faceIndex=Math.floor(i/3),t.push(r))}}else if(void 0!==a)if(Array.isArray(o))for(let i=0,s=h.length;i<s;i++){const s=h[i],f=o[s.materialIndex];for(let i=Math.max(s.start,d.start),o=Math.min(a.count,Math.min(s.start+s.count,d.start+d.count));i<o;i+=3){r=wr(this,f,e,n,u,c,l,i,i+1,i+2),r&&(r.faceIndex=Math.floor(i/3),r.face.materialIndex=s.materialIndex,t.push(r))}}else{for(let i=Math.max(0,d.start),s=Math.min(a.count,d.start+d.count);i<s;i+=3){r=wr(this,o,e,n,u,c,l,i,i+1,i+2),r&&(r.faceIndex=Math.floor(i/3),t.push(r))}}}}function wr(e,t,n,r,i,o,s,a,u,c){e.getVertexPosition(a,pr),e.getVertexPosition(u,mr),e.getVertexPosition(c,gr);const l=function(e,t,n,r,i,o,s,a){let u;if(u=1===t.side?r.intersectTriangle(s,o,i,!0,a):r.intersectTriangle(i,o,s,0===t.side,a),null===u)return null;_r.copy(a),_r.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(_r);return c<n.near||c>n.far?null:{distance:c,point:_r.clone(),object:e}}(e,t,n,r,pr,mr,gr,br);if(l){const e=new wt;zn.getBarycoord(br,pr,mr,gr,e),i&&(l.uv=zn.getInterpolatedAttribute(i,a,u,c,e,new Xe)),o&&(l.uv1=zn.getInterpolatedAttribute(o,a,u,c,e,new Xe)),s&&(l.normal=zn.getInterpolatedAttribute(s,a,u,c,e,new wt),l.normal.dot(r.direction)>0&&l.normal.multiplyScalar(-1));const t={a:a,b:u,c:c,normal:new wt,materialIndex:0};zn.getNormal(pr,mr,gr,t.normal),l.face=t,l.barycoord=e}return l}class Sr extends cr{constructor(e=1,t=1,n=1,r=1,i=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};const s=this;r=Math.floor(r),i=Math.floor(i),o=Math.floor(o);const a=[],u=[],c=[],l=[];let h=0,d=0;function f(e,t,n,r,i,o,f,p,m,g,v){const y=o/m,b=f/g,_=o/2,x=f/2,w=p/2,S=m+1,E=g+1;let T=0,M=0;const A=new wt;for(let o=0;o<E;o++){const s=o*b-x;for(let a=0;a<S;a++){const h=a*y-_;A[e]=h*r,A[t]=s*i,A[n]=w,u.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[n]=p>0?1:-1,c.push(A.x,A.y,A.z),l.push(a/m),l.push(1-o/g),T+=1}}for(let e=0;e<g;e++)for(let t=0;t<m;t++){const n=h+t+S*e,r=h+t+S*(e+1),i=h+(t+1)+S*(e+1),o=h+(t+1)+S*e;a.push(n,r,o),a.push(r,i,o),M+=6}s.addGroup(d,M,v),d+=M,h+=T}f("z","y","x",-1,-1,n,t,e,o,i,0),f("z","y","x",1,-1,n,t,-e,o,i,1),f("x","z","y",1,1,e,n,t,r,o,2),f("x","z","y",1,-1,e,n,-t,r,o,3),f("x","y","z",1,-1,e,t,n,r,i,4),f("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(a),this.setAttribute("position",new tr(u,3)),this.setAttribute("normal",new tr(c,3)),this.setAttribute("uv",new tr(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Sr(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Er(e){const t={};for(const n in e){t[n]={};for(const r in e[n]){const i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][r]=null):t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}}return t}function Tr(e){const t={};for(let n=0;n<e.length;n++){const r=Er(e[n]);for(const e in r)t[e]=r[e]}return t}function Mr(e){const t=e.getRenderTarget();return null===t?e.outputColorSpace:!0===t.isXRRenderTarget?t.texture.colorSpace:tt.workingColorSpace}const Ar={clone:Er,merge:Tr};class Cr extends Zn{static get type(){return"ShaderMaterial"}constructor(e){super(),this.isShaderMaterial=!0,this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Er(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const n in this.uniforms){const r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const e in this.extensions)!0===this.extensions[e]&&(n[e]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class Or extends Mn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Qt,this.projectionMatrix=new Qt,this.projectionMatrixInverse=new Qt,this.coordinateSystem=Ie}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const Pr=new wt,Rr=new Xe,Nr=new Xe;class Ir extends Or{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Be*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Fe*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Be*Math.atan(Math.tan(.5*Fe*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Pr.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Pr.x,Pr.y).multiplyScalar(-e/Pr.z),Pr.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Pr.x,Pr.y).multiplyScalar(-e/Pr.z)}getViewSize(e,t){return this.getViewBounds(e,Rr,Nr),t.subVectors(Nr,Rr)}setViewOffset(e,t,n,r,i,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Fe*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const e=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/e,t-=o.offsetY*n/s,r*=o.width/e,n*=o.height/s}const s=this.filmOffset;0!==s&&(i+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const kr=-90;class Dr extends Mn{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Ir(kr,1,e,t);r.layers=this.layers,this.add(r);const i=new Ir(kr,1,e,t);i.layers=this.layers,this.add(i);const o=new Ir(kr,1,e,t);o.layers=this.layers,this.add(o);const s=new Ir(kr,1,e,t);s.layers=this.layers,this.add(s);const a=new Ir(kr,1,e,t);a.layers=this.layers,this.add(a);const u=new Ir(kr,1,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,i,o,s,a]=t;for(const e of t)this.remove(e);if(e===Ie)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),a.up.set(0,1,0),a.lookAt(0,0,-1);else{if(e!==ke)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),a.up.set(0,-1,0),a.lookAt(0,0,-1)}for(const e of t)this.add(e),e.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[i,o,s,a,u,c]=this.children,l=e.getRenderTarget(),h=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),f=e.xr.enabled;e.xr.enabled=!1;const p=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,i),e.setRenderTarget(n,1,r),e.render(t,o),e.setRenderTarget(n,2,r),e.render(t,s),e.setRenderTarget(n,3,r),e.render(t,a),e.setRenderTarget(n,4,r),e.render(t,u),n.texture.generateMipmaps=p,e.setRenderTarget(n,5,r),e.render(t,c),e.setRenderTarget(l,h,d),e.xr.enabled=f,n.texture.needsPMREMUpdate=!0}}class Lr extends mt{constructor(e,t,n,r,i,o,s,a,u,c){super(e=void 0!==e?e:[],t=void 0!==t?t:l,n,r,i,o,s,a,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Ur extends yt{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new Lr(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:_}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},r=new Sr(5,5,5),i=new Cr({name:"CubemapFromEquirect",uniforms:Er(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:1,blending:0});i.uniforms.tEquirect.value=t;const o=new xr(r,i),s=t.minFilter;t.minFilter===w&&(t.minFilter=_);return new Dr(1,10,this).update(e,o),t.minFilter=s,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,r){const i=e.getRenderTarget();for(let i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,n,r);e.setRenderTarget(i)}}const Fr=new wt,Br=new wt,zr=new Ze;class jr{constructor(e=new wt(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=Fr.subVectors(n,t).cross(Br.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(Fr),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||zr.getNormalMatrix(e),r=this.coplanarPoint(Fr).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Vr=new Gt,Gr=new wt;class Hr{constructor(e=new jr,t=new jr,n=new jr,r=new jr,i=new jr,o=new jr){this.planes=[e,t,n,r,i,o]}set(e,t,n,r,i,o){const s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(n),s[3].copy(r),s[4].copy(i),s[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=2e3){const n=this.planes,r=e.elements,i=r[0],o=r[1],s=r[2],a=r[3],u=r[4],c=r[5],l=r[6],h=r[7],d=r[8],f=r[9],p=r[10],m=r[11],g=r[12],v=r[13],y=r[14],b=r[15];if(n[0].setComponents(a-i,h-u,m-d,b-g).normalize(),n[1].setComponents(a+i,h+u,m+d,b+g).normalize(),n[2].setComponents(a+o,h+c,m+f,b+v).normalize(),n[3].setComponents(a-o,h-c,m-f,b-v).normalize(),n[4].setComponents(a-s,h-l,m-p,b-y).normalize(),t===Ie)n[5].setComponents(a+s,h+l,m+p,b+y).normalize();else{if(t!==ke)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(s,l,p,y).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),Vr.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),Vr.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Vr)}intersectsSprite(e){return Vr.center.set(0,0,0),Vr.radius=.7071067811865476,Vr.applyMatrix4(e.matrixWorld),this.intersectsSphere(Vr)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let e=0;e<6;e++){if(t[e].distanceToPoint(n)<r)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(Gr.x=r.normal.x>0?e.max.x:e.min.x,Gr.y=r.normal.y>0?e.max.y:e.min.y,Gr.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Gr)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Wr(){let e=null,t=!1,n=null,r=null;function i(t,o){n(t,o),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function qr(e){const t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);const r=t.get(n);r&&(e.deleteBuffer(r.buffer),t.delete(n))},update:function(n,r){if(n.isInterleavedBufferAttribute&&(n=n.data),n.isGLBufferAttribute){const e=t.get(n);return void((!e||e.version<n.version)&&t.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version}))}const i=t.get(n);if(void 0===i)t.set(n,function(t,n){const r=t.array,i=t.usage,o=r.byteLength,s=e.createBuffer();let a;if(e.bindBuffer(n,s),e.bufferData(n,r,i),t.onUploadCallback(),r instanceof Float32Array)a=e.FLOAT;else if(r instanceof Uint16Array)a=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(r instanceof Int16Array)a=e.SHORT;else if(r instanceof Uint32Array)a=e.UNSIGNED_INT;else if(r instanceof Int32Array)a=e.INT;else if(r instanceof Int8Array)a=e.BYTE;else if(r instanceof Uint8Array)a=e.UNSIGNED_BYTE;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);a=e.UNSIGNED_BYTE}return{buffer:s,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version,size:o}}(n,r));else if(i.version<n.version){if(i.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,n,r){const i=n.array,o=n.updateRanges;if(e.bindBuffer(r,t),0===o.length)e.bufferSubData(r,0,i);else{o.sort(((e,t)=>e.start-t.start));let t=0;for(let e=1;e<o.length;e++){const n=o[t],r=o[e];r.start<=n.start+n.count+1?n.count=Math.max(n.count,r.start+r.count-n.start):(++t,o[t]=r)}o.length=t+1;for(let t=0,n=o.length;t<n;t++){const n=o[t];e.bufferSubData(r,n.start*i.BYTES_PER_ELEMENT,i,n.start,n.count)}n.clearUpdateRanges()}n.onUploadCallback()}(i.buffer,n,r),i.version=n.version}}}}class Xr extends cr{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,o=t/2,s=Math.floor(n),a=Math.floor(r),u=s+1,c=a+1,l=e/s,h=t/a,d=[],f=[],p=[],m=[];for(let e=0;e<c;e++){const t=e*h-o;for(let n=0;n<u;n++){const r=n*l-i;f.push(r,-t,0),p.push(0,0,1),m.push(n/s),m.push(1-e/a)}}for(let e=0;e<a;e++)for(let t=0;t<s;t++){const n=t+u*e,r=t+u*(e+1),i=t+1+u*(e+1),o=t+1+u*e;d.push(n,r,o),d.push(r,i,o)}this.setIndex(d),this.setAttribute("position",new tr(f,3)),this.setAttribute("normal",new tr(p,3)),this.setAttribute("uv",new tr(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Xr(e.width,e.height,e.widthSegments,e.heightSegments)}}const Zr={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\t\n\t\tfloat lightToPositionLength = length( lightToPosition );\n\t\tif ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\t\tdp += shadowBias;\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t\t) * ( 1.0 / 9.0 );\n\t\t\t#else\n\t\t\t\tshadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t\n\t\t#else\n\t\t\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},$r={common:{diffuse:{value:new Wn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ze},alphaMap:{value:null},alphaMapTransform:{value:new Ze},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ze}},envmap:{envMap:{value:null},envMapRotation:{value:new Ze},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ze}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ze}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ze},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ze},normalScale:{value:new Xe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ze},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ze}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ze}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ze}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Wn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Wn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ze},alphaTest:{value:0},uvTransform:{value:new Ze}},sprite:{diffuse:{value:new Wn(16777215)},opacity:{value:1},center:{value:new Xe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ze},alphaMap:{value:null},alphaMapTransform:{value:new Ze},alphaTest:{value:0}}},Yr={basic:{uniforms:Tr([$r.common,$r.specularmap,$r.envmap,$r.aomap,$r.lightmap,$r.fog]),vertexShader:Zr.meshbasic_vert,fragmentShader:Zr.meshbasic_frag},lambert:{uniforms:Tr([$r.common,$r.specularmap,$r.envmap,$r.aomap,$r.lightmap,$r.emissivemap,$r.bumpmap,$r.normalmap,$r.displacementmap,$r.fog,$r.lights,{emissive:{value:new Wn(0)}}]),vertexShader:Zr.meshlambert_vert,fragmentShader:Zr.meshlambert_frag},phong:{uniforms:Tr([$r.common,$r.specularmap,$r.envmap,$r.aomap,$r.lightmap,$r.emissivemap,$r.bumpmap,$r.normalmap,$r.displacementmap,$r.fog,$r.lights,{emissive:{value:new Wn(0)},specular:{value:new Wn(1118481)},shininess:{value:30}}]),vertexShader:Zr.meshphong_vert,fragmentShader:Zr.meshphong_frag},standard:{uniforms:Tr([$r.common,$r.envmap,$r.aomap,$r.lightmap,$r.emissivemap,$r.bumpmap,$r.normalmap,$r.displacementmap,$r.roughnessmap,$r.metalnessmap,$r.fog,$r.lights,{emissive:{value:new Wn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Zr.meshphysical_vert,fragmentShader:Zr.meshphysical_frag},toon:{uniforms:Tr([$r.common,$r.aomap,$r.lightmap,$r.emissivemap,$r.bumpmap,$r.normalmap,$r.displacementmap,$r.gradientmap,$r.fog,$r.lights,{emissive:{value:new Wn(0)}}]),vertexShader:Zr.meshtoon_vert,fragmentShader:Zr.meshtoon_frag},matcap:{uniforms:Tr([$r.common,$r.bumpmap,$r.normalmap,$r.displacementmap,$r.fog,{matcap:{value:null}}]),vertexShader:Zr.meshmatcap_vert,fragmentShader:Zr.meshmatcap_frag},points:{uniforms:Tr([$r.points,$r.fog]),vertexShader:Zr.points_vert,fragmentShader:Zr.points_frag},dashed:{uniforms:Tr([$r.common,$r.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Zr.linedashed_vert,fragmentShader:Zr.linedashed_frag},depth:{uniforms:Tr([$r.common,$r.displacementmap]),vertexShader:Zr.depth_vert,fragmentShader:Zr.depth_frag},normal:{uniforms:Tr([$r.common,$r.bumpmap,$r.normalmap,$r.displacementmap,{opacity:{value:1}}]),vertexShader:Zr.meshnormal_vert,fragmentShader:Zr.meshnormal_frag},sprite:{uniforms:Tr([$r.sprite,$r.fog]),vertexShader:Zr.sprite_vert,fragmentShader:Zr.sprite_frag},background:{uniforms:{uvTransform:{value:new Ze},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Zr.background_vert,fragmentShader:Zr.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Ze}},vertexShader:Zr.backgroundCube_vert,fragmentShader:Zr.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Zr.cube_vert,fragmentShader:Zr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Zr.equirect_vert,fragmentShader:Zr.equirect_frag},distanceRGBA:{uniforms:Tr([$r.common,$r.displacementmap,{referencePosition:{value:new wt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Zr.distanceRGBA_vert,fragmentShader:Zr.distanceRGBA_frag},shadow:{uniforms:Tr([$r.lights,$r.fog,{color:{value:new Wn(0)},opacity:{value:1}}]),vertexShader:Zr.shadow_vert,fragmentShader:Zr.shadow_frag}};Yr.physical={uniforms:Tr([Yr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ze},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ze},clearcoatNormalScale:{value:new Xe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ze},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ze},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ze},sheen:{value:0},sheenColor:{value:new Wn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ze},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ze},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ze},transmissionSamplerSize:{value:new Xe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ze},attenuationDistance:{value:0},attenuationColor:{value:new Wn(0)},specularColor:{value:new Wn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ze},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ze},anisotropyVector:{value:new Xe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ze}}]),vertexShader:Zr.meshphysical_vert,fragmentShader:Zr.meshphysical_frag};const Kr={r:0,b:0,g:0},Qr=new cn,Jr=new Qt;function ei(e,t,n,r,i,o,s){const a=new Wn(0);let u,c,l=!0===o?0:1,h=null,d=0,f=null;function m(e){let r=!0===e.isScene?e.background:null;if(r&&r.isTexture){r=(e.backgroundBlurriness>0?n:t).get(r)}return r}function g(t,n){t.getRGB(Kr,Mr(e)),r.buffers.color.setClear(Kr.r,Kr.g,Kr.b,n,s)}return{getClearColor:function(){return a},setClearColor:function(e,t=1){a.set(e),l=t,g(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(e){l=e,g(a,l)},render:function(t){let n=!1;const i=m(t);null===i?g(a,l):i&&i.isColor&&(g(i,1),n=!0);const o=e.xr.getEnvironmentBlendMode();"additive"===o?r.buffers.color.setClear(0,0,0,1,s):"alpha-blend"===o&&r.buffers.color.setClear(0,0,0,0,s),(e.autoClear||n)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))},addToRenderList:function(t,n){const r=m(n);r&&(r.isCubeTexture||r.mapping===p)?(void 0===c&&(c=new xr(new Sr(1,1,1),new Cr({name:"BackgroundCubeMaterial",uniforms:Er(Yr.backgroundCube.uniforms),vertexShader:Yr.backgroundCube.vertexShader,fragmentShader:Yr.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),Qr.copy(n.backgroundRotation),Qr.x*=-1,Qr.y*=-1,Qr.z*=-1,r.isCubeTexture&&!1===r.isRenderTargetTexture&&(Qr.y*=-1,Qr.z*=-1),c.material.uniforms.envMap.value=r,c.material.uniforms.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(Jr.makeRotationFromEuler(Qr)),c.material.toneMapped=tt.getTransfer(r.colorSpace)!==Oe,h===r&&d===r.version&&f===e.toneMapping||(c.material.needsUpdate=!0,h=r,d=r.version,f=e.toneMapping),c.layers.enableAll(),t.unshift(c,c.geometry,c.material,0,0,null)):r&&r.isTexture&&(void 0===u&&(u=new xr(new Xr(2,2),new Cr({name:"BackgroundMaterial",uniforms:Er(Yr.background.uniforms),vertexShader:Yr.background.vertexShader,fragmentShader:Yr.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(u)),u.material.uniforms.t2D.value=r,u.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,u.material.toneMapped=tt.getTransfer(r.colorSpace)!==Oe,!0===r.matrixAutoUpdate&&r.updateMatrix(),u.material.uniforms.uvTransform.value.copy(r.matrix),h===r&&d===r.version&&f===e.toneMapping||(u.material.needsUpdate=!0,h=r,d=r.version,f=e.toneMapping),u.layers.enableAll(),t.unshift(u,u.geometry,u.material,0,0,null))}}}function ti(e,t){const n=e.getParameter(e.MAX_VERTEX_ATTRIBS),r={},i=c(null);let o=i,s=!1;function a(t){return e.bindVertexArray(t)}function u(t){return e.deleteVertexArray(t)}function c(e){const t=[],r=[],i=[];for(let e=0;e<n;e++)t[e]=0,r[e]=0,i[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:i,object:e,attributes:{},index:null}}function l(){const e=o.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function h(e){d(e,0)}function d(t,n){const r=o.newAttributes,i=o.enabledAttributes,s=o.attributeDivisors;r[t]=1,0===i[t]&&(e.enableVertexAttribArray(t),i[t]=1),s[t]!==n&&(e.vertexAttribDivisor(t,n),s[t]=n)}function f(){const t=o.newAttributes,n=o.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function p(t,n,r,i,o,s,a){!0===a?e.vertexAttribIPointer(t,n,r,o,s):e.vertexAttribPointer(t,n,r,i,o,s)}function m(){g(),s=!0,o!==i&&(o=i,a(o.object))}function g(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:function(n,i,u,m,g){let v=!1;const y=function(t,n,i){const o=!0===i.wireframe;let s=r[t.id];void 0===s&&(s={},r[t.id]=s);let a=s[n.id];void 0===a&&(a={},s[n.id]=a);let u=a[o];void 0===u&&(u=c(e.createVertexArray()),a[o]=u);return u}(m,u,i);o!==y&&(o=y,a(o.object)),v=function(e,t,n,r){const i=o.attributes,s=t.attributes;let a=0;const u=n.getAttributes();for(const t in u){if(u[t].location>=0){const n=i[t];let r=s[t];if(void 0===r&&("instanceMatrix"===t&&e.instanceMatrix&&(r=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(r=e.instanceColor)),void 0===n)return!0;if(n.attribute!==r)return!0;if(r&&n.data!==r.data)return!0;a++}}return o.attributesNum!==a||o.index!==r}(n,m,u,g),v&&function(e,t,n,r){const i={},s=t.attributes;let a=0;const u=n.getAttributes();for(const t in u){if(u[t].location>=0){let n=s[t];void 0===n&&("instanceMatrix"===t&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(n=e.instanceColor));const r={};r.attribute=n,n&&n.data&&(r.data=n.data),i[t]=r,a++}}o.attributes=i,o.attributesNum=a,o.index=r}(n,m,u,g),null!==g&&t.update(g,e.ELEMENT_ARRAY_BUFFER),(v||s)&&(s=!1,function(n,r,i,o){l();const s=o.attributes,a=i.getAttributes(),u=r.defaultAttributeValues;for(const r in a){const i=a[r];if(i.location>=0){let a=s[r];if(void 0===a&&("instanceMatrix"===r&&n.instanceMatrix&&(a=n.instanceMatrix),"instanceColor"===r&&n.instanceColor&&(a=n.instanceColor)),void 0!==a){const r=a.normalized,s=a.itemSize,u=t.get(a);if(void 0===u)continue;const c=u.buffer,l=u.type,f=u.bytesPerElement,m=l===e.INT||l===e.UNSIGNED_INT||a.gpuType===A;if(a.isInterleavedBufferAttribute){const t=a.data,u=t.stride,g=a.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<i.locationSize;e++)d(i.location+e,t.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<i.locationSize;e++)h(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<i.locationSize;e++)p(i.location+e,s/i.locationSize,l,r,u*f,(g+s/i.locationSize*e)*f,m)}else{if(a.isInstancedBufferAttribute){for(let e=0;e<i.locationSize;e++)d(i.location+e,a.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=a.meshPerAttribute*a.count)}else for(let e=0;e<i.locationSize;e++)h(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<i.locationSize;e++)p(i.location+e,s/i.locationSize,l,r,s*f,s/i.locationSize*e*f,m)}}else if(void 0!==u){const t=u[r];if(void 0!==t)switch(t.length){case 2:e.vertexAttrib2fv(i.location,t);break;case 3:e.vertexAttrib3fv(i.location,t);break;case 4:e.vertexAttrib4fv(i.location,t);break;default:e.vertexAttrib1fv(i.location,t)}}}}f()}(n,i,u,m),null!==g&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(g).buffer))},reset:m,resetDefaultState:g,dispose:function(){m();for(const e in r){const t=r[e];for(const e in t){const n=t[e];for(const e in n)u(n[e].object),delete n[e];delete t[e]}delete r[e]}},releaseStatesOfGeometry:function(e){if(void 0===r[e.id])return;const t=r[e.id];for(const e in t){const n=t[e];for(const e in n)u(n[e].object),delete n[e];delete t[e]}delete r[e.id]},releaseStatesOfProgram:function(e){for(const t in r){const n=r[t];if(void 0===n[e.id])continue;const i=n[e.id];for(const e in i)u(i[e].object),delete i[e];delete n[e.id]}},initAttributes:l,enableAttribute:h,disableUnusedAttributes:f}}function ni(e,t,n){let r;function i(t,i,o){0!==o&&(e.drawArraysInstanced(r,t,i,o),n.update(i,r,o))}this.setMode=function(e){r=e},this.render=function(t,i){e.drawArrays(r,t,i),n.update(i,r,1)},this.renderInstances=i,this.renderMultiDraw=function(e,i,o){if(0===o)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,e,0,i,0,o);let s=0;for(let e=0;e<o;e++)s+=i[e];n.update(s,r,1)},this.renderMultiDrawInstances=function(e,o,s,a){if(0===s)return;const u=t.get("WEBGL_multi_draw");if(null===u)for(let t=0;t<e.length;t++)i(e[t],o[t],a[t]);else{u.multiDrawArraysInstancedWEBGL(r,e,0,o,0,a,0,s);let t=0;for(let e=0;e<s;e++)t+=o[e]*a[e];n.update(t,r,1)}}}function ri(e,t,n,r){let i;function o(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let s=void 0!==n.precision?n.precision:"highp";const a=o(s);a!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",a,"instead."),s=a);const u=!0===n.logarithmicDepthBuffer,c=!0===n.reverseDepthBuffer&&t.has("EXT_clip_control"),l=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:o,textureFormatReadable:function(t){return t===D||r.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){const i=n===P&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(n!==S&&r.convert(n)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==O&&!i)},precision:s,logarithmicDepthBuffer:u,reverseDepthBuffer:c,maxTextures:l,maxVertexTextures:h,maxTextureSize:e.getParameter(e.MAX_TEXTURE_SIZE),maxCubemapSize:e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:e.getParameter(e.MAX_VERTEX_ATTRIBS),maxVertexUniforms:e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:e.getParameter(e.MAX_VARYING_VECTORS),maxFragmentUniforms:e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),vertexTextures:h>0,maxSamples:e.getParameter(e.MAX_SAMPLES)}}function ii(e){const t=this;let n=null,r=0,i=!1,o=!1;const s=new jr,a=new Ze,u={value:null,needsUpdate:!1};function c(e,n,r,i){const o=null!==e?e.length:0;let c=null;if(0!==o){if(c=u.value,!0!==i||null===c){const t=r+4*o,i=n.matrixWorldInverse;a.getNormalMatrix(i),(null===c||c.length<t)&&(c=new Float32Array(t));for(let t=0,n=r;t!==o;++t,n+=4)s.copy(e[t]).applyMatrix4(i,a),s.normal.toArray(c,n),c[n+3]=s.constant}u.value=c,u.needsUpdate=!0}return t.numPlanes=o,t.numIntersection=0,c}this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const n=0!==e.length||t||0!==r||i;return i=t,r=e.length,n},this.beginShadows=function(){o=!0,c(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(e,t){n=c(e,t,0)},this.setState=function(s,a,l){const h=s.clippingPlanes,d=s.clipIntersection,f=s.clipShadows,p=e.get(s);if(!i||null===h||0===h.length||o&&!f)o?c(null):function(){u.value!==n&&(u.value=n,u.needsUpdate=r>0);t.numPlanes=r,t.numIntersection=0}();else{const e=o?0:r,t=4*e;let i=p.clippingState||null;u.value=i,i=c(h,a,t,l);for(let e=0;e!==t;++e)i[e]=n[e];p.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function oi(e){let t=new WeakMap;function n(e,t){return t===d?e.mapping=l:t===f&&(e.mapping=h),e}function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const o=i.mapping;if(o===d||o===f){if(t.has(i)){return n(t.get(i).texture,i.mapping)}{const o=i.image;if(o&&o.height>0){const s=new Ur(o.height);return s.fromEquirectangularTexture(e,i),t.set(i,s),i.addEventListener("dispose",r),n(s.texture,i.mapping)}return null}}}return i},dispose:function(){t=new WeakMap}}}class si extends Or{constructor(e=-1,t=1,n=1,r=-1,i=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,o=n+e,s=r+t,a=r-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,o=i+e*this.view.width,s-=t*this.view.offsetY,a=s-t*this.view.height}this.projectionMatrix.makeOrthographic(i,o,s,a,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const ai=[.125,.215,.35,.446,.526,.582],ui=20,ci=new si,li=new Wn;let hi=null,di=0,fi=0,pi=!1;const mi=(1+Math.sqrt(5))/2,gi=1/mi,vi=[new wt(-mi,gi,0),new wt(mi,gi,0),new wt(-gi,0,mi),new wt(gi,0,mi),new wt(0,mi,-gi),new wt(0,mi,gi),new wt(-1,1,-1),new wt(1,1,-1),new wt(-1,1,1),new wt(1,1,1)];class yi{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){hi=this._renderer.getRenderTarget(),di=this._renderer.getActiveCubeFace(),fi=this._renderer.getActiveMipmapLevel(),pi=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=wi(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=xi(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(hi,di,fi),this._renderer.xr.enabled=pi,e.scissorTest=!1,_i(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===l||e.mapping===h?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),hi=this._renderer.getRenderTarget(),di=this._renderer.getActiveCubeFace(),fi=this._renderer.getActiveMipmapLevel(),pi=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:_,minFilter:_,generateMipmaps:!1,type:P,format:D,colorSpace:Ae,depthBuffer:!1},r=bi(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=bi(e,t,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],n=[],r=[];let i=e;const o=e-4+1+ai.length;for(let s=0;s<o;s++){const o=Math.pow(2,i);n.push(o);let a=1/o;s>e-4?a=ai[s-e+4-1]:0===s&&(a=0),r.push(a);const u=1/(o-2),c=-u,l=1+u,h=[c,c,l,c,l,l,c,c,l,l,c,l],d=6,f=6,p=3,m=2,g=1,v=new Float32Array(p*f*d),y=new Float32Array(m*f*d),b=new Float32Array(g*f*d);for(let e=0;e<d;e++){const t=e%3*2/3-1,n=e>2?0:-1,r=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];v.set(r,p*f*e),y.set(h,m*f*e);const i=[e,e,e,e,e,e];b.set(i,g*f*e)}const _=new cr;_.setAttribute("position",new Qn(v,p)),_.setAttribute("uv",new Qn(y,m)),_.setAttribute("faceIndex",new Qn(b,g)),t.push(_),i>4&&i--}return{lodPlanes:t,sizeLods:n,sigmas:r}}(r)),this._blurMaterial=function(e,t,n){const r=new Float32Array(ui),i=new wt(0,1,0),o=new Cr({name:"SphericalGaussianBlur",defines:{n:ui,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:Si(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1});return o}(r,e,t)}return r}_compileMaterial(e){const t=new xr(this._lodPlanes[0],e);this._renderer.compile(t,ci)}_sceneToCubeUV(e,t,n,r){const i=new Ir(90,1,t,n),o=[1,-1,1,1,1,1],s=[1,1,1,-1,-1,-1],a=this._renderer,u=a.autoClear,c=a.toneMapping;a.getClearColor(li),a.toneMapping=0,a.autoClear=!1;const l=new $n({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),h=new xr(new Sr,l);let d=!1;const f=e.background;f?f.isColor&&(l.color.copy(f),e.background=null,d=!0):(l.color.copy(li),d=!0);for(let t=0;t<6;t++){const n=t%3;0===n?(i.up.set(0,o[t],0),i.lookAt(s[t],0,0)):1===n?(i.up.set(0,0,o[t]),i.lookAt(0,s[t],0)):(i.up.set(0,o[t],0),i.lookAt(0,0,s[t]));const u=this._cubeSize;_i(r,n*u,t>2?u:0,u,u),a.setRenderTarget(r),d&&a.render(h,i),a.render(e,i)}h.geometry.dispose(),h.material.dispose(),a.toneMapping=c,a.autoClear=u,e.background=f}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===l||e.mapping===h;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=wi()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=xi());const i=r?this._cubemapMaterial:this._equirectMaterial,o=new xr(this._lodPlanes[0],i);i.uniforms.envMap.value=e;const s=this._cubeSize;_i(t,0,0,3*s,2*s),n.setRenderTarget(t),n.render(o,ci)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let t=1;t<r;t++){const n=Math.sqrt(this._sigmas[t]*this._sigmas[t]-this._sigmas[t-1]*this._sigmas[t-1]),i=vi[(r-t-1)%vi.length];this._blur(e,t-1,t,n,i)}t.autoClear=n}_blur(e,t,n,r,i){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",i),this._halfBlur(o,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,o,s){const a=this._renderer,u=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new xr(this._lodPlanes[r],u),l=u.uniforms,h=this._sizeLods[n]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,f=i/d,p=isFinite(i)?1+Math.floor(3*f):ui;p>ui&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${p} samples when the maximum is set to 20`);const m=[];let g=0;for(let e=0;e<ui;++e){const t=e/f,n=Math.exp(-t*t/2);m.push(n),0===e?g+=n:e<p&&(g+=2*n)}for(let e=0;e<m.length;e++)m[e]=m[e]/g;l.envMap.value=e.texture,l.samples.value=p,l.weights.value=m,l.latitudinal.value="latitudinal"===o,s&&(l.poleAxis.value=s);const{_lodMax:v}=this;l.dTheta.value=d,l.mipInt.value=v-n;const y=this._sizeLods[r];_i(t,3*y*(r>v-4?r-v+4:0),4*(this._cubeSize-y),3*y,2*y),a.setRenderTarget(t),a.render(c,ci)}}function bi(e,t,n){const r=new yt(e,t,n);return r.texture.mapping=p,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function _i(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function xi(){return new Cr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Si(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function wi(){return new Cr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Si(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Si(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function Ei(e){let t=new WeakMap,n=null;function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const o=i.mapping,s=o===d||o===f,a=o===l||o===h;if(s||a){let o=t.get(i);const u=void 0!==o?o.texture.pmremVersion:0;if(i.isRenderTargetTexture&&i.pmremVersion!==u)return null===n&&(n=new yi(e)),o=s?n.fromEquirectangular(i,o):n.fromCubemap(i,o),o.texture.pmremVersion=i.pmremVersion,t.set(i,o),o.texture;if(void 0!==o)return o.texture;{const u=i.image;return s&&u&&u.height>0||a&&u&&function(e){let t=0;const n=6;for(let r=0;r<n;r++)void 0!==e[r]&&t++;return t===n}(u)?(null===n&&(n=new yi(e)),o=s?n.fromEquirectangular(i):n.fromCubemap(i),o.texture.pmremVersion=i.pmremVersion,t.set(i,o),i.addEventListener("dispose",r),o.texture):null}}}return i},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function Ti(e){const t={};function n(n){if(void 0!==t[n])return t[n];let r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(e){const t=n(e);return null===t&&et("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function Mi(e,t,n,r){const i={},o=new WeakMap;function s(e){const a=e.target;null!==a.index&&t.remove(a.index);for(const e in a.attributes)t.remove(a.attributes[e]);for(const e in a.morphAttributes){const n=a.morphAttributes[e];for(let e=0,r=n.length;e<r;e++)t.remove(n[e])}a.removeEventListener("dispose",s),delete i[a.id];const u=o.get(a);u&&(t.remove(u),o.delete(a)),r.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,n.memory.geometries--}function a(e){const n=[],r=e.index,i=e.attributes.position;let s=0;if(null!==r){const e=r.array;s=r.version;for(let t=0,r=e.length;t<r;t+=3){const r=e[t+0],i=e[t+1],o=e[t+2];n.push(r,i,i,o,o,r)}}else{if(void 0===i)return;{const e=i.array;s=i.version;for(let t=0,r=e.length/3-1;t<r;t+=3){const e=t+0,r=t+1,i=t+2;n.push(e,r,r,i,i,e)}}}const a=new(Ye(n)?er:Jn)(n,1);a.version=s;const u=o.get(e);u&&t.remove(u),o.set(e,a)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",s),i[t.id]=!0,n.memory.geometries++),t},update:function(n){const r=n.attributes;for(const n in r)t.update(r[n],e.ARRAY_BUFFER);const i=n.morphAttributes;for(const n in i){const r=i[n];for(let n=0,i=r.length;n<i;n++)t.update(r[n],e.ARRAY_BUFFER)}},getWireframeAttribute:function(e){const t=o.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&a(e)}else a(e);return o.get(e)}}}function Ai(e,t,n){let r,i,o;function s(t,s,a){0!==a&&(e.drawElementsInstanced(r,s,i,t*o,a),n.update(s,r,a))}this.setMode=function(e){r=e},this.setIndex=function(e){i=e.type,o=e.bytesPerElement},this.render=function(t,s){e.drawElements(r,s,i,t*o),n.update(s,r,1)},this.renderInstances=s,this.renderMultiDraw=function(e,o,s){if(0===s)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,o,0,i,e,0,s);let a=0;for(let e=0;e<s;e++)a+=o[e];n.update(a,r,1)},this.renderMultiDrawInstances=function(e,a,u,c){if(0===u)return;const l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<e.length;t++)s(e[t]/o,a[t],c[t]);else{l.multiDrawElementsInstancedWEBGL(r,a,0,i,e,0,c,0,u);let t=0;for(let e=0;e<u;e++)t+=a[e]*c[e];n.update(t,r,1)}}}function Ci(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,i){switch(t.calls++,r){case e.TRIANGLES:t.triangles+=i*(n/3);break;case e.LINES:t.lines+=i*(n/2);break;case e.LINE_STRIP:t.lines+=i*(n-1);break;case e.LINE_LOOP:t.lines+=i*n;break;case e.POINTS:t.points+=i*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function Oi(e,t,n){const r=new WeakMap,i=new gt;return{update:function(o,s,a){const u=o.morphTargetInfluences,c=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,l=void 0!==c?c.length:0;let h=r.get(s);if(void 0===h||h.count!==l){void 0!==h&&h.texture.dispose();const d=void 0!==s.morphAttributes.position,f=void 0!==s.morphAttributes.normal,p=void 0!==s.morphAttributes.color,m=s.morphAttributes.position||[],g=s.morphAttributes.normal||[],v=s.morphAttributes.color||[];let y=0;!0===d&&(y=1),!0===f&&(y=2),!0===p&&(y=3);let b=s.attributes.position.count*y,_=1;b>t.maxTextureSize&&(_=Math.ceil(b/t.maxTextureSize),b=t.maxTextureSize);const x=new Float32Array(b*_*4*l),w=new bt(x,b,_,l);w.type=O,w.needsUpdate=!0;const S=4*y;for(let T=0;T<l;T++){const M=m[T],A=g[T],C=v[T],P=b*_*4*T;for(let R=0;R<M.count;R++){const N=R*S;!0===d&&(i.fromBufferAttribute(M,R),x[P+N+0]=i.x,x[P+N+1]=i.y,x[P+N+2]=i.z,x[P+N+3]=0),!0===f&&(i.fromBufferAttribute(A,R),x[P+N+4]=i.x,x[P+N+5]=i.y,x[P+N+6]=i.z,x[P+N+7]=0),!0===p&&(i.fromBufferAttribute(C,R),x[P+N+8]=i.x,x[P+N+9]=i.y,x[P+N+10]=i.z,x[P+N+11]=4===C.itemSize?i.w:1)}}function E(){w.dispose(),r.delete(s),s.removeEventListener("dispose",E)}h={count:l,texture:w,size:new Xe(b,_)},r.set(s,h),s.addEventListener("dispose",E)}if(!0===o.isInstancedMesh&&null!==o.morphTexture)a.getUniforms().setValue(e,"morphTexture",o.morphTexture,n);else{let I=0;for(let D=0;D<u.length;D++)I+=u[D];const k=s.morphTargetsRelative?1:1-I;a.getUniforms().setValue(e,"morphTargetBaseInfluence",k),a.getUniforms().setValue(e,"morphTargetInfluences",u)}a.getUniforms().setValue(e,"morphTargetsTexture",h.texture,n),a.getUniforms().setValue(e,"morphTargetsTextureSize",h.size)}}}function Pi(e,t,n,r){let i=new WeakMap;function o(e){const t=e.target;t.removeEventListener("dispose",o),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(s){const a=r.render.frame,u=s.geometry,c=t.get(s,u);if(i.get(c)!==a&&(t.update(c),i.set(c,a)),s.isInstancedMesh&&(!1===s.hasEventListener("dispose",o)&&s.addEventListener("dispose",o),i.get(s)!==a&&(n.update(s.instanceMatrix,e.ARRAY_BUFFER),null!==s.instanceColor&&n.update(s.instanceColor,e.ARRAY_BUFFER),i.set(s,a))),s.isSkinnedMesh){const e=s.skeleton;i.get(e)!==a&&(e.update(),i.set(e,a))}return c},dispose:function(){i=new WeakMap}}}class Ri extends mt{constructor(e,t,n,r,i,o,s,a,u,c=1026){if(c!==L&&c!==U)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===L&&(n=C),void 0===n&&c===U&&(n=I),super(null,r,i,o,s,a,c,n,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==s?s:y,this.minFilter=void 0!==a?a:y,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}const Ni=new mt,Ii=new Ri(1,1),ki=new bt,Di=new _t,Li=new Lr,Ui=[],Fi=[],Bi=new Float32Array(16),zi=new Float32Array(9),ji=new Float32Array(4);function Vi(e,t,n){const r=e[0];if(r<=0||r>0)return e;const i=t*n;let o=Ui[i];if(void 0===o&&(o=new Float32Array(i),Ui[i]=o),0!==t){r.toArray(o,0);for(let r=1,i=0;r!==t;++r)i+=n,e[r].toArray(o,i)}return o}function Gi(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Hi(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function Wi(e,t){let n=Fi[t];void 0===n&&(n=new Int32Array(t),Fi[t]=n);for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function qi(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Xi(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Gi(n,t))return;e.uniform2fv(this.addr,t),Hi(n,t)}}function Zi(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Gi(n,t))return;e.uniform3fv(this.addr,t),Hi(n,t)}}function $i(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Gi(n,t))return;e.uniform4fv(this.addr,t),Hi(n,t)}}function Yi(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(Gi(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Hi(n,t)}else{if(Gi(n,r))return;ji.set(r),e.uniformMatrix2fv(this.addr,!1,ji),Hi(n,r)}}function Ki(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(Gi(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Hi(n,t)}else{if(Gi(n,r))return;zi.set(r),e.uniformMatrix3fv(this.addr,!1,zi),Hi(n,r)}}function Qi(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(Gi(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Hi(n,t)}else{if(Gi(n,r))return;Bi.set(r),e.uniformMatrix4fv(this.addr,!1,Bi),Hi(n,r)}}function Ji(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function eo(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Gi(n,t))return;e.uniform2iv(this.addr,t),Hi(n,t)}}function to(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(Gi(n,t))return;e.uniform3iv(this.addr,t),Hi(n,t)}}function no(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Gi(n,t))return;e.uniform4iv(this.addr,t),Hi(n,t)}}function ro(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function io(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Gi(n,t))return;e.uniform2uiv(this.addr,t),Hi(n,t)}}function oo(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(Gi(n,t))return;e.uniform3uiv(this.addr,t),Hi(n,t)}}function so(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Gi(n,t))return;e.uniform4uiv(this.addr,t),Hi(n,t)}}function ao(e,t,n){const r=this.cache,i=n.allocateTextureUnit();let o;r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),this.type===e.SAMPLER_2D_SHADOW?(Ii.compareFunction=515,o=Ii):o=Ni,n.setTexture2D(t||o,i)}function uo(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||Di,i)}function co(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||Li,i)}function lo(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||ki,i)}function ho(e,t){e.uniform1fv(this.addr,t)}function fo(e,t){const n=Vi(t,this.size,2);e.uniform2fv(this.addr,n)}function po(e,t){const n=Vi(t,this.size,3);e.uniform3fv(this.addr,n)}function mo(e,t){const n=Vi(t,this.size,4);e.uniform4fv(this.addr,n)}function go(e,t){const n=Vi(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function vo(e,t){const n=Vi(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function yo(e,t){const n=Vi(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function bo(e,t){e.uniform1iv(this.addr,t)}function _o(e,t){e.uniform2iv(this.addr,t)}function xo(e,t){e.uniform3iv(this.addr,t)}function wo(e,t){e.uniform4iv(this.addr,t)}function So(e,t){e.uniform1uiv(this.addr,t)}function Eo(e,t){e.uniform2uiv(this.addr,t)}function To(e,t){e.uniform3uiv(this.addr,t)}function Mo(e,t){e.uniform4uiv(this.addr,t)}function Ao(e,t,n){const r=this.cache,i=t.length,o=Wi(n,i);Gi(r,o)||(e.uniform1iv(this.addr,o),Hi(r,o));for(let e=0;e!==i;++e)n.setTexture2D(t[e]||Ni,o[e])}function Co(e,t,n){const r=this.cache,i=t.length,o=Wi(n,i);Gi(r,o)||(e.uniform1iv(this.addr,o),Hi(r,o));for(let e=0;e!==i;++e)n.setTexture3D(t[e]||Di,o[e])}function Oo(e,t,n){const r=this.cache,i=t.length,o=Wi(n,i);Gi(r,o)||(e.uniform1iv(this.addr,o),Hi(r,o));for(let e=0;e!==i;++e)n.setTextureCube(t[e]||Li,o[e])}function Po(e,t,n){const r=this.cache,i=t.length,o=Wi(n,i);Gi(r,o)||(e.uniform1iv(this.addr,o),Hi(r,o));for(let e=0;e!==i;++e)n.setTexture2DArray(t[e]||ki,o[e])}class Ro{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return qi;case 35664:return Xi;case 35665:return Zi;case 35666:return $i;case 35674:return Yi;case 35675:return Ki;case 35676:return Qi;case 5124:case 35670:return Ji;case 35667:case 35671:return eo;case 35668:case 35672:return to;case 35669:case 35673:return no;case 5125:return ro;case 36294:return io;case 36295:return oo;case 36296:return so;case 35678:case 36198:case 36298:case 36306:case 35682:return ao;case 35679:case 36299:case 36307:return uo;case 35680:case 36300:case 36308:case 36293:return co;case 36289:case 36303:case 36311:case 36292:return lo}}(t.type)}}class No{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return ho;case 35664:return fo;case 35665:return po;case 35666:return mo;case 35674:return go;case 35675:return vo;case 35676:return yo;case 5124:case 35670:return bo;case 35667:case 35671:return _o;case 35668:case 35672:return xo;case 35669:case 35673:return wo;case 5125:return So;case 36294:return Eo;case 36295:return To;case 36296:return Mo;case 35678:case 36198:case 36298:case 36306:case 35682:return Ao;case 35679:case 36299:case 36307:return Co;case 35680:case 36300:case 36308:case 36293:return Oo;case 36289:case 36303:case 36311:case 36292:return Po}}(t.type)}}class Io{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let i=0,o=r.length;i!==o;++i){const o=r[i];o.setValue(e,t[o.id],n)}}}const ko=/(\w+)(\])?(\[|\.)?/g;function Do(e,t){e.seq.push(t),e.map[t.id]=t}function Lo(e,t,n){const r=e.name,i=r.length;for(ko.lastIndex=0;;){const o=ko.exec(r),s=ko.lastIndex;let a=o[1];const u="]"===o[2],c=o[3];if(u&&(a|=0),void 0===c||"["===c&&s+2===i){Do(n,void 0===c?new Ro(a,e,t):new No(a,e,t));break}{let e=n.map[a];void 0===e&&(e=new Io(a),Do(n,e)),n=e}}}class Uo{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const n=e.getActiveUniform(t,r);Lo(n,e.getUniformLocation(t,n.name),this)}}setValue(e,t,n,r){const i=this.map[t];void 0!==i&&i.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let i=0,o=t.length;i!==o;++i){const o=t[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,i=e.length;r!==i;++r){const i=e[r];i.id in t&&n.push(i)}return n}}function Fo(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}let Bo=0;const zo=new Ze;function jo(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(r&&""===i)return"";const o=/ERROR: 0:(\d+)/.exec(i);if(o){const r=parseInt(o[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){const n=e.split("\n"),r=[],i=Math.max(t-6,0),o=Math.min(t+6,n.length);for(let e=i;e<o;e++){const i=e+1;r.push(`${i===t?">":" "} ${i}: ${n[e]}`)}return r.join("\n")}(e.getShaderSource(t),r)}return i}function Vo(e,t){const n=function(e){tt._getMatrix(zo,tt.workingColorSpace,e);const t=`mat3( ${zo.elements.map((e=>e.toFixed(4)))} )`;switch(tt.getTransfer(e)){case Ce:return[t,"LinearTransferOETF"];case Oe:return[t,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",e),[t,"LinearTransferOETF"]}}(t);return[`vec4 ${e}( vec4 value ) {`,`\treturn ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join("\n")}function Go(e,t){let n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Cineon";break;case 4:n="ACESFilmic";break;case 6:n="AgX";break;case 7:n="Neutral";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const Ho=new wt;function Wo(){tt.getLuminanceCoefficients(Ho);return["float luminance( const in vec3 rgb ) {",`\tconst vec3 weights = vec3( ${Ho.x.toFixed(4)}, ${Ho.y.toFixed(4)}, ${Ho.z.toFixed(4)} );`,"\treturn dot( weights, rgb );","}"].join("\n")}function qo(e){return""!==e}function Xo(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Zo(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const $o=/^[ \t]*#include +<([\w\d./]+)>/gm;function Yo(e){return e.replace($o,Qo)}const Ko=new Map;function Qo(e,t){let n=Zr[t];if(void 0===n){const e=Ko.get(t);if(void 0===e)throw new Error("Can not resolve #include <"+t+">");n=Zr[e],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e)}return Yo(n)}const Jo=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function es(e){return e.replace(Jo,ts)}function ts(e,t,n,r){let i="";for(let e=parseInt(t);e<parseInt(n);e++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return i}function ns(e){let t=`precision ${e.precision} float;\n\tprecision ${e.precision} int;\n\tprecision ${e.precision} sampler2D;\n\tprecision ${e.precision} samplerCube;\n\tprecision ${e.precision} sampler3D;\n\tprecision ${e.precision} sampler2DArray;\n\tprecision ${e.precision} sampler2DShadow;\n\tprecision ${e.precision} samplerCubeShadow;\n\tprecision ${e.precision} sampler2DArrayShadow;\n\tprecision ${e.precision} isampler2D;\n\tprecision ${e.precision} isampler3D;\n\tprecision ${e.precision} isamplerCube;\n\tprecision ${e.precision} isampler2DArray;\n\tprecision ${e.precision} usampler2D;\n\tprecision ${e.precision} usampler3D;\n\tprecision ${e.precision} usamplerCube;\n\tprecision ${e.precision} usampler2DArray;\n\t`;return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function rs(e,t,n,r){const i=e.getContext(),o=n.defines;let s=n.vertexShader,a=n.fragmentShader;const u=function(e){let t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),c=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case l:case h:t="ENVMAP_TYPE_CUBE";break;case p:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),d=function(e){let t="ENVMAP_MODE_REFLECTION";e.envMap&&e.envMapMode===h&&(t="ENVMAP_MODE_REFRACTION");return t}(n),f=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),m=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),g=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(qo).join("\n")}(n),v=function(e){const t=[];for(const n in e){const r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(o),y=i.createProgram();let b,_,x=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(b=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v].filter(qo).join("\n"),b.length>0&&(b+="\n"),_=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v].filter(qo).join("\n"),_.length>0&&(_+="\n")):(b=[ns(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(qo).join("\n"),_=[ns(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+d:"",n.envMap?"#define "+f:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?Zr.tonemapping_pars_fragment:"",0!==n.toneMapping?Go("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Zr.colorspace_pars_fragment,Vo("linearToOutputTexel",n.outputColorSpace),Wo(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(qo).join("\n")),s=Yo(s),s=Xo(s,n),s=Zo(s,n),a=Yo(a),a=Xo(a,n),a=Zo(a,n),s=es(s),a=es(a),!0!==n.isRawShaderMaterial&&(x="#version 300 es\n",b=[g,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+b,_=["#define varying in",n.glslVersion===Ne?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Ne?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+_);const w=x+b+s,S=x+_+a,E=Fo(i,i.VERTEX_SHADER,w),T=Fo(i,i.FRAGMENT_SHADER,S);function M(t){if(e.debug.checkShaderErrors){const n=i.getProgramInfoLog(y).trim(),r=i.getShaderInfoLog(E).trim(),o=i.getShaderInfoLog(T).trim();let s=!0,a=!0;if(!1===i.getProgramParameter(y,i.LINK_STATUS))if(s=!1,"function"==typeof e.debug.onShaderError)e.debug.onShaderError(i,y,E,T);else{const e=jo(i,E,"vertex"),r=jo(i,T,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(y,i.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+n+"\n"+e+"\n"+r)}else""!==n?console.warn("THREE.WebGLProgram: Program Info Log:",n):""!==r&&""!==o||(a=!1);a&&(t.diagnostics={runnable:s,programLog:n,vertexShader:{log:r,prefix:b},fragmentShader:{log:o,prefix:_}})}i.deleteShader(E),i.deleteShader(T),A=new Uo(i,y),C=function(e,t){const n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i),o=r.name;let s=1;r.type===e.FLOAT_MAT2&&(s=2),r.type===e.FLOAT_MAT3&&(s=3),r.type===e.FLOAT_MAT4&&(s=4),n[o]={type:r.type,location:e.getAttribLocation(t,o),locationSize:s}}return n}(i,y)}let A,C;i.attachShader(y,E),i.attachShader(y,T),void 0!==n.index0AttributeName?i.bindAttribLocation(y,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(y,0,"position"),i.linkProgram(y),this.getUniforms=function(){return void 0===A&&M(this),A},this.getAttributes=function(){return void 0===C&&M(this),C};let O=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===O&&(O=i.getProgramParameter(y,37297)),O},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(y),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=Bo++,this.cacheKey=t,this.usedTimes=1,this.program=y,this.vertexShader=E,this.fragmentShader=T,this}let is=0;class os{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(i)&&(o.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const e of t)e.usedTimes--,0===e.usedTimes&&this.shaderCache.delete(e.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new ss(e),t.set(e,n)),n}}class ss{constructor(e){this.id=is++,this.code=e,this.usedTimes=0}}function as(e,t,n,r,i,o,s){const a=new ln,u=new os,c=new Set,l=[],h=i.logarithmicDepthBuffer,d=i.vertexTextures;let f=i.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(e){return c.add(e),0===e?"uv":`uv${e}`}return{getParameters:function(o,a,l,v,y){const b=v.fog,_=y.geometry,x=o.isMeshStandardMaterial?v.environment:null,w=(o.isMeshStandardMaterial?n:t).get(o.envMap||x),S=w&&w.mapping===p?w.image.height:null,E=m[o.type];null!==o.precision&&(f=i.getMaxPrecision(o.precision),f!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",f,"instead."));const T=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,M=void 0!==T?T.length:0;let A,C,O,P,R=0;if(void 0!==_.morphAttributes.position&&(R=1),void 0!==_.morphAttributes.normal&&(R=2),void 0!==_.morphAttributes.color&&(R=3),E){const e=Yr[E];A=e.vertexShader,C=e.fragmentShader}else A=o.vertexShader,C=o.fragmentShader,u.update(o),O=u.getVertexShaderID(o),P=u.getFragmentShaderID(o);const N=e.getRenderTarget(),I=e.state.buffers.depth.getReversed(),k=!0===y.isInstancedMesh,D=!0===y.isBatchedMesh,L=!!o.map,U=!!o.matcap,F=!!w,B=!!o.aoMap,z=!!o.lightMap,j=!!o.bumpMap,V=!!o.normalMap,G=!!o.displacementMap,H=!!o.emissiveMap,W=!!o.metalnessMap,q=!!o.roughnessMap,X=o.anisotropy>0,Z=o.clearcoat>0,$=o.dispersion>0,Y=o.iridescence>0,K=o.sheen>0,Q=o.transmission>0,J=X&&!!o.anisotropyMap,ee=Z&&!!o.clearcoatMap,te=Z&&!!o.clearcoatNormalMap,ne=Z&&!!o.clearcoatRoughnessMap,re=Y&&!!o.iridescenceMap,ie=Y&&!!o.iridescenceThicknessMap,oe=K&&!!o.sheenColorMap,se=K&&!!o.sheenRoughnessMap,ae=!!o.specularMap,ue=!!o.specularColorMap,ce=!!o.specularIntensityMap,le=Q&&!!o.transmissionMap,he=Q&&!!o.thicknessMap,de=!!o.gradientMap,fe=!!o.alphaMap,pe=o.alphaTest>0,me=!!o.alphaHash,ge=!!o.extensions;let ve=0;o.toneMapped&&(null!==N&&!0!==N.isXRRenderTarget||(ve=e.toneMapping));const ye={shaderID:E,shaderType:o.type,shaderName:o.name,vertexShader:A,fragmentShader:C,defines:o.defines,customVertexShaderID:O,customFragmentShaderID:P,isRawShaderMaterial:!0===o.isRawShaderMaterial,glslVersion:o.glslVersion,precision:f,batching:D,batchingColor:D&&null!==y._colorsTexture,instancing:k,instancingColor:k&&null!==y.instanceColor,instancingMorph:k&&null!==y.morphTexture,supportsVertexTextures:d,outputColorSpace:null===N?e.outputColorSpace:!0===N.isXRRenderTarget?N.texture.colorSpace:Ae,alphaToCoverage:!!o.alphaToCoverage,map:L,matcap:U,envMap:F,envMapMode:F&&w.mapping,envMapCubeUVHeight:S,aoMap:B,lightMap:z,bumpMap:j,normalMap:V,displacementMap:d&&G,emissiveMap:H,normalMapObjectSpace:V&&1===o.normalMapType,normalMapTangentSpace:V&&0===o.normalMapType,metalnessMap:W,roughnessMap:q,anisotropy:X,anisotropyMap:J,clearcoat:Z,clearcoatMap:ee,clearcoatNormalMap:te,clearcoatRoughnessMap:ne,dispersion:$,iridescence:Y,iridescenceMap:re,iridescenceThicknessMap:ie,sheen:K,sheenColorMap:oe,sheenRoughnessMap:se,specularMap:ae,specularColorMap:ue,specularIntensityMap:ce,transmission:Q,transmissionMap:le,thicknessMap:he,gradientMap:de,opaque:!1===o.transparent&&1===o.blending&&!1===o.alphaToCoverage,alphaMap:fe,alphaTest:pe,alphaHash:me,combine:o.combine,mapUv:L&&g(o.map.channel),aoMapUv:B&&g(o.aoMap.channel),lightMapUv:z&&g(o.lightMap.channel),bumpMapUv:j&&g(o.bumpMap.channel),normalMapUv:V&&g(o.normalMap.channel),displacementMapUv:G&&g(o.displacementMap.channel),emissiveMapUv:H&&g(o.emissiveMap.channel),metalnessMapUv:W&&g(o.metalnessMap.channel),roughnessMapUv:q&&g(o.roughnessMap.channel),anisotropyMapUv:J&&g(o.anisotropyMap.channel),clearcoatMapUv:ee&&g(o.clearcoatMap.channel),clearcoatNormalMapUv:te&&g(o.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ne&&g(o.clearcoatRoughnessMap.channel),iridescenceMapUv:re&&g(o.iridescenceMap.channel),iridescenceThicknessMapUv:ie&&g(o.iridescenceThicknessMap.channel),sheenColorMapUv:oe&&g(o.sheenColorMap.channel),sheenRoughnessMapUv:se&&g(o.sheenRoughnessMap.channel),specularMapUv:ae&&g(o.specularMap.channel),specularColorMapUv:ue&&g(o.specularColorMap.channel),specularIntensityMapUv:ce&&g(o.specularIntensityMap.channel),transmissionMapUv:le&&g(o.transmissionMap.channel),thicknessMapUv:he&&g(o.thicknessMap.channel),alphaMapUv:fe&&g(o.alphaMap.channel),vertexTangents:!!_.attributes.tangent&&(V||X),vertexColors:o.vertexColors,vertexAlphas:!0===o.vertexColors&&!!_.attributes.color&&4===_.attributes.color.itemSize,pointsUvs:!0===y.isPoints&&!!_.attributes.uv&&(L||fe),fog:!!b,useFog:!0===o.fog,fogExp2:!!b&&b.isFogExp2,flatShading:!0===o.flatShading,sizeAttenuation:!0===o.sizeAttenuation,logarithmicDepthBuffer:h,reverseDepthBuffer:I,skinning:!0===y.isSkinnedMesh,morphTargets:void 0!==_.morphAttributes.position,morphNormals:void 0!==_.morphAttributes.normal,morphColors:void 0!==_.morphAttributes.color,morphTargetsCount:M,morphTextureStride:R,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numSpotLightMaps:a.spotLightMap.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numSpotLightShadowsWithMaps:a.numSpotLightShadowsWithMaps,numLightProbes:a.numLightProbes,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:o.dithering,shadowMapEnabled:e.shadowMap.enabled&&l.length>0,shadowMapType:e.shadowMap.type,toneMapping:ve,decodeVideoTexture:L&&!0===o.map.isVideoTexture&&tt.getTransfer(o.map.colorSpace)===Oe,decodeVideoTextureEmissive:H&&!0===o.emissiveMap.isVideoTexture&&tt.getTransfer(o.emissiveMap.colorSpace)===Oe,premultipliedAlpha:o.premultipliedAlpha,doubleSided:2===o.side,flipSided:1===o.side,useDepthPacking:o.depthPacking>=0,depthPacking:o.depthPacking||0,index0AttributeName:o.index0AttributeName,extensionClipCullDistance:ge&&!0===o.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ge&&!0===o.extensions.multiDraw||D)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:o.customProgramCacheKey()};return ye.vertexUv1s=c.has(1),ye.vertexUv2s=c.has(2),ye.vertexUv3s=c.has(3),c.clear(),ye},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){a.disableAll(),t.supportsVertexTextures&&a.enable(0);t.instancing&&a.enable(1);t.instancingColor&&a.enable(2);t.instancingMorph&&a.enable(3);t.matcap&&a.enable(4);t.envMap&&a.enable(5);t.normalMapObjectSpace&&a.enable(6);t.normalMapTangentSpace&&a.enable(7);t.clearcoat&&a.enable(8);t.iridescence&&a.enable(9);t.alphaTest&&a.enable(10);t.vertexColors&&a.enable(11);t.vertexAlphas&&a.enable(12);t.vertexUv1s&&a.enable(13);t.vertexUv2s&&a.enable(14);t.vertexUv3s&&a.enable(15);t.vertexTangents&&a.enable(16);t.anisotropy&&a.enable(17);t.alphaHash&&a.enable(18);t.batching&&a.enable(19);t.dispersion&&a.enable(20);t.batchingColor&&a.enable(21);e.push(a.mask),a.disableAll(),t.fog&&a.enable(0);t.useFog&&a.enable(1);t.flatShading&&a.enable(2);t.logarithmicDepthBuffer&&a.enable(3);t.reverseDepthBuffer&&a.enable(4);t.skinning&&a.enable(5);t.morphTargets&&a.enable(6);t.morphNormals&&a.enable(7);t.morphColors&&a.enable(8);t.premultipliedAlpha&&a.enable(9);t.shadowMapEnabled&&a.enable(10);t.doubleSided&&a.enable(11);t.flipSided&&a.enable(12);t.useDepthPacking&&a.enable(13);t.dithering&&a.enable(14);t.transmission&&a.enable(15);t.sheen&&a.enable(16);t.opaque&&a.enable(17);t.pointsUvs&&a.enable(18);t.decodeVideoTexture&&a.enable(19);t.decodeVideoTextureEmissive&&a.enable(20);t.alphaToCoverage&&a.enable(21);e.push(a.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=m[e.type];let n;if(t){const e=Yr[t];n=Ar.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let r;for(let e=0,t=l.length;e<t;e++){const t=l[e];if(t.cacheKey===n){r=t,++r.usedTimes;break}}return void 0===r&&(r=new rs(e,n,t,o),l.push(r)),r},releaseProgram:function(e){if(0==--e.usedTimes){const t=l.indexOf(e);l[t]=l[l.length-1],l.pop(),e.destroy()}},releaseShaderCache:function(e){u.remove(e)},programs:l,dispose:function(){u.dispose()}}}function us(){let e=new WeakMap;return{has:function(t){return e.has(t)},get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function cs(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function ls(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function hs(){const e=[];let t=0;const n=[],r=[],i=[];function o(n,r,i,o,s,a){let u=e[t];return void 0===u?(u={id:n.id,object:n,geometry:r,material:i,groupOrder:o,renderOrder:n.renderOrder,z:s,group:a},e[t]=u):(u.id=n.id,u.object=n,u.geometry=r,u.material=i,u.groupOrder=o,u.renderOrder=n.renderOrder,u.z=s,u.group=a),t++,u}return{opaque:n,transmissive:r,transparent:i,init:function(){t=0,n.length=0,r.length=0,i.length=0},push:function(e,t,s,a,u,c){const l=o(e,t,s,a,u,c);s.transmission>0?r.push(l):!0===s.transparent?i.push(l):n.push(l)},unshift:function(e,t,s,a,u,c){const l=o(e,t,s,a,u,c);s.transmission>0?r.unshift(l):!0===s.transparent?i.unshift(l):n.unshift(l)},finish:function(){for(let n=t,r=e.length;n<r;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||cs),r.length>1&&r.sort(t||ls),i.length>1&&i.sort(t||ls)}}}function ds(){let e=new WeakMap;return{get:function(t,n){const r=e.get(t);let i;return void 0===r?(i=new hs,e.set(t,[i])):n>=r.length?(i=new hs,r.push(i)):i=r[n],i},dispose:function(){e=new WeakMap}}}function fs(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new wt,color:new Wn};break;case"SpotLight":n={position:new wt,direction:new wt,color:new Wn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new wt,color:new Wn,distance:0,decay:0};break;case"HemisphereLight":n={direction:new wt,skyColor:new Wn,groundColor:new Wn};break;case"RectAreaLight":n={color:new Wn,position:new wt,halfWidth:new wt,halfHeight:new wt}}return e[t.id]=n,n}}}let ps=0;function ms(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function gs(e){const t=new fs,n=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let e=0;e<9;e++)r.probe.push(new wt);const i=new wt,o=new Qt,s=new Qt;return{setup:function(i){let o=0,s=0,a=0;for(let e=0;e<9;e++)r.probe[e].set(0,0,0);let u=0,c=0,l=0,h=0,d=0,f=0,p=0,m=0,g=0,v=0,y=0;i.sort(ms);for(let e=0,b=i.length;e<b;e++){const b=i[e],_=b.color,x=b.intensity,w=b.distance,S=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)o+=_.r*x,s+=_.g*x,a+=_.b*x;else if(b.isLightProbe){for(let e=0;e<9;e++)r.probe[e].addScaledVector(b.sh.coefficients[e],x);y++}else if(b.isDirectionalLight){const e=t.get(b);if(e.color.copy(b.color).multiplyScalar(b.intensity),b.castShadow){const e=b.shadow,t=n.get(b);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,r.directionalShadow[u]=t,r.directionalShadowMap[u]=S,r.directionalShadowMatrix[u]=b.shadow.matrix,f++}r.directional[u]=e,u++}else if(b.isSpotLight){const e=t.get(b);e.position.setFromMatrixPosition(b.matrixWorld),e.color.copy(_).multiplyScalar(x),e.distance=w,e.coneCos=Math.cos(b.angle),e.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),e.decay=b.decay,r.spot[l]=e;const i=b.shadow;if(b.map&&(r.spotLightMap[g]=b.map,g++,i.updateMatrices(b),b.castShadow&&v++),r.spotLightMatrix[l]=i.matrix,b.castShadow){const e=n.get(b);e.shadowIntensity=i.intensity,e.shadowBias=i.bias,e.shadowNormalBias=i.normalBias,e.shadowRadius=i.radius,e.shadowMapSize=i.mapSize,r.spotShadow[l]=e,r.spotShadowMap[l]=S,m++}l++}else if(b.isRectAreaLight){const e=t.get(b);e.color.copy(_).multiplyScalar(x),e.halfWidth.set(.5*b.width,0,0),e.halfHeight.set(0,.5*b.height,0),r.rectArea[h]=e,h++}else if(b.isPointLight){const e=t.get(b);if(e.color.copy(b.color).multiplyScalar(b.intensity),e.distance=b.distance,e.decay=b.decay,b.castShadow){const e=b.shadow,t=n.get(b);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,t.shadowCameraNear=e.camera.near,t.shadowCameraFar=e.camera.far,r.pointShadow[c]=t,r.pointShadowMap[c]=S,r.pointShadowMatrix[c]=b.shadow.matrix,p++}r.point[c]=e,c++}else if(b.isHemisphereLight){const e=t.get(b);e.skyColor.copy(b.color).multiplyScalar(x),e.groundColor.copy(b.groundColor).multiplyScalar(x),r.hemi[d]=e,d++}}h>0&&(!0===e.has("OES_texture_float_linear")?(r.rectAreaLTC1=$r.LTC_FLOAT_1,r.rectAreaLTC2=$r.LTC_FLOAT_2):(r.rectAreaLTC1=$r.LTC_HALF_1,r.rectAreaLTC2=$r.LTC_HALF_2)),r.ambient[0]=o,r.ambient[1]=s,r.ambient[2]=a;const b=r.hash;b.directionalLength===u&&b.pointLength===c&&b.spotLength===l&&b.rectAreaLength===h&&b.hemiLength===d&&b.numDirectionalShadows===f&&b.numPointShadows===p&&b.numSpotShadows===m&&b.numSpotMaps===g&&b.numLightProbes===y||(r.directional.length=u,r.spot.length=l,r.rectArea.length=h,r.point.length=c,r.hemi.length=d,r.directionalShadow.length=f,r.directionalShadowMap.length=f,r.pointShadow.length=p,r.pointShadowMap.length=p,r.spotShadow.length=m,r.spotShadowMap.length=m,r.directionalShadowMatrix.length=f,r.pointShadowMatrix.length=p,r.spotLightMatrix.length=m+g-v,r.spotLightMap.length=g,r.numSpotLightShadowsWithMaps=v,r.numLightProbes=y,b.directionalLength=u,b.pointLength=c,b.spotLength=l,b.rectAreaLength=h,b.hemiLength=d,b.numDirectionalShadows=f,b.numPointShadows=p,b.numSpotShadows=m,b.numSpotMaps=g,b.numLightProbes=y,r.version=ps++)},setupView:function(e,t){let n=0,a=0,u=0,c=0,l=0;const h=t.matrixWorldInverse;for(let t=0,d=e.length;t<d;t++){const d=e[t];if(d.isDirectionalLight){const e=r.directional[n];e.direction.setFromMatrixPosition(d.matrixWorld),i.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(i),e.direction.transformDirection(h),n++}else if(d.isSpotLight){const e=r.spot[u];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(d.matrixWorld),i.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(i),e.direction.transformDirection(h),u++}else if(d.isRectAreaLight){const e=r.rectArea[c];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),s.identity(),o.copy(d.matrixWorld),o.premultiply(h),s.extractRotation(o),e.halfWidth.set(.5*d.width,0,0),e.halfHeight.set(0,.5*d.height,0),e.halfWidth.applyMatrix4(s),e.halfHeight.applyMatrix4(s),c++}else if(d.isPointLight){const e=r.point[a];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),a++}else if(d.isHemisphereLight){const e=r.hemi[l];e.direction.setFromMatrixPosition(d.matrixWorld),e.direction.transformDirection(h),l++}}},state:r}}function vs(e){const t=new gs(e),n=[],r=[];const i={lightsArray:n,shadowsArray:r,camera:null,lights:t,transmissionRenderTarget:{}};return{init:function(e){i.camera=e,n.length=0,r.length=0},state:i,setupLights:function(){t.setup(n)},setupLightsView:function(e){t.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){r.push(e)}}}function ys(e){let t=new WeakMap;return{get:function(n,r=0){const i=t.get(n);let o;return void 0===i?(o=new vs(e),t.set(n,[o])):r>=i.length?(o=new vs(e),i.push(o)):o=i[r],o},dispose:function(){t=new WeakMap}}}class bs extends Zn{static get type(){return"MeshDepthMaterial"}constructor(e){super(),this.isMeshDepthMaterial=!0,this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class _s extends Zn{static get type(){return"MeshDistanceMaterial"}constructor(e){super(),this.isMeshDistanceMaterial=!0,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function xs(e,t,n){let r=new Hr;const i=new Xe,o=new Xe,s=new gt,a=new bs({depthPacking:3201}),u=new _s,c={},l=n.maxTextureSize,h={0:1,1:0,2:2},d=new Cr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Xe},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new cr;p.setAttribute("position",new Qn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new xr(p,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;let v=this.type;function b(n,r){const o=t.update(m);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,f.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new yt(i.x,i.y)),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,o,d,m,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,o,f,m,null)}function _(t,n,r,i){let o=null;const s=!0===r.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==s)o=s;else if(o=!0===r.isPointLight?u:a,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0){const e=o.uuid,t=n.uuid;let r=c[e];void 0===r&&(r={},c[e]=r);let i=r[t];void 0===i&&(i=o.clone(),r[t]=i,n.addEventListener("dispose",w)),o=i}if(o.visible=n.visible,o.wireframe=n.wireframe,o.side=3===i?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:h[n.side],o.alphaMap=n.alphaMap,o.alphaTest=n.alphaTest,o.map=n.map,o.clipShadows=n.clipShadows,o.clippingPlanes=n.clippingPlanes,o.clipIntersection=n.clipIntersection,o.displacementMap=n.displacementMap,o.displacementScale=n.displacementScale,o.displacementBias=n.displacementBias,o.wireframeLinewidth=n.wireframeLinewidth,o.linewidth=n.linewidth,!0===r.isPointLight&&!0===o.isMeshDistanceMaterial){e.properties.get(o).light=r}return o}function x(n,i,o,s,a){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===a)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);const r=t.update(n),u=n.material;if(Array.isArray(u)){const t=r.groups;for(let c=0,l=t.length;c<l;c++){const l=t[c],h=u[l.materialIndex];if(h&&h.visible){const t=_(n,h,s,a);n.onBeforeShadow(e,n,i,o,r,t,l),e.renderBufferDirect(o,null,r,t,n,l),n.onAfterShadow(e,n,i,o,r,t,l)}}}else if(u.visible){const t=_(n,u,s,a);n.onBeforeShadow(e,n,i,o,r,t,null),e.renderBufferDirect(o,null,r,t,n,null),n.onAfterShadow(e,n,i,o,r,t,null)}}const u=n.children;for(let e=0,t=u.length;e<t;e++)x(u[e],i,o,s,a)}function w(e){e.target.removeEventListener("dispose",w);for(const t in c){const n=c[t],r=e.target.uuid;if(r in n){n[r].dispose(),delete n[r]}}}this.render=function(t,n,a){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===t.length)return;const u=e.getRenderTarget(),c=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),d=e.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);const f=3!==v&&3===this.type,p=3===v&&3!==this.type;for(let u=0,c=t.length;u<c;u++){const c=t[u],h=c.shadow;if(void 0===h){console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");continue}if(!1===h.autoUpdate&&!1===h.needsUpdate)continue;i.copy(h.mapSize);const m=h.getFrameExtents();if(i.multiply(m),o.copy(h.mapSize),(i.x>l||i.y>l)&&(i.x>l&&(o.x=Math.floor(l/m.x),i.x=o.x*m.x,h.mapSize.x=o.x),i.y>l&&(o.y=Math.floor(l/m.y),i.y=o.y*m.y,h.mapSize.y=o.y)),null===h.map||!0===f||!0===p){const e=3!==this.type?{minFilter:y,magFilter:y}:{};null!==h.map&&h.map.dispose(),h.map=new yt(i.x,i.y,e),h.map.texture.name=c.name+".shadowMap",h.camera.updateProjectionMatrix()}e.setRenderTarget(h.map),e.clear();const g=h.getViewportCount();for(let e=0;e<g;e++){const t=h.getViewport(e);s.set(o.x*t.x,o.y*t.y,o.x*t.z,o.y*t.w),d.viewport(s),h.updateMatrices(c,e),r=h.getFrustum(),x(n,a,h.camera,c,this.type)}!0!==h.isPointLightShadow&&3===this.type&&b(h,a),h.needsUpdate=!1}v=this.type,g.needsUpdate=!1,e.setRenderTarget(u,c,h)}}const ws={0:1,2:6,4:7,3:5,1:0,6:2,7:4,5:3};function Ss(e,t){const n=new function(){let t=!1;const n=new gt;let r=null;const i=new gt(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,o,s,a){!0===a&&(t*=s,r*=s,o*=s),n.set(t,r,o,s),!1===i.equals(n)&&(e.clearColor(t,r,o,s),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},r=new function(){let n=!1,r=!1,i=null,o=null,s=null;return{setReversed:function(e){if(r!==e){const e=t.get("EXT_clip_control");r?e.clipControlEXT(e.LOWER_LEFT_EXT,e.ZERO_TO_ONE_EXT):e.clipControlEXT(e.LOWER_LEFT_EXT,e.NEGATIVE_ONE_TO_ONE_EXT);const n=s;s=null,this.setClear(n)}r=e},getReversed:function(){return r},setTest:function(t){t?j(e.DEPTH_TEST):V(e.DEPTH_TEST)},setMask:function(t){i===t||n||(e.depthMask(t),i=t)},setFunc:function(t){if(r&&(t=ws[t]),o!==t){switch(t){case 0:e.depthFunc(e.NEVER);break;case 1:e.depthFunc(e.ALWAYS);break;case 2:e.depthFunc(e.LESS);break;case 3:default:e.depthFunc(e.LEQUAL);break;case 4:e.depthFunc(e.EQUAL);break;case 5:e.depthFunc(e.GEQUAL);break;case 6:e.depthFunc(e.GREATER);break;case 7:e.depthFunc(e.NOTEQUAL)}o=t}},setLocked:function(e){n=e},setClear:function(t){s!==t&&(r&&(t=1-t),e.clearDepth(t),s=t)},reset:function(){n=!1,i=null,o=null,s=null,r=!1}}},i=new function(){let t=!1,n=null,r=null,i=null,o=null,s=null,a=null,u=null,c=null;return{setTest:function(n){t||(n?j(e.STENCIL_TEST):V(e.STENCIL_TEST))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,s){r===t&&i===n&&o===s||(e.stencilFunc(t,n,s),r=t,i=n,o=s)},setOp:function(t,n,r){s===t&&a===n&&u===r||(e.stencilOp(t,n,r),s=t,a=n,u=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,r=null,i=null,o=null,s=null,a=null,u=null,c=null}}},o=new WeakMap,s=new WeakMap;let a={},u={},l=new WeakMap,h=[],d=null,f=!1,p=null,m=null,g=null,v=null,y=null,b=null,_=null,x=new Wn(0,0,0),w=0,S=!1,E=null,T=null,M=null,A=null,C=null;const O=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let P=!1,R=0;const N=e.getParameter(e.VERSION);-1!==N.indexOf("WebGL")?(R=parseFloat(/^WebGL (\d)/.exec(N)[1]),P=R>=1):-1!==N.indexOf("OpenGL ES")&&(R=parseFloat(/^OpenGL ES (\d)/.exec(N)[1]),P=R>=2);let I=null,k={};const D=e.getParameter(e.SCISSOR_BOX),L=e.getParameter(e.VIEWPORT),U=(new gt).fromArray(D),F=(new gt).fromArray(L);function B(t,n,r,i){const o=new Uint8Array(4),s=e.createTexture();e.bindTexture(t,s),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let s=0;s<r;s++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,i,0,e.RGBA,e.UNSIGNED_BYTE,o):e.texImage2D(n+s,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,o);return s}const z={};function j(t){!0!==a[t]&&(e.enable(t),a[t]=!0)}function V(t){!1!==a[t]&&(e.disable(t),a[t]=!1)}z[e.TEXTURE_2D]=B(e.TEXTURE_2D,e.TEXTURE_2D,1),z[e.TEXTURE_CUBE_MAP]=B(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),z[e.TEXTURE_2D_ARRAY]=B(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),z[e.TEXTURE_3D]=B(e.TEXTURE_3D,e.TEXTURE_3D,1,1),n.setClear(0,0,0,1),r.setClear(1),i.setClear(0),j(e.DEPTH_TEST),r.setFunc(3),q(!1),X(1),j(e.CULL_FACE),W(0);const G={[c]:e.FUNC_ADD,101:e.FUNC_SUBTRACT,102:e.FUNC_REVERSE_SUBTRACT};G[103]=e.MIN,G[104]=e.MAX;const H={200:e.ZERO,201:e.ONE,202:e.SRC_COLOR,204:e.SRC_ALPHA,210:e.SRC_ALPHA_SATURATE,208:e.DST_COLOR,206:e.DST_ALPHA,203:e.ONE_MINUS_SRC_COLOR,205:e.ONE_MINUS_SRC_ALPHA,209:e.ONE_MINUS_DST_COLOR,207:e.ONE_MINUS_DST_ALPHA,211:e.CONSTANT_COLOR,212:e.ONE_MINUS_CONSTANT_COLOR,213:e.CONSTANT_ALPHA,214:e.ONE_MINUS_CONSTANT_ALPHA};function W(t,n,r,i,o,s,a,u,l,h){if(0!==t){if(!1===f&&(j(e.BLEND),f=!0),5===t)o=o||n,s=s||r,a=a||i,n===m&&o===y||(e.blendEquationSeparate(G[n],G[o]),m=n,y=o),r===g&&i===v&&s===b&&a===_||(e.blendFuncSeparate(H[r],H[i],H[s],H[a]),g=r,v=i,b=s,_=a),!1!==u.equals(x)&&l===w||(e.blendColor(u.r,u.g,u.b,l),x.copy(u),w=l),p=t,S=!1;else if(t!==p||h!==S){if(m===c&&y===c||(e.blendEquation(e.FUNC_ADD),m=c,y=c),h)switch(t){case 1:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.ONE,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}g=null,v=null,b=null,_=null,x.set(0,0,0),w=0,p=t,S=h}}else!0===f&&(V(e.BLEND),f=!1)}function q(t){E!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),E=t)}function X(t){0!==t?(j(e.CULL_FACE),t!==T&&(1===t?e.cullFace(e.BACK):2===t?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):V(e.CULL_FACE),T=t}function Z(t,n,r){t?(j(e.POLYGON_OFFSET_FILL),A===n&&C===r||(e.polygonOffset(n,r),A=n,C=r)):V(e.POLYGON_OFFSET_FILL)}return{buffers:{color:n,depth:r,stencil:i},enable:j,disable:V,bindFramebuffer:function(t,n){return u[t]!==n&&(e.bindFramebuffer(t,n),u[t]=n,t===e.DRAW_FRAMEBUFFER&&(u[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(u[e.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(t,n){let r=h,i=!1;if(t){r=l.get(n),void 0===r&&(r=[],l.set(n,r));const o=t.textures;if(r.length!==o.length||r[0]!==e.COLOR_ATTACHMENT0){for(let t=0,n=o.length;t<n;t++)r[t]=e.COLOR_ATTACHMENT0+t;r.length=o.length,i=!0}}else r[0]!==e.BACK&&(r[0]=e.BACK,i=!0);i&&e.drawBuffers(r)},useProgram:function(t){return d!==t&&(e.useProgram(t),d=t,!0)},setBlending:W,setMaterial:function(t,o){2===t.side?V(e.CULL_FACE):j(e.CULL_FACE);let s=1===t.side;o&&(s=!s),q(s),1===t.blending&&!1===t.transparent?W(0):W(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),r.setFunc(t.depthFunc),r.setTest(t.depthTest),r.setMask(t.depthWrite),n.setMask(t.colorWrite);const a=t.stencilWrite;i.setTest(a),a&&(i.setMask(t.stencilWriteMask),i.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),i.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Z(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?j(e.SAMPLE_ALPHA_TO_COVERAGE):V(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:q,setCullFace:X,setLineWidth:function(t){t!==M&&(P&&e.lineWidth(t),M=t)},setPolygonOffset:Z,setScissorTest:function(t){t?j(e.SCISSOR_TEST):V(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+O-1),I!==t&&(e.activeTexture(t),I=t)},bindTexture:function(t,n,r){void 0===r&&(r=null===I?e.TEXTURE0+O-1:I);let i=k[r];void 0===i&&(i={type:void 0,texture:void 0},k[r]=i),i.type===t&&i.texture===n||(I!==r&&(e.activeTexture(r),I=r),e.bindTexture(t,n||z[t]),i.type=t,i.texture=n)},unbindTexture:function(){const t=k[I];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},updateUBOMapping:function(t,n){let r=s.get(n);void 0===r&&(r=new WeakMap,s.set(n,r));let i=r.get(t);void 0===i&&(i=e.getUniformBlockIndex(n,t.name),r.set(t,i))},uniformBlockBinding:function(t,n){const r=s.get(n).get(t);o.get(n)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),o.set(n,r))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===U.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),U.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),r.setReversed(!1),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),a={},I=null,k={},u={},l=new WeakMap,h=[],d=null,f=!1,p=null,m=null,g=null,v=null,y=null,b=null,_=null,x=new Wn(0,0,0),w=0,S=!1,E=null,T=null,M=null,A=null,C=null,U.set(0,0,e.canvas.width,e.canvas.height),F.set(0,0,e.canvas.width,e.canvas.height),n.reset(),r.reset(),i.reset()}}}function Es(e,t,n,r){const i=function(e){switch(e){case S:case E:return{byteLength:1,components:1};case M:case T:case P:return{byteLength:2,components:1};case R:case N:return{byteLength:2,components:4};case C:case A:case O:return{byteLength:4,components:1};case k:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${e}.`)}(r);switch(n){case 1021:case 1024:return e*t;case 1025:return e*t*2;case F:case B:return e*t/i.components*i.byteLength;case 1030:case z:return e*t*2/i.components*i.byteLength;case 1022:return e*t*3/i.components*i.byteLength;case D:case j:return e*t*4/i.components*i.byteLength;case V:case G:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case H:case W:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case X:case $:return Math.max(e,16)*Math.max(t,8)/4;case q:case Z:return Math.max(e,8)*Math.max(t,8)/2;case Y:case K:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case Q:case J:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case ee:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case te:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case ne:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case re:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case ie:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case oe:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case se:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case ae:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case ue:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case ce:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case le:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case he:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case de:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case fe:case pe:case me:return Math.ceil(e/4)*Math.ceil(t/4)*16;case 36283:case ge:return Math.ceil(e/4)*Math.ceil(t/4)*8;case ve:case ye:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function Ts(e,t,n,r,i,o,s){const a=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,u="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new Xe,l=new WeakMap;let h;const d=new WeakMap;let f=!1;try{f="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function p(e,t){return f?new OffscreenCanvas(e,t):Ke("canvas")}function E(e,t,n){let r=1;const i=re(e);if((i.width>n||i.height>n)&&(r=n/Math.max(i.width,i.height)),r<1){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof VideoFrame&&e instanceof VideoFrame){const n=Math.floor(r*i.width),o=Math.floor(r*i.height);void 0===h&&(h=p(n,o));const s=t?p(n,o):h;s.width=n,s.height=o;return s.getContext("2d").drawImage(e,0,0,n,o),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+i.width+"x"+i.height+") to ("+n+"x"+o+")."),s}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+i.width+"x"+i.height+")."),e}return e}function T(e){return e.generateMipmaps}function A(t){e.generateMipmap(t)}function P(t){return t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:t.isWebGL3DRenderTarget?e.TEXTURE_3D:t.isWebGLArrayRenderTarget||t.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D}function R(n,r,i,o,s=!1){if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let a=r;if(r===e.RED&&(i===e.FLOAT&&(a=e.R32F),i===e.HALF_FLOAT&&(a=e.R16F),i===e.UNSIGNED_BYTE&&(a=e.R8)),r===e.RED_INTEGER&&(i===e.UNSIGNED_BYTE&&(a=e.R8UI),i===e.UNSIGNED_SHORT&&(a=e.R16UI),i===e.UNSIGNED_INT&&(a=e.R32UI),i===e.BYTE&&(a=e.R8I),i===e.SHORT&&(a=e.R16I),i===e.INT&&(a=e.R32I)),r===e.RG&&(i===e.FLOAT&&(a=e.RG32F),i===e.HALF_FLOAT&&(a=e.RG16F),i===e.UNSIGNED_BYTE&&(a=e.RG8)),r===e.RG_INTEGER&&(i===e.UNSIGNED_BYTE&&(a=e.RG8UI),i===e.UNSIGNED_SHORT&&(a=e.RG16UI),i===e.UNSIGNED_INT&&(a=e.RG32UI),i===e.BYTE&&(a=e.RG8I),i===e.SHORT&&(a=e.RG16I),i===e.INT&&(a=e.RG32I)),r===e.RGB_INTEGER&&(i===e.UNSIGNED_BYTE&&(a=e.RGB8UI),i===e.UNSIGNED_SHORT&&(a=e.RGB16UI),i===e.UNSIGNED_INT&&(a=e.RGB32UI),i===e.BYTE&&(a=e.RGB8I),i===e.SHORT&&(a=e.RGB16I),i===e.INT&&(a=e.RGB32I)),r===e.RGBA_INTEGER&&(i===e.UNSIGNED_BYTE&&(a=e.RGBA8UI),i===e.UNSIGNED_SHORT&&(a=e.RGBA16UI),i===e.UNSIGNED_INT&&(a=e.RGBA32UI),i===e.BYTE&&(a=e.RGBA8I),i===e.SHORT&&(a=e.RGBA16I),i===e.INT&&(a=e.RGBA32I)),r===e.RGB&&i===e.UNSIGNED_INT_5_9_9_9_REV&&(a=e.RGB9_E5),r===e.RGBA){const t=s?Ce:tt.getTransfer(o);i===e.FLOAT&&(a=e.RGBA32F),i===e.HALF_FLOAT&&(a=e.RGBA16F),i===e.UNSIGNED_BYTE&&(a=t===Oe?e.SRGB8_ALPHA8:e.RGBA8),i===e.UNSIGNED_SHORT_4_4_4_4&&(a=e.RGBA4),i===e.UNSIGNED_SHORT_5_5_5_1&&(a=e.RGB5_A1)}return a!==e.R16F&&a!==e.R32F&&a!==e.RG16F&&a!==e.RG32F&&a!==e.RGBA16F&&a!==e.RGBA32F||t.get("EXT_color_buffer_float"),a}function N(t,n){let r;return t?null===n||n===C||n===I?r=e.DEPTH24_STENCIL8:n===O?r=e.DEPTH32F_STENCIL8:n===M&&(r=e.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===n||n===C||n===I?r=e.DEPTH_COMPONENT24:n===O?r=e.DEPTH_COMPONENT32F:n===M&&(r=e.DEPTH_COMPONENT16),r}function k(e,t){return!0===T(e)||e.isFramebufferTexture&&e.minFilter!==y&&e.minFilter!==_?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function F(e){const t=e.target;t.removeEventListener("dispose",F),function(e){const t=r.get(e);if(void 0===t.__webglInit)return;const n=e.source,i=d.get(n);if(i){const r=i[t.__cacheKey];r.usedTimes--,0===r.usedTimes&&z(e),0===Object.keys(i).length&&d.delete(n)}r.remove(e)}(t),t.isVideoTexture&&l.delete(t)}function B(t){const n=t.target;n.removeEventListener("dispose",B),function(t){const n=r.get(t);t.depthTexture&&(t.depthTexture.dispose(),r.remove(t.depthTexture));if(t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++){if(Array.isArray(n.__webglFramebuffer[t]))for(let r=0;r<n.__webglFramebuffer[t].length;r++)e.deleteFramebuffer(n.__webglFramebuffer[t][r]);else e.deleteFramebuffer(n.__webglFramebuffer[t]);n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[t])}else{if(Array.isArray(n.__webglFramebuffer))for(let t=0;t<n.__webglFramebuffer.length;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let t=0;t<n.__webglColorRenderbuffer.length;t++)n.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(n.__webglColorRenderbuffer[t]);n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const i=t.textures;for(let t=0,n=i.length;t<n;t++){const n=r.get(i[t]);n.__webglTexture&&(e.deleteTexture(n.__webglTexture),s.memory.textures--),r.remove(i[t])}r.remove(t)}(n)}function z(t){const n=r.get(t);e.deleteTexture(n.__webglTexture);const i=t.source;delete d.get(i)[n.__cacheKey],s.memory.textures--}let j=0;function V(t,i){const o=r.get(t);if(t.isVideoTexture&&function(e){const t=s.render.frame;l.get(e)!==t&&(l.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&o.__version!==t.version){const e=t.image;if(null===e)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==e.complete)return void Z(o,t,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.bindTexture(e.TEXTURE_2D,o.__webglTexture,e.TEXTURE0+i)}const G={[m]:e.REPEAT,[g]:e.CLAMP_TO_EDGE,[v]:e.MIRRORED_REPEAT},H={[y]:e.NEAREST,1004:e.NEAREST_MIPMAP_NEAREST,[b]:e.NEAREST_MIPMAP_LINEAR,[_]:e.LINEAR,[x]:e.LINEAR_MIPMAP_NEAREST,[w]:e.LINEAR_MIPMAP_LINEAR},W={512:e.NEVER,519:e.ALWAYS,513:e.LESS,515:e.LEQUAL,514:e.EQUAL,518:e.GEQUAL,516:e.GREATER,517:e.NOTEQUAL};function q(n,o){if(o.type!==O||!1!==t.has("OES_texture_float_linear")||o.magFilter!==_&&o.magFilter!==x&&o.magFilter!==b&&o.magFilter!==w&&o.minFilter!==_&&o.minFilter!==x&&o.minFilter!==b&&o.minFilter!==w||console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(n,e.TEXTURE_WRAP_S,G[o.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,G[o.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,G[o.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,H[o.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,H[o.minFilter]),o.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,W[o.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){if(o.magFilter===y)return;if(o.minFilter!==b&&o.minFilter!==w)return;if(o.type===O&&!1===t.has("OES_texture_float_linear"))return;if(o.anisotropy>1||r.get(o).__currentAnisotropy){const s=t.get("EXT_texture_filter_anisotropic");e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy}}}function X(t,n){let r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",F));const i=n.source;let o=d.get(i);void 0===o&&(o={},d.set(i,o));const a=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(a!==t.__cacheKey){void 0===o[a]&&(o[a]={texture:e.createTexture(),usedTimes:0},s.memory.textures++,r=!0),o[a].usedTimes++;const i=o[t.__cacheKey];void 0!==i&&(o[t.__cacheKey].usedTimes--,0===i.usedTimes&&z(n)),t.__cacheKey=a,t.__webglTexture=o[a].texture}return r}function Z(t,s,a){let u=e.TEXTURE_2D;(s.isDataArrayTexture||s.isCompressedArrayTexture)&&(u=e.TEXTURE_2D_ARRAY),s.isData3DTexture&&(u=e.TEXTURE_3D);const c=X(t,s),l=s.source;n.bindTexture(u,t.__webglTexture,e.TEXTURE0+a);const h=r.get(l);if(l.version!==h.__version||!0===c){n.activeTexture(e.TEXTURE0+a);const t=tt.getPrimaries(tt.workingColorSpace),r=s.colorSpace===Te?null:tt.getPrimaries(s.colorSpace),d=s.colorSpace===Te||t===r?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,s.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,s.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);let f=E(s.image,!1,i.maxTextureSize);f=ne(s,f);const p=o.convert(s.format,s.colorSpace),m=o.convert(s.type);let g,v=R(s.internalFormat,p,m,s.colorSpace,s.isVideoTexture);q(u,s);const y=s.mipmaps,b=!0!==s.isVideoTexture,_=void 0===h.__version||!0===c,x=l.dataReady,w=k(s,f);if(s.isDepthTexture)v=N(s.format===U,s.type),_&&(b?n.texStorage2D(e.TEXTURE_2D,1,v,f.width,f.height):n.texImage2D(e.TEXTURE_2D,0,v,f.width,f.height,0,p,m,null));else if(s.isDataTexture)if(y.length>0){b&&_&&n.texStorage2D(e.TEXTURE_2D,w,v,y[0].width,y[0].height);for(let t=0,r=y.length;t<r;t++)g=y[t],b?x&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,g.width,g.height,p,m,g.data):n.texImage2D(e.TEXTURE_2D,t,v,g.width,g.height,0,p,m,g.data);s.generateMipmaps=!1}else b?(_&&n.texStorage2D(e.TEXTURE_2D,w,v,f.width,f.height),x&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,f.width,f.height,p,m,f.data)):n.texImage2D(e.TEXTURE_2D,0,v,f.width,f.height,0,p,m,f.data);else if(s.isCompressedTexture)if(s.isCompressedArrayTexture){b&&_&&n.texStorage3D(e.TEXTURE_2D_ARRAY,w,v,y[0].width,y[0].height,f.depth);for(let t=0,r=y.length;t<r;t++)if(g=y[t],s.format!==D)if(null!==p)if(b){if(x)if(s.layerUpdates.size>0){const r=Es(g.width,g.height,s.format,s.type);for(const i of s.layerUpdates){const o=g.data.subarray(i*r/g.data.BYTES_PER_ELEMENT,(i+1)*r/g.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,i,g.width,g.height,1,p,o)}s.clearLayerUpdates()}else n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,g.width,g.height,f.depth,p,g.data)}else n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,v,g.width,g.height,f.depth,0,g.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else b?x&&n.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,g.width,g.height,f.depth,p,m,g.data):n.texImage3D(e.TEXTURE_2D_ARRAY,t,v,g.width,g.height,f.depth,0,p,m,g.data)}else{b&&_&&n.texStorage2D(e.TEXTURE_2D,w,v,y[0].width,y[0].height);for(let t=0,r=y.length;t<r;t++)g=y[t],s.format!==D?null!==p?b?x&&n.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,g.width,g.height,p,g.data):n.compressedTexImage2D(e.TEXTURE_2D,t,v,g.width,g.height,0,g.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):b?x&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,g.width,g.height,p,m,g.data):n.texImage2D(e.TEXTURE_2D,t,v,g.width,g.height,0,p,m,g.data)}else if(s.isDataArrayTexture)if(b){if(_&&n.texStorage3D(e.TEXTURE_2D_ARRAY,w,v,f.width,f.height,f.depth),x)if(s.layerUpdates.size>0){const t=Es(f.width,f.height,s.format,s.type);for(const r of s.layerUpdates){const i=f.data.subarray(r*t/f.data.BYTES_PER_ELEMENT,(r+1)*t/f.data.BYTES_PER_ELEMENT);n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,r,f.width,f.height,1,p,m,i)}s.clearLayerUpdates()}else n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,f.width,f.height,f.depth,p,m,f.data)}else n.texImage3D(e.TEXTURE_2D_ARRAY,0,v,f.width,f.height,f.depth,0,p,m,f.data);else if(s.isData3DTexture)b?(_&&n.texStorage3D(e.TEXTURE_3D,w,v,f.width,f.height,f.depth),x&&n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,f.width,f.height,f.depth,p,m,f.data)):n.texImage3D(e.TEXTURE_3D,0,v,f.width,f.height,f.depth,0,p,m,f.data);else if(s.isFramebufferTexture){if(_)if(b)n.texStorage2D(e.TEXTURE_2D,w,v,f.width,f.height);else{let t=f.width,r=f.height;for(let i=0;i<w;i++)n.texImage2D(e.TEXTURE_2D,i,v,t,r,0,p,m,null),t>>=1,r>>=1}}else if(y.length>0){if(b&&_){const t=re(y[0]);n.texStorage2D(e.TEXTURE_2D,w,v,t.width,t.height)}for(let t=0,r=y.length;t<r;t++)g=y[t],b?x&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,p,m,g):n.texImage2D(e.TEXTURE_2D,t,v,p,m,g);s.generateMipmaps=!1}else if(b){if(_){const t=re(f);n.texStorage2D(e.TEXTURE_2D,w,v,t.width,t.height)}x&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,p,m,f)}else n.texImage2D(e.TEXTURE_2D,0,v,p,m,f);T(s)&&A(u),h.__version=l.version,s.onUpdate&&s.onUpdate(s)}t.__version=s.version}function $(t,i,s,u,c,l){const h=o.convert(s.format,s.colorSpace),d=o.convert(s.type),f=R(s.internalFormat,h,d,s.colorSpace),p=r.get(i),m=r.get(s);if(m.__renderTarget=i,!p.__hasExternalTextures){const t=Math.max(1,i.width>>l),r=Math.max(1,i.height>>l);c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?n.texImage3D(c,l,f,t,r,i.depth,0,h,d,null):n.texImage2D(c,l,f,t,r,0,h,d,null)}n.bindFramebuffer(e.FRAMEBUFFER,t),te(i)?a.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,u,c,m.__webglTexture,0,ee(i)):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,u,c,m.__webglTexture,l),n.bindFramebuffer(e.FRAMEBUFFER,null)}function Y(t,n,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer){const i=n.depthTexture,o=i&&i.isDepthTexture?i.type:null,s=N(n.stencilBuffer,o),u=n.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,c=ee(n);te(n)?a.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,c,s,n.width,n.height):r?e.renderbufferStorageMultisample(e.RENDERBUFFER,c,s,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,s,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,u,e.RENDERBUFFER,t)}else{const t=n.textures;for(let i=0;i<t.length;i++){const s=t[i],u=o.convert(s.format,s.colorSpace),c=o.convert(s.type),l=R(s.internalFormat,u,c,s.colorSpace),h=ee(n);r&&!1===te(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,h,l,n.width,n.height):te(n)?a.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,h,l,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,l,n.width,n.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function K(t){const i=r.get(t),o=!0===t.isWebGLCubeRenderTarget;if(i.__boundDepthTexture!==t.depthTexture){const e=t.depthTexture;if(i.__depthDisposeCallback&&i.__depthDisposeCallback(),e){const t=()=>{delete i.__boundDepthTexture,delete i.__depthDisposeCallback,e.removeEventListener("dispose",t)};e.addEventListener("dispose",t),i.__depthDisposeCallback=t}i.__boundDepthTexture=e}if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(o)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const o=r.get(i.depthTexture);o.__renderTarget=i,o.__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),V(i.depthTexture,0);const s=o.__webglTexture,u=ee(i);if(i.depthTexture.format===L)te(i)?a.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0,u):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0);else{if(i.depthTexture.format!==U)throw new Error("Unknown depthTexture format");te(i)?a.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0,u):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0)}}(i.__webglFramebuffer,t)}else if(o){i.__webglDepthbuffer=[];for(let r=0;r<6;r++)if(n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[r]),void 0===i.__webglDepthbuffer[r])i.__webglDepthbuffer[r]=e.createRenderbuffer(),Y(i.__webglDepthbuffer[r],t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,o=i.__webglDepthbuffer[r];e.bindRenderbuffer(e.RENDERBUFFER,o),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,o)}}else if(n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer),void 0===i.__webglDepthbuffer)i.__webglDepthbuffer=e.createRenderbuffer(),Y(i.__webglDepthbuffer,t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,r=i.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,r),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,r)}n.bindFramebuffer(e.FRAMEBUFFER,null)}const Q=[],J=[];function ee(e){return Math.min(i.maxSamples,e.samples)}function te(e){const n=r.get(e);return e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function ne(e,t){const n=e.colorSpace,r=e.format,i=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||n!==Ae&&n!==Te&&(tt.getTransfer(n)===Oe?r===D&&i===S||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",n)),t}function re(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?(c.width=e.naturalWidth||e.width,c.height=e.naturalHeight||e.height):"undefined"!=typeof VideoFrame&&e instanceof VideoFrame?(c.width=e.displayWidth,c.height=e.displayHeight):(c.width=e.width,c.height=e.height),c}this.allocateTextureUnit=function(){const e=j;return e>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+i.maxTextures),j+=1,e},this.resetTextureUnits=function(){j=0},this.setTexture2D=V,this.setTexture2DArray=function(t,i){const o=r.get(t);t.version>0&&o.__version!==t.version?Z(o,t,i):n.bindTexture(e.TEXTURE_2D_ARRAY,o.__webglTexture,e.TEXTURE0+i)},this.setTexture3D=function(t,i){const o=r.get(t);t.version>0&&o.__version!==t.version?Z(o,t,i):n.bindTexture(e.TEXTURE_3D,o.__webglTexture,e.TEXTURE0+i)},this.setTextureCube=function(t,s){const a=r.get(t);t.version>0&&a.__version!==t.version?function(t,s,a){if(6!==s.image.length)return;const u=X(t,s),c=s.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+a);const l=r.get(c);if(c.version!==l.__version||!0===u){n.activeTexture(e.TEXTURE0+a);const t=tt.getPrimaries(tt.workingColorSpace),r=s.colorSpace===Te?null:tt.getPrimaries(s.colorSpace),h=s.colorSpace===Te||t===r?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,s.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,s.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,h);const d=s.isCompressedTexture||s.image[0].isCompressedTexture,f=s.image[0]&&s.image[0].isDataTexture,p=[];for(let e=0;e<6;e++)p[e]=d||f?f?s.image[e].image:s.image[e]:E(s.image[e],!0,i.maxCubemapSize),p[e]=ne(s,p[e]);const m=p[0],g=o.convert(s.format,s.colorSpace),v=o.convert(s.type),y=R(s.internalFormat,g,v,s.colorSpace),b=!0!==s.isVideoTexture,_=void 0===l.__version||!0===u,x=c.dataReady;let w,S=k(s,m);if(q(e.TEXTURE_CUBE_MAP,s),d){b&&_&&n.texStorage2D(e.TEXTURE_CUBE_MAP,S,y,m.width,m.height);for(let t=0;t<6;t++){w=p[t].mipmaps;for(let r=0;r<w.length;r++){const i=w[r];s.format!==D?null!==g?b?x&&n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,0,0,i.width,i.height,g,i.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,y,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):b?x&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,0,0,i.width,i.height,g,v,i.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,y,i.width,i.height,0,g,v,i.data)}}}else{if(w=s.mipmaps,b&&_){w.length>0&&S++;const t=re(p[0]);n.texStorage2D(e.TEXTURE_CUBE_MAP,S,y,t.width,t.height)}for(let t=0;t<6;t++)if(f){b?x&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,p[t].width,p[t].height,g,v,p[t].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,y,p[t].width,p[t].height,0,g,v,p[t].data);for(let r=0;r<w.length;r++){const i=w[r].image[t].image;b?x&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,i.width,i.height,g,v,i.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,y,i.width,i.height,0,g,v,i.data)}}else{b?x&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,g,v,p[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,y,g,v,p[t]);for(let r=0;r<w.length;r++){const i=w[r];b?x&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,g,v,i.image[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,y,g,v,i.image[t])}}}T(s)&&A(e.TEXTURE_CUBE_MAP),l.__version=c.version,s.onUpdate&&s.onUpdate(s)}t.__version=s.version}(a,t,s):n.bindTexture(e.TEXTURE_CUBE_MAP,a.__webglTexture,e.TEXTURE0+s)},this.rebindTextures=function(t,n,i){const o=r.get(t);void 0!==n&&$(o.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==i&&K(t)},this.setupRenderTarget=function(t){const i=t.texture,a=r.get(t),u=r.get(i);t.addEventListener("dispose",B);const c=t.textures,l=!0===t.isWebGLCubeRenderTarget,h=c.length>1;if(h||(void 0===u.__webglTexture&&(u.__webglTexture=e.createTexture()),u.__version=i.version,s.memory.textures++),l){a.__webglFramebuffer=[];for(let t=0;t<6;t++)if(i.mipmaps&&i.mipmaps.length>0){a.__webglFramebuffer[t]=[];for(let n=0;n<i.mipmaps.length;n++)a.__webglFramebuffer[t][n]=e.createFramebuffer()}else a.__webglFramebuffer[t]=e.createFramebuffer()}else{if(i.mipmaps&&i.mipmaps.length>0){a.__webglFramebuffer=[];for(let t=0;t<i.mipmaps.length;t++)a.__webglFramebuffer[t]=e.createFramebuffer()}else a.__webglFramebuffer=e.createFramebuffer();if(h)for(let t=0,n=c.length;t<n;t++){const n=r.get(c[t]);void 0===n.__webglTexture&&(n.__webglTexture=e.createTexture(),s.memory.textures++)}if(t.samples>0&&!1===te(t)){a.__webglMultisampledFramebuffer=e.createFramebuffer(),a.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,a.__webglMultisampledFramebuffer);for(let n=0;n<c.length;n++){const r=c[n];a.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,a.__webglColorRenderbuffer[n]);const i=o.convert(r.format,r.colorSpace),s=o.convert(r.type),u=R(r.internalFormat,i,s,r.colorSpace,!0===t.isXRRenderTarget),l=ee(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,l,u,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+n,e.RENDERBUFFER,a.__webglColorRenderbuffer[n])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(a.__webglDepthRenderbuffer=e.createRenderbuffer(),Y(a.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(l){n.bindTexture(e.TEXTURE_CUBE_MAP,u.__webglTexture),q(e.TEXTURE_CUBE_MAP,i);for(let n=0;n<6;n++)if(i.mipmaps&&i.mipmaps.length>0)for(let r=0;r<i.mipmaps.length;r++)$(a.__webglFramebuffer[n][r],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,r);else $(a.__webglFramebuffer[n],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);T(i)&&A(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(h){for(let i=0,o=c.length;i<o;i++){const o=c[i],s=r.get(o);n.bindTexture(e.TEXTURE_2D,s.__webglTexture),q(e.TEXTURE_2D,o),$(a.__webglFramebuffer,t,o,e.COLOR_ATTACHMENT0+i,e.TEXTURE_2D,0),T(o)&&A(e.TEXTURE_2D)}n.unbindTexture()}else{let r=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(r=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(r,u.__webglTexture),q(r,i),i.mipmaps&&i.mipmaps.length>0)for(let n=0;n<i.mipmaps.length;n++)$(a.__webglFramebuffer[n],t,i,e.COLOR_ATTACHMENT0,r,n);else $(a.__webglFramebuffer,t,i,e.COLOR_ATTACHMENT0,r,0);T(i)&&A(r),n.unbindTexture()}t.depthBuffer&&K(t)},this.updateRenderTargetMipmap=function(e){const t=e.textures;for(let i=0,o=t.length;i<o;i++){const o=t[i];if(T(o)){const t=P(e),i=r.get(o).__webglTexture;n.bindTexture(t,i),A(t),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.samples>0)if(!1===te(t)){const i=t.textures,o=t.width,s=t.height;let a=e.COLOR_BUFFER_BIT;const c=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,l=r.get(t),h=i.length>1;if(h)for(let t=0;t<i.length;t++)n.bindFramebuffer(e.FRAMEBUFFER,l.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,l.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,l.__webglMultisampledFramebuffer),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,l.__webglFramebuffer);for(let n=0;n<i.length;n++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(a|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(a|=e.STENCIL_BUFFER_BIT)),h){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,l.__webglColorRenderbuffer[n]);const t=r.get(i[n]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,o,s,0,0,o,s,a,e.NEAREST),!0===u&&(Q.length=0,J.length=0,Q.push(e.COLOR_ATTACHMENT0+n),t.depthBuffer&&!1===t.resolveDepthBuffer&&(Q.push(c),J.push(c),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,J)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,Q))}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),h)for(let t=0;t<i.length;t++){n.bindFramebuffer(e.FRAMEBUFFER,l.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,l.__webglColorRenderbuffer[t]);const o=r.get(i[t]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,l.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,o,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,l.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&u){const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[n])}},this.setupDepthRenderbuffer=K,this.setupFrameBufferTexture=$,this.useMultisampledRTT=te}function Ms(e,t){return{convert:function(n,r=""){let i;const o=tt.getTransfer(r);if(n===S)return e.UNSIGNED_BYTE;if(n===R)return e.UNSIGNED_SHORT_4_4_4_4;if(n===N)return e.UNSIGNED_SHORT_5_5_5_1;if(n===k)return e.UNSIGNED_INT_5_9_9_9_REV;if(n===E)return e.BYTE;if(n===T)return e.SHORT;if(n===M)return e.UNSIGNED_SHORT;if(n===A)return e.INT;if(n===C)return e.UNSIGNED_INT;if(n===O)return e.FLOAT;if(n===P)return e.HALF_FLOAT;if(1021===n)return e.ALPHA;if(1022===n)return e.RGB;if(n===D)return e.RGBA;if(1024===n)return e.LUMINANCE;if(1025===n)return e.LUMINANCE_ALPHA;if(n===L)return e.DEPTH_COMPONENT;if(n===U)return e.DEPTH_STENCIL;if(n===F)return e.RED;if(n===B)return e.RED_INTEGER;if(1030===n)return e.RG;if(n===z)return e.RG_INTEGER;if(n===j)return e.RGBA_INTEGER;if(n===V||n===G||n===H||n===W)if(o===Oe){if(i=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(n===V)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===G)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===H)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===W)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=t.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(n===V)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===G)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===H)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===W)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===q||n===X||n===Z||n===$){if(i=t.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(n===q)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===X)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Z)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===$)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===Y||n===K||n===Q){if(i=t.get("WEBGL_compressed_texture_etc"),null===i)return null;if(n===Y||n===K)return o===Oe?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(n===Q)return o===Oe?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(n===J||n===ee||n===te||n===ne||n===re||n===ie||n===oe||n===se||n===ae||n===ue||n===ce||n===le||n===he||n===de){if(i=t.get("WEBGL_compressed_texture_astc"),null===i)return null;if(n===J)return o===Oe?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===ee)return o===Oe?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===te)return o===Oe?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===ne)return o===Oe?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===re)return o===Oe?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===ie)return o===Oe?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===oe)return o===Oe?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===se)return o===Oe?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===ae)return o===Oe?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===ue)return o===Oe?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===ce)return o===Oe?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===le)return o===Oe?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===he)return o===Oe?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===de)return o===Oe?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===fe||n===pe||n===me){if(i=t.get("EXT_texture_compression_bptc"),null===i)return null;if(n===fe)return o===Oe?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===pe)return i.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===me)return i.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===n||n===ge||n===ve||n===ye){if(i=t.get("EXT_texture_compression_rgtc"),null===i)return null;if(n===fe)return i.COMPRESSED_RED_RGTC1_EXT;if(n===ge)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===ve)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===ye)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===I?e.UNSIGNED_INT_24_8:void 0!==e[n]?e[n]:null}}}class As extends Ir{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Cs extends Mn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Os={type:"move"};class Ps{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Cs,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Cs,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new wt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new wt),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Cs,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new wt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new wt),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,o=null;const s=this._targetRay,a=this._grip,u=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(u&&e.hand){o=!0;for(const r of e.hand.values()){const e=t.getJointPose(r,n),i=this._getHandJoint(u,r);null!==e&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.matrixWorldNeedsUpdate=!0,i.jointRadius=e.radius),i.visible=null!==e}const r=u.joints["index-finger-tip"],i=u.joints["thumb-tip"],s=r.position.distanceTo(i.position),a=.02,c=.005;u.inputState.pinching&&s>a+c?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&s<=a-c&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==a&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1));null!==s&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==i&&(r=i),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(Os)))}return null!==s&&(s.visible=null!==r),null!==a&&(a.visible=null!==i),null!==u&&(u.visible=null!==o),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new Cs;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class Rs{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(null===this.texture){const r=new mt;e.properties.get(r).__webglTexture=t.texture,t.depthNear==n.depthNear&&t.depthFar==n.depthFar||(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,n=new Cr({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new xr(new Xr(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Ns extends De{constructor(e,t){super();const n=this;let r=null,i=1,o=null,s="local-floor",a=1,u=null,c=null,l=null,h=null,d=null,f=null;const p=new Rs,m=t.getContextAttributes();let g=null,v=null;const y=[],b=[],_=new Xe;let x=null;const w=new Ir;w.viewport=new gt;const E=new Ir;E.viewport=new gt;const T=[w,E],M=new As;let A=null,O=null;function P(e){const t=b.indexOf(e.inputSource);if(-1===t)return;const n=y[t];void 0!==n&&(n.update(e.inputSource,e.frame,u||o),n.dispatchEvent({type:e.type,data:e.inputSource}))}function R(){r.removeEventListener("select",P),r.removeEventListener("selectstart",P),r.removeEventListener("selectend",P),r.removeEventListener("squeeze",P),r.removeEventListener("squeezestart",P),r.removeEventListener("squeezeend",P),r.removeEventListener("end",R),r.removeEventListener("inputsourceschange",N);for(let e=0;e<y.length;e++){const t=b[e];null!==t&&(b[e]=null,y[e].disconnect(t))}A=null,O=null,p.reset(),e.setRenderTarget(g),d=null,h=null,l=null,r=null,v=null,j.stop(),n.isPresenting=!1,e.setPixelRatio(x),e.setSize(_.width,_.height,!1),n.dispatchEvent({type:"sessionend"})}function N(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],r=b.indexOf(n);r>=0&&(b[r]=null,y[r].disconnect(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let r=b.indexOf(n);if(-1===r){for(let e=0;e<y.length;e++){if(e>=b.length){b.push(n),r=e;break}if(null===b[e]){b[e]=n,r=e;break}}if(-1===r)break}const i=y[r];i&&i.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=y[e];return void 0===t&&(t=new Ps,y[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=y[e];return void 0===t&&(t=new Ps,y[e]=t),t.getGripSpace()},this.getHand=function(e){let t=y[e];return void 0===t&&(t=new Ps,y[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){s=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(e){u=e},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return l},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=async function(c){if(r=c,null!==r){if(g=e.getRenderTarget(),r.addEventListener("select",P),r.addEventListener("selectstart",P),r.addEventListener("selectend",P),r.addEventListener("squeeze",P),r.addEventListener("squeezestart",P),r.addEventListener("squeezeend",P),r.addEventListener("end",R),r.addEventListener("inputsourceschange",N),!0!==m.xrCompatible&&await t.makeXRCompatible(),x=e.getPixelRatio(),e.getSize(_),void 0===r.renderState.layers){const n={antialias:m.antialias,alpha:!0,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:i};d=new XRWebGLLayer(r,t,n),r.updateRenderState({baseLayer:d}),e.setPixelRatio(1),e.setSize(d.framebufferWidth,d.framebufferHeight,!1),v=new yt(d.framebufferWidth,d.framebufferHeight,{format:D,type:S,colorSpace:e.outputColorSpace,stencilBuffer:m.stencil})}else{let n=null,o=null,s=null;m.depth&&(s=m.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,n=m.stencil?U:L,o=m.stencil?I:C);const a={colorFormat:t.RGBA8,depthFormat:s,scaleFactor:i};l=new XRWebGLBinding(r,t),h=l.createProjectionLayer(a),r.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),v=new yt(h.textureWidth,h.textureHeight,{format:D,type:S,depthTexture:new Ri(h.textureWidth,h.textureHeight,o,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:m.stencil,colorSpace:e.outputColorSpace,samples:m.antialias?4:0,resolveDepthBuffer:!1===h.ignoreDepthValues})}v.isXRRenderTarget=!0,this.setFoveation(a),u=null,o=await r.requestReferenceSpace(s),j.setContext(r),j.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode},this.getDepthTexture=function(){return p.getDepthTexture()};const k=new wt,F=new wt;function B(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===r)return;let t=e.near,n=e.far;null!==p.texture&&(p.depthNear>0&&(t=p.depthNear),p.depthFar>0&&(n=p.depthFar)),M.near=E.near=w.near=t,M.far=E.far=w.far=n,A===M.near&&O===M.far||(r.updateRenderState({depthNear:M.near,depthFar:M.far}),A=M.near,O=M.far),w.layers.mask=2|e.layers.mask,E.layers.mask=4|e.layers.mask,M.layers.mask=w.layers.mask|E.layers.mask;const i=e.parent,o=M.cameras;B(M,i);for(let e=0;e<o.length;e++)B(o[e],i);2===o.length?function(e,t,n){k.setFromMatrixPosition(t.matrixWorld),F.setFromMatrixPosition(n.matrixWorld);const r=k.distanceTo(F),i=t.projectionMatrix.elements,o=n.projectionMatrix.elements,s=i[14]/(i[10]-1),a=i[14]/(i[10]+1),u=(i[9]+1)/i[5],c=(i[9]-1)/i[5],l=(i[8]-1)/i[0],h=(o[8]+1)/o[0],d=s*l,f=s*h,p=r/(-l+h),m=p*-l;if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===i[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{const t=s+p,n=a+p,i=d-m,o=f+(r-m),l=u*a/n*t,h=c*a/n*t;e.projectionMatrix.makePerspective(i,o,l,h,t,n),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(M,w,E):M.projectionMatrix.copy(w.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*Be*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,M,i)},this.getCamera=function(){return M},this.getFoveation=function(){if(null!==h||null!==d)return a},this.setFoveation=function(e){a=e,null!==h&&(h.fixedFoveation=e),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==p.texture},this.getDepthSensingMesh=function(){return p.getMesh(M)};let z=null;const j=new Wr;j.setAnimationLoop((function(t,i){if(c=i.getViewerPose(u||o),f=i,null!==c){const t=c.views;null!==d&&(e.setRenderTargetFramebuffer(v,d.framebuffer),e.setRenderTarget(v));let n=!1;t.length!==M.cameras.length&&(M.cameras.length=0,n=!0);for(let r=0;r<t.length;r++){const i=t[r];let o=null;if(null!==d)o=d.getViewport(i);else{const t=l.getViewSubImage(h,i);o=t.viewport,0===r&&(e.setRenderTargetTextures(v,t.colorTexture,h.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(v))}let s=T[r];void 0===s&&(s=new Ir,s.layers.enable(r),s.viewport=new gt,T[r]=s),s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.quaternion,s.scale),s.projectionMatrix.fromArray(i.projectionMatrix),s.projectionMatrixInverse.copy(s.projectionMatrix).invert(),s.viewport.set(o.x,o.y,o.width,o.height),0===r&&(M.matrix.copy(s.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),!0===n&&M.cameras.push(s)}const i=r.enabledFeatures;if(i&&i.includes("depth-sensing")){const n=l.getDepthInformation(t[0]);n&&n.isValid&&n.texture&&p.init(e,n,r.renderState)}}for(let e=0;e<y.length;e++){const t=b[e],n=y[e];null!==t&&void 0!==n&&n.update(t,i,u||o)}z&&z(t,i),i.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:i}),f=null})),this.setAnimationLoop=function(e){z=e},this.dispose=function(){}}}const Is=new cn,ks=new Qt;function Ds(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function r(e,r){e.opacity.value=r.opacity,r.color&&e.diffuse.value.copy(r.color),r.emissive&&e.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(e.map.value=r.map,n(r.map,e.mapTransform)),r.alphaMap&&(e.alphaMap.value=r.alphaMap,n(r.alphaMap,e.alphaMapTransform)),r.bumpMap&&(e.bumpMap.value=r.bumpMap,n(r.bumpMap,e.bumpMapTransform),e.bumpScale.value=r.bumpScale,1===r.side&&(e.bumpScale.value*=-1)),r.normalMap&&(e.normalMap.value=r.normalMap,n(r.normalMap,e.normalMapTransform),e.normalScale.value.copy(r.normalScale),1===r.side&&e.normalScale.value.negate()),r.displacementMap&&(e.displacementMap.value=r.displacementMap,n(r.displacementMap,e.displacementMapTransform),e.displacementScale.value=r.displacementScale,e.displacementBias.value=r.displacementBias),r.emissiveMap&&(e.emissiveMap.value=r.emissiveMap,n(r.emissiveMap,e.emissiveMapTransform)),r.specularMap&&(e.specularMap.value=r.specularMap,n(r.specularMap,e.specularMapTransform)),r.alphaTest>0&&(e.alphaTest.value=r.alphaTest);const i=t.get(r),o=i.envMap,s=i.envMapRotation;o&&(e.envMap.value=o,Is.copy(s),Is.x*=-1,Is.y*=-1,Is.z*=-1,o.isCubeTexture&&!1===o.isRenderTargetTexture&&(Is.y*=-1,Is.z*=-1),e.envMapRotation.value.setFromMatrix4(ks.makeRotationFromEuler(Is)),e.flipEnvMap.value=o.isCubeTexture&&!1===o.isRenderTargetTexture?-1:1,e.reflectivity.value=r.reflectivity,e.ior.value=r.ior,e.refractionRatio.value=r.refractionRatio),r.lightMap&&(e.lightMap.value=r.lightMap,e.lightMapIntensity.value=r.lightMapIntensity,n(r.lightMap,e.lightMapTransform)),r.aoMap&&(e.aoMap.value=r.aoMap,e.aoMapIntensity.value=r.aoMapIntensity,n(r.aoMap,e.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,Mr(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,i,o,s,a){i.isMeshBasicMaterial||i.isMeshLambertMaterial?r(e,i):i.isMeshToonMaterial?(r(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,i)):i.isMeshPhongMaterial?(r(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,i)):i.isMeshStandardMaterial?(r(e,i),function(e,t){e.metalness.value=t.metalness,t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap,n(t.metalnessMap,e.metalnessMapTransform));e.roughness.value=t.roughness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap,n(t.roughnessMap,e.roughnessMapTransform));t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}(e,i),i.isMeshPhysicalMaterial&&function(e,t,r){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),1===t.side&&e.clearcoatNormalScale.value.negate()));t.dispersion>0&&(e.dispersion.value=t.dispersion);t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform)));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform));t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,i,a)):i.isMeshMatcapMaterial?(r(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,i)):i.isMeshDepthMaterial?r(e,i):i.isMeshDistanceMaterial?(r(e,i),function(e,n){const r=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(r.matrixWorld),e.nearDistance.value=r.shadow.camera.near,e.farDistance.value=r.shadow.camera.far}(e,i)):i.isMeshNormalMaterial?r(e,i):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,r,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*i,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i,o,s):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function Ls(e,t,n,r){let i={},o={},s=[];const a=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function u(e,t,n,r){const i=e.value,o=t+"_"+n;if(void 0===r[o])return r[o]="number"==typeof i||"boolean"==typeof i?i:i.clone(),!0;{const e=r[o];if("number"==typeof i||"boolean"==typeof i){if(e!==i)return r[o]=i,!0}else if(!1===e.equals(i))return e.copy(i),!0}return!1}function c(e){const t={boundary:0,storage:0};return"number"==typeof e||"boolean"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function l(t){const n=t.target;n.removeEventListener("dispose",l);const r=s.indexOf(n.__bindingPointIndex);s.splice(r,1),e.deleteBuffer(i[n.id]),delete i[n.id],delete o[n.id]}return{bind:function(e,t){const n=t.program;r.uniformBlockBinding(e,n)},update:function(n,h){let d=i[n.id];void 0===d&&(!function(e){const t=e.uniforms;let n=0;const r=16;for(let e=0,i=t.length;e<i;e++){const i=Array.isArray(t[e])?t[e]:[t[e]];for(let e=0,t=i.length;e<t;e++){const t=i[e],o=Array.isArray(t.value)?t.value:[t.value];for(let e=0,i=o.length;e<i;e++){const i=c(o[e]),s=n%r,a=s%i.boundary,u=s+a;n+=a,0!==u&&r-u<i.storage&&(n+=r-u),t.__data=new Float32Array(i.storage/Float32Array.BYTES_PER_ELEMENT),t.__offset=n,n+=i.storage}}}const i=n%r;i>0&&(n+=r-i);e.__size=n,e.__cache={}}(n),d=function(t){const n=function(){for(let e=0;e<a;e++)if(-1===s.indexOf(e))return s.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;const r=e.createBuffer(),i=t.__size,o=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,r),e.bufferData(e.UNIFORM_BUFFER,i,o),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,r),r}(n),i[n.id]=d,n.addEventListener("dispose",l));const f=h.program;r.updateUBOMapping(n,f);const p=t.render.frame;o[n.id]!==p&&(!function(t){const n=i[t.id],r=t.uniforms,o=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(let t=0,n=r.length;t<n;t++){const n=Array.isArray(r[t])?r[t]:[r[t]];for(let r=0,i=n.length;r<i;r++){const i=n[r];if(!0===u(i,t,r,o)){const t=i.__offset,n=Array.isArray(i.value)?i.value:[i.value];let r=0;for(let o=0;o<n.length;o++){const s=n[o],a=c(s);"number"==typeof s||"boolean"==typeof s?(i.__data[0]=s,e.bufferSubData(e.UNIFORM_BUFFER,t+r,i.__data)):s.isMatrix3?(i.__data[0]=s.elements[0],i.__data[1]=s.elements[1],i.__data[2]=s.elements[2],i.__data[3]=0,i.__data[4]=s.elements[3],i.__data[5]=s.elements[4],i.__data[6]=s.elements[5],i.__data[7]=0,i.__data[8]=s.elements[6],i.__data[9]=s.elements[7],i.__data[10]=s.elements[8],i.__data[11]=0):(s.toArray(i.__data,r),r+=a.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,i.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),o[n.id]=p)},dispose:function(){for(const t in i)e.deleteBuffer(i[t]);s=[],i={},o={}}}}class Us extends Mn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new cn,this.environmentIntensity=1,this.environmentRotation=new cn,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class Fs extends Zn{static get type(){return"LineBasicMaterial"}constructor(e){super(),this.isLineBasicMaterial=!0,this.color=new Wn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Bs=new wt,zs=new wt,js=new Qt,Vs=new Kt,Gs=new Gt,Hs=new wt,Ws=new wt;class qs extends Mn{constructor(e=new cr,t=new Fs){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,r=t.count;e<r;e++)Bs.fromBufferAttribute(t,e-1),zs.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=Bs.distanceTo(zs);e.setAttribute("lineDistance",new tr(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Gs.copy(n.boundingSphere),Gs.applyMatrix4(r),Gs.radius+=i,!1===e.ray.intersectsSphere(Gs))return;js.copy(r).invert(),Vs.copy(e.ray).applyMatrix4(js);const s=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=s*s,u=this.isLineSegments?2:1,c=n.index,l=n.attributes.position;if(null!==c){const n=Math.max(0,o.start),r=Math.min(c.count,o.start+o.count);for(let i=n,o=r-1;i<o;i+=u){const n=c.getX(i),r=c.getX(i+1),o=Xs(this,e,Vs,a,n,r);o&&t.push(o)}if(this.isLineLoop){const i=c.getX(r-1),o=c.getX(n),s=Xs(this,e,Vs,a,i,o);s&&t.push(s)}}else{const n=Math.max(0,o.start),r=Math.min(l.count,o.start+o.count);for(let i=n,o=r-1;i<o;i+=u){const n=Xs(this,e,Vs,a,i,i+1);n&&t.push(n)}if(this.isLineLoop){const i=Xs(this,e,Vs,a,r-1,n);i&&t.push(i)}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function Xs(e,t,n,r,i,o){const s=e.geometry.attributes.position;Bs.fromBufferAttribute(s,i),zs.fromBufferAttribute(s,o);if(n.distanceSqToSegment(Bs,zs,Hs,Ws)>r)return;Hs.applyMatrix4(e.matrixWorld);const a=t.ray.origin.distanceTo(Hs);return a<t.near||a>t.far?void 0:{distance:a,point:Ws.clone().applyMatrix4(e.matrixWorld),index:i,face:null,faceIndex:null,barycoord:null,object:e}}class Zs{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),i=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),i+=n.distanceTo(r),t.push(i),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let r=0;const i=n.length;let o;o=t||e*n[i-1];let s,a=0,u=i-1;for(;a<=u;)if(r=Math.floor(a+(u-a)/2),s=n[r]-o,s<0)a=r+1;else{if(!(s>0)){u=r;break}u=r-1}if(r=u,n[r]===o)return r/(i-1);const c=n[r];return(r+(o-c)/(n[r+1]-c))/(i-1)}getTangent(e,t){const n=1e-4;let r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);const o=this.getPoint(r),s=this.getPoint(i),a=t||(o.isVector2?new Xe:new wt);return a.copy(s).sub(o).normalize(),a}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new wt,r=[],i=[],o=[],s=new wt,a=new Qt;for(let t=0;t<=e;t++){const n=t/e;r[t]=this.getTangentAt(n,new wt)}i[0]=new wt,o[0]=new wt;let u=Number.MAX_VALUE;const c=Math.abs(r[0].x),l=Math.abs(r[0].y),h=Math.abs(r[0].z);c<=u&&(u=c,n.set(1,0,0)),l<=u&&(u=l,n.set(0,1,0)),h<=u&&n.set(0,0,1),s.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],s),o[0].crossVectors(r[0],i[0]);for(let t=1;t<=e;t++){if(i[t]=i[t-1].clone(),o[t]=o[t-1].clone(),s.crossVectors(r[t-1],r[t]),s.length()>Number.EPSILON){s.normalize();const e=Math.acos(je(r[t-1].dot(r[t]),-1,1));i[t].applyMatrix4(a.makeRotationAxis(s,e))}o[t].crossVectors(r[t],i[t])}if(!0===t){let t=Math.acos(je(i[0].dot(i[e]),-1,1));t/=e,r[0].dot(s.crossVectors(i[0],i[e]))>0&&(t=-t);for(let n=1;n<=e;n++)i[n].applyMatrix4(a.makeRotationAxis(r[n],t*n)),o[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:o}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class $s extends Zs{constructor(e=0,t=0,n=1,r=1,i=0,o=2*Math.PI,s=!1,a=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=o,this.aClockwise=s,this.aRotation=a}getPoint(e,t=new Xe){const n=t,r=2*Math.PI;let i=this.aEndAngle-this.aStartAngle;const o=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=o?0:r),!0!==this.aClockwise||o||(i===r?i=-r:i-=r);const s=this.aStartAngle+e*i;let a=this.aX+this.xRadius*Math.cos(s),u=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=a-this.aX,r=u-this.aY;a=n*e-r*t+this.aX,u=n*t+r*e+this.aY}return n.set(a,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}function Ys(){let e=0,t=0,n=0,r=0;function i(i,o,s,a){e=i,t=s,n=-3*i+3*o-2*s-a,r=2*i-2*o+s+a}return{initCatmullRom:function(e,t,n,r,o){i(t,n,o*(n-e),o*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,o,s,a){let u=(t-e)/o-(n-e)/(o+s)+(n-t)/s,c=(n-t)/s-(r-t)/(s+a)+(r-n)/a;u*=s,c*=s,i(t,n,u,c)},calc:function(i){const o=i*i;return e+t*i+n*o+r*(o*i)}}}const Ks=new wt,Qs=new Ys,Js=new Ys,ea=new Ys;function ta(e,t,n,r,i){const o=.5*(r-t),s=.5*(i-n),a=e*e;return(2*n-2*r+o+s)*(e*a)+(-3*n+3*r-2*o-s)*a+o*e+n}function na(e,t,n,r){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function ra(e,t,n,r,i){return function(e,t){const n=1-e;return n*n*n*t}(e,t)+function(e,t){const n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}class ia extends Zs{constructor(e=new Xe,t=new Xe,n=new Xe,r=new Xe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new Xe){const n=t,r=this.v0,i=this.v1,o=this.v2,s=this.v3;return n.set(ra(e,r.x,i.x,o.x,s.x),ra(e,r.y,i.y,o.y,s.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class oa extends Zs{constructor(e=new wt,t=new wt,n=new wt,r=new wt){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new wt){const n=t,r=this.v0,i=this.v1,o=this.v2,s=this.v3;return n.set(ra(e,r.x,i.x,o.x,s.x),ra(e,r.y,i.y,o.y,s.y),ra(e,r.z,i.z,o.z,s.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class sa extends Zs{constructor(e=new Xe,t=new Xe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Xe){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Xe){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class aa extends Zs{constructor(e=new Xe,t=new Xe,n=new Xe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Xe){const n=t,r=this.v0,i=this.v1,o=this.v2;return n.set(na(e,r.x,i.x,o.x),na(e,r.y,i.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ua extends Zs{constructor(e=new wt,t=new wt,n=new wt){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new wt){const n=t,r=this.v0,i=this.v1,o=this.v2;return n.set(na(e,r.x,i.x,o.x),na(e,r.y,i.y,o.y),na(e,r.z,i.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ca extends Zs{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Xe){const n=t,r=this.points,i=(r.length-1)*e,o=Math.floor(i),s=i-o,a=r[0===o?o:o-1],u=r[o],c=r[o>r.length-2?r.length-1:o+1],l=r[o>r.length-3?r.length-1:o+2];return n.set(ta(s,a.x,u.x,c.x,l.x),ta(s,a.y,u.y,c.y,l.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Xe).fromArray(n))}return this}}var la=Object.freeze({__proto__:null,ArcCurve:class extends $s{constructor(e,t,n,r,i,o){super(e,t,n,n,r,i,o),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class extends Zs{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new wt){const n=t,r=this.points,i=r.length,o=(i-(this.closed?0:1))*e;let s,a,u=Math.floor(o),c=o-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/i)+1)*i:0===c&&u===i-1&&(u=i-2,c=1),this.closed||u>0?s=r[(u-1)%i]:(Ks.subVectors(r[0],r[1]).add(r[0]),s=Ks);const l=r[u%i],h=r[(u+1)%i];if(this.closed||u+2<i?a=r[(u+2)%i]:(Ks.subVectors(r[i-1],r[i-2]).add(r[i-1]),a=Ks),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(s.distanceToSquared(l),e),n=Math.pow(l.distanceToSquared(h),e),r=Math.pow(h.distanceToSquared(a),e);n<1e-4&&(n=1),t<1e-4&&(t=n),r<1e-4&&(r=n),Qs.initNonuniformCatmullRom(s.x,l.x,h.x,a.x,t,n,r),Js.initNonuniformCatmullRom(s.y,l.y,h.y,a.y,t,n,r),ea.initNonuniformCatmullRom(s.z,l.z,h.z,a.z,t,n,r)}else"catmullrom"===this.curveType&&(Qs.initCatmullRom(s.x,l.x,h.x,a.x,this.tension),Js.initCatmullRom(s.y,l.y,h.y,a.y,this.tension),ea.initCatmullRom(s.z,l.z,h.z,a.z,this.tension));return n.set(Qs.calc(c),Js.calc(c),ea.calc(c)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new wt).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},CubicBezierCurve:ia,CubicBezierCurve3:oa,EllipseCurve:$s,LineCurve:sa,LineCurve3:class extends Zs{constructor(e=new wt,t=new wt){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new wt){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new wt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:aa,QuadraticBezierCurve3:ua,SplineCurve:ca});class ha extends cr{constructor(e=1,t=1,n=1,r=32,i=1,o=!1,s=0,a=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:s,thetaLength:a};const u=this;r=Math.floor(r),i=Math.floor(i);const c=[],l=[],h=[],d=[];let f=0;const p=[],m=n/2;let g=0;function v(n){const i=f,o=new Xe,p=new wt;let v=0;const y=!0===n?e:t,b=!0===n?1:-1;for(let e=1;e<=r;e++)l.push(0,m*b,0),h.push(0,b,0),d.push(.5,.5),f++;const _=f;for(let e=0;e<=r;e++){const t=e/r*a+s,n=Math.cos(t),i=Math.sin(t);p.x=y*i,p.y=m*b,p.z=y*n,l.push(p.x,p.y,p.z),h.push(0,b,0),o.x=.5*n+.5,o.y=.5*i*b+.5,d.push(o.x,o.y),f++}for(let e=0;e<r;e++){const t=i+e,r=_+e;!0===n?c.push(r,r+1,t):c.push(r+1,r,t),v+=3}u.addGroup(g,v,!0===n?1:2),g+=v}!function(){const o=new wt,v=new wt;let y=0;const b=(t-e)/n;for(let u=0;u<=i;u++){const c=[],g=u/i,y=g*(t-e)+e;for(let e=0;e<=r;e++){const t=e/r,i=t*a+s,u=Math.sin(i),p=Math.cos(i);v.x=y*u,v.y=-g*n+m,v.z=y*p,l.push(v.x,v.y,v.z),o.set(u,b,p).normalize(),h.push(o.x,o.y,o.z),d.push(t,1-g),c.push(f++)}p.push(c)}for(let n=0;n<r;n++)for(let r=0;r<i;r++){const o=p[r][n],s=p[r+1][n],a=p[r+1][n+1],u=p[r][n+1];(e>0||0!==r)&&(c.push(o,s,u),y+=3),(t>0||r!==i-1)&&(c.push(s,a,u),y+=3)}u.addGroup(g,y,0),g+=y}(),!1===o&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(c),this.setAttribute("position",new tr(l,3)),this.setAttribute("normal",new tr(h,3)),this.setAttribute("uv",new tr(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ha(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class da extends ha{constructor(e=1,t=1,n=32,r=1,i=!1,o=0,s=2*Math.PI){super(0,e,t,n,r,i,o,s),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:s}}static fromJSON(e){return new da(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class fa extends cr{constructor(e=1,t=32,n=16,r=0,i=2*Math.PI,o=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:s},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const a=Math.min(o+s,Math.PI);let u=0;const c=[],l=new wt,h=new wt,d=[],f=[],p=[],m=[];for(let d=0;d<=n;d++){const g=[],v=d/n;let y=0;0===d&&0===o?y=.5/t:d===n&&a===Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){const a=n/t;l.x=-e*Math.cos(r+a*i)*Math.sin(o+v*s),l.y=e*Math.cos(o+v*s),l.z=e*Math.sin(r+a*i)*Math.sin(o+v*s),f.push(l.x,l.y,l.z),h.copy(l).normalize(),p.push(h.x,h.y,h.z),m.push(a+y,1-v),g.push(u++)}c.push(g)}for(let e=0;e<n;e++)for(let r=0;r<t;r++){const t=c[e][r+1],i=c[e][r],s=c[e+1][r],u=c[e+1][r+1];(0!==e||o>0)&&d.push(t,i,u),(e!==n-1||a<Math.PI)&&d.push(i,s,u)}this.setIndex(d),this.setAttribute("position",new tr(f,3)),this.setAttribute("normal",new tr(p,3)),this.setAttribute("uv",new tr(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fa(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class pa extends cr{constructor(e=new ua(new wt(-1,-1,0),new wt(-1,1,0),new wt(1,1,0)),t=64,n=1,r=8,i=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i};const o=e.computeFrenetFrames(t,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const s=new wt,a=new wt,u=new Xe;let c=new wt;const l=[],h=[],d=[],f=[];function p(i){c=e.getPointAt(i/t,c);const u=o.normals[i],d=o.binormals[i];for(let e=0;e<=r;e++){const t=e/r*Math.PI*2,i=Math.sin(t),o=-Math.cos(t);a.x=o*u.x+i*d.x,a.y=o*u.y+i*d.y,a.z=o*u.z+i*d.z,a.normalize(),h.push(a.x,a.y,a.z),s.x=c.x+n*a.x,s.y=c.y+n*a.y,s.z=c.z+n*a.z,l.push(s.x,s.y,s.z)}}!function(){for(let e=0;e<t;e++)p(e);p(!1===i?t:0),function(){for(let e=0;e<=t;e++)for(let n=0;n<=r;n++)u.x=e/t,u.y=n/r,d.push(u.x,u.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=r;t++){const n=(r+1)*(e-1)+(t-1),i=(r+1)*e+(t-1),o=(r+1)*e+t,s=(r+1)*(e-1)+t;f.push(n,i,s),f.push(i,o,s)}}()}(),this.setIndex(f),this.setAttribute("position",new tr(l,3)),this.setAttribute("normal",new tr(h,3)),this.setAttribute("uv",new tr(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new pa((new la[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class ma extends Zn{static get type(){return"MeshLambertMaterial"}constructor(e){super(),this.isMeshLambertMaterial=!0,this.color=new Wn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Wn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new cn,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}function ga(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function va(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}class ya{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let o;n:{r:if(!(e<r)){for(let o=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===o)break;if(i=r,r=t[++n],e<r)break t}o=t.length;break n}if(e>=i)break e;{const s=t[1];e<s&&(n=2,i=s);for(let o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===o)break;if(r=i,i=t[--n-1],e>=i)break t}o=n,n=0}}for(;n<o;){const r=n+o>>>1;e<t[r]?o=r:n=r+1}if(r=t[n],i=t[n-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let e=0;e!==r;++e)t[e]=n[i+e];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class ba extends ya{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:we,endingEnd:we}}intervalChanged_(e,t,n){const r=this.parameterPositions;let i=e-2,o=e+1,s=r[i],a=r[o];if(void 0===s)switch(this.getSettings_().endingStart){case Se:i=e,s=2*t-n;break;case Ee:i=r.length-2,s=t+r[i]-r[i+1];break;default:i=e,s=n}if(void 0===a)switch(this.getSettings_().endingEnd){case Se:o=e,a=2*n-t;break;case Ee:o=1,a=n+r[1]-r[0];break;default:o=e-1,a=t}const u=.5*(n-t),c=this.valueSize;this._weightPrev=u/(t-s),this._weightNext=u/(a-n),this._offsetPrev=i*c,this._offsetNext=o*c}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=e*s,u=a-s,c=this._offsetPrev,l=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(n-t)/(r-t),p=f*f,m=p*f,g=-h*m+2*h*p-h*f,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,b=d*m-d*p;for(let e=0;e!==s;++e)i[e]=g*o[c+e]+v*o[u+e]+y*o[a+e]+b*o[l+e];return i}}class _a extends ya{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=e*s,u=a-s,c=(n-t)/(r-t),l=1-c;for(let e=0;e!==s;++e)i[e]=o[u+e]*l+o[a+e]*c;return i}}class xa extends ya{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class wa{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ga(t,this.TimeBufferType),this.values=ga(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:ga(e.times,Array),values:ga(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new xa(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new _a(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new ba(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case be:t=this.InterpolantFactoryMethodDiscrete;break;case _e:t=this.InterpolantFactoryMethodLinear;break;case xe:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return be;case this.InterpolantFactoryMethodLinear:return _e;case this.InterpolantFactoryMethodSmooth:return xe}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let i=0,o=r-1;for(;i!==r&&n[i]<e;)++i;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==i||o!==r){i>=o&&(o=Math.max(o,1),i=o-1);const e=this.getValueSize();this.times=n.slice(i,o),this.values=this.values.slice(i*e,o*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let t=0;t!==i;t++){const r=n[t];if("number"==typeof r&&isNaN(r)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,r),e=!1;break}if(null!==o&&o>r){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,r,o),e=!1;break}o=r}if(void 0!==r&&va(r))for(let t=0,n=r.length;t!==n;++t){const n=r[t];if(isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,n),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===xe,i=e.length-1;let o=1;for(let s=1;s<i;++s){let i=!1;const a=e[s];if(a!==e[s+1]&&(1!==s||a!==e[0]))if(r)i=!0;else{const e=s*n,r=e-n,o=e+n;for(let s=0;s!==n;++s){const n=t[e+s];if(n!==t[r+s]||n!==t[o+s]){i=!0;break}}}if(i){if(s!==o){e[o]=e[s];const r=s*n,i=o*n;for(let e=0;e!==n;++e)t[i+e]=t[r+e]}++o}}if(i>0){e[o]=e[i];for(let e=i*n,r=o*n,s=0;s!==n;++s)t[r+s]=t[e+s];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}wa.prototype.TimeBufferType=Float32Array,wa.prototype.ValueBufferType=Float32Array,wa.prototype.DefaultInterpolation=_e;class Sa extends wa{constructor(e,t,n){super(e,t,n)}}Sa.prototype.ValueTypeName="bool",Sa.prototype.ValueBufferType=Array,Sa.prototype.DefaultInterpolation=be,Sa.prototype.InterpolantFactoryMethodLinear=void 0,Sa.prototype.InterpolantFactoryMethodSmooth=void 0;class Ea extends wa{}Ea.prototype.ValueTypeName="color";class Ta extends wa{}Ta.prototype.ValueTypeName="number";class Ma extends ya{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=(n-t)/(r-t);let u=e*s;for(let e=u+s;u!==e;u+=4)xt.slerpFlat(i,0,o,u-s,o,u,a);return i}}class Aa extends wa{InterpolantFactoryMethodLinear(e){return new Ma(this.times,this.values,this.getValueSize(),e)}}Aa.prototype.ValueTypeName="quaternion",Aa.prototype.InterpolantFactoryMethodSmooth=void 0;class Ca extends wa{constructor(e,t,n){super(e,t,n)}}Ca.prototype.ValueTypeName="string",Ca.prototype.ValueBufferType=Array,Ca.prototype.DefaultInterpolation=be,Ca.prototype.InterpolantFactoryMethodLinear=void 0,Ca.prototype.InterpolantFactoryMethodSmooth=void 0;class Oa extends wa{}Oa.prototype.ValueTypeName="vector";const Pa={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class Ra{constructor(e,t,n){const r=this;let i,o=!1,s=0,a=0;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===o&&void 0!==r.onStart&&r.onStart(e,s,a),o=!0},this.itemEnd=function(e){s++,void 0!==r.onProgress&&r.onProgress(e,s,a),s===a&&(o=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return i?i(e):e},this.setURLModifier=function(e){return i=e,this},this.addHandler=function(e,t){return u.push(e,t),this},this.removeHandler=function(e){const t=u.indexOf(e);return-1!==t&&u.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=u.length;t<n;t+=2){const n=u[t],r=u[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return r}return null}}}const Na=new Ra;class Ia{constructor(e){this.manager=void 0!==e?e:Na,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Ia.DEFAULT_MATERIAL_NAME="__DEFAULT";class ka extends Ia{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,o=Pa.get(e);if(void 0!==o)return i.manager.itemStart(e),setTimeout((function(){t&&t(o),i.manager.itemEnd(e)}),0),o;const s=Ke("img");function a(){c(),Pa.add(e,this),t&&t(this),i.manager.itemEnd(e)}function u(t){c(),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}function c(){s.removeEventListener("load",a,!1),s.removeEventListener("error",u,!1)}return s.addEventListener("load",a,!1),s.addEventListener("error",u,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),i.manager.itemStart(e),s.src=e,s}}class Da extends Mn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Wn(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(t.object.target=this.target.uuid),t}}const La=new Qt,Ua=new wt,Fa=new wt;class Ba{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Xe(512,512),this.map=null,this.mapPass=null,this.matrix=new Qt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Hr,this._frameExtents=new Xe(1,1),this._viewportCount=1,this._viewports=[new gt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Ua.setFromMatrixPosition(e.matrixWorld),t.position.copy(Ua),Fa.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Fa),t.updateMatrixWorld(),La.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(La),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(La)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class za extends Ba{constructor(){super(new si(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class ja extends Da{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Mn.DEFAULT_UP),this.updateMatrix(),this.target=new Mn,this.shadow=new za}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Va extends Da{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Ga{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Ha(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Ha();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Ha(){return performance.now()}const Wa="\\[\\]\\.:\\/",qa=new RegExp("["+Wa+"]","g"),Xa="[^"+Wa+"]",Za="[^"+Wa.replace("\\.","")+"]",$a=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",Xa)+/(WCOD+)?/.source.replace("WCOD",Za)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Xa)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Xa)+"$"),Ya=["material","materials","bones","map"];class Ka{constructor(e,t,n){this.path=t,this.parsedPath=n||Ka.parseTrackName(t),this.node=Ka.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Ka.Composite(e,t,n):new Ka(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(qa,"")}static parseTrackName(e){const t=$a.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const e=n.nodeName.substring(r+1);-1!==Ya.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let r=0;r<e.length;r++){const i=e[r];if(i.name===t||i.uuid===t)return i;const o=n(i.children);if(o)return o}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let i=t.propertyIndex;if(e||(e=Ka.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(n){let r=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===r){r=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==r){if(void 0===e[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[r]}}const o=e[r];if(void 0===o){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+r+" but it wasn't found.",e)}let s=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?s=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(s=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}a=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=i}else void 0!==o.fromArray&&void 0!==o.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(a=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ka.Composite=class{constructor(e,t,n){const r=n||Ka.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},Ka.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Ka.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Ka.prototype.GetterByBindingType=[Ka.prototype._getValue_direct,Ka.prototype._getValue_array,Ka.prototype._getValue_arrayElement,Ka.prototype._getValue_toArray],Ka.prototype.SetterByBindingTypeAndVersioning=[[Ka.prototype._setValue_direct,Ka.prototype._setValue_direct_setNeedsUpdate,Ka.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ka.prototype._setValue_array,Ka.prototype._setValue_array_setNeedsUpdate,Ka.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ka.prototype._setValue_arrayElement,Ka.prototype._setValue_arrayElement_setNeedsUpdate,Ka.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ka.prototype._setValue_fromArray,Ka.prototype._setValue_fromArray_setNeedsUpdate,Ka.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);const Qa=new Qt;class Ja{constructor(e,t,n=0,r=1/0){this.ray=new Kt(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new ln,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return Qa.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(Qa),this}intersectObject(e,t=!0,n=[]){return tu(e,this,n,t),n.sort(eu),n}intersectObjects(e,t=!0,n=[]){for(let r=0,i=e.length;r<i;r++)tu(e[r],this,n,t);return n.sort(eu),n}}function eu(e,t){return e.distance-t.distance}function tu(e,t,n,r){let i=!0;if(e.layers.test(t.layers)){!1===e.raycast(t,n)&&(i=!1)}if(!0===i&&!0===r){const r=e.children;for(let e=0,i=r.length;e<i;e++)tu(r[e],t,n,!0)}}class nu{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(je(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class ru extends De{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:r}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=r);const iu=new jr,ou=new Xe,su=new wt,au=new Xe,uu=new Xe,cu=new wt,lu=new wt,hu=new Qt,du=new wt,fu=new wt;let pu=null,mu=null;const gu=[],vu=-1,yu=0,bu=1;class _u extends ru{constructor(e,t,n=null){super(t,n),this.objects=e,this.recursive=!0,this.transformGroup=!1,this.rotateSpeed=1,this.raycaster=new Ja,this.mouseButtons={LEFT:i.PAN,MIDDLE:i.PAN,RIGHT:i.ROTATE},this.touches={ONE:s},this._onPointerMove=xu.bind(this),this._onPointerDown=wu.bind(this),this._onPointerCancel=Su.bind(this),this._onContextMenu=Eu.bind(this),null!==n&&this.connect()}connect(){this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerCancel),this.domElement.addEventListener("pointerleave",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerCancel),this.domElement.removeEventListener("pointerleave",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto",this.domElement.style.cursor=""}dispose(){this.disconnect()}_updatePointer(e){const t=this.domElement.getBoundingClientRect();ou.x=(e.clientX-t.left)/t.width*2-1,ou.y=-(e.clientY-t.top)/t.height*2+1}_updateState(e){let t;if("touch"===e.pointerType)t=this.touches.ONE;else switch(e.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=null}switch(t){case i.PAN:case s:this.state=yu;break;case i.ROTATE:case o:this.state=bu;break;default:this.state=vu}}getRaycaster(){return console.warn("THREE.DragControls: getRaycaster() has been deprecated. Use controls.raycaster instead."),this.raycaster}setObjects(e){console.warn("THREE.DragControls: setObjects() has been deprecated. Use controls.objects instead."),this.objects=e}getObjects(){return console.warn("THREE.DragControls: getObjects() has been deprecated. Use controls.objects instead."),this.objects}activate(){console.warn("THREE.DragControls: activate() has been renamed to connect()."),this.connect()}deactivate(){console.warn("THREE.DragControls: deactivate() has been renamed to disconnect()."),this.disconnect()}set mode(e){console.warn("THREE.DragControls: The .mode property has been removed. Define the type of transformation via the .mouseButtons or .touches properties.")}get mode(){console.warn("THREE.DragControls: The .mode property has been removed. Define the type of transformation via the .mouseButtons or .touches properties.")}}function xu(e){const t=this.object,n=this.domElement,r=this.raycaster;if(!1!==this.enabled){if(this._updatePointer(e),r.setFromCamera(ou,t),pu)this.state===yu?r.ray.intersectPlane(iu,cu)&&pu.position.copy(cu.sub(su).applyMatrix4(hu)):this.state===bu&&(au.subVectors(ou,uu).multiplyScalar(this.rotateSpeed),pu.rotateOnWorldAxis(du,au.x),pu.rotateOnWorldAxis(fu.normalize(),-au.y)),this.dispatchEvent({type:"drag",object:pu}),uu.copy(ou);else if("mouse"===e.pointerType||"pen"===e.pointerType)if(gu.length=0,r.setFromCamera(ou,t),r.intersectObjects(this.objects,this.recursive,gu),gu.length>0){const e=gu[0].object;iu.setFromNormalAndCoplanarPoint(t.getWorldDirection(iu.normal),lu.setFromMatrixPosition(e.matrixWorld)),mu!==e&&null!==mu&&(this.dispatchEvent({type:"hoveroff",object:mu}),n.style.cursor="auto",mu=null),mu!==e&&(this.dispatchEvent({type:"hoveron",object:e}),n.style.cursor="pointer",mu=e)}else null!==mu&&(this.dispatchEvent({type:"hoveroff",object:mu}),n.style.cursor="auto",mu=null);uu.copy(ou)}}function wu(e){const t=this.object,n=this.domElement,r=this.raycaster;!1!==this.enabled&&(this._updatePointer(e),this._updateState(e),gu.length=0,r.setFromCamera(ou,t),r.intersectObjects(this.objects,this.recursive,gu),gu.length>0&&(pu=!0===this.transformGroup?Tu(gu[0].object):gu[0].object,iu.setFromNormalAndCoplanarPoint(t.getWorldDirection(iu.normal),lu.setFromMatrixPosition(pu.matrixWorld)),r.ray.intersectPlane(iu,cu)&&(this.state===yu?(hu.copy(pu.parent.matrixWorld).invert(),su.copy(cu).sub(lu.setFromMatrixPosition(pu.matrixWorld))):this.state===bu&&(du.set(0,1,0).applyQuaternion(t.quaternion).normalize(),fu.set(1,0,0).applyQuaternion(t.quaternion).normalize())),n.style.cursor="move",this.dispatchEvent({type:"dragstart",object:pu})),uu.copy(ou))}function Su(){!1!==this.enabled&&(pu&&(this.dispatchEvent({type:"dragend",object:pu}),pu=null),this.domElement.style.cursor=mu?"pointer":"auto",this.state=vu)}function Eu(e){!1!==this.enabled&&e.preventDefault()}function Tu(e,t=null){return e.isGroup&&(t=e),null===e.parent?t:Tu(e.parent,t)}var Mu=n(13320),Au=n(5271),Cu=n(80621),Ou=n(44200),Pu=n(54476),Ru=n(64794),Nu=n(88291),Iu=n(42358),ku=n(66819),Du=n(49085),Lu=n(86925),Uu=n(37996);function Fu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bu(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zu(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function ju(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,s,a=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(e,t)||Gu(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vu(e){return function(e){if(Array.isArray(e))return Hu(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Gu(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gu(e,t){if(e){if("string"==typeof e)return Hu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hu(e,t):void 0}}function Hu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Wu=["createObj","updateObj","exitObj","objBindAttr","dataBindAttr"];function qu(e,t,n){var r=n.objBindAttr,i=void 0===r?"__obj":r,o=n.dataBindAttr,s=void 0===o?"__data":o,a=n.idAccessor,u=n.purge,c=void 0!==u&&u,l=function(e){return e.hasOwnProperty(s)},h=t.filter((function(e){return!l(e)})),d=t.filter(l).map((function(e){return e[s]})),f=c?{enter:e,exit:d,update:[]}:function(e,t,n){var r={enter:[],update:[],exit:[]};if(n){var i=(0,Uu.Z)(e,n,!1),o=(0,Uu.Z)(t,n,!1),s=Object.assign({},i,o);Object.entries(s).forEach((function(e){var t=ju(e,2),n=t[0],s=t[1],a=i.hasOwnProperty(n)?o.hasOwnProperty(n)?"update":"exit":"enter";r[a].push("update"===a?[i[n],o[n]]:s)}))}else{var a=new Set(e),u=new Set(t);new Set([].concat(Vu(a),Vu(u))).forEach((function(e){var t=a.has(e)?u.has(e)?"update":"exit":"enter";r[t].push("update"===t?[e,e]:e)}))}return r}(d,e,a);return f.update=f.update.map((function(e){var t=ju(e,2),n=t[0],r=t[1];return n!==r&&(r[i]=n[i],r[i][s]=r),r})),f.exit=f.exit.concat(h.map((function(e){return Bu({},i,e)}))),f}function Xu(e,t,n,r,i){var o=i.createObj,s=void 0===o?function(e){return{}}:o,a=i.updateObj,u=void 0===a?function(e,t){}:a,c=i.exitObj,l=void 0===c?function(e){}:c,h=i.objBindAttr,d=void 0===h?"__obj":h,f=i.dataBindAttr,p=void 0===f?"__data":f,m=zu(i,Wu),g=qu(e,t,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fu(Object(n),!0).forEach((function(t){Bu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({objBindAttr:d,dataBindAttr:p},m)),v=g.enter,y=g.update;g.exit.forEach((function(e){var t=e[d];delete e[d],l(t),r(t)}));var b=function(e){var t=[];return e.forEach((function(e){var n=s(e);n&&(n[p]=e,e[d]=n,t.push(n))})),t}(v);!function(e){e.forEach((function(e){var t=e[d];t&&(t[p]=e,u(t,e))}))}([].concat(Vu(v),Vu(y))),b.forEach(n)}var Zu=n(9771),$u=n(22059),Yu=n(20680);function Ku(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Qu(e,t,n){return t=nc(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ic()?Reflect.construct(t,n||[],nc(e).constructor):t.apply(e,n))}function Ju(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ec(e,t,n){return Object.defineProperty(e,"prototype",{writable:!1}),e}function tc(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nc(e){return nc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nc(e)}function rc(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uc(e,t)}function ic(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ic=function(){return!!e})()}function oc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oc(Object(n),!0).forEach((function(t){tc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ac(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function uc(e,t){return uc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},uc(e,t)}function cc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,s,a=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t);else for(;!(u=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(e,t)||dc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lc(e){return function(e){if(Array.isArray(e))return Ku(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||dc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hc(e){return hc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hc(e)}function dc(e,t){if(e){if("string"==typeof e)return Ku(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ku(e,t):void 0}}var fc=function(e){e instanceof Array?e.forEach(fc):(e.map&&e.map.dispose(),e.dispose())},pc=function(e){e.geometry&&e.geometry.dispose(),e.material&&fc(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(pc)},mc=function(e){for(;e.children.length;){var t=e.children[0];e.remove(t),pc(t)}},gc=["objFilter"];function vc(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.objFilter,i=void 0===r?function(){return!0}:r,o=ac(n,gc);return Xu(e,t.children.filter(i),(function(e){return t.add(e)}),(function(e){t.remove(e),mc(e)}),sc({objBindAttr:"__threeObj"},o))}var yc=function(e){return isNaN(e)?parseInt((0,Yu.Z)(e).toHex(),16):e},bc=function(e){return isNaN(e)?(0,Yu.Z)(e).getAlpha():1},_c=(0,Zu.Z)($u.Z);function xc(e,t,n){t&&"string"==typeof n&&e.filter((function(e){return!e[n]})).forEach((function(e){e[n]=_c(t(e))}))}var wc=window.THREE?window.THREE:{Group:Cs,Mesh:xr,MeshLambertMaterial:ma,Color:Wn,BufferGeometry:cr,BufferAttribute:Qn,Matrix4:Qt,Vector3:wt,SphereGeometry:fa,CylinderGeometry:ha,TubeGeometry:pa,ConeGeometry:da,Line:qs,LineBasicMaterial:Fs,QuadraticBezierCurve3:ua,CubicBezierCurve3:oa,Box3:Tt},Sc={graph:Ru,forcelayout:Nu},Ec=(new wc.BufferGeometry).setAttribute?"setAttribute":"addAttribute",Tc=(new wc.BufferGeometry).applyMatrix4?"applyMatrix4":"applyMatrix",Mc=(0,Iu.Z)({props:{jsonUrl:{onChange:function(e,t){var n=this;e&&!t.fetchingJson&&(t.fetchingJson=!0,t.onLoading(),fetch(e).then((function(e){return e.json()})).then((function(e){t.fetchingJson=!1,t.onFinishLoading(e),n.graphData(e)})))},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(e,t){t.engineRunning=!1}},numDimensions:{default:3,onChange:function(e,t){var n=t.d3ForceLayout.force("charge");function r(e,t){e.forEach((function(e){delete e[t],delete e["v".concat(t)]}))}n&&n.strength(e>2?-60:-30),e<3&&r(t.graphData.nodes,"z"),e<2&&r(t.graphData.nodes,"y")}},dagMode:{onChange:function(e,t){!e&&"d3"===t.forceEngine&&(t.graphData.nodes||[]).forEach((function(e){return e.fx=e.fy=e.fz=void 0}))}},dagLevelDistance:{},dagNodeFilter:{default:function(e){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4},nodeId:{default:"id"},nodeVal:{default:"val"},nodeResolution:{default:8},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeVisibility:{default:!0},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},nodePositionUpdate:{triggerUpdate:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{},linkResolution:{default:6},linkCurvature:{default:0,triggerUpdate:!1},linkCurveRotation:{default:0,triggerUpdate:!1},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{triggerUpdate:!1},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(e,t){t.d3ForceLayout.alphaDecay(e)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(e,t){t.d3ForceLayout.alphaTarget(e)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(e,t){t.d3ForceLayout.velocityDecay(e)}},ngraphPhysics:{default:{timeStep:20,gravity:-1.2,theta:.8,springLength:30,springCoefficient:8e-4,dragCoefficient:.02}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onLoading:{default:function(){},triggerUpdate:!1},onFinishLoading:{default:function(){},triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1}},methods:{refresh:function(e){return e._flushObjects=!0,e._rerender(),this},d3Force:function(e,t,n){return void 0===n?e.d3ForceLayout.force(t):(e.d3ForceLayout.force(t,n),this)},d3ReheatSimulation:function(e){return e.d3ForceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(e){return e.cntTicks=0,e.startTickTime=new Date,e.engineRunning=!0,this},tickFrame:function(e){var t,n,r,i,o="ngraph"!==e.forceEngine;return e.engineRunning&&function(){++e.cntTicks>e.cooldownTicks||new Date-e.startTickTime>e.cooldownTime||o&&e.d3AlphaMin>0&&e.d3ForceLayout.alpha()<e.d3AlphaMin?(e.engineRunning=!1,e.onEngineStop()):(e.layout[o?"tick":"step"](),e.onEngineTick());var t=(0,ku.Z)(e.nodeThreeObjectExtend);e.graphData.nodes.forEach((function(n){var r=n.__threeObj;if(r){var i=o?n:e.layout.getNodePosition(n[e.nodeId]),s=t(n);e.nodePositionUpdate&&e.nodePositionUpdate(s?r.children[0]:r,{x:i.x,y:i.y,z:i.z},n)&&!s||(r.position.x=i.x,r.position.y=i.y||0,r.position.z=i.z||0)}}));var n=(0,ku.Z)(e.linkWidth),r=(0,ku.Z)(e.linkCurvature),i=(0,ku.Z)(e.linkCurveRotation),s=(0,ku.Z)(e.linkThreeObjectExtend);function a(t){var n=o?t:e.layout.getLinkPosition(e.layout.graph.getLink(t.source,t.target).id),s=n[o?"source":"from"],a=n[o?"target":"to"];if(s&&a&&s.hasOwnProperty("x")&&a.hasOwnProperty("x")){var u=r(t);if(u){var c,l=new wc.Vector3(s.x,s.y||0,s.z||0),h=new wc.Vector3(a.x,a.y||0,a.z||0),d=l.distanceTo(h),f=i(t);if(d>0){var p=a.x-s.x,m=a.y-s.y||0,g=(new wc.Vector3).subVectors(h,l),v=g.clone().multiplyScalar(u).cross(0!==p||0!==m?new wc.Vector3(0,0,1):new wc.Vector3(0,1,0)).applyAxisAngle(g.normalize(),f).add((new wc.Vector3).addVectors(l,h).divideScalar(2));c=new wc.QuadraticBezierCurve3(l,v,h)}else{var y=70*u,b=-f,_=b+Math.PI/2;c=new wc.CubicBezierCurve3(l,new wc.Vector3(y*Math.cos(_),y*Math.sin(_),0).add(l),new wc.Vector3(y*Math.cos(b),y*Math.sin(b),0).add(l),h)}t.__curve=c}else t.__curve=null}}e.graphData.links.forEach((function(t){var r=t.__lineObj;if(r){var i=o?t:e.layout.getLinkPosition(e.layout.graph.getLink(t.source,t.target).id),u=i[o?"source":"from"],c=i[o?"target":"to"];if(u&&c&&u.hasOwnProperty("x")&&c.hasOwnProperty("x")){a(t);var l=s(t);if(!e.linkPositionUpdate||!e.linkPositionUpdate(l?r.children[1]:r,{start:{x:u.x,y:u.y,z:u.z},end:{x:c.x,y:c.y,z:c.z}},t)||l){var h=30,d=t.__curve,f=r.children.length?r.children[0]:r;if("Line"===f.type){if(d){var p=d.getPoints(h);f.geometry.getAttribute("position").array.length!==3*p.length&&f.geometry[Ec]("position",new wc.BufferAttribute(new Float32Array(3*p.length),3)),f.geometry.setFromPoints(p)}else{var m=f.geometry.getAttribute("position");m&&m.array&&6===m.array.length||f.geometry[Ec]("position",m=new wc.BufferAttribute(new Float32Array(6),3)),m.array[0]=u.x,m.array[1]=u.y||0,m.array[2]=u.z||0,m.array[3]=c.x,m.array[4]=c.y||0,m.array[5]=c.z||0,m.needsUpdate=!0}f.geometry.computeBoundingSphere()}else if("Mesh"===f.type)if(d){f.geometry.type.match(/^Tube(Buffer)?Geometry$/)||(f.position.set(0,0,0),f.rotation.set(0,0,0),f.scale.set(1,1,1));var g=Math.ceil(10*n(t))/10/2,v=new wc.TubeGeometry(d,h,g,e.linkResolution,!1);f.geometry.dispose(),f.geometry=v}else{if(!f.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)){var y=Math.ceil(10*n(t))/10/2,b=new wc.CylinderGeometry(y,y,1,e.linkResolution,1,!1);b[Tc]((new wc.Matrix4).makeTranslation(0,.5,0)),b[Tc]((new wc.Matrix4).makeRotationX(Math.PI/2)),f.geometry.dispose(),f.geometry=b}var _=new wc.Vector3(u.x,u.y||0,u.z||0),x=new wc.Vector3(c.x,c.y||0,c.z||0),w=_.distanceTo(x);f.position.x=_.x,f.position.y=_.y,f.position.z=_.z,f.scale.z=w,f.parent.localToWorld(x),f.lookAt(x)}}}}}))}(),t=(0,ku.Z)(e.linkDirectionalArrowRelPos),n=(0,ku.Z)(e.linkDirectionalArrowLength),r=(0,ku.Z)(e.nodeVal),e.graphData.links.forEach((function(i){var s=i.__arrowObj;if(s){var a=o?i:e.layout.getLinkPosition(e.layout.graph.getLink(i.source,i.target).id),u=a[o?"source":"from"],c=a[o?"target":"to"];if(u&&c&&u.hasOwnProperty("x")&&c.hasOwnProperty("x")){var l=Math.cbrt(Math.max(0,r(u)||1))*e.nodeRelSize,h=Math.cbrt(Math.max(0,r(c)||1))*e.nodeRelSize,d=n(i),f=t(i),p=i.__curve?function(e){return i.__curve.getPoint(e)}:function(e){var t=function(e,t,n,r){return t[e]+(n[e]-t[e])*r||0};return{x:t("x",u,c,e),y:t("y",u,c,e),z:t("z",u,c,e)}},m=i.__curve?i.__curve.getLength():Math.sqrt(["x","y","z"].map((function(e){return Math.pow((c[e]||0)-(u[e]||0),2)})).reduce((function(e,t){return e+t}),0)),g=l+d+(m-l-h-d)*f,v=p(g/m),y=p((g-d)/m);["x","y","z"].forEach((function(e){return s.position[e]=y[e]}));var b=function(e,t,n){if(ic())return Reflect.construct.apply(null,arguments);var r=[null];return r.push.apply(r,t),new(e.bind.apply(e,r))}(wc.Vector3,lc(["x","y","z"].map((function(e){return v[e]}))));s.parent.localToWorld(b),s.lookAt(b)}}})),i=(0,ku.Z)(e.linkDirectionalParticleSpeed),e.graphData.links.forEach((function(t){var n=t.__photonsObj&&t.__photonsObj.children,r=t.__singleHopPhotonsObj&&t.__singleHopPhotonsObj.children;if(r&&r.length||n&&n.length){var s=o?t:e.layout.getLinkPosition(e.layout.graph.getLink(t.source,t.target).id),a=s[o?"source":"from"],u=s[o?"target":"to"];if(a&&u&&a.hasOwnProperty("x")&&u.hasOwnProperty("x")){var c=i(t),l=t.__curve?function(e){return t.__curve.getPoint(e)}:function(e){var t=function(e,t,n,r){return t[e]+(n[e]-t[e])*r||0};return{x:t("x",a,u,e),y:t("y",a,u,e),z:t("z",a,u,e)}};[].concat(lc(n||[]),lc(r||[])).forEach((function(e,t){var r="singleHopPhotons"===e.parent.__linkThreeObjType;if(e.hasOwnProperty("__progressRatio")||(e.__progressRatio=r?0:t/n.length),e.__progressRatio+=c,e.__progressRatio>=1){if(r)return e.parent.remove(e),void mc(e);e.__progressRatio=e.__progressRatio%1}var i=e.__progressRatio,o=l(i);["x","y","z"].forEach((function(t){return e.position[t]=o[t]}))}))}}})),this},emitParticle:function(e,t){if(t&&e.graphData.links.includes(t)){if(!t.__singleHopPhotonsObj){var n=new wc.Group;n.__linkThreeObjType="singleHopPhotons",t.__singleHopPhotonsObj=n,e.graphScene.add(n)}var r=(0,ku.Z)(e.linkDirectionalParticleWidth),i=Math.ceil(10*r(t))/10/2,o=e.linkDirectionalParticleResolution,s=new wc.SphereGeometry(i,o,o),a=(0,ku.Z)(e.linkColor),u=(0,ku.Z)(e.linkDirectionalParticleColor)(t)||a(t)||"#f0f0f0",c=new wc.Color(yc(u)),l=3*e.linkOpacity,h=new wc.MeshLambertMaterial({color:c,transparent:!0,opacity:l});t.__singleHopPhotonsObj.add(new wc.Mesh(s,h))}return this},getGraphBbox:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};if(!e.initialised)return null;var n=function e(n){var r=[];if(n.geometry){n.geometry.computeBoundingBox();var i=new wc.Box3;i.copy(n.geometry.boundingBox).applyMatrix4(n.matrixWorld),r.push(i)}return r.concat.apply(r,lc((n.children||[]).filter((function(e){return!e.hasOwnProperty("__graphObjType")||"node"===e.__graphObjType&&t(e.__data)})).map(e)))}(e.graphScene);return n.length?Object.assign.apply(Object,lc(["x","y","z"].map((function(e){return tc({},e,[(0,Du.Z)(n,(function(t){return t.min[e]})),(0,Lu.Z)(n,(function(t){return t.max[e]}))])})))):null}},stateInit:function(){return{d3ForceLayout:(0,Mu.Z)().force("link",(0,Au.Z)()).force("charge",(0,Cu.Z)()).force("center",(0,Ou.Z)()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(e,t){t.graphScene=e},update:function(e,t){var n=function(e){return e.some((function(e){return t.hasOwnProperty(e)}))};if(e.engineRunning=!1,e.onUpdate(),null!==e.nodeAutoColorBy&&n(["nodeAutoColorBy","graphData","nodeColor"])&&xc(e.graphData.nodes,(0,ku.Z)(e.nodeAutoColorBy),e.nodeColor),null!==e.linkAutoColorBy&&n(["linkAutoColorBy","graphData","linkColor"])&&xc(e.graphData.links,(0,ku.Z)(e.linkAutoColorBy),e.linkColor),e._flushObjects||n(["graphData","nodeThreeObject","nodeThreeObjectExtend","nodeVal","nodeColor","nodeVisibility","nodeRelSize","nodeResolution","nodeOpacity"])){var r=(0,ku.Z)(e.nodeThreeObject),i=(0,ku.Z)(e.nodeThreeObjectExtend),o=(0,ku.Z)(e.nodeVal),s=(0,ku.Z)(e.nodeColor),a=(0,ku.Z)(e.nodeVisibility),u={},c={};vc(e.graphData.nodes.filter(a),e.graphScene,{purge:e._flushObjects||n(["nodeThreeObject","nodeThreeObjectExtend"]),objFilter:function(e){return"node"===e.__graphObjType},createObj:function(t){var n,o=r(t),s=i(t);return o&&e.nodeThreeObject===o&&(o=o.clone()),o&&!s?n=o:((n=new wc.Mesh).__graphDefaultObj=!0,o&&s&&n.add(o)),n.__graphObjType="node",n},updateObj:function(t,n){if(t.__graphDefaultObj){var r=o(n)||1,i=Math.cbrt(r)*e.nodeRelSize,a=e.nodeResolution;t.geometry.type.match(/^Sphere(Buffer)?Geometry$/)&&t.geometry.parameters.radius===i&&t.geometry.parameters.widthSegments===a||(u.hasOwnProperty(r)||(u[r]=new wc.SphereGeometry(i,a,a)),t.geometry.dispose(),t.geometry=u[r]);var l=s(n),h=new wc.Color(yc(l||"#ffffaa")),d=e.nodeOpacity*bc(l);"MeshLambertMaterial"===t.material.type&&t.material.color.equals(h)&&t.material.opacity===d||(c.hasOwnProperty(l)||(c[l]=new wc.MeshLambertMaterial({color:h,transparent:!0,opacity:d})),t.material.dispose(),t.material=c[l])}}})}if(e._flushObjects||n(["graphData","linkThreeObject","linkThreeObjectExtend","linkMaterial","linkColor","linkWidth","linkVisibility","linkResolution","linkOpacity","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution"])){var l=(0,ku.Z)(e.linkThreeObject),h=(0,ku.Z)(e.linkThreeObjectExtend),d=(0,ku.Z)(e.linkMaterial),f=(0,ku.Z)(e.linkVisibility),p=(0,ku.Z)(e.linkColor),m=(0,ku.Z)(e.linkWidth),g={},v={},y={},b=e.graphData.links.filter(f);if(vc(b,e.graphScene,{objBindAttr:"__lineObj",purge:e._flushObjects||n(["linkThreeObject","linkThreeObjectExtend","linkWidth"]),objFilter:function(e){return"link"===e.__graphObjType},exitObj:function(e){var t=e.__data&&e.__data.__singleHopPhotonsObj;t&&(t.parent.remove(t),mc(t),delete e.__data.__singleHopPhotonsObj)},createObj:function(t){var n,r,i=l(t),o=h(t);if(i&&e.linkThreeObject===i&&(i=i.clone()),!i||o)if(!!m(t))n=new wc.Mesh;else{var s=new wc.BufferGeometry;s[Ec]("position",new wc.BufferAttribute(new Float32Array(6),3)),n=new wc.Line(s)}return i?o?((r=new wc.Group).__graphDefaultObj=!0,r.add(n),r.add(i)):r=i:(r=n).__graphDefaultObj=!0,r.renderOrder=10,r.__graphObjType="link",r},updateObj:function(t,n){if(t.__graphDefaultObj){var r=t.children.length?t.children[0]:t,i=Math.ceil(10*m(n))/10,o=!!i;if(o){var s=i/2,a=e.linkResolution;if(!r.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)||r.geometry.parameters.radiusTop!==s||r.geometry.parameters.radialSegments!==a){if(!g.hasOwnProperty(i)){var u=new wc.CylinderGeometry(s,s,1,a,1,!1);u[Tc]((new wc.Matrix4).makeTranslation(0,.5,0)),u[Tc]((new wc.Matrix4).makeRotationX(Math.PI/2)),g[i]=u}r.geometry.dispose(),r.geometry=g[i]}}var c=d(n);if(c)r.material=c;else{var l=p(n),h=new wc.Color(yc(l||"#f0f0f0")),f=e.linkOpacity*bc(l),b=o?"MeshLambertMaterial":"LineBasicMaterial";if(r.material.type!==b||!r.material.color.equals(h)||r.material.opacity!==f){var _=o?v:y;_.hasOwnProperty(l)||(_[l]=new wc[b]({color:h,transparent:f<1,opacity:f,depthWrite:f>=1})),r.material.dispose(),r.material=_[l]}}}}}),e.linkDirectionalArrowLength||t.hasOwnProperty("linkDirectionalArrowLength")){var _=(0,ku.Z)(e.linkDirectionalArrowLength),x=(0,ku.Z)(e.linkDirectionalArrowColor);vc(b.filter(_),e.graphScene,{objBindAttr:"__arrowObj",objFilter:function(e){return"arrow"===e.__linkThreeObjType},createObj:function(){var e=new wc.Mesh(void 0,new wc.MeshLambertMaterial({transparent:!0}));return e.__linkThreeObjType="arrow",e},updateObj:function(t,n){var r=_(n),i=e.linkDirectionalArrowResolution;if(!t.geometry.type.match(/^Cone(Buffer)?Geometry$/)||t.geometry.parameters.height!==r||t.geometry.parameters.radialSegments!==i){var o=new wc.ConeGeometry(.25*r,r,i);o.translate(0,r/2,0),o.rotateX(Math.PI/2),t.geometry.dispose(),t.geometry=o}var s=x(n)||p(n)||"#f0f0f0";t.material.color=new wc.Color(yc(s)),t.material.opacity=3*e.linkOpacity*bc(s)}})}if(e.linkDirectionalParticles||t.hasOwnProperty("linkDirectionalParticles")){var w=(0,ku.Z)(e.linkDirectionalParticles),S=(0,ku.Z)(e.linkDirectionalParticleWidth),E=(0,ku.Z)(e.linkDirectionalParticleColor),T={},M={};vc(b.filter(w),e.graphScene,{objBindAttr:"__photonsObj",objFilter:function(e){return"photons"===e.__linkThreeObjType},createObj:function(){var e=new wc.Group;return e.__linkThreeObjType="photons",e},updateObj:function(t,n){var r,i=Math.round(Math.abs(w(n))),o=!!t.children.length&&t.children[0],s=Math.ceil(10*S(n))/10/2,a=e.linkDirectionalParticleResolution;o&&o.geometry.parameters.radius===s&&o.geometry.parameters.widthSegments===a?r=o.geometry:(M.hasOwnProperty(s)||(M[s]=new wc.SphereGeometry(s,a,a)),r=M[s],o&&o.geometry.dispose());var u,c=E(n)||p(n)||"#f0f0f0",l=new wc.Color(yc(c)),h=3*e.linkOpacity;o&&o.material.color.equals(l)&&o.material.opacity===h?u=o.material:(T.hasOwnProperty(c)||(T[c]=new wc.MeshLambertMaterial({color:l,transparent:!0,opacity:h})),u=T[c],o&&o.material.dispose()),vc(lc(new Array(i)).map((function(e,t){return{idx:t}})),t,{idAccessor:function(e){return e.idx},createObj:function(){return new wc.Mesh(r,u)},updateObj:function(e){e.geometry=r,e.material=u}})}})}}if(e._flushObjects=!1,n(["graphData","nodeId","linkSource","linkTarget","numDimensions","forceEngine","dagMode","dagNodeFilter","dagLevelDistance"])){e.engineRunning=!1,e.graphData.links.forEach((function(t){t.source=t[e.linkSource],t.target=t[e.linkTarget]}));var A,C="ngraph"!==e.forceEngine;if(C){(A=e.d3ForceLayout).stop().alpha(1).numDimensions(e.numDimensions).nodes(e.graphData.nodes);var O=e.d3ForceLayout.force("link");O&&O.id((function(t){return t[e.nodeId]})).links(e.graphData.links);var P=e.dagMode&&function(e,t){var n=e.nodes,r=e.links,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=i.nodeFilter,s=void 0===o?function(){return!0}:o,a=i.onLoopError,u=void 0===a?function(e){throw"Invalid DAG structure! Found cycle in node path: ".concat(e.join(" -> "),".")}:a,c={};n.forEach((function(e){return c[t(e)]={data:e,out:[],depth:-1,skip:!s(e)}})),r.forEach((function(e){var n=e.source,r=e.target,i=u(n),o=u(r);if(!c.hasOwnProperty(i))throw"Missing source node with id: ".concat(i);if(!c.hasOwnProperty(o))throw"Missing target node with id: ".concat(o);var s=c[i],a=c[o];function u(e){return"object"===hc(e)?t(e):e}s.out.push(a)}));var l=[];d(Object.values(c));var h=Object.assign.apply(Object,[{}].concat(lc(Object.entries(c).filter((function(e){return!cc(e,2)[1].skip})).map((function(e){var t=cc(e,2);return tc({},t[0],t[1].depth)})))));return h;function d(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=function(){var i=e[o];if(-1!==n.indexOf(i)){var s=[].concat(lc(n.slice(n.indexOf(i))),[i]).map((function(e){return t(e.data)}));return l.some((function(e){return e.length===s.length&&e.every((function(e,t){return e===s[t]}))}))||(l.push(s),u(s)),1}r>i.depth&&(i.depth=r,d(i.out,[].concat(lc(n),[i]),r+(i.skip?0:1)))},o=0,s=e.length;o<s;o++)i()}}(e.graphData,(function(t){return t[e.nodeId]}),{nodeFilter:e.dagNodeFilter,onLoopError:e.onDagError||void 0}),R=Math.max.apply(Math,lc(Object.values(P||[]))),N=e.dagLevelDistance||e.graphData.nodes.length/(R||1)*2*(-1!==["radialin","radialout"].indexOf(e.dagMode)?.7:1);if(["lr","rl","td","bu","zin","zout"].includes(t.dagMode)){var I=["lr","rl"].includes(t.dagMode)?"fx":["td","bu"].includes(t.dagMode)?"fy":"fz";e.graphData.nodes.filter(e.dagNodeFilter).forEach((function(e){return delete e[I]}))}if(["lr","rl","td","bu","zin","zout"].includes(e.dagMode)){var k=["rl","td","zout"].includes(e.dagMode),D=["lr","rl"].includes(e.dagMode)?"fx":["td","bu"].includes(e.dagMode)?"fy":"fz";e.graphData.nodes.filter(e.dagNodeFilter).forEach((function(t){return t[D]=function(t){return(P[t[e.nodeId]]-R/2)*N*(k?-1:1)}(t)}))}e.d3ForceLayout.force("dagRadial",-1!==["radialin","radialout"].indexOf(e.dagMode)?(0,Pu.Z)((function(t){var n=P[t[e.nodeId]]||-1;return("radialin"===e.dagMode?R-n:n)*N})).strength((function(t){return e.dagNodeFilter(t)?1:0})):null)}else{var L=Sc.graph();e.graphData.nodes.forEach((function(t){L.addNode(t[e.nodeId])})),e.graphData.links.forEach((function(e){L.addLink(e.source,e.target)})),(A=Sc.forcelayout(L,sc({dimensions:e.numDimensions},e.ngraphPhysics))).graph=L}for(var U=0;U<e.warmupTicks&&!(C&&e.d3AlphaMin>0&&e.d3ForceLayout.alpha()<e.d3AlphaMin);U++)A[C?"tick":"step"]();e.layout=A,this.resetCountdown()}e.engineRunning=!0,e.onFinishUpdate()}});var Ac=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(t){function r(){var t;Ju(this,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return(t=Qu(this,r,[].concat(o))).__kapsuleInstance=e().apply(void 0,[].concat(lc(n?[t]:[]),o)),t}return rc(r,t),ec(r)}(t);return Object.keys(e()).forEach((function(e){return r.prototype[e]=function(){var t,n=(t=this.__kapsuleInstance)[e].apply(t,arguments);return n===this.__kapsuleInstance?this:n}})),r}(Mc,(window.THREE?window.THREE:{Group:Cs}).Group,!0);const Cc="170",Oc=100,Pc=204,Rc=205,Nc=300,Ic=301,kc=302,Dc=303,Lc=304,Uc=306,Fc=1e3,Bc=1001,zc=1002,jc=1003,Vc=1004,Gc=1005,Hc=1006,Wc=1007,qc=1008,Xc=1009,Zc=1010,$c=1011,Yc=1012,Kc=1013,Qc=1014,Jc=1015,el=1016,tl=1020,nl=1022,rl=1023,il=1026,ol=1027,sl=1028,al=1029,ul=1030,cl=1031,ll=1033,hl=33776,dl=33777,fl=33778,pl=33779,ml=37492,gl=37496,vl=37808,yl=37809,bl=37810,_l=37811,xl=37812,wl=37813,Sl=37814,El=37815,Tl=37816,Ml=37817,Al=37818,Cl=37819,Ol=37820,Pl=37821,Rl=36492,Nl=2300,Il=2301,kl=2302,Dl=2400,Ll=2401,Ul=2402,Fl="",Bl="srgb",zl="srgb-linear",jl="linear",Vl="srgb",Gl=7680,Hl=35044,Wl=35048,ql=2e3,Xl=2001;class Zl{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e);e.target=null}}}const $l=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Yl=1234567;const Kl=Math.PI/180,Ql=180/Math.PI;function Jl(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return($l[255&e]+$l[e>>8&255]+$l[e>>16&255]+$l[e>>24&255]+"-"+$l[255&t]+$l[t>>8&255]+"-"+$l[t>>16&15|64]+$l[t>>24&255]+"-"+$l[63&n|128]+$l[n>>8&255]+"-"+$l[n>>16&255]+$l[n>>24&255]+$l[255&r]+$l[r>>8&255]+$l[r>>16&255]+$l[r>>24&255]).toLowerCase()}function eh(e,t,n){return Math.max(t,Math.min(n,e))}function th(e,t){return(e%t+t)%t}function nh(e,t,n){return(1-n)*e+n*t}function rh(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function ih(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const oh={DEG2RAD:Kl,RAD2DEG:Ql,generateUUID:Jl,clamp:eh,euclideanModulo:th,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:nh,damp:function(e,t,n,r){return nh(e,t,1-Math.exp(-n*r))},pingpong:function(e,t=1){return t-Math.abs(th(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(Yl=e);let t=Yl+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*Kl},radToDeg:function(e){return e*Ql},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,i){const o=Math.cos,s=Math.sin,a=o(n/2),u=s(n/2),c=o((t+r)/2),l=s((t+r)/2),h=o((t-r)/2),d=s((t-r)/2),f=o((r-t)/2),p=s((r-t)/2);switch(i){case"XYX":e.set(a*l,u*h,u*d,a*c);break;case"YZY":e.set(u*d,a*l,u*h,a*c);break;case"ZXZ":e.set(u*h,u*d,a*l,a*c);break;case"XZX":e.set(a*l,u*p,u*f,a*c);break;case"YXY":e.set(u*f,a*l,u*p,a*c);break;case"ZYZ":e.set(u*p,u*f,a*l,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},normalize:ih,denormalize:rh};class sh{constructor(e=0,t=0){sh.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(eh(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*n-o*r+e.x,this.y=i*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ah{constructor(e,t,n,r,i,o,s,a,u){ah.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,o,s,a,u)}set(e,t,n,r,i,o,s,a,u){const c=this.elements;return c[0]=e,c[1]=r,c[2]=s,c[3]=t,c[4]=i,c[5]=a,c[6]=n,c[7]=o,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,o=n[0],s=n[3],a=n[6],u=n[1],c=n[4],l=n[7],h=n[2],d=n[5],f=n[8],p=r[0],m=r[3],g=r[6],v=r[1],y=r[4],b=r[7],_=r[2],x=r[5],w=r[8];return i[0]=o*p+s*v+a*_,i[3]=o*m+s*y+a*x,i[6]=o*g+s*b+a*w,i[1]=u*p+c*v+l*_,i[4]=u*m+c*y+l*x,i[7]=u*g+c*b+l*w,i[2]=h*p+d*v+f*_,i[5]=h*m+d*y+f*x,i[8]=h*g+d*b+f*w,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],u=e[7],c=e[8];return t*o*c-t*s*u-n*i*c+n*s*a+r*i*u-r*o*a}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],u=e[7],c=e[8],l=c*o-s*u,h=s*a-c*i,d=u*i-o*a,f=t*l+n*h+r*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);const p=1/f;return e[0]=l*p,e[1]=(r*u-c*n)*p,e[2]=(s*n-r*o)*p,e[3]=h*p,e[4]=(c*t-r*a)*p,e[5]=(r*i-s*t)*p,e[6]=d*p,e[7]=(n*a-u*t)*p,e[8]=(o*t-n*i)*p,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,o,s){const a=Math.cos(i),u=Math.sin(i);return this.set(n*a,n*u,-n*(a*o+u*s)+o+e,-r*u,r*a,-r*(-u*o+a*s)+s+t,0,0,1),this}scale(e,t){return this.premultiply(uh.makeScale(e,t)),this}rotate(e){return this.premultiply(uh.makeRotation(-e)),this}translate(e,t){return this.premultiply(uh.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let e=0;e<9;e++)if(t[e]!==n[e])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const uh=new ah;Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function ch(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}const lh={};const hh={enabled:!0,workingColorSpace:zl,spaces:{},convert:function(e,t,n){return!1!==this.enabled&&t!==n&&t&&n?(this.spaces[t].transfer===Vl&&(e.r=dh(e.r),e.g=dh(e.g),e.b=dh(e.b)),this.spaces[t].primaries!==this.spaces[n].primaries&&(e.applyMatrix3(this.spaces[t].toXYZ),e.applyMatrix3(this.spaces[n].fromXYZ)),this.spaces[n].transfer===Vl&&(e.r=fh(e.r),e.g=fh(e.g),e.b=fh(e.b)),e):e},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)},getPrimaries:function(e){return this.spaces[e].primaries},getTransfer:function(e){return e===Fl?jl:this.spaces[e].transfer},getLuminanceCoefficients:function(e,t=this.workingColorSpace){return e.fromArray(this.spaces[t].luminanceCoefficients)},define:function(e){Object.assign(this.spaces,e)},_getMatrix:function(e,t,n){return e.copy(this.spaces[t].toXYZ).multiply(this.spaces[n].fromXYZ)},_getDrawingBufferColorSpace:function(e){return this.spaces[e].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(e=this.workingColorSpace){return this.spaces[e].workingColorSpaceConfig.unpackColorSpace}};function dh(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function fh(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}const ph=[.64,.33,.3,.6,.15,.06],mh=[.2126,.7152,.0722],gh=[.3127,.329],vh=(new ah).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),yh=(new ah).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);let bh;hh.define({[zl]:{primaries:ph,whitePoint:gh,transfer:jl,toXYZ:vh,fromXYZ:yh,luminanceCoefficients:mh,workingColorSpaceConfig:{unpackColorSpace:Bl},outputColorSpaceConfig:{drawingBufferColorSpace:Bl}},[Bl]:{primaries:ph,whitePoint:gh,transfer:Vl,toXYZ:vh,fromXYZ:yh,luminanceCoefficients:mh,outputColorSpaceConfig:{drawingBufferColorSpace:Bl}}});class _h{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===bh&&(bh=ch("canvas")),bh.width=e.width,bh.height=e.height;const n=bh.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=bh}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=ch("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let e=0;e<i.length;e++)i[e]=255*dh(i[e]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*dh(t[e]/255)):t[e]=dh(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let xh=0;class wh{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:xh++}),this.uuid=Jl(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)r[t].isDataTexture?e.push(Sh(r[t].image)):e.push(Sh(r[t]))}else e=Sh(r);n.url=e}return t||(e.images[this.uuid]=n),n}}function Sh(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?_h.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Eh=0;class Th extends Zl{constructor(e=Th.DEFAULT_IMAGE,t=Th.DEFAULT_MAPPING,n=1001,r=1001,i=1006,o=1008,s=1023,a=1009,u=Th.DEFAULT_ANISOTROPY,c=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Eh++}),this.uuid=Jl(),this.name="",this.source=new wh(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=o,this.anisotropy=u,this.format=s,this.internalFormat=null,this.type=a,this.offset=new sh(0,0),this.repeat=new sh(1,1),this.center=new sh(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ah,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Nc)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Fc:e.x=e.x-Math.floor(e.x);break;case Bc:e.x=e.x<0?0:1;break;case zc:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case Fc:e.y=e.y-Math.floor(e.y);break;case Bc:e.y=e.y<0?0:1;break;case zc:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}Th.DEFAULT_IMAGE=null,Th.DEFAULT_MAPPING=Nc,Th.DEFAULT_ANISOTROPY=1;class Mh{constructor(e=0,t=0,n=0,r=1){Mh.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*i,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const o=.01,s=.1,a=e.elements,u=a[0],c=a[4],l=a[8],h=a[1],d=a[5],f=a[9],p=a[2],m=a[6],g=a[10];if(Math.abs(c-h)<o&&Math.abs(l-p)<o&&Math.abs(f-m)<o){if(Math.abs(c+h)<s&&Math.abs(l+p)<s&&Math.abs(f+m)<s&&Math.abs(u+d+g-3)<s)return this.set(1,0,0,0),this;t=Math.PI;const e=(u+1)/2,a=(d+1)/2,v=(g+1)/2,y=(c+h)/4,b=(l+p)/4,_=(f+m)/4;return e>a&&e>v?e<o?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(e),r=y/n,i=b/n):a>v?a<o?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(a),n=y/r,i=_/r):v<o?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(v),n=b/i,r=_/i),this.set(n,r,i,t),this}let v=Math.sqrt((m-f)*(m-f)+(l-p)*(l-p)+(h-c)*(h-c));return Math.abs(v)<.001&&(v=1),this.x=(m-f)/v,this.y=(l-p)/v,this.z=(h-c)/v,this.w=Math.acos((u+d+g-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Ah extends Zl{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Mh(0,0,e,t),this.scissorTest=!1,this.viewport=new Mh(0,0,e,t);const r={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Hc,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const i=new Th(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);i.flipY=!1,i.generateMipmaps=n.generateMipmaps,i.internalFormat=n.internalFormat,this.textures=[];const o=n.count;for(let e=0;e<o;e++)this.textures[e]=i.clone(),this.textures[e].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.textures.length;r<i;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++)this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new wh(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ch extends Ah{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class Oh extends Th{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=jc,this.minFilter=jc,this.wrapR=Bc,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Ph{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,o,s){let a=n[r+0],u=n[r+1],c=n[r+2],l=n[r+3];const h=i[o+0],d=i[o+1],f=i[o+2],p=i[o+3];if(0===s)return e[t+0]=a,e[t+1]=u,e[t+2]=c,void(e[t+3]=l);if(1===s)return e[t+0]=h,e[t+1]=d,e[t+2]=f,void(e[t+3]=p);if(l!==p||a!==h||u!==d||c!==f){let e=1-s;const t=a*h+u*d+c*f+l*p,n=t>=0?1:-1,r=1-t*t;if(r>Number.EPSILON){const i=Math.sqrt(r),o=Math.atan2(i,t*n);e=Math.sin(e*o)/i,s=Math.sin(s*o)/i}const i=s*n;if(a=a*e+h*i,u=u*e+d*i,c=c*e+f*i,l=l*e+p*i,e===1-s){const e=1/Math.sqrt(a*a+u*u+c*c+l*l);a*=e,u*=e,c*=e,l*=e}}e[t]=a,e[t+1]=u,e[t+2]=c,e[t+3]=l}static multiplyQuaternionsFlat(e,t,n,r,i,o){const s=n[r],a=n[r+1],u=n[r+2],c=n[r+3],l=i[o],h=i[o+1],d=i[o+2],f=i[o+3];return e[t]=s*f+c*l+a*d-u*h,e[t+1]=a*f+c*h+u*l-s*d,e[t+2]=u*f+c*d+s*h-a*l,e[t+3]=c*f-s*l-a*h-u*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,i=e._z,o=e._order,s=Math.cos,a=Math.sin,u=s(n/2),c=s(r/2),l=s(i/2),h=a(n/2),d=a(r/2),f=a(i/2);switch(o){case"XYZ":this._x=h*c*l+u*d*f,this._y=u*d*l-h*c*f,this._z=u*c*f+h*d*l,this._w=u*c*l-h*d*f;break;case"YXZ":this._x=h*c*l+u*d*f,this._y=u*d*l-h*c*f,this._z=u*c*f-h*d*l,this._w=u*c*l+h*d*f;break;case"ZXY":this._x=h*c*l-u*d*f,this._y=u*d*l+h*c*f,this._z=u*c*f+h*d*l,this._w=u*c*l-h*d*f;break;case"ZYX":this._x=h*c*l-u*d*f,this._y=u*d*l+h*c*f,this._z=u*c*f-h*d*l,this._w=u*c*l+h*d*f;break;case"YZX":this._x=h*c*l+u*d*f,this._y=u*d*l+h*c*f,this._z=u*c*f-h*d*l,this._w=u*c*l-h*d*f;break;case"XZY":this._x=h*c*l-u*d*f,this._y=u*d*l-h*c*f,this._z=u*c*f+h*d*l,this._w=u*c*l+h*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],o=t[1],s=t[5],a=t[9],u=t[2],c=t[6],l=t[10],h=n+s+l;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-a)*e,this._y=(i-u)*e,this._z=(o-r)*e}else if(n>s&&n>l){const e=2*Math.sqrt(1+n-s-l);this._w=(c-a)/e,this._x=.25*e,this._y=(r+o)/e,this._z=(i+u)/e}else if(s>l){const e=2*Math.sqrt(1+s-n-l);this._w=(i-u)/e,this._x=(r+o)/e,this._y=.25*e,this._z=(a+c)/e}else{const e=2*Math.sqrt(1+l-n-s);this._w=(o-r)/e,this._x=(i+u)/e,this._y=(a+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(eh(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,o=e._w,s=t._x,a=t._y,u=t._z,c=t._w;return this._x=n*c+o*s+r*u-i*a,this._y=r*c+o*a+i*s-n*u,this._z=i*c+o*u+n*a-r*s,this._w=o*c-n*s-r*a-i*u,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,i=this._z,o=this._w;let s=o*e._w+n*e._x+r*e._y+i*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;const a=1-s*s;if(a<=Number.EPSILON){const e=1-t;return this._w=e*o+t*this._w,this._x=e*n+t*this._x,this._y=e*r+t*this._y,this._z=e*i+t*this._z,this.normalize(),this}const u=Math.sqrt(a),c=Math.atan2(u,s),l=Math.sin((1-t)*c)/u,h=Math.sin(t*c)/u;return this._w=o*l+this._w*h,this._x=n*l+this._x*h,this._y=r*l+this._y*h,this._z=i*l+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Rh{constructor(e=0,t=0,n=0){Rh.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Ih.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Ih.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,o=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,s=e.z,a=e.w,u=2*(o*r-s*n),c=2*(s*t-i*r),l=2*(i*n-o*t);return this.x=t+a*u+o*l-s*c,this.y=n+a*c+s*u-i*l,this.z=r+a*l+i*c-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,o=t.x,s=t.y,a=t.z;return this.x=r*a-i*s,this.y=i*o-n*a,this.z=n*s-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Nh.copy(this).projectOnVector(e),this.sub(Nh)}reflect(e){return this.sub(Nh.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(eh(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Nh=new Rh,Ih=new Ph;class kh{constructor(e=new Rh(1/0,1/0,1/0),t=new Rh(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Lh.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Lh.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Lh.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n){const r=n.getAttribute("position");if(!0===t&&void 0!==r&&!0!==e.isInstancedMesh)for(let t=0,n=r.count;t<n;t++)!0===e.isMesh?e.getVertexPosition(t,Lh):Lh.fromBufferAttribute(r,t),Lh.applyMatrix4(e.matrixWorld),this.expandByPoint(Lh);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),Uh.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),Uh.copy(n.boundingBox)),Uh.applyMatrix4(e.matrixWorld),this.union(Uh)}const r=e.children;for(let e=0,n=r.length;e<n;e++)this.expandByObject(r[e],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Lh),Lh.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Hh),Wh.subVectors(this.max,Hh),Fh.subVectors(e.a,Hh),Bh.subVectors(e.b,Hh),zh.subVectors(e.c,Hh),jh.subVectors(Bh,Fh),Vh.subVectors(zh,Bh),Gh.subVectors(Fh,zh);let t=[0,-jh.z,jh.y,0,-Vh.z,Vh.y,0,-Gh.z,Gh.y,jh.z,0,-jh.x,Vh.z,0,-Vh.x,Gh.z,0,-Gh.x,-jh.y,jh.x,0,-Vh.y,Vh.x,0,-Gh.y,Gh.x,0];return!!Zh(t,Fh,Bh,zh,Wh)&&(t=[1,0,0,0,1,0,0,0,1],!!Zh(t,Fh,Bh,zh,Wh)&&(qh.crossVectors(jh,Vh),t=[qh.x,qh.y,qh.z],Zh(t,Fh,Bh,zh,Wh)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Lh).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Lh).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Dh[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Dh[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Dh[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Dh[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Dh[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Dh[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Dh[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Dh[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Dh)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Dh=[new Rh,new Rh,new Rh,new Rh,new Rh,new Rh,new Rh,new Rh],Lh=new Rh,Uh=new kh,Fh=new Rh,Bh=new Rh,zh=new Rh,jh=new Rh,Vh=new Rh,Gh=new Rh,Hh=new Rh,Wh=new Rh,qh=new Rh,Xh=new Rh;function Zh(e,t,n,r,i){for(let o=0,s=e.length-3;o<=s;o+=3){Xh.fromArray(e,o);const s=i.x*Math.abs(Xh.x)+i.y*Math.abs(Xh.y)+i.z*Math.abs(Xh.z),a=t.dot(Xh),u=n.dot(Xh),c=r.dot(Xh);if(Math.max(-Math.max(a,u,c),Math.min(a,u,c))>s)return!1}return!0}const $h=new kh,Yh=new Rh,Kh=new Rh;class Qh{constructor(e=new Rh,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):$h.setFromPoints(e).getCenter(n);let r=0;for(let t=0,i=e.length;t<i;t++)r=Math.max(r,n.distanceToSquared(e[t]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Yh.subVectors(e,this.center);const t=Yh.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(Yh,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Kh.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Yh.copy(e.center).add(Kh)),this.expandByPoint(Yh.copy(e.center).sub(Kh))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Jh=new Rh,ed=new Rh,td=new Rh,nd=new Rh,rd=new Rh,id=new Rh,od=new Rh;class sd{constructor(e=new Rh,t=new Rh(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Jh)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Jh.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Jh.copy(this.origin).addScaledVector(this.direction,t),Jh.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){ed.copy(e).add(t).multiplyScalar(.5),td.copy(t).sub(e).normalize(),nd.copy(this.origin).sub(ed);const i=.5*e.distanceTo(t),o=-this.direction.dot(td),s=nd.dot(this.direction),a=-nd.dot(td),u=nd.lengthSq(),c=Math.abs(1-o*o);let l,h,d,f;if(c>0)if(l=o*a-s,h=o*s-a,f=i*c,l>=0)if(h>=-f)if(h<=f){const e=1/c;l*=e,h*=e,d=l*(l+o*h+2*s)+h*(o*l+h+2*a)+u}else h=i,l=Math.max(0,-(o*h+s)),d=-l*l+h*(h+2*a)+u;else h=-i,l=Math.max(0,-(o*h+s)),d=-l*l+h*(h+2*a)+u;else h<=-f?(l=Math.max(0,-(-o*i+s)),h=l>0?-i:Math.min(Math.max(-i,-a),i),d=-l*l+h*(h+2*a)+u):h<=f?(l=0,h=Math.min(Math.max(-i,-a),i),d=h*(h+2*a)+u):(l=Math.max(0,-(o*i+s)),h=l>0?i:Math.min(Math.max(-i,-a),i),d=-l*l+h*(h+2*a)+u);else h=o>0?-i:i,l=Math.max(0,-(o*h+s)),d=-l*l+h*(h+2*a)+u;return n&&n.copy(this.origin).addScaledVector(this.direction,l),r&&r.copy(ed).addScaledVector(td,h),d}intersectSphere(e,t){Jh.subVectors(e.center,this.origin);const n=Jh.dot(this.direction),r=Jh.dot(Jh)-n*n,i=e.radius*e.radius;if(r>i)return null;const o=Math.sqrt(i-r),s=n-o,a=n+o;return a<0?null:s<0?this.at(a,t):this.at(s,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,o,s,a;const u=1/this.direction.x,c=1/this.direction.y,l=1/this.direction.z,h=this.origin;return u>=0?(n=(e.min.x-h.x)*u,r=(e.max.x-h.x)*u):(n=(e.max.x-h.x)*u,r=(e.min.x-h.x)*u),c>=0?(i=(e.min.y-h.y)*c,o=(e.max.y-h.y)*c):(i=(e.max.y-h.y)*c,o=(e.min.y-h.y)*c),n>o||i>r?null:((i>n||isNaN(n))&&(n=i),(o<r||isNaN(r))&&(r=o),l>=0?(s=(e.min.z-h.z)*l,a=(e.max.z-h.z)*l):(s=(e.max.z-h.z)*l,a=(e.min.z-h.z)*l),n>a||s>r?null:((s>n||n!=n)&&(n=s),(a<r||r!=r)&&(r=a),r<0?null:this.at(n>=0?n:r,t)))}intersectsBox(e){return null!==this.intersectBox(e,Jh)}intersectTriangle(e,t,n,r,i){rd.subVectors(t,e),id.subVectors(n,e),od.crossVectors(rd,id);let o,s=this.direction.dot(od);if(s>0){if(r)return null;o=1}else{if(!(s<0))return null;o=-1,s=-s}nd.subVectors(this.origin,e);const a=o*this.direction.dot(id.crossVectors(nd,id));if(a<0)return null;const u=o*this.direction.dot(rd.cross(nd));if(u<0)return null;if(a+u>s)return null;const c=-o*nd.dot(od);return c<0?null:this.at(c/s,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class ad{constructor(e,t,n,r,i,o,s,a,u,c,l,h,d,f,p,m){ad.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,o,s,a,u,c,l,h,d,f,p,m)}set(e,t,n,r,i,o,s,a,u,c,l,h,d,f,p,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=s,g[13]=a,g[2]=u,g[6]=c,g[10]=l,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new ad).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/ud.setFromMatrixColumn(e,0).length(),i=1/ud.setFromMatrixColumn(e,1).length(),o=1/ud.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,o=Math.cos(n),s=Math.sin(n),a=Math.cos(r),u=Math.sin(r),c=Math.cos(i),l=Math.sin(i);if("XYZ"===e.order){const e=o*c,n=o*l,r=s*c,i=s*l;t[0]=a*c,t[4]=-a*l,t[8]=u,t[1]=n+r*u,t[5]=e-i*u,t[9]=-s*a,t[2]=i-e*u,t[6]=r+n*u,t[10]=o*a}else if("YXZ"===e.order){const e=a*c,n=a*l,r=u*c,i=u*l;t[0]=e+i*s,t[4]=r*s-n,t[8]=o*u,t[1]=o*l,t[5]=o*c,t[9]=-s,t[2]=n*s-r,t[6]=i+e*s,t[10]=o*a}else if("ZXY"===e.order){const e=a*c,n=a*l,r=u*c,i=u*l;t[0]=e-i*s,t[4]=-o*l,t[8]=r+n*s,t[1]=n+r*s,t[5]=o*c,t[9]=i-e*s,t[2]=-o*u,t[6]=s,t[10]=o*a}else if("ZYX"===e.order){const e=o*c,n=o*l,r=s*c,i=s*l;t[0]=a*c,t[4]=r*u-n,t[8]=e*u+i,t[1]=a*l,t[5]=i*u+e,t[9]=n*u-r,t[2]=-u,t[6]=s*a,t[10]=o*a}else if("YZX"===e.order){const e=o*a,n=o*u,r=s*a,i=s*u;t[0]=a*c,t[4]=i-e*l,t[8]=r*l+n,t[1]=l,t[5]=o*c,t[9]=-s*c,t[2]=-u*c,t[6]=n*l+r,t[10]=e-i*l}else if("XZY"===e.order){const e=o*a,n=o*u,r=s*a,i=s*u;t[0]=a*c,t[4]=-l,t[8]=u*c,t[1]=e*l+i,t[5]=o*c,t[9]=n*l-r,t[2]=r*l-n,t[6]=s*c,t[10]=i*l+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(ld,e,hd)}lookAt(e,t,n){const r=this.elements;return pd.subVectors(e,t),0===pd.lengthSq()&&(pd.z=1),pd.normalize(),dd.crossVectors(n,pd),0===dd.lengthSq()&&(1===Math.abs(n.z)?pd.x+=1e-4:pd.z+=1e-4,pd.normalize(),dd.crossVectors(n,pd)),dd.normalize(),fd.crossVectors(pd,dd),r[0]=dd.x,r[4]=fd.x,r[8]=pd.x,r[1]=dd.y,r[5]=fd.y,r[9]=pd.y,r[2]=dd.z,r[6]=fd.z,r[10]=pd.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,o=n[0],s=n[4],a=n[8],u=n[12],c=n[1],l=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],b=n[11],_=n[15],x=r[0],w=r[4],S=r[8],E=r[12],T=r[1],M=r[5],A=r[9],C=r[13],O=r[2],P=r[6],R=r[10],N=r[14],I=r[3],k=r[7],D=r[11],L=r[15];return i[0]=o*x+s*T+a*O+u*I,i[4]=o*w+s*M+a*P+u*k,i[8]=o*S+s*A+a*R+u*D,i[12]=o*E+s*C+a*N+u*L,i[1]=c*x+l*T+h*O+d*I,i[5]=c*w+l*M+h*P+d*k,i[9]=c*S+l*A+h*R+d*D,i[13]=c*E+l*C+h*N+d*L,i[2]=f*x+p*T+m*O+g*I,i[6]=f*w+p*M+m*P+g*k,i[10]=f*S+p*A+m*R+g*D,i[14]=f*E+p*C+m*N+g*L,i[3]=v*x+y*T+b*O+_*I,i[7]=v*w+y*M+b*P+_*k,i[11]=v*S+y*A+b*R+_*D,i[15]=v*E+y*C+b*N+_*L,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],o=e[1],s=e[5],a=e[9],u=e[13],c=e[2],l=e[6],h=e[10],d=e[14];return e[3]*(+i*a*l-r*u*l-i*s*h+n*u*h+r*s*d-n*a*d)+e[7]*(+t*a*d-t*u*h+i*o*h-r*o*d+r*u*c-i*a*c)+e[11]*(+t*u*l-t*s*d-i*o*l+n*o*d+i*s*c-n*u*c)+e[15]*(-r*s*c-t*a*l+t*s*h+r*o*l-n*o*h+n*a*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],u=e[7],c=e[8],l=e[9],h=e[10],d=e[11],f=e[12],p=e[13],m=e[14],g=e[15],v=l*m*u-p*h*u+p*a*d-s*m*d-l*a*g+s*h*g,y=f*h*u-c*m*u-f*a*d+o*m*d+c*a*g-o*h*g,b=c*p*u-f*l*u+f*s*d-o*p*d-c*s*g+o*l*g,_=f*l*a-c*p*a-f*s*h+o*p*h+c*s*m-o*l*m,x=t*v+n*y+r*b+i*_;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/x;return e[0]=v*w,e[1]=(p*h*i-l*m*i-p*r*d+n*m*d+l*r*g-n*h*g)*w,e[2]=(s*m*i-p*a*i+p*r*u-n*m*u-s*r*g+n*a*g)*w,e[3]=(l*a*i-s*h*i-l*r*u+n*h*u+s*r*d-n*a*d)*w,e[4]=y*w,e[5]=(c*m*i-f*h*i+f*r*d-t*m*d-c*r*g+t*h*g)*w,e[6]=(f*a*i-o*m*i-f*r*u+t*m*u+o*r*g-t*a*g)*w,e[7]=(o*h*i-c*a*i+c*r*u-t*h*u-o*r*d+t*a*d)*w,e[8]=b*w,e[9]=(f*l*i-c*p*i-f*n*d+t*p*d+c*n*g-t*l*g)*w,e[10]=(o*p*i-f*s*i+f*n*u-t*p*u-o*n*g+t*s*g)*w,e[11]=(c*s*i-o*l*i-c*n*u+t*l*u+o*n*d-t*s*d)*w,e[12]=_*w,e[13]=(c*p*r-f*l*r+f*n*h-t*p*h-c*n*m+t*l*m)*w,e[14]=(f*s*r-o*p*r-f*n*a+t*p*a+o*n*m-t*s*m)*w,e[15]=(o*l*r-c*s*r+c*n*a-t*l*a-o*n*h+t*s*h)*w,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,o=e.x,s=e.y,a=e.z,u=i*o,c=i*s;return this.set(u*o+n,u*s-r*a,u*a+r*s,0,u*s+r*a,c*s+n,c*a-r*o,0,u*a-r*s,c*a+r*o,i*a*a+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,o){return this.set(1,n,i,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,o=t._y,s=t._z,a=t._w,u=i+i,c=o+o,l=s+s,h=i*u,d=i*c,f=i*l,p=o*c,m=o*l,g=s*l,v=a*u,y=a*c,b=a*l,_=n.x,x=n.y,w=n.z;return r[0]=(1-(p+g))*_,r[1]=(d+b)*_,r[2]=(f-y)*_,r[3]=0,r[4]=(d-b)*x,r[5]=(1-(h+g))*x,r[6]=(m+v)*x,r[7]=0,r[8]=(f+y)*w,r[9]=(m-v)*w,r[10]=(1-(h+p))*w,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let i=ud.set(r[0],r[1],r[2]).length();const o=ud.set(r[4],r[5],r[6]).length(),s=ud.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],cd.copy(this);const a=1/i,u=1/o,c=1/s;return cd.elements[0]*=a,cd.elements[1]*=a,cd.elements[2]*=a,cd.elements[4]*=u,cd.elements[5]*=u,cd.elements[6]*=u,cd.elements[8]*=c,cd.elements[9]*=c,cd.elements[10]*=c,t.setFromRotationMatrix(cd),n.x=i,n.y=o,n.z=s,this}makePerspective(e,t,n,r,i,o,s=2e3){const a=this.elements,u=2*i/(t-e),c=2*i/(n-r),l=(t+e)/(t-e),h=(n+r)/(n-r);let d,f;if(s===ql)d=-(o+i)/(o-i),f=-2*o*i/(o-i);else{if(s!==Xl)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);d=-o/(o-i),f=-o*i/(o-i)}return a[0]=u,a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=c,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,r,i,o,s=2e3){const a=this.elements,u=1/(t-e),c=1/(n-r),l=1/(o-i),h=(t+e)*u,d=(n+r)*c;let f,p;if(s===ql)f=(o+i)*l,p=-2*l;else{if(s!==Xl)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);f=i*l,p=-1*l}return a[0]=2*u,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=p,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let e=0;e<16;e++)if(t[e]!==n[e])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const ud=new Rh,cd=new ad,ld=new Rh(0,0,0),hd=new Rh(1,1,1),dd=new Rh,fd=new Rh,pd=new Rh,md=new ad,gd=new Ph;class vd{constructor(e=0,t=0,n=0,r=vd.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,i=r[0],o=r[4],s=r[8],a=r[1],u=r[5],c=r[9],l=r[2],h=r[6],d=r[10];switch(t){case"XYZ":this._y=Math.asin(eh(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(h,u),this._z=0);break;case"YXZ":this._x=Math.asin(-eh(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,d),this._z=Math.atan2(a,u)):(this._y=Math.atan2(-l,i),this._z=0);break;case"ZXY":this._x=Math.asin(eh(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-l,d),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(a,i));break;case"ZYX":this._y=Math.asin(-eh(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,i)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(eh(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-l,i)):(this._x=0,this._y=Math.atan2(s,d));break;case"XZY":this._z=Math.asin(-eh(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,u),this._y=Math.atan2(s,i)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return md.makeRotationFromQuaternion(e),this.setFromRotationMatrix(md,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return gd.setFromEuler(this),this.setFromQuaternion(gd,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}vd.DEFAULT_ORDER="XYZ";class yd{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let bd=0;const _d=new Rh,xd=new Ph,wd=new ad,Sd=new Rh,Ed=new Rh,Td=new Rh,Md=new Ph,Ad=new Rh(1,0,0),Cd=new Rh(0,1,0),Od=new Rh(0,0,1),Pd={type:"added"},Rd={type:"removed"},Nd={type:"childadded",child:null},Id={type:"childremoved",child:null};class kd extends Zl{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:bd++}),this.uuid=Jl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=kd.DEFAULT_UP.clone();const e=new Rh,t=new vd,n=new Ph,r=new Rh(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ad},normalMatrix:{value:new ah}}),this.matrix=new ad,this.matrixWorld=new ad,this.matrixAutoUpdate=kd.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=kd.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new yd,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return xd.setFromAxisAngle(e,t),this.quaternion.multiply(xd),this}rotateOnWorldAxis(e,t){return xd.setFromAxisAngle(e,t),this.quaternion.premultiply(xd),this}rotateX(e){return this.rotateOnAxis(Ad,e)}rotateY(e){return this.rotateOnAxis(Cd,e)}rotateZ(e){return this.rotateOnAxis(Od,e)}translateOnAxis(e,t){return _d.copy(e).applyQuaternion(this.quaternion),this.position.add(_d.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Ad,e)}translateY(e){return this.translateOnAxis(Cd,e)}translateZ(e){return this.translateOnAxis(Od,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(wd.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Sd.copy(e):Sd.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Ed.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?wd.lookAt(Ed,Sd,this.up):wd.lookAt(Sd,Ed,this.up),this.quaternion.setFromRotationMatrix(wd),r&&(wd.extractRotation(r.matrixWorld),xd.setFromRotationMatrix(wd),this.quaternion.premultiply(xd.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Pd),Nd.child=e,this.dispatchEvent(Nd),Nd.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Rd),Id.child=e,this.dispatchEvent(Id),Id.child=null),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),wd.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),wd.multiply(e.parent.matrixWorld)),e.applyMatrix4(wd),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Pd),Nd.child=e,this.dispatchEvent(Nd),Nd.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let i=0,o=r.length;i<o;i++)r[i].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ed,e,Td),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ed,Md,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++){t[n].updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++){e[t].updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map((e=>({boxInitialized:e.boxInitialized,boxMin:e.box.min.toArray(),boxMax:e.box.max.toArray(),sphereInitialized:e.sphereInitialized,sphereRadius:e.sphere.radius,sphereCenter:e.sphere.center.toArray()}))),r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),null!==this._colorsTexture&&(r.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),null!==this.boundingBox&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const r=n[t];i(e.shapes,r)}else i(e.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,r=this.material.length;n<r;n++)t.push(i(e.materials,this.material[n]));r.material=t}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let t=0;t<this.children.length;t++)r.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];r.animations.push(i(e.animations,n))}}if(t){const t=o(e.geometries),r=o(e.materials),i=o(e.textures),s=o(e.images),a=o(e.shapes),u=o(e.skeletons),c=o(e.animations),l=o(e.nodes);t.length>0&&(n.geometries=t),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),s.length>0&&(n.images=s),a.length>0&&(n.shapes=a),u.length>0&&(n.skeletons=u),c.length>0&&(n.animations=c),l.length>0&&(n.nodes=l)}return n.object=r,n;function o(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){const n=e.children[t];this.add(n.clone())}return this}}kd.DEFAULT_UP=new Rh(0,1,0),kd.DEFAULT_MATRIX_AUTO_UPDATE=!0,kd.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Dd=new Rh,Ld=new Rh,Ud=new Rh,Fd=new Rh,Bd=new Rh,zd=new Rh,jd=new Rh,Vd=new Rh,Gd=new Rh,Hd=new Rh,Wd=new Mh,qd=new Mh,Xd=new Mh;class Zd{constructor(e=new Rh,t=new Rh,n=new Rh){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Dd.subVectors(e,t),r.cross(Dd);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){Dd.subVectors(r,t),Ld.subVectors(n,t),Ud.subVectors(e,t);const o=Dd.dot(Dd),s=Dd.dot(Ld),a=Dd.dot(Ud),u=Ld.dot(Ld),c=Ld.dot(Ud),l=o*u-s*s;if(0===l)return i.set(0,0,0),null;const h=1/l,d=(u*a-s*c)*h,f=(o*c-s*a)*h;return i.set(1-d-f,f,d)}static containsPoint(e,t,n,r){return null!==this.getBarycoord(e,t,n,r,Fd)&&(Fd.x>=0&&Fd.y>=0&&Fd.x+Fd.y<=1)}static getInterpolation(e,t,n,r,i,o,s,a){return null===this.getBarycoord(e,t,n,r,Fd)?(a.x=0,a.y=0,"z"in a&&(a.z=0),"w"in a&&(a.w=0),null):(a.setScalar(0),a.addScaledVector(i,Fd.x),a.addScaledVector(o,Fd.y),a.addScaledVector(s,Fd.z),a)}static getInterpolatedAttribute(e,t,n,r,i,o){return Wd.setScalar(0),qd.setScalar(0),Xd.setScalar(0),Wd.fromBufferAttribute(e,t),qd.fromBufferAttribute(e,n),Xd.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(Wd,i.x),o.addScaledVector(qd,i.y),o.addScaledVector(Xd,i.z),o}static isFrontFacing(e,t,n,r){return Dd.subVectors(n,t),Ld.subVectors(e,t),Dd.cross(Ld).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Dd.subVectors(this.c,this.b),Ld.subVectors(this.a,this.b),.5*Dd.cross(Ld).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Zd.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Zd.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,i){return Zd.getInterpolation(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return Zd.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Zd.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let o,s;Bd.subVectors(r,n),zd.subVectors(i,n),Vd.subVectors(e,n);const a=Bd.dot(Vd),u=zd.dot(Vd);if(a<=0&&u<=0)return t.copy(n);Gd.subVectors(e,r);const c=Bd.dot(Gd),l=zd.dot(Gd);if(c>=0&&l<=c)return t.copy(r);const h=a*l-c*u;if(h<=0&&a>=0&&c<=0)return o=a/(a-c),t.copy(n).addScaledVector(Bd,o);Hd.subVectors(e,i);const d=Bd.dot(Hd),f=zd.dot(Hd);if(f>=0&&d<=f)return t.copy(i);const p=d*u-a*f;if(p<=0&&u>=0&&f<=0)return s=u/(u-f),t.copy(n).addScaledVector(zd,s);const m=c*f-d*l;if(m<=0&&l-c>=0&&d-f>=0)return jd.subVectors(i,r),s=(l-c)/(l-c+(d-f)),t.copy(r).addScaledVector(jd,s);const g=1/(m+p+h);return o=p*g,s=h*g,t.copy(n).addScaledVector(Bd,o).addScaledVector(zd,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const $d={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Yd={h:0,s:0,l:0},Kd={h:0,s:0,l:0};function Qd(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class Jd{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Bl){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,hh.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=hh.workingColorSpace){return this.r=e,this.g=t,this.b=n,hh.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=hh.workingColorSpace){if(e=th(e,1),t=eh(t,0,1),n=eh(n,0,1),0===t)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=Qd(i,r,e+1/3),this.g=Qd(i,r,e),this.b=Qd(i,r,e-1/3)}return hh.toWorkingColorSpace(this,r),this}setStyle(e,t=Bl){function n(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const o=r[1],s=r[2];switch(o){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,t);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,t);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const n=r[1],i=n.length;if(3===i)return this.setRGB(parseInt(n.charAt(0),16)/15,parseInt(n.charAt(1),16)/15,parseInt(n.charAt(2),16)/15,t);if(6===i)return this.setHex(parseInt(n,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Bl){const n=$d[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=dh(e.r),this.g=dh(e.g),this.b=dh(e.b),this}copyLinearToSRGB(e){return this.r=fh(e.r),this.g=fh(e.g),this.b=fh(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Bl){return hh.fromWorkingColorSpace(ef.copy(this),e),65536*Math.round(eh(255*ef.r,0,255))+256*Math.round(eh(255*ef.g,0,255))+Math.round(eh(255*ef.b,0,255))}getHexString(e=Bl){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=hh.workingColorSpace){hh.fromWorkingColorSpace(ef.copy(this),t);const n=ef.r,r=ef.g,i=ef.b,o=Math.max(n,r,i),s=Math.min(n,r,i);let a,u;const c=(s+o)/2;if(s===o)a=0,u=0;else{const e=o-s;switch(u=c<=.5?e/(o+s):e/(2-o-s),o){case n:a=(r-i)/e+(r<i?6:0);break;case r:a=(i-n)/e+2;break;case i:a=(n-r)/e+4}a/=6}return e.h=a,e.s=u,e.l=c,e}getRGB(e,t=hh.workingColorSpace){return hh.fromWorkingColorSpace(ef.copy(this),t),e.r=ef.r,e.g=ef.g,e.b=ef.b,e}getStyle(e=Bl){hh.fromWorkingColorSpace(ef.copy(this),e);const t=ef.r,n=ef.g,r=ef.b;return e!==Bl?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*n)},${Math.round(255*r)})`}offsetHSL(e,t,n){return this.getHSL(Yd),this.setHSL(Yd.h+e,Yd.s+t,Yd.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Yd),e.getHSL(Kd);const n=nh(Yd.h,Kd.h,t),r=nh(Yd.s,Kd.s,t),i=nh(Yd.l,Kd.l,t);return this.setHSL(n,r,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ef=new Jd;Jd.NAMES=$d;let tf=0;class nf extends Zl{static get type(){return"Material"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:tf++}),this.uuid=Jl(),this.name="",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Pc,this.blendDst=Rc,this.blendEquation=Oc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Jd(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Gl,this.stencilZFail=Gl,this.stencilZPass=Gl,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`)}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),this.blendSrc!==Pc&&(n.blendSrc=this.blendSrc),this.blendDst!==Rc&&(n.blendDst=this.blendDst),this.blendEquation!==Oc&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Gl&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Gl&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Gl&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const t=r(e.textures),i=r(e.images);t.length>0&&(n.textures=t),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let r=0;r!==e;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class rf extends nf{static get type(){return"MeshBasicMaterial"}constructor(e){super(),this.isMeshBasicMaterial=!0,this.color=new Jd(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new vd,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const of=sf();function sf(){const e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),r=new Uint32Array(512),i=new Uint32Array(512);for(let e=0;e<256;++e){const t=e-127;t<-27?(r[e]=0,r[256|e]=32768,i[e]=24,i[256|e]=24):t<-14?(r[e]=1024>>-t-14,r[256|e]=1024>>-t-14|32768,i[e]=-t-1,i[256|e]=-t-1):t<=15?(r[e]=t+15<<10,r[256|e]=t+15<<10|32768,i[e]=13,i[256|e]=13):t<128?(r[e]=31744,r[256|e]=64512,i[e]=24,i[256|e]=24):(r[e]=31744,r[256|e]=64512,i[e]=13,i[256|e]=13)}const o=new Uint32Array(2048),s=new Uint32Array(64),a=new Uint32Array(64);for(let e=1;e<1024;++e){let t=e<<13,n=0;for(;0==(8388608&t);)t<<=1,n-=8388608;t&=-8388609,n+=947912704,o[e]=t|n}for(let e=1024;e<2048;++e)o[e]=939524096+(e-1024<<13);for(let e=1;e<31;++e)s[e]=e<<23;s[31]=1199570944,s[32]=2147483648;for(let e=33;e<63;++e)s[e]=2147483648+(e-32<<23);s[63]=3347054592;for(let e=1;e<64;++e)32!==e&&(a[e]=1024);return{floatView:t,uint32View:n,baseTable:r,shiftTable:i,mantissaTable:o,exponentTable:s,offsetTable:a}}function af(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=eh(e,-65504,65504),of.floatView[0]=e;const t=of.uint32View[0],n=t>>23&511;return of.baseTable[n]+((8388607&t)>>of.shiftTable[n])}function uf(e){const t=e>>10;return of.uint32View[0]=of.mantissaTable[of.offsetTable[t]+(1023&e)]+of.exponentTable[t],of.floatView[0]}const cf=new Rh,lf=new sh;class hf{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=Hl,this.updateRanges=[],this.gpuType=Jc,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)lf.fromBufferAttribute(this,t),lf.applyMatrix3(e),this.setXY(t,lf.x,lf.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)cf.fromBufferAttribute(this,t),cf.applyMatrix3(e),this.setXYZ(t,cf.x,cf.y,cf.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)cf.fromBufferAttribute(this,t),cf.applyMatrix4(e),this.setXYZ(t,cf.x,cf.y,cf.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)cf.fromBufferAttribute(this,t),cf.applyNormalMatrix(e),this.setXYZ(t,cf.x,cf.y,cf.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)cf.fromBufferAttribute(this,t),cf.transformDirection(e),this.setXYZ(t,cf.x,cf.y,cf.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=rh(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=ih(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=rh(t,this.array)),t}setX(e,t){return this.normalized&&(t=ih(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=rh(t,this.array)),t}setY(e,t){return this.normalized&&(t=ih(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=rh(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ih(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=rh(t,this.array)),t}setW(e,t){return this.normalized&&(t=ih(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=ih(t,this.array),n=ih(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=ih(t,this.array),n=ih(n,this.array),r=ih(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=ih(t,this.array),n=ih(n,this.array),r=ih(r,this.array),i=ih(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Hl&&(e.usage=this.usage),e}}class df extends hf{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class ff extends hf{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class pf extends hf{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=uf(this.array[e*this.itemSize]);return this.normalized&&(t=rh(t,this.array)),t}setX(e,t){return this.normalized&&(t=ih(t,this.array)),this.array[e*this.itemSize]=af(t),this}getY(e){let t=uf(this.array[e*this.itemSize+1]);return this.normalized&&(t=rh(t,this.array)),t}setY(e,t){return this.normalized&&(t=ih(t,this.array)),this.array[e*this.itemSize+1]=af(t),this}getZ(e){let t=uf(this.array[e*this.itemSize+2]);return this.normalized&&(t=rh(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ih(t,this.array)),this.array[e*this.itemSize+2]=af(t),this}getW(e){let t=uf(this.array[e*this.itemSize+3]);return this.normalized&&(t=rh(t,this.array)),t}setW(e,t){return this.normalized&&(t=ih(t,this.array)),this.array[e*this.itemSize+3]=af(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=ih(t,this.array),n=ih(n,this.array)),this.array[e+0]=af(t),this.array[e+1]=af(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=ih(t,this.array),n=ih(n,this.array),r=ih(r,this.array)),this.array[e+0]=af(t),this.array[e+1]=af(n),this.array[e+2]=af(r),this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=ih(t,this.array),n=ih(n,this.array),r=ih(r,this.array),i=ih(i,this.array)),this.array[e+0]=af(t),this.array[e+1]=af(n),this.array[e+2]=af(r),this.array[e+3]=af(i),this}}class mf extends hf{constructor(e,t,n){super(new Float32Array(e),t,n)}}let gf=0;const vf=new ad,yf=new kd,bf=new Rh,_f=new kh,xf=new kh,wf=new Rh;class Sf extends Zl{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:gf++}),this.uuid=Jl(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(function(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}(e)?ff:df)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new ah).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return vf.makeRotationFromQuaternion(e),this.applyMatrix4(vf),this}rotateX(e){return vf.makeRotationX(e),this.applyMatrix4(vf),this}rotateY(e){return vf.makeRotationY(e),this.applyMatrix4(vf),this}rotateZ(e){return vf.makeRotationZ(e),this.applyMatrix4(vf),this}translate(e,t,n){return vf.makeTranslation(e,t,n),this.applyMatrix4(vf),this}scale(e,t,n){return vf.makeScale(e,t,n),this.applyMatrix4(vf),this}lookAt(e){return yf.lookAt(e),yf.updateMatrix(),this.applyMatrix4(yf.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(bf).negate(),this.translate(bf.x,bf.y,bf.z),this}setFromPoints(e){const t=this.getAttribute("position");if(void 0===t){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t.push(r.x,r.y,r.z||0)}this.setAttribute("position",new mf(t,3))}else{for(let n=0,r=t.count;n<r;n++){const r=e[n];t.setXYZ(n,r.x,r.y,r.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new kh);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new Rh(-1/0,-1/0,-1/0),new Rh(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];_f.setFromBufferAttribute(n),this.morphTargetsRelative?(wf.addVectors(this.boundingBox.min,_f.min),this.boundingBox.expandByPoint(wf),wf.addVectors(this.boundingBox.max,_f.max),this.boundingBox.expandByPoint(wf)):(this.boundingBox.expandByPoint(_f.min),this.boundingBox.expandByPoint(_f.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Qh);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new Rh,1/0);if(e){const n=this.boundingSphere.center;if(_f.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];xf.setFromBufferAttribute(n),this.morphTargetsRelative?(wf.addVectors(_f.min,xf.min),_f.expandByPoint(wf),wf.addVectors(_f.max,xf.max),_f.expandByPoint(wf)):(_f.expandByPoint(xf.min),_f.expandByPoint(xf.max))}_f.getCenter(n);let r=0;for(let t=0,i=e.count;t<i;t++)wf.fromBufferAttribute(e,t),r=Math.max(r,n.distanceToSquared(wf));if(t)for(let i=0,o=t.length;i<o;i++){const o=t[i],s=this.morphTargetsRelative;for(let t=0,i=o.count;t<i;t++)wf.fromBufferAttribute(o,t),s&&(bf.fromBufferAttribute(e,t),wf.add(bf)),r=Math.max(r,n.distanceToSquared(wf))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.position,r=t.normal,i=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new hf(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),s=[],a=[];for(let e=0;e<n.count;e++)s[e]=new Rh,a[e]=new Rh;const u=new Rh,c=new Rh,l=new Rh,h=new sh,d=new sh,f=new sh,p=new Rh,m=new Rh;function g(e,t,r){u.fromBufferAttribute(n,e),c.fromBufferAttribute(n,t),l.fromBufferAttribute(n,r),h.fromBufferAttribute(i,e),d.fromBufferAttribute(i,t),f.fromBufferAttribute(i,r),c.sub(u),l.sub(u),d.sub(h),f.sub(h);const o=1/(d.x*f.y-f.x*d.y);isFinite(o)&&(p.copy(c).multiplyScalar(f.y).addScaledVector(l,-d.y).multiplyScalar(o),m.copy(l).multiplyScalar(d.x).addScaledVector(c,-f.x).multiplyScalar(o),s[e].add(p),s[t].add(p),s[r].add(p),a[e].add(m),a[t].add(m),a[r].add(m))}let v=this.groups;0===v.length&&(v=[{start:0,count:e.count}]);for(let t=0,n=v.length;t<n;++t){const n=v[t],r=n.start;for(let t=r,i=r+n.count;t<i;t+=3)g(e.getX(t+0),e.getX(t+1),e.getX(t+2))}const y=new Rh,b=new Rh,_=new Rh,x=new Rh;function w(e){_.fromBufferAttribute(r,e),x.copy(_);const t=s[e];y.copy(t),y.sub(_.multiplyScalar(_.dot(t))).normalize(),b.crossVectors(x,t);const n=b.dot(a[e])<0?-1:1;o.setXYZW(e,y.x,y.y,y.z,n)}for(let t=0,n=v.length;t<n;++t){const n=v[t],r=n.start;for(let t=r,i=r+n.count;t<i;t+=3)w(e.getX(t+0)),w(e.getX(t+1)),w(e.getX(t+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new hf(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const r=new Rh,i=new Rh,o=new Rh,s=new Rh,a=new Rh,u=new Rh,c=new Rh,l=new Rh;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),f=e.getX(h+1),p=e.getX(h+2);r.fromBufferAttribute(t,d),i.fromBufferAttribute(t,f),o.fromBufferAttribute(t,p),c.subVectors(o,i),l.subVectors(r,i),c.cross(l),s.fromBufferAttribute(n,d),a.fromBufferAttribute(n,f),u.fromBufferAttribute(n,p),s.add(c),a.add(c),u.add(c),n.setXYZ(d,s.x,s.y,s.z),n.setXYZ(f,a.x,a.y,a.z),n.setXYZ(p,u.x,u.y,u.z)}else for(let e=0,s=t.count;e<s;e+=3)r.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),o.fromBufferAttribute(t,e+2),c.subVectors(o,i),l.subVectors(r,i),c.cross(l),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)wf.fromBufferAttribute(e,t),wf.normalize(),e.setXYZ(t,wf.x,wf.y,wf.z)}toNonIndexed(){function e(e,t){const n=e.array,r=e.itemSize,i=e.normalized,o=new n.constructor(t.length*r);let s=0,a=0;for(let i=0,u=t.length;i<u;i++){s=e.isInterleavedBufferAttribute?t[i]*e.data.stride+e.offset:t[i]*r;for(let e=0;e<r;e++)o[a++]=n[s++]}return new hf(o,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Sf,n=this.index.array,r=this.attributes;for(const i in r){const o=e(r[i],n);t.setAttribute(i,o)}const i=this.morphAttributes;for(const r in i){const o=[],s=i[r];for(let t=0,r=s.length;t<r;t++){const r=e(s[t],n);o.push(r)}t.morphAttributes[r]=o}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let e=0,n=o.length;e<n;e++){const n=o[e];t.addGroup(n.start,n.count,n.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const t in n){const r=n[t];e.data.attributes[t]=r.toJSON(e.data)}const r={};let i=!1;for(const t in this.morphAttributes){const n=this.morphAttributes[t],o=[];for(let t=0,r=n.length;t<r;t++){const r=n[t];o.push(r.toJSON(e.data))}o.length>0&&(r[t]=o,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const s=this.boundingSphere;return null!==s&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const e in r){const n=r[e];this.setAttribute(e,n.clone(t))}const i=e.morphAttributes;for(const e in i){const n=[],r=i[e];for(let e=0,i=r.length;e<i;e++)n.push(r[e].clone(t));this.morphAttributes[e]=n}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let e=0,t=o.length;e<t;e++){const t=o[e];this.addGroup(t.start,t.count,t.materialIndex)}const s=e.boundingBox;null!==s&&(this.boundingBox=s.clone());const a=e.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Ef=new ad,Tf=new sd,Mf=new Qh,Af=new Rh,Cf=new Rh,Of=new Rh,Pf=new Rh,Rf=new Rh,Nf=new Rh,If=new Rh,kf=new Rh;class Df extends kd{constructor(e=new Sf,t=new rf){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const s=this.morphTargetInfluences;if(i&&s){Nf.set(0,0,0);for(let n=0,r=i.length;n<r;n++){const r=s[n],a=i[n];0!==r&&(Rf.fromBufferAttribute(a,e),o?Nf.addScaledVector(Rf,r):Nf.addScaledVector(Rf.sub(t),r))}t.add(Nf)}return t}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r){if(null===n.boundingSphere&&n.computeBoundingSphere(),Mf.copy(n.boundingSphere),Mf.applyMatrix4(i),Tf.copy(e.ray).recast(e.near),!1===Mf.containsPoint(Tf.origin)){if(null===Tf.intersectSphere(Mf,Af))return;if(Tf.origin.distanceToSquared(Af)>(e.far-e.near)**2)return}Ef.copy(i).invert(),Tf.copy(e.ray).applyMatrix4(Ef),null!==n.boundingBox&&!1===Tf.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,Tf)}}_computeIntersections(e,t,n){let r;const i=this.geometry,o=this.material,s=i.index,a=i.attributes.position,u=i.attributes.uv,c=i.attributes.uv1,l=i.attributes.normal,h=i.groups,d=i.drawRange;if(null!==s)if(Array.isArray(o))for(let i=0,a=h.length;i<a;i++){const a=h[i],f=o[a.materialIndex];for(let i=Math.max(a.start,d.start),o=Math.min(s.count,Math.min(a.start+a.count,d.start+d.count));i<o;i+=3){r=Lf(this,f,e,n,u,c,l,s.getX(i),s.getX(i+1),s.getX(i+2)),r&&(r.faceIndex=Math.floor(i/3),r.face.materialIndex=a.materialIndex,t.push(r))}}else{for(let i=Math.max(0,d.start),a=Math.min(s.count,d.start+d.count);i<a;i+=3){r=Lf(this,o,e,n,u,c,l,s.getX(i),s.getX(i+1),s.getX(i+2)),r&&(r.faceIndex=Math.floor(i/3),t.push(r))}}else if(void 0!==a)if(Array.isArray(o))for(let i=0,s=h.length;i<s;i++){const s=h[i],f=o[s.materialIndex];for(let i=Math.max(s.start,d.start),o=Math.min(a.count,Math.min(s.start+s.count,d.start+d.count));i<o;i+=3){r=Lf(this,f,e,n,u,c,l,i,i+1,i+2),r&&(r.faceIndex=Math.floor(i/3),r.face.materialIndex=s.materialIndex,t.push(r))}}else{for(let i=Math.max(0,d.start),s=Math.min(a.count,d.start+d.count);i<s;i+=3){r=Lf(this,o,e,n,u,c,l,i,i+1,i+2),r&&(r.faceIndex=Math.floor(i/3),t.push(r))}}}}function Lf(e,t,n,r,i,o,s,a,u,c){e.getVertexPosition(a,Cf),e.getVertexPosition(u,Of),e.getVertexPosition(c,Pf);const l=function(e,t,n,r,i,o,s,a){let u;if(u=1===t.side?r.intersectTriangle(s,o,i,!0,a):r.intersectTriangle(i,o,s,0===t.side,a),null===u)return null;kf.copy(a),kf.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(kf);return c<n.near||c>n.far?null:{distance:c,point:kf.clone(),object:e}}(e,t,n,r,Cf,Of,Pf,If);if(l){const e=new Rh;Zd.getBarycoord(If,Cf,Of,Pf,e),i&&(l.uv=Zd.getInterpolatedAttribute(i,a,u,c,e,new sh)),o&&(l.uv1=Zd.getInterpolatedAttribute(o,a,u,c,e,new sh)),s&&(l.normal=Zd.getInterpolatedAttribute(s,a,u,c,e,new Rh),l.normal.dot(r.direction)>0&&l.normal.multiplyScalar(-1));const t={a:a,b:u,c:c,normal:new Rh,materialIndex:0};Zd.getNormal(Cf,Of,Pf,t.normal),l.face=t,l.barycoord=e}return l}class Uf extends Sf{constructor(e=1,t=1,n=1,r=1,i=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};const s=this;r=Math.floor(r),i=Math.floor(i),o=Math.floor(o);const a=[],u=[],c=[],l=[];let h=0,d=0;function f(e,t,n,r,i,o,f,p,m,g,v){const y=o/m,b=f/g,_=o/2,x=f/2,w=p/2,S=m+1,E=g+1;let T=0,M=0;const A=new Rh;for(let o=0;o<E;o++){const s=o*b-x;for(let a=0;a<S;a++){const h=a*y-_;A[e]=h*r,A[t]=s*i,A[n]=w,u.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[n]=p>0?1:-1,c.push(A.x,A.y,A.z),l.push(a/m),l.push(1-o/g),T+=1}}for(let e=0;e<g;e++)for(let t=0;t<m;t++){const n=h+t+S*e,r=h+t+S*(e+1),i=h+(t+1)+S*(e+1),o=h+(t+1)+S*e;a.push(n,r,o),a.push(r,i,o),M+=6}s.addGroup(d,M,v),d+=M,h+=T}f("z","y","x",-1,-1,n,t,e,o,i,0),f("z","y","x",1,-1,n,t,-e,o,i,1),f("x","z","y",1,1,e,n,t,r,o,2),f("x","z","y",1,-1,e,n,-t,r,o,3),f("x","y","z",1,-1,e,t,n,r,i,4),f("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(a),this.setAttribute("position",new mf(u,3)),this.setAttribute("normal",new mf(c,3)),this.setAttribute("uv",new mf(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Uf(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Ff(e){const t={};for(const n in e){t[n]={};for(const r in e[n]){const i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][r]=null):t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}}return t}class Bf extends nf{static get type(){return"ShaderMaterial"}constructor(e){super(),this.isShaderMaterial=!0,this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="\nvoid main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",this.fragmentShader="\nvoid main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}\n",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ff(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const n in this.uniforms){const r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const e in this.extensions)!0===this.extensions[e]&&(n[e]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class zf extends kd{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ad,this.projectionMatrix=new ad,this.projectionMatrixInverse=new ad,this.coordinateSystem=ql}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const jf=new Rh,Vf=new sh,Gf=new sh;class Hf extends zf{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Ql*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Kl*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Ql*Math.atan(Math.tan(.5*Kl*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){jf.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(jf.x,jf.y).multiplyScalar(-e/jf.z),jf.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(jf.x,jf.y).multiplyScalar(-e/jf.z)}getViewSize(e,t){return this.getViewBounds(e,Vf,Gf),t.subVectors(Gf,Vf)}setViewOffset(e,t,n,r,i,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Kl*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const e=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/e,t-=o.offsetY*n/s,r*=o.width/e,n*=o.height/s}const s=this.filmOffset;0!==s&&(i+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Wf=-90;class qf extends kd{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Hf(Wf,1,e,t);r.layers=this.layers,this.add(r);const i=new Hf(Wf,1,e,t);i.layers=this.layers,this.add(i);const o=new Hf(Wf,1,e,t);o.layers=this.layers,this.add(o);const s=new Hf(Wf,1,e,t);s.layers=this.layers,this.add(s);const a=new Hf(Wf,1,e,t);a.layers=this.layers,this.add(a);const u=new Hf(Wf,1,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,i,o,s,a]=t;for(const e of t)this.remove(e);if(e===ql)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),a.up.set(0,1,0),a.lookAt(0,0,-1);else{if(e!==Xl)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),a.up.set(0,-1,0),a.lookAt(0,0,-1)}for(const e of t)this.add(e),e.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[i,o,s,a,u,c]=this.children,l=e.getRenderTarget(),h=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),f=e.xr.enabled;e.xr.enabled=!1;const p=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,i),e.setRenderTarget(n,1,r),e.render(t,o),e.setRenderTarget(n,2,r),e.render(t,s),e.setRenderTarget(n,3,r),e.render(t,a),e.setRenderTarget(n,4,r),e.render(t,u),n.texture.generateMipmaps=p,e.setRenderTarget(n,5,r),e.render(t,c),e.setRenderTarget(l,h,d),e.xr.enabled=f,n.texture.needsPMREMUpdate=!0}}class Xf extends Th{constructor(e,t,n,r,i,o,s,a,u,c){super(e=void 0!==e?e:[],t=void 0!==t?t:Ic,n,r,i,o,s,a,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Zf extends Ch{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new Xf(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Hc}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},r=new Uf(5,5,5),i=new Bf({name:"CubemapFromEquirect",uniforms:Ff(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:1,blending:0});i.uniforms.tEquirect.value=t;const o=new Df(r,i),s=t.minFilter;t.minFilter===qc&&(t.minFilter=Hc);return new qf(1,10,this).update(e,o),t.minFilter=s,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,r){const i=e.getRenderTarget();for(let i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,n,r);e.setRenderTarget(i)}}class $f extends kd{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new vd,this.environmentIntensity=1,this.environmentRotation=new vd,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class Yf{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Hl,this.updateRanges=[],this.version=0,this.uuid=Jl()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Jl()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Jl()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Kf=new Rh;class Qf{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Kf.fromBufferAttribute(this,t),Kf.applyMatrix4(e),this.setXYZ(t,Kf.x,Kf.y,Kf.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Kf.fromBufferAttribute(this,t),Kf.applyNormalMatrix(e),this.setXYZ(t,Kf.x,Kf.y,Kf.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Kf.fromBufferAttribute(this,t),Kf.transformDirection(e),this.setXYZ(t,Kf.x,Kf.y,Kf.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=rh(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=ih(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=ih(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=ih(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=ih(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=ih(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=rh(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=rh(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=rh(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=rh(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=ih(t,this.array),n=ih(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=ih(t,this.array),n=ih(n,this.array),r=ih(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=ih(t,this.array),n=ih(n,this.array),r=ih(r,this.array),i=ih(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new hf(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Qf(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Jf extends nf{static get type(){return"SpriteMaterial"}constructor(e){super(),this.isSpriteMaterial=!0,this.color=new Jd(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}class ep extends Th{constructor(e=null,t=1,n=1,r,i,o,s,a,u=1003,c=1003,l,h){super(null,o,s,a,u,c,r,i,l,h),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class tp extends hf{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const np=new Rh,rp=new Rh,ip=new ah;class op{constructor(e=new Rh(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=np.subVectors(n,t).cross(rp.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(np),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||ip.getNormalMatrix(e),r=this.coplanarPoint(np).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const sp=new Qh,ap=new Rh;class up{constructor(e=new op,t=new op,n=new op,r=new op,i=new op,o=new op){this.planes=[e,t,n,r,i,o]}set(e,t,n,r,i,o){const s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(n),s[3].copy(r),s[4].copy(i),s[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=2e3){const n=this.planes,r=e.elements,i=r[0],o=r[1],s=r[2],a=r[3],u=r[4],c=r[5],l=r[6],h=r[7],d=r[8],f=r[9],p=r[10],m=r[11],g=r[12],v=r[13],y=r[14],b=r[15];if(n[0].setComponents(a-i,h-u,m-d,b-g).normalize(),n[1].setComponents(a+i,h+u,m+d,b+g).normalize(),n[2].setComponents(a+o,h+c,m+f,b+v).normalize(),n[3].setComponents(a-o,h-c,m-f,b-v).normalize(),n[4].setComponents(a-s,h-l,m-p,b-y).normalize(),t===ql)n[5].setComponents(a+s,h+l,m+p,b+y).normalize();else{if(t!==Xl)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(s,l,p,y).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),sp.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),sp.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(sp)}intersectsSprite(e){return sp.center.set(0,0,0),sp.radius=.7071067811865476,sp.applyMatrix4(e.matrixWorld),this.intersectsSphere(sp)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let e=0;e<6;e++){if(t[e].distanceToPoint(n)<r)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(ap.x=r.normal.x>0?e.max.x:e.min.x,ap.y=r.normal.y>0?e.max.y:e.min.y,ap.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(ap)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}class cp extends nf{static get type(){return"LineBasicMaterial"}constructor(e){super(),this.isLineBasicMaterial=!0,this.color=new Jd(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}class lp extends nf{static get type(){return"PointsMaterial"}constructor(e){super(),this.isPointsMaterial=!0,this.color=new Jd(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}class hp extends Th{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=jc,this.minFilter=jc,this.generateMipmaps=!1,this.needsUpdate=!0}}class dp extends Th{constructor(e,t,n,r,i,o,s,a,u,c=1026){if(c!==il&&c!==ol)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===il&&(n=Qc),void 0===n&&c===ol&&(n=tl),super(null,r,i,o,s,a,c,n,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==s?s:jc,this.minFilter=void 0!==a?a:jc,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class fp extends Sf{constructor(e=1,t=32,n=16,r=0,i=2*Math.PI,o=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:s},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const a=Math.min(o+s,Math.PI);let u=0;const c=[],l=new Rh,h=new Rh,d=[],f=[],p=[],m=[];for(let d=0;d<=n;d++){const g=[],v=d/n;let y=0;0===d&&0===o?y=.5/t:d===n&&a===Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){const a=n/t;l.x=-e*Math.cos(r+a*i)*Math.sin(o+v*s),l.y=e*Math.cos(o+v*s),l.z=e*Math.sin(r+a*i)*Math.sin(o+v*s),f.push(l.x,l.y,l.z),h.copy(l).normalize(),p.push(h.x,h.y,h.z),m.push(a+y,1-v),g.push(u++)}c.push(g)}for(let e=0;e<n;e++)for(let r=0;r<t;r++){const t=c[e][r+1],i=c[e][r],s=c[e+1][r],u=c[e+1][r+1];(0!==e||o>0)&&d.push(t,i,u),(e!==n-1||a<Math.PI)&&d.push(i,s,u)}this.setIndex(d),this.setAttribute("position",new mf(f,3)),this.setAttribute("normal",new mf(p,3)),this.setAttribute("uv",new mf(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fp(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class pp extends nf{static get type(){return"ShadowMaterial"}constructor(e){super(),this.isShadowMaterial=!0,this.color=new Jd(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class mp extends nf{static get type(){return"MeshStandardMaterial"}constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.color=new Jd(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Jd(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new sh(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new vd,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class gp extends mp{static get type(){return"MeshPhysicalMaterial"}constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new sh(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return eh(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Jd(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Jd(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Jd(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class vp extends nf{static get type(){return"MeshPhongMaterial"}constructor(e){super(),this.isMeshPhongMaterial=!0,this.color=new Jd(16777215),this.specular=new Jd(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Jd(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new sh(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new vd,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class yp extends nf{static get type(){return"MeshToonMaterial"}constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.color=new Jd(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Jd(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new sh(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class bp extends nf{static get type(){return"MeshNormalMaterial"}constructor(e){super(),this.isMeshNormalMaterial=!0,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new sh(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class _p extends nf{static get type(){return"MeshLambertMaterial"}constructor(e){super(),this.isMeshLambertMaterial=!0,this.color=new Jd(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Jd(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new sh(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new vd,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class xp extends nf{static get type(){return"MeshMatcapMaterial"}constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.color=new Jd(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new sh(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class wp extends cp{static get type(){return"LineDashedMaterial"}constructor(e){super(),this.isLineDashedMaterial=!0,this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Sp(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function Ep(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}class Tp{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let o;n:{r:if(!(e<r)){for(let o=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===o)break;if(i=r,r=t[++n],e<r)break t}o=t.length;break n}if(e>=i)break e;{const s=t[1];e<s&&(n=2,i=s);for(let o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===o)break;if(r=i,i=t[--n-1],e>=i)break t}o=n,n=0}}for(;n<o;){const r=n+o>>>1;e<t[r]?o=r:n=r+1}if(r=t[n],i=t[n-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let e=0;e!==r;++e)t[e]=n[i+e];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Mp extends Tp{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Dl,endingEnd:Dl}}intervalChanged_(e,t,n){const r=this.parameterPositions;let i=e-2,o=e+1,s=r[i],a=r[o];if(void 0===s)switch(this.getSettings_().endingStart){case Ll:i=e,s=2*t-n;break;case Ul:i=r.length-2,s=t+r[i]-r[i+1];break;default:i=e,s=n}if(void 0===a)switch(this.getSettings_().endingEnd){case Ll:o=e,a=2*n-t;break;case Ul:o=1,a=n+r[1]-r[0];break;default:o=e-1,a=t}const u=.5*(n-t),c=this.valueSize;this._weightPrev=u/(t-s),this._weightNext=u/(a-n),this._offsetPrev=i*c,this._offsetNext=o*c}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=e*s,u=a-s,c=this._offsetPrev,l=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(n-t)/(r-t),p=f*f,m=p*f,g=-h*m+2*h*p-h*f,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,b=d*m-d*p;for(let e=0;e!==s;++e)i[e]=g*o[c+e]+v*o[u+e]+y*o[a+e]+b*o[l+e];return i}}class Ap extends Tp{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=e*s,u=a-s,c=(n-t)/(r-t),l=1-c;for(let e=0;e!==s;++e)i[e]=o[u+e]*l+o[a+e]*c;return i}}class Cp extends Tp{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Op{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Sp(t,this.TimeBufferType),this.values=Sp(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Sp(e.times,Array),values:Sp(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Cp(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Ap(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Mp(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Nl:t=this.InterpolantFactoryMethodDiscrete;break;case Il:t=this.InterpolantFactoryMethodLinear;break;case kl:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Nl;case this.InterpolantFactoryMethodLinear:return Il;case this.InterpolantFactoryMethodSmooth:return kl}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let i=0,o=r-1;for(;i!==r&&n[i]<e;)++i;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==i||o!==r){i>=o&&(o=Math.max(o,1),i=o-1);const e=this.getValueSize();this.times=n.slice(i,o),this.values=this.values.slice(i*e,o*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let t=0;t!==i;t++){const r=n[t];if("number"==typeof r&&isNaN(r)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,r),e=!1;break}if(null!==o&&o>r){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,r,o),e=!1;break}o=r}if(void 0!==r&&Ep(r))for(let t=0,n=r.length;t!==n;++t){const n=r[t];if(isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,n),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===kl,i=e.length-1;let o=1;for(let s=1;s<i;++s){let i=!1;const a=e[s];if(a!==e[s+1]&&(1!==s||a!==e[0]))if(r)i=!0;else{const e=s*n,r=e-n,o=e+n;for(let s=0;s!==n;++s){const n=t[e+s];if(n!==t[r+s]||n!==t[o+s]){i=!0;break}}}if(i){if(s!==o){e[o]=e[s];const r=s*n,i=o*n;for(let e=0;e!==n;++e)t[i+e]=t[r+e]}++o}}if(i>0){e[o]=e[i];for(let e=i*n,r=o*n,s=0;s!==n;++s)t[r+s]=t[e+s];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}Op.prototype.TimeBufferType=Float32Array,Op.prototype.ValueBufferType=Float32Array,Op.prototype.DefaultInterpolation=Il;class Pp extends Op{constructor(e,t,n){super(e,t,n)}}Pp.prototype.ValueTypeName="bool",Pp.prototype.ValueBufferType=Array,Pp.prototype.DefaultInterpolation=Nl,Pp.prototype.InterpolantFactoryMethodLinear=void 0,Pp.prototype.InterpolantFactoryMethodSmooth=void 0;class Rp extends Op{}Rp.prototype.ValueTypeName="color";class Np extends Op{}Np.prototype.ValueTypeName="number";class Ip extends Tp{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=(n-t)/(r-t);let u=e*s;for(let e=u+s;u!==e;u+=4)Ph.slerpFlat(i,0,o,u-s,o,u,a);return i}}class kp extends Op{InterpolantFactoryMethodLinear(e){return new Ip(this.times,this.values,this.getValueSize(),e)}}kp.prototype.ValueTypeName="quaternion",kp.prototype.InterpolantFactoryMethodSmooth=void 0;class Dp extends Op{constructor(e,t,n){super(e,t,n)}}Dp.prototype.ValueTypeName="string",Dp.prototype.ValueBufferType=Array,Dp.prototype.DefaultInterpolation=Nl,Dp.prototype.InterpolantFactoryMethodLinear=void 0,Dp.prototype.InterpolantFactoryMethodSmooth=void 0;class Lp extends Op{}Lp.prototype.ValueTypeName="vector";class Up{constructor(e,t,n){const r=this;let i,o=!1,s=0,a=0;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===o&&void 0!==r.onStart&&r.onStart(e,s,a),o=!0},this.itemEnd=function(e){s++,void 0!==r.onProgress&&r.onProgress(e,s,a),s===a&&(o=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return i?i(e):e},this.setURLModifier=function(e){return i=e,this},this.addHandler=function(e,t){return u.push(e,t),this},this.removeHandler=function(e){const t=u.indexOf(e);return-1!==t&&u.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=u.length;t<n;t+=2){const n=u[t],r=u[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return r}return null}}}const Fp=new Up;class Bp{constructor(e){this.manager=void 0!==e?e:Fp,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Bp.DEFAULT_MATERIAL_NAME="__DEFAULT";class zp extends kd{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Jd(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(t.object.target=this.target.uuid),t}}class jp extends zp{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(kd.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Jd(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Vp=new ad,Gp=new Rh,Hp=new Rh;class Wp{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new sh(512,512),this.map=null,this.mapPass=null,this.matrix=new ad,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new up,this._frameExtents=new sh(1,1),this._viewportCount=1,this._viewports=[new Mh(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Gp.setFromMatrixPosition(e.matrixWorld),t.position.copy(Gp),Hp.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Hp),t.updateMatrixWorld(),Vp.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Vp),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Vp)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class qp extends Wp{constructor(){super(new Hf(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*Ql*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Xp extends zp{constructor(e,t,n=0,r=Math.PI/3,i=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(kd.DEFAULT_UP),this.updateMatrix(),this.target=new kd,this.distance=n,this.angle=r,this.penumbra=i,this.decay=o,this.map=null,this.shadow=new qp}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const Zp=new ad,$p=new Rh,Yp=new Rh;class Kp extends Wp{constructor(){super(new Hf(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new sh(4,2),this._viewportCount=6,this._viewports=[new Mh(2,1,1,1),new Mh(0,1,1,1),new Mh(3,1,1,1),new Mh(1,1,1,1),new Mh(3,0,1,1),new Mh(1,0,1,1)],this._cubeDirections=[new Rh(1,0,0),new Rh(-1,0,0),new Rh(0,0,1),new Rh(0,0,-1),new Rh(0,1,0),new Rh(0,-1,0)],this._cubeUps=[new Rh(0,1,0),new Rh(0,1,0),new Rh(0,1,0),new Rh(0,1,0),new Rh(0,0,1),new Rh(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,i=e.distance||n.far;i!==n.far&&(n.far=i,n.updateProjectionMatrix()),$p.setFromMatrixPosition(e.matrixWorld),n.position.copy($p),Yp.copy(n.position),Yp.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Yp),n.updateMatrixWorld(),r.makeTranslation(-$p.x,-$p.y,-$p.z),Zp.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Zp)}}class Qp extends zp{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new Kp}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Jp extends zf{constructor(e=-1,t=1,n=1,r=-1,i=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,o=n+e,s=r+t,a=r-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,o=i+e*this.view.width,s-=t*this.view.offsetY,a=s-t*this.view.height}this.projectionMatrix.makeOrthographic(i,o,s,a,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}class em extends Wp{constructor(){super(new Jp(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class tm extends zp{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(kd.DEFAULT_UP),this.updateMatrix(),this.target=new kd,this.shadow=new em}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class nm extends zp{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class rm extends zp{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class im{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Rh)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*i),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],n*r*1.092548),t.addScaledVector(o[5],r*i*1.092548),t.addScaledVector(o[6],.315392*(3*i*i-1)),t.addScaledVector(o[7],n*i*1.092548),t.addScaledVector(o[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,i=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],1.023328*r),t.addScaledVector(o[2],1.023328*i),t.addScaledVector(o[3],1.023328*n),t.addScaledVector(o[4],.858086*n*r),t.addScaledVector(o[5],.858086*r*i),t.addScaledVector(o[6],.743125*i*i-.247708),t.addScaledVector(o[7],.858086*n*i),t.addScaledVector(o[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}class om extends zp{constructor(e=new im,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}const sm="\\[\\]\\.:\\/",am=new RegExp("["+sm+"]","g"),um="[^"+sm+"]",cm="[^"+sm.replace("\\.","")+"]",lm=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",um)+/(WCOD+)?/.source.replace("WCOD",cm)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",um)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",um)+"$"),hm=["material","materials","bones","map"];class dm{constructor(e,t,n){this.path=t,this.parsedPath=n||dm.parseTrackName(t),this.node=dm.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new dm.Composite(e,t,n):new dm(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(am,"")}static parseTrackName(e){const t=lm.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const e=n.nodeName.substring(r+1);-1!==hm.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let r=0;r<e.length;r++){const i=e[r];if(i.name===t||i.uuid===t)return i;const o=n(i.children);if(o)return o}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let i=t.propertyIndex;if(e||(e=dm.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(n){let r=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===r){r=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==r){if(void 0===e[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[r]}}const o=e[r];if(void 0===o){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+r+" but it wasn't found.",e)}let s=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?s=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(s=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}a=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=i}else void 0!==o.fromArray&&void 0!==o.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(a=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}dm.Composite=class{constructor(e,t,n){const r=n||dm.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},dm.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},dm.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},dm.prototype.GetterByBindingType=[dm.prototype._getValue_direct,dm.prototype._getValue_array,dm.prototype._getValue_arrayElement,dm.prototype._getValue_toArray],dm.prototype.SetterByBindingTypeAndVersioning=[[dm.prototype._setValue_direct,dm.prototype._setValue_direct_setNeedsUpdate,dm.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[dm.prototype._setValue_array,dm.prototype._setValue_array_setNeedsUpdate,dm.prototype._setValue_array_setMatrixWorldNeedsUpdate],[dm.prototype._setValue_arrayElement,dm.prototype._setValue_arrayElement_setNeedsUpdate,dm.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[dm.prototype._setValue_fromArray,dm.prototype._setValue_fromArray_setNeedsUpdate,dm.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);class fm extends Yf{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}const pm=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveMap","envMap","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"];class mm{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=!0===e.object.isSkinnedMesh,this.refreshUniforms=pm,this.renderId=0}firstInitialization(e){return!1===this.renderObjects.has(e)&&(this.getRenderObjectData(e),!0)}getRenderObjectData(e){let t=this.renderObjects.get(e);if(void 0===t){const{geometry:n,material:r}=e;if(t={material:this.getMaterialData(r),geometry:{attributes:this.getAttributesData(n.attributes),indexVersion:n.index?n.index.version:null,drawRange:{start:n.drawRange.start,count:n.drawRange.count}},worldMatrix:e.object.matrixWorld.clone()},e.object.center&&(t.center=e.object.center.clone()),e.object.morphTargetInfluences&&(t.morphTargetInfluences=e.object.morphTargetInfluences.slice()),null!==e.bundle&&(t.version=e.bundle.version),t.material.transmission>0){const{width:n,height:r}=e.context;t.bufferWidth=n,t.bufferHeight=r}this.renderObjects.set(e,t)}return t}getAttributesData(e){const t={};for(const n in e){const r=e[n];t[n]={version:r.version}}return t}containsNode(e){const t=e.material;for(const e in t)if(t[e]&&t[e].isNode)return!0;return null!==e.renderer.nodes.modelViewMatrix||null!==e.renderer.nodes.modelNormalViewMatrix}getMaterialData(e){const t={};for(const n of this.refreshUniforms){const r=e[n];null!=r&&("object"==typeof r&&void 0!==r.clone?!0===r.isTexture?t[n]={id:r.id,version:r.version}:t[n]=r.clone():t[n]=r)}return t}equals(e){const{object:t,material:n,geometry:r}=e,i=this.getRenderObjectData(e);if(!0!==i.worldMatrix.equals(t.matrixWorld))return i.worldMatrix.copy(t.matrixWorld),!1;const o=i.material;for(const e in o){const t=o[e],r=n[e];if(void 0!==t.equals){if(!1===t.equals(r))return t.copy(r),!1}else if(!0===r.isTexture){if(t.id!==r.id||t.version!==r.version)return t.id=r.id,t.version=r.version,!1}else if(t!==r)return o[e]=r,!1}if(o.transmission>0){const{width:t,height:n}=e.context;if(i.bufferWidth!==t||i.bufferHeight!==n)return i.bufferWidth=t,i.bufferHeight=n,!1}const s=i.geometry,a=r.attributes,u=s.attributes,c=Object.keys(u),l=Object.keys(a);if(c.length!==l.length)return i.geometry.attributes=this.getAttributesData(a),!1;for(const e of c){const t=u[e],n=a[e];if(void 0===n)return delete u[e],!1;if(t.version!==n.version)return t.version=n.version,!1}const h=r.index,d=s.indexVersion,f=h?h.version:null;if(d!==f)return s.indexVersion=f,!1;if(s.drawRange.start!==r.drawRange.start||s.drawRange.count!==r.drawRange.count)return s.drawRange.start=r.drawRange.start,s.drawRange.count=r.drawRange.count,!1;if(i.morphTargetInfluences){let e=!1;for(let n=0;n<i.morphTargetInfluences.length;n++)i.morphTargetInfluences[n]!==t.morphTargetInfluences[n]&&(e=!0);if(e)return!0}return i.center&&!1===i.center.equals(t.center)?(i.center.copy(t.center),!0):(null!==e.bundle&&(i.version=e.bundle.version),!0)}needsRefresh(e,t){if(this.hasNode||this.hasAnimation||this.firstInitialization(e))return!0;const{renderId:n}=t;if(this.renderId!==n)return this.renderId=n,!0;const r=!0===e.object.static,i=null!==e.bundle&&!0===e.bundle.static&&this.getRenderObjectData(e).version===e.bundle.version;if(r||i)return!1;return!0!==this.equals(e)}}function gm(e,t=0){let n=3735928559^t,r=1103547991^t;if(e instanceof Array)for(let t,i=0;i<e.length;i++)t=e[i],n=Math.imul(n^t,2654435761),r=Math.imul(r^t,1597334677);else for(let t,i=0;i<e.length;i++)t=e.charCodeAt(i),n=Math.imul(n^t,2654435761),r=Math.imul(r^t,1597334677);return n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507),r^=Math.imul(n^n>>>13,3266489909),4294967296*(2097151&r)+(n>>>0)}const vm=e=>gm(e),ym=e=>gm(e),bm=(...e)=>gm(e);function _m(e,t=!1){const n=[];!0===e.isNode&&(n.push(e.id),e=e.getSelf());for(const{property:r,childNode:i}of xm(e))n.push(n,gm(r.slice(0,-4)),i.getCacheKey(t));return gm(n)}function*xm(e,t=!1){for(const n in e){if(!0===n.startsWith("_"))continue;const r=e[n];if(!0===Array.isArray(r))for(let e=0;e<r.length;e++){const i=r[e];i&&(!0===i.isNode||t&&"function"==typeof i.toJSON)&&(yield{property:n,index:e,childNode:i})}else if(r&&!0===r.isNode)yield{property:n,childNode:r};else if("object"==typeof r)for(const e in r){const i=r[e];i&&(!0===i.isNode||t&&"function"==typeof i.toJSON)&&(yield{property:n,index:e,childNode:i})}}}function wm(e){if(null==e)return null;const t=typeof e;return!0===e.isNode?"node":"number"===t?"float":"boolean"===t?"bool":"string"===t?"string":"function"===t?"shader":!0===e.isVector2?"vec2":!0===e.isVector3?"vec3":!0===e.isVector4?"vec4":!0===e.isMatrix3?"mat3":!0===e.isMatrix4?"mat4":!0===e.isColor?"color":e instanceof ArrayBuffer?"ArrayBuffer":null}function Sm(e,...t){const n=e?e.slice(-4):void 0;return 1===t.length&&("vec2"===n?t=[t[0],t[0]]:"vec3"===n?t=[t[0],t[0],t[0]]:"vec4"===n&&(t=[t[0],t[0],t[0],t[0]])),"color"===e?new Jd(...t):"vec2"===n?new sh(...t):"vec3"===n?new Rh(...t):"vec4"===n?new Mh(...t):"mat3"===n?new ah(...t):"mat4"===n?new ad(...t):"bool"===e?t[0]||!1:"float"===e||"int"===e||"uint"===e?t[0]||0:"string"===e?t[0]||"":"ArrayBuffer"===e?Tm(t[0]):null}function Em(e){let t="";const n=new Uint8Array(e);for(let e=0;e<n.length;e++)t+=String.fromCharCode(n[e]);return btoa(t)}function Tm(e){return Uint8Array.from(atob(e),(e=>e.charCodeAt(0))).buffer}const Mm="vertex",Am="none",Cm="frame",Om="render",Pm="object",Rm=["setup","analyze","generate"],Nm=["fragment","vertex","compute"],Im=["x","y","z","w"];let km=0;class Dm extends Zl{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=Am,this.updateBeforeType=Am,this.updateAfterType=Am,this.uuid=oh.generateUUID(),this.version=0,this._cacheKey=null,this._cacheKeyVersion=0,this.global=!1,this.isNode=!0,Object.defineProperty(this,"id",{value:km++})}set needsUpdate(e){!0===e&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this.getSelf()),this}onFrameUpdate(e){return this.onUpdate(e,Cm)}onRenderUpdate(e){return this.onUpdate(e,Om)}onObjectUpdate(e){return this.onUpdate(e,Pm)}onReference(e){return this.updateReference=e.bind(this.getSelf()),this}getSelf(){return this.self||this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of xm(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}getCacheKey(e=!1){return!0!==(e=e||this.version!==this._cacheKeyVersion)&&null!==this._cacheKey||(this._cacheKey=_m(this,e),this._cacheKeyVersion=this.version),this._cacheKey}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const t=this.getNodeType(e);return e.getElementType(t)}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}setup(e){const t=e.getNodeProperties(this);let n=0;for(const e of this.getChildren())t["node"+n++]=e;return null}analyze(e){if(1===e.increaseUsage(this)){const t=e.getNodeProperties(this);for(const n of Object.values(t))n&&!0===n.isNode&&n.build(e)}}generate(e,t){const{outputNode:n}=e.getNodeProperties(this);if(n&&!0===n.isNode)return n.build(e,t)}updateBefore(){console.warn("Abstract function.")}updateAfter(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e,t=null){const n=this.getShared(e);if(this!==n)return n.build(e,t);e.addNode(this),e.addChain(this);let r=null;const i=e.getBuildStage();if("setup"===i){this.updateReference(e);const t=e.getNodeProperties(this);if(!0!==t.initialized){e.stack.nodes.length;t.initialized=!0,t.outputNode=this.setup(e),null!==t.outputNode&&e.stack.nodes.length;for(const n of Object.values(t))n&&!0===n.isNode&&n.build(e)}}else if("analyze"===i)this.analyze(e);else if("generate"===i){if(1===this.generate.length){const n=this.getNodeType(e),i=e.getDataFromNode(this);r=i.snippet,void 0===r?(r=this.generate(e)||"",i.snippet=r):void 0!==i.flowCodes&&void 0!==e.context.nodeBlock&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),r=e.format(r,n,t)}else r=this.generate(e,t)||""}return e.removeChain(this),e.addSequentialNode(this),r}getSerializeChildren(){return xm(this)}serialize(e){const t=this.getSerializeChildren(),n={};for(const{property:r,index:i,childNode:o}of t)void 0!==i?(void 0===n[r]&&(n[r]=Number.isInteger(i)?[]:{}),n[r][i]=o.toJSON(e.meta).uuid):n[r]=o.toJSON(e.meta).uuid;Object.keys(n).length>0&&(e.inputNodes=n)}deserialize(e){if(void 0!==e.inputNodes){const t=e.meta.nodes;for(const n in e.inputNodes)if(Array.isArray(e.inputNodes[n])){const r=[];for(const i of e.inputNodes[n])r.push(t[i]);this[n]=r}else if("object"==typeof e.inputNodes[n]){const r={};for(const i in e.inputNodes[n]){const o=e.inputNodes[n][i];r[i]=t[o]}this[n]=r}else{const r=e.inputNodes[n];this[n]=t[r]}}}toJSON(e){const{uuid:t,type:n}=this,r=void 0===e||"string"==typeof e;r&&(e={textures:{},images:{},nodes:{}});let i=e.nodes[t];function o(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}if(void 0===i&&(i={uuid:t,type:n,meta:e,metadata:{version:4.6,type:"Node",generator:"Node.toJSON"}},!0!==r&&(e.nodes[i.uuid]=i),this.serialize(i),delete i.meta),r){const t=o(e.textures),n=o(e.images),r=o(e.nodes);t.length>0&&(i.textures=t),n.length>0&&(i.images=n),r.length>0&&(i.nodes=r)}return i}}class Lm extends Dm{static get type(){return"ArrayElementNode"}constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){return`${this.node.build(e)}[ ${this.indexNode.build(e,"uint")} ]`}}class Um extends Dm{static get type(){return"ConvertNode"}constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let n=null;for(const r of this.convertTo.split("|"))null!==n&&e.getTypeLength(t)!==e.getTypeLength(r)||(n=r);return n}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const n=this.node,r=this.getNodeType(e),i=n.build(e,r);return e.format(i,r,t)}}class Fm extends Dm{static get type(){return"TempNode"}constructor(e){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if("generate"===e.getBuildStage()){const n=e.getVectorType(this.getNodeType(e,t)),r=e.getDataFromNode(this);if(void 0!==r.propertyName)return e.format(r.propertyName,n,t);if("void"!==n&&"void"!==t&&this.hasDependencies(e)){const i=super.build(e,n),o=e.getVarFromNode(this,null,n),s=e.getPropertyName(o);return e.addLineFlowCode(`${s} = ${i}`,this),r.snippet=i,r.propertyName=s,e.format(r.propertyName,n,t)}}return super.build(e,t)}}class Bm extends Fm{static get type(){return"JoinNode"}constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return null!==this.nodeType?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce(((t,n)=>t+e.getTypeLength(n.getNodeType(e))),0))}generate(e,t){const n=this.getNodeType(e),r=this.nodes,i=e.getComponentType(n),o=[];for(const t of r){let n=t.build(e);const r=e.getComponentType(t.getNodeType(e));r!==i&&(n=e.format(n,r,i)),o.push(n)}const s=`${e.getType(n)}( ${o.join(", ")} )`;return e.format(s,n,t)}}const zm=Im.join("");class jm extends Dm{static get type(){return"SplitNode"}constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(Im.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}generate(e,t){const n=this.node,r=e.getTypeLength(n.getNodeType(e));let i=null;if(r>1){let o=null;this.getVectorLength()>=r&&(o=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const s=n.build(e,o);i=this.components.length===r&&this.components===zm.slice(0,this.components.length)?e.format(s,o,t):e.format(`${s}.${this.components}`,this.getNodeType(e),t)}else i=n.build(e,t);return i}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class Vm extends Fm{static get type(){return"SetNode"}constructor(e,t,n){super(),this.sourceNode=e,this.components=t,this.targetNode=n}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:n,targetNode:r}=this,i=this.getNodeType(e),o=e.getTypeFromLength(n.length,r.getNodeType(e)),s=r.build(e,o),a=t.build(e,i),u=e.getTypeLength(i),c=[];for(let e=0;e<u;e++){const t=Im[e];t===n[0]?(c.push(s),e+=n.length-1):c.push(a+"."+t)}return`${e.getType(i)}( ${c.join(", ")} )`}}class Gm extends Fm{static get type(){return"FlipNode"}constructor(e,t){super(),this.sourceNode=e,this.components=t}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:t,sourceNode:n}=this,r=this.getNodeType(e),i=n.build(e),o=e.getVarFromNode(this),s=e.getPropertyName(o);e.addLineFlowCode(s+" = "+i,this);const a=e.getTypeLength(r),u=[];let c=0;for(let e=0;e<a;e++){const n=Im[e];n===t[c]?(u.push("1.0 - "+s+"."+n),c++):u.push(s+"."+n)}return`${e.getType(r)}( ${u.join(", ")} )`}}class Hm extends Dm{static get type(){return"InputNode"}constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return null===this.nodeType?wm(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=wm(this.value),e.nodeType=this.nodeType,"ArrayBuffer"===e.valueType&&(e.value=Em(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?Sm(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}class Wm extends Hm{static get type(){return"ConstNode"}constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const n=this.getNodeType(e);return e.format(this.generateConst(e),n,t)}}let qm=null;const Xm=new Map;function Zm(e,t){if(Xm.has(e))console.warn(`Redefinition of method chaining ${e}`);else{if("function"!=typeof t)throw new Error(`Node element ${e} is not a function`);Xm.set(e,t)}}const $m=e=>e.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),Ym=e=>$m(e).split("").sort().join(""),Km={setup(e,t){const n=t.shift();return e(xg(n),...t)},get(e,t,n){if("string"==typeof t&&void 0===e[t]){if(!0!==e.isStackNode&&"assign"===t)return(...e)=>(qm.assign(n,...e),n);if(Xm.has(t)){const r=Xm.get(t);return e.isStackNode?(...e)=>n.add(r(...e)):(...e)=>r(n,...e)}if("self"===t)return e;if(t.endsWith("Assign")&&Xm.has(t.slice(0,t.length-"Assign".length))){const r=Xm.get(t.slice(0,t.length-"Assign".length));return e.isStackNode?(...e)=>n.assign(e[0],r(...e)):(...e)=>n.assign(r(n,...e))}if(!0===/^[xyzwrgbastpq]{1,4}$/.test(t))return t=$m(t),_g(new jm(n,t));if(!0===/^set[XYZWRGBASTPQ]{1,4}$/.test(t))return t=Ym(t.slice(3).toLowerCase()),n=>_g(new Vm(e,t,n));if(!0===/^flip[XYZWRGBASTPQ]{1,4}$/.test(t))return t=Ym(t.slice(4).toLowerCase()),()=>_g(new Gm(_g(e),t));if("width"===t||"height"===t||"depth"===t)return"width"===t?t="x":"height"===t?t="y":"depth"===t&&(t="z"),_g(new jm(e,t));if(!0===/^\d+$/.test(t))return _g(new Lm(n,new Wm(Number(t),"uint")))}return Reflect.get(e,t,n)},set(e,t,n,r){return"string"!=typeof t||void 0!==e[t]||!0!==/^[xyzwrgbastpq]{1,4}$/.test(t)&&"width"!==t&&"height"!==t&&"depth"!==t&&!0!==/^\d+$/.test(t)?Reflect.set(e,t,n,r):(r[t].assign(n),!0)}},Qm=new WeakMap,Jm=new WeakMap,eg=function(e,t=null){for(const n in e)e[n]=_g(e[n],t);return e},tg=function(e,t=null){const n=e.length;for(let r=0;r<n;r++)e[r]=_g(e[r],t);return e},ng=function(e,t=null,n=null,r=null){const i=e=>_g(null!==r?Object.assign(e,r):e);return null===t?(...t)=>i(new e(...wg(t))):null!==n?(n=_g(n),(...r)=>i(new e(t,...wg(r),n))):(...n)=>i(new e(t,...wg(n)))},rg=function(e,...t){return _g(new e(...wg(t)))};class ig extends Dm{constructor(e,t){super(),this.shaderNode=e,this.inputNodes=t}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}call(e){const{shaderNode:t,inputNodes:n}=this,r=e.getNodeProperties(t);if(r.onceOutput)return r.onceOutput;let i=null;if(t.layout){let r=Jm.get(e.constructor);void 0===r&&(r=new WeakMap,Jm.set(e.constructor,r));let o=r.get(t);void 0===o&&(o=_g(e.buildFunctionNode(t)),r.set(t,o)),null!==e.currentFunctionNode&&e.currentFunctionNode.includes.push(o),i=_g(o.call(n))}else{const r=t.jsFunc,o=null!==n?r(n,e):r(e);i=_g(o)}return t.once&&(r.onceOutput=i),i}getOutputNode(e){const t=e.getNodeProperties(this);return null===t.outputNode&&(t.outputNode=this.setupOutput(e)),t.outputNode}setup(e){return this.getOutputNode(e)}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}generate(e,t){return this.getOutputNode(e).build(e,t)}}class og extends Dm{constructor(e,t){super(t),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}setLayout(e){return this.layout=e,this}call(e=null){return xg(e),_g(new ig(this,e))}setup(){return this.call()}}const sg=[!1,!0],ag=[0,1,2,3],ug=[-1,-2],cg=[.5,1.5,1/3,1e-6,1e6,Math.PI,2*Math.PI,1/Math.PI,2/Math.PI,1/(2*Math.PI),Math.PI/2],lg=new Map;for(const e of sg)lg.set(e,new Wm(e));const hg=new Map;for(const e of ag)hg.set(e,new Wm(e,"uint"));const dg=new Map([...hg].map((e=>new Wm(e.value,"int"))));for(const e of ug)dg.set(e,new Wm(e,"int"));const fg=new Map([...dg].map((e=>new Wm(e.value))));for(const e of cg)fg.set(e,new Wm(e));for(const e of cg)fg.set(-e,new Wm(-e));const pg={bool:lg,uint:hg,ints:dg,float:fg},mg=new Map([...lg,...fg]),gg=(e,t)=>mg.has(e)?mg.get(e):!0===e.isNode?e:new Wm(e,t),vg=function(e,t=null){return(...n)=>{if((0===n.length||!["bool","float","int","uint"].includes(e)&&n.every((e=>"object"!=typeof e)))&&(n=[Sm(e,...n)]),1===n.length&&null!==t&&t.has(n[0]))return _g(t.get(n[0]));if(1===n.length){const t=gg(n[0],e);return(e=>{try{return e.getNodeType()}catch(e){return}})(t)===e?_g(t):_g(new Um(t,e))}const r=n.map((e=>gg(e)));return _g(new Bm(r,e))}},yg=e=>"object"==typeof e&&null!==e?e.value:e;function bg(e,t){return new Proxy(new og(e,t),Km)}const _g=(e,t=null)=>function(e,t=null){const n=wm(e);if("node"===n){let t=Qm.get(e);return void 0===t&&(t=new Proxy(e,Km),Qm.set(e,t),Qm.set(t,t)),t}return null===t&&("float"===n||"boolean"===n)||n&&"shader"!==n&&"string"!==n?_g(gg(e,t)):"shader"===n?Tg(e):e}(e,t),xg=(e,t=null)=>new eg(e,t),wg=(e,t=null)=>new tg(e,t),Sg=(...e)=>new ng(...e),Eg=(...e)=>new rg(...e),Tg=(e,t)=>{const n=new bg(e,t),r=(...e)=>{let t;return xg(e),t=e[0]&&e[0].isNode?[...e]:e[0],n.call(t)};return r.shaderNode=n,r.setLayout=e=>(n.setLayout(e),r),r.once=()=>(n.once=!0,r),r};Zm("toGlobal",(e=>(e.global=!0,e)));const Mg=e=>{qm=e},Ag=()=>qm,Cg=(...e)=>qm.If(...e);Zm("append",(function(e){return qm&&qm.add(e),e}));const Og=new vg("color"),Pg=new vg("float",pg.float),Rg=new vg("int",pg.ints),Ng=new vg("uint",pg.uint),Ig=new vg("bool",pg.bool),kg=new vg("vec2"),Dg=new vg("ivec2"),Lg=new vg("uvec2"),Ug=new vg("bvec2"),Fg=new vg("vec3"),Bg=new vg("ivec3"),zg=new vg("uvec3"),jg=new vg("bvec3"),Vg=new vg("vec4"),Gg=new vg("ivec4"),Hg=new vg("uvec4"),Wg=new vg("bvec4"),qg=new vg("mat2"),Xg=new vg("mat3"),Zg=new vg("mat4");Zm("toColor",Og),Zm("toFloat",Pg),Zm("toInt",Rg),Zm("toUint",Ng),Zm("toBool",Ig),Zm("toVec2",kg),Zm("toIVec2",Dg),Zm("toUVec2",Lg),Zm("toBVec2",Ug),Zm("toVec3",Fg),Zm("toIVec3",Bg),Zm("toUVec3",zg),Zm("toBVec3",jg),Zm("toVec4",Vg),Zm("toIVec4",Gg),Zm("toUVec4",Hg),Zm("toBVec4",Wg),Zm("toMat2",qg),Zm("toMat3",Xg),Zm("toMat4",Zg);Zm("element",Sg(Lm)),Zm("convert",((e,t)=>_g(new Um(_g(e),t))));class $g extends Dm{static get type(){return"UniformGroupNode"}constructor(e,t=!1,n=1){super("string"),this.name=e,this.version=0,this.shared=t,this.order=n,this.isUniformGroup=!0}set needsUpdate(e){!0===e&&this.version++}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const Yg=e=>new $g(e),Kg=(e,t=0)=>new $g(e,!0,t),Qg=Kg("frame"),Jg=Kg("render"),ev=Yg("object");class tv extends Hm{static get type(){return"UniformNode"}constructor(e,t=null){super(e,t),this.isUniformNode=!0,this.name="",this.groupNode=ev}label(e){return this.name=e,this}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){const n=this.getSelf();return e=e.bind(n),super.onUpdate((t=>{const r=e(t,n);void 0!==r&&(this.value=r)}),t)}generate(e,t){const n=this.getNodeType(e),r=this.getUniformHash(e);let i=e.getNodeFromHash(r);void 0===i&&(e.setHashNode(this,r),i=this);const o=i.getInputType(e),s=e.getUniformFromNode(i,o,e.shaderStage,this.name||e.context.label),a=e.getPropertyName(s);return void 0!==e.context.label&&delete e.context.label,e.format(a,n,t)}}const nv=(e,t)=>{const n=(e=>null!=e?e.nodeType||e.convertTo||("string"==typeof e?e:null):null)(t||e),r=e&&!0===e.isNode?e.node&&e.node.value||e.value:e;return _g(new tv(r,n))};class rv extends Dm{static get type(){return"PropertyNode"}constructor(e,t=null,n=!1){super(e),this.name=t,this.varying=n,this.isPropertyNode=!0}getHash(e){return this.name||super.getHash(e)}isGlobal(){return!0}generate(e){let t;return!0===this.varying?(t=e.getVaryingFromNode(this,this.name),t.needsInterpolation=!0):t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}const iv=(e,t)=>_g(new rv(e,t)),ov=(e,t)=>_g(new rv(e,t,!0)),sv=Eg(rv,"vec4","DiffuseColor"),av=Eg(rv,"vec3","EmissiveColor"),uv=Eg(rv,"float","Roughness"),cv=Eg(rv,"float","Metalness"),lv=Eg(rv,"float","Clearcoat"),hv=Eg(rv,"float","ClearcoatRoughness"),dv=Eg(rv,"vec3","Sheen"),fv=Eg(rv,"float","SheenRoughness"),pv=Eg(rv,"float","Iridescence"),mv=Eg(rv,"float","IridescenceIOR"),gv=Eg(rv,"float","IridescenceThickness"),vv=Eg(rv,"float","AlphaT"),yv=Eg(rv,"float","Anisotropy"),bv=Eg(rv,"vec3","AnisotropyT"),_v=Eg(rv,"vec3","AnisotropyB"),xv=Eg(rv,"color","SpecularColor"),wv=Eg(rv,"float","SpecularF90"),Sv=Eg(rv,"float","Shininess"),Ev=Eg(rv,"vec4","Output"),Tv=Eg(rv,"float","dashSize"),Mv=Eg(rv,"float","gapSize"),Av=Eg(rv,"float","IOR"),Cv=Eg(rv,"float","Transmission"),Ov=Eg(rv,"float","Thickness"),Pv=Eg(rv,"float","AttenuationDistance"),Rv=Eg(rv,"color","AttenuationColor"),Nv=Eg(rv,"float","Dispersion");class Iv extends Fm{static get type(){return"AssignNode"}constructor(e,t){super(),this.targetNode=e,this.sourceNode=t}hasDependencies(){return!1}getNodeType(e,t){return"void"!==t?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:t}=this;if(!1===e.isAvailable("swizzleAssign")&&t.isSplitNode&&t.components.length>1){const n=e.getTypeLength(t.node.getNodeType(e));return Im.join("").slice(0,n)!==t.components}return!1}generate(e,t){const{targetNode:n,sourceNode:r}=this,i=this.needsSplitAssign(e),o=n.getNodeType(e),s=n.context({assign:!0}).build(e),a=r.build(e,o),u=r.getNodeType(e),c=e.getDataFromNode(this);let l;if(!0===c.initialized)"void"!==t&&(l=s);else if(i){const r=e.getVarFromNode(this,null,o),i=e.getPropertyName(r);e.addLineFlowCode(`${i} = ${a}`,this);const u=n.node.context({assign:!0}).build(e);for(let t=0;t<n.components.length;t++){const r=n.components[t];e.addLineFlowCode(`${u}.${r} = ${i}[ ${t} ]`,this)}"void"!==t&&(l=s)}else l=`${s} = ${a}`,"void"!==t&&"void"!==u||(e.addLineFlowCode(l,this),"void"!==t&&(l=s));return c.initialized=!0,e.format(l,o,t)}}Zm("assign",Sg(Iv));class kv extends Fm{static get type(){return"FunctionCallNode"}constructor(e=null,t={}){super(),this.functionNode=e,this.parameters=t}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}generate(e){const t=[],n=this.functionNode,r=n.getInputs(e),i=this.parameters,o=(t,n)=>{const r=n.type;let i;return i="pointer"===r?"&"+t.build(e):t.build(e,r),i};if(Array.isArray(i))for(let e=0;e<i.length;e++)t.push(o(i[e],r[e]));else for(const e of r){const n=i[e.name];if(void 0===n)throw new Error(`FunctionCallNode: Input '${e.name}' not found in FunctionNode.`);t.push(o(n,e))}return`${n.build(e,"property")}( ${t.join(", ")} )`}}Zm("call",((e,...t)=>(t=t.length>1||t[0]&&!0===t[0].isNode?wg(t):xg(t[0]),_g(new kv(_g(e),t)))));class Dv extends Fm{static get type(){return"OperatorNode"}constructor(e,t,n,...r){if(super(),r.length>0){let i=new Dv(e,t,n);for(let t=0;t<r.length-1;t++)i=new Dv(e,i,r[t]);t=i,n=r[r.length-1]}this.op=e,this.aNode=t,this.bNode=n}getNodeType(e,t){const n=this.op,r=this.aNode,i=this.bNode,o=r.getNodeType(e),s=void 0!==i?i.getNodeType(e):null;if("void"===o||"void"===s)return"void";if("%"===n)return o;if("~"===n||"&"===n||"|"===n||"^"===n||">>"===n||"<<"===n)return e.getIntegerType(o);if("!"===n||"=="===n||"&&"===n||"||"===n||"^^"===n)return"bool";if("<"===n||">"===n||"<="===n||">="===n){const n=t?e.getTypeLength(t):Math.max(e.getTypeLength(o),e.getTypeLength(s));return n>1?`bvec${n}`:"bool"}return"float"===o&&e.isMatrix(s)?s:e.isMatrix(o)&&e.isVector(s)?e.getVectorFromMatrix(o):e.isVector(o)&&e.isMatrix(s)?e.getVectorFromMatrix(s):e.getTypeLength(s)>e.getTypeLength(o)?s:o}generate(e,t){const n=this.op,r=this.aNode,i=this.bNode,o=this.getNodeType(e,t);let s=null,a=null;"void"!==o?(s=r.getNodeType(e),a=void 0!==i?i.getNodeType(e):null,"<"===n||">"===n||"<="===n||">="===n||"=="===n?e.isVector(s)?a=s:s!==a&&(s=a="float"):">>"===n||"<<"===n?(s=o,a=e.changeComponentType(a,"uint")):e.isMatrix(s)&&e.isVector(a)?a=e.getVectorFromMatrix(s):s=e.isVector(s)&&e.isMatrix(a)?e.getVectorFromMatrix(a):a=o):s=a=o;const u=r.build(e,s),c=void 0!==i?i.build(e,a):null,l=e.getTypeLength(t),h=e.getFunctionOperator(n);return"void"!==t?"<"===n&&l>1?e.useComparisonMethod?e.format(`${e.getMethod("lessThan",t)}( ${u}, ${c} )`,o,t):e.format(`( ${u} < ${c} )`,o,t):"<="===n&&l>1?e.useComparisonMethod?e.format(`${e.getMethod("lessThanEqual",t)}( ${u}, ${c} )`,o,t):e.format(`( ${u} <= ${c} )`,o,t):">"===n&&l>1?e.useComparisonMethod?e.format(`${e.getMethod("greaterThan",t)}( ${u}, ${c} )`,o,t):e.format(`( ${u} > ${c} )`,o,t):">="===n&&l>1?e.useComparisonMethod?e.format(`${e.getMethod("greaterThanEqual",t)}( ${u}, ${c} )`,o,t):e.format(`( ${u} >= ${c} )`,o,t):"!"===n||"~"===n?e.format(`(${n}${u})`,s,t):h?e.format(`${h}( ${u}, ${c} )`,o,t):e.format(`( ${u} ${n} ${c} )`,o,t):"void"!==s?h?e.format(`${h}( ${u}, ${c} )`,o,t):e.format(`${u} ${n} ${c}`,o,t):void 0}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const Lv=Sg(Dv,"+"),Uv=Sg(Dv,"-"),Fv=Sg(Dv,"*"),Bv=Sg(Dv,"/"),zv=Sg(Dv,"%"),jv=Sg(Dv,"=="),Vv=Sg(Dv,"!="),Gv=Sg(Dv,"<"),Hv=Sg(Dv,">"),Wv=Sg(Dv,"<="),qv=Sg(Dv,">="),Xv=Sg(Dv,"&&"),Zv=Sg(Dv,"||"),$v=Sg(Dv,"!"),Yv=Sg(Dv,"^^"),Kv=Sg(Dv,"&"),Qv=Sg(Dv,"~"),Jv=Sg(Dv,"|"),ey=Sg(Dv,"^"),ty=Sg(Dv,"<<"),ny=Sg(Dv,">>");Zm("add",Lv),Zm("sub",Uv),Zm("mul",Fv),Zm("div",Bv),Zm("modInt",zv),Zm("equal",jv),Zm("notEqual",Vv),Zm("lessThan",Gv),Zm("greaterThan",Hv),Zm("lessThanEqual",Wv),Zm("greaterThanEqual",qv),Zm("and",Xv),Zm("or",Zv),Zm("not",$v),Zm("xor",Yv),Zm("bitAnd",Kv),Zm("bitNot",Qv),Zm("bitOr",Jv),Zm("bitXor",ey),Zm("shiftLeft",ty),Zm("shiftRight",ny);Zm("remainder",((...e)=>(console.warn("TSL.OperatorNode: .remainder() has been renamed to .modInt()."),zv(...e))));class ry extends Fm{static get type(){return"MathNode"}constructor(e,t,n=null,r=null){super(),this.method=e,this.aNode=t,this.bNode=n,this.cNode=r}getInputType(e){const t=this.aNode.getNodeType(e),n=this.bNode?this.bNode.getNodeType(e):null,r=this.cNode?this.cNode.getNodeType(e):null,i=e.isMatrix(t)?0:e.getTypeLength(t),o=e.isMatrix(n)?0:e.getTypeLength(n),s=e.isMatrix(r)?0:e.getTypeLength(r);return i>o&&i>s?t:o>s?n:s>i?r:t}getNodeType(e){const t=this.method;return t===ry.LENGTH||t===ry.DISTANCE||t===ry.DOT?"float":t===ry.CROSS?"vec3":t===ry.ALL?"bool":t===ry.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):t===ry.MOD?this.aNode.getNodeType(e):this.getInputType(e)}generate(e,t){const n=this.method,r=this.getNodeType(e),i=this.getInputType(e),o=this.aNode,s=this.bNode,a=this.cNode,u=!0===e.renderer.isWebGLRenderer;if(n===ry.TRANSFORM_DIRECTION){let n=o,r=s;e.isMatrix(n.getNodeType(e))?r=Vg(Fg(r),0):n=Vg(Fg(n),0);const i=Fv(n,r).xyz;return by(i).build(e,t)}if(n===ry.NEGATE)return e.format("( - "+o.build(e,i)+" )",r,t);if(n===ry.ONE_MINUS)return Uv(1,o).build(e,t);if(n===ry.RECIPROCAL)return Bv(1,o).build(e,t);if(n===ry.DIFFERENCE)return Ay(Uv(o,s)).build(e,t);{const c=[];return n===ry.CROSS||n===ry.MOD?c.push(o.build(e,r),s.build(e,r)):u&&n===ry.STEP?c.push(o.build(e,1===e.getTypeLength(o.getNodeType(e))?"float":i),s.build(e,i)):u&&(n===ry.MIN||n===ry.MAX)||n===ry.MOD?c.push(o.build(e,i),s.build(e,1===e.getTypeLength(s.getNodeType(e))?"float":i)):n===ry.REFRACT?c.push(o.build(e,i),s.build(e,i),a.build(e,"float")):n===ry.MIX?c.push(o.build(e,i),s.build(e,i),a.build(e,1===e.getTypeLength(a.getNodeType(e))?"float":i)):(c.push(o.build(e,i)),null!==s&&c.push(s.build(e,i)),null!==a&&c.push(a.build(e,i))),e.format(`${e.getMethod(n,r)}( ${c.join(", ")} )`,r,t)}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}ry.ALL="all",ry.ANY="any",ry.EQUALS="equals",ry.RADIANS="radians",ry.DEGREES="degrees",ry.EXP="exp",ry.EXP2="exp2",ry.LOG="log",ry.LOG2="log2",ry.SQRT="sqrt",ry.INVERSE_SQRT="inversesqrt",ry.FLOOR="floor",ry.CEIL="ceil",ry.NORMALIZE="normalize",ry.FRACT="fract",ry.SIN="sin",ry.COS="cos",ry.TAN="tan",ry.ASIN="asin",ry.ACOS="acos",ry.ATAN="atan",ry.ABS="abs",ry.SIGN="sign",ry.LENGTH="length",ry.NEGATE="negate",ry.ONE_MINUS="oneMinus",ry.DFDX="dFdx",ry.DFDY="dFdy",ry.ROUND="round",ry.RECIPROCAL="reciprocal",ry.TRUNC="trunc",ry.FWIDTH="fwidth",ry.BITCAST="bitcast",ry.TRANSPOSE="transpose",ry.ATAN2="atan2",ry.MIN="min",ry.MAX="max",ry.MOD="mod",ry.STEP="step",ry.REFLECT="reflect",ry.DISTANCE="distance",ry.DIFFERENCE="difference",ry.DOT="dot",ry.CROSS="cross",ry.POW="pow",ry.TRANSFORM_DIRECTION="transformDirection",ry.MIX="mix",ry.CLAMP="clamp",ry.REFRACT="refract",ry.SMOOTHSTEP="smoothstep",ry.FACEFORWARD="faceforward";const iy=Pg(1e-6),oy=Pg(Math.PI),sy=(Math.PI,Sg(ry,ry.ALL)),ay=Sg(ry,ry.ANY),uy=Sg(ry,ry.EQUALS),cy=Sg(ry,ry.RADIANS),ly=Sg(ry,ry.DEGREES),hy=Sg(ry,ry.EXP),dy=Sg(ry,ry.EXP2),fy=Sg(ry,ry.LOG),py=Sg(ry,ry.LOG2),my=Sg(ry,ry.SQRT),gy=Sg(ry,ry.INVERSE_SQRT),vy=Sg(ry,ry.FLOOR),yy=Sg(ry,ry.CEIL),by=Sg(ry,ry.NORMALIZE),_y=Sg(ry,ry.FRACT),xy=Sg(ry,ry.SIN),wy=Sg(ry,ry.COS),Sy=Sg(ry,ry.TAN),Ey=Sg(ry,ry.ASIN),Ty=Sg(ry,ry.ACOS),My=Sg(ry,ry.ATAN),Ay=Sg(ry,ry.ABS),Cy=Sg(ry,ry.SIGN),Oy=Sg(ry,ry.LENGTH),Py=Sg(ry,ry.NEGATE),Ry=Sg(ry,ry.ONE_MINUS),Ny=Sg(ry,ry.DFDX),Iy=Sg(ry,ry.DFDY),ky=Sg(ry,ry.ROUND),Dy=Sg(ry,ry.RECIPROCAL),Ly=Sg(ry,ry.TRUNC),Uy=Sg(ry,ry.FWIDTH),Fy=(ry.BITCAST,Sg(ry,ry.TRANSPOSE)),By=Sg(ry,ry.ATAN2),zy=Sg(ry,ry.MIN),jy=Sg(ry,ry.MAX),Vy=Sg(ry,ry.MOD),Gy=Sg(ry,ry.STEP),Hy=Sg(ry,ry.REFLECT),Wy=Sg(ry,ry.DISTANCE),qy=Sg(ry,ry.DIFFERENCE),Xy=Sg(ry,ry.DOT),Zy=Sg(ry,ry.CROSS),$y=Sg(ry,ry.POW),Yy=Sg(ry,ry.POW,2),Ky=Sg(ry,ry.POW,3),Qy=Sg(ry,ry.POW,4),Jy=Sg(ry,ry.TRANSFORM_DIRECTION),eb=e=>Xy(e,e),tb=Sg(ry,ry.MIX),nb=(e,t=0,n=1)=>_g(new ry(ry.CLAMP,_g(e),_g(t),_g(n))),rb=Sg(ry,ry.REFRACT),ib=Sg(ry,ry.SMOOTHSTEP),ob=Sg(ry,ry.FACEFORWARD),sb=Tg((([e])=>{const t=Xy(e.xy,kg(12.9898,78.233)),n=Vy(t,oy);return _y(xy(n).mul(43758.5453))}));Zm("all",sy),Zm("any",ay),Zm("equals",uy),Zm("radians",cy),Zm("degrees",ly),Zm("exp",hy),Zm("exp2",dy),Zm("log",fy),Zm("log2",py),Zm("sqrt",my),Zm("inverseSqrt",gy),Zm("floor",vy),Zm("ceil",yy),Zm("normalize",by),Zm("fract",_y),Zm("sin",xy),Zm("cos",wy),Zm("tan",Sy),Zm("asin",Ey),Zm("acos",Ty),Zm("atan",My),Zm("abs",Ay),Zm("sign",Cy),Zm("length",Oy),Zm("lengthSq",eb),Zm("negate",Py),Zm("oneMinus",Ry),Zm("dFdx",Ny),Zm("dFdy",Iy),Zm("round",ky),Zm("reciprocal",Dy),Zm("trunc",Ly),Zm("fwidth",Uy),Zm("atan2",By),Zm("min",zy),Zm("max",jy),Zm("mod",Vy),Zm("step",Gy),Zm("reflect",Hy),Zm("distance",Wy),Zm("dot",Xy),Zm("cross",Zy),Zm("pow",$y),Zm("pow2",Yy),Zm("pow3",Ky),Zm("pow4",Qy),Zm("transformDirection",Jy),Zm("mix",((e,t,n)=>tb(t,n,e))),Zm("clamp",nb),Zm("refract",rb),Zm("smoothstep",((e,t,n)=>ib(t,n,e))),Zm("faceForward",ob),Zm("difference",qy),Zm("saturate",(e=>nb(e))),Zm("cbrt",(e=>Fv(Cy(e),$y(Ay(e),1/3)))),Zm("transpose",Fy),Zm("rand",sb);class ab extends Dm{static get type(){return"ConditionalNode"}constructor(e,t,n=null){super(),this.condNode=e,this.ifNode=t,this.elseNode=n}getNodeType(e){const t=this.ifNode.getNodeType(e);if(null!==this.elseNode){const n=this.elseNode.getNodeType(e);if(e.getTypeLength(n)>e.getTypeLength(t))return n}return t}setup(e){const t=this.condNode.cache(),n=this.ifNode.cache(),r=this.elseNode?this.elseNode.cache():null,i=e.context.nodeBlock;e.getDataFromNode(n).parentNodeBlock=i,null!==r&&(e.getDataFromNode(r).parentNodeBlock=i);const o=e.getNodeProperties(this);o.condNode=t,o.ifNode=n.context({nodeBlock:n}),o.elseNode=r?r.context({nodeBlock:r}):null}generate(e,t){const n=this.getNodeType(e),r=e.getDataFromNode(this);if(void 0!==r.nodeProperty)return r.nodeProperty;const{condNode:i,ifNode:o,elseNode:s}=e.getNodeProperties(this),a="void"!==t,u=a?iv(n).build(e):"";r.nodeProperty=u;const c=i.build(e,"bool");e.addFlowCode(`\n${e.tab}if ( ${c} ) {\n\n`).addFlowTab();let l=o.build(e,n);if(l&&(l=a?u+" = "+l+";":"return "+l+";"),e.removeFlowTab().addFlowCode(e.tab+"\t"+l+"\n\n"+e.tab+"}"),null!==s){e.addFlowCode(" else {\n\n").addFlowTab();let t=s.build(e,n);t&&(t=a?u+" = "+t+";":"return "+t+";"),e.removeFlowTab().addFlowCode(e.tab+"\t"+t+"\n\n"+e.tab+"}\n\n")}else e.addFlowCode("\n\n");return e.format(u,n,t)}}const ub=Sg(ab);Zm("select",ub);Zm("cond",((...e)=>(console.warn("TSL.ConditionalNode: cond() has been renamed to select()."),ub(...e))));class cb extends Dm{static get type(){return"ContextNode"}constructor(e,t={}){super(),this.isContextNode=!0,this.node=e,this.value=t}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}analyze(e){this.node.build(e)}setup(e){const t=e.getContext();e.setContext({...e.context,...this.value});const n=this.node.build(e);return e.setContext(t),n}generate(e,t){const n=e.getContext();e.setContext({...e.context,...this.value});const r=this.node.build(e,t);return e.setContext(n),r}}const lb=Sg(cb);Zm("context",lb),Zm("label",((e,t)=>lb(e,{label:t})));class hb extends Dm{static get type(){return"VarNode"}constructor(e,t=null){super(),this.node=e,this.name=t,this.global=!0,this.isVarNode=!0}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}generate(e){const{node:t,name:n}=this,r=e.getVarFromNode(this,n,e.getVectorType(this.getNodeType(e))),i=e.getPropertyName(r),o=t.build(e,r.type);return e.addLineFlowCode(`${i} = ${o}`,this),i}}const db=Sg(hb);Zm("toVar",((...e)=>db(...e).append()));Zm("temp",(e=>(console.warn('TSL: "temp" is deprecated. Use ".toVar()" instead.'),db(e))));class fb extends Dm{static get type(){return"VaryingNode"}constructor(e,t=null){super(),this.node=e,this.name=t,this.isVaryingNode=!0}isGlobal(){return!0}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const t=e.getNodeProperties(this);let n=t.varying;if(void 0===n){const r=this.name,i=this.getNodeType(e);t.varying=n=e.getVaryingFromNode(this,r,i),t.node=this.node}return n.needsInterpolation||(n.needsInterpolation="fragment"===e.shaderStage),n}setup(e){this.setupVarying(e)}analyze(e){return this.setupVarying(e),this.node.analyze(e)}generate(e){const t=e.getNodeProperties(this),n=this.setupVarying(e);if(void 0===t.propertyName){const r=this.getNodeType(e),i=e.getPropertyName(n,Mm);e.flowNodeFromShaderStage(Mm,this.node,r,i),t.propertyName=i}return e.getPropertyName(n)}}const pb=Sg(fb);Zm("varying",pb);const mb=Tg((([e])=>{const t=e.mul(.9478672986).add(.0521327014).pow(2.4),n=e.mul(.0773993808),r=e.lessThanEqual(.04045);return tb(t,n,r)})).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),gb=Tg((([e])=>{const t=e.pow(.41666).mul(1.055).sub(.055),n=e.mul(12.92),r=e.lessThanEqual(.0031308);return tb(t,n,r)})).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),vb="WorkingColorSpace",yb="OutputColorSpace";class bb extends Fm{static get type(){return"ColorSpaceNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this.source=t,this.target=n}resolveColorSpace(e,t){return t===vb?hh.workingColorSpace:t===yb?e.context.outputColorSpace||e.renderer.outputColorSpace:t}setup(e){const{colorNode:t}=this,n=this.resolveColorSpace(e,this.source),r=this.resolveColorSpace(e,this.target);let i=t;return!1!==hh.enabled&&n!==r&&n&&r?(hh.getTransfer(n)===Vl&&(i=Vg(mb(i.rgb),i.a)),hh.getPrimaries(n)!==hh.getPrimaries(r)&&(i=Vg(Xg(hh._getMatrix(new ah,n,r)).mul(i.rgb),i.a)),hh.getTransfer(r)===Vl&&(i=Vg(gb(i.rgb),i.a)),i):i}}const _b=(e,t)=>_g(new bb(_g(e),t,vb));Zm("toOutputColorSpace",(e=>_g(new bb(_g(e),vb,yb)))),Zm("toWorkingColorSpace",(e=>_g(new bb(_g(e),yb,vb)))),Zm("workingToColorSpace",((e,t)=>_g(new bb(_g(e),vb,t)))),Zm("colorSpaceToWorking",_b);let xb=class extends Lm{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,n,r)}};class wb extends Dm{static get type(){return"ReferenceBaseNode"}constructor(e,t,n=null,r=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=r,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.updateType=Pm}setGroup(e){return this.group=e,this}element(e){return _g(new xb(this,_g(e)))}setNodeType(e){const t=nv(null,e).getSelf();null!==this.group&&t.setGroup(this.group),this.node=t}getNodeType(e){return null===this.node&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let e=1;e<t.length;e++)n=n[t[e]];return n}updateReference(e){return this.reference=null!==this.object?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){null===this.node&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}class Sb extends wb{static get type(){return"RendererReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.renderer=n,this.setGroup(Jg)}updateReference(e){return this.reference=null!==this.renderer?this.renderer:e.renderer,this.reference}}const Eb=(e,t,n)=>_g(new Sb(e,t,n));class Tb extends Fm{static get type(){return"ToneMappingNode"}constructor(e,t=Mb,n=null){super("vec3"),this.toneMapping=e,this.exposureNode=t,this.colorNode=n}getCacheKey(){return bm(super.getCacheKey(),this.toneMapping)}setup(e){const t=this.colorNode||e.context.color,n=this.toneMapping;if(0===n)return t;let r=null;const i=e.renderer.library.getToneMappingFunction(n);return null!==i?r=Vg(i(t.rgb,this.exposureNode),t.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",n),r=t),r}}const Mb=Eb("toneMappingExposure","float");Zm("toneMapping",((e,t,n)=>((e,t,n)=>_g(new Tb(e,_g(t),_g(n))))(t,n,e)));class Ab extends Hm{static get type(){return"BufferAttributeNode"}constructor(e,t=null,n=0,r=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=n,this.bufferOffset=r,this.usage=Hl,this.instanced=!1,this.attribute=null,this.global=!0,e&&!0===e.isBufferAttribute&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(0===this.bufferStride&&0===this.bufferOffset){let t=e.globalCache.getData(this.value);return void 0===t&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getNodeType(e){return null===this.bufferType&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(null!==this.attribute)return;const t=this.getNodeType(e),n=this.value,r=e.getTypeLength(t),i=this.bufferStride||r,o=this.bufferOffset,s=!0===n.isInterleavedBuffer?n:new Yf(n,i),a=new Qf(s,r,o);s.setUsage(this.usage),this.attribute=a,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const t=this.getNodeType(e),n=e.getBufferAttributeFromNode(this,t),r=e.getPropertyName(n);let i=null;if("vertex"===e.shaderStage||"compute"===e.shaderStage)this.name=r,i=r;else{i=pb(this).build(e,t)}return i}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&!0===this.attribute.isBufferAttribute&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}const Cb=(e,t,n,r)=>_g(new Ab(e,t,n,r)),Ob=(e,t,n,r)=>Cb(e,t,n,r).setInstanced(!0),Pb=(e,t,n,r)=>((e,t,n,r)=>Cb(e,t,n,r).setUsage(Wl))(e,t,n,r).setInstanced(!0);Zm("toAttribute",(e=>Cb(e.value)));class Rb extends Dm{static get type(){return"ComputeNode"}constructor(e,t,n=[64]){super("void"),this.isComputeNode=!0,this.computeNode=e,this.count=t,this.workgroupSize=n,this.dispatchCount=0,this.version=1,this.updateBeforeType=Pm,this.onInitFunction=null,this.updateDispatchCount()}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}updateDispatchCount(){const{count:e,workgroupSize:t}=this;let n=t[0];for(let e=1;e<t.length;e++)n*=t[e];this.dispatchCount=Math.ceil(e/n)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}generate(e){const{shaderStage:t}=e;if("compute"===t){const t=this.computeNode.build(e,"void");""!==t&&e.addLineFlowCode(t,this)}}}Zm("compute",((e,t,n)=>_g(new Rb(_g(e),t,n))));class Nb extends Dm{static get type(){return"CacheNode"}constructor(e,t=!0){super(),this.node=e,this.parent=t,this.isCacheNode=!0}getNodeType(e){return this.node.getNodeType(e)}build(e,...t){const n=e.getCache(),r=e.getCacheFromNode(this,this.parent);e.setCache(r);const i=this.node.build(e,...t);return e.setCache(n),i}}const Ib=(e,...t)=>_g(new Nb(_g(e),...t));Zm("cache",Ib);class kb extends Dm{static get type(){return"BypassNode"}constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const t=this.callNode.build(e,"void");return""!==t&&e.addLineFlowCode(t,this),this.outputNode.build(e)}}Zm("bypass",Sg(kb));class Db extends Dm{static get type(){return"RemapNode"}constructor(e,t,n,r=Pg(0),i=Pg(1)){super(),this.node=e,this.inLowNode=t,this.inHighNode=n,this.outLowNode=r,this.outHighNode=i,this.doClamp=!0}setup(){const{node:e,inLowNode:t,inHighNode:n,outLowNode:r,outHighNode:i,doClamp:o}=this;let s=e.sub(t).div(n.sub(t));return!0===o&&(s=s.clamp()),s.mul(i.sub(r)).add(r)}}const Lb=Sg(Db,null,null,{doClamp:!1}),Ub=Sg(Db);Zm("remap",Lb),Zm("remapClamp",Ub);class Fb extends Dm{static get type(){return"ExpressionNode"}constructor(e="",t="void"){super(t),this.snippet=e}generate(e,t){const n=this.getNodeType(e),r=this.snippet;if("void"!==n)return e.format(`( ${r} )`,n,t);e.addLineFlowCode(r,this)}}const Bb=Sg(Fb);Zm("discard",(e=>(e?ub(e,Bb("discard")):Bb("discard")).append()));class zb extends Fm{static get type(){return"RenderOutputNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this.toneMapping=t,this.outputColorSpace=n,this.isRenderOutput=!0}setup({context:e}){let t=this.colorNode||e.color;const n=(null!==this.toneMapping?this.toneMapping:e.toneMapping)||0,r=(null!==this.outputColorSpace?this.outputColorSpace:e.outputColorSpace)||Fl;return 0!==n&&(t=t.toneMapping(n)),r!==Fl&&r!==hh.workingColorSpace&&(t=t.workingToColorSpace(r)),t}}const jb=(e,t=null,n=null)=>_g(new zb(_g(e),t,n));Zm("renderOutput",jb);class Vb extends Dm{static get type(){return"AttributeNode"}constructor(e,t=null){super(t),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=this.nodeType;if(null===t){const n=this.getAttributeName(e);if(e.hasGeometryAttribute(n)){const r=e.geometry.getAttribute(n);t=e.getTypeFromAttribute(r)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const t=this.getAttributeName(e),n=this.getNodeType(e);if(!0===e.hasGeometryAttribute(t)){const r=e.geometry.getAttribute(t),i=e.getTypeFromAttribute(r),o=e.getAttribute(t,i);if("vertex"===e.shaderStage)return e.format(o.name,i,n);return pb(this).build(e,n)}return console.warn(`AttributeNode: Vertex attribute "${t}" not found on geometry.`),e.generateConst(n)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const Gb=(e,t)=>_g(new Vb(e,t)),Hb=e=>Gb("uv"+(e>0?e:""),"vec2");class Wb extends Dm{static get type(){return"TextureSizeNode"}constructor(e,t=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}generate(e,t){const n=this.textureNode.build(e,"property"),r=null===this.levelNode?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${n}, ${r} )`,this.getNodeType(e),t)}}const qb=Sg(Wb);class Xb extends tv{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=Cm}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,t=e.images,n=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(n&&void 0!==n.width){const{width:e,height:t}=n;this.value=Math.log2(Math.max(e,t))}}}const Zb=Sg(Xb);class $b extends tv{static get type(){return"TextureNode"}constructor(e,t=null,n=null,r=null){super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=n,this.biasNode=r,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=Am,this.referenceNode=null,this._value=e,this._matrixUniform=null,this.setUpdateMatrix(null===t)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return!0===this.value.isDepthTexture?"float":this.value.type===Qc?"uvec4":this.value.type===Kc?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return Hb(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return null===this._matrixUniform&&(this._matrixUniform=nv(this.value.matrix)),this._matrixUniform.mul(Fg(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?Cm:Am,this}setupUV(e,t){const n=this.value;return!e.isFlipY()||!0!==n.isRenderTargetTexture&&!0!==n.isFramebufferTexture&&!0!==n.isDepthTexture||(t=this.sampler?t.flipY():t.setY(Rg(qb(this,this.levelNode).y).sub(t.y).sub(1))),t}setup(e){const t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;let n=this.uvNode;null!==n&&!0!==e.context.forceUVContext||!e.context.getUV||(n=e.context.getUV(this)),n||(n=this.getDefaultUV()),!0===this.updateMatrix&&(n=this.getTransformedUV(n)),n=this.setupUV(e,n);let r=this.levelNode;null===r&&e.context.getTextureLevel&&(r=e.context.getTextureLevel(this)),t.uvNode=n,t.levelNode=r,t.biasNode=this.biasNode,t.compareNode=this.compareNode,t.gradNode=this.gradNode,t.depthNode=this.depthNode}generateUV(e,t){return t.build(e,!0===this.sampler?"vec2":"ivec2")}generateSnippet(e,t,n,r,i,o,s,a){const u=this.value;let c;return c=r?e.generateTextureLevel(u,t,n,r,o):i?e.generateTextureBias(u,t,n,i,o):a?e.generateTextureGrad(u,t,n,a,o):s?e.generateTextureCompare(u,t,n,s,o):!1===this.sampler?e.generateTextureLoad(u,t,n,o):e.generateTexture(u,t,n,o),c}generate(e,t){const n=e.getNodeProperties(this),r=this.value;if(!r||!0!==r.isTexture)throw new Error("TextureNode: Need a three.js texture.");const i=super.generate(e,"property");if("sampler"===t)return i+"_sampler";if(e.isReference(t))return i;{const o=e.getDataFromNode(this);let s=o.propertyName;if(void 0===s){const{uvNode:t,levelNode:r,biasNode:a,compareNode:u,depthNode:c,gradNode:l}=n,h=this.generateUV(e,t),d=r?r.build(e,"float"):null,f=a?a.build(e,"float"):null,p=c?c.build(e,"int"):null,m=u?u.build(e,"float"):null,g=l?[l[0].build(e,"vec2"),l[1].build(e,"vec2")]:null,v=e.getVarFromNode(this);s=e.getPropertyName(v);const y=this.generateSnippet(e,i,h,d,f,p,m,g);e.addLineFlowCode(`${s} = ${y}`,this),o.snippet=y,o.propertyName=s}let a=s;const u=this.getNodeType(e);return e.needsToWorkingColorSpace(r)&&(a=_b(Bb(a,u),r.colorSpace).setup(e).build(e,u)),e.format(a,u,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){const t=this.clone();return t.uvNode=_g(e),t.referenceNode=this.getSelf(),_g(t)}blur(e){const t=this.clone();return t.biasNode=_g(e).mul(Zb(t)),t.referenceNode=this.getSelf(),_g(t)}level(e){const t=this.clone();return t.levelNode=_g(e),t.referenceNode=this.getSelf(),_g(t)}size(e){return qb(this,e)}bias(e){const t=this.clone();return t.biasNode=_g(e),t.referenceNode=this.getSelf(),_g(t)}compare(e){const t=this.clone();return t.compareNode=_g(e),t.referenceNode=this.getSelf(),_g(t)}grad(e,t){const n=this.clone();return n.gradNode=[_g(e),_g(t)],n.referenceNode=this.getSelf(),_g(n)}depth(e){const t=this.clone();return t.depthNode=_g(e),t.referenceNode=this.getSelf(),_g(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,t=this._matrixUniform;null!==t&&(t.value=e.matrix),!0===e.matrixAutoUpdate&&e.updateMatrix()}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e}}const Yb=Sg($b),Kb=(...e)=>Yb(...e).setSampler(!1),Qb=nv("float").label("cameraNear").setGroup(Jg).onRenderUpdate((({camera:e})=>e.near)),Jb=nv("float").label("cameraFar").setGroup(Jg).onRenderUpdate((({camera:e})=>e.far)),e_=nv("mat4").label("cameraProjectionMatrix").setGroup(Jg).onRenderUpdate((({camera:e})=>e.projectionMatrix)),t_=nv("mat4").label("cameraViewMatrix").setGroup(Jg).onRenderUpdate((({camera:e})=>e.matrixWorldInverse)),n_=nv(new Rh).label("cameraPosition").setGroup(Jg).onRenderUpdate((({camera:e},t)=>t.value.setFromMatrixPosition(e.matrixWorld)));class r_ extends Dm{static get type(){return"Object3DNode"}constructor(e,t=null){super(),this.scope=e,this.object3d=t,this.updateType=Pm,this._uniformNode=new tv(null)}getNodeType(){const e=this.scope;return e===r_.WORLD_MATRIX?"mat4":e===r_.POSITION||e===r_.VIEW_POSITION||e===r_.DIRECTION||e===r_.SCALE?"vec3":void 0}update(e){const t=this.object3d,n=this._uniformNode,r=this.scope;if(r===r_.WORLD_MATRIX)n.value=t.matrixWorld;else if(r===r_.POSITION)n.value=n.value||new Rh,n.value.setFromMatrixPosition(t.matrixWorld);else if(r===r_.SCALE)n.value=n.value||new Rh,n.value.setFromMatrixScale(t.matrixWorld);else if(r===r_.DIRECTION)n.value=n.value||new Rh,t.getWorldDirection(n.value);else if(r===r_.VIEW_POSITION){const r=e.camera;n.value=n.value||new Rh,n.value.setFromMatrixPosition(t.matrixWorld),n.value.applyMatrix4(r.matrixWorldInverse)}}generate(e){const t=this.scope;return t===r_.WORLD_MATRIX?this._uniformNode.nodeType="mat4":t!==r_.POSITION&&t!==r_.VIEW_POSITION&&t!==r_.DIRECTION&&t!==r_.SCALE||(this._uniformNode.nodeType="vec3"),this._uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}r_.WORLD_MATRIX="worldMatrix",r_.POSITION="position",r_.SCALE="scale",r_.VIEW_POSITION="viewPosition",r_.DIRECTION="direction";r_.DIRECTION,r_.WORLD_MATRIX,r_.POSITION,r_.SCALE,r_.VIEW_POSITION;class i_ extends r_{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}const o_=Eg(i_,i_.WORLD_MATRIX),s_=nv(new ah).onObjectUpdate((({object:e},t)=>t.value.getNormalMatrix(e.matrixWorld))),a_=t_.mul(o_).toVar("modelViewMatrix"),u_=Gb("position","vec3"),c_=u_.varying("positionLocal"),l_=u_.varying("positionPrevious"),h_=o_.mul(c_).xyz.varying("v_positionWorld"),d_=c_.transformDirection(o_).varying("v_positionWorldDirection").normalize().toVar("positionWorldDirection"),f_=a_.mul(c_).xyz.varying("v_positionView"),p_=f_.negate().varying("v_positionViewDirection").normalize().toVar("positionViewDirection");class m_ extends Dm{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){const{renderer:t,material:n}=e;return t.coordinateSystem===ql&&1===n.side?"false":e.getFrontFacing()}}const g_=Pg(Eg(m_)).mul(2).sub(1),v_=Gb("normal","vec3"),y_=Tg((e=>!1===e.geometry.hasAttribute("normal")?(console.warn('TSL.NormalNode: Vertex attribute "normal" not found on geometry.'),Fg(0,1,0)):v_),"vec3").once()().toVar("normalLocal"),b_=f_.dFdx().cross(f_.dFdy()).normalize().toVar("normalFlat"),__=Tg((e=>{let t;return t=!0===e.material.flatShading?b_:pb(M_(y_),"v_normalView").normalize(),t}),"vec3").once()().toVar("normalView"),x_=pb(__.transformDirection(t_),"v_normalWorld").normalize().toVar("normalWorld"),w_=Tg((e=>e.context.setupNormal()),"vec3").once()().mul(g_).toVar("transformedNormalView"),S_=w_.transformDirection(t_).toVar("transformedNormalWorld"),E_=Tg((e=>e.context.setupClearcoatNormal()),"vec3").once()().mul(g_).toVar("transformedClearcoatNormalView"),T_=Tg((([e,t=o_])=>{const n=Xg(t),r=e.div(Fg(n[0].dot(n[0]),n[1].dot(n[1]),n[2].dot(n[2])));return n.mul(r).xyz})),M_=Tg((([e],t)=>{const n=t.renderer.nodes.modelNormalViewMatrix;if(null!==n)return n.transformDirection(e);const r=s_.mul(e);return t_.transformDirection(r)})),A_=nv(0).onReference((({material:e})=>e)).onRenderUpdate((({material:e})=>e.refractionRatio)),C_=p_.negate().reflect(w_),O_=p_.negate().refract(w_,A_),P_=C_.transformDirection(t_).toVar("reflectVector"),R_=O_.transformDirection(t_).toVar("reflectVector");class N_ extends $b{static get type(){return"CubeTextureNode"}constructor(e,t=null,n=null,r=null){super(e,t,n,r),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===Ic?P_:e.mapping===kc?R_:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',e.mapping),Fg(0,0,0))}setUpdateMatrix(){}setupUV(e,t){const n=this.value;return e.renderer.coordinateSystem!==Xl&&n.isRenderTargetTexture?t:Fg(t.x.negate(),t.yz)}generateUV(e,t){return t.build(e,"vec3")}}const I_=Sg(N_);class k_ extends tv{static get type(){return"BufferNode"}constructor(e,t,n=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=n}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const D_=(e,t,n)=>_g(new k_(e,t,n));class L_ extends Lm{static get type(){return"UniformArrayElementNode"}constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}generate(e){const t=super.generate(e),n=this.getNodeType();return e.format(t,"vec4",n)}}class U_ extends k_{static get type(){return"UniformArrayNode"}constructor(e,t=null){super(null,"vec4"),this.array=e,this.elementType=t,this._elementType=null,this._elementLength=0,this.updateType=Om,this.isArrayBufferNode=!0}getElementType(){return this.elementType||this._elementType}getElementLength(){return this._elementLength}update(){const{array:e,value:t}=this,n=this.getElementLength(),r=this.getElementType();if(1===n)for(let n=0;n<e.length;n++){t[4*n]=e[n]}else if("color"===r)for(let n=0;n<e.length;n++){const r=4*n,i=e[n];t[r]=i.r,t[r+1]=i.g,t[r+2]=i.b||0}else for(let n=0;n<e.length;n++){const r=4*n,i=e[n];t[r]=i.x,t[r+1]=i.y,t[r+2]=i.z||0,t[r+3]=i.w||0}}setup(e){const t=this.array.length;this._elementType=null===this.elementType?wm(this.array[0]):this.elementType,this._elementLength=e.getTypeLength(this._elementType);let n=Float32Array;return"i"===this._elementType.charAt(0)?n=Int32Array:"u"===this._elementType.charAt(0)&&(n=Uint32Array),this.value=new n(4*t),this.bufferCount=t,this.bufferType=e.changeComponentType("vec4",e.getComponentType(this._elementType)),super.setup(e)}element(e){return _g(new L_(this,_g(e)))}}const F_=(e,t)=>_g(new U_(e,t));class B_ extends Lm{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,n,r)}}class z_ extends Dm{static get type(){return"ReferenceNode"}constructor(e,t,n=null,r=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=r,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.name=null,this.updateType=Pm}element(e){return _g(new B_(this,_g(e)))}setGroup(e){return this.group=e,this}label(e){return this.name=e,this}setNodeType(e){let t=null;t=null!==this.count?D_(null,e,this.count):Array.isArray(this.getValueFromReference())?F_(null,e):"texture"===e?Yb(null):"cubeTexture"===e?I_(null):nv(null,e),null!==this.group&&t.setGroup(this.group),null!==this.name&&t.label(this.name),this.node=t.getSelf()}getNodeType(e){return null===this.node&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let e=1;e<t.length;e++)n=n[t[e]];return n}updateReference(e){return this.reference=null!==this.object?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){null===this.node&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const j_=(e,t,n)=>_g(new z_(e,t,n)),V_=(e,t,n,r)=>_g(new z_(e,t,r,n));class G_ extends z_{static get type(){return"MaterialReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.material=n,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=null!==this.material?this.material:e.material,this.reference}}const H_=(e,t,n)=>_g(new G_(e,t,n)),W_=Tg((e=>(!1===e.geometry.hasAttribute("tangent")&&e.geometry.computeTangents(),Gb("tangent","vec4"))))(),q_=W_.xyz.toVar("tangentLocal"),X_=a_.mul(Vg(q_,0)).xyz.varying("v_tangentView").normalize().toVar("tangentView"),Z_=e=>e.mul(W_.w).xyz,$_=Xg(X_,pb(Z_(__.cross(X_)),"v_bitangentView").normalize().toVar("bitangentView"),__),Y_=(()=>{let e=_v.cross(p_);return e=e.cross(_v).normalize(),e=tb(e,w_,yv.mul(uv.oneMinus()).oneMinus().pow2().pow2()).normalize(),e})(),K_=Tg((e=>{const{eye_pos:t,surf_norm:n,mapN:r,uv:i}=e,o=t.dFdx(),s=t.dFdy(),a=i.dFdx(),u=i.dFdy(),c=n,l=s.cross(c),h=c.cross(o),d=l.mul(a.x).add(h.mul(u.x)),f=l.mul(a.y).add(h.mul(u.y)),p=d.dot(d).max(f.dot(f)),m=g_.mul(p.inverseSqrt());return Lv(d.mul(r.x,m),f.mul(r.y,m),c.mul(r.z)).normalize()}));class Q_ extends Fm{static get type(){return"NormalMapNode"}constructor(e,t=null){super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=0}setup(e){const{normalMapType:t,scaleNode:n}=this;let r=this.node.mul(2).sub(1);null!==n&&(r=Fg(r.xy.mul(n),r.z));let i=null;if(1===t)i=M_(r);else if(0===t){i=!0===e.hasGeometryAttribute("tangent")?$_.mul(r).normalize():K_({eye_pos:f_,surf_norm:__,mapN:r,uv:Hb()})}return i}}const J_=Sg(Q_),ex=Tg((({textureNode:e,bumpScale:t})=>{const n=t=>e.cache().context({getUV:e=>t(e.uvNode||Hb()),forceUVContext:!0}),r=Pg(n((e=>e)));return kg(Pg(n((e=>e.add(e.dFdx())))).sub(r),Pg(n((e=>e.add(e.dFdy())))).sub(r)).mul(t)})),tx=Tg((e=>{const{surf_pos:t,surf_norm:n,dHdxy:r}=e,i=t.dFdx().normalize(),o=n,s=t.dFdy().normalize().cross(o),a=o.cross(i),u=i.dot(s).mul(g_),c=u.sign().mul(r.x.mul(s).add(r.y.mul(a)));return u.abs().mul(n).sub(c).normalize()}));class nx extends Fm{static get type(){return"BumpMapNode"}constructor(e,t=null){super("vec3"),this.textureNode=e,this.scaleNode=t}setup(){const e=null!==this.scaleNode?this.scaleNode:1,t=ex({textureNode:this.textureNode,bumpScale:e});return tx({surf_pos:f_,surf_norm:__,dHdxy:t})}}const rx=Sg(nx),ix=new Map;class ox extends Dm{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,t){let n=ix.get(e);return void 0===n&&(n=H_(e,t),ix.set(e,n)),n}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache("map"===e?"map":e+"Map","texture")}setup(e){const t=e.context.material,n=this.scope;let r=null;if(n===ox.COLOR){const e=void 0!==t.color?this.getColor(n):Fg();r=t.map&&!0===t.map.isTexture?e.mul(this.getTexture("map")):e}else if(n===ox.OPACITY){const e=this.getFloat(n);r=t.alphaMap&&!0===t.alphaMap.isTexture?e.mul(this.getTexture("alpha")):e}else if(n===ox.SPECULAR_STRENGTH)r=t.specularMap&&!0===t.specularMap.isTexture?this.getTexture("specular").r:Pg(1);else if(n===ox.SPECULAR_INTENSITY){const e=this.getFloat(n);r=t.specularMap?e.mul(this.getTexture(n).a):e}else if(n===ox.SPECULAR_COLOR){const e=this.getColor(n);r=t.specularColorMap&&!0===t.specularColorMap.isTexture?e.mul(this.getTexture(n).rgb):e}else if(n===ox.ROUGHNESS){const e=this.getFloat(n);r=t.roughnessMap&&!0===t.roughnessMap.isTexture?e.mul(this.getTexture(n).g):e}else if(n===ox.METALNESS){const e=this.getFloat(n);r=t.metalnessMap&&!0===t.metalnessMap.isTexture?e.mul(this.getTexture(n).b):e}else if(n===ox.EMISSIVE){const e=this.getFloat("emissiveIntensity"),i=this.getColor(n).mul(e);r=t.emissiveMap&&!0===t.emissiveMap.isTexture?i.mul(this.getTexture(n)):i}else if(n===ox.NORMAL)t.normalMap?(r=J_(this.getTexture("normal"),this.getCache("normalScale","vec2")),r.normalMapType=t.normalMapType):r=t.bumpMap?rx(this.getTexture("bump").r,this.getFloat("bumpScale")):__;else if(n===ox.CLEARCOAT){const e=this.getFloat(n);r=t.clearcoatMap&&!0===t.clearcoatMap.isTexture?e.mul(this.getTexture(n).r):e}else if(n===ox.CLEARCOAT_ROUGHNESS){const e=this.getFloat(n);r=t.clearcoatRoughnessMap&&!0===t.clearcoatRoughnessMap.isTexture?e.mul(this.getTexture(n).r):e}else if(n===ox.CLEARCOAT_NORMAL)r=t.clearcoatNormalMap?J_(this.getTexture(n),this.getCache(n+"Scale","vec2")):__;else if(n===ox.SHEEN){const e=this.getColor("sheenColor").mul(this.getFloat("sheen"));r=t.sheenColorMap&&!0===t.sheenColorMap.isTexture?e.mul(this.getTexture("sheenColor").rgb):e}else if(n===ox.SHEEN_ROUGHNESS){const e=this.getFloat(n);r=t.sheenRoughnessMap&&!0===t.sheenRoughnessMap.isTexture?e.mul(this.getTexture(n).a):e,r=r.clamp(.07,1)}else if(n===ox.ANISOTROPY)if(t.anisotropyMap&&!0===t.anisotropyMap.isTexture){const e=this.getTexture(n);r=qg(zx.x,zx.y,zx.y.negate(),zx.x).mul(e.rg.mul(2).sub(kg(1)).normalize().mul(e.b))}else r=zx;else if(n===ox.IRIDESCENCE_THICKNESS){const e=j_("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){const i=j_("0","float",t.iridescenceThicknessRange);r=e.sub(i).mul(this.getTexture(n).g).add(i)}else r=e}else if(n===ox.TRANSMISSION){const e=this.getFloat(n);r=t.transmissionMap?e.mul(this.getTexture(n).r):e}else if(n===ox.THICKNESS){const e=this.getFloat(n);r=t.thicknessMap?e.mul(this.getTexture(n).g):e}else if(n===ox.IOR)r=this.getFloat(n);else if(n===ox.LIGHT_MAP)r=this.getTexture(n).rgb.mul(this.getFloat("lightMapIntensity"));else if(n===ox.AO_MAP)r=this.getTexture(n).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else{const t=this.getNodeType(e);r=this.getCache(n,t)}return r}}ox.ALPHA_TEST="alphaTest",ox.COLOR="color",ox.OPACITY="opacity",ox.SHININESS="shininess",ox.SPECULAR="specular",ox.SPECULAR_STRENGTH="specularStrength",ox.SPECULAR_INTENSITY="specularIntensity",ox.SPECULAR_COLOR="specularColor",ox.REFLECTIVITY="reflectivity",ox.ROUGHNESS="roughness",ox.METALNESS="metalness",ox.NORMAL="normal",ox.CLEARCOAT="clearcoat",ox.CLEARCOAT_ROUGHNESS="clearcoatRoughness",ox.CLEARCOAT_NORMAL="clearcoatNormal",ox.EMISSIVE="emissive",ox.ROTATION="rotation",ox.SHEEN="sheen",ox.SHEEN_ROUGHNESS="sheenRoughness",ox.ANISOTROPY="anisotropy",ox.IRIDESCENCE="iridescence",ox.IRIDESCENCE_IOR="iridescenceIOR",ox.IRIDESCENCE_THICKNESS="iridescenceThickness",ox.IOR="ior",ox.TRANSMISSION="transmission",ox.THICKNESS="thickness",ox.ATTENUATION_DISTANCE="attenuationDistance",ox.ATTENUATION_COLOR="attenuationColor",ox.LINE_SCALE="scale",ox.LINE_DASH_SIZE="dashSize",ox.LINE_GAP_SIZE="gapSize",ox.LINE_WIDTH="linewidth",ox.LINE_DASH_OFFSET="dashOffset",ox.POINT_WIDTH="pointWidth",ox.DISPERSION="dispersion",ox.LIGHT_MAP="light",ox.AO_MAP="ao";const sx=Eg(ox,ox.ALPHA_TEST),ax=Eg(ox,ox.COLOR),ux=Eg(ox,ox.SHININESS),cx=Eg(ox,ox.EMISSIVE),lx=Eg(ox,ox.OPACITY),hx=Eg(ox,ox.SPECULAR),dx=Eg(ox,ox.SPECULAR_INTENSITY),fx=Eg(ox,ox.SPECULAR_COLOR),px=Eg(ox,ox.SPECULAR_STRENGTH),mx=Eg(ox,ox.REFLECTIVITY),gx=Eg(ox,ox.ROUGHNESS),vx=Eg(ox,ox.METALNESS),yx=Eg(ox,ox.NORMAL).context({getUV:null}),bx=Eg(ox,ox.CLEARCOAT),_x=Eg(ox,ox.CLEARCOAT_ROUGHNESS),xx=Eg(ox,ox.CLEARCOAT_NORMAL).context({getUV:null}),wx=Eg(ox,ox.ROTATION),Sx=Eg(ox,ox.SHEEN),Ex=Eg(ox,ox.SHEEN_ROUGHNESS),Tx=Eg(ox,ox.ANISOTROPY),Mx=Eg(ox,ox.IRIDESCENCE),Ax=Eg(ox,ox.IRIDESCENCE_IOR),Cx=Eg(ox,ox.IRIDESCENCE_THICKNESS),Ox=Eg(ox,ox.TRANSMISSION),Px=Eg(ox,ox.THICKNESS),Rx=Eg(ox,ox.IOR),Nx=Eg(ox,ox.ATTENUATION_DISTANCE),Ix=Eg(ox,ox.ATTENUATION_COLOR),kx=Eg(ox,ox.LINE_SCALE),Dx=Eg(ox,ox.LINE_DASH_SIZE),Lx=Eg(ox,ox.LINE_GAP_SIZE),Ux=(ox.LINE_WIDTH,ox.LINE_DASH_OFFSET,ox.POINT_WIDTH,Eg(ox,ox.DISPERSION)),Fx=Eg(ox,ox.LIGHT_MAP),Bx=Eg(ox,ox.AO_MAP),zx=nv(new sh).onReference((function(e){return e.material})).onRenderUpdate((function({material:e}){this.value.set(e.anisotropy*Math.cos(e.anisotropyRotation),e.anisotropy*Math.sin(e.anisotropyRotation))}));class jx extends Fm{static get type(){return"ModelViewProjectionNode"}constructor(e=null){super("vec4"),this.positionNode=e}setup(e){if("fragment"===e.shaderStage)return pb(e.context.mvp);const t=this.positionNode||c_,n=e.renderer.nodes.modelViewMatrix||a_;return e_.mul(n).mul(t)}}const Vx=Sg(jx);class Gx extends Dm{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isInstanceIndexNode=!0}generate(e){const t=this.getNodeType(e),n=this.scope;let r,i;if(n===Gx.VERTEX)r=e.getVertexIndex();else if(n===Gx.INSTANCE)r=e.getInstanceIndex();else if(n===Gx.DRAW)r=e.getDrawIndex();else if(n===Gx.INVOCATION_LOCAL)r=e.getInvocationLocalIndex();else if(n===Gx.INVOCATION_SUBGROUP)r=e.getInvocationSubgroupIndex();else{if(n!==Gx.SUBGROUP)throw new Error("THREE.IndexNode: Unknown scope: "+n);r=e.getSubgroupIndex()}if("vertex"===e.shaderStage||"compute"===e.shaderStage)i=r;else{i=pb(this).build(e,t)}return i}}Gx.VERTEX="vertex",Gx.INSTANCE="instance",Gx.SUBGROUP="subgroup",Gx.INVOCATION_LOCAL="invocationLocal",Gx.INVOCATION_SUBGROUP="invocationSubgroup",Gx.DRAW="draw";const Hx=Eg(Gx,Gx.VERTEX),Wx=Eg(Gx,Gx.INSTANCE),qx=(Gx.SUBGROUP,Gx.INVOCATION_SUBGROUP,Gx.INVOCATION_LOCAL,Eg(Gx,Gx.DRAW));class Xx extends Dm{static get type(){return"InstanceNode"}constructor(e){super("void"),this.instanceMesh=e,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=Cm,this.buffer=null,this.bufferColor=null}setup(e){let t=this.instanceMatrixNode,n=this.instanceColorNode;const r=this.instanceMesh;if(null===t){const e=r.instanceMatrix;if(r.count<=1e3)t=D_(e.array,"mat4",Math.max(r.count,1)).element(Wx);else{const n=new fm(e.array,16,1);this.buffer=n;const r=e.usage===Wl?Pb:Ob,i=[r(n,"vec4",16,0),r(n,"vec4",16,4),r(n,"vec4",16,8),r(n,"vec4",16,12)];t=Zg(...i)}this.instanceMatrixNode=t}const i=r.instanceColor;if(i&&null===n){const e=new tp(i.array,3),t=i.usage===Wl?Pb:Ob;this.bufferColor=e,n=Fg(t(e,"vec3",3,0)),this.instanceColorNode=n}const o=t.mul(c_).xyz;if(c_.assign(o),e.hasGeometryAttribute("normal")){const e=T_(y_,t);y_.assign(e)}null!==this.instanceColorNode&&ov("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.instanceMesh.instanceMatrix.usage!==Wl&&null!=this.buffer&&this.instanceMesh.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMesh.instanceMatrix.version),this.instanceMesh.instanceColor&&this.instanceMesh.instanceColor.usage!==Wl&&null!=this.bufferColor&&this.instanceMesh.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceMesh.instanceColor.version)}}const Zx=Sg(Xx);class $x extends Dm{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){null===this.batchingIdNode&&(null===e.getDrawIndex()?this.batchingIdNode=Wx:this.batchingIdNode=qx);const t=Tg((([e])=>{const t=qb(Kb(this.batchMesh._indirectTexture),0),n=Rg(e).modInt(Rg(t)),r=Rg(e).div(Rg(t));return Kb(this.batchMesh._indirectTexture,Dg(n,r)).x})).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]}),n=t(Rg(this.batchingIdNode)),r=this.batchMesh._matricesTexture,i=qb(Kb(r),0),o=Pg(n).mul(4).toInt().toVar(),s=o.modInt(i),a=o.div(Rg(i)),u=Zg(Kb(r,Dg(s,a)),Kb(r,Dg(s.add(1),a)),Kb(r,Dg(s.add(2),a)),Kb(r,Dg(s.add(3),a))),c=this.batchMesh._colorsTexture;if(null!==c){const e=Tg((([e])=>{const t=qb(Kb(c),0).x,n=e,r=n.modInt(t),i=n.div(t);return Kb(c,Dg(r,i)).rgb})).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]}),t=e(n);ov("vec3","vBatchColor").assign(t)}const l=Xg(u);c_.assign(u.mul(c_));const h=y_.div(Fg(l[0].dot(l[0]),l[1].dot(l[1]),l[2].dot(l[2]))),d=l.mul(h).xyz;y_.assign(d),e.hasGeometryAttribute("tangent")&&q_.mulAssign(l)}}const Yx=Sg($x),Kx=new WeakMap;class Qx extends Dm{static get type(){return"SkinningNode"}constructor(e,t=!1){let n,r,i;super("void"),this.skinnedMesh=e,this.useReference=t,this.updateType=Pm,this.skinIndexNode=Gb("skinIndex","uvec4"),this.skinWeightNode=Gb("skinWeight","vec4"),t?(n=j_("bindMatrix","mat4"),r=j_("bindMatrixInverse","mat4"),i=V_("skeleton.boneMatrices","mat4",e.skeleton.bones.length)):(n=nv(e.bindMatrix,"mat4"),r=nv(e.bindMatrixInverse,"mat4"),i=D_(e.skeleton.boneMatrices,"mat4",e.skeleton.bones.length)),this.bindMatrixNode=n,this.bindMatrixInverseNode=r,this.boneMatricesNode=i,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,t=c_){const{skinIndexNode:n,skinWeightNode:r,bindMatrixNode:i,bindMatrixInverseNode:o}=this,s=e.element(n.x),a=e.element(n.y),u=e.element(n.z),c=e.element(n.w),l=i.mul(t),h=Lv(s.mul(r.x).mul(l),a.mul(r.y).mul(l),u.mul(r.z).mul(l),c.mul(r.w).mul(l));return o.mul(h).xyz}getSkinnedNormal(e=this.boneMatricesNode,t=y_){const{skinIndexNode:n,skinWeightNode:r,bindMatrixNode:i,bindMatrixInverseNode:o}=this,s=e.element(n.x),a=e.element(n.y),u=e.element(n.z),c=e.element(n.w);let l=Lv(r.x.mul(s),r.y.mul(a),r.z.mul(u),r.w.mul(c));return l=o.mul(l).mul(i),l.transformDirection(t).xyz}getPreviousSkinnedPosition(e){const t=e.object;return null===this.previousBoneMatricesNode&&(t.skeleton.previousBoneMatrices=new Float32Array(t.skeleton.boneMatrices),this.previousBoneMatricesNode=V_("skeleton.previousBoneMatrices","mat4",t.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,l_)}needsPreviousBoneMatrices(e){const t=e.renderer.getMRT();return t&&t.has("velocity")}setup(e){this.needsPreviousBoneMatrices(e)&&l_.assign(this.getPreviousSkinnedPosition(e));const t=this.getSkinnedPosition();if(c_.assign(t),e.hasGeometryAttribute("normal")){const t=this.getSkinnedNormal();y_.assign(t),e.hasGeometryAttribute("tangent")&&q_.assign(t)}}generate(e,t){if("void"!==t)return c_.build(e,t)}update(e){const t=(this.useReference?e.object:this.skinnedMesh).skeleton;Kx.get(t)!==e.frameId&&(Kx.set(t,e.frameId),null!==this.previousBoneMatricesNode&&t.previousBoneMatrices.set(t.boneMatrices),t.update())}}class Jx extends Dm{static get type(){return"LoopNode"}constructor(e=[]){super(),this.params=e}getVarName(e){return String.fromCharCode("i".charCodeAt()+e)}getProperties(e){const t=e.getNodeProperties(this);if(void 0!==t.stackNode)return t;const n={};for(let e=0,t=this.params.length-1;e<t;e++){const t=this.params[e],r=!0!==t.isNode&&t.name||this.getVarName(e),i=!0!==t.isNode&&t.type||"int";n[r]=Bb(r,i)}const r=e.addStack();return t.returnsNode=this.params[this.params.length-1](n,r,e),t.stackNode=r,e.removeStack(),t}getNodeType(e){const{returnsNode:t}=this.getProperties(e);return t?t.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){const t=this.getProperties(e),n=this.params,r=t.stackNode;for(let t=0,r=n.length-1;t<r;t++){const r=n[t];let i=null,o=null,s=null,a=null,u=null,c=null;r.isNode?(a="int",s=this.getVarName(t),i="0",o=r.build(e,a),u="<"):(a=r.type||"int",s=r.name||this.getVarName(t),i=r.start,o=r.end,u=r.condition,c=r.update,"number"==typeof i?i=e.generateConst(a,i):i&&i.isNode&&(i=i.build(e,a)),"number"==typeof o?o=e.generateConst(a,o):o&&o.isNode&&(o=o.build(e,a)),void 0!==i&&void 0===o?(i+=" - 1",o="0",u=">="):void 0!==o&&void 0===i&&(i="0",u="<"),void 0===u&&(u=Number(i)>Number(o)?">=":"<"));const l={start:i,end:o,condition:u},h=l.start,d=l.end;let f="",p="",m="";c||(c="int"===a||"uint"===a?u.includes("<")?"++":"--":u.includes("<")?"+= 1.":"-= 1."),f+=e.getVar(a,s)+" = "+h,p+=s+" "+u+" "+d,m+=s+" "+c;const g=`for ( ${f}; ${p}; ${m} )`;e.addFlowCode((0===t?"\n":"")+e.tab+g+" {\n\n").addFlowTab()}const i=r.build(e,"void"),o=t.returnsNode?t.returnsNode.build(e):"";e.removeFlowTab().addFlowCode("\n"+e.tab+i);for(let t=0,n=this.params.length-1;t<n;t++)e.addFlowCode((0===t?"":e.tab)+"}\n\n").removeFlowTab();return e.addFlowTab(),o}}const ew=(...e)=>_g(new Jx(wg(e,"int"))).append(),tw=()=>Bb("break").append(),nw=new WeakMap,rw=new Mh,iw=Tg((({bufferMap:e,influence:t,stride:n,width:r,depth:i,offset:o})=>{const s=Rg(Hx).mul(n).add(o),a=s.div(r),u=s.sub(a.mul(r));return Kb(e,Dg(u,a)).depth(i).mul(t)}));class ow extends Dm{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=nv(1),this.updateType=Pm}setup(e){const{geometry:t}=e,n=void 0!==t.morphAttributes.position,r=t.hasAttribute("normal")&&void 0!==t.morphAttributes.normal,i=t.morphAttributes.position||t.morphAttributes.normal||t.morphAttributes.color,o=void 0!==i?i.length:0,{texture:s,stride:a,size:u}=function(e){const t=void 0!==e.morphAttributes.position,n=void 0!==e.morphAttributes.normal,r=void 0!==e.morphAttributes.color,i=e.morphAttributes.position||e.morphAttributes.normal||e.morphAttributes.color,o=void 0!==i?i.length:0;let s=nw.get(e);if(void 0===s||s.count!==o){void 0!==s&&s.texture.dispose();const a=e.morphAttributes.position||[],u=e.morphAttributes.normal||[],c=e.morphAttributes.color||[];let l=0;!0===t&&(l=1),!0===n&&(l=2),!0===r&&(l=3);let h=e.attributes.position.count*l,d=1;const f=4096;h>f&&(d=Math.ceil(h/f),h=f);const p=new Float32Array(h*d*4*o),m=new Oh(p,h,d,o);m.type=Jc,m.needsUpdate=!0;const g=4*l;for(let y=0;y<o;y++){const b=a[y],_=u[y],x=c[y],w=h*d*4*y;for(let S=0;S<b.count;S++){const E=S*g;!0===t&&(rw.fromBufferAttribute(b,S),p[w+E+0]=rw.x,p[w+E+1]=rw.y,p[w+E+2]=rw.z,p[w+E+3]=0),!0===n&&(rw.fromBufferAttribute(_,S),p[w+E+4]=rw.x,p[w+E+5]=rw.y,p[w+E+6]=rw.z,p[w+E+7]=0),!0===r&&(rw.fromBufferAttribute(x,S),p[w+E+8]=rw.x,p[w+E+9]=rw.y,p[w+E+10]=rw.z,p[w+E+11]=4===x.itemSize?rw.w:1)}}function v(){m.dispose(),nw.delete(e),e.removeEventListener("dispose",v)}s={count:o,texture:m,stride:l,size:new sh(h,d)},nw.set(e,s),e.addEventListener("dispose",v)}return s}(t);!0===n&&c_.mulAssign(this.morphBaseInfluence),!0===r&&y_.mulAssign(this.morphBaseInfluence);const c=Rg(u.width);ew(o,(({i:e})=>{const t=Pg(0).toVar();this.mesh.count>1&&null!==this.mesh.morphTexture&&void 0!==this.mesh.morphTexture?t.assign(Kb(this.mesh.morphTexture,Dg(Rg(e).add(1),Rg(Wx))).r):t.assign(j_("morphTargetInfluences","float").element(e).toVar()),!0===n&&c_.addAssign(iw({bufferMap:s,influence:t,stride:a,width:c,depth:e,offset:Rg(0)})),!0===r&&y_.addAssign(iw({bufferMap:s,influence:t,stride:a,width:c,depth:e,offset:Rg(1)}))}))}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce(((e,t)=>e+t),0)}}const sw=Sg(ow);class aw extends Dm{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}generate(){console.warn("Abstract function.")}}class uw extends aw{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class cw extends cb{static get type(){return"LightingContextNode"}constructor(e,t=null,n=null,r=null){super(e),this.lightingModel=t,this.backdropNode=n,this.backdropAlphaNode=r,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:t}=this,n={directDiffuse:Fg().toVar("directDiffuse"),directSpecular:Fg().toVar("directSpecular"),indirectDiffuse:Fg().toVar("indirectDiffuse"),indirectSpecular:Fg().toVar("indirectSpecular")};return{radiance:Fg().toVar("radiance"),irradiance:Fg().toVar("irradiance"),iblIrradiance:Fg().toVar("iblIrradiance"),ambientOcclusion:Pg(1).toVar("ambientOcclusion"),reflectedLight:n,backdrop:e,backdropAlpha:t}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const lw=Sg(cw);class hw extends aw{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}let dw,fw;class pw extends Dm{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this.isViewportNode=!0}getNodeType(){return this.scope===pw.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=Am;return this.scope!==pw.SIZE&&this.scope!==pw.VIEWPORT||(e=Om),this.updateType=e,e}update({renderer:e}){const t=e.getRenderTarget();this.scope===pw.VIEWPORT?null!==t?fw.copy(t.viewport):(e.getViewport(fw),fw.multiplyScalar(e.getPixelRatio())):null!==t?(dw.width=t.width,dw.height=t.height):e.getDrawingBufferSize(dw)}setup(){const e=this.scope;let t=null;return t=e===pw.SIZE?nv(dw||(dw=new sh)):e===pw.VIEWPORT?nv(fw||(fw=new Mh)):kg(vw.div(gw)),t}generate(e){if(this.scope===pw.COORDINATE){let t=e.getFragCoord();if(e.isFlipY()){const n=e.getNodeProperties(gw).outputNode.build(e);t=`${e.getType("vec2")}( ${t}.x, ${n}.y - ${t}.y )`}return t}return super.generate(e)}}pw.COORDINATE="coordinate",pw.VIEWPORT="viewport",pw.SIZE="size",pw.UV="uv";const mw=Eg(pw,pw.UV),gw=Eg(pw,pw.SIZE),vw=Eg(pw,pw.COORDINATE),yw=Eg(pw,pw.VIEWPORT),bw=(yw.zw,yw.xy,new sh);class _w extends $b{static get type(){return"ViewportTextureNode"}constructor(e=mw,t=null,n=null){null===n&&((n=new hp).minFilter=qc),super(n,e,t),this.generateMipmaps=!1,this.isOutputTextureNode=!0,this.updateBeforeType=Cm}updateBefore(e){const t=e.renderer;t.getDrawingBufferSize(bw);const n=this.value;n.image.width===bw.width&&n.image.height===bw.height||(n.image.width=bw.width,n.image.height=bw.height,n.needsUpdate=!0);const r=n.generateMipmaps;n.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(n),n.generateMipmaps=r}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const xw=Sg(_w,null,null,{generateMipmaps:!0});let ww=null;class Sw extends _w{static get type(){return"ViewportDepthTextureNode"}constructor(e=mw,t=null){null===ww&&(ww=new dp),super(e,t,ww)}}const Ew=Sg(Sw);class Tw extends Dm{static get type(){return"ViewportDepthNode"}constructor(e,t=null){super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===Tw.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:t}=this,n=this.valueNode;let r=null;if(t===Tw.DEPTH_BASE)null!==n&&(r=Pw().assign(n));else if(t===Tw.DEPTH)r=e.isPerspectiveCamera?Aw(f_.z,Qb,Jb):Mw(f_.z,Qb,Jb);else if(t===Tw.LINEAR_DEPTH)if(null!==n)if(e.isPerspectiveCamera){const e=Cw(n,Qb,Jb);r=Mw(e,Qb,Jb)}else r=n;else r=Mw(f_.z,Qb,Jb);return r}}Tw.DEPTH_BASE="depthBase",Tw.DEPTH="depth",Tw.LINEAR_DEPTH="linearDepth";const Mw=(e,t,n)=>e.add(t).div(t.sub(n)),Aw=(e,t,n)=>t.add(e).mul(n).div(n.sub(t).mul(e)),Cw=(e,t,n)=>t.mul(n).div(n.sub(t).mul(e).sub(n)),Ow=(e,t,n)=>{t=t.max(1e-6).toVar();const r=py(e.div(t).add(1)),i=py(n.div(t).add(1));return r.div(i)},Pw=Sg(Tw,Tw.DEPTH_BASE),Rw=Eg(Tw,Tw.DEPTH),Nw=Sg(Tw,Tw.LINEAR_DEPTH);Ew();Rw.assign=e=>Pw(e);class Iw extends Dm{static get type(){return"ClippingNode"}constructor(e=Iw.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const t=e.clippingContext,{localClipIntersection:n,localClippingCount:r,globalClippingCount:i}=t,o=i+r,s=n?o-r:o;return this.scope===Iw.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(t.planes,o,s):this.setupDefault(t.planes,o,s)}setupAlphaToCoverage(e,t,n){return Tg((()=>{const r=F_(e),i=iv("float","distanceToPlane"),o=iv("float","distanceToGradient"),s=iv("float","clipOpacity");let a;if(s.assign(1),ew(n,(({i:e})=>{a=r.element(e),i.assign(f_.dot(a.xyz).negate().add(a.w)),o.assign(i.fwidth().div(2)),s.mulAssign(ib(o.negate(),o,i)),s.equal(0).discard()})),n<t){const e=iv("float","unionclipOpacity");e.assign(1),ew({start:n,end:t},(({i:t})=>{a=r.element(t),i.assign(f_.dot(a.xyz).negate().add(a.w)),o.assign(i.fwidth().div(2)),e.mulAssign(ib(o.negate(),o,i).oneMinus())})),s.mulAssign(e.oneMinus())}sv.a.mulAssign(s),sv.a.equal(0).discard()}))()}setupDefault(e,t,n){return Tg((()=>{const r=F_(e);let i;if(ew(n,(({i:e})=>{i=r.element(e),f_.dot(i.xyz).greaterThan(i.w).discard()})),n<t){const e=iv("bool","clipped");e.assign(!0),ew({start:n,end:t},(({i:t})=>{i=r.element(t),e.assign(f_.dot(i.xyz).greaterThan(i.w).and(e))})),e.discard()}}))()}}Iw.ALPHA_TO_COVERAGE="alphaToCoverage",Iw.DEFAULT="default";const kw=Tg((([e])=>_y(Fv(1e4,xy(Fv(17,e.x).add(Fv(.1,e.y)))).mul(Lv(.1,Ay(xy(Fv(13,e.y).add(e.x)))))))),Dw=Tg((([e])=>kw(kg(kw(e.xy),e.z)))),Lw=Tg((([e])=>{const t=jy(Oy(Ny(e.xyz)),Oy(Iy(e.xyz))).toVar("maxDeriv"),n=Pg(1).div(Pg(.05).mul(t)).toVar("pixScale"),r=kg(dy(vy(py(n))),dy(yy(py(n)))).toVar("pixScales"),i=kg(Dw(vy(r.x.mul(e.xyz))),Dw(vy(r.y.mul(e.xyz)))).toVar("alpha"),o=_y(py(n)).toVar("lerpFactor"),s=Lv(Fv(o.oneMinus(),i.x),Fv(o,i.y)).toVar("x"),a=zy(o,o.oneMinus()).toVar("a"),u=Fg(s.mul(s).div(Fv(2,a).mul(Uv(1,a))),s.sub(Fv(.5,a)).div(Uv(1,a)),Uv(1,Uv(1,s).mul(Uv(1,s)).div(Fv(2,a).mul(Uv(1,a))))).toVar("cases"),c=s.lessThan(a.oneMinus()).select(s.lessThan(a).select(u.x,u.y),u.z);return nb(c,1e-6,1)}));class Uw extends nf{static get type(){return"NodeMaterial"}constructor(){super(),this.isNodeMaterial=!0,this.type=this.constructor.type,this.forceSinglePass=!1,this.fog=!0,this.lights=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.shadowNode=null,this.shadowPositionNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null}customProgramCacheKey(){return this.type+_m(this)}build(e){this.setup(e)}setupObserver(e){return new mm(e)}setup(e){let t;e.context.setupNormal=()=>this.setupNormal(e),e.addStack(),e.stack.outputNode=this.vertexNode||this.setupPosition(e),null!==this.geometryNode&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();const n=this.setupClipping(e);if(!0===this.depthWrite&&this.setupDepth(e),null===this.fragmentNode){this.setupDiffuseColor(e),this.setupVariants(e);const r=this.setupLighting(e);null!==n&&e.stack.add(n);const i=Vg(r,sv.a).max(0);t=this.setupOutput(e,i),Ev.assign(t),null!==this.outputNode&&(t=this.outputNode);if(null!==e.renderer.getRenderTarget()){const n=e.renderer.getMRT(),r=this.mrtNode;null!==n?(t=n,null!==r&&(t=n.merge(r))):null!==r&&(t=r)}}else{let n=this.fragmentNode;!0!==n.isOutputStructNode&&(n=Vg(n)),t=this.setupOutput(e,n)}e.stack.outputNode=t,e.addFlow("fragment",e.removeStack()),e.monitor=this.setupObserver(e)}setupClipping(e){if(null===e.clippingContext)return null;const{globalClippingCount:t,localClippingCount:n}=e.clippingContext;let r=null;if(t||n){const t=e.renderer.samples;this.alphaToCoverage&&t>1?r=_g(new Iw(Iw.ALPHA_TO_COVERAGE)):e.stack.add(_g(new Iw))}return r}setupDepth(e){const{renderer:t,camera:n}=e;let r=this.depthNode;if(null===r){const e=t.getMRT();e&&e.has("depth")?r=e.get("depth"):!0===t.logarithmicDepthBuffer&&(r=n.isPerspectiveCamera?Ow(Vx().w,Qb,Jb):Mw(f_.z,Qb,Jb))}null!==r&&Rw.assign(r).append()}setupPosition(e){const{object:t}=e,n=t.geometry;var r;if(e.addStack(),(n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color)&&sw(t).append(),!0===t.isSkinnedMesh&&(r=t,_g(new Qx(r,!0))).append(),this.displacementMap){const e=H_("displacementMap","texture"),t=H_("displacementScale","float"),n=H_("displacementBias","float");c_.addAssign(y_.normalize().mul(e.x.mul(t).add(n)))}t.isBatchedMesh&&Yx(t).append(),t.instanceMatrix&&!0===t.instanceMatrix.isInstancedBufferAttribute&&Zx(t).append(),null!==this.positionNode&&c_.assign(this.positionNode);const i=Vx();return e.context.vertex=e.removeStack(),e.context.mvp=i,i}setupDiffuseColor({object:e,geometry:t}){let n=this.colorNode?Vg(this.colorNode):ax;if(!0===this.vertexColors&&t.hasAttribute("color")&&(n=Vg(n.xyz.mul(Gb("color","vec3")),n.a)),e.instanceColor){n=ov("vec3","vInstanceColor").mul(n)}if(e.isBatchedMesh&&e._colorsTexture){n=ov("vec3","vBatchColor").mul(n)}sv.assign(n);const r=this.opacityNode?Pg(this.opacityNode):lx;if(sv.a.assign(sv.a.mul(r)),null!==this.alphaTestNode||this.alphaTest>0){const e=null!==this.alphaTestNode?Pg(this.alphaTestNode):sx;sv.a.lessThanEqual(e).discard()}!0===this.alphaHash&&sv.a.lessThan(Lw(c_)).discard(),!1===this.transparent&&1===this.blending&&!1===this.alphaToCoverage&&sv.a.assign(1)}setupVariants(){}setupOutgoingLight(){return!0===this.lights?Fg(0):sv.rgb}setupNormal(){return this.normalNode?Fg(this.normalNode):yx}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?H_("envMap","cubeTexture"):H_("envMap","texture")),e}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new hw(Fx)),t}setupLights(e){const t=[],n=this.setupEnvironment(e);n&&n.isLightingNode&&t.push(n);const r=this.setupLightMap(e);if(r&&r.isLightingNode&&t.push(r),null!==this.aoNode||e.material.aoMap){const e=null!==this.aoNode?this.aoNode:Bx;t.push(new uw(e))}let i=this.lightsNode||e.lightsNode;return t.length>0&&(i=e.renderer.lighting.createNode([...i.getLights(),...t])),i}setupLightingModel(){}setupLighting(e){const{material:t}=e,{backdropNode:n,backdropAlphaNode:r,emissiveNode:i}=this,o=!0===this.lights||null!==this.lightsNode?this.setupLights(e):null;let s=this.setupOutgoingLight(e);if(o&&o.getScope().hasLights){const t=this.setupLightingModel(e);s=lw(o,t,n,r)}else null!==n&&(s=Fg(null!==r?tb(s,n,r):n));return(i&&!0===i.isNode||t.emissive&&!0===t.emissive.isColor)&&(av.assign(Fg(i||cx)),s=s.add(av)),s}setupOutput(e,t){if(!0===this.fog){const n=e.fogNode;n&&(t=Vg(n.mix(t.rgb,n.colorNode),t.a))}return t}setDefaultValues(e){for(const t in e){const n=e[t];void 0===this[t]&&(this[t]=n,n&&n.clone&&(this[t]=n.clone()))}const t=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const e in t)void 0===Object.getOwnPropertyDescriptor(this.constructor.prototype,e)&&void 0!==t[e].get&&Object.defineProperty(this.constructor.prototype,e,t[e])}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{},nodes:{}});const n=nf.prototype.toJSON.call(this,e),r=xm(this);n.inputNodes={};for(const{property:t,childNode:i}of r)n.inputNodes[t]=i.toJSON(e).uuid;function i(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}if(t){const t=i(e.textures),r=i(e.images),o=i(e.nodes);t.length>0&&(n.textures=t),r.length>0&&(n.images=r),o.length>0&&(n.nodes=o)}return n}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.shadowNode=e.shadowNode,this.shadowPositionNode=e.shadowPositionNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,super.copy(e)}}const Fw=new cp;class Bw extends Uw{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.lights=!1,this.setDefaultValues(Fw),this.setValues(e)}}const zw=new wp;class jw extends Uw{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.lights=!1,this.setDefaultValues(zw),this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode,t=this.dashScaleNode?Pg(this.dashScaleNode):kx,n=this.dashSizeNode?Pg(this.dashSizeNode):Dx,r=this.dashSizeNode?Pg(this.dashGapNode):Lx;Tv.assign(n),Mv.assign(r);const i=pb(Gb("lineDistance").mul(t));(e?i.add(e):i).mod(Tv.add(Mv)).greaterThan(Tv).discard()}}const Vw=new bp;class Gw extends Uw{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.lights=!1,this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(Vw),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?Pg(this.opacityNode):lx;sv.assign(Vg(_g(w_).mul(.5).add(.5),e))}}class Hw extends Fm{static get type(){return"EquirectUVNode"}constructor(e=d_){super("vec2"),this.dirNode=e}setup(){const e=this.dirNode,t=e.z.atan2(e.x).mul(1/(2*Math.PI)).add(.5),n=e.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return kg(t,n)}}const Ww=Sg(Hw);class qw extends Zf{constructor(e=1,t={}){super(e,t),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,t){const n=t.minFilter,r=t.generateMipmaps;t.generateMipmaps=!0,this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i=new Uf(5,5,5),o=Ww(d_),s=new Uw;s.colorNode=Yb(t,o,0),s.side=1,s.blending=0;const a=new Df(i,s),u=new $f;u.add(a),t.minFilter===qc&&(t.minFilter=Hc);const c=new qf(1,10,this),l=e.getMRT();return e.setMRT(null),c.update(e,u),e.setMRT(l),t.minFilter=n,t.currentGenerateMipmaps=r,a.geometry.dispose(),a.material.dispose(),this}}const Xw=new WeakMap;class Zw extends Fm{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=I_();const t=new Xf;t.isRenderTargetTexture=!0,this._defaultTexture=t,this.updateBeforeType=Om}updateBefore(e){const{renderer:t,material:n}=e,r=this.envNode;if(r.isTextureNode||r.isMaterialReferenceNode){const e=r.isTextureNode?r.value:n[r.property];if(e&&e.isTexture){const n=e.mapping;if(n===Dc||n===Lc){if(Xw.has(e)){const t=Xw.get(e);Yw(t,e.mapping),this._cubeTexture=t}else{const n=e.image;if(function(e){return null!=e&&e.height>0}(n)){const r=new qw(n.height);r.fromEquirectangularTexture(t,e),Yw(r.texture,e.mapping),this._cubeTexture=r.texture,Xw.set(e,r.texture),e.addEventListener("dispose",$w)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function $w(e){const t=e.target;t.removeEventListener("dispose",$w);const n=Xw.get(t);void 0!==n&&(Xw.delete(t),n.dispose())}function Yw(e,t){t===Dc?e.mapping=Ic:t===Lc&&(e.mapping=kc)}const Kw=Sg(Zw);class Qw extends aw{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=Kw(this.envNode)}}class Jw extends aw{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const t=Pg(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(t)}}class eS{start(){}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class tS extends eS{constructor(){super()}indirect(e,t,n){const r=e.ambientOcclusion,i=e.reflectedLight,o=n.context.irradianceLightMap;i.indirectDiffuse.assign(Vg(0)),o?i.indirectDiffuse.addAssign(o):i.indirectDiffuse.addAssign(Vg(1,1,1,0)),i.indirectDiffuse.mulAssign(r),i.indirectDiffuse.mulAssign(sv.rgb)}finish(e,t,n){const r=n.material,i=e.outgoingLight,o=n.context.environment;if(o)switch(r.combine){case 0:i.rgb.assign(tb(i.rgb,i.rgb.mul(o.rgb),px.mul(mx)));break;case 1:i.rgb.assign(tb(i.rgb,o.rgb,px.mul(mx)));break;case 2:i.rgb.addAssign(o.rgb.mul(px.mul(mx)));break;default:console.warn("THREE.BasicLightingModel: Unsupported .combine value:",r.combine)}}}const nS=new rf;class rS extends Uw{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(nS),this.setValues(e)}setupNormal(){return __}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new Qw(t):null}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new Jw(Fx)),t}setupOutgoingLight(){return sv.rgb}setupLightingModel(){return new tS}}const iS=Tg((({f0:e,f90:t,dotVH:n})=>{const r=n.mul(-5.55473).sub(6.98316).mul(n).exp2();return e.mul(r.oneMinus()).add(t.mul(r))})),oS=Tg((e=>e.diffuseColor.mul(1/Math.PI))),sS=Tg((({dotNH:e})=>Sv.mul(Pg(.5)).add(1).mul(Pg(1/Math.PI)).mul(e.pow(Sv)))),aS=Tg((({lightDirection:e})=>{const t=e.add(p_).normalize(),n=w_.dot(t).clamp(),r=p_.dot(t).clamp(),i=iS({f0:xv,f90:1,dotVH:r}),o=Pg(.25),s=sS({dotNH:n});return i.mul(o).mul(s)}));class uS extends tS{constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:t,reflectedLight:n}){const r=w_.dot(e).clamp().mul(t);n.directDiffuse.addAssign(r.mul(oS({diffuseColor:sv.rgb}))),!0===this.specular&&n.directSpecular.addAssign(r.mul(aS({lightDirection:e})).mul(px))}indirect({ambientOcclusion:e,irradiance:t,reflectedLight:n}){n.indirectDiffuse.addAssign(t.mul(oS({diffuseColor:sv}))),n.indirectDiffuse.mulAssign(e)}}const cS=new _p;class lS extends Uw{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(cS),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new Qw(t):null}setupLightingModel(){return new uS(!1)}}const hS=new vp;class dS extends Uw{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(hS),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new Qw(t):null}setupLightingModel(){return new uS}setupVariants(){const e=(this.shininessNode?Pg(this.shininessNode):ux).max(1e-4);Sv.assign(e);const t=this.specularNode||hx;xv.assign(t)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}const fS=Tg((e=>{if(!1===e.geometry.hasAttribute("normal"))return Pg(0);const t=__.dFdx().abs().max(__.dFdy().abs());return t.x.max(t.y).max(t.z)})),pS=Tg((e=>{const{roughness:t}=e,n=fS();let r=t.max(.0525);return r=r.add(n),r=r.min(1),r})),mS=Tg((({alpha:e,dotNL:t,dotNV:n})=>{const r=e.pow2(),i=t.mul(r.add(r.oneMinus().mul(n.pow2())).sqrt()),o=n.mul(r.add(r.oneMinus().mul(t.pow2())).sqrt());return Bv(.5,i.add(o).max(iy))})).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),gS=Tg((({alphaT:e,alphaB:t,dotTV:n,dotBV:r,dotTL:i,dotBL:o,dotNV:s,dotNL:a})=>{const u=a.mul(Fg(e.mul(n),t.mul(r),s).length()),c=s.mul(Fg(e.mul(i),t.mul(o),a).length());return Bv(.5,u.add(c)).saturate()})).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),vS=Tg((({alpha:e,dotNH:t})=>{const n=e.pow2(),r=t.pow2().mul(n.oneMinus()).oneMinus();return n.div(r.pow2()).mul(1/Math.PI)})).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),yS=Pg(1/Math.PI),bS=Tg((({alphaT:e,alphaB:t,dotNH:n,dotTH:r,dotBH:i})=>{const o=e.mul(t),s=Fg(t.mul(r),e.mul(i),o.mul(n)),a=s.dot(s),u=o.div(a);return yS.mul(o.mul(u.pow2()))})).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),_S=Tg((e=>{const{lightDirection:t,f0:n,f90:r,roughness:i,f:o,USE_IRIDESCENCE:s,USE_ANISOTROPY:a}=e,u=e.normalView||w_,c=i.pow2(),l=t.add(p_).normalize(),h=u.dot(t).clamp(),d=u.dot(p_).clamp(),f=u.dot(l).clamp(),p=p_.dot(l).clamp();let m,g,v=iS({f0:n,f90:r,dotVH:p});if(yg(s)&&(v=pv.mix(v,o)),yg(a)){const e=bv.dot(t),n=bv.dot(p_),r=bv.dot(l),i=_v.dot(t),o=_v.dot(p_),s=_v.dot(l);m=gS({alphaT:vv,alphaB:c,dotTV:n,dotBV:o,dotTL:e,dotBL:i,dotNV:d,dotNL:h}),g=bS({alphaT:vv,alphaB:c,dotNH:f,dotTH:r,dotBH:s})}else m=mS({alpha:c,dotNL:h,dotNV:d}),g=vS({alpha:c,dotNH:f});return v.mul(m).mul(g)})),xS=Tg((({roughness:e,dotNV:t})=>{const n=Vg(-1,-.0275,-.572,.022),r=Vg(1,.0425,1.04,-.04),i=e.mul(n).add(r),o=i.x.mul(i.x).min(t.mul(-9.28).exp2()).mul(i.x).add(i.y);return kg(-1.04,1.04).mul(o).add(i.zw)})).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),wS=Tg((e=>{const{dotNV:t,specularColor:n,specularF90:r,roughness:i}=e,o=xS({dotNV:t,roughness:i});return n.mul(o.x).add(r.mul(o.y))})),SS=Tg((({f:e,f90:t,dotVH:n})=>{const r=n.oneMinus().saturate(),i=r.mul(r),o=r.mul(i,i).clamp(0,.9999);return e.sub(Fg(t).mul(o)).div(o.oneMinus())})).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),ES=Tg((({roughness:e,dotNH:t})=>{const n=e.pow2(),r=Pg(1).div(n),i=t.pow2().oneMinus().max(.0078125);return Pg(2).add(r).mul(i.pow(r.mul(.5))).div(2*Math.PI)})).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),TS=Tg((({dotNV:e,dotNL:t})=>Pg(1).div(Pg(4).mul(t.add(e).sub(t.mul(e)))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),MS=Tg((({lightDirection:e})=>{const t=e.add(p_).normalize(),n=w_.dot(e).clamp(),r=w_.dot(p_).clamp(),i=w_.dot(t).clamp(),o=ES({roughness:fv,dotNH:i}),s=TS({dotNV:r,dotNL:n});return dv.mul(o).mul(s)})),AS=Tg((({N:e,V:t,roughness:n})=>{const r=e.dot(t).saturate(),i=kg(n,r.oneMinus().sqrt());return i.assign(i.mul(.984375).add(.0078125)),i})).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),CS=Tg((({f:e})=>{const t=e.length();return jy(t.mul(t).add(e.z).div(t.add(1)),0)})).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),OS=Tg((({v1:e,v2:t})=>{const n=e.dot(t),r=n.abs().toVar(),i=r.mul(.0145206).add(.4965155).mul(r).add(.8543985).toVar(),o=r.add(4.1616724).mul(r).add(3.417594).toVar(),s=i.div(o),a=n.greaterThan(0).select(s,jy(n.mul(n).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(s));return e.cross(t).mul(a)})).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),PS=Tg((({N:e,V:t,P:n,mInv:r,p0:i,p1:o,p2:s,p3:a})=>{const u=o.sub(i).toVar(),c=a.sub(i).toVar(),l=u.cross(c),h=Fg().toVar();return Cg(l.dot(n.sub(i)).greaterThanEqual(0),(()=>{const u=t.sub(e.mul(t.dot(e))).normalize(),c=e.cross(u).negate(),l=r.mul(Xg(u,c,e).transpose()).toVar(),d=l.mul(i.sub(n)).normalize().toVar(),f=l.mul(o.sub(n)).normalize().toVar(),p=l.mul(s.sub(n)).normalize().toVar(),m=l.mul(a.sub(n)).normalize().toVar(),g=Fg(0).toVar();g.addAssign(OS({v1:d,v2:f})),g.addAssign(OS({v1:f,v2:p})),g.addAssign(OS({v1:p,v2:m})),g.addAssign(OS({v1:m,v2:d})),h.assign(Fg(CS({f:g})))})),h})).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),RS=1/6,NS=e=>Fv(RS,Fv(e,Fv(e,e.negate().add(3)).sub(3)).add(1)),IS=e=>Fv(RS,Fv(e,Fv(e,Fv(3,e).sub(6))).add(4)),kS=e=>Fv(RS,Fv(e,Fv(e,Fv(-3,e).add(3)).add(3)).add(1)),DS=e=>Fv(RS,$y(e,3)),LS=e=>NS(e).add(IS(e)),US=e=>kS(e).add(DS(e)),FS=e=>Lv(-1,IS(e).div(NS(e).add(IS(e)))),BS=e=>Lv(1,DS(e).div(kS(e).add(DS(e)))),zS=(e,t,n)=>{const r=e.uvNode,i=Fv(r,t.zw).add(.5),o=vy(i),s=_y(i),a=LS(s.x),u=US(s.x),c=FS(s.x),l=BS(s.x),h=FS(s.y),d=BS(s.y),f=kg(o.x.add(c),o.y.add(h)).sub(.5).mul(t.xy),p=kg(o.x.add(l),o.y.add(h)).sub(.5).mul(t.xy),m=kg(o.x.add(c),o.y.add(d)).sub(.5).mul(t.xy),g=kg(o.x.add(l),o.y.add(d)).sub(.5).mul(t.xy),v=LS(s.y).mul(Lv(a.mul(e.uv(f).level(n)),u.mul(e.uv(p).level(n)))),y=US(s.y).mul(Lv(a.mul(e.uv(m).level(n)),u.mul(e.uv(g).level(n))));return v.add(y)},jS=Tg((([e,t=Pg(3)])=>{const n=kg(e.size(Rg(t))),r=kg(e.size(Rg(t.add(1)))),i=Bv(1,n),o=Bv(1,r),s=zS(e,Vg(i,n),vy(t)),a=zS(e,Vg(o,r),yy(t));return _y(t).mix(s,a)})),VS=Tg((([e,t,n,r,i])=>{const o=Fg(rb(t.negate(),by(e),Bv(1,r))),s=Fg(Oy(i[0].xyz),Oy(i[1].xyz),Oy(i[2].xyz));return by(o).mul(n.mul(s))})).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),GS=Tg((([e,t])=>e.mul(nb(t.mul(2).sub(2),0,1)))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),HS=xw(),WS=xw(),qS=Tg((([e,t,n],{material:r})=>{const i=(1==r.side?HS:WS).uv(e),o=py(gw.x).mul(GS(t,n));return jS(i,o)})),XS=Tg((([e,t,n])=>(Cg(n.notEqual(0),(()=>{const r=fy(t).negate().div(n);return hy(r.negate().mul(e))})),Fg(1)))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),ZS=Tg((([e,t,n,r,i,o,s,a,u,c,l,h,d,f,p])=>{let m,g;if(p){m=Vg().toVar(),g=Fg().toVar();const i=l.sub(1).mul(p.mul(.025)),o=Fg(l.sub(i),l,l.add(i));ew({start:0,end:3},(({i:i})=>{const l=o.element(i),p=VS(e,t,h,l,a),v=s.add(p),y=c.mul(u.mul(Vg(v,1))),b=kg(y.xy.div(y.w)).toVar();b.addAssign(1),b.divAssign(2),b.assign(kg(b.x,b.y.oneMinus()));const _=qS(b,n,l);m.element(i).assign(_.element(i)),m.a.addAssign(_.a),g.element(i).assign(r.element(i).mul(XS(Oy(p),d,f).element(i)))})),m.a.divAssign(3)}else{const i=VS(e,t,h,l,a),o=s.add(i),p=c.mul(u.mul(Vg(o,1))),v=kg(p.xy.div(p.w)).toVar();v.addAssign(1),v.divAssign(2),v.assign(kg(v.x,v.y.oneMinus())),m=qS(v,n,l),g=r.mul(XS(Oy(i),d,f))}const v=g.rgb.mul(m.rgb),y=e.dot(t).clamp(),b=Fg(wS({dotNV:y,specularColor:i,specularF90:o,roughness:n})),_=g.r.add(g.g,g.b).div(3);return Vg(b.oneMinus().mul(v),m.a.oneMinus().mul(_).oneMinus())})),$S=Xg(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),YS=(e,t)=>e.sub(t).div(e.add(t)).pow2(),KS=Tg((({outsideIOR:e,eta2:t,cosTheta1:n,thinFilmThickness:r,baseF0:i})=>{const o=tb(e,t,ib(0,.03,r)),s=e.div(o).pow2().mul(n.pow2().oneMinus()).oneMinus();Cg(s.lessThan(0),(()=>Fg(1)));const a=s.sqrt(),u=YS(o,e),c=iS({f0:u,f90:1,dotVH:n}),l=c.oneMinus(),h=o.lessThan(e).select(Math.PI,0),d=Pg(Math.PI).sub(h),f=(e=>{const t=e.sqrt();return Fg(1).add(t).div(Fg(1).sub(t))})(i.clamp(0,.9999)),p=YS(f,o.toVec3()),m=iS({f0:p,f90:1,dotVH:a}),g=Fg(f.x.lessThan(o).select(Math.PI,0),f.y.lessThan(o).select(Math.PI,0),f.z.lessThan(o).select(Math.PI,0)),v=o.mul(r,a,2),y=Fg(d).add(g),b=c.mul(m).clamp(1e-5,.9999),_=b.sqrt(),x=l.pow2().mul(m).div(Fg(1).sub(b)),w=c.add(x).toVar(),S=x.sub(l).toVar();return ew({start:1,end:2,condition:"<=",name:"m"},(({m:e})=>{S.mulAssign(_);const t=((e,t)=>{const n=e.mul(2*Math.PI*1e-9),r=Fg(54856e-17,44201e-17,52481e-17),i=Fg(1681e3,1795300,2208400),o=Fg(43278e5,93046e5,66121e5),s=Pg(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(n.mul(2239900).add(t.x).cos()).mul(n.pow2().mul(-45282e5).exp());let a=r.mul(o.mul(2*Math.PI).sqrt()).mul(i.mul(n).add(t).cos()).mul(n.pow2().negate().mul(o).exp());return a=Fg(a.x.add(s),a.y,a.z).div(1.0685e-7),$S.mul(a)})(Pg(e).mul(v),Pg(e).mul(y)).mul(2);w.addAssign(S.mul(t))})),w.max(Fg(0))})).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),QS=Tg((({normal:e,viewDir:t,roughness:n})=>{const r=e.dot(t).saturate(),i=n.pow2(),o=ub(n.lessThan(.25),Pg(-339.2).mul(i).add(Pg(161.4).mul(n)).sub(25.9),Pg(-8.48).mul(i).add(Pg(14.3).mul(n)).sub(9.95)),s=ub(n.lessThan(.25),Pg(44).mul(i).sub(Pg(23.7).mul(n)).add(3.26),Pg(1.97).mul(i).sub(Pg(3.27).mul(n)).add(.72));return ub(n.lessThan(.25),0,Pg(.1).mul(n).sub(.025)).add(o.mul(r).add(s).exp()).mul(1/Math.PI).saturate()})),JS=Fg(.04),eE=Pg(1);class tE extends eS{constructor(e=!1,t=!1,n=!1,r=!1,i=!1,o=!1){super(),this.clearcoat=e,this.sheen=t,this.iridescence=n,this.anisotropy=r,this.transmission=i,this.dispersion=o,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}start(e){if(!0===this.clearcoat&&(this.clearcoatRadiance=Fg().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=Fg().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=Fg().toVar("clearcoatSpecularIndirect")),!0===this.sheen&&(this.sheenSpecularDirect=Fg().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=Fg().toVar("sheenSpecularIndirect")),!0===this.iridescence){const e=w_.dot(p_).clamp();this.iridescenceFresnel=KS({outsideIOR:Pg(1),eta2:mv,cosTheta1:e,thinFilmThickness:gv,baseF0:xv}),this.iridescenceF0=SS({f:this.iridescenceFresnel,f90:1,dotVH:e})}if(!0===this.transmission){const t=h_,n=n_.sub(h_).normalize(),r=S_;e.backdrop=ZS(r,n,uv,sv,xv,wv,t,o_,t_,e_,Av,Ov,Rv,Pv,this.dispersion?Nv:null),e.backdropAlpha=Cv,sv.a.mulAssign(tb(1,e.backdrop.a,Cv))}}computeMultiscattering(e,t,n){const r=w_.dot(p_).clamp(),i=xS({roughness:uv,dotNV:r}),o=(this.iridescenceF0?pv.mix(xv,this.iridescenceF0):xv).mul(i.x).add(n.mul(i.y)),s=i.x.add(i.y).oneMinus(),a=xv.add(xv.oneMinus().mul(.047619)),u=o.mul(a).div(s.mul(a).oneMinus());e.addAssign(o),t.addAssign(u.mul(s))}direct({lightDirection:e,lightColor:t,reflectedLight:n}){const r=w_.dot(e).clamp().mul(t);if(!0===this.sheen&&this.sheenSpecularDirect.addAssign(r.mul(MS({lightDirection:e}))),!0===this.clearcoat){const n=E_.dot(e).clamp().mul(t);this.clearcoatSpecularDirect.addAssign(n.mul(_S({lightDirection:e,f0:JS,f90:eE,roughness:hv,normalView:E_})))}n.directDiffuse.addAssign(r.mul(oS({diffuseColor:sv.rgb}))),n.directSpecular.addAssign(r.mul(_S({lightDirection:e,f0:xv,f90:1,roughness:uv,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:t,halfWidth:n,halfHeight:r,reflectedLight:i,ltc_1:o,ltc_2:s}){const a=t.add(n).sub(r),u=t.sub(n).sub(r),c=t.sub(n).add(r),l=t.add(n).add(r),h=w_,d=p_,f=f_.toVar(),p=AS({N:h,V:d,roughness:uv}),m=o.uv(p).toVar(),g=s.uv(p).toVar(),v=Xg(Fg(m.x,0,m.y),Fg(0,1,0),Fg(m.z,0,m.w)).toVar(),y=xv.mul(g.x).add(xv.oneMinus().mul(g.y)).toVar();i.directSpecular.addAssign(e.mul(y).mul(PS({N:h,V:d,P:f,mInv:v,p0:a,p1:u,p2:c,p3:l}))),i.directDiffuse.addAssign(e.mul(sv).mul(PS({N:h,V:d,P:f,mInv:Xg(1,0,0,0,1,0,0,0,1),p0:a,p1:u,p2:c,p3:l})))}indirect(e,t,n){this.indirectDiffuse(e,t,n),this.indirectSpecular(e,t,n),this.ambientOcclusion(e,t,n)}indirectDiffuse({irradiance:e,reflectedLight:t}){t.indirectDiffuse.addAssign(e.mul(oS({diffuseColor:sv})))}indirectSpecular({radiance:e,iblIrradiance:t,reflectedLight:n}){if(!0===this.sheen&&this.sheenSpecularIndirect.addAssign(t.mul(dv,QS({normal:w_,viewDir:p_,roughness:fv}))),!0===this.clearcoat){const e=E_.dot(p_).clamp(),t=wS({dotNV:e,specularColor:JS,specularF90:eE,roughness:hv});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(t))}const r=Fg().toVar("singleScattering"),i=Fg().toVar("multiScattering"),o=t.mul(1/Math.PI);this.computeMultiscattering(r,i,wv);const s=r.add(i),a=sv.mul(s.r.max(s.g).max(s.b).oneMinus());n.indirectSpecular.addAssign(e.mul(r)),n.indirectSpecular.addAssign(i.mul(o)),n.indirectDiffuse.addAssign(a.mul(o))}ambientOcclusion({ambientOcclusion:e,reflectedLight:t}){const n=w_.dot(p_).clamp().add(e),r=uv.mul(-16).oneMinus().negate().exp2(),i=e.sub(n.pow(r).oneMinus()).clamp();!0===this.clearcoat&&this.clearcoatSpecularIndirect.mulAssign(e),!0===this.sheen&&this.sheenSpecularIndirect.mulAssign(e),t.indirectDiffuse.mulAssign(e),t.indirectSpecular.mulAssign(i)}finish(e){const{outgoingLight:t}=e;if(!0===this.clearcoat){const e=E_.dot(p_).clamp(),n=iS({dotVH:e,f0:JS,f90:eE}),r=t.mul(lv.mul(n).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(lv));t.assign(r)}if(!0===this.sheen){const e=dv.r.max(dv.g).max(dv.b).mul(.157).oneMinus(),n=t.mul(e).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);t.assign(n)}}}const nE=Pg(1),rE=Pg(-2),iE=Pg(.8),oE=Pg(-1),sE=Pg(.4),aE=Pg(2),uE=Pg(.305),cE=Pg(3),lE=Pg(.21),hE=Pg(4),dE=Pg(4),fE=Pg(16),pE=Tg((([e])=>{const t=Fg(Ay(e)).toVar(),n=Pg(-1).toVar();return Cg(t.x.greaterThan(t.z),(()=>{Cg(t.x.greaterThan(t.y),(()=>{n.assign(ub(e.x.greaterThan(0),0,3))})).Else((()=>{n.assign(ub(e.y.greaterThan(0),1,4))}))})).Else((()=>{Cg(t.z.greaterThan(t.y),(()=>{n.assign(ub(e.z.greaterThan(0),2,5))})).Else((()=>{n.assign(ub(e.y.greaterThan(0),1,4))}))})),n})).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),mE=Tg((([e,t])=>{const n=kg().toVar();return Cg(t.equal(0),(()=>{n.assign(kg(e.z,e.y).div(Ay(e.x)))})).ElseIf(t.equal(1),(()=>{n.assign(kg(e.x.negate(),e.z.negate()).div(Ay(e.y)))})).ElseIf(t.equal(2),(()=>{n.assign(kg(e.x.negate(),e.y).div(Ay(e.z)))})).ElseIf(t.equal(3),(()=>{n.assign(kg(e.z.negate(),e.y).div(Ay(e.x)))})).ElseIf(t.equal(4),(()=>{n.assign(kg(e.x.negate(),e.z).div(Ay(e.y)))})).Else((()=>{n.assign(kg(e.x,e.y).div(Ay(e.z)))})),Fv(.5,n.add(1))})).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),gE=Tg((([e])=>{const t=Pg(0).toVar();return Cg(e.greaterThanEqual(iE),(()=>{t.assign(nE.sub(e).mul(oE.sub(rE)).div(nE.sub(iE)).add(rE))})).ElseIf(e.greaterThanEqual(sE),(()=>{t.assign(iE.sub(e).mul(aE.sub(oE)).div(iE.sub(sE)).add(oE))})).ElseIf(e.greaterThanEqual(uE),(()=>{t.assign(sE.sub(e).mul(cE.sub(aE)).div(sE.sub(uE)).add(aE))})).ElseIf(e.greaterThanEqual(lE),(()=>{t.assign(uE.sub(e).mul(hE.sub(cE)).div(uE.sub(lE)).add(cE))})).Else((()=>{t.assign(Pg(-2).mul(py(Fv(1.16,e))))})),t})).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),vE=Tg((([e,t])=>{const n=e.toVar();n.assign(Fv(2,n).sub(1));const r=Fg(n,1).toVar();return Cg(t.equal(0),(()=>{r.assign(r.zyx)})).ElseIf(t.equal(1),(()=>{r.assign(r.xzy),r.xz.mulAssign(-1)})).ElseIf(t.equal(2),(()=>{r.x.mulAssign(-1)})).ElseIf(t.equal(3),(()=>{r.assign(r.zyx),r.xz.mulAssign(-1)})).ElseIf(t.equal(4),(()=>{r.assign(r.xzy),r.xy.mulAssign(-1)})).ElseIf(t.equal(5),(()=>{r.z.mulAssign(-1)})),r})).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),yE=Tg((([e,t,n,r,i,o])=>{const s=Pg(n),a=Fg(t),u=nb(gE(s),rE,o),c=_y(u),l=vy(u),h=Fg(bE(e,a,l,r,i,o)).toVar();return Cg(c.notEqual(0),(()=>{const t=Fg(bE(e,a,l.add(1),r,i,o)).toVar();h.assign(tb(h,t,c))})),h})),bE=Tg((([e,t,n,r,i,o])=>{const s=Pg(n).toVar(),a=Fg(t),u=Pg(pE(a)).toVar(),c=Pg(jy(dE.sub(s),0)).toVar();s.assign(jy(s,dE));const l=Pg(dy(s)).toVar(),h=kg(mE(a,u).mul(l.sub(2)).add(1)).toVar();return Cg(u.greaterThan(2),(()=>{h.y.addAssign(l),u.subAssign(3)})),h.x.addAssign(u.mul(l)),h.x.addAssign(c.mul(Fv(3,fE))),h.y.addAssign(Fv(4,dy(o).sub(l))),h.x.mulAssign(r),h.y.mulAssign(i),e.uv(h).grad(kg(),kg())})),_E=Tg((({envMap:e,mipInt:t,outputDirection:n,theta:r,axis:i,CUBEUV_TEXEL_WIDTH:o,CUBEUV_TEXEL_HEIGHT:s,CUBEUV_MAX_MIP:a})=>{const u=wy(r),c=n.mul(u).add(i.cross(n).mul(xy(r))).add(i.mul(i.dot(n).mul(u.oneMinus())));return bE(e,c,t,o,s,a)})),xE=Tg((({n:e,latitudinal:t,poleAxis:n,outputDirection:r,weights:i,samples:o,dTheta:s,mipInt:a,envMap:u,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:l,CUBEUV_MAX_MIP:h})=>{const d=Fg(ub(t,n,Zy(n,r))).toVar();Cg(sy(d.equals(Fg(0))),(()=>{d.assign(Fg(r.z,0,r.x.negate()))})),d.assign(by(d));const f=Fg().toVar();return f.addAssign(i.element(Rg(0)).mul(_E({theta:0,axis:d,outputDirection:r,mipInt:a,envMap:u,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:l,CUBEUV_MAX_MIP:h}))),ew({start:Rg(1),end:e},(({i:e})=>{Cg(e.greaterThanEqual(o),(()=>{tw()}));const t=Pg(s.mul(Pg(e))).toVar();f.addAssign(i.element(e).mul(_E({theta:t.mul(-1),axis:d,outputDirection:r,mipInt:a,envMap:u,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:l,CUBEUV_MAX_MIP:h}))),f.addAssign(i.element(e).mul(_E({theta:t,axis:d,outputDirection:r,mipInt:a,envMap:u,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:l,CUBEUV_MAX_MIP:h})))})),Vg(f,1)}));let wE=null;const SE=new WeakMap;function EE(e){let t=SE.get(e);if((void 0!==t?t.pmremVersion:-1)!==e.pmremVersion){const n=e.image;if(e.isCubeTexture){if(!function(e){if(null==e)return!1;let t=0;const n=6;for(let r=0;r<n;r++)void 0!==e[r]&&t++;return t===n}(n))return null;t=wE.fromCubemap(e,t)}else{if(!function(e){return null!=e&&e.height>0}(n))return null;t=wE.fromEquirectangular(e,t)}t.pmremVersion=e.pmremVersion,SE.set(e,t)}return t.texture}class TE extends Fm{static get type(){return"PMREMNode"}constructor(e,t=null,n=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=t,this.levelNode=n,this._generator=null;const r=new Th;r.isRenderTargetTexture=!0,this._texture=Yb(r),this._width=nv(0),this._height=nv(0),this._maxMip=nv(0),this.updateBeforeType=Om}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const t=function(e){const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}updateBefore(){let e=this._pmrem;const t=e?e.pmremVersion:-1,n=this._value;t!==n.pmremVersion&&(e=!0===n.isPMREMTexture?n:EE(n),null!==e&&(this._pmrem=e,this.updateFromTexture(e)))}setup(e){null===wE&&(wE=e.createPMREMGenerator()),this.updateBefore(e);let t=this.uvNode;null===t&&e.context.getUV&&(t=e.context.getUV(this));const n=this.value;e.renderer.coordinateSystem===ql&&!0!==n.isPMREMTexture&&!0===n.isRenderTargetTexture&&(t=Fg(t.x.negate(),t.yz));let r=this.levelNode;return null===r&&e.context.getTextureLevel&&(r=e.context.getTextureLevel(this)),yE(this._texture,t,r,this._width,this._height,this._maxMip)}}const ME=Sg(TE),AE=new WeakMap;class CE extends aw{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:t}=e;let n=this.envNode;if(n.isTextureNode||n.isMaterialReferenceNode){const e=n.isTextureNode?n.value:t[n.property];let r=AE.get(e);void 0===r&&(r=ME(e),AE.set(e,r)),n=r}const r=t.envMap?j_("envMapIntensity","float",e.material):j_("environmentIntensity","float",e.scene),i=!0===t.useAnisotropy||t.anisotropy>0?Y_:w_,o=n.context(OE(uv,i)).mul(r),s=n.context(PE(S_)).mul(Math.PI).mul(r),a=Ib(o),u=Ib(s);e.context.radiance.addAssign(a),e.context.iblIrradiance.addAssign(u);const c=e.context.lightingModel.clearcoatRadiance;if(c){const e=n.context(OE(hv,E_)).mul(r),t=Ib(e);c.addAssign(t)}}}const OE=(e,t)=>{let n=null;return{getUV:()=>(null===n&&(n=p_.negate().reflect(t),n=e.mul(e).mix(n,t).normalize(),n=n.transformDirection(t_)),n),getTextureLevel:()=>e}},PE=e=>({getUV:()=>e,getTextureLevel:()=>Pg(1)}),RE=new mp;class NE extends Uw{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(RE),this.setValues(e)}setupEnvironment(e){let t=super.setupEnvironment(e);return null===t&&e.environmentNode&&(t=e.environmentNode),t?new CE(t):null}setupLightingModel(){return new tE}setupSpecular(){const e=tb(Fg(.04),sv.rgb,cv);xv.assign(e),wv.assign(1)}setupVariants(){const e=this.metalnessNode?Pg(this.metalnessNode):vx;cv.assign(e);let t=this.roughnessNode?Pg(this.roughnessNode):gx;t=pS({roughness:t}),uv.assign(t),this.setupSpecular(),sv.assign(Vg(sv.rgb.mul(e.oneMinus()),sv.a))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}const IE=new gp;class kE extends NE{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(IE),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||null!==this.clearcoatNode}get useIridescence(){return this.iridescence>0||null!==this.iridescenceNode}get useSheen(){return this.sheen>0||null!==this.sheenNode}get useAnisotropy(){return this.anisotropy>0||null!==this.anisotropyNode}get useTransmission(){return this.transmission>0||null!==this.transmissionNode}get useDispersion(){return this.dispersion>0||null!==this.dispersionNode}setupSpecular(){const e=this.iorNode?Pg(this.iorNode):Rx;Av.assign(e),xv.assign(tb(zy(Yy(Av.sub(1).div(Av.add(1))).mul(fx),Fg(1)).mul(dx),sv.rgb,cv)),wv.assign(tb(dx,1,cv))}setupLightingModel(){return new tE(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const e=this.clearcoatNode?Pg(this.clearcoatNode):bx,t=this.clearcoatRoughnessNode?Pg(this.clearcoatRoughnessNode):_x;lv.assign(e),hv.assign(pS({roughness:t}))}if(this.useSheen){const e=this.sheenNode?Fg(this.sheenNode):Sx,t=this.sheenRoughnessNode?Pg(this.sheenRoughnessNode):Ex;dv.assign(e),fv.assign(t)}if(this.useIridescence){const e=this.iridescenceNode?Pg(this.iridescenceNode):Mx,t=this.iridescenceIORNode?Pg(this.iridescenceIORNode):Ax,n=this.iridescenceThicknessNode?Pg(this.iridescenceThicknessNode):Cx;pv.assign(e),mv.assign(t),gv.assign(n)}if(this.useAnisotropy){const e=(this.anisotropyNode?kg(this.anisotropyNode):Tx).toVar();yv.assign(e.length()),Cg(yv.equal(0),(()=>{e.assign(kg(1,0))})).Else((()=>{e.divAssign(kg(yv)),yv.assign(yv.saturate())})),vv.assign(yv.pow2().mix(uv.pow2(),1)),bv.assign($_[0].mul(e.x).add($_[1].mul(e.y))),_v.assign($_[1].mul(e.x).sub($_[0].mul(e.y)))}if(this.useTransmission){const e=this.transmissionNode?Pg(this.transmissionNode):Ox,t=this.thicknessNode?Pg(this.thicknessNode):Px,n=this.attenuationDistanceNode?Pg(this.attenuationDistanceNode):Nx,r=this.attenuationColorNode?Fg(this.attenuationColorNode):Ix;if(Cv.assign(e),Ov.assign(t),Pv.assign(n),Rv.assign(r),this.useDispersion){const e=this.dispersionNode?Pg(this.dispersionNode):Ux;Nv.assign(e)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?Fg(this.clearcoatNormalNode):xx}setup(e){e.context.setupClearcoatNormal=()=>this.setupClearcoatNormal(e),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}const DE=Tg((({normal:e,lightDirection:t,builder:n})=>{const r=e.dot(t),i=kg(r.mul(.5).add(.5),0);if(n.material.gradientMap){const e=H_("gradientMap","texture").context({getUV:()=>i});return Fg(e.r)}{const e=i.fwidth().mul(.5);return tb(Fg(.7),Fg(1),ib(Pg(.7).sub(e.x),Pg(.7).add(e.x),i.x))}}));class LE extends eS{direct({lightDirection:e,lightColor:t,reflectedLight:n},r,i){const o=DE({normal:v_,lightDirection:e,builder:i}).mul(t);n.directDiffuse.addAssign(o.mul(oS({diffuseColor:sv.rgb})))}indirect({ambientOcclusion:e,irradiance:t,reflectedLight:n}){n.indirectDiffuse.addAssign(t.mul(oS({diffuseColor:sv}))),n.indirectDiffuse.mulAssign(e)}}const UE=new yp;class FE extends Uw{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(UE),this.setValues(e)}setupLightingModel(){return new LE}}class BE extends Fm{static get type(){return"MatcapUVNode"}constructor(){super("vec2")}setup(){const e=Fg(p_.z,0,p_.x.negate()).normalize(),t=p_.cross(e);return kg(e.dot(w_),t.dot(w_)).mul(.495).add(.5)}}const zE=Eg(BE),jE=new xp;class VE extends Uw{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.lights=!1,this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(jE),this.setValues(e)}setupVariants(e){const t=zE;let n;n=e.material.matcap?H_("matcap","texture").context({getUV:()=>t}):Fg(tb(.2,.8,t.y)),sv.rgb.mulAssign(n.rgb)}}const GE=new lp;class HE extends Uw{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.isPointsNodeMaterial=!0,this.lights=!1,this.transparent=!0,this.sizeNode=null,this.setDefaultValues(GE),this.setValues(e)}copy(e){return this.sizeNode=e.sizeNode,super.copy(e)}}class WE extends Fm{static get type(){return"RotateNode"}constructor(e,t){super(),this.positionNode=e,this.rotationNode=t}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:t,positionNode:n}=this;if("vec2"===this.getNodeType(e)){const e=t.cos(),r=t.sin();return qg(e,r,r.negate(),e).mul(n)}{const e=t,r=Zg(Vg(1,0,0,0),Vg(0,wy(e.x),xy(e.x).negate(),0),Vg(0,xy(e.x),wy(e.x),0),Vg(0,0,0,1)),i=Zg(Vg(wy(e.y),0,xy(e.y),0),Vg(0,1,0,0),Vg(xy(e.y).negate(),0,wy(e.y),0),Vg(0,0,0,1)),o=Zg(Vg(wy(e.z),xy(e.z).negate(),0,0),Vg(xy(e.z),wy(e.z),0,0),Vg(0,0,1,0),Vg(0,0,0,1));return r.mul(i).mul(o).mul(Vg(n,1)).xyz}}}const qE=Sg(WE),XE=new Jf;class ZE extends Uw{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this.lights=!1,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.setDefaultValues(XE),this.setValues(e)}setupPosition({object:e,camera:t,context:n}){const r=this.sizeAttenuation,{positionNode:i,rotationNode:o,scaleNode:s}=this,a=c_;let u=a_.mul(Fg(i||0)),c=kg(o_[0].xyz.length(),o_[1].xyz.length());if(null!==s&&(c=c.mul(s)),!r)if(t.isPerspectiveCamera)c=c.mul(u.z.negate());else{const e=Pg(2).div(e_.element(1).element(1));c=c.mul(e.mul(2))}let l=a.xy;if(e.center&&!0===e.center.isVector2){const e=((e,t,n)=>_g(new wb(e,t,n)))("center","vec2");l=l.sub(e.sub(.5))}l=l.mul(c);const h=Pg(o||wx),d=qE(l,h);u=Vg(u.xy.add(d),u.zw);const f=e_.mul(u);return n.vertex=a,f}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}class $E extends eS{constructor(){super(),this.shadowNode=Pg(1).toVar("shadowMask")}direct({shadowMask:e}){this.shadowNode.mulAssign(e)}finish(e){sv.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(sv.rgb)}}const YE=new pp;class KE extends Uw{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.setDefaultValues(YE),this.setValues(e)}setupLightingModel(){return new $E}}Tg((({texture:e,uv:t})=>{const n=1e-4,r=Fg().toVar();return Cg(t.x.lessThan(n),(()=>{r.assign(Fg(1,0,0))})).ElseIf(t.y.lessThan(n),(()=>{r.assign(Fg(0,1,0))})).ElseIf(t.z.lessThan(n),(()=>{r.assign(Fg(0,0,1))})).ElseIf(t.x.greaterThan(.9999),(()=>{r.assign(Fg(-1,0,0))})).ElseIf(t.y.greaterThan(.9999),(()=>{r.assign(Fg(0,-1,0))})).ElseIf(t.z.greaterThan(.9999),(()=>{r.assign(Fg(0,0,-1))})).Else((()=>{const n=.01,i=e.uv(t.add(Fg(-.01,0,0))).r.sub(e.uv(t.add(Fg(n,0,0))).r),o=e.uv(t.add(Fg(0,-.01,0))).r.sub(e.uv(t.add(Fg(0,n,0))).r),s=e.uv(t.add(Fg(0,0,-.01))).r.sub(e.uv(t.add(Fg(0,0,n))).r);r.assign(Fg(i,o,s))})),r.normalize()}));class QE{constructor(e,t){this.nodes=e,this.info=t,this.animationLoop=null,this.requestId=null,this._init()}_init(){const e=(t,n)=>{this.requestId=self.requestAnimationFrame(e),!0===this.info.autoReset&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,null!==this.animationLoop&&this.animationLoop(t,n)};e()}dispose(){self.cancelAnimationFrame(this.requestId),this.requestId=null}setAnimationLoop(e){this.animationLoop=e}}class JE{constructor(){this.weakMap=new WeakMap}get(e){let t=this.weakMap;for(let n=0;n<e.length;n++)if(t=t.get(e[n]),void 0===t)return;return t.get(e[e.length-1])}set(e,t){let n=this.weakMap;for(let t=0;t<e.length;t++){const r=e[t];!1===n.has(r)&&n.set(r,new WeakMap),n=n.get(r)}return n.set(e[e.length-1],t)}delete(e){let t=this.weakMap;for(let n=0;n<e.length;n++)if(t=t.get(e[n]),void 0===t)return!1;return t.delete(e[e.length-1])}}const eT=new op;class tT{constructor(){this.version=0,this.globalClippingCount=0,this.localClippingCount=0,this.localClippingEnabled=!1,this.localClipIntersection=!1,this.planes=[],this.parentVersion=0,this.viewNormalMatrix=new ah,this.cacheKey=0}projectPlanes(e,t){const n=e.length,r=this.planes;for(let i=0;i<n;i++){eT.copy(e[i]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const n=r[t+i],o=eT.normal;n.x=-o.x,n.y=-o.y,n.z=-o.z,n.w=eT.constant}}updateGlobal(e,t){const n=e.clippingPlanes;this.viewMatrix=t.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix);let r=!1;if(Array.isArray(n)&&0!==n.length){const e=n.length;if(e!==this.globalClippingCount){const t=[];for(let n=0;n<e;n++)t.push(new Mh);this.globalClippingCount=e,this.planes=t,r=!0}this.projectPlanes(n,0)}else 0!==this.globalClippingCount&&(this.globalClippingCount=0,this.planes=[],r=!0);e.localClippingEnabled!==this.localClippingEnabled&&(this.localClippingEnabled=e.localClippingEnabled,r=!0),r&&(this.version++,this.cacheKey=bm(this.globalClippingCount,!0===this.localClippingEnabled?1:0))}update(e,t){let n=!1;if(this!==e&&e.version!==this.parentVersion&&(this.globalClippingCount=t.isShadowNodeMaterial?0:e.globalClippingCount,this.localClippingEnabled=e.localClippingEnabled,this.planes=Array.from(e.planes),this.parentVersion=e.version,this.viewMatrix=e.viewMatrix,this.viewNormalMatrix=e.viewNormalMatrix,n=!0),this.localClippingEnabled){const e=t.clippingPlanes;if(Array.isArray(e)&&0!==e.length){const t=e.length,r=this.planes,i=this.globalClippingCount;if(n||t!==this.localClippingCount){r.length=i+t;for(let e=0;e<t;e++)r[i+e]=new Mh;this.localClippingCount=t,n=!0}this.projectPlanes(e,i)}else 0!==this.localClippingCount&&(this.localClippingCount=0,n=!0);this.localClipIntersection!==t.clipIntersection&&(this.localClipIntersection=t.clipIntersection,n=!0)}n&&(this.version+=e.version,this.cacheKey=bm(e.cacheKey,this.localClippingCount,!0===this.localClipIntersection?1:0))}}let nT=0;class rT{constructor(e,t,n,r,i,o,s,a,u){this._nodes=e,this._geometries=t,this.id=nT++,this.renderer=n,this.object=r,this.material=i,this.scene=o,this.camera=s,this.lightsNode=a,this.context=u,this.geometry=r.geometry,this.version=i.version,this.drawRange=null,this.attributes=null,this.pipeline=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.updateClipping(u.clippingContext),this.clippingContextVersion=this.clippingContext.version,this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.material.addEventListener("dispose",this.onMaterialDispose)}updateClipping(e){const t=this.material;let n=this.clippingContext;Array.isArray(t.clippingPlanes)?(n!==e&&n||(n=new tT,this.clippingContext=n),n.update(e,t)):this.clippingContext!==e&&(this.clippingContext=e)}get clippingNeedsUpdate(){return this.clippingContext.version!==this.clippingContextVersion&&(this.clippingContextVersion=this.clippingContext.version,!0)}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().monitor)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}getAttributes(){if(null!==this.attributes)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,t=this.geometry,n=[],r=new Set;for(const i of e){const e=i.node&&i.node.attribute?i.node.attribute:t.getAttribute(i.name);if(void 0===e)continue;n.push(e);const o=e.isInterleavedBufferAttribute?e.data:e;r.add(o)}return this.attributes=n,this.vertexBuffers=Array.from(r.values()),n}getVertexBuffers(){return null===this.vertexBuffers&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:t,geometry:n,group:r,drawRange:i}=this,o=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),s=this.getIndex(),a=null!==s,u=n.isInstancedBufferGeometry?n.instanceCount:e.count>1?e.count:1;if(0===u)return null;if(o.instanceCount=u,!0===e.isBatchedMesh)return o;let c=1;!0!==t.wireframe||e.isPoints||e.isLineSegments||e.isLine||e.isLineLoop||(c=2);let l=i.start*c,h=(i.start+i.count)*c;null!==r&&(l=Math.max(l,r.start*c),h=Math.min(h,(r.start+r.count)*c));const d=n.attributes.position;let f=1/0;a?f=s.count:null!=d&&(f=d.count),l=Math.max(l,0),h=Math.min(h,f);const p=h-l;return p<0||p===1/0?null:(o.vertexCount=p,o.firstVertex=l,o)}getGeometryCacheKey(){const{geometry:e}=this;let t="";for(const n of Object.keys(e.attributes).sort()){const r=e.attributes[n];t+=n+",",r.data&&(t+=r.data.stride+","),r.offset&&(t+=r.offset+","),r.itemSize&&(t+=r.itemSize+","),r.normalized&&(t+="n,")}return e.index&&(t+="index,"),t}getMaterialCacheKey(){const{object:e,material:t}=this;let n=t.customProgramCacheKey();for(const e of function(e){const t=Object.keys(e);let n=Object.getPrototypeOf(e);for(;n;){const e=Object.getOwnPropertyDescriptors(n);for(const n in e)if(void 0!==e[n]){const r=e[n];r&&"function"==typeof r.get&&t.push(n)}n=Object.getPrototypeOf(n)}return t}(t)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(e))continue;const r=t[e];let i;if(null!==r){const e=typeof r;"number"===e?i=0!==r?"1":"0":"object"===e?(i="{",r.isTexture&&(i+=r.mapping),i+="}"):i=String(r)}else i=String(r);n+=i+","}return n+=this.clippingContext.cacheKey+",",e.geometry&&(n+=this.getGeometryCacheKey()),e.skeleton&&(n+=e.skeleton.bones.length+","),e.morphTargetInfluences&&(n+=e.morphTargetInfluences.length+","),e.isBatchedMesh&&(n+=e._matricesTexture.uuid+",",null!==e._colorsTexture&&(n+=e._colorsTexture.uuid+",")),e.count>1&&(n+=e.uuid+","),vm(n)}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=this._nodes.getCacheKey(this.scene,this.lightsNode);return this.object.receiveShadow&&(e+=1),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.onDispose()}}const iT=[];class oT{constructor(e,t,n,r,i,o){this.renderer=e,this.nodes=t,this.geometries=n,this.pipelines=r,this.bindings=i,this.info=o,this.chainMaps={}}get(e,t,n,r,i,o,s){const a=this.getChainMap(s);iT[0]=e,iT[1]=t,iT[2]=o,iT[3]=i;let u=a.get(iT);return void 0===u?(u=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,t,n,r,i,o,s),a.set(iT,u)):(u.updateClipping(o.clippingContext),(u.version!==t.version||u.needsUpdate)&&(u.initialCacheKey!==u.getCacheKey()?(u.dispose(),u=this.get(e,t,n,r,i,o,s)):u.version=t.version)),u}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new JE)}dispose(){this.chainMaps={}}createRenderObject(e,t,n,r,i,o,s,a,u,c){const l=this.getChainMap(c),h=new rT(e,t,n,r,i,o,s,a,u);return h.onDispose=()=>{this.pipelines.delete(h),this.bindings.delete(h),this.nodes.delete(h),l.delete(h.getChainArray())},h}}class sT{constructor(){this.data=new WeakMap}get(e){let t=this.data.get(e);return void 0===t&&(t={},this.data.set(e,t)),t}delete(e){let t;return this.data.has(e)&&(t=this.data.get(e),this.data.delete(e)),t}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const aT=1,uT=2,cT=3,lT=4,hT=16;class dT extends sT{constructor(e){super(),this.backend=e}delete(e){const t=super.delete(e);return void 0!==t&&this.backend.destroyAttribute(e),t}update(e,t){const n=this.get(e);if(void 0===n.version)t===aT?this.backend.createAttribute(e):t===uT?this.backend.createIndexAttribute(e):t===cT?this.backend.createStorageAttribute(e):t===lT&&this.backend.createIndirectStorageAttribute(e),n.version=this._getBufferAttribute(e).version;else{const t=this._getBufferAttribute(e);(n.version<t.version||t.usage===Wl)&&(this.backend.updateAttribute(e),n.version=t.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}function fT(e){return null!==e.index?e.index.version:e.attributes.position.version}function pT(e){const t=[],n=e.index,r=e.attributes.position;if(null!==n){const e=n.array;for(let n=0,r=e.length;n<r;n+=3){const r=e[n+0],i=e[n+1],o=e[n+2];t.push(r,i,i,o,o,r)}}else{for(let e=0,n=r.array.length/3-1;e<n;e+=3){const n=e+0,r=e+1,i=e+2;t.push(n,r,r,i,i,n)}}const i=new(function(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}(t)?ff:df)(t,1);return i.version=fT(e),i}class mT extends sT{constructor(e,t){super(),this.attributes=e,this.info=t,this.wireframes=new WeakMap,this.attributeCall=new WeakMap}has(e){const t=e.geometry;return super.has(t)&&!0===this.get(t).initialized}updateForRender(e){!1===this.has(e)&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const t=e.geometry;this.get(t).initialized=!0,this.info.memory.geometries++;const n=()=>{this.info.memory.geometries--;const r=t.index,i=e.getAttributes();null!==r&&this.attributes.delete(r);for(const e of i)this.attributes.delete(e);const o=this.wireframes.get(t);void 0!==o&&this.attributes.delete(o),t.removeEventListener("dispose",n)};t.addEventListener("dispose",n)}updateAttributes(e){const t=e.getAttributes();for(const e of t)e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute?this.updateAttribute(e,cT):this.updateAttribute(e,aT);const n=this.getIndex(e);null!==n&&this.updateAttribute(n,uT);const r=e.geometry.indirect;null!==r&&this.updateAttribute(r,lT)}updateAttribute(e,t){const n=this.info.render.calls;e.isInterleavedBufferAttribute?void 0===this.attributeCall.get(e)?(this.attributes.update(e,t),this.attributeCall.set(e,n)):this.attributeCall.get(e.data)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e.data,n),this.attributeCall.set(e,n)):this.attributeCall.get(e)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e,n))}getIndirect(e){return e.geometry.indirect}getIndex(e){const{geometry:t,material:n}=e;let r=t.index;if(!0===n.wireframe){const e=this.wireframes;let n=e.get(t);void 0===n?(n=pT(t),e.set(t,n)):n.version!==fT(t)&&(this.attributes.delete(n),n=pT(t),e.set(t,n)),r=n}return r}}class gT{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0,previousFrameCalls:0,timestampCalls:0},this.compute={calls:0,frameCalls:0,timestamp:0,previousFrameCalls:0,timestampCalls:0},this.memory={geometries:0,textures:0}}update(e,t,n){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=n*(t/3):e.isPoints?this.render.points+=n*t:e.isLineSegments?this.render.lines+=n*(t/2):e.isLine?this.render.lines+=n*(t-1):console.error("THREE.WebGPUInfo: Unknown object type.")}updateTimestamp(e,t){0===this[e].timestampCalls&&(this[e].timestamp=0),this[e].timestamp+=t,this[e].timestampCalls++,this[e].timestampCalls>=this[e].previousFrameCalls&&(this[e].timestampCalls=0)}reset(){const e=this.render.frameCalls;this.render.previousFrameCalls=e;const t=this.compute.frameCalls;this.compute.previousFrameCalls=t,this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class vT{constructor(e){this.cacheKey=e,this.usedTimes=0}}class yT extends vT{constructor(e,t,n){super(e),this.vertexProgram=t,this.fragmentProgram=n}}class bT extends vT{constructor(e,t){super(e),this.computeProgram=t,this.isComputePipeline=!0}}let _T=0;class xT{constructor(e,t,n=null,r=null){this.id=_T++,this.code=e,this.stage=t,this.transforms=n,this.attributes=r,this.usedTimes=0}}class wT extends sT{constructor(e,t){super(),this.backend=e,this.nodes=t,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,t){const{backend:n}=this,r=this.get(e);if(this._needsComputeUpdate(e)){const i=r.pipeline;i&&(i.usedTimes--,i.computeProgram.usedTimes--);const o=this.nodes.getForCompute(e);let s=this.programs.compute.get(o.computeShader);void 0===s&&(i&&0===i.computeProgram.usedTimes&&this._releaseProgram(i.computeProgram),s=new xT(o.computeShader,"compute",o.transforms,o.nodeAttributes),this.programs.compute.set(o.computeShader,s),n.createProgram(s));const a=this._getComputeCacheKey(e,s);let u=this.caches.get(a);void 0===u&&(i&&0===i.usedTimes&&this._releasePipeline(i),u=this._getComputePipeline(e,s,a,t)),u.usedTimes++,s.usedTimes++,r.version=e.version,r.pipeline=u}return r.pipeline}getForRender(e,t=null){const{backend:n}=this,r=this.get(e);if(this._needsRenderUpdate(e)){const i=r.pipeline;i&&(i.usedTimes--,i.vertexProgram.usedTimes--,i.fragmentProgram.usedTimes--);const o=e.getNodeBuilderState();let s=this.programs.vertex.get(o.vertexShader);void 0===s&&(i&&0===i.vertexProgram.usedTimes&&this._releaseProgram(i.vertexProgram),s=new xT(o.vertexShader,"vertex"),this.programs.vertex.set(o.vertexShader,s),n.createProgram(s));let a=this.programs.fragment.get(o.fragmentShader);void 0===a&&(i&&0===i.fragmentProgram.usedTimes&&this._releaseProgram(i.fragmentProgram),a=new xT(o.fragmentShader,"fragment"),this.programs.fragment.set(o.fragmentShader,a),n.createProgram(a));const u=this._getRenderCacheKey(e,s,a);let c=this.caches.get(u);void 0===c?(i&&0===i.usedTimes&&this._releasePipeline(i),c=this._getRenderPipeline(e,s,a,u,t)):e.pipeline=c,c.usedTimes++,s.usedTimes++,a.usedTimes++,r.pipeline=c}return r.pipeline}delete(e){const t=this.get(e).pipeline;return t&&(t.usedTimes--,0===t.usedTimes&&this._releasePipeline(t),t.isComputePipeline?(t.computeProgram.usedTimes--,0===t.computeProgram.usedTimes&&this._releaseProgram(t.computeProgram)):(t.fragmentProgram.usedTimes--,t.vertexProgram.usedTimes--,0===t.vertexProgram.usedTimes&&this._releaseProgram(t.vertexProgram),0===t.fragmentProgram.usedTimes&&this._releaseProgram(t.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,t,n,r){n=n||this._getComputeCacheKey(e,t);let i=this.caches.get(n);return void 0===i&&(i=new bT(n,t),this.caches.set(n,i),this.backend.createComputePipeline(i,r)),i}_getRenderPipeline(e,t,n,r,i){r=r||this._getRenderCacheKey(e,t,n);let o=this.caches.get(r);return void 0===o&&(o=new yT(r,t,n),this.caches.set(r,o),e.pipeline=o,this.backend.createRenderPipeline(e,i)),o}_getComputeCacheKey(e,t){return e.id+","+t.id}_getRenderCacheKey(e,t,n){return t.id+","+n.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const t=e.code,n=e.stage;this.programs[n].delete(t)}_needsComputeUpdate(e){const t=this.get(e);return void 0===t.pipeline||t.version!==e.version}_needsRenderUpdate(e){return void 0===this.get(e).pipeline||this.backend.needsRenderUpdate(e)}}class ST extends sT{constructor(e,t,n,r,i,o){super(),this.backend=e,this.textures=n,this.pipelines=i,this.attributes=r,this.nodes=t,this.info=o,this.pipelines.bindings=this}getForRender(e){const t=e.getBindings();for(const e of t){const n=this.get(e);void 0===n.bindGroup&&(this._init(e),this.backend.createBindings(e,t),n.bindGroup=e)}return t}getForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const e of t){const n=this.get(e);void 0===n.bindGroup&&(this._init(e),this.backend.createBindings(e,t),n.bindGroup=e)}return t}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}_updateBindings(e){for(const t of e)this._update(t,e)}_init(e){for(const t of e.bindings)if(t.isSampledTexture)this.textures.updateTexture(t.texture);else if(t.isStorageBuffer){const e=t.attribute,n=e.isIndirectStorageBufferAttribute?lT:cT;this.attributes.update(e,n)}}_update(e,t){const{backend:n}=this;let r=!1;for(const t of e.bindings){if(t.isNodeUniformsGroup){if(!this.nodes.updateGroup(t))continue}if(t.isUniformBuffer){t.update()&&n.updateBinding(t)}else if(t.isSampler)t.update();else if(t.isSampledTexture){t.needsBindingsUpdate(this.textures.get(t.texture).generation)&&(r=!0);const e=t.update(),i=t.texture;e&&this.textures.updateTexture(i);const o=n.get(i);if(!0===n.isWebGPUBackend&&void 0===o.texture&&void 0===o.externalTexture&&(console.error("Bindings._update: binding should be available:",t,e,i,t.textureNode.value,r),this.textures.updateTexture(i),r=!0),!0===i.isStorageTexture){const e=this.get(i);!0===t.store?e.needsMipmap=!0:this.textures.needsMipmaps(i)&&!0===e.needsMipmap&&(this.backend.generateMipmaps(i),e.needsMipmap=!1)}}}!0===r&&this.backend.updateBindings(e,t)}}function ET(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function TT(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function MT(e){return(e.transmission>0||e.transmissionNode)&&2===e.side&&!1===e.forceSinglePass}class AT{constructor(e,t,n){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(t,n),this.lightsArray=[],this.scene=t,this.camera=n,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,t,n,r,i,o){let s=this.renderItems[this.renderItemsIndex];return void 0===s?(s={id:e.id,object:e,geometry:t,material:n,groupOrder:r,renderOrder:e.renderOrder,z:i,group:o},this.renderItems[this.renderItemsIndex]=s):(s.id=e.id,s.object=e,s.geometry=t,s.material=n,s.groupOrder=r,s.renderOrder=e.renderOrder,s.z=i,s.group=o),this.renderItemsIndex++,s}push(e,t,n,r,i,o){const s=this.getNextRenderItem(e,t,n,r,i,o);!0===e.occlusionTest&&this.occlusionQueryCount++,!0===n.transparent||n.transmission>0?(MT(n)&&this.transparentDoublePass.push(s),this.transparent.push(s)):this.opaque.push(s)}unshift(e,t,n,r,i,o){const s=this.getNextRenderItem(e,t,n,r,i,o);!0===n.transparent||n.transmission>0?(MT(n)&&this.transparentDoublePass.unshift(s),this.transparent.unshift(s)):this.opaque.unshift(s)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,t){this.opaque.length>1&&this.opaque.sort(e||ET),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(t||TT),this.transparent.length>1&&this.transparent.sort(t||TT)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,t=this.renderItems.length;e<t;e++){const t=this.renderItems[e];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.groupOrder=null,t.renderOrder=null,t.z=null,t.group=null}}}class CT{constructor(e){this.lighting=e,this.lists=new JE}get(e,t){const n=this.lists,r=[e,t];let i=n.get(r);return void 0===i&&(i=new AT(this.lighting,e,t),n.set(r,i)),i}dispose(){this.lists=new JE}}let OT=0;class PT{constructor(){this.id=OT++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new Mh,this.scissor=!1,this.scissorValue=new Mh,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.sampleCount=1,this.width=0,this.height=0,this.isRenderContext=!0}getCacheKey(){return RT(this)}}function RT(e){const{textures:t,activeCubeFace:n}=e,r=[n];for(const e of t)r.push(e.id);return ym(r)}class NT{constructor(){this.chainMaps={}}get(e,t,n=null){const r=[e,t];let i;if(null===n)i="default";else{const e=n.texture.format;i=`${n.textures.length}:${e}:${n.samples}:${n.depthBuffer}:${n.stencilBuffer}`}const o=this.getChainMap(i);let s=o.get(r);return void 0===s&&(s=new PT,o.set(r,s)),null!==n&&(s.sampleCount=0===n.samples?1:n.samples),s}getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new JE)}dispose(){this.chainMaps={}}}const IT=new Rh;class kT extends sT{constructor(e,t,n){super(),this.renderer=e,this.backend=t,this.info=n}updateRenderTarget(e,t=0){const n=this.get(e),r=0===e.samples?1:e.samples,i=n.depthTextureMips||(n.depthTextureMips={}),o=e.textures,s=this.getSize(o[0]),a=s.width>>t,u=s.height>>t;let c=e.depthTexture||i[t];const l=!0===e.depthBuffer||!0===e.stencilBuffer;let h=!1;void 0===c&&l&&(c=new dp,c.format=e.stencilBuffer?ol:il,c.type=e.stencilBuffer?tl:Qc,c.image.width=a,c.image.height=u,i[t]=c),n.width===s.width&&s.height===n.height||(h=!0,c&&(c.needsUpdate=!0,c.image.width=a,c.image.height=u)),n.width=s.width,n.height=s.height,n.textures=o,n.depthTexture=c||null,n.depth=e.depthBuffer,n.stencil=e.stencilBuffer,n.renderTarget=e,n.sampleCount!==r&&(h=!0,c&&(c.needsUpdate=!0),n.sampleCount=r);const d={sampleCount:r};for(let e=0;e<o.length;e++){const t=o[e];h&&(t.needsUpdate=!0),this.updateTexture(t,d)}if(c&&this.updateTexture(c,d),!0!==n.initialized){n.initialized=!0;const t=()=>{e.removeEventListener("dispose",t);for(let e=0;e<o.length;e++)this._destroyTexture(o[e]);c&&this._destroyTexture(c),this.delete(e)};e.addEventListener("dispose",t)}}updateTexture(e,t={}){const n=this.get(e);if(!0===n.initialized&&n.version===e.version)return;const r=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,i=this.backend;if(r&&!0===n.initialized&&(i.destroySampler(e),i.destroyTexture(e)),e.isFramebufferTexture){const t=this.renderer.getRenderTarget();e.type=t?t.texture.type:Xc}const{width:o,height:s,depth:a}=this.getSize(e);if(t.width=o,t.height=s,t.depth=a,t.needsMipmaps=this.needsMipmaps(e),t.levels=t.needsMipmaps?this.getMipLevels(e,o,s):1,r||!0===e.isStorageTexture)i.createSampler(e),i.createTexture(e,t),n.generation=e.version;else{if(!0!==n.initialized&&i.createSampler(e),e.version>0){const r=e.image;if(void 0===r)console.warn("THREE.Renderer: Texture marked for update but image is undefined.");else if(!1===r.complete)console.warn("THREE.Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const n=[];for(const t of e.images)n.push(t);t.images=n}else t.image=r;void 0!==n.isDefaultTexture&&!0!==n.isDefaultTexture||(i.createTexture(e,t),n.isDefaultTexture=!1,n.generation=e.version),!0===e.source.dataReady&&i.updateTexture(e,t),t.needsMipmaps&&0===e.mipmaps.length&&i.generateMipmaps(e)}}else i.createDefaultTexture(e),n.isDefaultTexture=!0,n.generation=e.version}if(!0!==n.initialized){n.initialized=!0,n.generation=e.version,this.info.memory.textures++;const t=()=>{e.removeEventListener("dispose",t),this._destroyTexture(e),this.info.memory.textures--};e.addEventListener("dispose",t)}n.version=e.version}getSize(e,t=IT){let n=e.images?e.images[0]:e.image;return n?(void 0!==n.image&&(n=n.image),t.width=n.width,t.height=n.height,t.depth=e.isCubeTexture?6:n.depth||1):t.width=t.height=t.depth=1,t}getMipLevels(e,t,n){let r;return r=e.isCompressedTexture?e.mipmaps.length:Math.floor(Math.log2(Math.max(t,n)))+1,r}needsMipmaps(e){return this.isEnvironmentTexture(e)||!0===e.isCompressedTexture||e.generateMipmaps}isEnvironmentTexture(e){const t=e.mapping;return t===Dc||t===Lc||t===Ic||t===kc}_destroyTexture(e){this.backend.destroySampler(e),this.backend.destroyTexture(e),this.delete(e)}}class DT extends Jd{constructor(e,t,n,r=1){super(e,t,n),this.a=r}set(e,t,n,r=1){return this.a=r,super.set(e,t,n)}copy(e){return void 0!==e.a&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}class LT extends rv{static get type(){return"ParameterNode"}constructor(e,t=null){super(e,t),this.isParameterNode=!0}getHash(){return this.uuid}generate(){return this.name}}class UT extends Dm{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this.isStackNode=!0}getNodeType(e){return this.outputNode?this.outputNode.getNodeType(e):"void"}add(e){return this.nodes.push(e),this}If(e,t){const n=new bg(t);return this._currentCond=ub(e,n),this.add(this._currentCond)}ElseIf(e,t){const n=new bg(t),r=ub(e,n);return this._currentCond.elseNode=r,this._currentCond=r,this}Else(e){return this._currentCond.elseNode=new bg(e),this}build(e,...t){const n=Ag();Mg(this);for(const t of this.nodes)t.build(e,"void");return Mg(n),this.outputNode?this.outputNode.build(e,...t):super.build(e,...t)}else(...e){return console.warn("TSL.StackNode: .else() has been renamed to .Else()."),this.Else(...e)}elseif(...e){return console.warn("TSL.StackNode: .elseif() has been renamed to .ElseIf()."),this.ElseIf(...e)}}const FT=Sg(UT);new op,new Rh,new Rh,new Rh,new ad,new Rh(0,0,-1),new Mh,new Rh,new Rh,new Mh,new sh;const BT=new Ah;mw.flipX();BT.depthTexture=new dp(1,1);const zT=new Jp(-1,1,1,-1,0,1);class jT extends Sf{constructor(e=!1){super();const t=!1===e?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new mf([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new mf(t,2))}}const VT=new jT;class GT extends Df{constructor(e=null){super(VT,e),this.camera=zT,this.isQuadMesh=!0}renderAsync(e){return e.renderAsync(this,zT)}render(e){e.render(this,zT)}}const HT=new vd,WT=new ad;class qT extends Dm{static get type(){return"SceneNode"}constructor(e=qT.BACKGROUND_BLURRINESS,t=null){super(),this.scope=e,this.scene=t}setup(e){const t=this.scope,n=null!==this.scene?this.scene:e.scene;let r;return t===qT.BACKGROUND_BLURRINESS?r=j_("backgroundBlurriness","float",n):t===qT.BACKGROUND_INTENSITY?r=j_("backgroundIntensity","float",n):t===qT.BACKGROUND_ROTATION?r=nv("mat4").label("backgroundRotation").setGroup(Jg).onRenderUpdate((()=>{const e=n.background;return null!==e&&e.isTexture&&e.mapping!==Nc?(HT.copy(n.backgroundRotation),HT.x*=-1,HT.y*=-1,HT.z*=-1,WT.makeRotationFromEuler(HT)):WT.identity(),WT})):console.error("THREE.SceneNode: Unknown scope:",t),r}}qT.BACKGROUND_BLURRINESS="backgroundBlurriness",qT.BACKGROUND_INTENSITY="backgroundIntensity",qT.BACKGROUND_ROTATION="backgroundRotation";const XT=Eg(qT,qT.BACKGROUND_BLURRINESS),ZT=Eg(qT,qT.BACKGROUND_INTENSITY),$T=Eg(qT,qT.BACKGROUND_ROTATION);const YT="point-list",KT="line-list",QT="line-strip",JT="triangle-list",eM="triangle-strip",tM="never",nM="less",rM="equal",iM="less-equal",oM="greater",sM="not-equal",aM="greater-equal",uM="always",cM="store",lM="load",hM="clear",dM="ccw",fM="none",pM="front",mM="back",gM="uint16",vM="uint32",yM={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10uFloat:"rgb10a2unorm",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Stencil8:"stencil8",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},bM="clamp-to-edge",_M="repeat",xM="mirror-repeat",wM="linear",SM="nearest",EM="zero",TM="one",MM="src",AM="one-minus-src",CM="src-alpha",OM="one-minus-src-alpha",PM="dst",RM="one-minus-dst",NM="dst-alpha",IM="one-minus-dst-alpha",kM="src-alpha-saturated",DM="constant",LM="one-minus-constant",UM="add",FM="subtract",BM="reverse-subtract",zM="min",jM="max",VM=0,GM=15,HM="keep",WM="zero",qM="replace",XM="invert",ZM="increment-clamp",$M="decrement-clamp",YM="increment-wrap",KM="decrement-wrap",QM="storage",JM="read-only-storage",eA="write-only",tA="read-only",nA="float",rA="unfilterable-float",iA="depth",oA="sint",sA="uint",aA="2d",uA="3d",cA="2d",lA="2d-array",hA="cube",dA="3d",fA="all",pA="vertex",mA="instance",gA={DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups"};new WeakMap;const vA=new sh;class yA extends $b{static get type(){return"PassTextureNode"}constructor(e,t){super(t),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return e.object.isQuadMesh&&this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class bA extends yA{static get type(){return"PassMultipleTextureNode"}constructor(e,t,n=!1){super(e,null),this.textureName=t,this.previousTexture=n}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){return new this.constructor(this.passNode,this.textureName,this.previousTexture)}}class _A extends Fm{static get type(){return"PassNode"}constructor(e,t,n,r={}){super("vec4"),this.scope=e,this.scene=t,this.camera=n,this.options=r,this._pixelRatio=1,this._width=1,this._height=1;const i=new dp;i.isRenderTargetTexture=!0,i.name="depth";const o=new Ah(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:el,...r});o.texture.name="output",o.depthTexture=i,this.renderTarget=o,this.updateBeforeType=Cm,this._textures={output:o.texture,depth:i},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=nv(0),this._cameraFar=nv(0),this._mrt=null,this.isPassNode=!0}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}isGlobal(){return!0}getTexture(e){let t=this._textures[e];if(void 0===t){t=this.renderTarget.texture.clone(),t.isRenderTargetTexture=!0,t.name=e,this._textures[e]=t,this.renderTarget.textures.push(t)}return t}getPreviousTexture(e){let t=this._previousTextures[e];return void 0===t&&(t=this.getTexture(e).clone(),t.isRenderTargetTexture=!0,this._previousTextures[e]=t),t}toggleTexture(e){const t=this._previousTextures[e];if(void 0!==t){const n=this._textures[e],r=this.renderTarget.textures.indexOf(n);this.renderTarget.textures[r]=t,this._textures[e]=t,this._previousTextures[e]=n,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let t=this._textureNodes[e];return void 0===t&&(t=_g(new bA(this,e)),t.updateTexture(),this._textureNodes[e]=t),t}getPreviousTextureNode(e="output"){let t=this._previousTextureNodes[e];return void 0===t&&(void 0===this._textureNodes[e]&&this.getTextureNode(e),t=_g(new bA(this,e,!0)),t.updateTexture(),this._previousTextureNodes[e]=t),t}getViewZNode(e="depth"){let t=this._viewZNodes[e];if(void 0===t){const n=this._cameraNear,r=this._cameraFar;this._viewZNodes[e]=t=Cw(this.getTextureNode(e),n,r)}return t}getLinearDepthNode(e="depth"){let t=this._linearDepthNodes[e];if(void 0===t){const n=this._cameraNear,r=this._cameraFar,i=this.getViewZNode(e);this._linearDepthNodes[e]=t=Mw(i,n,r)}return t}setup({renderer:e}){return this.renderTarget.samples=void 0===this.options.samples?e.samples:this.options.samples,!0===e.backend.isWebGLBackend&&(this.renderTarget.samples=0),this.renderTarget.depthTexture.isMultisampleRenderTargetTexture=this.renderTarget.samples>1,this.scope===_A.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:t}=e,{scene:n,camera:r}=this;this._pixelRatio=t.getPixelRatio();const i=t.getSize(vA);this.setSize(i.width,i.height);const o=t.getRenderTarget(),s=t.getMRT();this._cameraNear.value=r.near,this._cameraFar.value=r.far;for(const e in this._previousTextures)this.toggleTexture(e);t.setRenderTarget(this.renderTarget),t.setMRT(this._mrt),t.render(n,r),t.setRenderTarget(o),t.setMRT(s)}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget.setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}_A.COLOR="color",_A.DEPTH="depth";const xA=Tg((([e,t])=>e.mul(t).clamp())).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),wA=Tg((([e,t])=>(e=e.mul(t)).div(e.add(1)).clamp())).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),SA=Tg((([e,t])=>{const n=(e=(e=e.mul(t)).sub(.004).max(0)).mul(e.mul(6.2).add(.5)),r=e.mul(e.mul(6.2).add(1.7)).add(.06);return n.div(r).pow(2.2)})).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),EA=Tg((([e])=>{const t=e.mul(e.add(.0245786)).sub(90537e-9),n=e.mul(e.add(.432951).mul(.983729)).add(.238081);return t.div(n)})),TA=Tg((([e,t])=>{const n=Xg(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),r=Xg(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return e=e.mul(t).div(.6),e=n.mul(e),e=EA(e),(e=r.mul(e)).clamp()})).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),MA=Xg(Fg(1.6605,-.1246,-.0182),Fg(-.5876,1.1329,-.1006),Fg(-.0728,-.0083,1.1187)),AA=Xg(Fg(.6274,.0691,.0164),Fg(.3293,.9195,.088),Fg(.0433,.0113,.8956)),CA=Tg((([e])=>{const t=Fg(e).toVar(),n=Fg(t.mul(t)).toVar(),r=Fg(n.mul(n)).toVar();return Pg(15.5).mul(r.mul(n)).sub(Fv(40.14,r.mul(t))).add(Fv(31.96,r).sub(Fv(6.868,n.mul(t))).add(Fv(.4298,n).add(Fv(.1191,t).sub(.00232))))})),OA=Tg((([e,t])=>{const n=Fg(e).toVar(),r=Xg(Fg(.856627153315983,.137318972929847,.11189821299995),Fg(.0951212405381588,.761241990602591,.0767994186031903),Fg(.0482516061458583,.101439036467562,.811302368396859)),i=Xg(Fg(1.1271005818144368,-.1413297634984383,-.14132976349843826),Fg(-.11060664309660323,1.157823702216272,-.11060664309660294),Fg(-.016493938717834573,-.016493938717834257,1.2519364065950405)),o=Pg(-12.47393),s=Pg(4.026069);return n.mulAssign(t),n.assign(AA.mul(n)),n.assign(r.mul(n)),n.assign(jy(n,1e-10)),n.assign(py(n)),n.assign(n.sub(o).div(s.sub(o))),n.assign(nb(n,0,1)),n.assign(CA(n)),n.assign(i.mul(n)),n.assign($y(jy(Fg(0),n),Fg(2.2))),n.assign(MA.mul(n)),n.assign(nb(n,0,1)),n})).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),PA=Tg((([e,t])=>{const n=Pg(.76),r=Pg(.15);e=e.mul(t);const i=zy(e.r,zy(e.g,e.b)),o=ub(i.lessThan(.08),i.sub(Fv(6.25,i.mul(i))),.04);e.subAssign(o);const s=jy(e.r,jy(e.g,e.b));Cg(s.lessThan(n),(()=>e));const a=Uv(1,n),u=Uv(1,a.mul(a).div(s.add(a.sub(n))));e.mulAssign(u.div(s));const c=Uv(1,Bv(1,r.mul(s.sub(u)).add(1)));return tb(e,Fg(u),c)})).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class RA extends Dm{static get type(){return"CodeNode"}constructor(e="",t=[],n=""){super("code"),this.isCodeNode=!0,this.code=e,this.language=n,this.includes=t}isGlobal(){return!0}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const t=this.getIncludes(e);for(const n of t)n.build(e);const n=e.getCodeFromNode(this,this.getNodeType(e));return n.code=this.code,n.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}class NA extends RA{static get type(){return"FunctionNode"}constructor(e="",t=[],n=""){super(e,t,n)}getNodeType(e){return this.getNodeFunction(e).type}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const t=e.getDataFromNode(this);let n=t.nodeFunction;return void 0===n&&(n=e.parser.parseFunction(this.code),t.nodeFunction=n),n}generate(e,t){super.generate(e);const n=this.getNodeFunction(e),r=n.name,i=n.type,o=e.getCodeFromNode(this,i);""!==r&&(o.name=r);const s=e.getPropertyName(o),a=this.getNodeFunction(e).getCode(s);return o.code=a+"\n","property"===t?s:e.format(`${s}()`,i,t)}}class IA extends Map{get(e,t=null,...n){if(this.has(e))return super.get(e);if(null!==t){const r=t(...n);return this.set(e,r),r}}}new IA;class kA extends Dm{static get type(){return"FogNode"}constructor(e,t){super("float"),this.isFogNode=!0,this.colorNode=e,this.factorNode=t}getViewZNode(e){let t;const n=e.context.getViewZ;return void 0!==n&&(t=n(this)),(t||f_.z).negate()}setup(){return this.factorNode}}class DA extends kA{static get type(){return"FogRangeNode"}constructor(e,t,n){super(e),this.isFogRangeNode=!0,this.nearNode=t,this.farNode=n}setup(e){const t=this.getViewZNode(e);return ib(this.nearNode,this.farNode,t)}}const LA=Sg(DA);class UA extends kA{static get type(){return"FogExp2Node"}constructor(e,t){super(e),this.isFogExp2Node=!0,this.densityNode=t}setup(e){const t=this.getViewZNode(e),n=this.densityNode;return n.mul(n,t,t).negate().exp().oneMinus()}}const FA=Sg(UA);Sg(class extends Dm{constructor(e){super(),this.scope=e}generate(e){const{scope:t}=this,{renderer:n}=e;!0===n.backend.isWebGLBackend?e.addFlowCode(`\t// ${t}Barrier \n`):e.addLineFlowCode(`${t}Barrier()`,this)}});class BA extends Fm{static get type(){return"AtomicFunctionNode"}constructor(e,t,n,r=null){super("uint"),this.method=e,this.pointerNode=t,this.valueNode=n,this.storeNode=r}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const t=this.method,n=this.getNodeType(e),r=this.getInputType(e),i=this.pointerNode,o=this.valueNode,s=[];s.push(`&${i.build(e,r)}`),s.push(o.build(e,r));const a=`${e.getMethod(t,n)}( ${s.join(", ")} )`;if(null!==this.storeNode){const t=this.storeNode.build(e,r);e.addLineFlowCode(`${t} = ${a}`,this)}else e.addLineFlowCode(a,this)}}BA.ATOMIC_LOAD="atomicLoad",BA.ATOMIC_STORE="atomicStore",BA.ATOMIC_ADD="atomicAdd",BA.ATOMIC_SUB="atomicSub",BA.ATOMIC_MAX="atomicMax",BA.ATOMIC_MIN="atomicMin",BA.ATOMIC_AND="atomicAnd",BA.ATOMIC_OR="atomicOr",BA.ATOMIC_XOR="atomicXor";Sg(BA);let zA;function jA(e){zA=zA||new WeakMap;let t=zA.get(e);return void 0===t&&zA.set(e,t={}),t}function VA(e){const t=jA(e);return t.position||(t.position=nv(new Rh).setGroup(Jg).onRenderUpdate(((t,n)=>n.value.setFromMatrixPosition(e.matrixWorld))))}function GA(e){const t=jA(e);return t.viewPosition||(t.viewPosition=nv(new Rh).setGroup(Jg).onRenderUpdate((({camera:t},n)=>{n.value=n.value||new Rh,n.value.setFromMatrixPosition(e.matrixWorld),n.value.applyMatrix4(t.matrixWorldInverse)})))}const HA=e=>t_.transformDirection(VA(e).sub(function(e){const t=jA(e);return t.targetPosition||(t.targetPosition=nv(new Rh).setGroup(Jg).onRenderUpdate(((t,n)=>n.value.setFromMatrixPosition(e.target.matrixWorld))))}(e))),WA=(e,t)=>{for(const n of t)if(n.isAnalyticLightNode&&n.light.id===e)return n;return null},qA=new WeakMap;class XA extends Dm{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=Fg().toVar("totalDiffuse"),this.totalSpecularNode=Fg().toVar("totalSpecular"),this.outgoingLightNode=Fg().toVar("outgoingLight"),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}getHash(e){if(null===this._lightNodesHash){null===this._lightNodes&&this.setupLightsNode(e);const t=[];for(const e of this._lightNodes)t.push(e.getSelf().getHash());this._lightNodesHash="lights-"+t.join(",")}return this._lightNodesHash}analyze(e){const t=e.getDataFromNode(this);for(const n of t.nodes)n.build(e)}setupLightsNode(e){const t=[],n=this._lightNodes,r=(e=>e.sort(((e,t)=>e.id-t.id)))(this._lights),i=e.renderer.library;for(const e of r)if(e.isNode)t.push(_g(e));else{let r=null;if(null!==n&&(r=WA(e.id,n)),null===r){const n=i.getLightNodeClass(e.constructor);if(null===n){console.warn(`LightsNode.setupNodeLights: Light node not found for ${e.constructor.name}`);continue}let r=null;qA.has(e)?r=qA.get(e):(r=_g(new n(e)),qA.set(e,r)),t.push(r)}}this._lightNodes=t}setupLights(e,t){for(const n of t)n.build(e)}setup(e){null===this._lightNodes&&this.setupLightsNode(e);const t=e.context,n=t.lightingModel;let r=this.outgoingLightNode;if(n){const{_lightNodes:i,totalDiffuseNode:o,totalSpecularNode:s}=this;t.outgoingLight=r;const a=e.addStack();e.getDataFromNode(this).nodes=a.nodes,n.start(t,a,e),this.setupLights(e,i),n.indirect(t,a,e);const{backdrop:u,backdropAlpha:c}=t,{directDiffuse:l,directSpecular:h,indirectDiffuse:d,indirectSpecular:f}=t.reflectedLight;let p=l.add(d);null!==u&&(p=Fg(null!==c?c.mix(p,u):u),t.material.transparent=!0),o.assign(p),s.assign(h.add(f)),r.assign(o.add(s)),n.finish(t,a,e),r=r.bypass(e.removeStack())}return r}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}const ZA=Tg((({depthTexture:e,shadowCoord:t})=>Yb(e,t.xy).compare(t.z))),$A=Tg((({depthTexture:e,shadowCoord:t,shadow:n})=>{const r=(t,n)=>Yb(e,t).compare(n),i=j_("mapSize","vec2",n).setGroup(Jg),o=j_("radius","float",n).setGroup(Jg),s=kg(1).div(i),a=s.x.negate().mul(o),u=s.y.negate().mul(o),c=s.x.mul(o),l=s.y.mul(o),h=a.div(2),d=u.div(2),f=c.div(2),p=l.div(2);return Lv(r(t.xy.add(kg(a,u)),t.z),r(t.xy.add(kg(0,u)),t.z),r(t.xy.add(kg(c,u)),t.z),r(t.xy.add(kg(h,d)),t.z),r(t.xy.add(kg(0,d)),t.z),r(t.xy.add(kg(f,d)),t.z),r(t.xy.add(kg(a,0)),t.z),r(t.xy.add(kg(h,0)),t.z),r(t.xy,t.z),r(t.xy.add(kg(f,0)),t.z),r(t.xy.add(kg(c,0)),t.z),r(t.xy.add(kg(h,p)),t.z),r(t.xy.add(kg(0,p)),t.z),r(t.xy.add(kg(f,p)),t.z),r(t.xy.add(kg(a,l)),t.z),r(t.xy.add(kg(0,l)),t.z),r(t.xy.add(kg(c,l)),t.z)).mul(1/17)})),YA=Tg((({depthTexture:e,shadowCoord:t,shadow:n})=>{const r=(t,n)=>Yb(e,t).compare(n),i=j_("mapSize","vec2",n).setGroup(Jg),o=kg(1).div(i),s=o.x,a=o.y,u=t.xy,c=_y(u.mul(i).add(.5));return u.subAssign(c.mul(o)),Lv(r(u,t.z),r(u.add(kg(s,0)),t.z),r(u.add(kg(0,a)),t.z),r(u.add(o),t.z),tb(r(u.add(kg(s.negate(),0)),t.z),r(u.add(kg(s.mul(2),0)),t.z),c.x),tb(r(u.add(kg(s.negate(),a)),t.z),r(u.add(kg(s.mul(2),a)),t.z),c.x),tb(r(u.add(kg(0,a.negate())),t.z),r(u.add(kg(0,a.mul(2))),t.z),c.y),tb(r(u.add(kg(s,a.negate())),t.z),r(u.add(kg(s,a.mul(2))),t.z),c.y),tb(tb(r(u.add(kg(s.negate(),a.negate())),t.z),r(u.add(kg(s.mul(2),a.negate())),t.z),c.x),tb(r(u.add(kg(s.negate(),a.mul(2))),t.z),r(u.add(kg(s.mul(2),a.mul(2))),t.z),c.x),c.y)).mul(1/9)})),KA=Tg((({depthTexture:e,shadowCoord:t})=>{const n=Pg(1).toVar(),r=Yb(e).uv(t.xy).rg,i=Gy(t.z,r.x);return Cg(i.notEqual(Pg(1)),(()=>{const e=t.z.sub(r.x),o=jy(0,r.y.mul(r.y));let s=o.div(o.add(e.mul(e)));s=nb(Uv(s,.3).div(.95-.3)),n.assign(nb(jy(i,s)))})),n})),QA=Tg((({samples:e,radius:t,size:n,shadowPass:r})=>{const i=Pg(0).toVar(),o=Pg(0).toVar(),s=e.lessThanEqual(Pg(1)).select(Pg(0),Pg(2).div(e.sub(1))),a=e.lessThanEqual(Pg(1)).select(Pg(0),Pg(-1));ew({start:Rg(0),end:Rg(e),type:"int",condition:"<"},(({i:e})=>{const u=a.add(Pg(e).mul(s)),c=r.uv(Lv(vw.xy,kg(0,u).mul(t)).div(n)).x;i.addAssign(c),o.addAssign(c.mul(c))})),i.divAssign(e),o.divAssign(e);const u=my(o.sub(i.mul(i)));return kg(i,u)})),JA=Tg((({samples:e,radius:t,size:n,shadowPass:r})=>{const i=Pg(0).toVar(),o=Pg(0).toVar(),s=e.lessThanEqual(Pg(1)).select(Pg(0),Pg(2).div(e.sub(1))),a=e.lessThanEqual(Pg(1)).select(Pg(0),Pg(-1));ew({start:Rg(0),end:Rg(e),type:"int",condition:"<"},(({i:e})=>{const u=a.add(Pg(e).mul(s)),c=r.uv(Lv(vw.xy,kg(u,0).mul(t)).div(n));i.addAssign(c.x),o.addAssign(Lv(c.y.mul(c.y),c.x.mul(c.x)))})),i.divAssign(e),o.divAssign(e);const u=my(o.sub(i.mul(i)));return kg(i,u)})),eC=[ZA,$A,YA,KA];let tC=null;const nC=new GT;class rC extends Dm{static get type(){return"ShadowNode"}constructor(e,t=null){super(),this.light=e,this.shadow=t||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this.updateBeforeType=Om,this._node=null,this.isShadowNode=!0}setupShadow(e){const{object:t,renderer:n}=e;null===tC&&(tC=new Uw,tC.fragmentNode=Vg(0,0,0,1),tC.isShadowNodeMaterial=!0,tC.name="ShadowMaterial");const r=this.shadow,i=n.shadowMap.type,o=new dp(r.mapSize.width,r.mapSize.height);o.compareFunction=513;const s=e.createRenderTarget(r.mapSize.width,r.mapSize.height);if(s.depthTexture=o,r.camera.updateProjectionMatrix(),3===i){o.compareFunction=null,this.vsmShadowMapVertical=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:ul,type:el}),this.vsmShadowMapHorizontal=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:ul,type:el});const t=Yb(o),n=Yb(this.vsmShadowMapVertical.texture),i=j_("blurSamples","float",r).setGroup(Jg),s=j_("radius","float",r).setGroup(Jg),a=j_("mapSize","vec2",r).setGroup(Jg);let u=this.vsmMaterialVertical||(this.vsmMaterialVertical=new Uw);u.fragmentNode=QA({samples:i,radius:s,size:a,shadowPass:t}).context(e.getSharedContext()),u.name="VSMVertical",u=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new Uw),u.fragmentNode=JA({samples:i,radius:s,size:a,shadowPass:n}).context(e.getSharedContext()),u.name="VSMHorizontal"}const a=j_("intensity","float",r).setGroup(Jg),u=j_("bias","float",r).setGroup(Jg),c=j_("normalBias","float",r).setGroup(Jg),l=t.material.shadowPositionNode||h_;let h,d=nv(r.matrix).setGroup(Jg).mul(l.add(S_.mul(c)));if(r.camera.isOrthographicCamera||!0!==n.logarithmicDepthBuffer)d=d.xyz.div(d.w),h=d.z,n.coordinateSystem===Xl&&(h=h.mul(2).sub(1));else{const e=d.w;d=d.xy.div(e);const t=nv("float").onRenderUpdate((()=>r.camera.near)),n=nv("float").onRenderUpdate((()=>r.camera.far));h=Ow(e,t,n)}d=Fg(d.x,d.y.oneMinus(),h.add(u));const f=d.x.greaterThanEqual(0).and(d.x.lessThanEqual(1)).and(d.y.greaterThanEqual(0)).and(d.y.lessThanEqual(1)).and(d.z.lessThanEqual(1)),p=r.filterNode||eC[n.shadowMap.type]||null;if(null===p)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const m=Yb(s.texture,d),g=f.select(p({depthTexture:3===i?this.vsmShadowMapHorizontal.texture:o,shadowCoord:d,shadow:r}),Pg(1));return this.shadowMap=s,this.shadow.map=s,tb(1,g.rgb.mix(m,1),a.mul(m.a))}setup(e){if(!1!==e.renderer.shadowMap.enabled)return null!==this._node?this._node:this._node=this.setupShadow(e)}updateShadow(e){const{shadowMap:t,light:n,shadow:r}=this,{renderer:i,scene:o,camera:s}=e,a=i.shadowMap.type,u=t.depthTexture.version;this._depthVersionCached=u;const c=o.overrideMaterial;o.overrideMaterial=tC,t.setSize(r.mapSize.width,r.mapSize.height),r.updateMatrices(n),r.camera.layers.mask=s.layers.mask;const l=i.getRenderTarget(),h=i.getRenderObjectFunction();i.setRenderObjectFunction(((e,...t)=>{(!0===e.castShadow||e.receiveShadow&&3===a)&&i.renderObject(e,...t)})),i.setRenderTarget(t),i.render(o,r.camera),i.setRenderObjectFunction(h),!0!==n.isPointLight&&3===a&&this.vsmPass(i),i.setRenderTarget(l),o.overrideMaterial=c}vsmPass(e){const{shadow:t}=this;this.vsmShadowMapVertical.setSize(t.mapSize.width,t.mapSize.height),this.vsmShadowMapHorizontal.setSize(t.mapSize.width,t.mapSize.height),e.setRenderTarget(this.vsmShadowMapVertical),nC.material=this.vsmMaterialVertical,nC.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),nC.material=this.vsmMaterialHorizontal,nC.render(e)}dispose(){this.shadowMap.dispose(),this.shadowMap=null,null!==this.vsmShadowMapVertical&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),null!==this.vsmShadowMapHorizontal&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null),this.updateBeforeType=Am}updateBefore(e){const{shadow:t}=this;(t.needsUpdate||t.autoUpdate)&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(t.needsUpdate=!1))}}class iC extends aw{static get type(){return"AnalyticLightNode"}constructor(e=null){super(),this.updateType=Cm,this.light=e,this.color=new Jd,this.colorNode=nv(this.color).setGroup(Jg),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0}getCacheKey(){return bm(super.getCacheKey(),this.light.id,this.light.castShadow?1:0)}getHash(){return this.light.uuid}setupShadow(e){const{renderer:t}=e;if(!1===t.shadowMap.enabled)return;let n=this.shadowColorNode;if(null===n){const e=this.light.shadow.shadowNode;let t;t=void 0!==e?_g(e):((e,t)=>_g(new rC(e,t)))(this.light),this.shadowNode=t,this.shadowColorNode=n=this.colorNode.mul(t),this.baseColorNode=this.colorNode}this.colorNode=n}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):null!==this.shadowNode&&this.shadowNode.dispose()}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const oC=Tg((e=>{const{lightDistance:t,cutoffDistance:n,decayExponent:r}=e,i=t.pow(r).max(.01).reciprocal();return n.greaterThan(0).select(i.mul(t.div(n).pow4().oneMinus().clamp().pow2()),i)})),sC=Tg((({color:e,lightViewPosition:t,cutoffDistance:n,decayExponent:r},i)=>{const o=i.context.lightingModel,s=t.sub(f_),a=s.normalize(),u=s.length(),c=oC({lightDistance:u,cutoffDistance:n,decayExponent:r}),l=e.mul(c),h=i.context.reflectedLight;o.direct({lightDirection:a,lightColor:l,reflectedLight:h},i.stack,i)}));class aC extends iC{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=nv(0).setGroup(Jg),this.decayExponentNode=nv(0).setGroup(Jg)}update(e){const{light:t}=this;super.update(e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}setup(){sC({color:this.colorNode,lightViewPosition:GA(this.light),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode}).append()}}const uC=Tg((([e,t])=>{const n=e.x,r=e.y,i=e.z;let o=t.element(0).mul(.886227);return o=o.add(t.element(1).mul(1.023328).mul(r)),o=o.add(t.element(2).mul(1.023328).mul(i)),o=o.add(t.element(3).mul(1.023328).mul(n)),o=o.add(t.element(4).mul(.858086).mul(n).mul(r)),o=o.add(t.element(5).mul(.858086).mul(r).mul(i)),o=o.add(t.element(6).mul(i.mul(i).mul(.743125).sub(.247708))),o=o.add(t.element(7).mul(.858086).mul(n).mul(i)),o=o.add(t.element(8).mul(.429043).mul(Fv(n,n).sub(Fv(r,r)))),o})),cC=new DT;class lC extends sT{constructor(e,t){super(),this.renderer=e,this.nodes=t}update(e,t,n){const r=this.renderer,i=this.nodes.getBackgroundNode(e)||e.background;let o=!1;if(null===i)r._clearColor.getRGB(cC,zl),cC.a=r._clearColor.a;else if(!0===i.isColor)i.getRGB(cC,zl),cC.a=1,o=!0;else if(!0===i.isNode){const n=this.get(e),o=i;cC.copy(r._clearColor);let s=n.backgroundMesh;if(void 0===s){const e=lb(Vg(o).mul(ZT),{getUV:()=>$T.mul(x_),getTextureLevel:()=>XT});let t=Vx();t=t.setZ(t.w);const r=new Uw;r.name="Background.material",r.side=1,r.depthTest=!1,r.depthWrite=!1,r.fog=!1,r.lights=!1,r.vertexNode=t,r.colorNode=e,n.backgroundMeshNode=e,n.backgroundMesh=s=new Df(new fp(1,32,32),r),s.frustumCulled=!1,s.name="Background.mesh",s.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)}}const a=o.getCacheKey();n.backgroundCacheKey!==a&&(n.backgroundMeshNode.node=Vg(o).mul(ZT),n.backgroundMeshNode.needsUpdate=!0,s.material.needsUpdate=!0,n.backgroundCacheKey=a),t.unshift(s,s.geometry,s.material,0,0,null)}else console.error("THREE.Renderer: Unsupported background configuration.",i);if(!0===r.autoClear||!0===o){const e=n.clearColorValue;e.r=cC.r,e.g=cC.g,e.b=cC.b,e.a=cC.a,!0!==r.backend.isWebGLBackend&&!0!==r.alpha||(e.r*=e.a,e.g*=e.a,e.b*=e.a),n.depthClearValue=r._clearDepth,n.stencilClearValue=r._clearStencil,n.clearColor=!0===r.autoClearColor,n.clearDepth=!0===r.autoClearDepth,n.clearStencil=!0===r.autoClearStencil}else n.clearColor=!1,n.clearDepth=!1,n.clearStencil=!1}}let hC=0;class dC{constructor(e="",t=[],n=0,r=[]){this.name=e,this.bindings=t,this.index=n,this.bindingsReference=r,this.id=hC++}}class fC{constructor(e,t,n,r,i,o,s,a,u,c=[]){this.vertexShader=e,this.fragmentShader=t,this.computeShader=n,this.transforms=c,this.nodeAttributes=r,this.bindings=i,this.updateNodes=o,this.updateBeforeNodes=s,this.updateAfterNodes=a,this.monitor=u,this.usedTimes=0}createBindings(){const e=[];for(const t of this.bindings){if(!0!==t.bindings[0].groupNode.shared){const n=new dC(t.name,[],t.index,t);e.push(n);for(const e of t.bindings)n.bindings.push(e.clone())}else e.push(t)}return e}}class pC{constructor(e,t,n=null){this.isNodeAttribute=!0,this.name=e,this.type=t,this.node=n}}class mC{constructor(e,t,n){this.isNodeUniform=!0,this.name=e,this.type=t,this.node=n.getSelf()}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class gC{constructor(e,t){this.isNodeVar=!0,this.name=e,this.type=t}}class vC extends gC{constructor(e,t){super(e,t),this.needsInterpolation=!1,this.isNodeVarying=!0}}class yC{constructor(e,t,n=""){this.name=e,this.type=t,this.code=n,Object.defineProperty(this,"isNodeCode",{value:!0})}}let bC=0;class _C{constructor(e=null){this.id=bC++,this.nodesData=new WeakMap,this.parent=e}getData(e){let t=this.nodesData.get(e);return void 0===t&&null!==this.parent&&(t=this.parent.getData(e)),t}setData(e,t){this.nodesData.set(e,t)}}class xC{constructor(e,t){this.name=e,this.value=t,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class wC extends xC{constructor(e,t=0){super(e,t),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class SC extends xC{constructor(e,t=new sh){super(e,t),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class EC extends xC{constructor(e,t=new Rh){super(e,t),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class TC extends xC{constructor(e,t=new Mh){super(e,t),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class MC extends xC{constructor(e,t=new Jd){super(e,t),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class AC extends xC{constructor(e,t=new ah){super(e,t),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class CC extends xC{constructor(e,t=new ad){super(e,t),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class OC extends wC{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class PC extends SC{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class RC extends EC{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class NC extends TC{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class IC extends MC{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class kC extends AC{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class DC extends CC{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}const LC=[.125,.215,.35,.446,.526,.582],UC=20,FC=new Jp(-1,1,1,-1,0,1),BC=new Hf(90,1),zC=new Jd;let jC=null,VC=0,GC=0;const HC=(1+Math.sqrt(5))/2,WC=1/HC,qC=[new Rh(-HC,WC,0),new Rh(HC,WC,0),new Rh(-WC,0,HC),new Rh(WC,0,HC),new Rh(0,HC,-WC),new Rh(0,HC,WC),new Rh(-1,1,-1),new Rh(1,1,-1),new Rh(-1,1,1),new Rh(1,1,1)],XC=[3,1,5,0,4,2],ZC=vE(Hb(),Gb("faceIndex")).normalize(),$C=Fg(ZC.x,ZC.y.negate(),ZC.z);class YC{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}fromScene(e,t=0,n=.1,r=100){jC=this._renderer.getRenderTarget(),VC=this._renderer.getActiveCubeFace(),GC=this._renderer.getActiveMipmapLevel(),this._setSize(256);const i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}async compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=eO(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=tO(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose(),null!==this._backgroundBox&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(jC,VC,GC),e.scissorTest=!1,QC(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Ic||e.mapping===kc?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),jC=this._renderer.getRenderTarget(),VC=this._renderer.getActiveCubeFace(),GC=this._renderer.getActiveMipmapLevel();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Hc,minFilter:Hc,generateMipmaps:!1,type:el,format:rl,colorSpace:zl},r=KC(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=KC(e,t,n);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas,lodMeshes:this._lodMeshes}=function(e){const t=[],n=[],r=[],i=[];let o=e;const s=e-4+1+LC.length;for(let a=0;a<s;a++){const s=Math.pow(2,o);n.push(s);let u=1/s;a>e-4?u=LC[a-e+4-1]:0===a&&(u=0),r.push(u);const c=1/(s-2),l=-c,h=1+c,d=[l,l,h,l,h,h,l,l,h,h,l,h],f=6,p=6,m=3,g=2,v=1,y=new Float32Array(m*p*f),b=new Float32Array(g*p*f),_=new Float32Array(v*p*f);for(let e=0;e<f;e++){const t=e%3*2/3-1,n=e>2?0:-1,r=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0],i=XC[e];y.set(r,m*p*i),b.set(d,g*p*i);const o=[i,i,i,i,i,i];_.set(o,v*p*i)}const x=new Sf;x.setAttribute("position",new hf(y,m)),x.setAttribute("uv",new hf(b,g)),x.setAttribute("faceIndex",new hf(_,v)),t.push(x),i.push(new Df(x,null)),o>4&&o--}return{lodPlanes:t,sizeLods:n,sigmas:r,lodMeshes:i}}(r)),this._blurMaterial=function(e,t,n){const r=F_(new Array(UC).fill(0)),i=nv(new Rh(0,1,0)),o=nv(0),s=Pg(UC),a=nv(0),u=nv(1),c=Yb(null),l=nv(0),h=Pg(1/t),d=Pg(1/n),f=Pg(e),p={n:s,latitudinal:a,weights:r,poleAxis:i,outputDirection:$C,dTheta:o,samples:u,envMap:c,mipInt:l,CUBEUV_TEXEL_WIDTH:h,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:f},m=JC("blur");return m.uniforms=p,m.fragmentNode=xE({...p,latitudinal:a.equal(1)}),m}(r,e,t)}return r}async _compileMaterial(e){const t=new Df(this._lodPlanes[0],e);await this._renderer.compile(t,FC)}_sceneToCubeUV(e,t,n,r){const i=BC;i.near=t,i.far=n;const o=[-1,1,-1,-1,-1,-1],s=[1,1,1,-1,-1,-1],a=this._renderer,u=a.autoClear;a.getClearColor(zC),a.autoClear=!1;let c=this._backgroundBox;if(null===c){const e=new rf({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1});c=new Df(new Uf,e)}let l=!1;const h=e.background;h?h.isColor&&(c.material.color.copy(h),e.background=null,l=!0):(c.material.color.copy(zC),l=!0),a.setRenderTarget(r),a.clear(),l&&a.render(c,i);for(let t=0;t<6;t++){const n=t%3;0===n?(i.up.set(0,o[t],0),i.lookAt(s[t],0,0)):1===n?(i.up.set(0,0,o[t]),i.lookAt(0,s[t],0)):(i.up.set(0,o[t],0),i.lookAt(0,0,s[t]));const u=this._cubeSize;QC(r,n*u,t>2?u:0,u,u),a.render(e,i)}a.autoClear=u,e.background=h}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===Ic||e.mapping===kc;r?null===this._cubemapMaterial&&(this._cubemapMaterial=eO(e)):null===this._equirectMaterial&&(this._equirectMaterial=tO(e));const i=r?this._cubemapMaterial:this._equirectMaterial;i.fragmentNode.value=e;const o=this._lodMeshes[0];o.material=i;const s=this._cubeSize;QC(t,0,0,3*s,2*s),n.setRenderTarget(t),n.render(o,FC)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let t=1;t<r;t++){const n=Math.sqrt(this._sigmas[t]*this._sigmas[t]-this._sigmas[t-1]*this._sigmas[t-1]),i=qC[(r-t-1)%qC.length];this._blur(e,t-1,t,n,i)}t.autoClear=n}_blur(e,t,n,r,i){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",i),this._halfBlur(o,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,o,s){const a=this._renderer,u=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const c=this._lodMeshes[r];c.material=u;const l=u.uniforms,h=this._sizeLods[n]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,f=i/d,p=isFinite(i)?1+Math.floor(3*f):UC;p>UC&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${p} samples when the maximum is set to 20`);const m=[];let g=0;for(let e=0;e<UC;++e){const t=e/f,n=Math.exp(-t*t/2);m.push(n),0===e?g+=n:e<p&&(g+=2*n)}for(let e=0;e<m.length;e++)m[e]=m[e]/g;e.texture.frame=(e.texture.frame||0)+1,l.envMap.value=e.texture,l.samples.value=p,l.weights.array=m,l.latitudinal.value="latitudinal"===o?1:0,s&&(l.poleAxis.value=s);const{_lodMax:v}=this;l.dTheta.value=d,l.mipInt.value=v-n;const y=this._sizeLods[r];QC(t,3*y*(r>v-4?r-v+4:0),4*(this._cubeSize-y),3*y,2*y),a.setRenderTarget(t),a.render(c,FC)}}function KC(e,t,n){const r=new Ah(e,t,n);return r.texture.mapping=Uc,r.texture.name="PMREM.cubeUv",r.texture.isPMREMTexture=!0,r.scissorTest=!0,r}function QC(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function JC(e){const t=new Uw;return t.depthTest=!1,t.depthWrite=!1,t.blending=0,t.name=`PMREM_${e}`,t}function eO(e){const t=JC("cubemap");return t.fragmentNode=I_(e,$C),t}function tO(e){const t=JC("equirect");return t.fragmentNode=Yb(e,Ww($C),0),t}const nO=new WeakMap,rO=new Map([[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),iO=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),oO=e=>/e/g.test(e)?String(e).replace(/\+/g,""):(e=Number(e))+(e%1?"":".0");class sO{constructor(e,t,n){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=t,this.parser=n,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.monitor=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.flow={code:""},this.chaining=[],this.stack=FT(),this.stacks=[],this.tab="\t",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new _C,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null,this.useComparisonMethod=!1}getBindGroupsCache(){let e=nO.get(this.renderer);return void 0===e&&(e=new JE,nO.set(this.renderer,e)),e}createRenderTarget(e,t,n){return new Ah(e,t,n)}createCubeRenderTarget(e,t){return new qw(e,t)}createPMREMGenerator(){return new YC(this.renderer)}includes(e){return this.nodes.includes(e)}_getBindGroup(e,t){const n=this.getBindGroupsCache(),r=[];let i,o=!0;for(const e of t)r.push(e),o=o&&!0!==e.groupNode.shared;return o?(i=n.get(r),void 0===i&&(i=new dC(e,r,this.bindingsIndexes[e].group,r),n.set(r,i))):i=new dC(e,r,this.bindingsIndexes[e].group,r),i}getBindGroupArray(e,t){const n=this.bindings[t];let r=n[e];return void 0===r&&(void 0===this.bindingsIndexes[e]&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),n[e]=r=[]),r}getBindings(){let e=this.bindGroups;if(null===e){const t={},n=this.bindings;for(const e of Nm)for(const r in n[e]){const i=n[e][r];(t[r]||(t[r]=[])).push(...i)}e=[];for(const n in t){const r=t[n],i=this._getBindGroup(n,r);e.push(i)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort(((e,t)=>e.bindings[0].groupNode.order-t.bindings[0].groupNode.order));for(let t=0;t<e.length;t++){const n=e[t];this.bindingsIndexes[n.name].group=t,n.index=t}}setHashNode(e,t){this.hashNodes[t]=e}addNode(e){!1===this.nodes.includes(e)&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){!1===this.sequentialNodes.includes(e)&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes){e.getUpdateType()!==Am&&this.updateNodes.push(e.getSelf())}for(const e of this.sequentialNodes){const t=e.getUpdateBeforeType(),n=e.getUpdateAfterType();t!==Am&&this.updateBeforeNodes.push(e.getSelf()),n!==Am&&this.updateAfterNodes.push(e.getSelf())}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===Hc||e.magFilter===Wc||e.magFilter===Gc||e.magFilter===qc||e.minFilter===Hc||e.minFilter===Wc||e.minFilter===Gc||e.minFilter===qc}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,t){return this.flowNodes[e].push(t),t}setContext(e){this.context=e}getContext(){return this.context}getSharedContext(){return this.context,this.context}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,t=!0){const n=this.getDataFromNode(e);return void 0===n.cache&&(n.cache=new _C(t?this.getCache():null)),n.cache}isAvailable(){return!1}getVertexIndex(){console.warn("Abstract function.")}getInstanceIndex(){console.warn("Abstract function.")}getDrawIndex(){console.warn("Abstract function.")}getFrontFacing(){console.warn("Abstract function.")}getFragCoord(){console.warn("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const t=this.getDataFromNode(e);return t.usageCount=void 0===t.usageCount?1:t.usageCount+1,t.usageCount}generateTexture(){console.warn("Abstract function.")}generateTextureLod(){console.warn("Abstract function.")}generateConst(e,t=null){if(null===t&&("float"===e||"int"===e||"uint"===e?t=0:"bool"===e?t=!1:"color"===e?t=new Jd:"vec2"===e?t=new sh:"vec3"===e?t=new Rh:"vec4"===e&&(t=new Mh)),"float"===e)return oO(t);if("int"===e)return`${Math.round(t)}`;if("uint"===e)return t>=0?`${Math.round(t)}u`:"0u";if("bool"===e)return t?"true":"false";if("color"===e)return`${this.getType("vec3")}( ${oO(t.r)}, ${oO(t.g)}, ${oO(t.b)} )`;const n=this.getTypeLength(e),r=this.getComponentType(e),i=e=>this.generateConst(r,e);if(2===n)return`${this.getType(e)}( ${i(t.x)}, ${i(t.y)} )`;if(3===n)return`${this.getType(e)}( ${i(t.x)}, ${i(t.y)}, ${i(t.z)} )`;if(4===n)return`${this.getType(e)}( ${i(t.x)}, ${i(t.y)}, ${i(t.z)}, ${i(t.w)} )`;if(n>4&&t&&(t.isMatrix3||t.isMatrix4))return`${this.getType(e)}( ${t.elements.map(i).join(", ")} )`;if(n>4)return`${this.getType(e)}()`;throw new Error(`NodeBuilder: Type '${e}' not found in generate constant attempt.`)}getType(e){return"color"===e?"vec3":e}hasGeometryAttribute(e){return this.geometry&&void 0!==this.geometry.getAttribute(e)}getAttribute(e,t){const n=this.attributes;for(const t of n)if(t.name===e)return t;const r=new pC(e,t);return n.push(r),r}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return"void"===e||"property"===e||"sampler"===e||"texture"===e||"cubeTexture"===e||"storageTexture"===e||"depthTexture"===e||"texture3D"===e}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const t=e.type;if(e.isDataTexture){if(t===Kc)return"int";if(t===Qc)return"uint"}return"float"}getElementType(e){return"mat2"===e?"vec2":"mat3"===e?"vec3":"mat4"===e?"vec4":this.getComponentType(e)}getComponentType(e){if("float"===(e=this.getVectorType(e))||"bool"===e||"int"===e||"uint"===e)return e;const t=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return null===t?null:"b"===t[1]?"bool":"i"===t[1]?"int":"u"===t[1]?"uint":"float"}getVectorType(e){return"color"===e?"vec3":"texture"===e||"cubeTexture"===e||"storageTexture"===e||"texture3D"===e?"vec4":e}getTypeFromLength(e,t="float"){if(1===e)return t;const n=rO.get(e);return("float"===t?"":t[0])+n}getTypeFromArray(e){return iO.get(e.constructor)}getTypeFromAttribute(e){let t=e;e.isInterleavedBufferAttribute&&(t=e.data);const n=t.array,r=e.itemSize,i=e.normalized;let o;return e instanceof pf||!0===i||(o=this.getTypeFromArray(n)),this.getTypeFromLength(r,o)}getTypeLength(e){const t=this.getVectorType(e),n=/vec([2-4])/.exec(t);return null!==n?Number(n[1]):"float"===t||"bool"===t||"int"===t||"uint"===t?1:!0===/mat2/.test(e)?4:!0===/mat3/.test(e)?9:!0===/mat4/.test(e)?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,t){return this.getTypeFromLength(this.getTypeLength(e),t)}getIntegerType(e){const t=this.getComponentType(e);return"int"===t||"uint"===t?e:this.changeComponentType(e,"int")}addStack(){return this.stack=FT(this.stack),this.stacks.push(Ag()||this.stack),Mg(this.stack),this.stack}removeStack(){const e=this.stack;return this.stack=e.parent,Mg(this.stacks.pop()),e}getDataFromNode(e,t=this.shaderStage,n=null){let r=(n=null===n?e.isGlobal(this)?this.globalCache:this.cache:n).getData(e);return void 0===r&&(r={},n.setData(e,r)),void 0===r[t]&&(r[t]={}),r[t]}getNodeProperties(e,t="any"){const n=this.getDataFromNode(e,t);return n.properties||(n.properties={outputNode:null})}getBufferAttributeFromNode(e,t){const n=this.getDataFromNode(e);let r=n.bufferAttribute;if(void 0===r){const i=this.uniforms.index++;r=new pC("nodeAttribute"+i,t,e),this.bufferAttributes.push(r),n.bufferAttribute=r}return r}getStructTypeFromNode(e,t=this.shaderStage){const n=this.getDataFromNode(e,t);if(void 0===n.structType){const r=this.structs.index++;e.name=`StructType${r}`,this.structs[t].push(e),n.structType=e}return e}getUniformFromNode(e,t,n=this.shaderStage,r=null){const i=this.getDataFromNode(e,n,this.globalCache);let o=i.uniform;if(void 0===o){const s=this.uniforms.index++;o=new mC(r||"nodeUniform"+s,t,e),this.uniforms[n].push(o),i.uniform=o}return o}getVarFromNode(e,t=null,n=e.getNodeType(this),r=this.shaderStage){const i=this.getDataFromNode(e,r);let o=i.variable;if(void 0===o){const e=this.vars[r]||(this.vars[r]=[]);null===t&&(t="nodeVar"+e.length),o=new gC(t,n),e.push(o),i.variable=o}return o}getVaryingFromNode(e,t=null,n=e.getNodeType(this)){const r=this.getDataFromNode(e,"any");let i=r.varying;if(void 0===i){const e=this.varyings,o=e.length;null===t&&(t="nodeVarying"+o),i=new vC(t,n),e.push(i),r.varying=i}return i}getCodeFromNode(e,t,n=this.shaderStage){const r=this.getDataFromNode(e);let i=r.code;if(void 0===i){const e=this.codes[n]||(this.codes[n]=[]),o=e.length;i=new yC("nodeCode"+o,t),e.push(i),r.code=i}return i}addFlowCodeHierarchy(e,t){const{flowCodes:n,flowCodeBlock:r}=this.getDataFromNode(e);let i=!0,o=t;for(;o;){if(!0===r.get(o)){i=!1;break}o=this.getDataFromNode(o).parentNodeBlock}if(i)for(const e of n)this.addLineFlowCode(e)}addLineFlowCodeBlock(e,t,n){const r=this.getDataFromNode(e),i=r.flowCodes||(r.flowCodes=[]),o=r.flowCodeBlock||(r.flowCodeBlock=new WeakMap);i.push(t),o.set(n,!0)}addLineFlowCode(e,t=null){return""===e||(null!==t&&this.context.nodeBlock&&this.addLineFlowCodeBlock(t,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e+=";\n"),this.flow.code+=e),this}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="\t",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const t=e.getNodeType(this),n=this.flowChildNode(e,t);return this.flowsData.set(e,n),n}buildFunctionNode(e){const t=new NA,n=this.currentFunctionNode;return this.currentFunctionNode=t,t.code=this.buildFunctionCode(e),this.currentFunctionNode=n,t}flowShaderNode(e){const t=e.layout,n={[Symbol.iterator](){let e=0;const t=Object.values(this);return{next:()=>({value:t[e],done:e++>=t.length})}}};for(const e of t.inputs)n[e.name]=new LT(e.type,e.name);e.layout=null;const r=e.call(n),i=this.flowStagesNode(r,t.type);return e.layout=t,i}flowStagesNode(e,t=null){const n=this.flow,r=this.vars,i=this.cache,o=this.buildStage,s=this.stack,a={code:""};this.flow=a,this.vars={},this.cache=new _C,this.stack=FT();for(const n of Rm)this.setBuildStage(n),a.result=e.build(this,t);return a.vars=this.getVars(this.shaderStage),this.flow=n,this.vars=r,this.cache=i,this.stack=s,this.setBuildStage(o),a}getFunctionOperator(){return null}flowChildNode(e,t=null){const n=this.flow,r={code:""};return this.flow=r,r.result=e.build(this,t),this.flow=n,r}flowNodeFromShaderStage(e,t,n=null,r=null){const i=this.shaderStage;this.setShaderStage(e);const o=this.flowChildNode(t,n);return null!==r&&(o.code+=`${this.tab+r} = ${o.result};\n`),this.flowCode[e]=this.flowCode[e]+o.code,this.setShaderStage(i),o}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){console.warn("Abstract function.")}getVaryings(){console.warn("Abstract function.")}getVar(e,t){return`${this.getType(e)} ${t}`}getVars(e){let t="";const n=this.vars[e];if(void 0!==n)for(const e of n)t+=`${this.getVar(e.type,e.name)}; `;return t}getUniforms(){console.warn("Abstract function.")}getCodes(e){const t=this.codes[e];let n="";if(void 0!==t)for(const e of t)n+=e.code+"\n";return n}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){console.warn("Abstract function.")}build(){const{object:e,material:t,renderer:n}=this;if(null!==t){let e=n.library.fromMaterial(t);null===e&&(console.error(`NodeMaterial: Material "${t.type}" is not compatible.`),e=new Uw),e.build(this)}else this.addFlow("compute",e);for(const e of Rm){this.setBuildStage(e),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const t of Nm){this.setShaderStage(t);const n=this.flowNodes[t];for(const t of n)"generate"===e?this.flowNode(t):t.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getNodeUniform(e,t){if("float"===t||"int"===t||"uint"===t)return new OC(e);if("vec2"===t||"ivec2"===t||"uvec2"===t)return new PC(e);if("vec3"===t||"ivec3"===t||"uvec3"===t)return new RC(e);if("vec4"===t||"ivec4"===t||"uvec4"===t)return new NC(e);if("color"===t)return new IC(e);if("mat3"===t)return new kC(e);if("mat4"===t)return new DC(e);throw new Error(`Uniform "${t}" not declared.`)}createNodeMaterial(e="NodeMaterial"){throw new Error(`THREE.NodeBuilder: createNodeMaterial() was deprecated. Use new ${e}() instead.`)}format(e,t,n){if((t=this.getVectorType(t))===(n=this.getVectorType(n))||null===n||this.isReference(n))return e;const r=this.getTypeLength(t),i=this.getTypeLength(n);return 16===r&&9===i?`${this.getType(n)}(${e}[0].xyz, ${e}[1].xyz, ${e}[2].xyz)`:9===r&&4===i?`${this.getType(n)}(${e}[0].xy, ${e}[1].xy)`:r>4||i>4||0===i?e:r===i?`${this.getType(n)}( ${e} )`:r>i?this.format(`${e}.${"xyz".slice(0,i)}`,this.getTypeFromLength(i,this.getComponentType(t)),n):4===i&&r>1?`${this.getType(n)}( ${this.format(e,t,"vec3")}, 1.0 )`:2===r?`${this.getType(n)}( ${this.format(e,t,"vec2")}, 0.0 )`:(1===r&&i>1&&t!==this.getComponentType(n)&&(e=`${this.getType(this.getComponentType(n))}( ${e} )`),`${this.getType(n)}( ${e} )`)}getSignature(){return`// Three.js r${Cc} - Node System\n`}}class aO{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.startTime=null,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,t){let n=e.get(t);return void 0===n&&(n={renderMap:new WeakMap,frameMap:new WeakMap},e.set(t,n)),n}updateBeforeNode(e){const t=e.getUpdateBeforeType(),n=e.updateReference(this);if(t===Cm){const{frameMap:t}=this._getMaps(this.updateBeforeMap,n);t.get(n)!==this.frameId&&!1!==e.updateBefore(this)&&t.set(n,this.frameId)}else if(t===Om){const{renderMap:t}=this._getMaps(this.updateBeforeMap,n);t.get(n)!==this.renderId&&!1!==e.updateBefore(this)&&t.set(n,this.renderId)}else t===Pm&&e.updateBefore(this)}updateAfterNode(e){const t=e.getUpdateAfterType(),n=e.updateReference(this);if(t===Cm){const{frameMap:t}=this._getMaps(this.updateAfterMap,n);t.get(n)!==this.frameId&&!1!==e.updateAfter(this)&&t.set(n,this.frameId)}else if(t===Om){const{renderMap:t}=this._getMaps(this.updateAfterMap,n);t.get(n)!==this.renderId&&!1!==e.updateAfter(this)&&t.set(n,this.renderId)}else t===Pm&&e.updateAfter(this)}updateNode(e){const t=e.getUpdateType(),n=e.updateReference(this);if(t===Cm){const{frameMap:t}=this._getMaps(this.updateMap,n);t.get(n)!==this.frameId&&!1!==e.update(this)&&t.set(n,this.frameId)}else if(t===Om){const{renderMap:t}=this._getMaps(this.updateMap,n);t.get(n)!==this.renderId&&!1!==e.update(this)&&t.set(n,this.renderId)}else t===Pm&&e.update(this)}update(){this.frameId++,void 0===this.lastTime&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class uO{constructor(e,t,n=null,r="",i=!1){this.type=e,this.name=t,this.count=n,this.qualifier=r,this.isConst=i}}uO.isNodeFunctionInput=!0;class cO extends iC{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setup(e){super.setup(e);const t=e.context.lightingModel,n=this.colorNode,r=HA(this.light),i=e.context.reflectedLight;t.direct({lightDirection:r,lightColor:n,reflectedLight:i},e.stack,e)}}const lO=new ad,hO=new ad;let dO=null;class fO extends iC{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=nv(new Rh).setGroup(Jg),this.halfWidth=nv(new Rh).setGroup(Jg),this.updateType=Om}update(e){super.update(e);const{light:t}=this,n=e.camera.matrixWorldInverse;hO.identity(),lO.copy(t.matrixWorld),lO.premultiply(n),hO.extractRotation(lO),this.halfWidth.value.set(.5*t.width,0,0),this.halfHeight.value.set(0,.5*t.height,0),this.halfWidth.value.applyMatrix4(hO),this.halfHeight.value.applyMatrix4(hO)}setup(e){let t,n;super.setup(e),e.isAvailable("float32Filterable")?(t=Yb(dO.LTC_FLOAT_1),n=Yb(dO.LTC_FLOAT_2)):(t=Yb(dO.LTC_HALF_1),n=Yb(dO.LTC_HALF_2));const{colorNode:r,light:i}=this,o=e.context.lightingModel,s=GA(i),a=e.context.reflectedLight;o.directRectArea({lightColor:r,lightPosition:s,halfWidth:this.halfWidth,halfHeight:this.halfHeight,reflectedLight:a,ltc_1:t,ltc_2:n},e.stack,e)}static setLTC(e){dO=e}}class pO extends iC{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=nv(0).setGroup(Jg),this.penumbraCosNode=nv(0).setGroup(Jg),this.cutoffDistanceNode=nv(0).setGroup(Jg),this.decayExponentNode=nv(0).setGroup(Jg)}update(e){super.update(e);const{light:t}=this;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}getSpotAttenuation(e){const{coneCosNode:t,penumbraCosNode:n}=this;return ib(t,n,e)}setup(e){super.setup(e);const t=e.context.lightingModel,{colorNode:n,cutoffDistanceNode:r,decayExponentNode:i,light:o}=this,s=GA(o).sub(f_),a=s.normalize(),u=a.dot(HA(o)),c=this.getSpotAttenuation(u),l=s.length(),h=oC({lightDistance:l,cutoffDistance:r,decayExponent:i}),d=n.mul(c).mul(h),f=e.context.reflectedLight;t.direct({lightDirection:a,lightColor:d,reflectedLight:f},e.stack,e)}}class mO extends pO{static get type(){return"IESSpotLightNode"}getSpotAttenuation(e){const t=this.light.iesMap;let n=null;if(t&&!0===t.isTexture){const r=e.acos().mul(1/Math.PI);n=Yb(t,kg(r,0),0).r}else n=super.getSpotAttenuation(e);return n}}class gO extends iC{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class vO extends iC{static get type(){return"HemisphereLightNode"}constructor(e=null){super(e),this.lightPositionNode=VA(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=nv(new Jd).setGroup(Jg)}update(e){const{light:t}=this;super.update(e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}setup(e){const{colorNode:t,groundColorNode:n,lightDirectionNode:r}=this,i=__.dot(r).mul(.5).add(.5),o=tb(n,t,i);e.context.irradiance.addAssign(o)}}class yO extends iC{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const t=[];for(let e=0;e<9;e++)t.push(new Rh);this.lightProbe=F_(t)}update(e){const{light:t}=this;super.update(e);for(let e=0;e<9;e++)this.lightProbe.array[e].copy(t.sh.coefficients[e]).multiplyScalar(t.intensity)}setup(e){const t=uC(x_,this.lightProbe);e.context.irradiance.addAssign(t)}}class bO{parseFunction(){console.warn("Abstract function.")}}class _O{constructor(e,t,n="",r=""){this.type=e,this.inputs=t,this.name=n,this.precision=r}getCode(){console.warn("Abstract function.")}}_O.isNodeFunction=!0;const xO=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,wO=/[a-z_0-9]+/gi,SO="#pragma main";class EO extends _O{constructor(e){const{type:t,inputs:n,name:r,precision:i,inputsCode:o,blockCode:s,headerCode:a}=(e=>{const t=(e=e.trim()).indexOf(SO),n=-1!==t?e.slice(t+SO.length):e,r=n.match(xO);if(null!==r&&5===r.length){const i=r[4],o=[];let s=null;for(;null!==(s=wO.exec(i));)o.push(s);const a=[];let u=0;for(;u<o.length;){const e="const"===o[u][0];!0===e&&u++;let t=o[u][0];"in"===t||"out"===t||"inout"===t?u++:t="";const n=o[u++][0];let r=Number.parseInt(o[u][0]);!1===Number.isNaN(r)?u++:r=null;const i=o[u++][0];a.push(new uO(n,i,r,t,e))}const c=n.substring(r[0].length),l=void 0!==r[3]?r[3]:"";return{type:r[2],inputs:a,name:l,precision:void 0!==r[1]?r[1]:"",inputsCode:i,blockCode:c,headerCode:-1!==t?e.slice(0,t):""}}throw new Error("FunctionNode: Function is not a GLSL code.")})(e);super(t,n,r,i),this.inputsCode=o,this.blockCode=s,this.headerCode=a}getCode(e=this.name){let t;const n=this.blockCode;if(""!==n){const{type:r,inputsCode:i,headerCode:o,precision:s}=this;let a=`${r} ${e} ( ${i.trim()} )`;""!==s&&(a=`${s} ${a}`),t=o+a+n}else t="";return t}}class TO extends bO{parseFunction(e){return new EO(e)}}const MO=new WeakMap;class AO extends sT{constructor(e,t){super(),this.renderer=e,this.backend=t,this.nodeFrame=new aO,this.nodeBuilderCache=new Map,this.callHashCache=new JE,this.groupsData=new JE}updateGroup(e){const t=e.groupNode,n=t.name;if(n===ev.name)return!0;if(n===Jg.name){const t=this.get(e),n=this.nodeFrame.renderId;return t.renderId!==n&&(t.renderId=n,!0)}if(n===Qg.name){const t=this.get(e),n=this.nodeFrame.frameId;return t.frameId!==n&&(t.frameId=n,!0)}const r=[t,e];let i=this.groupsData.get(r);return void 0===i&&this.groupsData.set(r,i={}),i.version!==t.version&&(i.version=t.version,!0)}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const t=this.get(e);let n=t.nodeBuilderState;if(void 0===n){const{nodeBuilderCache:r}=this,i=this.getForRenderCacheKey(e);if(n=r.get(i),void 0===n){const t=this.backend.createNodeBuilder(e.object,this.renderer);t.scene=e.scene,t.material=e.material,t.camera=e.camera,t.context.material=e.material,t.lightsNode=e.lightsNode,t.environmentNode=this.getEnvironmentNode(e.scene),t.fogNode=this.getFogNode(e.scene),t.clippingContext=e.clippingContext,t.build(),n=this._createNodeBuilderState(t),r.set(i,n)}n.usedTimes++,t.nodeBuilderState=n}return n}delete(e){if(e.isRenderObject){const t=this.get(e).nodeBuilderState;t.usedTimes--,0===t.usedTimes&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const t=this.get(e);let n=t.nodeBuilderState;if(void 0===n){const r=this.backend.createNodeBuilder(e,this.renderer);r.build(),n=this._createNodeBuilderState(r),t.nodeBuilderState=n}return n}_createNodeBuilderState(e){return new fC(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.monitor,e.transforms)}getEnvironmentNode(e){return e.environmentNode||this.get(e).environmentNode||null}getBackgroundNode(e){return e.backgroundNode||this.get(e).backgroundNode||null}getFogNode(e){return e.fogNode||this.get(e).fogNode||null}getCacheKey(e,t){const n=[e,t],r=this.renderer.info.calls;let i=this.callHashCache.get(n);if(void 0===i||i.callId!==r){const o=this.getEnvironmentNode(e),s=this.getFogNode(e),a=[];t&&a.push(t.getCacheKey(!0)),o&&a.push(o.getCacheKey()),s&&a.push(s.getCacheKey()),a.push(this.renderer.shadowMap.enabled?1:0),i={callId:r,cacheKey:ym(a)},this.callHashCache.set(n,i)}return i.cacheKey}updateScene(e){this.updateEnvironment(e),this.updateFog(e),this.updateBackground(e)}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const t=this.get(e),n=e.background;if(n){const r=0===e.backgroundBlurriness&&t.backgroundBlurriness>0||e.backgroundBlurriness>0&&0===t.backgroundBlurriness;if(t.background!==n||r){let r=null;if(!0===n.isCubeTexture||n.mapping===Dc||n.mapping===Lc||n.mapping===Uc)if(e.backgroundBlurriness>0||n.mapping===Uc)r=ME(n);else{let e;e=!0===n.isCubeTexture?I_(n):Yb(n),r=Kw(e)}else!0===n.isTexture?r=Yb(n,mw.flipY()).setUpdateMatrix(!0):!0!==n.isColor&&console.error("WebGPUNodes: Unsupported background configuration.",n);t.backgroundNode=r,t.background=n,t.backgroundBlurriness=e.backgroundBlurriness}}else t.backgroundNode&&(delete t.backgroundNode,delete t.background)}updateFog(e){const t=this.get(e),n=e.fog;if(n){if(t.fog!==n){let e=null;if(n.isFogExp2){const t=j_("color","color",n).setGroup(Jg),r=j_("density","float",n).setGroup(Jg);e=FA(t,r)}else if(n.isFog){const t=j_("color","color",n).setGroup(Jg),r=j_("near","float",n).setGroup(Jg),i=j_("far","float",n).setGroup(Jg);e=LA(t,r,i)}else console.error("WebGPUNodes: Unsupported fog configuration.",n);t.fogNode=e,t.fog=n}}else delete t.fogNode,delete t.fog}updateEnvironment(e){const t=this.get(e),n=e.environment;if(n){if(t.environment!==n){let e=null;!0===n.isCubeTexture?e=I_(n):!0===n.isTexture?e=Yb(n):console.error("Nodes: Unsupported environment configuration.",n),t.environmentNode=e,t.environment=n}}else t.environmentNode&&(delete t.environmentNode,delete t.environment)}getNodeFrame(e=this.renderer,t=null,n=null,r=null,i=null){const o=this.nodeFrame;return o.renderer=e,o.scene=t,o.object=n,o.camera=r,o.material=i,o}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace}hasOutputChange(e){return MO.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const t=this.renderer,n=this.getOutputCacheKey(),r=Yb(e,mw).renderOutput(t.toneMapping,t.currentColorSpace);return MO.set(e,n),r}updateBefore(e){const t=e.getNodeBuilderState();for(const n of t.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(n)}updateAfter(e){const t=e.getNodeBuilderState();for(const n of t.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(n)}updateForCompute(e){const t=this.getNodeFrame(),n=this.getForCompute(e);for(const e of n.updateNodes)t.updateNode(e)}updateForRender(e){const t=this.getNodeFrameForRender(e),n=e.getNodeBuilderState();for(const e of n.updateNodes)t.updateNode(e)}needsRefresh(e){const t=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,t)}dispose(){super.dispose(),this.nodeFrame=new aO,this.nodeBuilderCache=new Map}}class CO{constructor(e,t){this.scene=e,this.camera=t}clone(){return Object.assign(new this.constructor,this)}}class OO{constructor(){this.lists=new JE}get(e,t){const n=this.lists,r=[e,t];let i=n.get(r);return void 0===i&&(i=new CO(e,t),n.set(r,i)),i}dispose(){this.lists=new JE}}class PO{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let t=null;const n=this.getMaterialNodeClass(e.type);if(null!==n){t=new n;for(const n in e)t[n]=e[n]}return t}addToneMapping(e,t){this.addType(e,t,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,t){this.addType(e,t.type,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,t){this.addClass(e,t,this.lightNodes)}addType(e,t,n){if(n.has(t))console.warn(`Redefinition of node ${t}`);else{if("function"!=typeof e)throw new Error(`Node class ${e.name} is not a class.`);if("function"==typeof t||"object"==typeof t)throw new Error(`Base class ${t} is not a class.`);n.set(t,e)}}addClass(e,t,n){if(n.has(t))console.warn(`Redefinition of node ${t.name}`);else{if("function"!=typeof e)throw new Error(`Node class ${e.name} is not a class.`);if("function"!=typeof t)throw new Error(`Base class ${t.name} is not a class.`);n.set(t,e)}}}const RO=new XA;class NO extends JE{constructor(){super()}createNode(e=[]){return(new XA).setLights(e)}getNode(e,t){if(e.isQuadMesh)return RO;const n=[e,t];let r=this.get(n);return void 0===r&&(r=this.createNode(),this.set(n,r)),r}}const IO=new $f,kO=new sh,DO=new Mh,LO=new up,UO=new ad,FO=new Mh;class BO{constructor(e,t={}){this.isRenderer=!0;const{logarithmicDepthBuffer:n=!1,alpha:r=!0,depth:i=!0,stencil:o=!1,antialias:s=!1,samples:a=0,getFallback:u=null}=t;this.domElement=e.getDomElement(),this.backend=e,this.samples=a||!0===s?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=r,this.logarithmicDepthBuffer=n,this.outputColorSpace=Bl,this.toneMapping=0,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=i,this.stencil=o,this.clippingPlanes=[],this.info=new gT,this.nodes={modelViewMatrix:null,modelNormalViewMatrix:null},this.library=new PO,this.lighting=new NO,this._getFallback=u,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new Mh(0,0,this._width,this._height),this._scissor=new Mh(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new GT(new Uw),this._quad.material.type="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const c=!0===this.alpha?0:1;this._clearColor=new DT(0,0,0,c),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:1},this.xr={enabled:!1},this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(e,t,n)=>{await this.compileAsync(e,t);const r=this._renderLists.get(e,t),i=this._renderContexts.get(e,t,this._renderTarget),o=e.overrideMaterial||n.material,s=this._objects.get(n,o,e,t,r.lightsNode,i),{fragmentShader:a,vertexShader:u}=s.getNodeBuilderState();return{fragmentShader:a,vertexShader:u}}}}async init(){if(this._initialized)throw new Error("Renderer: Backend has already been initialized.");return null!==this._initPromise||(this._initPromise=new Promise((async(e,t)=>{let n=this.backend;try{await n.init(this)}catch(e){if(null===this._getFallback)return void t(e);try{this.backend=n=this._getFallback(e),await n.init(this)}catch(e){return void t(e)}}this._nodes=new AO(this,n),this._animation=new QE(this._nodes,this.info),this._attributes=new dT(n),this._background=new lC(this,this._nodes),this._geometries=new mT(this._attributes,this.info),this._textures=new kT(this,n,this.info),this._pipelines=new wT(n,this._nodes),this._bindings=new ST(n,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new oT(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new CT(this.lighting),this._bundles=new OO,this._renderContexts=new NT,this._initialized=!0,e()}))),this._initPromise}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,t,n=null){if(!0===this._isDeviceLost)return;!1===this._initialized&&await this.init();const r=this._nodes.nodeFrame,i=r.renderId,o=this._currentRenderContext,s=this._currentRenderObjectFunction,a=this._compilationPromises,u=!0===e.isScene?e:IO;null===n&&(n=e);const c=this._renderTarget,l=this._renderContexts.get(n,t,c),h=this._activeMipmapLevel,d=[];this._currentRenderContext=l,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=d,r.renderId++,r.update(),l.depth=this.depth,l.stencil=this.stencil,l.clippingContext||(l.clippingContext=new tT),l.clippingContext.updateGlobal(this,t),u.onBeforeRender(this,e,t,c);const f=this._renderLists.get(e,t);if(f.begin(),this._projectObject(e,t,0,f),n!==e&&n.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&f.pushLight(e)})),f.finish(),null!==c){this._textures.updateRenderTarget(c,h);const e=this._textures.get(c);l.textures=e.textures,l.depthTexture=e.depthTexture}else l.textures=null,l.depthTexture=null;this._nodes.updateScene(u),this._background.update(u,f,l);const p=f.opaque,m=f.transparent,g=f.lightsNode;!0===this.opaque&&p.length>0&&this._renderObjects(p,t,u,g),!0===this.transparent&&m.length>0&&this._renderTransparents(m,t,u,g),r.renderId=i,this._currentRenderContext=o,this._currentRenderObjectFunction=s,this._compilationPromises=a,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(d)}async renderAsync(e,t){!1===this._initialized&&await this.init();const n=this._renderScene(e,t);await this.backend.resolveTimestampAsync(n,"render")}async waitForGPU(){await this.backend.waitForGPU()}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}_onDeviceLost(e){let t=`THREE.WebGPURenderer: ${e.api} Device Lost:\n\nMessage: ${e.message}`;e.reason&&(t+=`\nReason: ${e.reason}`),console.error(t),this._isDeviceLost=!0}_renderBundle(e,t,n){const{bundleGroup:r,camera:i,renderList:o}=e,s=this._currentRenderContext,a=this._bundles.get(r,i),u=this.backend.get(a);void 0===u.renderContexts&&(u.renderContexts=new Set);const c=r.version!==u.version,l=!1===u.renderContexts.has(s)||c;if(u.renderContexts.add(s),l){this.backend.beginBundle(s),(void 0===u.renderObjects||c)&&(u.renderObjects=[]),this._currentRenderBundle=a;const e=o.opaque;!0===this.opaque&&e.length>0&&this._renderObjects(e,i,t,n),this._currentRenderBundle=null,this.backend.finishBundle(s,a),u.version=r.version}else{const{renderObjects:e}=u;for(let t=0,n=e.length;t<n;t++){const n=e[t];this._nodes.needsRefresh(n)&&(this._nodes.updateBefore(n),this._nodes.updateForRender(n),this._bindings.updateForRender(n),this._nodes.updateAfter(n))}}this.backend.addBundle(s,a)}render(e,t){if(!1===this._initialized)return console.warn("THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead."),this.renderAsync(e,t);this._renderScene(e,t)}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:t}=this;if(!1===(0!==e)&&!1===(t!==zl))return null;const{width:n,height:r}=this.getDrawingBufferSize(kO),{depth:i,stencil:o}=this;let s=this._frameBufferTarget;return null===s&&(s=new Ah(n,r,{depthBuffer:i,stencilBuffer:o,type:el,format:rl,colorSpace:zl,generateMipmaps:!1,minFilter:Hc,magFilter:Hc,samples:this.samples}),s.isPostProcessingRenderTarget=!0,this._frameBufferTarget=s),s.depthBuffer=i,s.stencilBuffer=o,s.setSize(n,r),s.viewport.copy(this._viewport),s.scissor.copy(this._scissor),s.viewport.multiplyScalar(this._pixelRatio),s.scissor.multiplyScalar(this._pixelRatio),s.scissorTest=this._scissorTest,s}_renderScene(e,t,n=!0){if(!0===this._isDeviceLost)return;const r=n?this._getFrameBufferTarget():null,i=this._nodes.nodeFrame,o=i.renderId,s=this._currentRenderContext,a=this._currentRenderObjectFunction,u=!0===e.isScene?e:IO,c=this._renderTarget,l=this._activeCubeFace,h=this._activeMipmapLevel;let d;null!==r?(d=r,this.setRenderTarget(d)):d=c;const f=this._renderContexts.get(e,t,d);this._currentRenderContext=f,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,i.renderId=this.info.calls;const p=this.coordinateSystem;t.coordinateSystem!==p&&(t.coordinateSystem=p,t.updateProjectionMatrix()),!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld();let m=this._viewport,g=this._scissor,v=this._pixelRatio;null!==d&&(m=d.viewport,g=d.scissor,v=1),this.getDrawingBufferSize(kO),DO.set(0,0,kO.width,kO.height);const y=void 0===m.minDepth?0:m.minDepth,b=void 0===m.maxDepth?1:m.maxDepth;f.viewportValue.copy(m).multiplyScalar(v).floor(),f.viewportValue.width>>=h,f.viewportValue.height>>=h,f.viewportValue.minDepth=y,f.viewportValue.maxDepth=b,f.viewport=!1===f.viewportValue.equals(DO),f.scissorValue.copy(g).multiplyScalar(v).floor(),f.scissor=this._scissorTest&&!1===f.scissorValue.equals(DO),f.scissorValue.width>>=h,f.scissorValue.height>>=h,f.clippingContext||(f.clippingContext=new tT),f.clippingContext.updateGlobal(this,t),u.onBeforeRender(this,e,t,d),UO.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),LO.setFromProjectionMatrix(UO,p);const _=this._renderLists.get(e,t);if(_.begin(),this._projectObject(e,t,0,_),_.finish(),!0===this.sortObjects&&_.sort(this._opaqueSort,this._transparentSort),null!==d){this._textures.updateRenderTarget(d,h);const e=this._textures.get(d);f.textures=e.textures,f.depthTexture=e.depthTexture,f.width=e.width,f.height=e.height,f.renderTarget=d,f.depth=d.depthBuffer,f.stencil=d.stencilBuffer}else f.textures=null,f.depthTexture=null,f.width=this.domElement.width,f.height=this.domElement.height,f.depth=this.depth,f.stencil=this.stencil;f.width>>=h,f.height>>=h,f.activeCubeFace=l,f.activeMipmapLevel=h,f.occlusionQueryCount=_.occlusionQueryCount,this._nodes.updateScene(u),this._background.update(u,_,f),this.backend.beginRender(f);const{bundles:x,lightsNode:w,transparentDoublePass:S,transparent:E,opaque:T}=_;if(x.length>0&&this._renderBundles(x,u,w),!0===this.opaque&&T.length>0&&this._renderObjects(T,t,u,w),!0===this.transparent&&E.length>0&&this._renderTransparents(E,S,t,u,w),this.backend.finishRender(f),i.renderId=o,this._currentRenderContext=s,this._currentRenderObjectFunction=a,null!==r){this.setRenderTarget(c,l,h);const e=this._quad;this._nodes.hasOutputChange(d.texture)&&(e.material.fragmentNode=this._nodes.getOutputNode(d.texture),e.material.needsUpdate=!0),this._renderScene(e,e.camera,!1)}return u.onAfterRender(this,e,t,d),f}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){!1===this._initialized&&await this.init(),this._animation.setAnimationLoop(e)}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,t,n){this._width=e,this._height=t,this._pixelRatio=n,this.domElement.width=Math.floor(e*n),this.domElement.height=Math.floor(t*n),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize()}setSize(e,t,n=!0){this._width=e,this._height=t,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(t*this._pixelRatio),!0===n&&(this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize()}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){const t=this._scissor;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e}setScissor(e,t,n,r){const i=this._scissor;e.isVector4?i.copy(e):i.set(e,t,n,r)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e,this.backend.setScissorTest(e)}getViewport(e){return e.copy(this._viewport)}setViewport(e,t,n,r,i=0,o=1){const s=this._viewport;e.isVector4?s.copy(e):s.set(e,t,n,r),s.minDepth=i,s.maxDepth=o}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,t=1){this._clearColor.set(e),this._clearColor.a=t}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const t=this._currentRenderContext;return t&&this.backend.isOccluded(t,e)}clear(e=!0,t=!0,n=!0){if(!1===this._initialized)return console.warn("THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead."),this.clearAsync(e,t,n);const r=this._renderTarget||this._getFrameBufferTarget();let i=null;if(null!==r&&(this._textures.updateRenderTarget(r),i=this._textures.get(r)),this.backend.clear(e,t,n,i),null!==r&&null===this._renderTarget){const e=this._quad;this._nodes.hasOutputChange(r.texture)&&(e.material.fragmentNode=this._nodes.getOutputNode(r.texture),e.material.needsUpdate=!0),this._renderScene(e,e.camera,!1)}}clearColor(){return this.clear(!0,!1,!1)}clearDepth(){return this.clear(!1,!0,!1)}clearStencil(){return this.clear(!1,!1,!0)}async clearAsync(e=!0,t=!0,n=!0){!1===this._initialized&&await this.init(),this.clear(e,t,n)}clearColorAsync(){return this.clearAsync(!0,!1,!1)}clearDepthAsync(){return this.clearAsync(!1,!0,!1)}clearStencilAsync(){return this.clearAsync(!1,!1,!0)}get currentToneMapping(){return null!==this._renderTarget?0:this.toneMapping}get currentColorSpace(){return null!==this._renderTarget?zl:this.outputColorSpace}dispose(){this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,t=0,n=0){this._renderTarget=e,this._activeCubeFace=t,this._activeMipmapLevel=n}getRenderTarget(){return this._renderTarget}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e){if(!0===this.isDeviceLost)return;if(!1===this._initialized)return console.warn("THREE.Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e);const t=this._nodes.nodeFrame,n=t.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,t.renderId=this.info.calls;const r=this.backend,i=this._pipelines,o=this._bindings,s=this._nodes,a=Array.isArray(e)?e:[e];if(void 0===a[0]||!0!==a[0].isComputeNode)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");r.beginCompute(e);for(const t of a){if(!1===i.has(t)){const e=()=>{t.removeEventListener("dispose",e),i.delete(t),o.delete(t),s.delete(t)};t.addEventListener("dispose",e);const n=t.onInitFunction;null!==n&&n.call(t,{renderer:this})}s.updateForCompute(t),o.updateForCompute(t);const n=o.getForCompute(t),a=i.getForCompute(t,n);r.compute(e,t,n,a)}r.finishCompute(e),t.renderId=n}async computeAsync(e){!1===this._initialized&&await this.init(),this.compute(e),await this.backend.resolveTimestampAsync(e,"compute")}async hasFeatureAsync(e){return!1===this._initialized&&await this.init(),this.backend.hasFeature(e)}hasFeature(e){return!1===this._initialized?(console.warn("THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead."),!1):this.backend.hasFeature(e)}copyFramebufferToTexture(e,t=null){if(null!==t)if(t.isVector2)t=FO.set(t.x,t.y,e.image.width,e.image.height).floor();else{if(!t.isVector4)return void console.error("THREE.Renderer.copyFramebufferToTexture: Invalid rectangle.");t=FO.copy(t).floor()}else t=FO.set(0,0,e.image.width,e.image.height);let n,r=this._currentRenderContext;null!==r?n=r.renderTarget:(n=this._renderTarget||this._getFrameBufferTarget(),null!==n&&(this._textures.updateRenderTarget(n),r=this._textures.get(n))),this._textures.updateTexture(e,{renderTarget:n}),this.backend.copyFramebufferToTexture(e,r,t)}copyTextureToTexture(e,t,n=null,r=null,i=0){this._textures.updateTexture(e),this._textures.updateTexture(t),this.backend.copyTextureToTexture(e,t,n,r,i)}readRenderTargetPixelsAsync(e,t,n,r,i,o=0,s=0){return this.backend.copyTextureToBuffer(e.textures[o],t,n,r,i,s)}_projectObject(e,t,n,r){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)r.pushLight(e);else if(e.isSprite){if(!e.frustumCulled||LO.intersectsSprite(e)){!0===this.sortObjects&&FO.setFromMatrixPosition(e.matrixWorld).applyMatrix4(UO);const{geometry:t,material:i}=e;i.visible&&r.push(e,t,i,n,FO.z,null)}}else if(e.isLineLoop)console.error("THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||LO.intersectsObject(e))){const{geometry:t,material:i}=e;if(!0===this.sortObjects&&(null===t.boundingSphere&&t.computeBoundingSphere(),FO.copy(t.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(UO)),Array.isArray(i)){const o=t.groups;for(let s=0,a=o.length;s<a;s++){const a=o[s],u=i[a.materialIndex];u&&u.visible&&r.push(e,t,u,n,FO.z,a)}}else i.visible&&r.push(e,t,i,n,FO.z,null)}if(!0===e.isBundleGroup&&void 0!==this.backend.beginBundle){const n=r;(r=this._renderLists.get(e,t)).begin(),n.pushBundle({bundleGroup:e,camera:t,renderList:r}),r.finish()}const i=e.children;for(let e=0,o=i.length;e<o;e++)this._projectObject(i[e],t,n,r)}_renderBundles(e,t,n){for(const r of e)this._renderBundle(r,t,n)}_renderTransparents(e,t,n,r,i){if(t.length>0){for(const{material:e}of t)e.side=1;this._renderObjects(t,n,r,i,"backSide");for(const{material:e}of t)e.side=0;this._renderObjects(e,n,r,i);for(const{material:e}of t)e.side=2}else this._renderObjects(e,n,r,i)}_renderObjects(e,t,n,r,i=null){for(let o=0,s=e.length;o<s;o++){const s=e[o],{object:a,geometry:u,material:c,group:l}=s;if(t.isArrayCamera){const e=t.cameras;for(let t=0,o=e.length;t<o;t++){const o=e[t];if(a.layers.test(o.layers)){const e=o.viewport,t=void 0===e.minDepth?0:e.minDepth,s=void 0===e.maxDepth?1:e.maxDepth,h=this._currentRenderContext.viewportValue;h.copy(e).multiplyScalar(this._pixelRatio).floor(),h.minDepth=t,h.maxDepth=s,this.backend.updateViewport(this._currentRenderContext),this._currentRenderObjectFunction(a,n,o,u,c,l,r,i)}}}else this._currentRenderObjectFunction(a,n,t,u,c,l,r,i)}}renderObject(e,t,n,r,i,o,s,a=null){let u,c,l;if(e.onBeforeRender(this,t,n,r,i,o),null!==t.overrideMaterial){const e=t.overrideMaterial;i.positionNode&&i.positionNode.isNode&&(u=e.positionNode,e.positionNode=i.positionNode),e.isShadowNodeMaterial&&(e.side=null===i.shadowSide?i.side:i.shadowSide,i.depthNode&&i.depthNode.isNode&&(l=e.depthNode,e.depthNode=i.depthNode),i.shadowNode&&i.shadowNode.isNode&&(c=e.fragmentNode,e.fragmentNode=i.shadowNode),this.localClippingEnabled&&(i.clipShadows?(e.clippingPlanes!==i.clippingPlanes&&(e.clippingPlanes=i.clippingPlanes,e.needsUpdate=!0),e.clipIntersection!==i.clipIntersection&&(e.clipIntersection=i.clipIntersection)):Array.isArray(e.clippingPlanes)&&(e.clippingPlanes=null,e.needsUpdate=!0))),i=e}!0===i.transparent&&2===i.side&&!1===i.forceSinglePass?(i.side=1,this._handleObjectFunction(e,i,t,n,s,o,"backSide"),i.side=0,this._handleObjectFunction(e,i,t,n,s,o,a),i.side=2):this._handleObjectFunction(e,i,t,n,s,o,a),void 0!==u&&(t.overrideMaterial.positionNode=u),void 0!==l&&(t.overrideMaterial.depthNode=l),void 0!==c&&(t.overrideMaterial.fragmentNode=c),e.onAfterRender(this,t,n,r,i,o)}_renderObjectDirect(e,t,n,r,i,o,s){const a=this._objects.get(e,t,n,r,i,this._currentRenderContext,s);a.drawRange=e.geometry.drawRange,a.group=o;const u=this._nodes.needsRefresh(a);if(u&&(this._nodes.updateBefore(a),this._geometries.updateForRender(a),this._nodes.updateForRender(a),this._bindings.updateForRender(a)),this._pipelines.updateForRender(a),null!==this._currentRenderBundle){this.backend.get(this._currentRenderBundle).renderObjects.push(a),a.bundle=this._currentRenderBundle.scene}this.backend.draw(a,this.info),u&&this._nodes.updateAfter(a)}_createObjectPipeline(e,t,n,r,i,o){const s=this._objects.get(e,t,n,r,i,this._currentRenderContext,o);this._nodes.updateBefore(s),this._geometries.updateForRender(s),this._nodes.updateForRender(s),this._bindings.updateForRender(s),this._pipelines.getForRender(s,this._compilationPromises),this._nodes.updateAfter(s)}get compile(){return this.compileAsync}}class zO{constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}clone(){return Object.assign(new this.constructor,this)}}class jO extends zO{constructor(e,t=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=t}get byteLength(){return(e=this._buffer.byteLength)+(hT-e%hT)%hT;var e}get buffer(){return this._buffer}update(){return!0}}class VO extends jO{constructor(e,t=null){super(e,t),this.isUniformBuffer=!0}}let GO=0;class HO extends VO{constructor(e,t){super("UniformBuffer_"+GO++,e?e.value:null),this.nodeUniform=e,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class WO extends VO{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}get values(){return null===this._values&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(null===e){const t=this.byteLength;e=new Float32Array(new ArrayBuffer(t)),this._buffer=e}return e}get byteLength(){let e=0;for(let t=0,n=this.uniforms.length;t<n;t++){const n=this.uniforms[t],{boundary:r,itemSize:i}=n,o=e%hT;0!==o&&hT-o-r<0?e+=hT-o:o%r!=0&&(e+=o%r),n.offset=e/this.bytesPerElement,e+=i*this.bytesPerElement}return Math.ceil(e/hT)*hT}update(){let e=!1;for(const t of this.uniforms)!0===this.updateByType(t)&&(e=!0);return e}updateByType(e){return e.isNumberUniform?this.updateNumber(e):e.isVector2Uniform?this.updateVector2(e):e.isVector3Uniform?this.updateVector3(e):e.isVector4Uniform?this.updateVector4(e):e.isColorUniform?this.updateColor(e):e.isMatrix3Uniform?this.updateMatrix3(e):e.isMatrix4Uniform?this.updateMatrix4(e):void console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset;if(n[i]!==r){this.buffer[i]=n[i]=r,t=!0}return t}updateVector2(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset;if(n[i+0]!==r.x||n[i+1]!==r.y){const e=this.buffer;e[i+0]=n[i+0]=r.x,e[i+1]=n[i+1]=r.y,t=!0}return t}updateVector3(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset;if(n[i+0]!==r.x||n[i+1]!==r.y||n[i+2]!==r.z){const e=this.buffer;e[i+0]=n[i+0]=r.x,e[i+1]=n[i+1]=r.y,e[i+2]=n[i+2]=r.z,t=!0}return t}updateVector4(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset;if(n[i+0]!==r.x||n[i+1]!==r.y||n[i+2]!==r.z||n[i+4]!==r.w){const e=this.buffer;e[i+0]=n[i+0]=r.x,e[i+1]=n[i+1]=r.y,e[i+2]=n[i+2]=r.z,e[i+3]=n[i+3]=r.w,t=!0}return t}updateColor(e){let t=!1;const n=this.values,r=e.getValue(),i=e.offset;if(n[i+0]!==r.r||n[i+1]!==r.g||n[i+2]!==r.b){const e=this.buffer;e[i+0]=n[i+0]=r.r,e[i+1]=n[i+1]=r.g,e[i+2]=n[i+2]=r.b,t=!0}return t}updateMatrix3(e){let t=!1;const n=this.values,r=e.getValue().elements,i=e.offset;if(n[i+0]!==r[0]||n[i+1]!==r[1]||n[i+2]!==r[2]||n[i+4]!==r[3]||n[i+5]!==r[4]||n[i+6]!==r[5]||n[i+8]!==r[6]||n[i+9]!==r[7]||n[i+10]!==r[8]){const e=this.buffer;e[i+0]=n[i+0]=r[0],e[i+1]=n[i+1]=r[1],e[i+2]=n[i+2]=r[2],e[i+4]=n[i+4]=r[3],e[i+5]=n[i+5]=r[4],e[i+6]=n[i+6]=r[5],e[i+8]=n[i+8]=r[6],e[i+9]=n[i+9]=r[7],e[i+10]=n[i+10]=r[8],t=!0}return t}updateMatrix4(e){let t=!1;const n=this.values,r=e.getValue().elements,i=e.offset;if(!1===function(e,t,n){for(let r=0,i=t.length;r<i;r++)if(e[n+r]!==t[r])return!1;return!0}(n,r,i)){this.buffer.set(r,i),function(e,t,n){for(let r=0,i=t.length;r<i;r++)e[n+r]=t[r]}(n,r,i),t=!0}return t}}let qO=0;class XO extends WO{constructor(e,t){super(e),this.id=qO++,this.groupNode=t,this.isNodeUniformsGroup=!0}getNodes(){const e=[];for(const t of this.uniforms){const n=t.nodeUniform.node;if(!n)throw new Error("NodeUniformsGroup: Uniform has no node.");e.push(n)}return e}}let ZO=0;class $O extends zO{constructor(e,t){super(e),this.id=ZO++,this.texture=t,this.version=t?t.version:0,this.store=!1,this.generation=null,this.isSampledTexture=!0}needsBindingsUpdate(e){const{texture:t}=this;return e!==this.generation?(this.generation=e,!0):t.isVideoTexture}update(){const{texture:e,version:t}=this;return t!==e.version&&(this.version=e.version,!0)}}class YO extends $O{constructor(e,t,n,r=null){super(e,t?t.value:null),this.textureNode=t,this.groupNode=n,this.access=r}needsBindingsUpdate(e){return this.textureNode.value!==this.texture||super.needsBindingsUpdate(e)}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class KO extends YO{constructor(e,t,n,r){super(e,t,n,r),this.isSampledCubeTexture=!0}}class QO extends YO{constructor(e,t,n,r){super(e,t,n,r),this.isSampledTexture3D=!0}}const JO={atan2:"atan",textureDimensions:"textureSize",equals:"equal"},eP={low:"lowp",medium:"mediump",high:"highp"},tP={swizzleAssign:!0,storageBuffer:!1},nP="\nprecision highp float;\nprecision highp int;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp sampler2DArray;\n\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\n\nprecision lowp sampler2DShadow;\n";class rP extends sO{constructor(e,t){super(e,t,new TO),this.uniformGroups={},this.transforms=[],this.extensions={},this.useComparisonMethod=!0}needsColorSpaceToLinearSRGB(e){return!0===e.isVideoTexture&&e.colorSpace!==Fl}getMethod(e){return JO[e]||e}getOutputStructName(){return""}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),r=[];for(const e of t.inputs)r.push(this.getType(e.type)+" "+e.name);return`${this.getType(t.type)} ${t.name}( ${r.join(", ")} ) {\n\n\t${n.vars}\n\n${n.code}\n\treturn ${n.result};\n\n}`}setupPBO(e){const t=e.value;if(void 0===t.pbo){const e=t.array,n=t.count*t.itemSize,{itemSize:r}=t,i=t.array.constructor.name.toLowerCase().includes("int");let o=i?al:sl;2===r?o=i?cl:ul:3===r?o=i?1032:nl:4===r&&(o=i?ll:rl);const s={Float32Array:Jc,Uint8Array:Xc,Uint16Array:Yc,Uint32Array:Qc,Int8Array:Zc,Int16Array:$c,Int32Array:Kc,Uint8ClampedArray:Xc},a=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(n/r))));let u=Math.ceil(n/r/a);a*u*r<n&&u++;const c=a*u*r,l=new e.constructor(c);l.set(e,0),t.array=l;const h=new ep(t.array,a,u,o,s[t.array.constructor.name]||Jc);h.needsUpdate=!0,h.isPBOTexture=!0;const d=new $b(h,null,null);d.setPrecision("high"),t.pboNode=d,t.pbo=d.value,this.getUniformFromNode(t.pboNode,"texture",this.shaderStage,this.context.label)}}getPropertyName(e,t=this.shaderStage){return e.isNodeUniform&&!0!==e.node.isTextureNode&&!0!==e.node.isBufferNode?t.charAt(0)+"_"+e.name:super.getPropertyName(e,t)}generatePBO(e){const{node:t,indexNode:n}=e,r=t.value;if(this.renderer.backend.has(r)){this.renderer.backend.get(r).pbo=r.pbo}const i=this.getUniformFromNode(r.pboNode,"texture",this.shaderStage,this.context.label),o=this.getPropertyName(i);this.increaseUsage(n);const s=n.build(this,"uint"),a=this.getDataFromNode(e);let u=a.propertyName;if(void 0===u){const n=this.getVarFromNode(e);u=this.getPropertyName(n);const i=this.getDataFromNode(t);let c=i.propertySizeName;void 0===c&&(c=u+"Size",this.getVarFromNode(t,c,"uint"),this.addLineFlowCode(`${c} = uint( textureSize( ${o}, 0 ).x )`,e),i.propertySizeName=c);const{itemSize:l}=r,h="."+Im.join("").slice(0,l),d=`ivec2(${s} % ${c}, ${s} / ${c})`,f=this.generateTextureLoad(null,o,d,null,"0");let p="vec4";r.pbo.type===Qc?p="uvec4":r.pbo.type===Kc&&(p="ivec4"),this.addLineFlowCode(`${u} = ${p}(${f})${h}`,e),a.propertyName=u}return u}generateTextureLoad(e,t,n,r,i="0"){return r?`texelFetch( ${t}, ivec3( ${n}, ${r} ), ${i} )`:`texelFetch( ${t}, ${n}, ${i} )`}generateTexture(e,t,n,r){return e.isDepthTexture?`texture( ${t}, ${n} ).x`:(r&&(n=`vec3( ${n}, ${r} )`),`texture( ${t}, ${n} )`)}generateTextureLevel(e,t,n,r){return`textureLod( ${t}, ${n}, ${r} )`}generateTextureBias(e,t,n,r){return`texture( ${t}, ${n}, ${r} )`}generateTextureGrad(e,t,n,r){return`textureGrad( ${t}, ${n}, ${r[0]}, ${r[1]} )`}generateTextureCompare(e,t,n,r,i,o=this.shaderStage){if("fragment"===o)return`texture( ${t}, vec3( ${n}, ${r} ) )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${o} shader.`)}getVars(e){const t=[],n=this.vars[e];if(void 0!==n)for(const e of n)t.push(`${this.getVar(e.type,e.name)};`);return t.join("\n\t")}getUniforms(e){const t=this.uniforms[e],n=[],r={};for(const i of t){let t=null,o=!1;if("texture"===i.type){const e=i.node.value;let n="";!0===e.isDataTexture&&(e.type===Qc?n="u":e.type===Kc&&(n="i")),t=e.compareFunction?`sampler2DShadow ${i.name};`:!0===e.isDataArrayTexture||!0===e.isCompressedArrayTexture?`${n}sampler2DArray ${i.name};`:`${n}sampler2D ${i.name};`}else if("cubeTexture"===i.type)t=`samplerCube ${i.name};`;else if("texture3D"===i.type)t=`sampler3D ${i.name};`;else if("buffer"===i.type){const e=i.node,n=this.getType(e.bufferType),r=e.bufferCount,o=r>0?r:"";t=`${e.name} {\n\t${n} ${i.name}[${o}];\n};\n`}else{t=`${this.getVectorType(i.type)} ${this.getPropertyName(i,e)};`,o=!0}const s=i.node.precision;if(null!==s&&(t=eP[s]+" "+t),o){t="\t"+t;const e=i.groupNode.name;(r[e]||(r[e]=[])).push(t)}else t="uniform "+t,n.push(t)}let i="";for(const t in r){const n=r[t];i+=this._getGLSLUniformStruct(e+"_"+t,n.join("\n"))+"\n"}return i+=n.join("\n"),i}getTypeFromAttribute(e){let t=super.getTypeFromAttribute(e);if(/^[iu]/.test(t)&&e.gpuType!==Kc){let n=e;e.isInterleavedBufferAttribute&&(n=e.data);const r=n.array;!1==(r instanceof Uint32Array||r instanceof Int32Array)&&(t=t.slice(1))}return t}getAttributes(e){let t="";if("vertex"===e||"compute"===e){const e=this.getAttributesArray();let n=0;for(const r of e)t+=`layout( location = ${n++} ) in ${r.type} ${r.name};\n`}return t}getStructMembers(e){const t=[],n=e.getMemberTypes();for(let e=0;e<n.length;e++){const r=n[e];t.push(`layout( location = ${e} ) out ${r} m${e};`)}return t.join("\n")}getStructs(e){const t=[],n=this.structs[e];if(0===n.length)return"layout( location = 0 ) out vec4 fragColor;\n";for(let e=0,r=n.length;e<r;e++){const r=n[e];let i="\n";i+=this.getStructMembers(r),i+="\n",t.push(i)}return t.join("\n\n")}getVaryings(e){let t="";const n=this.varyings;if("vertex"===e||"compute"===e)for(const r of n){"compute"===e&&(r.needsInterpolation=!0);const n=r.type;t+=`${n.includes("int")||n.includes("uv")||n.includes("iv")?"flat ":""}${r.needsInterpolation?"out":"/*out*/"} ${n} ${r.name};\n`}else if("fragment"===e)for(const e of n)if(e.needsInterpolation){const n=e.type;t+=`${n.includes("int")||n.includes("uv")||n.includes("iv")?"flat ":""}in ${n} ${e.name};\n`}return t}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce(((e,t)=>e*t),1)}u`}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,t,n=this.shaderStage){const r=this.extensions[n]||(this.extensions[n]=new Map);!1===r.has(e)&&r.set(e,{name:e,behavior:t})}getExtensions(e){const t=[];if("vertex"===e){const t=this.renderer.backend.extensions;this.object.isBatchedMesh&&t.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const n=this.extensions[e];if(void 0!==n)for(const{name:e,behavior:r}of n.values())t.push(`#extension ${e} : ${r}`);return t.join("\n")}isAvailable(e){let t=tP[e];if(void 0===t){if("float32Filterable"===e){const e=this.renderer.backend.extensions;e.has("OES_texture_float_linear")?(e.get("OES_texture_float_linear"),t=!0):t=!1}tP[e]=t}return t}isFlipY(){return!0}registerTransform(e,t){this.transforms.push({varyingName:e,attributeNode:t})}getTransforms(){const e=this.transforms;let t="";for(let n=0;n<e.length;n++){const r=e[n],i=this.getPropertyName(r.attributeNode);t+=`${r.varyingName} = ${i};\n\t`}return t}_getGLSLUniformStruct(e,t){return`\nlayout( std140 ) uniform ${e} {\n${t}\n};`}_getGLSLVertexCode(e){return`#version 300 es\n\n${this.getSignature()}\n\n// extensions \n${e.extensions}\n\n// precision\n${nP}\n\n// uniforms\n${e.uniforms}\n\n// varyings\n${e.varyings}\n\n// attributes\n${e.attributes}\n\n// codes\n${e.codes}\n\nvoid main() {\n\n\t// vars\n\t${e.vars}\n\n\t// transforms\n\t${e.transforms}\n\n\t// flow\n\t${e.flow}\n\n\tgl_PointSize = 1.0;\n\n}\n`}_getGLSLFragmentCode(e){return`#version 300 es\n\n${this.getSignature()}\n\n// precision\n${nP}\n\n// uniforms\n${e.uniforms}\n\n// varyings\n${e.varyings}\n\n// codes\n${e.codes}\n\n${e.structs}\n\nvoid main() {\n\n\t// vars\n\t${e.vars}\n\n\t// flow\n\t${e.flow}\n\n}\n`}buildCode(){const e=null!==this.material?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){let n="// code\n\n";n+=this.flowCode[t];const r=this.flowNodes[t],i=r[r.length-1];for(const e of r){const r=this.getFlowData(e),o=e.name;o&&(n.length>0&&(n+="\n"),n+=`\t// flow -> ${o}\n\t`),n+=`${r.code}\n\t`,e===i&&"compute"!==t&&(n+="// result\n\t","vertex"===t?(n+="gl_Position = ",n+=`${r.result};`):"fragment"===t&&(e.outputNode.isOutputStructNode||(n+="fragColor = ",n+=`${r.result};`)))}const o=e[t];o.extensions=this.getExtensions(t),o.uniforms=this.getUniforms(t),o.attributes=this.getAttributes(t),o.varyings=this.getVaryings(t),o.vars=this.getVars(t),o.structs=this.getStructs(t),o.codes=this.getCodes(t),o.transforms=this.getTransforms(t),o.flow=n}null!==this.material?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,t,n,r=null){const i=super.getUniformFromNode(e,t,n,r),o=this.getDataFromNode(e,n,this.globalCache);let s=o.uniformGPU;if(void 0===s){const r=e.groupNode,a=r.name,u=this.getBindGroupArray(a,n);if("texture"===t)s=new YO(i.name,i.node,r),u.push(s);else if("cubeTexture"===t)s=new KO(i.name,i.node,r),u.push(s);else if("texture3D"===t)s=new QO(i.name,i.node,r),u.push(s);else if("buffer"===t){e.name=`NodeBuffer_${e.id}`,i.name=`buffer${e.id}`;const t=new HO(e,r);t.name=e.name,u.push(t),s=t}else{const e=this.uniformGroups[n]||(this.uniformGroups[n]={});let o=e[a];void 0===o&&(o=new XO(n+"_"+a,r),e[a]=o,u.push(o)),s=this.getNodeUniform(i,t),o.addUniform(s)}o.uniformGPU=s}return i}}let iP=null,oP=null,sP=null;class aP{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null}async init(e){this.renderer=e}begin(){}finish(){}draw(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}createRenderPipeline(){}createComputePipeline(){}destroyPipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}createSampler(){}createDefaultTexture(){}createTexture(){}copyTextureToBuffer(){}createAttribute(){}createIndexAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}resolveTimestampAsync(){}hasFeatureAsync(){}hasFeature(){}getInstanceCount(e){const{object:t,geometry:n}=e;return n.isInstancedBufferGeometry?n.instanceCount:t.count>1?t.count:1}getDrawingBufferSize(){return iP=iP||new sh,this.renderer.getDrawingBufferSize(iP)}getScissor(){return oP=oP||new Mh,this.renderer.getScissor(oP)}setScissorTest(){}getClearColor(){const e=this.renderer;return sP=sP||new DT,e.getClearColor(sP),sP.getRGB(sP,this.renderer.currentColorSpace),sP}getDomElement(){let e=this.domElement;return null===e&&(e=void 0!==this.parameters.canvas?this.parameters.canvas:function(){const e=ch("canvas");return e.style.display="block",e}(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${Cc} webgpu`),this.domElement=e),e}set(e,t){this.data.set(e,t)}get(e){let t=this.data.get(e);return void 0===t&&(t={},this.data.set(e,t)),t}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}dispose(){}}let uP=0;class cP{constructor(e,t){this.buffers=[e.bufferGPU,t],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[1^this.activeBufferIndex]}switchBuffers(){this.activeBufferIndex^=1}}class lP{constructor(e){this.backend=e}createAttribute(e,t){const n=this.backend,{gl:r}=n,i=e.array,o=e.usage||r.STATIC_DRAW,s=e.isInterleavedBufferAttribute?e.data:e,a=n.get(s);let u,c=a.bufferGPU;if(void 0===c&&(c=this._createBuffer(r,t,i,o),a.bufferGPU=c,a.bufferType=t,a.version=s.version),i instanceof Float32Array)u=r.FLOAT;else if(i instanceof Uint16Array)u=e.isFloat16BufferAttribute?r.HALF_FLOAT:r.UNSIGNED_SHORT;else if(i instanceof Int16Array)u=r.SHORT;else if(i instanceof Uint32Array)u=r.UNSIGNED_INT;else if(i instanceof Int32Array)u=r.INT;else if(i instanceof Int8Array)u=r.BYTE;else if(i instanceof Uint8Array)u=r.UNSIGNED_BYTE;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+i);u=r.UNSIGNED_BYTE}let l={bufferGPU:c,bufferType:t,type:u,byteLength:i.byteLength,bytesPerElement:i.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:u===r.INT||u===r.UNSIGNED_INT||e.gpuType===Kc,id:uP++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const e=this._createBuffer(r,t,i,o);l=new cP(l,e)}n.set(e,l)}updateAttribute(e){const t=this.backend,{gl:n}=t,r=e.array,i=e.isInterleavedBufferAttribute?e.data:e,o=t.get(i),s=o.bufferType,a=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(n.bindBuffer(s,o.bufferGPU),0===a.length)n.bufferSubData(s,0,r);else{for(let e=0,t=a.length;e<t;e++){const t=a[e];n.bufferSubData(s,t.start*r.BYTES_PER_ELEMENT,r,t.start,t.count)}i.clearUpdateRanges()}n.bindBuffer(s,null),o.version=i.version}destroyAttribute(e){const t=this.backend,{gl:n}=t;e.isInterleavedBufferAttribute&&t.delete(e.data);const r=t.get(e);n.deleteBuffer(r.bufferGPU),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,{gl:n}=t,r=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:i}=t.get(r),o=e.array,s=o.byteLength;n.bindBuffer(n.COPY_READ_BUFFER,i);const a=n.createBuffer();n.bindBuffer(n.COPY_WRITE_BUFFER,a),n.bufferData(n.COPY_WRITE_BUFFER,s,n.STREAM_READ),n.copyBufferSubData(n.COPY_READ_BUFFER,n.COPY_WRITE_BUFFER,0,0,s),await t.utils._clientWaitAsync();const u=new e.array.constructor(o.length);return n.bindBuffer(n.COPY_WRITE_BUFFER,a),n.getBufferSubData(n.COPY_WRITE_BUFFER,0,u),n.deleteBuffer(a),n.bindBuffer(n.COPY_READ_BUFFER,null),n.bindBuffer(n.COPY_WRITE_BUFFER,null),u.buffer}_createBuffer(e,t,n,r){const i=e.createBuffer();return e.bindBuffer(t,i),e.bufferData(t,n,r),e.bindBuffer(t,null),i}}let hP,dP,fP=!1;class pP{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},!1===fP&&(this._init(this.gl),fP=!0)}_init(e){hP={[Oc]:e.FUNC_ADD,101:e.FUNC_SUBTRACT,102:e.FUNC_REVERSE_SUBTRACT},dP={200:e.ZERO,201:e.ONE,202:e.SRC_COLOR,[Pc]:e.SRC_ALPHA,210:e.SRC_ALPHA_SATURATE,208:e.DST_COLOR,206:e.DST_ALPHA,203:e.ONE_MINUS_SRC_COLOR,[Rc]:e.ONE_MINUS_SRC_ALPHA,209:e.ONE_MINUS_DST_COLOR,207:e.ONE_MINUS_DST_ALPHA}}enable(e){const{enabled:t}=this;!0!==t[e]&&(this.gl.enable(e),t[e]=!0)}disable(e){const{enabled:t}=this;!1!==t[e]&&(this.gl.disable(e),t[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:t}=this;e?t.frontFace(t.CW):t.frontFace(t.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:t}=this;0!==e?(this.enable(t.CULL_FACE),e!==this.currentCullFace&&(1===e?t.cullFace(t.BACK):2===e?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:t,gl:n}=this;e!==t&&(n.lineWidth(e),this.currentLineWidth=e)}setBlending(e,t,n,r,i,o,s,a){const{gl:u}=this;if(0!==e){if(!1===this.currentBlendingEnabled&&(this.enable(u.BLEND),this.currentBlendingEnabled=!0),5===e)i=i||t,o=o||n,s=s||r,t===this.currentBlendEquation&&i===this.currentBlendEquationAlpha||(u.blendEquationSeparate(hP[t],hP[i]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=i),n===this.currentBlendSrc&&r===this.currentBlendDst&&o===this.currentBlendSrcAlpha&&s===this.currentBlendDstAlpha||(u.blendFuncSeparate(dP[n],dP[r],dP[o],dP[s]),this.currentBlendSrc=n,this.currentBlendDst=r,this.currentBlendSrcAlpha=o,this.currentBlendDstAlpha=s),this.currentBlending=e,this.currentPremultipledAlpha=!1;else if(e!==this.currentBlending||a!==this.currentPremultipledAlpha){if(this.currentBlendEquation===Oc&&this.currentBlendEquationAlpha===Oc||(u.blendEquation(u.FUNC_ADD),this.currentBlendEquation=Oc,this.currentBlendEquationAlpha=Oc),a)switch(e){case 1:u.blendFuncSeparate(u.ONE,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case 2:u.blendFunc(u.ONE,u.ONE);break;case 3:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case 4:u.blendFuncSeparate(u.ZERO,u.SRC_COLOR,u.ZERO,u.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case 1:u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case 2:u.blendFunc(u.SRC_ALPHA,u.ONE);break;case 3:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case 4:u.blendFunc(u.ZERO,u.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=a}}else!0===this.currentBlendingEnabled&&(this.disable(u.BLEND),this.currentBlendingEnabled=!1)}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:t}=this;e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:t}=this;switch(e){case 0:t.depthFunc(t.NEVER);break;case 1:t.depthFunc(t.ALWAYS);break;case 2:t.depthFunc(t.LESS);break;case 3:default:t.depthFunc(t.LEQUAL);break;case 4:t.depthFunc(t.EQUAL);break;case 5:t.depthFunc(t.GEQUAL);break;case 6:t.depthFunc(t.GREATER);break;case 7:t.depthFunc(t.NOTEQUAL)}this.currentDepthFunc=e}}setStencilTest(e){const{gl:t}=this;e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,t,n){this.currentStencilFunc===e&&this.currentStencilRef===t&&this.currentStencilFuncMask===n||(this.gl.stencilFunc(e,t,n),this.currentStencilFunc=e,this.currentStencilRef=t,this.currentStencilFuncMask=n)}setStencilOp(e,t,n){this.currentStencilFail===e&&this.currentStencilZFail===t&&this.currentStencilZPass===n||(this.gl.stencilOp(e,t,n),this.currentStencilFail=e,this.currentStencilZFail=t,this.currentStencilZPass=n)}setMaterial(e,t){const{gl:n}=this;2===e.side?this.disable(n.CULL_FACE):this.enable(n.CULL_FACE);let r=1===e.side;t&&(r=!r),this.setFlipSided(r),1===e.blending&&!1===e.transparent?this.setBlending(0):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const i=e.stencilWrite;this.setStencilTest(i),i&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage&&this.backend.renderer.samples>1?this.enable(n.SAMPLE_ALPHA_TO_COVERAGE):this.disable(n.SAMPLE_ALPHA_TO_COVERAGE)}setPolygonOffset(e,t,n){const{gl:r}=this;e?(this.enable(r.POLYGON_OFFSET_FILL),this.currentPolygonOffsetFactor===t&&this.currentPolygonOffsetUnits===n||(r.polygonOffset(t,n),this.currentPolygonOffsetFactor=t,this.currentPolygonOffsetUnits=n)):this.disable(r.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e&&(this.gl.useProgram(e),this.currentProgram=e,!0)}bindFramebuffer(e,t){const{gl:n,currentBoundFramebuffers:r}=this;return r[e]!==t&&(n.bindFramebuffer(e,t),r[e]=t,e===n.DRAW_FRAMEBUFFER&&(r[n.FRAMEBUFFER]=t),e===n.FRAMEBUFFER&&(r[n.DRAW_FRAMEBUFFER]=t),!0)}drawBuffers(e,t){const{gl:n}=this;let r=[],i=!1;if(null!==e.textures){r=this.currentDrawbuffers.get(t),void 0===r&&(r=[],this.currentDrawbuffers.set(t,r));const o=e.textures;if(r.length!==o.length||r[0]!==n.COLOR_ATTACHMENT0){for(let e=0,t=o.length;e<t;e++)r[e]=n.COLOR_ATTACHMENT0+e;r.length=o.length,i=!0}}else r[0]!==n.BACK&&(r[0]=n.BACK,i=!0);i&&n.drawBuffers(r)}activeTexture(e){const{gl:t,currentTextureSlot:n,maxTextures:r}=this;void 0===e&&(e=t.TEXTURE0+r-1),n!==e&&(t.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,t,n){const{gl:r,currentTextureSlot:i,currentBoundTextures:o,maxTextures:s}=this;void 0===n&&(n=null===i?r.TEXTURE0+s-1:i);let a=o[n];void 0===a&&(a={type:void 0,texture:void 0},o[n]=a),a.type===e&&a.texture===t||(i!==n&&(r.activeTexture(n),this.currentTextureSlot=n),r.bindTexture(e,t),a.type=e,a.texture=t)}bindBufferBase(e,t,n){const{gl:r}=this,i=`${e}-${t}`;return this.currentBoundBufferBases[i]!==n&&(r.bindBufferBase(e,t,n),this.currentBoundBufferBases[i]=n,!0)}unbindTexture(){const{gl:e,currentTextureSlot:t,currentBoundTextures:n}=this,r=n[t];void 0!==r&&void 0!==r.type&&(e.bindTexture(r.type,null),r.type=void 0,r.texture=void 0)}}class mP{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,t=""){const{gl:n,extensions:r}=this;let i;if(e===Xc)return n.UNSIGNED_BYTE;if(1017===e)return n.UNSIGNED_SHORT_4_4_4_4;if(1018===e)return n.UNSIGNED_SHORT_5_5_5_1;if(35902===e)return n.UNSIGNED_INT_5_9_9_9_REV;if(e===Zc)return n.BYTE;if(e===$c)return n.SHORT;if(e===Yc)return n.UNSIGNED_SHORT;if(e===Kc)return n.INT;if(e===Qc)return n.UNSIGNED_INT;if(e===Jc)return n.FLOAT;if(e===el)return n.HALF_FLOAT;if(1021===e)return n.ALPHA;if(e===nl)return n.RGB;if(e===rl)return n.RGBA;if(1024===e)return n.LUMINANCE;if(1025===e)return n.LUMINANCE_ALPHA;if(e===il)return n.DEPTH_COMPONENT;if(e===ol)return n.DEPTH_STENCIL;if(e===sl)return n.RED;if(e===al)return n.RED_INTEGER;if(e===ul)return n.RG;if(e===cl)return n.RG_INTEGER;if(e===ll)return n.RGBA_INTEGER;if(e===hl||e===dl||e===fl||e===pl)if(t===Bl){if(i=r.get("WEBGL_compressed_texture_s3tc_srgb"),null===i)return null;if(e===hl)return i.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===dl)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===fl)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===pl)return i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(i=r.get("WEBGL_compressed_texture_s3tc"),null===i)return null;if(e===hl)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===dl)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===fl)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===pl)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===e||35841===e||35842===e||35843===e){if(i=r.get("WEBGL_compressed_texture_pvrtc"),null===i)return null;if(35840===e)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===e)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===e)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===e)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===e||e===ml||e===gl){if(i=r.get("WEBGL_compressed_texture_etc"),null===i)return null;if(36196===e||e===ml)return t===Bl?i.COMPRESSED_SRGB8_ETC2:i.COMPRESSED_RGB8_ETC2;if(e===gl)return t===Bl?i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:i.COMPRESSED_RGBA8_ETC2_EAC}if(e===vl||e===yl||e===bl||e===_l||e===xl||e===wl||e===Sl||e===El||e===Tl||e===Ml||e===Al||e===Cl||e===Ol||e===Pl){if(i=r.get("WEBGL_compressed_texture_astc"),null===i)return null;if(e===vl)return t===Bl?i.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:i.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===yl)return t===Bl?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:i.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===bl)return t===Bl?i.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:i.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===_l)return t===Bl?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:i.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===xl)return t===Bl?i.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:i.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===wl)return t===Bl?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:i.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===Sl)return t===Bl?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:i.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===El)return t===Bl?i.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:i.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===Tl)return t===Bl?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:i.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===Ml)return t===Bl?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:i.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===Al)return t===Bl?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:i.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===Cl)return t===Bl?i.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:i.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===Ol)return t===Bl?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:i.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===Pl)return t===Bl?i.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:i.COMPRESSED_RGBA_ASTC_12x12_KHR}if(e===Rl){if(i=r.get("EXT_texture_compression_bptc"),null===i)return null;if(e===Rl)return t===Bl?i.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:i.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===e||36284===e||36285===e||36286===e){if(i=r.get("EXT_texture_compression_rgtc"),null===i)return null;if(e===Rl)return i.COMPRESSED_RED_RGTC1_EXT;if(36284===e)return i.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===e)return i.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===e)return i.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return e===tl?n.UNSIGNED_INT_24_8:void 0!==n[e]?n[e]:null}_clientWaitAsync(){const{gl:e}=this,t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise(((n,r)=>{!function i(){const o=e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0);if(o===e.WAIT_FAILED)return e.deleteSync(t),void r();o!==e.TIMEOUT_EXPIRED?(e.deleteSync(t),n()):requestAnimationFrame(i)}()}))}}let gP,vP,yP,bP=!1;class _P{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},!1===bP&&(this._init(this.gl),bP=!0)}_init(e){gP={[Fc]:e.REPEAT,[Bc]:e.CLAMP_TO_EDGE,[zc]:e.MIRRORED_REPEAT},vP={[jc]:e.NEAREST,[Vc]:e.NEAREST_MIPMAP_NEAREST,[Gc]:e.NEAREST_MIPMAP_LINEAR,[Hc]:e.LINEAR,[Wc]:e.LINEAR_MIPMAP_NEAREST,[qc]:e.LINEAR_MIPMAP_LINEAR},yP={512:e.NEVER,519:e.ALWAYS,513:e.LESS,515:e.LEQUAL,514:e.EQUAL,518:e.GEQUAL,516:e.GREATER,517:e.NOTEQUAL}}filterFallback(e){const{gl:t}=this;return e===jc||e===Vc||e===Gc?t.NEAREST:t.LINEAR}getGLTextureType(e){const{gl:t}=this;let n;return n=!0===e.isCubeTexture?t.TEXTURE_CUBE_MAP:!0===e.isDataArrayTexture||!0===e.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:!0===e.isData3DTexture?t.TEXTURE_3D:t.TEXTURE_2D,n}getInternalFormat(e,t,n,r,i=!1){const{gl:o,extensions:s}=this;if(null!==e){if(void 0!==o[e])return o[e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+e+"'")}let a=t;return t===o.RED&&(n===o.FLOAT&&(a=o.R32F),n===o.HALF_FLOAT&&(a=o.R16F),n===o.UNSIGNED_BYTE&&(a=o.R8),n===o.UNSIGNED_SHORT&&(a=o.R16),n===o.UNSIGNED_INT&&(a=o.R32UI),n===o.BYTE&&(a=o.R8I),n===o.SHORT&&(a=o.R16I),n===o.INT&&(a=o.R32I)),t===o.RED_INTEGER&&(n===o.UNSIGNED_BYTE&&(a=o.R8UI),n===o.UNSIGNED_SHORT&&(a=o.R16UI),n===o.UNSIGNED_INT&&(a=o.R32UI),n===o.BYTE&&(a=o.R8I),n===o.SHORT&&(a=o.R16I),n===o.INT&&(a=o.R32I)),t===o.RG&&(n===o.FLOAT&&(a=o.RG32F),n===o.HALF_FLOAT&&(a=o.RG16F),n===o.UNSIGNED_BYTE&&(a=o.RG8),n===o.UNSIGNED_SHORT&&(a=o.RG16),n===o.UNSIGNED_INT&&(a=o.RG32UI),n===o.BYTE&&(a=o.RG8I),n===o.SHORT&&(a=o.RG16I),n===o.INT&&(a=o.RG32I)),t===o.RG_INTEGER&&(n===o.UNSIGNED_BYTE&&(a=o.RG8UI),n===o.UNSIGNED_SHORT&&(a=o.RG16UI),n===o.UNSIGNED_INT&&(a=o.RG32UI),n===o.BYTE&&(a=o.RG8I),n===o.SHORT&&(a=o.RG16I),n===o.INT&&(a=o.RG32I)),t===o.RGB&&(n===o.FLOAT&&(a=o.RGB32F),n===o.HALF_FLOAT&&(a=o.RGB16F),n===o.UNSIGNED_BYTE&&(a=o.RGB8),n===o.UNSIGNED_SHORT&&(a=o.RGB16),n===o.UNSIGNED_INT&&(a=o.RGB32UI),n===o.BYTE&&(a=o.RGB8I),n===o.SHORT&&(a=o.RGB16I),n===o.INT&&(a=o.RGB32I),n===o.UNSIGNED_BYTE&&(a=r===Bl&&!1===i?o.SRGB8:o.RGB8),n===o.UNSIGNED_SHORT_5_6_5&&(a=o.RGB565),n===o.UNSIGNED_SHORT_5_5_5_1&&(a=o.RGB5_A1),n===o.UNSIGNED_SHORT_4_4_4_4&&(a=o.RGB4),n===o.UNSIGNED_INT_5_9_9_9_REV&&(a=o.RGB9_E5)),t===o.RGB_INTEGER&&(n===o.UNSIGNED_BYTE&&(a=o.RGB8UI),n===o.UNSIGNED_SHORT&&(a=o.RGB16UI),n===o.UNSIGNED_INT&&(a=o.RGB32UI),n===o.BYTE&&(a=o.RGB8I),n===o.SHORT&&(a=o.RGB16I),n===o.INT&&(a=o.RGB32I)),t===o.RGBA&&(n===o.FLOAT&&(a=o.RGBA32F),n===o.HALF_FLOAT&&(a=o.RGBA16F),n===o.UNSIGNED_BYTE&&(a=o.RGBA8),n===o.UNSIGNED_SHORT&&(a=o.RGBA16),n===o.UNSIGNED_INT&&(a=o.RGBA32UI),n===o.BYTE&&(a=o.RGBA8I),n===o.SHORT&&(a=o.RGBA16I),n===o.INT&&(a=o.RGBA32I),n===o.UNSIGNED_BYTE&&(a=r===Bl&&!1===i?o.SRGB8_ALPHA8:o.RGBA8),n===o.UNSIGNED_SHORT_4_4_4_4&&(a=o.RGBA4),n===o.UNSIGNED_SHORT_5_5_5_1&&(a=o.RGB5_A1)),t===o.RGBA_INTEGER&&(n===o.UNSIGNED_BYTE&&(a=o.RGBA8UI),n===o.UNSIGNED_SHORT&&(a=o.RGBA16UI),n===o.UNSIGNED_INT&&(a=o.RGBA32UI),n===o.BYTE&&(a=o.RGBA8I),n===o.SHORT&&(a=o.RGBA16I),n===o.INT&&(a=o.RGBA32I)),t===o.DEPTH_COMPONENT&&(n===o.UNSIGNED_INT&&(a=o.DEPTH24_STENCIL8),n===o.FLOAT&&(a=o.DEPTH_COMPONENT32F)),t===o.DEPTH_STENCIL&&n===o.UNSIGNED_INT_24_8&&(a=o.DEPTH24_STENCIL8),a!==o.R16F&&a!==o.R32F&&a!==o.RG16F&&a!==o.RG32F&&a!==o.RGBA16F&&a!==o.RGBA32F||s.get("EXT_color_buffer_float"),a}setTextureParameters(e,t){const{gl:n,extensions:r,backend:i}=this;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,t.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,t.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE),n.texParameteri(e,n.TEXTURE_WRAP_S,gP[t.wrapS]),n.texParameteri(e,n.TEXTURE_WRAP_T,gP[t.wrapT]),e!==n.TEXTURE_3D&&e!==n.TEXTURE_2D_ARRAY||n.texParameteri(e,n.TEXTURE_WRAP_R,gP[t.wrapR]),n.texParameteri(e,n.TEXTURE_MAG_FILTER,vP[t.magFilter]);const o=void 0!==t.mipmaps&&t.mipmaps.length>0,s=t.minFilter===Hc&&o?qc:t.minFilter;if(n.texParameteri(e,n.TEXTURE_MIN_FILTER,vP[s]),t.compareFunction&&(n.texParameteri(e,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(e,n.TEXTURE_COMPARE_FUNC,yP[t.compareFunction])),!0===r.has("EXT_texture_filter_anisotropic")){if(t.magFilter===jc)return;if(t.minFilter!==Gc&&t.minFilter!==qc)return;if(t.type===Jc&&!1===r.has("OES_texture_float_linear"))return;if(t.anisotropy>1){const o=r.get("EXT_texture_filter_anisotropic");n.texParameterf(e,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,i.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:t,backend:n,defaultTextures:r}=this,i=this.getGLTextureType(e);let o=r[i];void 0===o&&(o=t.createTexture(),n.state.bindTexture(i,o),t.texParameteri(i,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(i,t.TEXTURE_MAG_FILTER,t.NEAREST),r[i]=o),n.set(e,{textureGPU:o,glTextureType:i,isDefault:!0})}createTexture(e,t){const{gl:n,backend:r}=this,{levels:i,width:o,height:s,depth:a}=t,u=r.utils.convert(e.format,e.colorSpace),c=r.utils.convert(e.type),l=this.getInternalFormat(e.internalFormat,u,c,e.colorSpace,e.isVideoTexture),h=n.createTexture(),d=this.getGLTextureType(e);r.state.bindTexture(d,h),this.setTextureParameters(d,e),e.isDataArrayTexture||e.isCompressedArrayTexture?n.texStorage3D(n.TEXTURE_2D_ARRAY,i,l,o,s,a):e.isData3DTexture?n.texStorage3D(n.TEXTURE_3D,i,l,o,s,a):e.isVideoTexture||n.texStorage2D(d,i,l,o,s),r.set(e,{textureGPU:h,glTextureType:d,glFormat:u,glType:c,glInternalFormat:l})}copyBufferToTexture(e,t){const{gl:n,backend:r}=this,{textureGPU:i,glTextureType:o,glFormat:s,glType:a}=r.get(t),{width:u,height:c}=t.source.data;n.bindBuffer(n.PIXEL_UNPACK_BUFFER,e),r.state.bindTexture(o,i),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.texSubImage2D(o,0,0,0,u,c,s,a,0),n.bindBuffer(n.PIXEL_UNPACK_BUFFER,null),r.state.unbindTexture()}updateTexture(e,t){const{gl:n}=this,{width:r,height:i}=t,{textureGPU:o,glTextureType:s,glFormat:a,glType:u,glInternalFormat:c}=this.backend.get(e);if(e.isRenderTargetTexture||void 0===o)return;const l=e=>e.isDataTexture?e.image.data:e instanceof ImageBitmap||e instanceof OffscreenCanvas||e instanceof HTMLImageElement||e instanceof HTMLCanvasElement?e:e.data;if(this.backend.state.bindTexture(s,o),this.setTextureParameters(s,e),e.isCompressedTexture){const r=e.mipmaps,i=t.image;for(let t=0;t<r.length;t++){const o=r[t];e.isCompressedArrayTexture?e.format!==n.RGBA?null!==a?n.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,t,0,0,0,o.width,o.height,i.depth,a,o.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texSubImage3D(n.TEXTURE_2D_ARRAY,t,0,0,0,o.width,o.height,i.depth,a,u,o.data):null!==a?n.compressedTexSubImage2D(n.TEXTURE_2D,t,0,0,o.width,o.height,a,o.data):console.warn("Unsupported compressed texture format")}}else if(e.isCubeTexture){const e=t.images;for(let t=0;t<6;t++){const o=l(e[t]);n.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,r,i,a,u,o)}}else if(e.isDataArrayTexture){const e=t.image;n.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,e.width,e.height,e.depth,a,u,e.data)}else if(e.isData3DTexture){const e=t.image;n.texSubImage3D(n.TEXTURE_3D,0,0,0,0,e.width,e.height,e.depth,a,u,e.data)}else if(e.isVideoTexture)e.update(),n.texImage2D(s,0,c,a,u,t.image);else{const e=l(t.image);n.texSubImage2D(s,0,0,0,r,i,a,u,e)}}generateMipmaps(e){const{gl:t,backend:n}=this,{textureGPU:r,glTextureType:i}=n.get(e);n.state.bindTexture(i,r),t.generateMipmap(i)}deallocateRenderBuffers(e){const{gl:t,backend:n}=this;if(e){const r=n.get(e);if(r.renderBufferStorageSetup=void 0,r.framebuffers){for(const e in r.framebuffers)t.deleteFramebuffer(r.framebuffers[e]);delete r.framebuffers}if(r.depthRenderbuffer&&(t.deleteRenderbuffer(r.depthRenderbuffer),delete r.depthRenderbuffer),r.stencilRenderbuffer&&(t.deleteRenderbuffer(r.stencilRenderbuffer),delete r.stencilRenderbuffer),r.msaaFrameBuffer&&(t.deleteFramebuffer(r.msaaFrameBuffer),delete r.msaaFrameBuffer),r.msaaRenderbuffers){for(let e=0;e<r.msaaRenderbuffers.length;e++)t.deleteRenderbuffer(r.msaaRenderbuffers[e]);delete r.msaaRenderbuffers}}}destroyTexture(e){const{gl:t,backend:n}=this,{textureGPU:r,renderTarget:i}=n.get(e);this.deallocateRenderBuffers(i),t.deleteTexture(r),n.delete(e)}copyTextureToTexture(e,t,n=null,r=null,i=0){const{gl:o,backend:s}=this,{state:a}=this.backend,{textureGPU:u,glTextureType:c,glType:l,glFormat:h}=s.get(t);let d,f,p,m,g,v;null!==n?(d=n.max.x-n.min.x,f=n.max.y-n.min.y,p=n.min.x,m=n.min.y):(d=e.image.width,f=e.image.height,p=0,m=0),null!==r?(g=r.x,v=r.y):(g=0,v=0),a.bindTexture(c,u),o.pixelStorei(o.UNPACK_ALIGNMENT,t.unpackAlignment),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,t.flipY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),o.pixelStorei(o.UNPACK_ALIGNMENT,t.unpackAlignment);const y=o.getParameter(o.UNPACK_ROW_LENGTH),b=o.getParameter(o.UNPACK_IMAGE_HEIGHT),_=o.getParameter(o.UNPACK_SKIP_PIXELS),x=o.getParameter(o.UNPACK_SKIP_ROWS),w=o.getParameter(o.UNPACK_SKIP_IMAGES),S=e.isCompressedTexture?e.mipmaps[i]:e.image;if(o.pixelStorei(o.UNPACK_ROW_LENGTH,S.width),o.pixelStorei(o.UNPACK_IMAGE_HEIGHT,S.height),o.pixelStorei(o.UNPACK_SKIP_PIXELS,p),o.pixelStorei(o.UNPACK_SKIP_ROWS,m),e.isRenderTargetTexture||e.isDepthTexture){const n=s.get(e),r=s.get(t),i=s.get(n.renderTarget),u=s.get(r.renderTarget),c=i.framebuffers[n.cacheKey],l=u.framebuffers[r.cacheKey];a.bindFramebuffer(o.READ_FRAMEBUFFER,c),a.bindFramebuffer(o.DRAW_FRAMEBUFFER,l);let h=o.COLOR_BUFFER_BIT;e.isDepthTexture&&(h=o.DEPTH_BUFFER_BIT),o.blitFramebuffer(p,m,d,f,g,v,d,f,h,o.NEAREST),a.bindFramebuffer(o.READ_FRAMEBUFFER,null),a.bindFramebuffer(o.DRAW_FRAMEBUFFER,null)}else e.isDataTexture?o.texSubImage2D(o.TEXTURE_2D,i,g,v,d,f,h,l,S.data):e.isCompressedTexture?o.compressedTexSubImage2D(o.TEXTURE_2D,i,g,v,S.width,S.height,h,S.data):o.texSubImage2D(o.TEXTURE_2D,i,g,v,d,f,h,l,S);o.pixelStorei(o.UNPACK_ROW_LENGTH,y),o.pixelStorei(o.UNPACK_IMAGE_HEIGHT,b),o.pixelStorei(o.UNPACK_SKIP_PIXELS,_),o.pixelStorei(o.UNPACK_SKIP_ROWS,x),o.pixelStorei(o.UNPACK_SKIP_IMAGES,w),0===i&&t.generateMipmaps&&o.generateMipmap(o.TEXTURE_2D),a.unbindTexture()}copyFramebufferToTexture(e,t,n){const{gl:r}=this,{state:i}=this.backend,{textureGPU:o}=this.backend.get(e),{x:s,y:a,z:u,w:c}=n,l=!0===e.isDepthTexture||t.renderTarget&&t.renderTarget.samples>0,h=t.renderTarget?t.renderTarget.height:this.backend.gerDrawingBufferSize().y;if(l){const n=0!==s||0!==a;let l,d;if(!0===e.isDepthTexture?(l=r.DEPTH_BUFFER_BIT,d=r.DEPTH_ATTACHMENT,t.stencil&&(l|=r.STENCIL_BUFFER_BIT)):(l=r.COLOR_BUFFER_BIT,d=r.COLOR_ATTACHMENT0),n){const e=this.backend.get(t.renderTarget),n=e.framebuffers[t.getCacheKey()],d=e.msaaFrameBuffer;i.bindFramebuffer(r.DRAW_FRAMEBUFFER,n),i.bindFramebuffer(r.READ_FRAMEBUFFER,d);const f=h-a-c;r.blitFramebuffer(s,f,s+u,f+c,s,f,s+u,f+c,l,r.NEAREST),i.bindFramebuffer(r.READ_FRAMEBUFFER,n),i.bindTexture(r.TEXTURE_2D,o),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,s,f,u,c),i.unbindTexture()}else{const e=r.createFramebuffer();i.bindFramebuffer(r.DRAW_FRAMEBUFFER,e),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,d,r.TEXTURE_2D,o,0),r.blitFramebuffer(0,0,u,c,0,0,u,c,l,r.NEAREST),r.deleteFramebuffer(e)}}else i.bindTexture(r.TEXTURE_2D,o),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,s,h-c-a,u,c),i.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(t)}setupRenderBufferStorage(e,t){const{gl:n}=this,r=t.renderTarget,{samples:i,depthTexture:o,depthBuffer:s,stencilBuffer:a,width:u,height:c}=r;if(n.bindRenderbuffer(n.RENDERBUFFER,e),s&&!a){let t=n.DEPTH_COMPONENT24;i>0?(o&&o.isDepthTexture&&o.type===n.FLOAT&&(t=n.DEPTH_COMPONENT32F),n.renderbufferStorageMultisample(n.RENDERBUFFER,i,t,u,c)):n.renderbufferStorage(n.RENDERBUFFER,t,u,c),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,e)}else s&&a&&(i>0?n.renderbufferStorageMultisample(n.RENDERBUFFER,i,n.DEPTH24_STENCIL8,u,c):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,u,c),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,e))}async copyTextureToBuffer(e,t,n,r,i,o){const{backend:s,gl:a}=this,{textureGPU:u,glFormat:c,glType:l}=this.backend.get(e),h=a.createFramebuffer();a.bindFramebuffer(a.READ_FRAMEBUFFER,h);const d=e.isCubeTexture?a.TEXTURE_CUBE_MAP_POSITIVE_X+o:a.TEXTURE_2D;a.framebufferTexture2D(a.READ_FRAMEBUFFER,a.COLOR_ATTACHMENT0,d,u,0);const f=this._getTypedArrayType(l),p=r*i*this._getBytesPerTexel(l,c),m=a.createBuffer();a.bindBuffer(a.PIXEL_PACK_BUFFER,m),a.bufferData(a.PIXEL_PACK_BUFFER,p,a.STREAM_READ),a.readPixels(t,n,r,i,c,l,0),a.bindBuffer(a.PIXEL_PACK_BUFFER,null),await s.utils._clientWaitAsync();const g=new f(p/f.BYTES_PER_ELEMENT);return a.bindBuffer(a.PIXEL_PACK_BUFFER,m),a.getBufferSubData(a.PIXEL_PACK_BUFFER,0,g),a.bindBuffer(a.PIXEL_PACK_BUFFER,null),a.deleteFramebuffer(h),g}_getTypedArrayType(e){const{gl:t}=this;if(e===t.UNSIGNED_BYTE)return Uint8Array;if(e===t.UNSIGNED_SHORT_4_4_4_4)return Uint16Array;if(e===t.UNSIGNED_SHORT_5_5_5_1)return Uint16Array;if(e===t.UNSIGNED_SHORT_5_6_5)return Uint16Array;if(e===t.UNSIGNED_SHORT)return Uint16Array;if(e===t.UNSIGNED_INT)return Uint32Array;if(e===t.HALF_FLOAT)return Uint16Array;if(e===t.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,t){const{gl:n}=this;let r=0;return e===n.UNSIGNED_BYTE&&(r=1),e!==n.UNSIGNED_SHORT_4_4_4_4&&e!==n.UNSIGNED_SHORT_5_5_5_1&&e!==n.UNSIGNED_SHORT_5_6_5&&e!==n.UNSIGNED_SHORT&&e!==n.HALF_FLOAT||(r=2),e!==n.UNSIGNED_INT&&e!==n.FLOAT||(r=4),t===n.RGBA?4*r:t===n.RGB?3*r:t===n.ALPHA?r:void 0}}class xP{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let t=this.extensions[e];return void 0===t&&(t=this.gl.getExtension(e),this.extensions[e]=t),t}has(e){return this.availableExtensions.includes(e)}}class wP{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(null!==this.maxAnisotropy)return this.maxAnisotropy;const e=this.backend.gl,t=this.backend.extensions;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const SP={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query"};class EP{constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,t){const{gl:n,mode:r,object:i,type:o,info:s,index:a}=this;0!==a?n.drawElements(r,t,o,e):n.drawArrays(r,e,t),s.update(i,t,r,1)}renderInstances(e,t,n){const{gl:r,mode:i,type:o,index:s,object:a,info:u}=this;0!==n&&(0!==s?r.drawElementsInstanced(i,t,o,e,n):r.drawArraysInstanced(i,e,t,n),u.update(a,t,i,n))}renderMultiDraw(e,t,n){const{extensions:r,mode:i,object:o,info:s}=this;if(0===n)return;const a=r.get("WEBGL_multi_draw");if(null===a)for(let r=0;r<n;r++)this.render(e[r],t[r]);else{0!==this.index?a.multiDrawElementsWEBGL(i,t,0,this.type,e,0,n):a.multiDrawArraysWEBGL(i,e,0,t,0,n);let r=0;for(let e=0;e<n;e++)r+=t[e];s.update(o,r,i,1)}}renderMultiDrawInstances(e,t,n,r){const{extensions:i,mode:o,object:s,info:a}=this;if(0===n)return;const u=i.get("WEBGL_multi_draw");if(null===u)for(let i=0;i<n;i++)this.renderInstances(e[i],t[i],r[i]);else{0!==this.index?u.multiDrawElementsInstancedWEBGL(o,t,0,this.type,e,0,r,0,n):u.multiDrawArraysInstancedWEBGL(o,e,0,t,0,r,0,n);let i=0;for(let e=0;e<n;e++)i+=t[e]*r[e];a.update(s,i,o,1)}}}class TP extends aP{constructor(e={}){super(e),this.isWebGLBackend=!0}init(e){super.init(e);const t=this.parameters,n=void 0!==t.context?t.context:e.domElement.getContext("webgl2");function r(t){t.preventDefault();const n={api:"WebGL",message:t.statusMessage||"Unknown reason",reason:null,originalEvent:t};e.onDeviceLost(n)}this._onContextLost=r,e.domElement.addEventListener("webglcontextlost",r,!1),this.gl=n,this.extensions=new xP(this),this.capabilities=new wP(this),this.attributeUtils=new lP(this),this.textureUtils=new _P(this),this.bufferRenderer=new EP(this),this.state=new pP(this),this.utils=new mP(this),this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.trackTimestamp=!0===t.trackTimestamp,this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile"),this._knownBindings=new WeakSet,this._currentContext=null}get coordinateSystem(){return ql}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async waitForGPU(){await this.utils._clientWaitAsync()}initTimestampQuery(e){if(!this.disjoint||!this.trackTimestamp)return;const t=this.get(e);if(this.queryRunning)return t.queryQueue||(t.queryQueue=[]),void t.queryQueue.push(e);t.activeQuery&&(this.gl.endQuery(this.disjoint.TIME_ELAPSED_EXT),t.activeQuery=null),t.activeQuery=this.gl.createQuery(),null!==t.activeQuery&&(this.gl.beginQuery(this.disjoint.TIME_ELAPSED_EXT,t.activeQuery),this.queryRunning=!0)}prepareTimestampBuffer(e){if(!this.disjoint||!this.trackTimestamp)return;const t=this.get(e);if(t.activeQuery&&(this.gl.endQuery(this.disjoint.TIME_ELAPSED_EXT),t.gpuQueries||(t.gpuQueries=[]),t.gpuQueries.push({query:t.activeQuery}),t.activeQuery=null,this.queryRunning=!1,t.queryQueue&&t.queryQueue.length>0)){const e=t.queryQueue.shift();this.initTimestampQuery(e)}}async resolveTimestampAsync(e,t="render"){if(!this.disjoint||!this.trackTimestamp)return;const n=this.get(e);n.gpuQueries||(n.gpuQueries=[]);for(let e=0;e<n.gpuQueries.length;e++){const r=n.gpuQueries[e],i=this.gl.getQueryParameter(r.query,this.gl.QUERY_RESULT_AVAILABLE),o=this.gl.getParameter(this.disjoint.GPU_DISJOINT_EXT);if(i&&!o){const i=this.gl.getQueryParameter(r.query,this.gl.QUERY_RESULT),o=Number(i)/1e6;this.gl.deleteQuery(r.query),n.gpuQueries.splice(e,1),e--,this.renderer.info.updateTimestamp(t,o)}}}getContext(){return this.gl}beginRender(e){const{gl:t}=this,n=this.get(e);if(this.initTimestampQuery(e),n.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1),e.viewport?this.updateViewport(e):t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),e.scissor){const{x:n,y:r,width:i,height:o}=e.scissorValue;t.scissor(n,e.height-o-r,i,o)}const r=e.occlusionQueryCount;r>0&&(n.currentOcclusionQueries=n.occlusionQueries,n.currentOcclusionQueryObjects=n.occlusionQueryObjects,n.lastOcclusionObject=null,n.occlusionQueries=new Array(r),n.occlusionQueryObjects=new Array(r),n.occlusionQueryIndex=0)}finishRender(e){const{gl:t,state:n}=this,r=this.get(e),i=r.previousContext,o=e.occlusionQueryCount;o>0&&(o>r.occlusionQueryIndex&&t.endQuery(t.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const s=e.textures;if(null!==s)for(let e=0;e<s.length;e++){const t=s[e];t.generateMipmaps&&this.generateMipmaps(t)}if(this._currentContext=i,null!==e.textures&&e.renderTarget){const r=this.get(e.renderTarget),{samples:i}=e.renderTarget;if(i>0){const i=r.framebuffers[e.getCacheKey()],o=t.COLOR_BUFFER_BIT,s=r.msaaFrameBuffer,a=e.textures;n.bindFramebuffer(t.READ_FRAMEBUFFER,s),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,i);for(let n=0;n<a.length;n++)if(e.scissor){const{x:n,y:i,width:s,height:a}=e.scissorValue,u=e.height-a-i;t.blitFramebuffer(n,u,n+s,u+a,n,u,n+s,u+a,o,t.NEAREST),t.invalidateSubFramebuffer(t.READ_FRAMEBUFFER,r.invalidationArray,n,u,s,a)}else t.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,o,t.NEAREST),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,r.invalidationArray)}}null!==i&&(this._setFramebuffer(i),i.viewport?this.updateViewport(i):t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight)),this.prepareTimestampBuffer(e)}resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueries:n,currentOcclusionQueryObjects:r}=t;if(n&&r){const e=new WeakSet,{gl:i}=this;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueries=null;const o=()=>{let s=0;for(let t=0;t<n.length;t++){const o=n[t];null!==o&&(i.getQueryParameter(o,i.QUERY_RESULT_AVAILABLE)&&(i.getQueryParameter(o,i.QUERY_RESULT)>0&&e.add(r[t]),n[t]=null,i.deleteQuery(o),s++))}s<n.length?requestAnimationFrame(o):t.occluded=e};o()}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}updateViewport(e){const t=this.gl,{x:n,y:r,width:i,height:o}=e.viewportValue;t.viewport(n,e.height-o-r,i,o)}setScissorTest(e){const t=this.gl;e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)}clear(e,t,n,r=null,i=!0){const{gl:o}=this;if(null===r){const e=this.getClearColor();e.r*=e.a,e.g*=e.a,e.b*=e.a,r={textures:null,clearColorValue:e}}let s=0;if(e&&(s|=o.COLOR_BUFFER_BIT),t&&(s|=o.DEPTH_BUFFER_BIT),n&&(s|=o.STENCIL_BUFFER_BIT),0!==s){let a;if(r.clearColorValue?a=r.clearColorValue:(a=this.getClearColor(),a.r*=a.a,a.g*=a.a,a.b*=a.a),t&&this.state.setDepthMask(!0),null===r.textures)o.clearColor(a.r,a.g,a.b,a.a),o.clear(s);else{if(i&&this._setFramebuffer(r),e)for(let e=0;e<r.textures.length;e++)o.clearBufferfv(o.COLOR,e,[a.r,a.g,a.b,a.a]);t&&n?o.clearBufferfi(o.DEPTH_STENCIL,0,1,0):t?o.clearBufferfv(o.DEPTH,0,[1]):n&&o.clearBufferiv(o.STENCIL,0,[0])}}}beginCompute(e){const{state:t,gl:n}=this;t.bindFramebuffer(n.FRAMEBUFFER,null),this.initTimestampQuery(e)}compute(e,t,n,r){const{state:i,gl:o}=this;this.discard||(o.enable(o.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:s,transformBuffers:a,attributes:u}=this.get(r),c=this._getVaoKey(null,u),l=this.vaoCache[c];void 0===l?this._createVao(null,u):o.bindVertexArray(l),i.useProgram(s),this._bindUniforms(n);const h=this._getTransformFeedback(a);o.bindTransformFeedback(o.TRANSFORM_FEEDBACK,h),o.beginTransformFeedback(o.POINTS),u[0].isStorageInstancedBufferAttribute?o.drawArraysInstanced(o.POINTS,0,1,t.count):o.drawArrays(o.POINTS,0,t.count),o.endTransformFeedback(),o.bindTransformFeedback(o.TRANSFORM_FEEDBACK,null);for(let e=0;e<a.length;e++){const t=a[e];t.pbo&&this.textureUtils.copyBufferToTexture(t.transformBuffer,t.pbo),t.switchBuffers()}}finishCompute(e){const t=this.gl;this.discard=!1,t.disable(t.RASTERIZER_DISCARD),this.prepareTimestampBuffer(e),this._currentContext&&this._setFramebuffer(this._currentContext)}draw(e){const{object:t,pipeline:n,material:r,context:i}=e,{programGPU:o}=this.get(n),{gl:s,state:a}=this,u=this.get(i),c=e.getDrawParameters();if(null===c)return;this._bindUniforms(e.getBindings());const l=t.isMesh&&t.matrixWorld.determinant()<0;a.setMaterial(r,l),a.useProgram(o);let h=e.staticVao;if(void 0===h){const t=this._getVaoKey(e.getIndex(),e.getAttributes());if(h=this.vaoCache[t],void 0===h){let t;({vaoGPU:h,staticVao:t}=this._createVao(e.getIndex(),e.getAttributes())),t&&(e.staticVao=h)}}s.bindVertexArray(h);const d=e.getIndex(),f=u.lastOcclusionObject;if(f!==t&&void 0!==f){if(null!==f&&!0===f.occlusionTest&&(s.endQuery(s.ANY_SAMPLES_PASSED),u.occlusionQueryIndex++),!0===t.occlusionTest){const e=s.createQuery();s.beginQuery(s.ANY_SAMPLES_PASSED,e),u.occlusionQueries[u.occlusionQueryIndex]=e,u.occlusionQueryObjects[u.occlusionQueryIndex]=t}u.lastOcclusionObject=t}const p=this.bufferRenderer;t.isPoints?p.mode=s.POINTS:t.isLineSegments?p.mode=s.LINES:t.isLine?p.mode=s.LINE_STRIP:t.isLineLoop?p.mode=s.LINE_LOOP:!0===r.wireframe?(a.setLineWidth(r.wireframeLinewidth*this.renderer.getPixelRatio()),p.mode=s.LINES):p.mode=s.TRIANGLES;const{vertexCount:m,instanceCount:g}=c;let{firstVertex:v}=c;if(p.object=t,null!==d){v*=d.array.BYTES_PER_ELEMENT;const e=this.get(d);p.index=d.count,p.type=e.type}else p.index=0;var y;t.isBatchedMesh?null!==t._multiDrawInstances?p.renderMultiDrawInstances(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount,t._multiDrawInstances):this.hasFeature("WEBGL_multi_draw")?p.renderMultiDraw(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount):(y="THREE.WebGLRenderer: WEBGL_multi_draw not supported.")in lh||(lh[y]=!0,console.warn(y)):g>1?p.renderInstances(v,m,g):p.render(v,m),s.bindVertexArray(null)}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}copyTextureToBuffer(e,t,n,r,i,o){return this.textureUtils.copyTextureToBuffer(e,t,n,r,i,o)}createSampler(){}destroySampler(){}createNodeBuilder(e,t){return new rP(e,t)}createProgram(e){const t=this.gl,{stage:n,code:r}=e,i="fragment"===n?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);t.shaderSource(i,r),t.compileShader(i),this.set(e,{shaderGPU:i})}destroyProgram(){console.warn("Abstract class.")}createRenderPipeline(e,t){const n=this.gl,r=e.pipeline,{fragmentProgram:i,vertexProgram:o}=r,s=n.createProgram(),a=this.get(i).shaderGPU,u=this.get(o).shaderGPU;if(n.attachShader(s,a),n.attachShader(s,u),n.linkProgram(s),this.set(r,{programGPU:s,fragmentShader:a,vertexShader:u}),null!==t&&this.parallel){const i=new Promise((t=>{const i=this.parallel,o=()=>{n.getProgramParameter(s,i.COMPLETION_STATUS_KHR)?(this._completeCompile(e,r),t()):requestAnimationFrame(o)};o()}));t.push(i)}else this._completeCompile(e,r)}_handleSource(e,t){const n=e.split("\n"),r=[],i=Math.max(t-6,0),o=Math.min(t+6,n.length);for(let e=i;e<o;e++){const i=e+1;r.push(`${i===t?">":" "} ${i}: ${n[e]}`)}return r.join("\n")}_getShaderErrors(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(r&&""===i)return"";const o=/ERROR: 0:(\d+)/.exec(i);if(o){const r=parseInt(o[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+this._handleSource(e.getShaderSource(t),r)}return i}_logProgramError(e,t,n){if(this.renderer.debug.checkShaderErrors){const r=this.gl,i=r.getProgramInfoLog(e).trim();if(!1===r.getProgramParameter(e,r.LINK_STATUS))if("function"==typeof this.renderer.debug.onShaderError)this.renderer.debug.onShaderError(r,e,n,t);else{const o=this._getShaderErrors(r,n,"vertex"),s=this._getShaderErrors(r,t,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(e,r.VALIDATE_STATUS)+"\n\nProgram Info Log: "+i+"\n"+o+"\n"+s)}else""!==i&&console.warn("THREE.WebGLProgram: Program Info Log:",i)}}_completeCompile(e,t){const{state:n,gl:r}=this,i=this.get(t),{programGPU:o,fragmentShader:s,vertexShader:a}=i;!1===r.getProgramParameter(o,r.LINK_STATUS)&&this._logProgramError(o,s,a),n.useProgram(o);const u=e.getBindings();this._setupBindings(u,o),this.set(t,{programGPU:o})}createComputePipeline(e,t){const{state:n,gl:r}=this,i={stage:"fragment",code:"#version 300 es\nprecision highp float;\nvoid main() {}"};this.createProgram(i);const{computeProgram:o}=e,s=r.createProgram(),a=this.get(i).shaderGPU,u=this.get(o).shaderGPU,c=o.transforms,l=[],h=[];for(let e=0;e<c.length;e++){const t=c[e];l.push(t.varyingName),h.push(t.attributeNode)}r.attachShader(s,a),r.attachShader(s,u),r.transformFeedbackVaryings(s,l,r.SEPARATE_ATTRIBS),r.linkProgram(s),!1===r.getProgramParameter(s,r.LINK_STATUS)&&this._logProgramError(s,a,u),n.useProgram(s),this._setupBindings(t,s);const d=o.attributes,f=[],p=[];for(let e=0;e<d.length;e++){const t=d[e].node.attribute;f.push(t),this.has(t)||this.attributeUtils.createAttribute(t,r.ARRAY_BUFFER)}for(let e=0;e<h.length;e++){const t=h[e].attribute;this.has(t)||this.attributeUtils.createAttribute(t,r.ARRAY_BUFFER);const n=this.get(t);p.push(n)}this.set(e,{programGPU:s,transformBuffers:p,attributes:f})}createBindings(e,t){if(!1===this._knownBindings.has(t)){this._knownBindings.add(t);let e=0,n=0;for(const r of t){this.set(r,{textures:n,uniformBuffers:e});for(const t of r.bindings)t.isUniformBuffer&&e++,t.isSampledTexture&&n++}}this.updateBindings(e,t)}updateBindings(e){const{gl:t}=this,n=this.get(e);let r=n.uniformBuffers,i=n.textures;for(const n of e.bindings)if(n.isUniformsGroup||n.isUniformBuffer){const e=n.buffer,i=t.createBuffer();t.bindBuffer(t.UNIFORM_BUFFER,i),t.bufferData(t.UNIFORM_BUFFER,e,t.DYNAMIC_DRAW),this.set(n,{index:r++,bufferGPU:i})}else if(n.isSampledTexture){const{textureGPU:e,glTextureType:t}=this.get(n.texture);this.set(n,{index:i++,textureGPU:e,glTextureType:t})}}updateBinding(e){const t=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const n=this.get(e).bufferGPU,r=e.buffer;t.bindBuffer(t.UNIFORM_BUFFER,n),t.bufferData(t.UNIFORM_BUFFER,r,t.DYNAMIC_DRAW)}}createIndexAttribute(e){const t=this.gl;this.attributeUtils.createAttribute(e,t.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){}hasFeature(e){const t=Object.keys(SP).filter((t=>SP[t]===e)),n=this.extensions;for(let e=0;e<t.length;e++)if(n.has(t[e]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,t,n,r,i){this.textureUtils.copyTextureToTexture(e,t,n,r,i)}copyFramebufferToTexture(e,t,n){this.textureUtils.copyFramebufferToTexture(e,t,n)}_setFramebuffer(e){const{gl:t,state:n}=this;let r=null;if(null!==e.textures){const i=e.renderTarget,o=this.get(i),{samples:s,depthBuffer:a,stencilBuffer:u}=i,c=!0===i.isWebGLCubeRenderTarget;let l=o.msaaFrameBuffer,h=o.depthRenderbuffer;const d=RT(e);let f;if(c?(o.cubeFramebuffers||(o.cubeFramebuffers={}),f=o.cubeFramebuffers[d]):(o.framebuffers||(o.framebuffers={}),f=o.framebuffers[d]),void 0===f){f=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,f);const r=e.textures;if(c){o.cubeFramebuffers[d]=f;const{textureGPU:e}=this.get(r[0]),n=this.renderer._activeCubeFace;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+n,e,0)}else{o.framebuffers[d]=f;for(let n=0;n<r.length;n++){const i=r[n],o=this.get(i);o.renderTarget=e.renderTarget,o.cacheKey=d;const s=t.COLOR_ATTACHMENT0+n;t.framebufferTexture2D(t.FRAMEBUFFER,s,t.TEXTURE_2D,o.textureGPU,0)}n.drawBuffers(e,f)}if(null!==e.depthTexture){const n=this.get(e.depthTexture),r=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;n.renderTarget=e.renderTarget,n.cacheKey=d,t.framebufferTexture2D(t.FRAMEBUFFER,r,t.TEXTURE_2D,n.textureGPU,0)}}if(s>0){if(void 0===l){const r=[];l=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,l);const i=[],c=e.textures;for(let n=0;n<c.length;n++){if(i[n]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,i[n]),r.push(t.COLOR_ATTACHMENT0+n),a){const e=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;r.push(e)}const o=e.textures[n],c=this.get(o);t.renderbufferStorageMultisample(t.RENDERBUFFER,s,c.glInternalFormat,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+n,t.RENDERBUFFER,i[n])}if(o.msaaFrameBuffer=l,o.msaaRenderbuffers=i,void 0===h){h=t.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(h,e),o.depthRenderbuffer=h;const n=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;r.push(n)}o.invalidationArray=r}r=o.msaaFrameBuffer}else r=f}n.bindFramebuffer(t.FRAMEBUFFER,r)}_getVaoKey(e,t){let n=[];if(null!==e){n+=":"+this.get(e).id}for(let e=0;e<t.length;e++){n+=":"+this.get(t[e]).id}return n}_createVao(e,t){const{gl:n}=this,r=n.createVertexArray();let i="",o=!0;if(n.bindVertexArray(r),null!==e){const t=this.get(e);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.bufferGPU),i+=":"+t.id}for(let e=0;e<t.length;e++){const r=t[e],s=this.get(r);let a,u;i+=":"+s.id,n.bindBuffer(n.ARRAY_BUFFER,s.bufferGPU),n.enableVertexAttribArray(e),(r.isStorageBufferAttribute||r.isStorageInstancedBufferAttribute)&&(o=!1),!0===r.isInterleavedBufferAttribute?(a=r.data.stride*s.bytesPerElement,u=r.offset*s.bytesPerElement):(a=0,u=0),s.isInteger?n.vertexAttribIPointer(e,r.itemSize,s.type,a,u):n.vertexAttribPointer(e,r.itemSize,s.type,r.normalized,a,u),r.isInstancedBufferAttribute&&!r.isInterleavedBufferAttribute?n.vertexAttribDivisor(e,r.meshPerAttribute):r.isInterleavedBufferAttribute&&r.data.isInstancedInterleavedBuffer&&n.vertexAttribDivisor(e,r.data.meshPerAttribute)}return n.bindBuffer(n.ARRAY_BUFFER,null),this.vaoCache[i]=r,{vaoGPU:r,staticVao:o}}_getTransformFeedback(e){let t="";for(let n=0;n<e.length;n++)t+=":"+e[n].id;let n=this.transformFeedbackCache[t];if(void 0!==n)return n;const{gl:r}=this;n=r.createTransformFeedback(),r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,n);for(let t=0;t<e.length;t++){const n=e[t];r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,t,n.transformBuffer)}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[t]=n,n}_setupBindings(e,t){const n=this.gl;for(const r of e)for(const e of r.bindings){const r=this.get(e).index;if(e.isUniformsGroup||e.isUniformBuffer){const i=n.getUniformBlockIndex(t,e.name);n.uniformBlockBinding(t,i,r)}else if(e.isSampledTexture){const i=n.getUniformLocation(t,e.name);n.uniform1i(i,r)}}}_bindUniforms(e){const{gl:t,state:n}=this;for(const r of e)for(const e of r.bindings){const r=this.get(e),i=r.index;e.isUniformsGroup||e.isUniformBuffer?n.bindBufferBase(t.UNIFORM_BUFFER,i,r.bufferGPU):e.isSampledTexture&&n.bindTexture(r.glTextureType,r.textureGPU,t.TEXTURE0+i)}}dispose(){this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}class MP extends zO{constructor(e,t){super(e),this.texture=t,this.version=t?t.version:0,this.isSampler=!0}}class AP extends MP{constructor(e,t,n){super(e,t?t.value:null),this.textureNode=t,this.groupNode=n}update(){this.texture=this.textureNode.value}}class CP extends jO{constructor(e,t){super(e,t?t.array:null),this.attribute=t,this.isStorageBuffer=!0}}let OP=0;class PP extends CP{constructor(e,t){super("StorageBuffer_"+OP++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:QM,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class RP extends sT{constructor(e){super(),this.device=e;this.mipmapSampler=e.createSampler({minFilter:wM}),this.flipYSampler=e.createSampler({minFilter:SM}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:"\nstruct VarysStruct {\n\t@builtin( position ) Position: vec4<f32>,\n\t@location( 0 ) vTex : vec2<f32>\n};\n\n@vertex\nfn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {\n\n\tvar Varys : VarysStruct;\n\n\tvar pos = array< vec2<f32>, 4 >(\n\t\tvec2<f32>( -1.0,  1.0 ),\n\t\tvec2<f32>(  1.0,  1.0 ),\n\t\tvec2<f32>( -1.0, -1.0 ),\n\t\tvec2<f32>(  1.0, -1.0 )\n\t);\n\n\tvar tex = array< vec2<f32>, 4 >(\n\t\tvec2<f32>( 0.0, 0.0 ),\n\t\tvec2<f32>( 1.0, 0.0 ),\n\t\tvec2<f32>( 0.0, 1.0 ),\n\t\tvec2<f32>( 1.0, 1.0 )\n\t);\n\n\tVarys.vTex = tex[ vertexIndex ];\n\tVarys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );\n\n\treturn Varys;\n\n}\n"}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:"\n@group( 0 ) @binding( 0 )\nvar imgSampler : sampler;\n\n@group( 0 ) @binding( 1 )\nvar img : texture_2d<f32>;\n\n@fragment\nfn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {\n\n\treturn textureSample( img, imgSampler, vTex );\n\n}\n"}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:"\n@group( 0 ) @binding( 0 )\nvar imgSampler : sampler;\n\n@group( 0 ) @binding( 1 )\nvar img : texture_2d<f32>;\n\n@fragment\nfn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {\n\n\treturn textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );\n\n}\n"})}getTransferPipeline(e){let t=this.transferPipelines[e];return void 0===t&&(t=this.device.createRenderPipeline({label:`mipmap-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:eM,stripIndexFormat:vM},layout:"auto"}),this.transferPipelines[e]=t),t}getFlipYPipeline(e){let t=this.flipYPipelines[e];return void 0===t&&(t=this.device.createRenderPipeline({label:`flipY-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:eM,stripIndexFormat:vM},layout:"auto"}),this.flipYPipelines[e]=t),t}flipY(e,t,n=0){const r=t.format,{width:i,height:o}=t.size,s=this.getTransferPipeline(r),a=this.getFlipYPipeline(r),u=this.device.createTexture({size:{width:i,height:o,depthOrArrayLayers:1},format:r,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),c=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:cA,baseArrayLayer:n}),l=u.createView({baseMipLevel:0,mipLevelCount:1,dimension:cA,baseArrayLayer:0}),h=this.device.createCommandEncoder({}),d=(e,t,n)=>{const r=e.getBindGroupLayout(0),i=this.device.createBindGroup({layout:r,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:t}]}),o=h.beginRenderPass({colorAttachments:[{view:n,loadOp:hM,storeOp:cM,clearValue:[0,0,0,0]}]});o.setPipeline(e),o.setBindGroup(0,i),o.draw(4,1,0,0),o.end()};d(s,c,l),d(a,l,c),this.device.queue.submit([h.finish()]),u.destroy()}generateMipmaps(e,t,n=0){const r=this.get(e);void 0===r.useCount&&(r.useCount=0,r.layers=[]);const i=r.layers[n]||this._mipmapCreateBundles(e,t,n),o=this.device.createCommandEncoder({});this._mipmapRunBundles(o,i),this.device.queue.submit([o.finish()]),0!==r.useCount&&(r.layers[n]=i),r.useCount++}_mipmapCreateBundles(e,t,n){const r=this.getTransferPipeline(t.format),i=r.getBindGroupLayout(0);let o=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:cA,baseArrayLayer:n});const s=[];for(let a=1;a<t.mipLevelCount;a++){const u=this.device.createBindGroup({layout:i,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:o}]}),c=e.createView({baseMipLevel:a,mipLevelCount:1,dimension:cA,baseArrayLayer:n}),l={colorAttachments:[{view:c,loadOp:hM,storeOp:cM,clearValue:[0,0,0,0]}]},h=this.device.createRenderBundleEncoder({colorFormats:[t.format]});h.setPipeline(r),h.setBindGroup(0,u),h.draw(4,1,0,0),s.push({renderBundles:[h.finish()],passDescriptor:l}),o=c}return s}_mipmapRunBundles(e,t){const n=t.length;for(let r=0;r<n;r++){const n=t[r],i=e.beginRenderPass(n.passDescriptor);i.executeBundles(n.renderBundles),i.end()}}}const NP={512:"never",513:"less",514:"equal",515:"less-equal",516:"greater",518:"greater-equal",519:"always",517:"not-equal"},IP=[0,1,3,2,4,5];class kP{constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new dp,this.depthTexture.name="depthBuffer"}createSampler(e){const t=this.backend,n=t.device,r=t.get(e),i={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};i.magFilter===wM&&i.minFilter===wM&&i.mipmapFilter===wM&&(i.maxAnisotropy=e.anisotropy),e.isDepthTexture&&null!==e.compareFunction&&(i.compare=NP[e.compareFunction]),r.sampler=n.createSampler(i)}createDefaultTexture(e){let t;const n=DP(e);e.isCubeTexture?t=this._getDefaultCubeTextureGPU(n):e.isVideoTexture?this.backend.get(e).externalTexture=this._getDefaultVideoFrame():t=this._getDefaultTextureGPU(n),this.backend.get(e).texture=t}createTexture(e,t={}){const n=this.backend,r=n.get(e);if(r.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");void 0===t.needsMipmaps&&(t.needsMipmaps=!1),void 0===t.levels&&(t.levels=1),void 0===t.depth&&(t.depth=1);const{width:i,height:o,depth:s,levels:a}=t;e.isFramebufferTexture&&(t.renderTarget?t.format=this.backend.utils.getCurrentColorFormat(t.renderTarget):t.format=this.backend.utils.getPreferredCanvasFormat());const u=this._getDimension(e),c=e.internalFormat||t.format||DP(e,n.device);r.format=c;let l=void 0!==t.sampleCount?t.sampleCount:1;l=n.utils.getSampleCount(l);const h=e.isRenderTargetTexture&&!e.isMultisampleRenderTargetTexture?1:l;let d=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;!0===e.isStorageTexture&&(d|=GPUTextureUsage.STORAGE_BINDING),!0!==e.isCompressedTexture&&!0!==e.isCompressedArrayTexture&&(d|=GPUTextureUsage.RENDER_ATTACHMENT);const f={label:e.name,size:{width:i,height:o,depthOrArrayLayers:s},mipLevelCount:a,sampleCount:h,dimension:u,format:c,usage:d};if(e.isVideoTexture){const t=e.source.data,n=new VideoFrame(t);f.size.width=n.displayWidth,f.size.height=n.displayHeight,n.close(),r.externalTexture=t}else{if(void 0===c)return console.warn("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(e);r.texture=n.device.createTexture(f)}if(e.isRenderTargetTexture&&l>1&&!e.isMultisampleRenderTargetTexture){const e=Object.assign({},f);e.label=e.label+"-msaa",e.sampleCount=l,r.msaaTexture=n.device.createTexture(e)}r.initialized=!0,r.textureDescriptorGPU=f}destroyTexture(e){const t=this.backend,n=t.get(e);n.texture.destroy(),void 0!==n.msaaTexture&&n.msaaTexture.destroy(),t.delete(e)}destroySampler(e){delete this.backend.get(e).sampler}generateMipmaps(e){const t=this.backend.get(e);if(e.isCubeTexture)for(let e=0;e<6;e++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,e);else{const n=e.image.depth||1;for(let e=0;e<n;e++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,e)}}getColorBuffer(){this.colorBuffer&&this.colorBuffer.destroy();const e=this.backend,{width:t,height:n}=e.getDrawingBufferSize();return this.colorBuffer=e.device.createTexture({label:"colorBuffer",size:{width:t,height:n,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.samples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}getDepthBuffer(e=!0,t=!1){const n=this.backend,{width:r,height:i}=n.getDrawingBufferSize(),o=this.depthTexture,s=n.get(o).texture;let a,u;if(t?(a=ol,u=tl):e&&(a=il,u=Qc),void 0!==s){if(o.image.width===r&&o.image.height===i&&o.format===a&&o.type===u)return s;this.destroyTexture(o)}return o.name="depthBuffer",o.format=a,o.type=u,o.image.width=r,o.image.height=i,this.createTexture(o,{sampleCount:n.utils.getSampleCount(n.renderer.samples),width:r,height:i}),n.get(o).texture}updateTexture(e,t){const n=this.backend.get(e),{textureDescriptorGPU:r}=n;if(!e.isRenderTargetTexture&&void 0!==r){if(e.isDataTexture)this._copyBufferToTexture(t.image,n.texture,r,0,e.flipY);else if(e.isDataArrayTexture||e.isData3DTexture)for(let i=0;i<t.image.depth;i++)this._copyBufferToTexture(t.image,n.texture,r,i,e.flipY,i);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,n.texture,r);else if(e.isCubeTexture)this._copyCubeMapToTexture(t.images,n.texture,r,e.flipY);else if(e.isVideoTexture){const t=e.source.data;n.externalTexture=t}else this._copyImageToTexture(t.image,n.texture,r,0,e.flipY);n.version=e.version,e.onUpdate&&e.onUpdate(e)}}async copyTextureToBuffer(e,t,n,r,i,o){const s=this.backend.device,a=this.backend.get(e),u=a.texture,c=a.textureDescriptorGPU.format,l=this._getBytesPerTexel(c);let h=r*l;h=256*Math.ceil(h/256);const d=s.createBuffer({size:r*i*l,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),f=s.createCommandEncoder();f.copyTextureToBuffer({texture:u,origin:{x:t,y:n,z:o}},{buffer:d,bytesPerRow:h},{width:r,height:i});const p=this._getTypedArrayType(c);s.queue.submit([f.finish()]),await d.mapAsync(GPUMapMode.READ);return new p(d.getMappedRange())}_isEnvironmentTexture(e){const t=e.mapping;return t===Dc||t===Lc||t===Ic||t===kc}_getDefaultTextureGPU(e){let t=this.defaultTexture[e];if(void 0===t){const n=new Th;n.minFilter=jc,n.magFilter=jc,this.createTexture(n,{width:1,height:1,format:e}),this.defaultTexture[e]=t=n}return this.backend.get(t).texture}_getDefaultCubeTextureGPU(e){let t=this.defaultTexture[e];if(void 0===t){const n=new Xf;n.minFilter=jc,n.magFilter=jc,this.createTexture(n,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=t=n}return this.backend.get(t).texture}_getDefaultVideoFrame(){let e=this.defaultVideoFrame;if(null===e){const t={timestamp:0,codedWidth:1,codedHeight:1,format:"RGBA"};this.defaultVideoFrame=e=new VideoFrame(new Uint8Array([0,0,0,255]),t)}return e}_copyCubeMapToTexture(e,t,n,r){for(let i=0;i<6;i++){const o=e[i],s=!0===r?IP[i]:i;o.isDataTexture?this._copyBufferToTexture(o.image,t,n,s,r):this._copyImageToTexture(o,t,n,s,r)}}_copyImageToTexture(e,t,n,r,i){this.backend.device.queue.copyExternalImageToTexture({source:e},{texture:t,mipLevel:0,origin:{x:0,y:0,z:r}},{width:e.width,height:e.height,depthOrArrayLayers:1}),!0===i&&this._flipY(t,n,r)}_getPassUtils(){let e=this._passUtils;return null===e&&(this._passUtils=e=new RP(this.backend.device)),e}_generateMipmaps(e,t,n=0){this._getPassUtils().generateMipmaps(e,t,n)}_flipY(e,t,n=0){this._getPassUtils().flipY(e,t,n)}_copyBufferToTexture(e,t,n,r,i,o=0){const s=this.backend.device,a=e.data,u=this._getBytesPerTexel(n.format),c=e.width*u;s.queue.writeTexture({texture:t,mipLevel:0,origin:{x:0,y:0,z:r}},a,{offset:e.width*e.height*u*o,bytesPerRow:c},{width:e.width,height:e.height,depthOrArrayLayers:1}),!0===i&&this._flipY(t,n,r)}_copyCompressedBufferToTexture(e,t,n){const r=this.backend.device,i=this._getBlockData(n.format),o=n.size.depthOrArrayLayers>1;for(let s=0;s<e.length;s++){const a=e[s],u=a.width,c=a.height,l=o?n.size.depthOrArrayLayers:1,h=Math.ceil(u/i.width)*i.byteLength,d=h*Math.ceil(c/i.height);for(let e=0;e<l;e++)r.queue.writeTexture({texture:t,mipLevel:s,origin:{x:0,y:0,z:e}},a.data,{offset:e*d,bytesPerRow:h,rowsPerImage:Math.ceil(c/i.height)},{width:Math.ceil(u/i.width)*i.width,height:Math.ceil(c/i.height)*i.height,depthOrArrayLayers:1})}}_getBlockData(e){return e===yM.BC1RGBAUnorm||e===yM.BC1RGBAUnormSRGB?{byteLength:8,width:4,height:4}:e===yM.BC2RGBAUnorm||e===yM.BC2RGBAUnormSRGB||e===yM.BC3RGBAUnorm||e===yM.BC3RGBAUnormSRGB?{byteLength:16,width:4,height:4}:e===yM.BC4RUnorm||e===yM.BC4RSNorm?{byteLength:8,width:4,height:4}:e===yM.BC5RGUnorm||e===yM.BC5RGSnorm||e===yM.BC6HRGBUFloat||e===yM.BC6HRGBFloat||e===yM.BC7RGBAUnorm||e===yM.BC7RGBAUnormSRGB?{byteLength:16,width:4,height:4}:e===yM.ETC2RGB8Unorm||e===yM.ETC2RGB8UnormSRGB||e===yM.ETC2RGB8A1Unorm||e===yM.ETC2RGB8A1UnormSRGB?{byteLength:8,width:4,height:4}:e===yM.ETC2RGBA8Unorm||e===yM.ETC2RGBA8UnormSRGB?{byteLength:16,width:4,height:4}:e===yM.EACR11Unorm||e===yM.EACR11Snorm?{byteLength:8,width:4,height:4}:e===yM.EACRG11Unorm||e===yM.EACRG11Snorm||e===yM.ASTC4x4Unorm||e===yM.ASTC4x4UnormSRGB?{byteLength:16,width:4,height:4}:e===yM.ASTC5x4Unorm||e===yM.ASTC5x4UnormSRGB?{byteLength:16,width:5,height:4}:e===yM.ASTC5x5Unorm||e===yM.ASTC5x5UnormSRGB?{byteLength:16,width:5,height:5}:e===yM.ASTC6x5Unorm||e===yM.ASTC6x5UnormSRGB?{byteLength:16,width:6,height:5}:e===yM.ASTC6x6Unorm||e===yM.ASTC6x6UnormSRGB?{byteLength:16,width:6,height:6}:e===yM.ASTC8x5Unorm||e===yM.ASTC8x5UnormSRGB?{byteLength:16,width:8,height:5}:e===yM.ASTC8x6Unorm||e===yM.ASTC8x6UnormSRGB?{byteLength:16,width:8,height:6}:e===yM.ASTC8x8Unorm||e===yM.ASTC8x8UnormSRGB?{byteLength:16,width:8,height:8}:e===yM.ASTC10x5Unorm||e===yM.ASTC10x5UnormSRGB?{byteLength:16,width:10,height:5}:e===yM.ASTC10x6Unorm||e===yM.ASTC10x6UnormSRGB?{byteLength:16,width:10,height:6}:e===yM.ASTC10x8Unorm||e===yM.ASTC10x8UnormSRGB?{byteLength:16,width:10,height:8}:e===yM.ASTC10x10Unorm||e===yM.ASTC10x10UnormSRGB?{byteLength:16,width:10,height:10}:e===yM.ASTC12x10Unorm||e===yM.ASTC12x10UnormSRGB?{byteLength:16,width:12,height:10}:e===yM.ASTC12x12Unorm||e===yM.ASTC12x12UnormSRGB?{byteLength:16,width:12,height:12}:void 0}_convertAddressMode(e){let t=bM;return e===Fc?t=_M:e===zc&&(t=xM),t}_convertFilterMode(e){let t=wM;return e!==jc&&e!==Vc&&e!==Gc||(t=SM),t}_getBytesPerTexel(e){return e===yM.R8Unorm||e===yM.R8Snorm||e===yM.R8Uint||e===yM.R8Sint?1:e===yM.R16Uint||e===yM.R16Sint||e===yM.R16Float||e===yM.RG8Unorm||e===yM.RG8Snorm||e===yM.RG8Uint||e===yM.RG8Sint?2:e===yM.R32Uint||e===yM.R32Sint||e===yM.R32Float||e===yM.RG16Uint||e===yM.RG16Sint||e===yM.RG16Float||e===yM.RGBA8Unorm||e===yM.RGBA8UnormSRGB||e===yM.RGBA8Snorm||e===yM.RGBA8Uint||e===yM.RGBA8Sint||e===yM.BGRA8Unorm||e===yM.BGRA8UnormSRGB||e===yM.RGB9E5UFloat||e===yM.RGB10A2Unorm||e===yM.RG11B10UFloat||e===yM.Depth32Float||e===yM.Depth24Plus||e===yM.Depth24PlusStencil8||e===yM.Depth32FloatStencil8?4:e===yM.RG32Uint||e===yM.RG32Sint||e===yM.RG32Float||e===yM.RGBA16Uint||e===yM.RGBA16Sint||e===yM.RGBA16Float?8:e===yM.RGBA32Uint||e===yM.RGBA32Sint||e===yM.RGBA32Float?16:void 0}_getTypedArrayType(e){return e===yM.R8Uint?Uint8Array:e===yM.R8Sint?Int8Array:e===yM.R8Unorm?Uint8Array:e===yM.R8Snorm?Int8Array:e===yM.RG8Uint?Uint8Array:e===yM.RG8Sint?Int8Array:e===yM.RG8Unorm?Uint8Array:e===yM.RG8Snorm?Int8Array:e===yM.RGBA8Uint?Uint8Array:e===yM.RGBA8Sint?Int8Array:e===yM.RGBA8Unorm?Uint8Array:e===yM.RGBA8Snorm?Int8Array:e===yM.R16Uint?Uint16Array:e===yM.R16Sint?Int16Array:e===yM.RG16Uint?Uint16Array:e===yM.RG16Sint?Int16Array:e===yM.RGBA16Uint?Uint16Array:e===yM.RGBA16Sint?Int16Array:e===yM.R16Float||e===yM.RG16Float||e===yM.RGBA16Float?Uint16Array:e===yM.R32Uint?Uint32Array:e===yM.R32Sint?Int32Array:e===yM.R32Float?Float32Array:e===yM.RG32Uint?Uint32Array:e===yM.RG32Sint?Int32Array:e===yM.RG32Float?Float32Array:e===yM.RGBA32Uint?Uint32Array:e===yM.RGBA32Sint?Int32Array:e===yM.RGBA32Float?Float32Array:e===yM.BGRA8Unorm||e===yM.BGRA8UnormSRGB?Uint8Array:e===yM.RGB10A2Unorm||e===yM.RGB9E5UFloat||e===yM.RG11B10UFloat?Uint32Array:e===yM.Depth32Float?Float32Array:e===yM.Depth24Plus||e===yM.Depth24PlusStencil8?Uint32Array:e===yM.Depth32FloatStencil8?Float32Array:void 0}_getDimension(e){let t;return t=e.isData3DTexture?uA:aA,t}}function DP(e,t=null){const n=e.format,r=e.type,i=e.colorSpace;let o;if(!0===e.isCompressedTexture||!0===e.isCompressedArrayTexture)switch(n){case dl:o=i===Bl?yM.BC1RGBAUnormSRGB:yM.BC1RGBAUnorm;break;case fl:o=i===Bl?yM.BC2RGBAUnormSRGB:yM.BC2RGBAUnorm;break;case pl:o=i===Bl?yM.BC3RGBAUnormSRGB:yM.BC3RGBAUnorm;break;case ml:o=i===Bl?yM.ETC2RGB8UnormSRGB:yM.ETC2RGB8Unorm;break;case gl:o=i===Bl?yM.ETC2RGBA8UnormSRGB:yM.ETC2RGBA8Unorm;break;case vl:o=i===Bl?yM.ASTC4x4UnormSRGB:yM.ASTC4x4Unorm;break;case yl:o=i===Bl?yM.ASTC5x4UnormSRGB:yM.ASTC5x4Unorm;break;case bl:o=i===Bl?yM.ASTC5x5UnormSRGB:yM.ASTC5x5Unorm;break;case _l:o=i===Bl?yM.ASTC6x5UnormSRGB:yM.ASTC6x5Unorm;break;case xl:o=i===Bl?yM.ASTC6x6UnormSRGB:yM.ASTC6x6Unorm;break;case wl:o=i===Bl?yM.ASTC8x5UnormSRGB:yM.ASTC8x5Unorm;break;case Sl:o=i===Bl?yM.ASTC8x6UnormSRGB:yM.ASTC8x6Unorm;break;case El:o=i===Bl?yM.ASTC8x8UnormSRGB:yM.ASTC8x8Unorm;break;case Tl:o=i===Bl?yM.ASTC10x5UnormSRGB:yM.ASTC10x5Unorm;break;case Ml:o=i===Bl?yM.ASTC10x6UnormSRGB:yM.ASTC10x6Unorm;break;case Al:o=i===Bl?yM.ASTC10x8UnormSRGB:yM.ASTC10x8Unorm;break;case Cl:o=i===Bl?yM.ASTC10x10UnormSRGB:yM.ASTC10x10Unorm;break;case Ol:o=i===Bl?yM.ASTC12x10UnormSRGB:yM.ASTC12x10Unorm;break;case Pl:o=i===Bl?yM.ASTC12x12UnormSRGB:yM.ASTC12x12Unorm;break;default:console.error("WebGPURenderer: Unsupported texture format.",n)}else switch(n){case rl:switch(r){case Zc:o=yM.RGBA8Snorm;break;case $c:o=yM.RGBA16Sint;break;case Yc:o=yM.RGBA16Uint;break;case Qc:o=yM.RGBA32Uint;break;case Kc:o=yM.RGBA32Sint;break;case Xc:o=i===Bl?yM.RGBA8UnormSRGB:yM.RGBA8Unorm;break;case el:o=yM.RGBA16Float;break;case Jc:o=yM.RGBA32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAFormat.",r)}break;case nl:if(35902===r)o=yM.RGB9E5UFloat;else console.error("WebGPURenderer: Unsupported texture type with RGBFormat.",r);break;case sl:switch(r){case Zc:o=yM.R8Snorm;break;case $c:o=yM.R16Sint;break;case Yc:o=yM.R16Uint;break;case Qc:o=yM.R32Uint;break;case Kc:o=yM.R32Sint;break;case Xc:o=yM.R8Unorm;break;case el:o=yM.R16Float;break;case Jc:o=yM.R32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RedFormat.",r)}break;case ul:switch(r){case Zc:o=yM.RG8Snorm;break;case $c:o=yM.RG16Sint;break;case Yc:o=yM.RG16Uint;break;case Qc:o=yM.RG32Uint;break;case Kc:o=yM.RG32Sint;break;case Xc:o=yM.RG8Unorm;break;case el:o=yM.RG16Float;break;case Jc:o=yM.RG32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGFormat.",r)}break;case il:switch(r){case Yc:o=yM.Depth16Unorm;break;case Qc:o=yM.Depth24Plus;break;case Jc:o=yM.Depth32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthFormat.",r)}break;case ol:switch(r){case tl:o=yM.Depth24PlusStencil8;break;case Jc:t&&!1===t.features.has(gA.Depth32FloatStencil8)&&console.error('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),o=yM.Depth32FloatStencil8;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",r)}break;case al:switch(r){case Kc:o=yM.R32Sint;break;case Qc:o=yM.R32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",r)}break;case cl:switch(r){case Kc:o=yM.RG32Sint;break;case Qc:o=yM.RG32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",r)}break;case ll:switch(r){case Kc:o=yM.RGBA32Sint;break;case Qc:o=yM.RGBA32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",r)}break;default:console.error("WebGPURenderer: Unsupported texture format.",n)}return o}const LP=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,UP=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/gi,FP={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"};class BP extends _O{constructor(e){const{type:t,inputs:n,name:r,inputsCode:i,blockCode:o,outputType:s}=(e=>{const t=(e=e.trim()).match(LP);if(null!==t&&4===t.length){const n=t[2],r=[];let i=null;for(;null!==(i=UP.exec(n));)r.push({name:i[1],type:i[2]});const o=[];for(let e=0;e<r.length;e++){const{name:t,type:n}=r[e];let i=n;i.startsWith("ptr")?i="pointer":(i.startsWith("texture")&&(i=n.split("<")[0]),i=FP[i]),o.push(new uO(i,t))}const s=e.substring(t[0].length),a=t[3]||"void",u=void 0!==t[1]?t[1]:"";return{type:FP[a]||a,inputs:o,name:u,inputsCode:n,blockCode:s,outputType:a}}throw new Error("FunctionNode: Function is not a WGSL code.")})(e);super(t,n,r),this.inputsCode=i,this.blockCode=o,this.outputType=s}getCode(e=this.name){const t="void"!==this.outputType?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${t}`+this.blockCode}}class zP extends bO{parseFunction(e){return new BP(e)}}const jP=self.GPUShaderStage,VP={vertex:jP?jP.VERTEX:1,fragment:jP?jP.FRAGMENT:2,compute:jP?jP.COMPUTE:4},GP={instance:!0,swizzleAssign:!1,storageBuffer:!0},HP={"^^":"tsl_xor"},WP={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},qP={tsl_xor:new RA("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new RA("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new RA("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new RA("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new RA("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new RA("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new RA("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new RA("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new RA("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping:new RA("\nfn tsl_repeatWrapping( uv : vec2<f32>, dimension : vec2<u32> ) -> vec2<u32> {\n\n\tlet uvScaled = vec2<u32>( uv * vec2<f32>( dimension ) );\n\n\treturn ( ( uvScaled % dimension ) + dimension ) % dimension;\n\n}\n"),biquadraticTexture:new RA("\nfn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, level : i32 ) -> vec4f {\n\n\tlet iRes = vec2i( textureDimensions( map, level ) );\n\tlet res = vec2f( iRes );\n\n\tlet uvScaled = coord * res;\n\tlet uvWrapping = ( ( uvScaled % res ) + res ) % res;\n\n\t// https://www.shadertoy.com/view/WtyXRy\n\n\tlet uv = uvWrapping - 0.5;\n\tlet iuv = floor( uv );\n\tlet f = fract( uv );\n\n\tlet rg1 = textureLoad( map, vec2i( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );\n\tlet rg2 = textureLoad( map, vec2i( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );\n\tlet rg3 = textureLoad( map, vec2i( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );\n\tlet rg4 = textureLoad( map, vec2i( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );\n\n\treturn mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );\n\n}\n")},XP={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"};/Windows/g.test(navigator.userAgent)&&(qP.pow_float=new RA("fn tsl_pow_float( a : f32, b : f32 ) -> f32 { return select( -pow( -a, b ), pow( a, b ), a > 0.0 ); }"),qP.pow_vec2=new RA("fn tsl_pow_vec2( a : vec2f, b : vec2f ) -> vec2f { return vec2f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ) ); }",[qP.pow_float]),qP.pow_vec3=new RA("fn tsl_pow_vec3( a : vec3f, b : vec3f ) -> vec3f { return vec3f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ) ); }",[qP.pow_float]),qP.pow_vec4=new RA("fn tsl_pow_vec4( a : vec4f, b : vec4f ) -> vec4f { return vec4f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ), tsl_pow_float( a.w, b.w ) ); }",[qP.pow_float]),XP.pow_float="tsl_pow_float",XP.pow_vec2="tsl_pow_vec2",XP.pow_vec3="tsl_pow_vec3",XP.pow_vec4="tsl_pow_vec4");let ZP="";!0!==/Firefox|Deno/g.test(navigator.userAgent)&&(ZP+="diagnostic( off, derivative_uniformity );\n");class $P extends sO{constructor(e,t){super(e,t,new zP),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}needsToWorkingColorSpace(e){return!0===e.isVideoTexture&&e.colorSpace!==Fl}_generateTextureSample(e,t,n,r,i=this.shaderStage){return"fragment"===i?r?`textureSample( ${t}, ${t}_sampler, ${n}, ${r} )`:`textureSample( ${t}, ${t}_sampler, ${n} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,n):this.generateTextureLod(e,t,n,"0")}_generateVideoSample(e,t,n=this.shaderStage){if("fragment"===n)return`textureSampleBaseClampToEdge( ${e}, ${e}_sampler, vec2<f32>( ${t}.x, 1.0 - ${t}.y ) )`;console.error(`WebGPURenderer: THREE.VideoTexture does not support ${n} shader.`)}_generateTextureSampleLevel(e,t,n,r,i,o=this.shaderStage){return"fragment"===o&&!1===this.isUnfilterable(e)?`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${r} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,n,r):this.generateTextureLod(e,t,n,r)}generateFilteredTexture(e,t,n,r="0"){return this._include("biquadraticTexture"),`tsl_biquadraticTexture( ${t}, ${n}, i32( ${r} ) )`}generateTextureLod(e,t,n,r="0"){this._include("repeatWrapping");return`textureLoad( ${t}, tsl_repeatWrapping( ${n}, ${!0===e.isMultisampleRenderTargetTexture?`textureDimensions( ${t} )`:`textureDimensions( ${t}, 0 )`} ), i32( ${r} ) )`}generateTextureLoad(e,t,n,r,i="0u"){return r?`textureLoad( ${t}, ${n}, ${r}, ${i} )`:`textureLoad( ${t}, ${n}, ${i} )`}generateTextureStore(e,t,n,r){return`textureStore( ${t}, ${n}, ${r} )`}isUnfilterable(e){return"float"!==this.getComponentTypeFromTexture(e)||!this.isAvailable("float32Filterable")&&!0===e.isDataTexture&&e.type===Jc||!0===e.isMultisampleRenderTargetTexture}generateTexture(e,t,n,r,i=this.shaderStage){let o=null;return o=!0===e.isVideoTexture?this._generateVideoSample(t,n,i):this.isUnfilterable(e)?this.generateTextureLod(e,t,n,"0",r,i):this._generateTextureSample(e,t,n,r,i),o}generateTextureGrad(e,t,n,r,i,o=this.shaderStage){if("fragment"===o)return`textureSampleGrad( ${t}, ${t}_sampler, ${n},  ${r[0]}, ${r[1]} )`;console.error(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${o} shader.`)}generateTextureCompare(e,t,n,r,i,o=this.shaderStage){if("fragment"===o)return`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${r} )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${o} shader.`)}generateTextureLevel(e,t,n,r,i,o=this.shaderStage){let s=null;return s=!0===e.isVideoTexture?this._generateVideoSample(t,n,o):this._generateTextureSampleLevel(e,t,n,r,i,o),s}generateTextureBias(e,t,n,r,i,o=this.shaderStage){if("fragment"===o)return`textureSampleBias( ${t}, ${t}_sampler, ${n}, ${r} )`;console.error(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${o} shader.`)}getPropertyName(e,t=this.shaderStage){if(!0===e.isNodeVarying&&!0===e.needsInterpolation){if("vertex"===t)return`varyings.${e.name}`}else if(!0===e.isNodeUniform){const t=e.name,n=e.type;return"texture"===n||"cubeTexture"===n||"storageTexture"===n||"texture3D"===n?t:"buffer"===n||"storageBuffer"===n||"indirectStorageBuffer"===n?`NodeBuffer_${e.id}.${t}`:e.groupNode.name+"."+t}return super.getPropertyName(e)}getOutputStructName(){return"output"}_getUniformGroupCount(e){return Object.keys(this.uniforms[e]).length}getFunctionOperator(e){const t=HP[e];return void 0!==t?(this._include(t),t):null}getStorageAccess(e){if(e.isStorageTextureNode)switch(e.access){case tA:return"read";case eA:return"write";default:return"read_write"}else switch(e.access){case QM:return"read_write";case JM:return"read";default:return"write"}}getUniformFromNode(e,t,n,r=null){const i=super.getUniformFromNode(e,t,n,r),o=this.getDataFromNode(e,n,this.globalCache);if(void 0===o.uniformGPU){let r;const s=e.groupNode,a=s.name,u=this.getBindGroupArray(a,n);if("texture"===t||"cubeTexture"===t||"storageTexture"===t||"texture3D"===t){let o=null;if("texture"===t||"storageTexture"===t?o=new YO(i.name,i.node,s,e.access?e.access:null):"cubeTexture"===t?o=new KO(i.name,i.node,s,e.access?e.access:null):"texture3D"===t&&(o=new QO(i.name,i.node,s,e.access?e.access:null)),o.store=!0===e.isStorageTextureNode,o.setVisibility(VP[n]),"fragment"===n&&!1===this.isUnfilterable(e.value)&&!1===o.store){const e=new AP(`${i.name}_sampler`,i.node,s);e.setVisibility(VP[n]),u.push(e,o),r=[e,o]}else u.push(o),r=[o]}else if("buffer"===t||"storageBuffer"===t||"indirectStorageBuffer"===t){const i=new("buffer"===t?HO:PP)(e,s);i.setVisibility(VP[n]),u.push(i),r=i}else{const e=this.uniformGroups[n]||(this.uniformGroups[n]={});let o=e[a];void 0===o&&(o=new XO(a,s),o.setVisibility(VP[n]),e[a]=o,u.push(o)),r=this.getNodeUniform(i,t),o.addUniform(r)}o.uniformGPU=r}return i}getBuiltin(e,t,n,r=this.shaderStage){const i=this.builtins[r]||(this.builtins[r]=new Map);return!1===i.has(e)&&i.set(e,{name:e,property:t,type:n}),t}hasBuiltin(e,t=this.shaderStage){return void 0!==this.builtins[t]&&this.builtins[t].has(e)}getVertexIndex(){return"vertex"===this.shaderStage?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),r=[];for(const e of t.inputs)r.push(e.name+" : "+this.getType(e.type));let i=`fn ${t.name}( ${r.join(", ")} ) -> ${this.getType(t.type)} {\n${n.vars}\n${n.code}\n`;return n.result&&(i+=`\treturn ${n.result};\n`),i+="\n}\n",i}getInstanceIndex(){return"vertex"===this.shaderStage?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}isFlipY(){return!1}enableDirective(e,t=this.shaderStage){(this.directives[t]||(this.directives[t]=new Set)).add(e)}getDirectives(e){const t=[],n=this.directives[e];if(void 0!==n)for(const e of n)t.push(`enable ${e};`);return t.join("\n")}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}getBuiltins(e){const t=[],n=this.builtins[e];if(void 0!==n)for(const{name:e,property:r,type:i}of n.values())t.push(`@builtin( ${e} ) ${r} : ${i}`);return t.join(",\n\t")}getScopedArray(e,t,n,r){return!1===this.scopedArrays.has(e)&&this.scopedArrays.set(e,{name:e,scope:t,bufferType:n,bufferCount:r}),e}getScopedArrays(e){if("compute"!==e)return;const t=[];for(const{name:e,scope:n,bufferType:r,bufferCount:i}of this.scopedArrays.values()){const o=this.getType(r);t.push(`var<${n}> ${e}: array< ${o}, ${i} >;`)}return t.join("\n")}getAttributes(e){const t=[];if("compute"===e&&(this.getBuiltin("global_invocation_id","id","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),"vertex"===e||"compute"===e){const e=this.getBuiltins("attribute");e&&t.push(e);const n=this.getAttributesArray();for(let e=0,r=n.length;e<r;e++){const r=n[e],i=r.name,o=this.getType(r.type);t.push(`@location( ${e} ) ${i} : ${o}`)}}return t.join(",\n\t")}getStructMembers(e){const t=[],n=e.getMemberTypes();for(let e=0;e<n.length;e++){const r=n[e];t.push(`\t@location( ${e} ) m${e} : ${r}<f32>`)}const r=this.getBuiltins("output");return r&&t.push("\t"+r),t.join(",\n")}getStructs(e){const t=[],n=this.structs[e];for(let e=0,r=n.length;e<r;e++){const r=n[e],i=r.name;let o=`struct ${i} {\n`;o+=this.getStructMembers(r),o+="\n}",t.push(o),t.push(`\nvar<private> output : ${i};\n\n`)}return t.join("\n\n")}getVar(e,t){return`var ${t} : ${this.getType(e)}`}getVars(e){const t=[],n=this.vars[e];if(void 0!==n)for(const e of n)t.push(`\t${this.getVar(e.type,e.name)};`);return`\n${t.join("\n")}\n`}getVaryings(e){const t=[];if("vertex"===e&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),"vertex"===e||"fragment"===e){const n=this.varyings,r=this.vars[e];for(let i=0;i<n.length;i++){const o=n[i];if(o.needsInterpolation){let e=`@location( ${i} )`;/^(int|uint|ivec|uvec)/.test(o.type)&&(e+=" @interpolate( flat )"),t.push(`${e} ${o.name} : ${this.getType(o.type)}`)}else"vertex"===e&&!1===r.includes(o)&&r.push(o)}}const n=this.getBuiltins(e);n&&t.push(n);const r=t.join(",\n\t");return"vertex"===e?this._getWGSLStruct("VaryingsStruct","\t"+r):r}getUniforms(e){const t=this.uniforms[e],n=[],r=[],i=[],o={};for(const i of t){const t=i.groupNode.name,s=this.bindingsIndexes[t];if("texture"===i.type||"cubeTexture"===i.type||"storageTexture"===i.type||"texture3D"===i.type){const t=i.node.value;let r;"fragment"===e&&!1===this.isUnfilterable(t)&&!0!==i.node.isStorageTextureNode&&(!0===t.isDepthTexture&&null!==t.compareFunction?n.push(`@binding( ${s.binding++} ) @group( ${s.group} ) var ${i.name}_sampler : sampler_comparison;`):n.push(`@binding( ${s.binding++} ) @group( ${s.group} ) var ${i.name}_sampler : sampler;`));let o="";if(!0===t.isMultisampleRenderTargetTexture&&(o="_multisampled"),!0===t.isCubeTexture)r="texture_cube<f32>";else if(!0===t.isDataArrayTexture||!0===t.isCompressedArrayTexture)r="texture_2d_array<f32>";else if(!0===t.isDepthTexture)r=`texture_depth${o}_2d`;else if(!0===t.isVideoTexture)r="texture_external";else if(!0===t.isData3DTexture)r="texture_3d<f32>";else if(!0===i.node.isStorageTextureNode){r=`texture_storage_2d<${DP(t)}, ${this.getStorageAccess(i.node)}>`}else{r=`texture${o}_2d<${this.getComponentTypeFromTexture(t).charAt(0)}32>`}n.push(`@binding( ${s.binding++} ) @group( ${s.group} ) var ${i.name} : ${r};`)}else if("buffer"===i.type||"storageBuffer"===i.type||"indirectStorageBuffer"===i.type){const e=i.node,t=this.getType(e.bufferType),n=e.bufferCount,o=n>0&&"buffer"===i.type?", "+n:"",a=e.isAtomic?`atomic<${t}>`:`${t}`,u=`\t${i.name} : array< ${a}${o} >\n`,c=e.isStorageBufferNode?`storage, ${this.getStorageAccess(e)}`:"uniform";r.push(this._getWGSLStructBinding("NodeBuffer_"+e.id,u,c,s.binding++,s.group))}else{const e=this.getType(this.getVectorType(i.type)),t=i.groupNode.name;(o[t]||(o[t]={index:s.binding++,id:s.group,snippets:[]})).snippets.push(`\t${i.name} : ${e}`)}}for(const e in o){const t=o[e];i.push(this._getWGSLStructBinding(e,t.snippets.join(",\n"),"uniform",t.index,t.id))}let s=n.join("\n");return s+=r.join("\n"),s+=i.join("\n"),s}buildCode(){const e=null!==this.material?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){const n=e[t];n.uniforms=this.getUniforms(t),n.attributes=this.getAttributes(t),n.varyings=this.getVaryings(t),n.structs=this.getStructs(t),n.vars=this.getVars(t),n.codes=this.getCodes(t),n.directives=this.getDirectives(t),n.scopedArrays=this.getScopedArrays(t);let r="// code\n\n";r+=this.flowCode[t];const i=this.flowNodes[t],o=i[i.length-1],s=o.outputNode,a=void 0!==s&&!0===s.isOutputStructNode;for(const e of i){const i=this.getFlowData(e),u=e.name;if(u&&(r.length>0&&(r+="\n"),r+=`\t// flow -> ${u}\n\t`),r+=`${i.code}\n\t`,e===o&&"compute"!==t)if(r+="// result\n\n\t","vertex"===t)r+=`varyings.Vertex = ${i.result};`;else if("fragment"===t)if(a)n.returnType=s.nodeType,r+=`return ${i.result};`;else{let e="\t@location(0) color: vec4<f32>";const t=this.getBuiltins("output");t&&(e+=",\n\t"+t),n.returnType="OutputStruct",n.structs+=this._getWGSLStruct("OutputStruct",e),n.structs+="\nvar<private> output : OutputStruct;\n\n",r+=`output.color = ${i.result};\n\n\treturn output;`}}n.flow=r}null!==this.material?(this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment)):this.computeShader=this._getWGSLComputeCode(e.compute,(this.object.workgroupSize||[64]).join(", "))}getMethod(e,t=null){let n;return null!==t&&(n=this._getWGSLMethod(e+"_"+t)),void 0===n&&(n=this._getWGSLMethod(e)),n||e}getType(e){return WP[e]||e}isAvailable(e){let t=GP[e];return void 0===t&&("float32Filterable"===e&&(t=this.renderer.hasFeature("float32-filterable")),GP[e]=t),t}_getWGSLMethod(e){return void 0!==qP[e]&&this._include(e),XP[e]}_include(e){const t=qP[e];return t.build(this),null!==this.currentFunctionNode&&this.currentFunctionNode.includes.push(t),t}_getWGSLVertexCode(e){return`${this.getSignature()}\n// directives\n${e.directives}\n\n// uniforms\n${e.uniforms}\n\n// varyings\n${e.varyings}\nvar<private> varyings : VaryingsStruct;\n\n// codes\n${e.codes}\n\n@vertex\nfn main( ${e.attributes} ) -> VaryingsStruct {\n\n\t// vars\n\t${e.vars}\n\n\t// flow\n\t${e.flow}\n\n\treturn varyings;\n\n}\n`}_getWGSLFragmentCode(e){return`${this.getSignature()}\n// global\n${ZP}\n\n// uniforms\n${e.uniforms}\n\n// structs\n${e.structs}\n\n// codes\n${e.codes}\n\n@fragment\nfn main( ${e.varyings} ) -> ${e.returnType} {\n\n\t// vars\n\t${e.vars}\n\n\t// flow\n\t${e.flow}\n\n}\n`}_getWGSLComputeCode(e,t){return`${this.getSignature()}\n// directives\n${e.directives}\n\n// system\nvar<private> instanceIndex : u32;\n\n// locals\n${e.scopedArrays}\n\n// uniforms\n${e.uniforms}\n\n// codes\n${e.codes}\n\n@compute @workgroup_size( ${t} )\nfn main( ${e.attributes} ) {\n\n\t// system\n\tinstanceIndex = id.x + id.y * numWorkgroups.x * u32(${t}) + id.z * numWorkgroups.x * numWorkgroups.y * u32(${t});\n\n\t// vars\n\t${e.vars}\n\n\t// flow\n\t${e.flow}\n\n}\n`}_getWGSLStruct(e,t){return`\nstruct ${e} {\n${t}\n};`}_getWGSLStructBinding(e,t,n,r=0,i=0){const o=e+"Struct";return`${this._getWGSLStruct(o,t)}\n@binding( ${r} ) @group( ${i} )\nvar<${n}> ${e} : ${o};`}}class YP{constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let t;return null!==e.depthTexture?t=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?t=yM.Depth24PlusStencil8:e.depth&&(t=yM.Depth24Plus),t}getTextureFormatGPU(e){return this.backend.get(e).format}getCurrentColorFormat(e){let t;return t=null!==e.textures?this.getTextureFormatGPU(e.textures[0]):this.getPreferredCanvasFormat(),t}getCurrentColorSpace(e){return null!==e.textures?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,t){return e.isPoints?YT:e.isLineSegments||e.isMesh&&!0===t.wireframe?KT:e.isLine?QT:e.isMesh?JT:void 0}getSampleCount(e){let t=1;return e>1&&(t=Math.pow(2,Math.floor(Math.log2(e))),2===t&&(t=4)),t}getSampleCountRenderContext(e){return null!==e.textures?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}getPreferredCanvasFormat(){return navigator.userAgent.includes("Quest")?yM.BGRA8Unorm:navigator.gpu.getPreferredCanvasFormat()}}const KP=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]),QP=new Map([[pf,["float16"]]]),JP=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class eR{constructor(e){this.backend=e}createAttribute(e,t){const n=this._getBufferAttribute(e),r=this.backend,i=r.get(n);let o=i.buffer;if(void 0===o){const s=r.device;let a=n.array;if(!1===e.normalized&&(a.constructor===Int16Array||a.constructor===Uint16Array)){const e=new Uint32Array(a.length);for(let t=0;t<a.length;t++)e[t]=a[t];a=e}if(n.array=a,(n.isStorageBufferAttribute||n.isStorageInstancedBufferAttribute)&&3===n.itemSize){a=new a.constructor(4*n.count);for(let e=0;e<n.count;e++)a.set(n.array.subarray(3*e,3*e+3),4*e);n.itemSize=4,n.array=a}const u=a.byteLength+(4-a.byteLength%4)%4;o=s.createBuffer({label:n.name,size:u,usage:t,mappedAtCreation:!0}),new a.constructor(o.getMappedRange()).set(a),o.unmap(),i.buffer=o}}updateAttribute(e){const t=this._getBufferAttribute(e),n=this.backend,r=n.device,i=n.get(t).buffer,o=t.array,s=t.updateRanges;if(0===s.length)r.queue.writeBuffer(i,0,o,0);else{for(let e=0,t=s.length;e<t;e++){const t=s[e];r.queue.writeBuffer(i,0,o,t.start*o.BYTES_PER_ELEMENT,t.count*o.BYTES_PER_ELEMENT)}t.clearUpdateRanges()}}createShaderVertexBuffers(e){const t=e.getAttributes(),n=new Map;for(let e=0;e<t.length;e++){const r=t[e],i=r.array.BYTES_PER_ELEMENT,o=this._getBufferAttribute(r);let s=n.get(o);if(void 0===s){let e,t;!0===r.isInterleavedBufferAttribute?(e=r.data.stride*i,t=r.data.isInstancedInterleavedBuffer?mA:pA):(e=r.itemSize*i,t=r.isInstancedBufferAttribute?mA:pA),!1!==r.normalized||r.array.constructor!==Int16Array&&r.array.constructor!==Uint16Array||(e=4),s={arrayStride:e,attributes:[],stepMode:t},n.set(o,s)}const a=this._getVertexFormat(r),u=!0===r.isInterleavedBufferAttribute?r.offset*i:0;s.attributes.push({shaderLocation:e,offset:u,format:a})}return Array.from(n.values())}destroyAttribute(e){const t=this.backend;t.get(this._getBufferAttribute(e)).buffer.destroy(),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,n=t.device,r=t.get(this._getBufferAttribute(e)).buffer,i=r.size,o=n.createBuffer({label:e.name,size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),s=n.createCommandEncoder({});s.copyBufferToBuffer(r,0,o,0,i),o.unmap();const a=s.finish();n.queue.submit([a]),await o.mapAsync(GPUMapMode.READ);return o.getMappedRange()}_getVertexFormat(e){const{itemSize:t,normalized:n}=e,r=e.array.constructor,i=e.constructor;let o;if(1==t)o=JP.get(r);else{const e=(QP.get(i)||KP.get(r))[n?1:0];if(e){const n=r.BYTES_PER_ELEMENT*t,i=4*Math.floor((n+3)/4)/r.BYTES_PER_ELEMENT;if(i%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");o=`${e}x${i}`}}return o||console.error("THREE.WebGPUAttributeUtils: Vertex format not supported yet."),o}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class tR{constructor(e){this.backend=e,this.bindGroupLayoutCache=new WeakMap}createBindingsLayout(e){const t=this.backend.device,n=[];let r=0;for(const t of e.bindings){const e={binding:r++,visibility:t.visibility};if(t.isUniformBuffer||t.isStorageBuffer){const n={};t.isStorageBuffer&&(n.type=t.access),e.buffer=n}else if(t.isSampler){const n={};t.texture.isDepthTexture&&null!==t.texture.compareFunction&&(n.type="comparison"),e.sampler=n}else if(t.isSampledTexture&&t.texture.isVideoTexture)e.externalTexture={};else if(t.isSampledTexture&&t.store){const n=this.backend.get(t.texture).texture.format,r=t.access;e.storageTexture={format:n,access:r}}else if(t.isSampledTexture){const n={};if(!0===t.texture.isMultisampleRenderTargetTexture&&(n.multisampled=!0),t.texture.isDepthTexture)n.sampleType=iA;else if(t.texture.isDataTexture||t.texture.isDataArrayTexture||t.texture.isData3DTexture){const e=t.texture.type;e===Kc?n.sampleType=oA:e===Qc?n.sampleType=sA:e===Jc&&(this.backend.hasFeature("float32-filterable")?n.sampleType=nA:n.sampleType=rA)}t.isSampledCubeTexture?n.viewDimension=hA:t.texture.isDataArrayTexture||t.texture.isCompressedArrayTexture?n.viewDimension=lA:t.isSampledTexture3D&&(n.viewDimension=dA),e.texture=n}else console.error(`WebGPUBindingUtils: Unsupported binding "${t}".`);n.push(e)}return t.createBindGroupLayout({entries:n})}createBindings(e){const{backend:t,bindGroupLayoutCache:n}=this,r=t.get(e);let i=n.get(e.bindingsReference);void 0===i&&(i=this.createBindingsLayout(e),n.set(e.bindingsReference,i));const o=this.createBindGroup(e,i);r.layout=i,r.group=o}updateBinding(e){const t=this.backend,n=t.device,r=e.buffer,i=t.get(e).buffer;n.queue.writeBuffer(i,0,r,0)}createBindGroup(e,t){const n=this.backend,r=n.device;let i=0;const o=[];for(const t of e.bindings){if(t.isUniformBuffer){const e=n.get(t);if(void 0===e.buffer){const n=t.byteLength,i=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,o=r.createBuffer({label:"bindingBuffer_"+t.name,size:n,usage:i});e.buffer=o}o.push({binding:i,resource:{buffer:e.buffer}})}else if(t.isStorageBuffer){const e=n.get(t);if(void 0===e.buffer){const r=t.attribute;e.buffer=n.get(r).buffer}o.push({binding:i,resource:{buffer:e.buffer}})}else if(t.isSampler){const e=n.get(t.texture);o.push({binding:i,resource:e.sampler})}else if(t.isSampledTexture){const e=n.get(t.texture);let s;if(void 0!==e.externalTexture)s=r.importExternalTexture({source:e.externalTexture});else{const n=t.store?1:e.texture.mipLevelCount,r=`view-${e.texture.width}-${e.texture.height}-${n}`;if(s=e[r],void 0===s){const i=fA;let o;o=t.isSampledCubeTexture?hA:t.isSampledTexture3D?dA:t.texture.isDataArrayTexture||t.texture.isCompressedArrayTexture?lA:cA,s=e[r]=e.texture.createView({aspect:i,dimension:o,mipLevelCount:n})}}o.push({binding:i,resource:s})}i++}return r.createBindGroup({label:"bindGroup_"+e.name,layout:t,entries:o})}}class nR{constructor(e){this.backend=e}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,t){const{object:n,material:r,geometry:i,pipeline:o}=e,{vertexProgram:s,fragmentProgram:a}=o,u=this.backend,c=u.device,l=u.utils,h=u.get(o),d=[];for(const t of e.getBindings()){const e=u.get(t);d.push(e.layout)}const f=u.attributeUtils.createShaderVertexBuffers(e);let p;!0===r.transparent&&0!==r.blending&&(p=this._getBlending(r));let m={};!0===r.stencilWrite&&(m={compare:this._getStencilCompare(r),failOp:this._getStencilOperation(r.stencilFail),depthFailOp:this._getStencilOperation(r.stencilZFail),passOp:this._getStencilOperation(r.stencilZPass)});const g=this._getColorWriteMask(r),v=[];if(null!==e.context.textures){const t=e.context.textures;for(let e=0;e<t.length;e++){const n=l.getTextureFormatGPU(t[e]);v.push({format:n,blend:p,writeMask:g})}}else{const t=l.getCurrentColorFormat(e.context);v.push({format:t,blend:p,writeMask:g})}const y=u.get(s).module,b=u.get(a).module,_=this._getPrimitiveState(n,i,r),x=this._getDepthCompare(r),w=l.getCurrentDepthStencilFormat(e.context),S=this._getSampleCount(e.context),E={label:`renderPipeline_${r.name||r.type}_${r.id}`,vertex:Object.assign({},y,{buffers:f}),fragment:Object.assign({},b,{targets:v}),primitive:_,multisample:{count:S,alphaToCoverageEnabled:r.alphaToCoverage&&S>1},layout:c.createPipelineLayout({bindGroupLayouts:d})},T={},M=e.context.depth,A=e.context.stencil;if(!0!==M&&!0!==A||(!0===M&&(T.format=w,T.depthWriteEnabled=r.depthWrite,T.depthCompare=x),!0===A&&(T.stencilFront=m,T.stencilBack={},T.stencilReadMask=r.stencilFuncMask,T.stencilWriteMask=r.stencilWriteMask),E.depthStencil=T),null===t)h.pipeline=c.createRenderPipeline(E);else{const e=new Promise((e=>{c.createRenderPipelineAsync(E).then((t=>{h.pipeline=t,e()}))}));t.push(e)}}createBundleEncoder(e){const t=this.backend,{utils:n,device:r}=t,i=n.getCurrentDepthStencilFormat(e),o={label:"renderBundleEncoder",colorFormats:[n.getCurrentColorFormat(e)],depthStencilFormat:i,sampleCount:this._getSampleCount(e)};return r.createRenderBundleEncoder(o)}createComputePipeline(e,t){const n=this.backend,r=n.device,i=n.get(e.computeProgram).module,o=n.get(e),s=[];for(const e of t){const t=n.get(e);s.push(t.layout)}o.pipeline=r.createComputePipeline({compute:i,layout:r.createPipelineLayout({bindGroupLayouts:s})})}_getBlending(e){let t,n;const r=e.blending,i=e.blendSrc,o=e.blendDst,s=e.blendEquation;if(5===r){const r=null!==e.blendSrcAlpha?e.blendSrcAlpha:i,a=null!==e.blendDstAlpha?e.blendDstAlpha:o,u=null!==e.blendEquationAlpha?e.blendEquationAlpha:s;t={srcFactor:this._getBlendFactor(i),dstFactor:this._getBlendFactor(o),operation:this._getBlendOperation(s)},n={srcFactor:this._getBlendFactor(r),dstFactor:this._getBlendFactor(a),operation:this._getBlendOperation(u)}}else{const i=(e,r,i,o)=>{t={srcFactor:e,dstFactor:r,operation:UM},n={srcFactor:i,dstFactor:o,operation:UM}};if(e.premultipliedAlpha)switch(r){case 1:i(TM,OM,TM,OM);break;case 2:i(TM,TM,TM,TM);break;case 3:i(EM,AM,EM,TM);break;case 4:i(EM,MM,EM,CM)}else switch(r){case 1:i(CM,OM,TM,OM);break;case 2:i(CM,TM,CM,TM);break;case 3:i(EM,AM,EM,TM);break;case 4:i(EM,MM,EM,MM)}}if(void 0!==t&&void 0!==n)return{color:t,alpha:n};console.error("THREE.WebGPURenderer: Invalid blending: ",r)}_getBlendFactor(e){let t;switch(e){case 200:t=EM;break;case 201:t=TM;break;case 202:t=MM;break;case 203:t=AM;break;case Pc:t=CM;break;case Rc:t=OM;break;case 208:t=PM;break;case 209:t=RM;break;case 206:t=NM;break;case 207:t=IM;break;case 210:t=kM;break;case 211:t=DM;break;case 212:t=LM;break;default:console.error("THREE.WebGPURenderer: Blend factor not supported.",e)}return t}_getStencilCompare(e){let t;const n=e.stencilFunc;switch(n){case 512:t=tM;break;case 519:t=uM;break;case 513:t=nM;break;case 515:t=iM;break;case 514:t=rM;break;case 518:t=aM;break;case 516:t=oM;break;case 517:t=sM;break;default:console.error("THREE.WebGPURenderer: Invalid stencil function.",n)}return t}_getStencilOperation(e){let t;switch(e){case Gl:t=HM;break;case 0:t=WM;break;case 7681:t=qM;break;case 5386:t=XM;break;case 7682:t=ZM;break;case 7683:t=$M;break;case 34055:t=YM;break;case 34056:t=KM;break;default:console.error("THREE.WebGPURenderer: Invalid stencil operation.",t)}return t}_getBlendOperation(e){let t;switch(e){case Oc:t=UM;break;case 101:t=FM;break;case 102:t=BM;break;case 103:t=zM;break;case 104:t=jM;break;default:console.error("THREE.WebGPUPipelineUtils: Blend equation not supported.",e)}return t}_getPrimitiveState(e,t,n){const r={},i=this.backend.utils;switch(r.topology=i.getPrimitiveTopology(e,n),null!==t.index&&!0===e.isLine&&!0!==e.isLineSegments&&(r.stripIndexFormat=t.index.array instanceof Uint16Array?gM:vM),n.side){case 0:r.frontFace=dM,r.cullMode=mM;break;case 1:r.frontFace=dM,r.cullMode=pM;break;case 2:r.frontFace=dM,r.cullMode=fM;break;default:console.error("THREE.WebGPUPipelineUtils: Unknown material.side value.",n.side)}return r}_getColorWriteMask(e){return!0===e.colorWrite?GM:VM}_getDepthCompare(e){let t;if(!1===e.depthTest)t=uM;else{const n=e.depthFunc;switch(n){case 0:t=tM;break;case 1:t=uM;break;case 2:t=nM;break;case 3:t=iM;break;case 4:t=rM;break;case 5:t=aM;break;case 6:t=oM;break;case 7:t=sM;break;default:console.error("THREE.WebGPUPipelineUtils: Invalid depth function.",n)}}return t}}class rR extends aP{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=void 0===e.alpha||e.alpha,this.parameters.requiredLimits=void 0===e.requiredLimits?{}:e.requiredLimits,this.trackTimestamp=!0===e.trackTimestamp,this.device=null,this.context=null,this.colorBuffer=null,this.defaultRenderPassdescriptor=null,this.utils=new YP(this),this.attributeUtils=new eR(this),this.bindingUtils=new tR(this),this.pipelineUtils=new nR(this),this.textureUtils=new kP(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const t=this.parameters;let n;if(void 0===t.device){const e={powerPreference:t.powerPreference},r=await navigator.gpu.requestAdapter(e);if(null===r)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const i=Object.values(gA),o=[];for(const e of i)r.features.has(e)&&o.push(e);const s={requiredFeatures:o,requiredLimits:t.requiredLimits};n=await r.requestDevice(s)}else n=t.device;n.lost.then((t=>{const n={api:"WebGPU",message:t.message||"Unknown reason",reason:t.reason||null,originalEvent:t};e.onDeviceLost(n)}));const r=void 0!==t.context?t.context:e.domElement.getContext("webgpu");this.device=n,this.context=r;const i=t.alpha?"premultiplied":"opaque";this.trackTimestamp=this.trackTimestamp&&this.hasFeature(gA.TimestampQuery),this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:i}),this.updateSize()}get coordinateSystem(){return Xl}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){let e=this.defaultRenderPassdescriptor;if(null===e){const t=this.renderer;e={colorAttachments:[{view:null}]},!0!==this.renderer.depth&&!0!==this.renderer.stencil||(e.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(t.depth,t.stencil).createView()});const n=e.colorAttachments[0];this.renderer.samples>0?n.view=this.colorBuffer.createView():n.resolveTarget=void 0,this.defaultRenderPassdescriptor=e}const t=e.colorAttachments[0];return this.renderer.samples>0?t.resolveTarget=this.context.getCurrentTexture().createView():t.view=this.context.getCurrentTexture().createView(),e}_getRenderPassDescriptor(e){const t=e.renderTarget,n=this.get(t);let r=n.descriptors;if(void 0===r||n.width!==t.width||n.height!==t.height||n.activeMipmapLevel!==t.activeMipmapLevel||n.samples!==t.samples){r={},n.descriptors=r;const e=()=>{t.removeEventListener("dispose",e),this.delete(t)};t.addEventListener("dispose",e)}const i=e.getCacheKey();let o=r[i];if(void 0===o){const s=e.textures,a=[];for(let t=0;t<s.length;t++){const n=this.get(s[t]),r=n.texture.createView({baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,dimension:cA});let i,o;void 0!==n.msaaTexture?(i=n.msaaTexture.createView(),o=r):(i=r,o=void 0),a.push({view:i,resolveTarget:o,loadOp:lM,storeOp:cM})}if(o={colorAttachments:a},e.depth){const t={view:this.get(e.depthTexture).texture.createView()};o.depthStencilAttachment=t}r[i]=o,n.width=t.width,n.height=t.height,n.samples=t.samples,n.activeMipmapLevel=t.activeMipmapLevel}return o}beginRender(e){const t=this.get(e),n=this.device,r=e.occlusionQueryCount;let i,o;r>0&&(t.currentOcclusionQuerySet&&t.currentOcclusionQuerySet.destroy(),t.currentOcclusionQueryBuffer&&t.currentOcclusionQueryBuffer.destroy(),t.currentOcclusionQuerySet=t.occlusionQuerySet,t.currentOcclusionQueryBuffer=t.occlusionQueryBuffer,t.currentOcclusionQueryObjects=t.occlusionQueryObjects,i=n.createQuerySet({type:"occlusion",count:r}),t.occlusionQuerySet=i,t.occlusionQueryIndex=0,t.occlusionQueryObjects=new Array(r),t.lastOcclusionObject=null),o=null===e.textures?this._getDefaultRenderPassDescriptor():this._getRenderPassDescriptor(e),this.initTimestampQuery(e,o),o.occlusionQuerySet=i;const s=o.depthStencilAttachment;if(null!==e.textures){const t=o.colorAttachments;for(let n=0;n<t.length;n++){const r=t[n];e.clearColor?(r.clearValue=0===n?e.clearColorValue:{r:0,g:0,b:0,a:1},r.loadOp=hM,r.storeOp=cM):(r.loadOp=lM,r.storeOp=cM)}}else{const t=o.colorAttachments[0];e.clearColor?(t.clearValue=e.clearColorValue,t.loadOp=hM,t.storeOp=cM):(t.loadOp=lM,t.storeOp=cM)}e.depth&&(e.clearDepth?(s.depthClearValue=e.clearDepthValue,s.depthLoadOp=hM,s.depthStoreOp=cM):(s.depthLoadOp=lM,s.depthStoreOp=cM)),e.stencil&&(e.clearStencil?(s.stencilClearValue=e.clearStencilValue,s.stencilLoadOp=hM,s.stencilStoreOp=cM):(s.stencilLoadOp=lM,s.stencilStoreOp=cM));const a=n.createCommandEncoder({label:"renderContext_"+e.id}),u=a.beginRenderPass(o);if(t.descriptor=o,t.encoder=a,t.currentPass=u,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.renderBundles=[],e.viewport&&this.updateViewport(e),e.scissor){const{x:t,y:n,width:r,height:i}=e.scissorValue;u.setScissorRect(t,n,r,i)}}finishRender(e){const t=this.get(e),n=e.occlusionQueryCount;if(t.renderBundles.length>0&&t.currentPass.executeBundles(t.renderBundles),n>t.occlusionQueryIndex&&t.currentPass.endOcclusionQuery(),t.currentPass.end(),n>0){const r=8*n;let i=this.occludedResolveCache.get(r);void 0===i&&(i=this.device.createBuffer({size:r,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(r,i));const o=this.device.createBuffer({size:r,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});t.encoder.resolveQuerySet(t.occlusionQuerySet,0,n,i,0),t.encoder.copyBufferToBuffer(i,0,o,0,r),t.occlusionQueryBuffer=o,this.resolveOccludedAsync(e)}if(this.prepareTimestampBuffer(e,t.encoder),this.device.queue.submit([t.encoder.finish()]),null!==e.textures){const t=e.textures;for(let e=0;e<t.length;e++){const n=t[e];!0===n.generateMipmaps&&this.textureUtils.generateMipmaps(n)}}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}async resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueryBuffer:n,currentOcclusionQueryObjects:r}=t;if(n&&r){const e=new WeakSet;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueryBuffer=null,await n.mapAsync(GPUMapMode.READ);const i=n.getMappedRange(),o=new BigUint64Array(i);for(let t=0;t<r.length;t++)o[t]!==BigInt(0)&&e.add(r[t]);n.destroy(),t.occluded=e}}updateViewport(e){const{currentPass:t}=this.get(e),{x:n,y:r,width:i,height:o,minDepth:s,maxDepth:a}=e.viewportValue;t.setViewport(n,r,i,o,s,a)}clear(e,t,n,r=null){const i=this.device,o=this.renderer;let s,a,u,c,l=[];if(e){const e=this.getClearColor();if(!0===this.renderer.alpha){const t=e.a;a={r:e.r*t,g:e.g*t,b:e.b*t,a:t}}else a={r:e.r,g:e.g,b:e.b,a:e.a}}if(null===r){u=o.depth,c=o.stencil;const t=this._getDefaultRenderPassDescriptor();if(e){l=t.colorAttachments;const e=l[0];e.clearValue=a,e.loadOp=hM,e.storeOp=cM}(u||c)&&(s=t.depthStencilAttachment)}else{if(u=r.depth,c=r.stencil,e)for(const e of r.textures){const t=this.get(e),n=t.texture.createView();let r,i;void 0!==t.msaaTexture?(r=t.msaaTexture.createView(),i=n):(r=n,i=void 0),l.push({view:r,resolveTarget:i,clearValue:a,loadOp:hM,storeOp:cM})}if(u||c){s={view:this.get(r.depthTexture).texture.createView()}}}u&&(t?(s.depthLoadOp=hM,s.depthClearValue=o.getClearDepth(),s.depthStoreOp=cM):(s.depthLoadOp=lM,s.depthStoreOp=cM)),c&&(n?(s.stencilLoadOp=hM,s.stencilClearValue=o.getClearStencil(),s.stencilStoreOp=cM):(s.stencilLoadOp=lM,s.stencilStoreOp=cM));const h=i.createCommandEncoder({});h.beginRenderPass({colorAttachments:l,depthStencilAttachment:s}).end(),i.queue.submit([h.finish()])}beginCompute(e){const t=this.get(e),n={};this.initTimestampQuery(e,n),t.cmdEncoderGPU=this.device.createCommandEncoder(),t.passEncoderGPU=t.cmdEncoderGPU.beginComputePass(n)}compute(e,t,n,r){const{passEncoderGPU:i}=this.get(e),o=this.get(r).pipeline;i.setPipeline(o);for(let e=0,t=n.length;e<t;e++){const t=n[e],r=this.get(t);i.setBindGroup(e,r.group)}const s=this.device.limits.maxComputeWorkgroupsPerDimension,a=this.get(t);void 0===a.dispatchSize&&(a.dispatchSize={x:0,y:1,z:1});const{dispatchSize:u}=a;t.dispatchCount>s?(u.x=Math.min(t.dispatchCount,s),u.y=Math.ceil(t.dispatchCount/s)):u.x=t.dispatchCount,i.dispatchWorkgroups(u.x,u.y,u.z)}finishCompute(e){const t=this.get(e);t.passEncoderGPU.end(),this.prepareTimestampBuffer(e,t.cmdEncoderGPU),this.device.queue.submit([t.cmdEncoderGPU.finish()])}async waitForGPU(){await this.device.queue.onSubmittedWorkDone()}draw(e,t){const{object:n,context:r,pipeline:i}=e,o=e.getBindings(),s=this.get(r),a=this.get(i).pipeline,u=s.currentSets,c=s.currentPass,l=e.getDrawParameters();if(null===l)return;u.pipeline!==a&&(c.setPipeline(a),u.pipeline=a);const h=u.bindingGroups;for(let e=0,t=o.length;e<t;e++){const t=o[e],n=this.get(t);h[t.index]!==t.id&&(c.setBindGroup(t.index,n.group),h[t.index]=t.id)}const d=e.getIndex(),f=null!==d;if(!0===f&&u.index!==d){const e=this.get(d).buffer,t=d.array instanceof Uint16Array?gM:vM;c.setIndexBuffer(e,t),u.index=d}const p=e.getVertexBuffers();for(let e=0,t=p.length;e<t;e++){const t=p[e];if(u.attributes[e]!==t){const n=this.get(t).buffer;c.setVertexBuffer(e,n),u.attributes[e]=t}}if(void 0!==s.occlusionQuerySet){const e=s.lastOcclusionObject;e!==n&&(null!==e&&!0===e.occlusionTest&&(c.endOcclusionQuery(),s.occlusionQueryIndex++),!0===n.occlusionTest&&(c.beginOcclusionQuery(s.occlusionQueryIndex),s.occlusionQueryObjects[s.occlusionQueryIndex]=n),s.lastOcclusionObject=n)}if(!0===n.isBatchedMesh){const e=n._multiDrawStarts,t=n._multiDrawCounts,r=n._multiDrawCount,i=n._multiDrawInstances,o=f?d.array.BYTES_PER_ELEMENT:1;for(let n=0;n<r;n++){const r=i?i[n]:1,s=r>1?0:n;c.drawIndexed(t[n],r,e[n]/o,0,s)}}else if(!0===f){const{vertexCount:r,instanceCount:i,firstVertex:o}=l,s=e.getIndirect();if(null!==s){const e=this.get(s).buffer;c.drawIndexedIndirect(e,0)}else c.drawIndexed(r,i,o,0,0);t.update(n,r,i)}else{const{vertexCount:r,instanceCount:i,firstVertex:o}=l,s=e.getIndirect();if(null!==s){const e=this.get(s).buffer;c.drawIndirect(e,0)}else c.draw(r,i,o,0);t.update(n,r,i)}}needsRenderUpdate(e){const t=this.get(e),{object:n,material:r}=e,i=this.utils,o=i.getSampleCountRenderContext(e.context),s=i.getCurrentColorSpace(e.context),a=i.getCurrentColorFormat(e.context),u=i.getCurrentDepthStencilFormat(e.context),c=i.getPrimitiveTopology(n,r);let l=!1;return t.material===r&&t.materialVersion===r.version&&t.transparent===r.transparent&&t.blending===r.blending&&t.premultipliedAlpha===r.premultipliedAlpha&&t.blendSrc===r.blendSrc&&t.blendDst===r.blendDst&&t.blendEquation===r.blendEquation&&t.blendSrcAlpha===r.blendSrcAlpha&&t.blendDstAlpha===r.blendDstAlpha&&t.blendEquationAlpha===r.blendEquationAlpha&&t.colorWrite===r.colorWrite&&t.depthWrite===r.depthWrite&&t.depthTest===r.depthTest&&t.depthFunc===r.depthFunc&&t.stencilWrite===r.stencilWrite&&t.stencilFunc===r.stencilFunc&&t.stencilFail===r.stencilFail&&t.stencilZFail===r.stencilZFail&&t.stencilZPass===r.stencilZPass&&t.stencilFuncMask===r.stencilFuncMask&&t.stencilWriteMask===r.stencilWriteMask&&t.side===r.side&&t.alphaToCoverage===r.alphaToCoverage&&t.sampleCount===o&&t.colorSpace===s&&t.colorFormat===a&&t.depthStencilFormat===u&&t.primitiveTopology===c&&t.clippingContextCacheKey===e.clippingContext.cacheKey||(t.material=r,t.materialVersion=r.version,t.transparent=r.transparent,t.blending=r.blending,t.premultipliedAlpha=r.premultipliedAlpha,t.blendSrc=r.blendSrc,t.blendDst=r.blendDst,t.blendEquation=r.blendEquation,t.blendSrcAlpha=r.blendSrcAlpha,t.blendDstAlpha=r.blendDstAlpha,t.blendEquationAlpha=r.blendEquationAlpha,t.colorWrite=r.colorWrite,t.depthWrite=r.depthWrite,t.depthTest=r.depthTest,t.depthFunc=r.depthFunc,t.stencilWrite=r.stencilWrite,t.stencilFunc=r.stencilFunc,t.stencilFail=r.stencilFail,t.stencilZFail=r.stencilZFail,t.stencilZPass=r.stencilZPass,t.stencilFuncMask=r.stencilFuncMask,t.stencilWriteMask=r.stencilWriteMask,t.side=r.side,t.alphaToCoverage=r.alphaToCoverage,t.sampleCount=o,t.colorSpace=s,t.colorFormat=a,t.depthStencilFormat=u,t.primitiveTopology=c,t.clippingContextCacheKey=e.clippingContext.cacheKey,l=!0),l}getRenderCacheKey(e){const{object:t,material:n}=e,r=this.utils,i=e.context;return[n.transparent,n.blending,n.premultipliedAlpha,n.blendSrc,n.blendDst,n.blendEquation,n.blendSrcAlpha,n.blendDstAlpha,n.blendEquationAlpha,n.colorWrite,n.depthWrite,n.depthTest,n.depthFunc,n.stencilWrite,n.stencilFunc,n.stencilFail,n.stencilZFail,n.stencilZPass,n.stencilFuncMask,n.stencilWriteMask,n.side,r.getSampleCountRenderContext(i),r.getCurrentColorSpace(i),r.getCurrentColorFormat(i),r.getCurrentDepthStencilFormat(i),r.getPrimitiveTopology(t,n),e.getGeometryCacheKey(),e.clippingContext.cacheKey].join()}createSampler(e){this.textureUtils.createSampler(e)}destroySampler(e){this.textureUtils.destroySampler(e)}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}copyTextureToBuffer(e,t,n,r,i,o){return this.textureUtils.copyTextureToBuffer(e,t,n,r,i,o)}initTimestampQuery(e,t){if(!this.trackTimestamp)return;const n=this.get(e);if(!n.timeStampQuerySet){const e=this.device.createQuerySet({type:"timestamp",count:2}),r={querySet:e,beginningOfPassWriteIndex:0,endOfPassWriteIndex:1};Object.assign(t,{timestampWrites:r}),n.timeStampQuerySet=e}}prepareTimestampBuffer(e,t){if(!this.trackTimestamp)return;const n=this.get(e),r=2*BigInt64Array.BYTES_PER_ELEMENT;void 0===n.currentTimestampQueryBuffers&&(n.currentTimestampQueryBuffers={resolveBuffer:this.device.createBuffer({label:"timestamp resolve buffer",size:r,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),resultBuffer:this.device.createBuffer({label:"timestamp result buffer",size:r,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),isMappingPending:!1});const{resolveBuffer:i,resultBuffer:o,isMappingPending:s}=n.currentTimestampQueryBuffers;!0!==s&&(t.resolveQuerySet(n.timeStampQuerySet,0,2,i,0),t.copyBufferToBuffer(i,0,o,0,r))}async resolveTimestampAsync(e,t="render"){if(!this.trackTimestamp)return;const n=this.get(e);if(void 0===n.currentTimestampQueryBuffers)return;const{resultBuffer:r,isMappingPending:i}=n.currentTimestampQueryBuffers;!0!==i&&(n.currentTimestampQueryBuffers.isMappingPending=!0,r.mapAsync(GPUMapMode.READ).then((()=>{const e=new BigUint64Array(r.getMappedRange()),i=Number(e[1]-e[0])/1e6;this.renderer.info.updateTimestamp(t,i),r.unmap(),n.currentTimestampQueryBuffers.isMappingPending=!1})))}createNodeBuilder(e,t){return new $P(e,t)}createProgram(e){this.get(e).module={module:this.device.createShaderModule({code:e.code,label:e.stage}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){this.pipelineUtils.createRenderPipeline(e,t)}createComputePipeline(e,t){this.pipelineUtils.createComputePipeline(e,t)}beginBundle(e){const t=this.get(e);t._currentPass=t.currentPass,t._currentSets=t.currentSets,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,t){const n=this.get(e),r=n.currentPass.finish();this.get(t).bundleGPU=r,n.currentSets=n._currentSets,n.currentPass=n._currentPass}addBundle(e,t){this.get(e).renderBundles.push(this.get(t).bundleGPU)}createBindings(e){this.bindingUtils.createBindings(e)}updateBindings(e){this.bindingUtils.createBindings(e)}updateBinding(e){this.bindingUtils.updateBinding(e)}createIndexAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}getMaxAnisotropy(){return 16}hasFeature(e){return this.device.features.has(e)}copyTextureToTexture(e,t,n=null,r=null,i=0){let o=0,s=0,a=0,u=0,c=0,l=0,h=e.image.width,d=e.image.height;null!==n&&(u=n.x,c=n.y,l=n.z||0,h=n.width,d=n.height),null!==r&&(o=r.x,s=r.y,a=r.z||0);const f=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+t.id}),p=this.get(e).texture,m=this.get(t).texture;f.copyTextureToTexture({texture:p,mipLevel:i,origin:{x:u,y:c,z:l}},{texture:m,mipLevel:i,origin:{x:o,y:s,z:a}},[h,d,1]),this.device.queue.submit([f.finish()])}copyFramebufferToTexture(e,t,n){const r=this.get(t);let i=null;i=t.renderTarget?e.isDepthTexture?this.get(t.depthTexture).texture:this.get(t.textures[0]).texture:e.isDepthTexture?this.textureUtils.getDepthBuffer(t.depth,t.stencil):this.context.getCurrentTexture();const o=this.get(e).texture;if(i.format!==o.format)return void console.error("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",i.format,o.format);let s;if(r.currentPass?(r.currentPass.end(),s=r.encoder):s=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),s.copyTextureToTexture({texture:i,origin:{x:n.x,y:n.y,z:0}},{texture:o},[n.z,n.w]),e.generateMipmaps&&this.textureUtils.generateMipmaps(e),r.currentPass){const{descriptor:e}=r;for(let t=0;t<e.colorAttachments.length;t++)e.colorAttachments[t].loadOp=lM;t.depth&&(e.depthStencilAttachment.depthLoadOp=lM),t.stencil&&(e.depthStencilAttachment.stencilLoadOp=lM),r.currentPass=s.beginRenderPass(e),r.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null}}else this.device.queue.submit([s.finish()])}}class iR extends Xp{constructor(e,t,n,r,i,o){super(e,t,n,r,i,o),this.iesMap=null}copy(e,t){return super.copy(e,t),this.iesMap=e.iesMap,this}}class oR extends PO{constructor(){super(),this.addMaterial(dS,vp),this.addMaterial(NE,mp),this.addMaterial(kE,gp),this.addMaterial(FE,yp),this.addMaterial(rS,rf),this.addMaterial(lS,_p),this.addMaterial(Gw,bp),this.addMaterial(VE,xp),this.addMaterial(Bw,cp),this.addMaterial(jw,wp),this.addMaterial(HE,lp),this.addMaterial(ZE,Jf),this.addMaterial(KE,pp),this.addLight(aC,Qp),this.addLight(cO,tm),this.addLight(fO,rm),this.addLight(pO,Xp),this.addLight(gO,nm),this.addLight(vO,jp),this.addLight(yO,om),this.addLight(mO,iR),this.addToneMapping(xA,1),this.addToneMapping(wA,2),this.addToneMapping(SA,3),this.addToneMapping(TA,4),this.addToneMapping(OA,6),this.addToneMapping(PA,7)}}class sR extends BO{constructor(e={}){let t;e.forceWebGL?t=TP:(t=rR,e.getFallback=()=>(console.warn("THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new TP(e)));super(new t(e),e),this.library=new oR,this.isWebGPURenderer=!0}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Cc}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Cc);const aR={type:"change"},uR={type:"start"},cR={type:"end"},lR=1e-6,hR=-1,dR=0,fR=1,pR=2,mR=3,gR=4,vR=new Xe,yR=new Xe,bR=new wt,_R=new wt,xR=new wt,wR=new xt,SR=new wt,ER=new wt,TR=new wt,MR=new wt;class AR extends ru{constructor(e,t=null){super(e,t),this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:i.ROTATE,MIDDLE:i.DOLLY,RIGHT:i.PAN},this.state=hR,this.keyState=hR,this.target=new wt,this._lastPosition=new wt,this._lastZoom=1,this._touchZoomDistanceStart=0,this._touchZoomDistanceEnd=0,this._lastAngle=0,this._eye=new wt,this._movePrev=new Xe,this._moveCurr=new Xe,this._lastAxis=new wt,this._zoomStart=new Xe,this._zoomEnd=new Xe,this._panStart=new Xe,this._panEnd=new Xe,this._pointers=[],this._pointerPositions={},this._onPointerMove=OR.bind(this),this._onPointerDown=CR.bind(this),this._onPointerUp=PR.bind(this),this._onPointerCancel=RR.bind(this),this._onContextMenu=FR.bind(this),this._onMouseWheel=UR.bind(this),this._onKeyDown=IR.bind(this),this._onKeyUp=NR.bind(this),this._onTouchStart=BR.bind(this),this._onTouchMove=zR.bind(this),this._onTouchEnd=jR.bind(this),this._onMouseDown=kR.bind(this),this._onMouseMove=DR.bind(this),this._onMouseUp=LR.bind(this),this._target0=this.target.clone(),this._position0=this.object.position.clone(),this._up0=this.object.up.clone(),this._zoom0=this.object.zoom,null!==t&&(this.connect(),this.handleResize()),this.update()}connect(){window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}handleResize(){const e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}update(){this._eye.subVectors(this.object.position,this.target),this.noRotate||this._rotateCamera(),this.noZoom||this._zoomCamera(),this.noPan||this._panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this._checkDistances(),this.object.lookAt(this.target),this._lastPosition.distanceToSquared(this.object.position)>lR&&(this.dispatchEvent(aR),this._lastPosition.copy(this.object.position))):this.object.isOrthographicCamera?(this.object.lookAt(this.target),(this._lastPosition.distanceToSquared(this.object.position)>lR||this._lastZoom!==this.object.zoom)&&(this.dispatchEvent(aR),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type.")}reset(){this.state=hR,this.keyState=hR,this.target.copy(this._target0),this.object.position.copy(this._position0),this.object.up.copy(this._up0),this.object.zoom=this._zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(aR),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom}_panCamera(){if(yR.copy(this._panEnd).sub(this._panStart),yR.lengthSq()){if(this.object.isOrthographicCamera){const e=(this.object.right-this.object.left)/this.object.zoom/this.domElement.clientWidth,t=(this.object.top-this.object.bottom)/this.object.zoom/this.domElement.clientWidth;yR.x*=e,yR.y*=t}yR.multiplyScalar(this._eye.length()*this.panSpeed),_R.copy(this._eye).cross(this.object.up).setLength(yR.x),_R.add(bR.copy(this.object.up).setLength(yR.y)),this.object.position.add(_R),this.target.add(_R),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(yR.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}_rotateCamera(){MR.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0);let e=MR.length();e?(this._eye.copy(this.object.position).sub(this.target),SR.copy(this._eye).normalize(),ER.copy(this.object.up).normalize(),TR.crossVectors(ER,SR).normalize(),ER.setLength(this._moveCurr.y-this._movePrev.y),TR.setLength(this._moveCurr.x-this._movePrev.x),MR.copy(ER.add(TR)),xR.crossVectors(MR,this._eye).normalize(),e*=this.rotateSpeed,wR.setFromAxisAngle(xR,e),this._eye.applyQuaternion(wR),this.object.up.applyQuaternion(wR),this._lastAxis.copy(xR),this._lastAngle=e):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),wR.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(wR),this.object.up.applyQuaternion(wR)),this._movePrev.copy(this._moveCurr)}_zoomCamera(){let e;this.state===gR?(e=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=qe.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed,1!==e&&e>0&&(this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=qe.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor)}_getMouseOnScreen(e,t){return vR.set((e-this.screen.left)/this.screen.width,(t-this.screen.top)/this.screen.height),vR}_getMouseOnCircle(e,t){return vR.set((e-.5*this.screen.width-this.screen.left)/(.5*this.screen.width),(this.screen.height+2*(this.screen.top-t))/this.screen.width),vR}_addPointer(e){this._pointers.push(e)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t].pointerId==e.pointerId)return void this._pointers.splice(t,1)}_trackPointer(e){let t=this._pointerPositions[e.pointerId];void 0===t&&(t=new Xe,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0].pointerId?this._pointers[1]:this._pointers[0];return this._pointerPositions[t.pointerId]}_checkDistances(){this.noZoom&&this.noPan||(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}}function CR(e){!1!==this.enabled&&(0===this._pointers.length&&(this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._addPointer(e),"touch"===e.pointerType?this._onTouchStart(e):this._onMouseDown(e))}function OR(e){!1!==this.enabled&&("touch"===e.pointerType?this._onTouchMove(e):this._onMouseMove(e))}function PR(e){!1!==this.enabled&&("touch"===e.pointerType?this._onTouchEnd(e):this._onMouseUp(),this._removePointer(e),0===this._pointers.length&&(this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp)))}function RR(e){this._removePointer(e)}function NR(){!1!==this.enabled&&(this.keyState=hR,window.addEventListener("keydown",this._onKeyDown))}function IR(e){!1!==this.enabled&&(window.removeEventListener("keydown",this._onKeyDown),this.keyState===hR&&(e.code!==this.keys[dR]||this.noRotate?e.code!==this.keys[fR]||this.noZoom?e.code!==this.keys[pR]||this.noPan||(this.keyState=pR):this.keyState=fR:this.keyState=dR))}function kR(e){let t;switch(e.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case i.DOLLY:this.state=fR;break;case i.ROTATE:this.state=dR;break;case i.PAN:this.state=pR;break;default:this.state=hR}const n=this.keyState!==hR?this.keyState:this.state;n!==dR||this.noRotate?n!==fR||this.noZoom?n!==pR||this.noPan||(this._panStart.copy(this._getMouseOnScreen(e.pageX,e.pageY)),this._panEnd.copy(this._panStart)):(this._zoomStart.copy(this._getMouseOnScreen(e.pageX,e.pageY)),this._zoomEnd.copy(this._zoomStart)):(this._moveCurr.copy(this._getMouseOnCircle(e.pageX,e.pageY)),this._movePrev.copy(this._moveCurr)),this.dispatchEvent(uR)}function DR(e){const t=this.keyState!==hR?this.keyState:this.state;t!==dR||this.noRotate?t!==fR||this.noZoom?t!==pR||this.noPan||this._panEnd.copy(this._getMouseOnScreen(e.pageX,e.pageY)):this._zoomEnd.copy(this._getMouseOnScreen(e.pageX,e.pageY)):(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(e.pageX,e.pageY)))}function LR(){this.state=hR,this.dispatchEvent(cR)}function UR(e){if(!1!==this.enabled&&!0!==this.noZoom){switch(e.preventDefault(),e.deltaMode){case 2:this._zoomStart.y-=.025*e.deltaY;break;case 1:this._zoomStart.y-=.01*e.deltaY;break;default:this._zoomStart.y-=25e-5*e.deltaY}this.dispatchEvent(uR),this.dispatchEvent(cR)}}function FR(e){!1!==this.enabled&&e.preventDefault()}function BR(e){if(this._trackPointer(e),1===this._pointers.length)this.state=mR,this._moveCurr.copy(this._getMouseOnCircle(this._pointers[0].pageX,this._pointers[0].pageY)),this._movePrev.copy(this._moveCurr);else{this.state=gR;const e=this._pointers[0].pageX-this._pointers[1].pageX,t=this._pointers[0].pageY-this._pointers[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(e*e+t*t);const n=(this._pointers[0].pageX+this._pointers[1].pageX)/2,r=(this._pointers[0].pageY+this._pointers[1].pageY)/2;this._panStart.copy(this._getMouseOnScreen(n,r)),this._panEnd.copy(this._panStart)}this.dispatchEvent(uR)}function zR(e){if(this._trackPointer(e),1===this._pointers.length)this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(e.pageX,e.pageY));else{const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y;this._touchZoomDistanceEnd=Math.sqrt(n*n+r*r);const i=(e.pageX+t.x)/2,o=(e.pageY+t.y)/2;this._panEnd.copy(this._getMouseOnScreen(i,o))}}function jR(e){switch(this._pointers.length){case 0:this.state=hR;break;case 1:this.state=mR,this._moveCurr.copy(this._getMouseOnCircle(e.pageX,e.pageY)),this._movePrev.copy(this._moveCurr);break;case 2:this.state=gR;for(let t=0;t<this._pointers.length;t++)if(this._pointers[t].pointerId!==e.pointerId){const e=this._pointerPositions[this._pointers[t].pointerId];this._moveCurr.copy(this._getMouseOnCircle(e.x,e.y)),this._movePrev.copy(this._moveCurr);break}}this.dispatchEvent(cR)}const VR={type:"change"},GR={type:"start"},HR={type:"end"},WR=new Kt,qR=new jr,XR=Math.cos(70*qe.DEG2RAD),ZR=new wt,$R=2*Math.PI,YR=-1,KR=0,QR=1,JR=2,eN=3,tN=4,nN=5,rN=6,iN=1e-6;class oN extends ru{constructor(e,t=null){super(e,t),this.state=YR,this.enabled=!0,this.target=new wt,this.cursor=new wt,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:i.ROTATE,MIDDLE:i.DOLLY,RIGHT:i.PAN},this.touches={ONE:o,TWO:a},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new wt,this._lastQuaternion=new xt,this._lastTargetPosition=new wt,this._quat=(new xt).setFromUnitVectors(e.up,new wt(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new nu,this._sphericalDelta=new nu,this._scale=1,this._panOffset=new wt,this._rotateStart=new Xe,this._rotateEnd=new Xe,this._rotateDelta=new Xe,this._panStart=new Xe,this._panEnd=new Xe,this._panDelta=new Xe,this._dollyStart=new Xe,this._dollyEnd=new Xe,this._dollyDelta=new Xe,this._dollyDirection=new wt,this._mouse=new Xe,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=aN.bind(this),this._onPointerDown=sN.bind(this),this._onPointerUp=uN.bind(this),this._onContextMenu=mN.bind(this),this._onMouseWheel=hN.bind(this),this._onKeyDown=dN.bind(this),this._onTouchStart=fN.bind(this),this._onTouchMove=pN.bind(this),this._onMouseDown=cN.bind(this),this._onMouseMove=lN.bind(this),this._interceptControlDown=gN.bind(this),this._interceptControlUp=vN.bind(this),null!==this.domElement&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1});this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents();this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){null!==this._domElementKeyEvents&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(VR),this.update(),this.state=YR}update(e=null){const t=this.object.position;ZR.copy(t).sub(this.target),ZR.applyQuaternion(this._quat),this._spherical.setFromVector3(ZR),this.autoRotate&&this.state===YR&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(n)&&isFinite(r)&&(n<-Math.PI?n+=$R:n>Math.PI&&(n-=$R),r<-Math.PI?r+=$R:r>Math.PI&&(r-=$R),this._spherical.theta=n<=r?Math.max(n,Math.min(r,this._spherical.theta)):this._spherical.theta>(n+r)/2?Math.max(n,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),!0===this.enableDamping?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let i=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const e=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),i=e!=this._spherical.radius}if(ZR.setFromSpherical(this._spherical),ZR.applyQuaternion(this._quatInverse),t.copy(this.target).add(ZR),this.object.lookAt(this.target),!0===this.enableDamping?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let e=null;if(this.object.isPerspectiveCamera){const t=ZR.length();e=this._clampDistance(t*this._scale);const n=t-e;this.object.position.addScaledVector(this._dollyDirection,n),this.object.updateMatrixWorld(),i=!!n}else if(this.object.isOrthographicCamera){const t=new wt(this._mouse.x,this._mouse.y,0);t.unproject(this.object);const n=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),i=n!==this.object.zoom;const r=new wt(this._mouse.x,this._mouse.y,0);r.unproject(this.object),this.object.position.sub(r).add(t),this.object.updateMatrixWorld(),e=ZR.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;null!==e&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(e).add(this.object.position):(WR.origin.copy(this.object.position),WR.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(WR.direction))<XR?this.object.lookAt(this.target):(qR.setFromNormalAndCoplanarPoint(this.object.up,this.target),WR.intersectPlane(qR,this.target))))}else if(this.object.isOrthographicCamera){const e=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),e!==this.object.zoom&&(this.object.updateProjectionMatrix(),i=!0)}return this._scale=1,this._performCursorZoom=!1,!!(i||this._lastPosition.distanceToSquared(this.object.position)>iN||8*(1-this._lastQuaternion.dot(this.object.quaternion))>iN||this._lastTargetPosition.distanceToSquared(this.target)>iN)&&(this.dispatchEvent(VR),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0)}_getAutoRotationAngle(e){return null!==e?$R/60*this.autoRotateSpeed*e:$R/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(.01*e);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){ZR.setFromMatrixColumn(t,0),ZR.multiplyScalar(-e),this._panOffset.add(ZR)}_panUp(e,t){!0===this.screenSpacePanning?ZR.setFromMatrixColumn(t,1):(ZR.setFromMatrixColumn(t,0),ZR.crossVectors(this.object.up,ZR)),ZR.multiplyScalar(e),this._panOffset.add(ZR)}_pan(e,t){const n=this.domElement;if(this.object.isPerspectiveCamera){const r=this.object.position;ZR.copy(r).sub(this.target);let i=ZR.length();i*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*i/n.clientHeight,this.object.matrix),this._panUp(2*t*i/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),r=e-n.left,i=t-n.top,o=n.width,s=n.height;this._mouse.x=r/o*2-1,this._mouse.y=-i/s*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft($R*this._rotateDelta.x/t.clientHeight),this._rotateUp($R*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp($R*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(-$R*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft($R*this.rotateSpeed/this.domElement.clientHeight):this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(-$R*this.rotateSpeed/this.domElement.clientHeight):this._pan(-this.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(1===this._pointers.length)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateStart.set(n,r)}}_handleTouchStartPan(e){if(1===this._pointers.length)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panStart.set(n,r)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,i=Math.sqrt(n*n+r*r);this._dollyStart.set(0,i)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(1==this._pointers.length)this._rotateEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateEnd.set(n,r)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft($R*this._rotateDelta.x/t.clientHeight),this._rotateUp($R*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(1===this._pointers.length)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panEnd.set(n,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,i=Math.sqrt(n*n+r*r);this._dollyEnd.set(0,i),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const o=.5*(e.pageX+t.x),s=.5*(e.pageY+t.y);this._updateZoomParameters(o,s)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return void this._pointers.splice(t,1)}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];void 0===t&&(t=new Xe,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}function sN(e){!1!==this.enabled&&(0===this._pointers.length&&(this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._isTrackingPointer(e)||(this._addPointer(e),"touch"===e.pointerType?this._onTouchStart(e):this._onMouseDown(e)))}function aN(e){!1!==this.enabled&&("touch"===e.pointerType?this._onTouchMove(e):this._onMouseMove(e))}function uN(e){switch(this._removePointer(e),this._pointers.length){case 0:this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(HR),this.state=YR;break;case 1:const t=this._pointers[0],n=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:n.x,pageY:n.y})}}function cN(e){let t;switch(e.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case i.DOLLY:if(!1===this.enableZoom)return;this._handleMouseDownDolly(e),this.state=QR;break;case i.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===this.enablePan)return;this._handleMouseDownPan(e),this.state=JR}else{if(!1===this.enableRotate)return;this._handleMouseDownRotate(e),this.state=KR}break;case i.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===this.enableRotate)return;this._handleMouseDownRotate(e),this.state=KR}else{if(!1===this.enablePan)return;this._handleMouseDownPan(e),this.state=JR}break;default:this.state=YR}this.state!==YR&&this.dispatchEvent(GR)}function lN(e){switch(this.state){case KR:if(!1===this.enableRotate)return;this._handleMouseMoveRotate(e);break;case QR:if(!1===this.enableZoom)return;this._handleMouseMoveDolly(e);break;case JR:if(!1===this.enablePan)return;this._handleMouseMovePan(e)}}function hN(e){!1!==this.enabled&&!1!==this.enableZoom&&this.state===YR&&(e.preventDefault(),this.dispatchEvent(GR),this._handleMouseWheel(this._customWheelEvent(e)),this.dispatchEvent(HR))}function dN(e){!1!==this.enabled&&!1!==this.enablePan&&this._handleKeyDown(e)}function fN(e){switch(this._trackPointer(e),this._pointers.length){case 1:switch(this.touches.ONE){case o:if(!1===this.enableRotate)return;this._handleTouchStartRotate(e),this.state=eN;break;case s:if(!1===this.enablePan)return;this._handleTouchStartPan(e),this.state=tN;break;default:this.state=YR}break;case 2:switch(this.touches.TWO){case a:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchStartDollyPan(e),this.state=nN;break;case u:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchStartDollyRotate(e),this.state=rN;break;default:this.state=YR}break;default:this.state=YR}this.state!==YR&&this.dispatchEvent(GR)}function pN(e){switch(this._trackPointer(e),this.state){case eN:if(!1===this.enableRotate)return;this._handleTouchMoveRotate(e),this.update();break;case tN:if(!1===this.enablePan)return;this._handleTouchMovePan(e),this.update();break;case nN:if(!1===this.enableZoom&&!1===this.enablePan)return;this._handleTouchMoveDollyPan(e),this.update();break;case rN:if(!1===this.enableZoom&&!1===this.enableRotate)return;this._handleTouchMoveDollyRotate(e),this.update();break;default:this.state=YR}}function mN(e){!1!==this.enabled&&e.preventDefault()}function gN(e){if("Control"===e.key){this._controlActive=!0;this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0})}}function vN(e){if("Control"===e.key){this._controlActive=!1;this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0})}}const yN={type:"change"},bN=1e-6,_N=new xt;class xN extends ru{constructor(e,t=null){super(e,t),this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1,this._moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this._moveVector=new wt(0,0,0),this._rotationVector=new wt(0,0,0),this._lastQuaternion=new xt,this._lastPosition=new wt,this._status=0,this._onKeyDown=wN.bind(this),this._onKeyUp=SN.bind(this),this._onPointerMove=TN.bind(this),this._onPointerDown=EN.bind(this),this._onPointerUp=MN.bind(this),this._onPointerCancel=AN.bind(this),this._onContextMenu=CN.bind(this),null!==t&&this.connect()}connect(){window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu)}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu)}dispose(){this.disconnect()}update(e){if(!1===this.enabled)return;const t=this.object,n=e*this.movementSpeed,r=e*this.rollSpeed;t.translateX(this._moveVector.x*n),t.translateY(this._moveVector.y*n),t.translateZ(this._moveVector.z*n),_N.set(this._rotationVector.x*r,this._rotationVector.y*r,this._rotationVector.z*r,1).normalize(),t.quaternion.multiply(_N),(this._lastPosition.distanceToSquared(t.position)>bN||8*(1-this._lastQuaternion.dot(t.quaternion))>bN)&&(this.dispatchEvent(yN),this._lastQuaternion.copy(t.quaternion),this._lastPosition.copy(t.position))}_updateMovementVector(){const e=this._moveState.forward||this.autoForward&&!this._moveState.back?1:0;this._moveVector.x=-this._moveState.left+this._moveState.right,this._moveVector.y=-this._moveState.down+this._moveState.up,this._moveVector.z=-e+this._moveState.back}_updateRotationVector(){this._rotationVector.x=-this._moveState.pitchDown+this._moveState.pitchUp,this._rotationVector.y=-this._moveState.yawRight+this._moveState.yawLeft,this._rotationVector.z=-this._moveState.rollRight+this._moveState.rollLeft}_getContainerDimensions(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}}}function wN(e){if(!e.altKey&&!1!==this.enabled){switch(e.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this._moveState.forward=1;break;case"KeyS":this._moveState.back=1;break;case"KeyA":this._moveState.left=1;break;case"KeyD":this._moveState.right=1;break;case"KeyR":this._moveState.up=1;break;case"KeyF":this._moveState.down=1;break;case"ArrowUp":this._moveState.pitchUp=1;break;case"ArrowDown":this._moveState.pitchDown=1;break;case"ArrowLeft":this._moveState.yawLeft=1;break;case"ArrowRight":this._moveState.yawRight=1;break;case"KeyQ":this._moveState.rollLeft=1;break;case"KeyE":this._moveState.rollRight=1}this._updateMovementVector(),this._updateRotationVector()}}function SN(e){if(!1!==this.enabled){switch(e.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this._moveState.forward=0;break;case"KeyS":this._moveState.back=0;break;case"KeyA":this._moveState.left=0;break;case"KeyD":this._moveState.right=0;break;case"KeyR":this._moveState.up=0;break;case"KeyF":this._moveState.down=0;break;case"ArrowUp":this._moveState.pitchUp=0;break;case"ArrowDown":this._moveState.pitchDown=0;break;case"ArrowLeft":this._moveState.yawLeft=0;break;case"ArrowRight":this._moveState.yawRight=0;break;case"KeyQ":this._moveState.rollLeft=0;break;case"KeyE":this._moveState.rollRight=0}this._updateMovementVector(),this._updateRotationVector()}}function EN(e){if(!1!==this.enabled)if(this.dragToLook)this._status++;else{switch(e.button){case 0:this._moveState.forward=1;break;case 2:this._moveState.back=1}this._updateMovementVector()}}function TN(e){if(!1!==this.enabled&&(!this.dragToLook||this._status>0)){const t=this._getContainerDimensions(),n=t.size[0]/2,r=t.size[1]/2;this._moveState.yawLeft=-(e.pageX-t.offset[0]-n)/n,this._moveState.pitchDown=(e.pageY-t.offset[1]-r)/r,this._updateRotationVector()}}function MN(e){if(!1!==this.enabled){if(this.dragToLook)this._status--,this._moveState.yawLeft=this._moveState.pitchDown=0;else{switch(e.button){case 0:this._moveState.forward=0;break;case 2:this._moveState.back=0}this._updateMovementVector()}this._updateRotationVector()}}function AN(){!1!==this.enabled&&(this.dragToLook?(this._status=0,this._moveState.yawLeft=this._moveState.pitchDown=0):(this._moveState.forward=0,this._moveState.back=0,this._updateMovementVector()),this._updateRotationVector())}function CN(e){!1!==this.enabled&&e.preventDefault()}const ON={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\n\t\t}"};class PN{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const RN=new si(-1,1,1,-1,0,1);const NN=new class extends cr{constructor(){super(),this.setAttribute("position",new tr([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new tr([0,2,0,0,2,0],2))}};class IN{constructor(e){this._mesh=new xr(NN,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,RN)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class kN extends PN{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof Cr?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Ar.clone(e.uniforms),this.material=new Cr({name:void 0!==e.name?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new IN(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class DN extends PN{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){const r=e.getContext(),i=e.state;let o,s;i.buffers.color.setMask(!1),i.buffers.depth.setMask(!1),i.buffers.color.setLocked(!0),i.buffers.depth.setLocked(!0),this.inverse?(o=0,s=1):(o=1,s=0),i.buffers.stencil.setTest(!0),i.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),i.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),i.buffers.stencil.setClear(s),i.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),i.buffers.color.setLocked(!1),i.buffers.depth.setLocked(!1),i.buffers.color.setMask(!0),i.buffers.depth.setMask(!0),i.buffers.stencil.setLocked(!1),i.buffers.stencil.setFunc(r.EQUAL,1,4294967295),i.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),i.buffers.stencil.setLocked(!0)}}class LN extends PN{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class UN{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),void 0===t){const n=e.getSize(new Xe);this._width=n.width,this._height=n.height,(t=new yt(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:P})).texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new kN(ON),this.copyPass.material.blending=0,this.clock=new Ga}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let n=!1;for(let t=0,r=this.passes.length;t<r;t++){const r=this.passes[t];if(!1!==r.enabled){if(r.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(t),r.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),r.needsSwap){if(n){const t=this.renderer.getContext(),n=this.renderer.state.buffers.stencil;n.setFunc(t.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),n.setFunc(t.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==DN&&(r instanceof DN?n=!0:r instanceof LN&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new Xe);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(let e=0;e<this.passes.length;e++)this.passes[e].setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class FN extends PN{constructor(e,t,n=null,r=null,i=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=i,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Wn}render(e,t,n){const r=e.autoClear;let i,o;e.autoClear=!1,null!==this.overrideMaterial&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),null!==this.clearColor&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),null!==this.clearAlpha&&(i=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),1==this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),!0===this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),null!==this.clearColor&&e.setClearColor(this._oldClearColor),null!==this.clearAlpha&&e.setClearAlpha(i),null!==this.overrideMaterial&&(this.scene.overrideMaterial=o),e.autoClear=r}}var BN=n(2053),zN=n(46468),jN=n(85716);var VN=n(23605);var GN=function(e){function t(t){var n;return n=e.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+t+" for more information.")||this,(0,zN.Z)(n)}return function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,(0,jN.Z)(e,t)}(t,e),t}((0,VN.Z)(Error));function HN(e,t){return e.substr(-t.length)===t}var WN=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/;function qN(e){return"string"!=typeof e?e:e.match(WN)?parseFloat(e):e}var XN=function(e){return function(t,n){void 0===n&&(n="16px");var r=t,i=n;if("string"==typeof t){if(!HN(t,"px"))throw new GN(69,e,t);r=qN(t)}if("string"==typeof n){if(!HN(n,"px"))throw new GN(70,e,n);i=qN(n)}if("string"==typeof r)throw new GN(71,t,e);if("string"==typeof i)throw new GN(72,n,e);return""+r/i+e}};XN("em");XN("rem");function ZN(e){return Math.round(255*e)}function $N(e,t,n){return ZN(e)+","+ZN(t)+","+ZN(n)}function YN(e,t,n,r){if(void 0===r&&(r=$N),0===t)return r(n,n,n);var i=(e%360+360)%360/60,o=(1-Math.abs(2*n-1))*t,s=o*(1-Math.abs(i%2-1)),a=0,u=0,c=0;i>=0&&i<1?(a=o,u=s):i>=1&&i<2?(a=s,u=o):i>=2&&i<3?(u=o,c=s):i>=3&&i<4?(u=s,c=o):i>=4&&i<5?(a=s,c=o):i>=5&&i<6&&(a=o,c=s);var l=n-o/2;return r(a+l,u+l,c+l)}var KN={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};var QN=/^#[a-fA-F0-9]{6}$/,JN=/^#[a-fA-F0-9]{8}$/,eI=/^#[a-fA-F0-9]{3}$/,tI=/^#[a-fA-F0-9]{4}$/,nI=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,rI=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,iI=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,oI=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function sI(e){if("string"!=typeof e)throw new GN(3);var t=function(e){if("string"!=typeof e)return e;var t=e.toLowerCase();return KN[t]?"#"+KN[t]:e}(e);if(t.match(QN))return{red:parseInt(""+t[1]+t[2],16),green:parseInt(""+t[3]+t[4],16),blue:parseInt(""+t[5]+t[6],16)};if(t.match(JN)){var n=parseFloat((parseInt(""+t[7]+t[8],16)/255).toFixed(2));return{red:parseInt(""+t[1]+t[2],16),green:parseInt(""+t[3]+t[4],16),blue:parseInt(""+t[5]+t[6],16),alpha:n}}if(t.match(eI))return{red:parseInt(""+t[1]+t[1],16),green:parseInt(""+t[2]+t[2],16),blue:parseInt(""+t[3]+t[3],16)};if(t.match(tI)){var r=parseFloat((parseInt(""+t[4]+t[4],16)/255).toFixed(2));return{red:parseInt(""+t[1]+t[1],16),green:parseInt(""+t[2]+t[2],16),blue:parseInt(""+t[3]+t[3],16),alpha:r}}var i=nI.exec(t);if(i)return{red:parseInt(""+i[1],10),green:parseInt(""+i[2],10),blue:parseInt(""+i[3],10)};var o=rI.exec(t.substring(0,50));if(o)return{red:parseInt(""+o[1],10),green:parseInt(""+o[2],10),blue:parseInt(""+o[3],10),alpha:parseFloat(""+o[4])>1?parseFloat(""+o[4])/100:parseFloat(""+o[4])};var s=iI.exec(t);if(s){var a="rgb("+YN(parseInt(""+s[1],10),parseInt(""+s[2],10)/100,parseInt(""+s[3],10)/100)+")",u=nI.exec(a);if(!u)throw new GN(4,t,a);return{red:parseInt(""+u[1],10),green:parseInt(""+u[2],10),blue:parseInt(""+u[3],10)}}var c=oI.exec(t.substring(0,50));if(c){var l="rgb("+YN(parseInt(""+c[1],10),parseInt(""+c[2],10)/100,parseInt(""+c[3],10)/100)+")",h=nI.exec(l);if(!h)throw new GN(4,t,l);return{red:parseInt(""+h[1],10),green:parseInt(""+h[2],10),blue:parseInt(""+h[3],10),alpha:parseFloat(""+c[4])>1?parseFloat(""+c[4])/100:parseFloat(""+c[4])}}throw new GN(5)}function aI(e){return function(e){var t,n=e.red/255,r=e.green/255,i=e.blue/255,o=Math.max(n,r,i),s=Math.min(n,r,i),a=(o+s)/2;if(o===s)return void 0!==e.alpha?{hue:0,saturation:0,lightness:a,alpha:e.alpha}:{hue:0,saturation:0,lightness:a};var u=o-s,c=a>.5?u/(2-o-s):u/(o+s);switch(o){case n:t=(r-i)/u+(r<i?6:0);break;case r:t=(i-n)/u+2;break;default:t=(n-r)/u+4}return t*=60,void 0!==e.alpha?{hue:t,saturation:c,lightness:a,alpha:e.alpha}:{hue:t,saturation:c,lightness:a}}(sI(e))}var uI=function(e){return 7===e.length&&e[1]===e[2]&&e[3]===e[4]&&e[5]===e[6]?"#"+e[1]+e[3]+e[5]:e};function cI(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function lI(e){return cI(Math.round(255*e))}function hI(e,t,n){return uI("#"+lI(e)+lI(t)+lI(n))}function dI(e,t,n){return YN(e,t,n,hI)}function fI(e,t,n){if("number"==typeof e&&"number"==typeof t&&"number"==typeof n)return dI(e,t,n);if("object"==typeof e&&void 0===t&&void 0===n)return dI(e.hue,e.saturation,e.lightness);throw new GN(1)}function pI(e,t,n,r){if("number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r)return r>=1?dI(e,t,n):"rgba("+YN(e,t,n)+","+r+")";if("object"==typeof e&&void 0===t&&void 0===n&&void 0===r)return e.alpha>=1?dI(e.hue,e.saturation,e.lightness):"rgba("+YN(e.hue,e.saturation,e.lightness)+","+e.alpha+")";throw new GN(2)}function mI(e,t,n){if("number"==typeof e&&"number"==typeof t&&"number"==typeof n)return uI("#"+cI(e)+cI(t)+cI(n));if("object"==typeof e&&void 0===t&&void 0===n)return uI("#"+cI(e.red)+cI(e.green)+cI(e.blue));throw new GN(6)}function gI(e,t,n,r){if("string"==typeof e&&"number"==typeof t){var i=sI(e);return"rgba("+i.red+","+i.green+","+i.blue+","+t+")"}if("number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r)return r>=1?mI(e,t,n):"rgba("+e+","+t+","+n+","+r+")";if("object"==typeof e&&void 0===t&&void 0===n&&void 0===r)return e.alpha>=1?mI(e.red,e.green,e.blue):"rgba("+e.red+","+e.green+","+e.blue+","+e.alpha+")";throw new GN(7)}function vI(e){if("object"!=typeof e)throw new GN(8);if(function(e){return"number"==typeof e.red&&"number"==typeof e.green&&"number"==typeof e.blue&&"number"==typeof e.alpha}(e))return gI(e);if(function(e){return"number"==typeof e.red&&"number"==typeof e.green&&"number"==typeof e.blue&&("number"!=typeof e.alpha||void 0===e.alpha)}(e))return mI(e);if(function(e){return"number"==typeof e.hue&&"number"==typeof e.saturation&&"number"==typeof e.lightness&&"number"==typeof e.alpha}(e))return pI(e);if(function(e){return"number"==typeof e.hue&&"number"==typeof e.saturation&&"number"==typeof e.lightness&&("number"!=typeof e.alpha||void 0===e.alpha)}(e))return fI(e);throw new GN(8)}function yI(e,t,n){return function(){var r=n.concat(Array.prototype.slice.call(arguments));return r.length>=t?e.apply(this,r):yI(e,t,r)}}function bI(e){return yI(e,e.length,[])}bI((function(e,t){if("transparent"===t)return t;var n=aI(t);return vI((0,BN.Z)({},n,{hue:n.hue+parseFloat(e)}))}));function _I(e,t,n){return Math.max(e,Math.min(t,n))}bI((function(e,t){if("transparent"===t)return t;var n=aI(t);return vI((0,BN.Z)({},n,{lightness:_I(0,1,n.lightness-parseFloat(e))}))}));bI((function(e,t){if("transparent"===t)return t;var n=aI(t);return vI((0,BN.Z)({},n,{saturation:_I(0,1,n.saturation-parseFloat(e))}))}));bI((function(e,t){if("transparent"===t)return t;var n=aI(t);return vI((0,BN.Z)({},n,{lightness:_I(0,1,n.lightness+parseFloat(e))}))}));var xI=bI((function(e,t,n){if("transparent"===t)return n;if("transparent"===n)return t;if(0===e)return n;var r=sI(t),i=(0,BN.Z)({},r,{alpha:"number"==typeof r.alpha?r.alpha:1}),o=sI(n),s=(0,BN.Z)({},o,{alpha:"number"==typeof o.alpha?o.alpha:1}),a=i.alpha-s.alpha,u=2*parseFloat(e)-1,c=((u*a==-1?u:u+a)/(1+u*a)+1)/2,l=1-c;return gI({red:Math.floor(i.red*c+s.red*l),green:Math.floor(i.green*c+s.green*l),blue:Math.floor(i.blue*c+s.blue*l),alpha:i.alpha*parseFloat(e)+s.alpha*(1-parseFloat(e))})})),wI=xI;var SI=bI((function(e,t){if("transparent"===t)return t;var n=sI(t),r="number"==typeof n.alpha?n.alpha:1;return gI((0,BN.Z)({},n,{alpha:_I(0,1,(100*r+100*parseFloat(e))/100)}))})),EI=SI;bI((function(e,t){if("transparent"===t)return t;var n=aI(t);return vI((0,BN.Z)({},n,{saturation:_I(0,1,n.saturation+parseFloat(e))}))}));bI((function(e,t){return"transparent"===t?t:vI((0,BN.Z)({},aI(t),{hue:parseFloat(e)}))}));bI((function(e,t){return"transparent"===t?t:vI((0,BN.Z)({},aI(t),{lightness:parseFloat(e)}))}));bI((function(e,t){return"transparent"===t?t:vI((0,BN.Z)({},aI(t),{saturation:parseFloat(e)}))}));bI((function(e,t){return"transparent"===t?t:wI(parseFloat(e),"rgb(0, 0, 0)",t)}));bI((function(e,t){return"transparent"===t?t:wI(parseFloat(e),"rgb(255, 255, 255)",t)}));bI((function(e,t){if("transparent"===t)return t;var n=sI(t),r="number"==typeof n.alpha?n.alpha:1;return gI((0,BN.Z)({},n,{alpha:_I(0,1,+(100*r-100*parseFloat(e)).toFixed(2)/100)}))}));var TI=n(83109);function MI(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function AI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function CI(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,s,a=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t);else for(;!(u=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(e,t)||PI(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function OI(e){return function(e){if(Array.isArray(e))return MI(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||PI(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PI(e,t){if(e){if("string"==typeof e)return MI(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?MI(e,t):void 0}}!function(e,t){void 0===t&&(t={});var n=t.insertAt;if("undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(".scene-nav-info {\n  bottom: 5px;\n  width: 100%;\n  text-align: center;\n  color: slategrey;\n  opacity: 0.7;\n  font-size: 10px;\n}\n\n.scene-tooltip {\n  top: 0;\n  color: lavender;\n  font-size: 15px;\n}\n\n.scene-nav-info, .scene-tooltip {\n  position: absolute;\n  font-family: sans-serif;\n  pointer-events: none;\n  user-select: none;\n}\n\n.scene-container canvas:focus {\n  outline: none;\n}");var RI=window.THREE?window.THREE:{WebGLRenderer:class{constructor(e={}){const{canvas:t=Qe(),context:n=null,depth:i=!0,stencil:o=!1,alpha:s=!1,antialias:a=!1,premultipliedAlpha:u=!0,preserveDrawingBuffer:c=!1,powerPreference:l="default",failIfMajorPerformanceCaveat:h=!1,reverseDepthBuffer:d=!1}=e;let f;if(this.isWebGLRenderer=!0,null!==n){if("undefined"!=typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");f=n.getContextAttributes().alpha}else f=s;const p=new Uint32Array(4),m=new Int32Array(4);let g=null,v=null;const y=[],b=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Me,this.toneMapping=0,this.toneMappingExposure=1;const _=this;let x=!1,E=0,T=0,A=null,O=-1,k=null;const D=new gt,L=new gt;let U=null;const F=new Wn(0);let V=0,G=t.width,H=t.height,W=1,q=null,X=null;const Z=new gt(0,0,G,H),$=new gt(0,0,G,H);let Y=!1;const K=new Hr;let Q=!1,J=!1;const ee=new Qt,te=new Qt,ne=new wt,re=new gt,ie={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let oe=!1;function se(){return null===A?W:1}let ae,ue,ce,le,he,de,fe,pe,me,ge,ve,ye,be,_e,xe,we,Se,Ee,Te,Ce,Oe,Pe,Re,Ne,Ie=n;function ke(e,n){return t.getContext(e,n)}try{const e={alpha:!0,depth:i,stencil:o,antialias:a,premultipliedAlpha:u,preserveDrawingBuffer:c,powerPreference:l,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${r}`),t.addEventListener("webglcontextlost",Ue,!1),t.addEventListener("webglcontextrestored",Fe,!1),t.addEventListener("webglcontextcreationerror",Be,!1),null===Ie){const t="webgl2";if(Ie=ke(t,e),null===Ie)throw ke(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function De(){ae=new Ti(Ie),ae.init(),Pe=new Ms(Ie,ae),ue=new ri(Ie,ae,e,Pe),ce=new Ss(Ie,ae),ue.reverseDepthBuffer&&d&&ce.buffers.depth.setReversed(!0),le=new Ci(Ie),he=new us,de=new Ts(Ie,ae,ce,he,ue,Pe,le),fe=new oi(_),pe=new Ei(_),me=new qr(Ie),Re=new ti(Ie,me),ge=new Mi(Ie,me,le,Re),ve=new Pi(Ie,ge,me,le),Te=new Oi(Ie,ue,de),we=new ii(he),ye=new as(_,fe,pe,ae,ue,Re,we),be=new Ds(_,he),_e=new ds,xe=new ys(ae),Ee=new ei(_,fe,pe,ce,ve,f,u),Se=new xs(_,ve,ue),Ne=new Ls(Ie,le,ue,ce),Ce=new ni(Ie,ae,le),Oe=new Ai(Ie,ae,le),le.programs=ye.programs,_.capabilities=ue,_.extensions=ae,_.properties=he,_.renderLists=_e,_.shadowMap=Se,_.state=ce,_.info=le}De();const Le=new Ns(_,Ie);function Ue(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),x=!0}function Fe(){console.log("THREE.WebGLRenderer: Context Restored."),x=!1;const e=le.autoReset,t=Se.enabled,n=Se.autoUpdate,r=Se.needsUpdate,i=Se.type;De(),le.autoReset=e,Se.enabled=t,Se.autoUpdate=n,Se.needsUpdate=r,Se.type=i}function Be(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function ze(e){const t=e.target;t.removeEventListener("dispose",ze),function(e){(function(e){const t=he.get(e).programs;void 0!==t&&(t.forEach((function(e){ye.releaseProgram(e)})),e.isShaderMaterial&&ye.releaseShaderCache(e))})(e),he.remove(e)}(t)}function je(e,t,n){!0===e.transparent&&2===e.side&&!1===e.forceSinglePass?(e.side=1,e.needsUpdate=!0,Ke(e,t,n),e.side=0,e.needsUpdate=!0,Ke(e,t,n),e.side=2):Ke(e,t,n)}this.xr=Le,this.getContext=function(){return Ie},this.getContextAttributes=function(){return Ie.getContextAttributes()},this.forceContextLoss=function(){const e=ae.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=ae.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return W},this.setPixelRatio=function(e){void 0!==e&&(W=e,this.setSize(G,H,!1))},this.getSize=function(e){return e.set(G,H)},this.setSize=function(e,n,r=!0){Le.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(G=e,H=n,t.width=Math.floor(e*W),t.height=Math.floor(n*W),!0===r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(G*W,H*W).floor()},this.setDrawingBufferSize=function(e,n,r){G=e,H=n,W=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(D)},this.getViewport=function(e){return e.copy(Z)},this.setViewport=function(e,t,n,r){e.isVector4?Z.set(e.x,e.y,e.z,e.w):Z.set(e,t,n,r),ce.viewport(D.copy(Z).multiplyScalar(W).round())},this.getScissor=function(e){return e.copy($)},this.setScissor=function(e,t,n,r){e.isVector4?$.set(e.x,e.y,e.z,e.w):$.set(e,t,n,r),ce.scissor(L.copy($).multiplyScalar(W).round())},this.getScissorTest=function(){return Y},this.setScissorTest=function(e){ce.setScissorTest(Y=e)},this.setOpaqueSort=function(e){q=e},this.setTransparentSort=function(e){X=e},this.getClearColor=function(e){return e.copy(Ee.getClearColor())},this.setClearColor=function(){Ee.setClearColor.apply(Ee,arguments)},this.getClearAlpha=function(){return Ee.getClearAlpha()},this.setClearAlpha=function(){Ee.setClearAlpha.apply(Ee,arguments)},this.clear=function(e=!0,t=!0,n=!0){let r=0;if(e){let e=!1;if(null!==A){const t=A.texture.format;e=t===j||t===z||t===B}if(e){const e=A.texture.type,t=e===S||e===C||e===M||e===I||e===R||e===N,n=Ee.getClearColor(),r=Ee.getClearAlpha(),i=n.r,o=n.g,s=n.b;t?(p[0]=i,p[1]=o,p[2]=s,p[3]=r,Ie.clearBufferuiv(Ie.COLOR,0,p)):(m[0]=i,m[1]=o,m[2]=s,m[3]=r,Ie.clearBufferiv(Ie.COLOR,0,m))}else r|=Ie.COLOR_BUFFER_BIT}t&&(r|=Ie.DEPTH_BUFFER_BIT),n&&(r|=Ie.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Ie.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ue,!1),t.removeEventListener("webglcontextrestored",Fe,!1),t.removeEventListener("webglcontextcreationerror",Be,!1),_e.dispose(),xe.dispose(),he.dispose(),fe.dispose(),pe.dispose(),ve.dispose(),Re.dispose(),Ne.dispose(),ye.dispose(),Le.dispose(),Le.removeEventListener("sessionstart",Ge),Le.removeEventListener("sessionend",He),We.stop()},this.renderBufferDirect=function(e,t,n,r,i,o){null===t&&(t=ie);const s=i.isMesh&&i.matrixWorld.determinant()<0,a=function(e,t,n,r,i){!0!==t.isScene&&(t=ie);de.resetTextureUnits();const o=t.fog,s=r.isMeshStandardMaterial?t.environment:null,a=null===A?_.outputColorSpace:!0===A.isXRRenderTarget?A.texture.colorSpace:Ae,u=(r.isMeshStandardMaterial?pe:fe).get(r.envMap||s),c=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,l=!!n.attributes.tangent&&(!!r.normalMap||r.anisotropy>0),h=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,f=!!n.morphAttributes.color;let p=0;r.toneMapped&&(null!==A&&!0!==A.isXRRenderTarget||(p=_.toneMapping));const m=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,g=void 0!==m?m.length:0,y=he.get(r),b=v.state.lights;if(!0===Q&&(!0===J||e!==k)){const t=e===k&&r.id===O;we.setState(r,e,t)}let x=!1;r.version===y.__version?y.needsLights&&y.lightsStateVersion!==b.state.version||y.outputColorSpace!==a||i.isBatchedMesh&&!1===y.batching?x=!0:i.isBatchedMesh||!0!==y.batching?i.isBatchedMesh&&!0===y.batchingColor&&null===i.colorTexture||i.isBatchedMesh&&!1===y.batchingColor&&null!==i.colorTexture||i.isInstancedMesh&&!1===y.instancing?x=!0:i.isInstancedMesh||!0!==y.instancing?i.isSkinnedMesh&&!1===y.skinning?x=!0:i.isSkinnedMesh||!0!==y.skinning?i.isInstancedMesh&&!0===y.instancingColor&&null===i.instanceColor||i.isInstancedMesh&&!1===y.instancingColor&&null!==i.instanceColor||i.isInstancedMesh&&!0===y.instancingMorph&&null===i.morphTexture||i.isInstancedMesh&&!1===y.instancingMorph&&null!==i.morphTexture||y.envMap!==u||!0===r.fog&&y.fog!==o?x=!0:void 0===y.numClippingPlanes||y.numClippingPlanes===we.numPlanes&&y.numIntersection===we.numIntersection?(y.vertexAlphas!==c||y.vertexTangents!==l||y.morphTargets!==h||y.morphNormals!==d||y.morphColors!==f||y.toneMapping!==p||y.morphTargetsCount!==g)&&(x=!0):x=!0:x=!0:x=!0:x=!0:(x=!0,y.__version=r.version);let w=y.currentProgram;!0===x&&(w=Ke(r,t,i));let S=!1,E=!1,T=!1;const M=w.getUniforms(),C=y.uniforms;ce.useProgram(w.program)&&(S=!0,E=!0,T=!0);r.id!==O&&(O=r.id,E=!0);if(S||k!==e){ce.buffers.depth.getReversed()?(ee.copy(e.projectionMatrix),function(e){const t=e.elements;t[2]=.5*t[2]+.5*t[3],t[6]=.5*t[6]+.5*t[7],t[10]=.5*t[10]+.5*t[11],t[14]=.5*t[14]+.5*t[15]}(ee),function(e){const t=e.elements;-1===t[11]?(t[10]=-t[10]-1,t[14]=-t[14]):(t[10]=-t[10],t[14]=1-t[14])}(ee),M.setValue(Ie,"projectionMatrix",ee)):M.setValue(Ie,"projectionMatrix",e.projectionMatrix),M.setValue(Ie,"viewMatrix",e.matrixWorldInverse);const t=M.map.cameraPosition;void 0!==t&&t.setValue(Ie,ne.setFromMatrixPosition(e.matrixWorld)),ue.logarithmicDepthBuffer&&M.setValue(Ie,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&M.setValue(Ie,"isOrthographic",!0===e.isOrthographicCamera),k!==e&&(k=e,E=!0,T=!0)}if(i.isSkinnedMesh){M.setOptional(Ie,i,"bindMatrix"),M.setOptional(Ie,i,"bindMatrixInverse");const e=i.skeleton;e&&(null===e.boneTexture&&e.computeBoneTexture(),M.setValue(Ie,"boneTexture",e.boneTexture,de))}i.isBatchedMesh&&(M.setOptional(Ie,i,"batchingTexture"),M.setValue(Ie,"batchingTexture",i._matricesTexture,de),M.setOptional(Ie,i,"batchingIdTexture"),M.setValue(Ie,"batchingIdTexture",i._indirectTexture,de),M.setOptional(Ie,i,"batchingColorTexture"),null!==i._colorsTexture&&M.setValue(Ie,"batchingColorTexture",i._colorsTexture,de));const P=n.morphAttributes;void 0===P.position&&void 0===P.normal&&void 0===P.color||Te.update(i,n,w);(E||y.receiveShadow!==i.receiveShadow)&&(y.receiveShadow=i.receiveShadow,M.setValue(Ie,"receiveShadow",i.receiveShadow));r.isMeshGouraudMaterial&&null!==r.envMap&&(C.envMap.value=u,C.flipEnvMap.value=u.isCubeTexture&&!1===u.isRenderTargetTexture?-1:1);r.isMeshStandardMaterial&&null===r.envMap&&null!==t.environment&&(C.envMapIntensity.value=t.environmentIntensity);E&&(M.setValue(Ie,"toneMappingExposure",_.toneMappingExposure),y.needsLights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(C,T),o&&!0===r.fog&&be.refreshFogUniforms(C,o),be.refreshMaterialUniforms(C,r,W,H,v.state.transmissionRenderTarget[e.id]),Uo.upload(Ie,Je(y),C,de));r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(Uo.upload(Ie,Je(y),C,de),r.uniformsNeedUpdate=!1);r.isSpriteMaterial&&M.setValue(Ie,"center",i.center);if(M.setValue(Ie,"modelViewMatrix",i.modelViewMatrix),M.setValue(Ie,"normalMatrix",i.normalMatrix),M.setValue(Ie,"modelMatrix",i.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial){const e=r.uniformsGroups;for(let t=0,n=e.length;t<n;t++){const n=e[t];Ne.update(n,w),Ne.bind(n,w)}}return w}(e,t,n,r,i);ce.setMaterial(r,s);let u=n.index,c=1;if(!0===r.wireframe){if(u=ge.getWireframeAttribute(n),void 0===u)return;c=2}const l=n.drawRange,h=n.attributes.position;let d=l.start*c,f=(l.start+l.count)*c;null!==o&&(d=Math.max(d,o.start*c),f=Math.min(f,(o.start+o.count)*c)),null!==u?(d=Math.max(d,0),f=Math.min(f,u.count)):null!=h&&(d=Math.max(d,0),f=Math.min(f,h.count));const p=f-d;if(p<0||p===1/0)return;let m;Re.setup(i,r,a,n,u);let g=Ce;if(null!==u&&(m=me.get(u),g=Oe,g.setIndex(m)),i.isMesh)!0===r.wireframe?(ce.setLineWidth(r.wireframeLinewidth*se()),g.setMode(Ie.LINES)):g.setMode(Ie.TRIANGLES);else if(i.isLine){let e=r.linewidth;void 0===e&&(e=1),ce.setLineWidth(e*se()),i.isLineSegments?g.setMode(Ie.LINES):i.isLineLoop?g.setMode(Ie.LINE_LOOP):g.setMode(Ie.LINE_STRIP)}else i.isPoints?g.setMode(Ie.POINTS):i.isSprite&&g.setMode(Ie.TRIANGLES);if(i.isBatchedMesh)if(null!==i._multiDrawInstances)g.renderMultiDrawInstances(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount,i._multiDrawInstances);else if(ae.get("WEBGL_multi_draw"))g.renderMultiDraw(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount);else{const e=i._multiDrawStarts,t=i._multiDrawCounts,n=i._multiDrawCount,o=u?me.get(u).bytesPerElement:1,s=he.get(r).currentProgram.getUniforms();for(let r=0;r<n;r++)s.setValue(Ie,"_gl_DrawID",r),g.render(e[r]/o,t[r])}else if(i.isInstancedMesh)g.renderInstances(d,p,i.count);else if(n.isInstancedBufferGeometry){const e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);g.renderInstances(d,p,t)}else g.render(d,p)},this.compile=function(e,t,n=null){null===n&&(n=e),v=xe.get(n),v.init(t),b.push(v),n.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(v.pushLight(e),e.castShadow&&v.pushShadow(e))})),e!==n&&e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(v.pushLight(e),e.castShadow&&v.pushShadow(e))})),v.setupLights();const r=new Set;return e.traverse((function(e){if(!(e.isMesh||e.isPoints||e.isLine||e.isSprite))return;const t=e.material;if(t)if(Array.isArray(t))for(let i=0;i<t.length;i++){const o=t[i];je(o,n,e),r.add(o)}else je(t,n,e),r.add(t)})),b.pop(),v=null,r},this.compileAsync=function(e,t,n=null){const r=this.compile(e,t,n);return new Promise((t=>{function n(){r.forEach((function(e){he.get(e).currentProgram.isReady()&&r.delete(e)})),0!==r.size?setTimeout(n,10):t(e)}null!==ae.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)}))};let Ve=null;function Ge(){We.stop()}function He(){We.start()}const We=new Wr;function qe(e,t,n,r){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)v.pushLight(e),e.castShadow&&v.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||K.intersectsSprite(e)){r&&re.setFromMatrixPosition(e.matrixWorld).applyMatrix4(te);const t=ve.update(e),i=e.material;i.visible&&g.push(e,t,i,n,re.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||K.intersectsObject(e))){const t=ve.update(e),i=e.material;if(r&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),re.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),re.copy(t.boundingSphere.center)),re.applyMatrix4(e.matrixWorld).applyMatrix4(te)),Array.isArray(i)){const r=t.groups;for(let o=0,s=r.length;o<s;o++){const s=r[o],a=i[s.materialIndex];a&&a.visible&&g.push(e,t,a,n,re.z,s)}}else i.visible&&g.push(e,t,i,n,re.z,null)}const i=e.children;for(let e=0,o=i.length;e<o;e++)qe(i[e],t,n,r)}function Xe(e,t,n,r){const i=e.opaque,o=e.transmissive,s=e.transparent;v.setupLightsView(n),!0===Q&&we.setGlobalState(_.clippingPlanes,n),r&&ce.viewport(D.copy(r)),i.length>0&&$e(i,t,n),o.length>0&&$e(o,t,n),s.length>0&&$e(s,t,n),ce.buffers.depth.setTest(!0),ce.buffers.depth.setMask(!0),ce.buffers.color.setMask(!0),ce.setPolygonOffset(!1)}function Ze(e,t,n,r){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;void 0===v.state.transmissionRenderTarget[r.id]&&(v.state.transmissionRenderTarget[r.id]=new yt(1,1,{generateMipmaps:!0,type:ae.has("EXT_color_buffer_half_float")||ae.has("EXT_color_buffer_float")?P:S,minFilter:w,samples:4,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:tt.workingColorSpace}));const i=v.state.transmissionRenderTarget[r.id],s=r.viewport||D;i.setSize(s.z,s.w);const a=_.getRenderTarget();_.setRenderTarget(i),_.getClearColor(F),V=_.getClearAlpha(),V<1&&_.setClearColor(16777215,.5),_.clear(),oe&&Ee.render(n);const u=_.toneMapping;_.toneMapping=0;const c=r.viewport;if(void 0!==r.viewport&&(r.viewport=void 0),v.setupLightsView(r),!0===Q&&we.setGlobalState(_.clippingPlanes,r),$e(e,n,r),de.updateMultisampleRenderTarget(i),de.updateRenderTargetMipmap(i),!1===ae.has("WEBGL_multisampled_render_to_texture")){let e=!1;for(let i=0,o=t.length;i<o;i++){const o=t[i],s=o.object,a=o.geometry,u=o.material,c=o.group;if(2===u.side&&s.layers.test(r.layers)){const t=u.side;u.side=1,u.needsUpdate=!0,Ye(s,n,r,a,u,c),u.side=t,u.needsUpdate=!0,e=!0}}!0===e&&(de.updateMultisampleRenderTarget(i),de.updateRenderTargetMipmap(i))}_.setRenderTarget(a),_.setClearColor(F,V),void 0!==c&&(r.viewport=c),_.toneMapping=u}function $e(e,t,n){const r=!0===t.isScene?t.overrideMaterial:null;for(let i=0,o=e.length;i<o;i++){const o=e[i],s=o.object,a=o.geometry,u=null===r?o.material:r,c=o.group;s.layers.test(n.layers)&&Ye(s,t,n,a,u,c)}}function Ye(e,t,n,r,i,o){e.onBeforeRender(_,t,n,r,i,o),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(_,t,n,r,e,o),!0===i.transparent&&2===i.side&&!1===i.forceSinglePass?(i.side=1,i.needsUpdate=!0,_.renderBufferDirect(n,t,r,i,e,o),i.side=0,i.needsUpdate=!0,_.renderBufferDirect(n,t,r,i,e,o),i.side=2):_.renderBufferDirect(n,t,r,i,e,o),e.onAfterRender(_,t,n,r,i,o)}function Ke(e,t,n){!0!==t.isScene&&(t=ie);const r=he.get(e),i=v.state.lights,o=v.state.shadowsArray,s=i.state.version,a=ye.getParameters(e,i.state,o,t,n),u=ye.getProgramCacheKey(a);let c=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?pe:fe).get(e.envMap||r.environment),r.envMapRotation=null!==r.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===c&&(e.addEventListener("dispose",ze),c=new Map,r.programs=c);let l=c.get(u);if(void 0!==l){if(r.currentProgram===l&&r.lightsStateVersion===s)return nt(e,a),l}else a.uniforms=ye.getUniforms(e),e.onBeforeCompile(a,_),l=ye.acquireProgram(a,u),c.set(u,l),r.uniforms=a.uniforms;const h=r.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=we.uniform),nt(e,a),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=s,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotLightMatrix.value=i.state.spotLightMatrix,h.spotLightMap.value=i.state.spotLightMap,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix),r.currentProgram=l,r.uniformsList=null,l}function Je(e){if(null===e.uniformsList){const t=e.currentProgram.getUniforms();e.uniformsList=Uo.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function nt(e,t){const n=he.get(e);n.outputColorSpace=t.outputColorSpace,n.batching=t.batching,n.batchingColor=t.batchingColor,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.instancingMorph=t.instancingMorph,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}We.setAnimationLoop((function(e){Ve&&Ve(e)})),"undefined"!=typeof self&&We.setContext(self),this.setAnimationLoop=function(e){Ve=e,Le.setAnimationLoop(e),null===e?We.stop():We.start()},Le.addEventListener("sessionstart",Ge),Le.addEventListener("sessionend",He),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===x)return;if(!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===Le.enabled&&!0===Le.isPresenting&&(!0===Le.cameraAutoUpdate&&Le.updateCamera(t),t=Le.getCamera()),!0===e.isScene&&e.onBeforeRender(_,e,t,A),v=xe.get(e,b.length),v.init(t),b.push(v),te.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),K.setFromProjectionMatrix(te),J=this.localClippingEnabled,Q=we.init(this.clippingPlanes,J),g=_e.get(e,y.length),g.init(),y.push(g),!0===Le.enabled&&!0===Le.isPresenting){const e=_.xr.getDepthSensingMesh();null!==e&&qe(e,t,-1/0,_.sortObjects)}qe(e,t,0,_.sortObjects),g.finish(),!0===_.sortObjects&&g.sort(q,X),oe=!1===Le.enabled||!1===Le.isPresenting||!1===Le.hasDepthSensing(),oe&&Ee.addToRenderList(g,e),this.info.render.frame++,!0===Q&&we.beginShadows();const n=v.state.shadowsArray;Se.render(n,e,t),!0===Q&&we.endShadows(),!0===this.info.autoReset&&this.info.reset();const r=g.opaque,i=g.transmissive;if(v.setupLights(),t.isArrayCamera){const n=t.cameras;if(i.length>0)for(let t=0,o=n.length;t<o;t++){Ze(r,i,e,n[t])}oe&&Ee.render(e);for(let t=0,r=n.length;t<r;t++){const r=n[t];Xe(g,e,r,r.viewport)}}else i.length>0&&Ze(r,i,e,t),oe&&Ee.render(e),Xe(g,e,t);null!==A&&(de.updateMultisampleRenderTarget(A),de.updateRenderTargetMipmap(A)),!0===e.isScene&&e.onAfterRender(_,e,t),Re.resetDefaultState(),O=-1,k=null,b.pop(),b.length>0?(v=b[b.length-1],!0===Q&&we.setGlobalState(_.clippingPlanes,v.state.camera)):v=null,y.pop(),g=y.length>0?y[y.length-1]:null},this.getActiveCubeFace=function(){return E},this.getActiveMipmapLevel=function(){return T},this.getRenderTarget=function(){return A},this.setRenderTargetTextures=function(e,t,n){he.get(e.texture).__webglTexture=t,he.get(e.depthTexture).__webglTexture=n;const r=he.get(e);r.__hasExternalTextures=!0,r.__autoAllocateDepthBuffer=void 0===n,r.__autoAllocateDepthBuffer||!0===ae.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),r.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(e,t){const n=he.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e,t=0,n=0){A=e,E=t,T=n;let r=!0,i=null,o=!1,s=!1;if(e){const a=he.get(e);if(void 0!==a.__useDefaultFramebuffer)ce.bindFramebuffer(Ie.FRAMEBUFFER,null),r=!1;else if(void 0===a.__webglFramebuffer)de.setupRenderTarget(e);else if(a.__hasExternalTextures)de.rebindTextures(e,he.get(e.texture).__webglTexture,he.get(e.depthTexture).__webglTexture);else if(e.depthBuffer){const t=e.depthTexture;if(a.__boundDepthTexture!==t){if(null!==t&&he.has(t)&&(e.width!==t.image.width||e.height!==t.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");de.setupDepthRenderbuffer(e)}}const u=e.texture;(u.isData3DTexture||u.isDataArrayTexture||u.isCompressedArrayTexture)&&(s=!0);const c=he.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(i=Array.isArray(c[t])?c[t][n]:c[t],o=!0):i=e.samples>0&&!1===de.useMultisampledRTT(e)?he.get(e).__webglMultisampledFramebuffer:Array.isArray(c)?c[n]:c,D.copy(e.viewport),L.copy(e.scissor),U=e.scissorTest}else D.copy(Z).multiplyScalar(W).floor(),L.copy($).multiplyScalar(W).floor(),U=Y;if(ce.bindFramebuffer(Ie.FRAMEBUFFER,i)&&r&&ce.drawBuffers(e,i),ce.viewport(D),ce.scissor(L),ce.setScissorTest(U),o){const r=he.get(e.texture);Ie.framebufferTexture2D(Ie.FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,Ie.TEXTURE_CUBE_MAP_POSITIVE_X+t,r.__webglTexture,n)}else if(s){const r=he.get(e.texture),i=t||0;Ie.framebufferTextureLayer(Ie.FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,r.__webglTexture,n||0,i)}O=-1},this.readRenderTargetPixels=function(e,t,n,r,i,o,s){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=he.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==s&&(a=a[s]),a){ce.bindFramebuffer(Ie.FRAMEBUFFER,a);try{const s=e.texture,a=s.format,u=s.type;if(!ue.textureFormatReadable(a))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!ue.textureTypeReadable(u))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&Ie.readPixels(t,n,r,i,Pe.convert(a),Pe.convert(u),o)}finally{const e=null!==A?he.get(A).__webglFramebuffer:null;ce.bindFramebuffer(Ie.FRAMEBUFFER,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,n,r,i,o,s){if(!e||!e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=he.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==s&&(a=a[s]),a){const s=e.texture,u=s.format,c=s.type;if(!ue.textureFormatReadable(u))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!ue.textureTypeReadable(c))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i){ce.bindFramebuffer(Ie.FRAMEBUFFER,a);const e=Ie.createBuffer();Ie.bindBuffer(Ie.PIXEL_PACK_BUFFER,e),Ie.bufferData(Ie.PIXEL_PACK_BUFFER,o.byteLength,Ie.STREAM_READ),Ie.readPixels(t,n,r,i,Pe.convert(u),Pe.convert(c),0);const s=null!==A?he.get(A).__webglFramebuffer:null;ce.bindFramebuffer(Ie.FRAMEBUFFER,s);const l=Ie.fenceSync(Ie.SYNC_GPU_COMMANDS_COMPLETE,0);return Ie.flush(),await function(e,t,n){return new Promise((function(r,i){setTimeout((function o(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:i();break;case e.TIMEOUT_EXPIRED:setTimeout(o,n);break;default:r()}}),n)}))}(Ie,l,4),Ie.bindBuffer(Ie.PIXEL_PACK_BUFFER,e),Ie.getBufferSubData(Ie.PIXEL_PACK_BUFFER,0,o),Ie.deleteBuffer(e),Ie.deleteSync(l),o}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(e,t=null,n=0){!0!==e.isTexture&&(et("WebGLRenderer: copyFramebufferToTexture function signature has changed."),t=arguments[0]||null,e=arguments[1]);const r=Math.pow(2,-n),i=Math.floor(e.image.width*r),o=Math.floor(e.image.height*r),s=null!==t?t.x:0,a=null!==t?t.y:0;de.setTexture2D(e,0),Ie.copyTexSubImage2D(Ie.TEXTURE_2D,n,0,0,s,a,i,o),ce.unbindTexture()},this.copyTextureToTexture=function(e,t,n=null,r=null,i=0){let o,s,a,u,c,l,h,d,f;!0!==e.isTexture&&(et("WebGLRenderer: copyTextureToTexture function signature has changed."),r=arguments[0]||null,e=arguments[1],t=arguments[2],i=arguments[3]||0,n=null);const p=e.isCompressedTexture?e.mipmaps[i]:e.image;null!==n?(o=n.max.x-n.min.x,s=n.max.y-n.min.y,a=n.isBox3?n.max.z-n.min.z:1,u=n.min.x,c=n.min.y,l=n.isBox3?n.min.z:0):(o=p.width,s=p.height,a=p.depth||1,u=0,c=0,l=0),null!==r?(h=r.x,d=r.y,f=r.z):(h=0,d=0,f=0);const m=Pe.convert(t.format),g=Pe.convert(t.type);let v;t.isData3DTexture?(de.setTexture3D(t,0),v=Ie.TEXTURE_3D):t.isDataArrayTexture||t.isCompressedArrayTexture?(de.setTexture2DArray(t,0),v=Ie.TEXTURE_2D_ARRAY):(de.setTexture2D(t,0),v=Ie.TEXTURE_2D),Ie.pixelStorei(Ie.UNPACK_FLIP_Y_WEBGL,t.flipY),Ie.pixelStorei(Ie.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),Ie.pixelStorei(Ie.UNPACK_ALIGNMENT,t.unpackAlignment);const y=Ie.getParameter(Ie.UNPACK_ROW_LENGTH),b=Ie.getParameter(Ie.UNPACK_IMAGE_HEIGHT),_=Ie.getParameter(Ie.UNPACK_SKIP_PIXELS),x=Ie.getParameter(Ie.UNPACK_SKIP_ROWS),w=Ie.getParameter(Ie.UNPACK_SKIP_IMAGES);Ie.pixelStorei(Ie.UNPACK_ROW_LENGTH,p.width),Ie.pixelStorei(Ie.UNPACK_IMAGE_HEIGHT,p.height),Ie.pixelStorei(Ie.UNPACK_SKIP_PIXELS,u),Ie.pixelStorei(Ie.UNPACK_SKIP_ROWS,c),Ie.pixelStorei(Ie.UNPACK_SKIP_IMAGES,l);const S=e.isDataArrayTexture||e.isData3DTexture,E=t.isDataArrayTexture||t.isData3DTexture;if(e.isRenderTargetTexture||e.isDepthTexture){const n=he.get(e),r=he.get(t),p=he.get(n.__renderTarget),m=he.get(r.__renderTarget);ce.bindFramebuffer(Ie.READ_FRAMEBUFFER,p.__webglFramebuffer),ce.bindFramebuffer(Ie.DRAW_FRAMEBUFFER,m.__webglFramebuffer);for(let n=0;n<a;n++)S&&Ie.framebufferTextureLayer(Ie.READ_FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,he.get(e).__webglTexture,i,l+n),e.isDepthTexture?(E&&Ie.framebufferTextureLayer(Ie.DRAW_FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,he.get(t).__webglTexture,i,f+n),Ie.blitFramebuffer(u,c,o,s,h,d,o,s,Ie.DEPTH_BUFFER_BIT,Ie.NEAREST)):E?Ie.copyTexSubImage3D(v,i,h,d,f+n,u,c,o,s):Ie.copyTexSubImage2D(v,i,h,d,f+n,u,c,o,s);ce.bindFramebuffer(Ie.READ_FRAMEBUFFER,null),ce.bindFramebuffer(Ie.DRAW_FRAMEBUFFER,null)}else E?e.isDataTexture||e.isData3DTexture?Ie.texSubImage3D(v,i,h,d,f,o,s,a,m,g,p.data):t.isCompressedArrayTexture?Ie.compressedTexSubImage3D(v,i,h,d,f,o,s,a,m,p.data):Ie.texSubImage3D(v,i,h,d,f,o,s,a,m,g,p):e.isDataTexture?Ie.texSubImage2D(Ie.TEXTURE_2D,i,h,d,o,s,m,g,p.data):e.isCompressedTexture?Ie.compressedTexSubImage2D(Ie.TEXTURE_2D,i,h,d,p.width,p.height,m,p.data):Ie.texSubImage2D(Ie.TEXTURE_2D,i,h,d,o,s,m,g,p);Ie.pixelStorei(Ie.UNPACK_ROW_LENGTH,y),Ie.pixelStorei(Ie.UNPACK_IMAGE_HEIGHT,b),Ie.pixelStorei(Ie.UNPACK_SKIP_PIXELS,_),Ie.pixelStorei(Ie.UNPACK_SKIP_ROWS,x),Ie.pixelStorei(Ie.UNPACK_SKIP_IMAGES,w),0===i&&t.generateMipmaps&&Ie.generateMipmap(v),ce.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n=null,r=null,i=0){return!0!==e.isTexture&&(et("WebGLRenderer: copyTextureToTexture3D function signature has changed."),n=arguments[0]||null,r=arguments[1]||null,e=arguments[2],t=arguments[3],i=arguments[4]||0),et('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(e,t,n,r,i)},this.initRenderTarget=function(e){void 0===he.get(e).__webglFramebuffer&&de.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?de.setTextureCube(e,0):e.isData3DTexture?de.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?de.setTexture2DArray(e,0):de.setTexture2D(e,0),ce.unbindTexture()},this.resetState=function(){E=0,T=0,A=null,ce.reset(),Re.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ie}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorspace=tt._getDrawingBufferColorSpace(e),t.unpackColorSpace=tt._getUnpackColorSpace()}},Scene:Us,PerspectiveCamera:Ir,Raycaster:Ja,SRGBColorSpace:Me,TextureLoader:class extends Ia{constructor(e){super(e)}load(e,t,n,r){const i=new mt,o=new ka(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,(function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}},Vector2:Xe,Vector3:wt,Box3:Tt,Color:Wn,Mesh:xr,SphereGeometry:fa,MeshBasicMaterial:$n,BackSide:1,EventDispatcher:De,MOUSE:i,Quaternion:xt,Spherical:nu,Clock:Ga},NI=(0,Iu.Z)({props:{width:{default:window.innerWidth,onChange:function(e,t,n){isNaN(e)&&(t.width=n)}},height:{default:window.innerHeight,onChange:function(e,t,n){isNaN(e)&&(t.height=n)}},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},lights:{default:[]},enablePointerInteraction:{default:!0,onChange:function(e,t){t.hoverObj=null,t.toolTipElem&&(t.toolTipElem.innerHTML="")},triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{default:function(){return-1},triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(e){if(e.initialised){if(e.controls.update&&e.controls.update(Math.min(1,e.clock.getDelta())),e.postProcessingComposer?e.postProcessingComposer.render():e.renderer.render(e.scene,e.camera),e.extraRenderers.forEach((function(t){return t.render(e.scene,e.camera)})),e.enablePointerInteraction){var t=null;if(e.hoverDuringDrag||!e.isPointerDragging){var n=this.intersectingObjects(e.pointerPos.x,e.pointerPos.y).filter((function(t){return e.hoverFilter(t.object)})).sort((function(t,n){return e.hoverOrderComparator(t.object,n.object)})),r=n.length?n[0]:null;t=r?r.object:null,e.intersectionPoint=r?r.point:null}t!==e.hoverObj&&(e.onHover(t,e.hoverObj),e.toolTipElem.innerHTML=t&&(0,ku.Z)(e.tooltipContent)(t)||"",e.hoverObj=t)}e.tweenGroup.update()}return this},getPointerPos:function(e){var t=e.pointerPos;return{x:t.x,y:t.y}},cameraPosition:function(e,t,n,r){var i=e.camera;if(t&&e.initialised){var o=t,s=n||{x:0,y:0,z:0};if(r){var a=Object.assign({},i.position),u=h();e.tweenGroup.add(new TI.kX(a).to(o,r).easing(TI.oY.Quadratic.Out).onUpdate(c).start()),e.tweenGroup.add(new TI.kX(u).to(s,r/3).easing(TI.oY.Quadratic.Out).onUpdate(l).start())}else c(o),l(s);return this}return Object.assign({},i.position,{lookAt:h()});function c(e){var t=e.x,n=e.y,r=e.z;void 0!==t&&(i.position.x=t),void 0!==n&&(i.position.y=n),void 0!==r&&(i.position.z=r)}function l(t){var n=new RI.Vector3(t.x,t.y,t.z);e.controls.target?e.controls.target=n:i.lookAt(n)}function h(){return Object.assign(new RI.Vector3(0,0,-1e3).applyQuaternion(i.quaternion).add(i.position))}},zoomToFit:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=arguments.length,i=new Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];return this.fitToBbox(this.getBbox.apply(this,i),t,n)},fitToBbox:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,i=e.camera;if(t){var o=new RI.Vector3(0,0,0),s=2*Math.max.apply(Math,OI(Object.entries(t).map((function(e){var t=CI(e,2),n=t[0],r=t[1];return Math.max.apply(Math,OI(r.map((function(e){return Math.abs(o[n]-e)}))))})))),a=(1-2*r/e.height)*i.fov,u=s/Math.atan(a*Math.PI/180),c=u/i.aspect,l=Math.max(u,c);if(l>0){var h=o.clone().sub(i.position).normalize().multiplyScalar(-l);this.cameraPosition(h,o,n)}}return this},getBbox:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=new RI.Box3(new RI.Vector3(0,0,0),new RI.Vector3(0,0,0)),r=e.objects.filter(t);return r.length?(r.forEach((function(e){return n.expandByObject(e)})),Object.assign.apply(Object,OI(["x","y","z"].map((function(e){return AI({},e,[n.min[e],n.max[e]])}))))):null},getScreenCoords:function(e,t,n,r){var i=new RI.Vector3(t,n,r);return i.project(this.camera()),{x:(i.x+1)*e.width/2,y:-(i.y-1)*e.height/2}},getSceneCoords:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=new RI.Vector2(t/e.width*2-1,-n/e.height*2+1),o=new RI.Raycaster;return o.setFromCamera(i,e.camera),Object.assign({},o.ray.at(r,new RI.Vector3))},intersectingObjects:function(e,t,n){var r=new RI.Vector2(t/e.width*2-1,-n/e.height*2+1),i=new RI.Raycaster;return i.params.Line.threshold=e.lineHoverPrecision,i.setFromCamera(r,e.camera),i.intersectObjects(e.objects,!0)},renderer:function(e){return e.renderer},scene:function(e){return e.scene},camera:function(e){return e.camera},postProcessingComposer:function(e){return e.postProcessingComposer},controls:function(e){return e.controls},tbControls:function(e){return e.controls}},stateInit:function(){return{scene:new RI.Scene,camera:new RI.PerspectiveCamera,clock:new RI.Clock,tweenGroup:new TI.ZA}},init:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.controlType,i=void 0===r?"trackball":r,o=n.useWebGPU,s=void 0!==o&&o,a=n.rendererConfig,u=void 0===a?{}:a,c=n.extraRenderers,l=void 0===c?[]:c,h=n.waitForLoadComplete,d=void 0===h||h;e.innerHTML="",e.appendChild(t.container=document.createElement("div")),t.container.className="scene-container",t.container.style.position="relative",t.container.appendChild(t.navInfo=document.createElement("div")),t.navInfo.className="scene-nav-info",t.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[i]||"",t.navInfo.style.display=t.showNavInfo?null:"none",t.toolTipElem=document.createElement("div"),t.toolTipElem.classList.add("scene-tooltip"),t.container.appendChild(t.toolTipElem),t.pointerPos=new RI.Vector2,t.pointerPos.x=-2,t.pointerPos.y=-2,["pointermove","pointerdown"].forEach((function(e){return t.container.addEventListener(e,(function(n){if("pointerdown"===e&&(t.isPointerPressed=!0),!t.isPointerDragging&&"pointermove"===n.type&&(n.pressure>0||t.isPointerPressed)&&("touch"!==n.pointerType||void 0===n.movementX||[n.movementX,n.movementY].some((function(e){return Math.abs(e)>1})))&&(t.isPointerDragging=!0),t.enablePointerInteraction){var r=(i=t.container,o=i.getBoundingClientRect(),s=window.pageXOffset||document.documentElement.scrollLeft,a=window.pageYOffset||document.documentElement.scrollTop,{top:o.top+a,left:o.left+s});t.pointerPos.x=n.pageX-r.left,t.pointerPos.y=n.pageY-r.top,t.toolTipElem.style.top="".concat(t.pointerPos.y,"px"),t.toolTipElem.style.left="".concat(t.pointerPos.x,"px"),t.toolTipElem.style.transform="translate(-".concat(t.pointerPos.x/t.width*100,"%, ").concat(t.height-t.pointerPos.y<100?"calc(-100% - 8px)":"21px",")")}var i,o,s,a}),{passive:!0})})),t.container.addEventListener("pointerup",(function(e){t.isPointerPressed=!1,t.isPointerDragging&&(t.isPointerDragging=!1,!t.clickAfterDrag)||requestAnimationFrame((function(){0===e.button&&t.onClick(t.hoverObj||null,e,t.intersectionPoint),2===e.button&&t.onRightClick&&t.onRightClick(t.hoverObj||null,e,t.intersectionPoint)}))}),{passive:!0,capture:!0}),t.container.addEventListener("contextmenu",(function(e){t.onRightClick&&e.preventDefault()})),t.renderer=new(s?sR:RI.WebGLRenderer)(Object.assign({antialias:!0,alpha:!0},u)),t.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),t.container.appendChild(t.renderer.domElement),t.extraRenderers=l,t.extraRenderers.forEach((function(e){e.domElement.style.position="absolute",e.domElement.style.top="0px",e.domElement.style.pointerEvents="none",t.container.appendChild(e.domElement)})),t.postProcessingComposer=new UN(t.renderer),t.postProcessingComposer.addPass(new FN(t.scene,t.camera)),t.controls=new{trackball:AR,orbit:oN,fly:xN}[i](t.camera,t.renderer.domElement),"fly"===i&&(t.controls.movementSpeed=300,t.controls.rollSpeed=Math.PI/6,t.controls.dragToLook=!0),"trackball"!==i&&"orbit"!==i||(t.controls.minDistance=.1,t.controls.maxDistance=t.skyRadius,t.controls.addEventListener("start",(function(){t.controlsEngaged=!0})),t.controls.addEventListener("change",(function(){t.controlsEngaged&&(t.controlsDragging=!0)})),t.controls.addEventListener("end",(function(){t.controlsEngaged=!1,t.controlsDragging=!1}))),[t.renderer,t.postProcessingComposer].concat(OI(t.extraRenderers)).forEach((function(e){return e.setSize(t.width,t.height)})),t.camera.aspect=t.width/t.height,t.camera.updateProjectionMatrix(),t.camera.position.z=1e3,t.scene.add(t.skysphere=new RI.Mesh),t.skysphere.visible=!1,t.loadComplete=t.scene.visible=!d,window.scene=t.scene},update:function(e,t){if(e.width&&e.height&&(t.hasOwnProperty("width")||t.hasOwnProperty("height"))&&(e.container.style.width="".concat(e.width,"px"),e.container.style.height="".concat(e.height,"px"),[e.renderer,e.postProcessingComposer].concat(OI(e.extraRenderers)).forEach((function(t){return t.setSize(e.width,e.height)})),e.camera.aspect=e.width/e.height,e.camera.updateProjectionMatrix()),t.hasOwnProperty("skyRadius")&&e.skyRadius&&(e.controls.hasOwnProperty("maxDistance")&&t.skyRadius&&(e.controls.maxDistance=Math.min(e.controls.maxDistance,e.skyRadius)),e.camera.far=2.5*e.skyRadius,e.camera.updateProjectionMatrix(),e.skysphere.geometry=new RI.SphereGeometry(e.skyRadius)),t.hasOwnProperty("backgroundColor")){var n=sI(e.backgroundColor).alpha;void 0===n&&(n=1),e.renderer.setClearColor(new RI.Color(EI(1,e.backgroundColor)),n)}function r(){e.loadComplete=e.scene.visible=!0}t.hasOwnProperty("backgroundImageUrl")&&(e.backgroundImageUrl?(new RI.TextureLoader).load(e.backgroundImageUrl,(function(t){t.colorSpace=RI.SRGBColorSpace,e.skysphere.material=new RI.MeshBasicMaterial({map:t,side:RI.BackSide}),e.skysphere.visible=!0,e.onBackgroundImageLoaded&&setTimeout(e.onBackgroundImageLoaded),!e.loadComplete&&r()})):(e.skysphere.visible=!1,e.skysphere.material.map=null,!e.loadComplete&&r())),t.hasOwnProperty("showNavInfo")&&(e.navInfo.style.display=e.showNavInfo?null:"none"),t.hasOwnProperty("lights")&&((t.lights||[]).forEach((function(t){return e.scene.remove(t)})),e.lights.forEach((function(t){return e.scene.add(t)}))),t.hasOwnProperty("objects")&&((t.objects||[]).forEach((function(t){return e.scene.remove(t)})),e.objects.forEach((function(t){return e.scene.add(t)})))}});function II(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function kI(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function LI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?DI(Object(n),!0).forEach((function(t){kI(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DI(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function UI(e){return function(e){if(Array.isArray(e))return II(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return II(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?II(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function FI(e,t){var n=new t;return n._destructor&&n._destructor(),{linkProp:function(t){return{default:n[t](),onChange:function(n,r){r[e][t](n)},triggerUpdate:!1}},linkMethod:function(t){return function(n){for(var r=n[e],i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];var a=r[t].apply(r,o);return a===r?this:a}}}}!function(e,t){void 0===t&&(t={});var n=t.insertAt;if("undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(".graph-info-msg {\n  top: 50%;\n  width: 100%;\n  text-align: center;\n  color: lavender;\n  opacity: 0.7;\n  font-size: 22px;\n  position: absolute;\n  font-family: Sans-serif;\n}\n\n.scene-container .clickable {\n  cursor: pointer;\n}\n\n.scene-container .grabbable {\n  cursor: move;\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n\n.scene-container .grabbable:active {\n  cursor: grabbing;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n}");var BI=window.THREE?window.THREE:{AmbientLight:Va,DirectionalLight:ja,Vector3:wt,REVISION:r},zI=FI("forceGraph",Ac),jI=Object.assign.apply(Object,UI(["jsonUrl","graphData","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeColor","nodeAutoColorBy","nodeOpacity","nodeVisibility","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaDecay","d3VelocityDecay","d3AlphaMin","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map((function(e){return kI({},e,zI.linkProp(e))})))),VI=Object.assign.apply(Object,UI(["refresh","getGraphBbox","d3Force","d3ReheatSimulation","emitParticle"].map((function(e){return kI({},e,zI.linkMethod(e))})))),GI=FI("renderObjs",NI),HI=Object.assign.apply(Object,UI(["width","height","backgroundColor","showNavInfo","enablePointerInteraction"].map((function(e){return kI({},e,GI.linkProp(e))})))),WI=Object.assign.apply(Object,UI(["lights","cameraPosition","postProcessingComposer"].map((function(e){return kI({},e,GI.linkMethod(e))}))).concat([{graph2ScreenCoords:GI.linkMethod("getScreenCoords"),screen2GraphCoords:GI.linkMethod("getSceneCoords")}])),qI=(0,Iu.Z)({props:LI(LI({nodeLabel:{default:"name",triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:1,onChange:function(e,t){return t.renderObjs.lineHoverPrecision(e)},triggerUpdate:!1},enableNavigationControls:{default:!0,onChange:function(e,t){var n=t.renderObjs.controls();n&&(n.enabled=e,e&&n.domElement&&n.domElement.dispatchEvent(new PointerEvent("pointerup")))},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1}},jI),HI),methods:LI(LI({zoomToFit:function(e,t,n){for(var r,i=arguments.length,o=new Array(i>3?i-3:0),s=3;s<i;s++)o[s-3]=arguments[s];return e.renderObjs.fitToBbox((r=e.forceGraph).getGraphBbox.apply(r,o),t,n),this},pauseAnimation:function(e){return null!==e.animationFrameRequestId&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),this},resumeAnimation:function(e){return null===e.animationFrameRequestId&&this._animationCycle(),this},_animationCycle:function(e){e.enablePointerInteraction&&(this.renderer().domElement.style.cursor=null),e.forceGraph.tickFrame(),e.renderObjs.tick(),e.animationFrameRequestId=requestAnimationFrame(this._animationCycle)},scene:function(e){return e.renderObjs.scene()},camera:function(e){return e.renderObjs.camera()},renderer:function(e){return e.renderObjs.renderer()},controls:function(e){return e.renderObjs.controls()},tbControls:function(e){return e.renderObjs.tbControls()},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},VI),WI),stateInit:function(e){var t=e.controlType,n=e.rendererConfig,r=e.extraRenderers,i=new Ac;return{forceGraph:i,renderObjs:NI({controlType:t,rendererConfig:n,extraRenderers:r}).objects([i]).lights([new BI.AmbientLight(13421772,Math.PI),new BI.DirectionalLight(16777215,.6*Math.PI)])}},init:function(e,t){e.innerHTML="",e.appendChild(t.container=document.createElement("div")),t.container.style.position="relative";var n=document.createElement("div");t.container.appendChild(n),t.renderObjs(n);var r,i=t.renderObjs.camera(),o=t.renderObjs.renderer(),s=t.renderObjs.controls();s.enabled=!!t.enableNavigationControls,t.lastSetCameraZ=i.position.z,t.container.appendChild(r=document.createElement("div")),r.className="graph-info-msg",r.textContent="",t.forceGraph.onLoading((function(){r.textContent="Loading..."})).onFinishLoading((function(){r.textContent=""})).onUpdate((function(){t.graphData=t.forceGraph.graphData(),0===i.position.x&&0===i.position.y&&i.position.z===t.lastSetCameraZ&&t.graphData.nodes.length&&(i.lookAt(t.forceGraph.position),t.lastSetCameraZ=i.position.z=170*Math.cbrt(t.graphData.nodes.length))})).onFinishUpdate((function(){if(t._dragControls){var e=t.graphData.nodes.find((function(e){return e.__initialFixedPos&&!e.__disposeControlsAfterDrag}));e?e.__disposeControlsAfterDrag=!0:t._dragControls.dispose(),t._dragControls=void 0}if(t.enableNodeDrag&&t.enablePointerInteraction&&"d3"===t.forceEngine){var n=t._dragControls=new _u(t.graphData.nodes.map((function(e){return e.__threeObj})).filter((function(e){return e})),i,o.domElement);n.addEventListener("dragstart",(function(e){s.enabled=!1,e.object.__initialPos=e.object.position.clone(),e.object.__prevPos=e.object.position.clone();var t=XI(e.object).__data;!t.__initialFixedPos&&(t.__initialFixedPos={fx:t.fx,fy:t.fy,fz:t.fz}),!t.__initialPos&&(t.__initialPos={x:t.x,y:t.y,z:t.z}),["x","y","z"].forEach((function(e){return t["f".concat(e)]=t[e]})),o.domElement.classList.add("grabbable")})),n.addEventListener("drag",(function(e){var n=XI(e.object);if(!e.object.hasOwnProperty("__graphObjType")){var r=e.object.__initialPos,i=e.object.__prevPos,o=e.object.position;n.position.add(o.clone().sub(i)),i.copy(o),o.copy(r)}var s=n.__data,a=n.position,u={x:a.x-s.x,y:a.y-s.y,z:a.z-s.z};["x","y","z"].forEach((function(e){return s["f".concat(e)]=s[e]=a[e]})),t.forceGraph.d3AlphaTarget(.3).resetCountdown(),s.__dragged=!0,t.onNodeDrag(s,u)})),n.addEventListener("dragend",(function(e){delete e.object.__initialPos,delete e.object.__prevPos;var r=XI(e.object).__data;r.__disposeControlsAfterDrag&&(n.dispose(),delete r.__disposeControlsAfterDrag);var i=r.__initialFixedPos,a=r.__initialPos,u={x:a.x-r.x,y:a.y-r.y,z:a.z-r.z};i&&(["x","y","z"].forEach((function(e){var t="f".concat(e);void 0===i[t]&&delete r[t]})),delete r.__initialFixedPos,delete r.__initialPos,r.__dragged&&(delete r.__dragged,t.onNodeDragEnd(r,u))),t.forceGraph.d3AlphaTarget(0).resetCountdown(),t.enableNavigationControls&&(s.enabled=!0,s.domElement&&s.domElement.ownerDocument&&s.domElement.ownerDocument.dispatchEvent(new PointerEvent("pointerup",{pointerType:"touch"}))),o.domElement.classList.remove("grabbable")}))}})),BI.REVISION<155&&(t.renderObjs.renderer().useLegacyLights=!1),t.renderObjs.hoverOrderComparator((function(e,t){var n=XI(e);if(!n)return 1;var r=XI(t);if(!r)return-1;var i=function(e){return"node"===e.__graphObjType};return i(r)-i(n)})).tooltipContent((function(e){var n=XI(e);return n&&(0,ku.Z)(t["".concat(n.__graphObjType,"Label")])(n.__data)||""})).hoverDuringDrag(!1).onHover((function(e){var n=XI(e);if(n!==t.hoverObj){var r=t.hoverObj?t.hoverObj.__graphObjType:null,i=t.hoverObj?t.hoverObj.__data:null,s=n?n.__graphObjType:null,a=n?n.__data:null;if(r&&r!==s){var u=t["on".concat("node"===r?"Node":"Link","Hover")];u&&u(null,i)}if(s){var c=t["on".concat("node"===s?"Node":"Link","Hover")];c&&c(a,r===s?i:null)}o.domElement.classList[n&&t["on".concat("node"===s?"Node":"Link","Click")]||!n&&t.onBackgroundClick?"add":"remove"]("clickable"),t.hoverObj=n}})).clickAfterDrag(!1).onClick((function(e,n){var r=XI(e);if(r){var i=t["on".concat("node"===r.__graphObjType?"Node":"Link","Click")];i&&i(r.__data,n)}else t.onBackgroundClick&&t.onBackgroundClick(n)})).onRightClick((function(e,n){var r=XI(e);if(r){var i=t["on".concat("node"===r.__graphObjType?"Node":"Link","RightClick")];i&&i(r.__data,n)}else t.onBackgroundRightClick&&t.onBackgroundRightClick(n)})),this._animationCycle()}});function XI(e){for(var t=e;t&&!t.hasOwnProperty("__graphObjType");)t=t.parent;return t}},10866:function(e,t,n){"use strict";n.d(t,{A:function(){return p}});var r,i=n(50959),o=n(28680),s=n(77320),a=n(53394);function u({color:e,dimensions:t,lineWidth:n}){return i.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function c({color:e,radius:t}){return i.createElement("circle",{cx:t,cy:t,r:t,fill:e})}!function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"}(r||(r={}));const l={[r.Dots]:"#91919a",[r.Lines]:"#eee",[r.Cross]:"#e2e2e2"},h={[r.Dots]:1,[r.Lines]:1,[r.Cross]:6},d=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function f({id:e,variant:t=r.Dots,gap:n=20,size:f,lineWidth:p=1,offset:m=2,color:g,style:v,className:y}){const b=(0,i.useRef)(null),{transform:_,patternId:x}=(0,s.oR)(d,a.X),w=g||l[t],S=f||h[t],E=t===r.Dots,T=t===r.Cross,M=Array.isArray(n)?n:[n,n],A=[M[0]*_[2]||1,M[1]*_[2]||1],C=S*_[2],O=T?[C,C]:A,P=E?[C/m,C/m]:[O[0]/m,O[1]/m];return i.createElement("svg",{className:(0,o.Z)(["react-flow__background",y]),style:{...v,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:b,"data-testid":"rf__background"},i.createElement("pattern",{id:x+e,x:_[0]%A[0],y:_[1]%A[1],width:A[0],height:A[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${P[0]},-${P[1]})`},E?i.createElement(c,{color:w,radius:C/m}):i.createElement(u,{dimensions:O,color:w,lineWidth:p})),i.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${x+e})`}))}f.displayName="Background";var p=(0,i.memo)(f)},77320:function(e,t,n){"use strict";n.d(t,{u5:function(){return ne},XQ:function(){return cr},HH:function(){return $e},s_:function(){return I},Ly:function(){return he},x$:function(){return ar},tV:function(){return Jn},yn:function(){return Xt},Fb:function(){return qt},oI:function(){return q},VP:function(){return Ne},RX:function(){return Ie},AQ:function(){return hr},_K:function(){return It},oR:function(){return P},AC:function(){return R}});var r=n(50959),i=n(28680),o=n(9714),s=n(74914);const{useDebugValue:a}=r,{useSyncExternalStoreWithSelector:u}=o,c=e=>e;function l(e,t=c,n){const r=u(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return a(r),r}const h=(e,t)=>{const n=(0,s.M)(e),r=(e,r=t)=>l(n,e,r);return Object.assign(r,n),r};var d=n(53394),f=n(89888),p=n(41468),m=n(13802),g=n(45452),v=n(10422);const y=(0,r.createContext)(null),b=y.Provider,_=e=>`Node type "${e}" not found. Using fallback type "default".`,x=()=>"The React Flow parent container needs a width and a height to render the graph.",w=()=>"Only child nodes can use a parent extent.",S=()=>"Can't create edge. An edge needs a source and a target.",E=e=>`Marker type "${e}" doesn't exist.`,T=(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,M=()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",A=e=>`Edge type "${e}" not found. Using fallback type "default".`,C=e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,O=(()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001")();function P(e,t){const n=(0,r.useContext)(y);if(null===n)throw new Error(O);return l(n,e,t)}const R=()=>{const e=(0,r.useContext)(y);if(null===e)throw new Error(O);return(0,r.useMemo)((()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy})),[e])},N=e=>e.userSelectionActive?"none":"all";function I({position:e,children:t,className:n,style:o,...s}){const a=P(N),u=`${e}`.split("-");return r.createElement("div",{className:(0,i.Z)(["react-flow__panel",n,...u]),style:{...o,pointerEvents:a},...s},t)}function k({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:r.createElement(I,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},r.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}var D=(0,r.memo)((({x:e,y:t,label:n,labelStyle:o={},labelShowBg:s=!0,labelBgStyle:a={},labelBgPadding:u=[2,4],labelBgBorderRadius:c=2,children:l,className:h,...d})=>{const f=(0,r.useRef)(null),[p,m]=(0,r.useState)({x:0,y:0,width:0,height:0}),g=(0,i.Z)(["react-flow__edge-textwrapper",h]);return(0,r.useEffect)((()=>{if(f.current){const e=f.current.getBBox();m({x:e.x,y:e.y,width:e.width,height:e.height})}}),[n]),void 0!==n&&n?r.createElement("g",{transform:`translate(${e-p.width/2} ${t-p.height/2})`,className:g,visibility:p.width?"visible":"hidden",...d},s&&r.createElement("rect",{width:p.width+2*u[0],x:-u[0],y:-u[1],height:p.height+2*u[1],className:"react-flow__edge-textbg",style:a,rx:c,ry:c}),r.createElement("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:f,style:o},n),l):null}));const L=e=>({width:e.offsetWidth,height:e.offsetHeight}),U=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),F=(e={x:0,y:0},t)=>({x:U(e.x,t[0][0],t[1][0]),y:U(e.y,t[0][1],t[1][1])}),B=(e,t,n)=>e<t?U(Math.abs(e-t),1,50)/50:e>n?-U(Math.abs(e-n),1,50)/50:0,z=(e,t)=>[20*B(e.x,35,t.width-35),20*B(e.y,35,t.height-35)],j=e=>e.getRootNode?.()||window?.document,V=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),G=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),H=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),W=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),q=(e,t)=>H(V(G(e),G(t))),X=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Z=e=>!isNaN(e)&&isFinite(e),$=Symbol.for("internals"),Y=["Enter"," ","Escape"],K=(e,t)=>{0};function Q(e){const t=((e=>"nativeEvent"in e)(e)?e.nativeEvent:e).composedPath?.()?.[0]||e.target;return["INPUT","SELECT","TEXTAREA"].includes(t?.nodeName)||t?.hasAttribute("contenteditable")||!!t?.closest(".nokey")}const J=e=>"clientX"in e,ee=(e,t)=>{const n=J(e),r=n?e.clientX:e.touches?.[0].clientX,i=n?e.clientY:e.touches?.[0].clientY;return{x:r-(t?.left??0),y:i-(t?.top??0)}},te=()=>"undefined"!=typeof navigator&&navigator?.userAgent?.indexOf("Mac")>=0,ne=({id:e,path:t,labelX:n,labelY:i,label:o,labelStyle:s,labelShowBg:a,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:l,style:h,markerEnd:d,markerStart:f,interactionWidth:p=20})=>r.createElement(r.Fragment,null,r.createElement("path",{id:e,style:h,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:d,markerStart:f}),p&&r.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:p,className:"react-flow__edge-interaction"}),o&&Z(n)&&Z(i)?r.createElement(D,{x:n,y:i,label:o,labelStyle:s,labelShowBg:a,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:l}):null);ne.displayName="BaseEdge";function re(e,t,n){return void 0===n?n:r=>{const i=t().edges.find((t=>t.id===e));i&&n(r,{...i})}}function ie({sourceX:e,sourceY:t,targetX:n,targetY:r}){const i=Math.abs(n-e)/2,o=n<e?n+i:n-i,s=Math.abs(r-t)/2;return[o,r<t?r+s:r-s,i,s]}function oe({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:i,sourceControlY:o,targetControlX:s,targetControlY:a}){const u=.125*e+.375*i+.375*s+.125*n,c=.125*t+.375*o+.375*a+.125*r;return[u,c,Math.abs(u-e),Math.abs(c-t)]}var se,ae,ue,ce,le,he;function de({pos:e,x1:t,y1:n,x2:r,y2:i}){return e===he.Left||e===he.Right?[.5*(t+r),n]:[t,.5*(n+i)]}function fe({sourceX:e,sourceY:t,sourcePosition:n=he.Bottom,targetX:r,targetY:i,targetPosition:o=he.Top}){const[s,a]=de({pos:n,x1:e,y1:t,x2:r,y2:i}),[u,c]=de({pos:o,x1:r,y1:i,x2:e,y2:t}),[l,h,d,f]=oe({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:s,sourceControlY:a,targetControlX:u,targetControlY:c});return[`M${e},${t} C${s},${a} ${u},${c} ${r},${i}`,l,h,d,f]}!function(e){e.Strict="strict",e.Loose="loose"}(se||(se={})),function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"}(ae||(ae={})),function(e){e.Partial="partial",e.Full="full"}(ue||(ue={})),function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"}(ce||(ce={})),function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"}(le||(le={})),function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"}(he||(he={}));const pe=(0,r.memo)((({sourceX:e,sourceY:t,targetX:n,targetY:i,sourcePosition:o=he.Bottom,targetPosition:s=he.Top,label:a,labelStyle:u,labelShowBg:c,labelBgStyle:l,labelBgPadding:h,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:m,interactionWidth:g})=>{const[v,y,b]=fe({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:i,targetPosition:s});return r.createElement(ne,{path:v,labelX:y,labelY:b,label:a,labelStyle:u,labelShowBg:c,labelBgStyle:l,labelBgPadding:h,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:m,interactionWidth:g})}));pe.displayName="SimpleBezierEdge";const me={[he.Left]:{x:-1,y:0},[he.Right]:{x:1,y:0},[he.Top]:{x:0,y:-1},[he.Bottom]:{x:0,y:1}},ge=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function ve({source:e,sourcePosition:t=he.Bottom,target:n,targetPosition:r=he.Top,center:i,offset:o}){const s=me[t],a=me[r],u={x:e.x+s.x*o,y:e.y+s.y*o},c={x:n.x+a.x*o,y:n.y+a.y*o},l=(({source:e,sourcePosition:t=he.Bottom,target:n})=>t===he.Left||t===he.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1})({source:u,sourcePosition:t,target:c}),h=0!==l.x?"x":"y",d=l[h];let f,p,m=[];const g={x:0,y:0},v={x:0,y:0},[y,b,_,x]=ie({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[h]*a[h]==-1){f=i.x??y,p=i.y??b;const e=[{x:f,y:u.y},{x:f,y:c.y}],t=[{x:u.x,y:p},{x:c.x,y:p}];m=s[h]===d?"x"===h?e:t:"x"===h?t:e}else{const i=[{x:u.x,y:c.y}],l=[{x:c.x,y:u.y}];if(m="x"===h?s.x===d?l:i:s.y===d?i:l,t===r){const t=Math.abs(e[h]-n[h]);if(t<=o){const r=Math.min(o-1,o-t);s[h]===d?g[h]=(u[h]>e[h]?-1:1)*r:v[h]=(c[h]>n[h]?-1:1)*r}}if(t!==r){const e="x"===h?"y":"x",t=s[h]===a[e],n=u[e]>c[e],r=u[e]<c[e];(1===s[h]&&(!t&&n||t&&r)||1!==s[h]&&(!t&&r||t&&n))&&(m="x"===h?i:l)}const y={x:u.x+g.x,y:u.y+g.y},b={x:c.x+v.x,y:c.y+v.y};Math.max(Math.abs(y.x-m[0].x),Math.abs(b.x-m[0].x))>=Math.max(Math.abs(y.y-m[0].y),Math.abs(b.y-m[0].y))?(f=(y.x+b.x)/2,p=m[0].y):(f=m[0].x,p=(y.y+b.y)/2)}return[[e,{x:u.x+g.x,y:u.y+g.y},...m,{x:c.x+v.x,y:c.y+v.y},n],f,p,_,x]}function ye({sourceX:e,sourceY:t,sourcePosition:n=he.Bottom,targetX:r,targetY:i,targetPosition:o=he.Top,borderRadius:s=5,centerX:a,centerY:u,offset:c=20}){const[l,h,d,f,p]=ve({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:i},targetPosition:o,center:{x:a,y:u},offset:c});return[l.reduce(((e,t,n)=>{let r="";return r=n>0&&n<l.length-1?function(e,t,n,r){const i=Math.min(ge(e,t)/2,ge(t,n)/2,r),{x:o,y:s}=t;if(e.x===o&&o===n.x||e.y===s&&s===n.y)return`L${o} ${s}`;if(e.y===s)return`L ${o+i*(e.x<n.x?-1:1)},${s}Q ${o},${s} ${o},${s+i*(e.y<n.y?1:-1)}`;const a=e.x<n.x?1:-1;return`L ${o},${s+i*(e.y<n.y?-1:1)}Q ${o},${s} ${o+i*a},${s}`}(l[n-1],t,l[n+1],s):`${0===n?"M":"L"}${t.x} ${t.y}`,e+=r}),""),h,d,f,p]}const be=(0,r.memo)((({sourceX:e,sourceY:t,targetX:n,targetY:i,label:o,labelStyle:s,labelShowBg:a,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:l,style:h,sourcePosition:d=he.Bottom,targetPosition:f=he.Top,markerEnd:p,markerStart:m,pathOptions:g,interactionWidth:v})=>{const[y,b,_]=ye({sourceX:e,sourceY:t,sourcePosition:d,targetX:n,targetY:i,targetPosition:f,borderRadius:g?.borderRadius,offset:g?.offset});return r.createElement(ne,{path:y,labelX:b,labelY:_,label:o,labelStyle:s,labelShowBg:a,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:l,style:h,markerEnd:p,markerStart:m,interactionWidth:v})}));be.displayName="SmoothStepEdge";const _e=(0,r.memo)((e=>r.createElement(be,{...e,pathOptions:(0,r.useMemo)((()=>({borderRadius:0,offset:e.pathOptions?.offset})),[e.pathOptions?.offset])})));_e.displayName="StepEdge";const xe=(0,r.memo)((({sourceX:e,sourceY:t,targetX:n,targetY:i,label:o,labelStyle:s,labelShowBg:a,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:l,style:h,markerEnd:d,markerStart:f,interactionWidth:p})=>{const[m,g,v]=function({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[i,o,s,a]=ie({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,i,o,s,a]}({sourceX:e,sourceY:t,targetX:n,targetY:i});return r.createElement(ne,{path:m,labelX:g,labelY:v,label:o,labelStyle:s,labelShowBg:a,labelBgStyle:u,labelBgPadding:c,labelBgBorderRadius:l,style:h,markerEnd:d,markerStart:f,interactionWidth:p})}));function we(e,t){return e>=0?.5*e:25*t*Math.sqrt(-e)}function Se({pos:e,x1:t,y1:n,x2:r,y2:i,c:o}){switch(e){case he.Left:return[t-we(t-r,o),n];case he.Right:return[t+we(r-t,o),n];case he.Top:return[t,n-we(n-i,o)];case he.Bottom:return[t,n+we(i-n,o)]}}function Ee({sourceX:e,sourceY:t,sourcePosition:n=he.Bottom,targetX:r,targetY:i,targetPosition:o=he.Top,curvature:s=.25}){const[a,u]=Se({pos:n,x1:e,y1:t,x2:r,y2:i,c:s}),[c,l]=Se({pos:o,x1:r,y1:i,x2:e,y2:t,c:s}),[h,d,f,p]=oe({sourceX:e,sourceY:t,targetX:r,targetY:i,sourceControlX:a,sourceControlY:u,targetControlX:c,targetControlY:l});return[`M${e},${t} C${a},${u} ${c},${l} ${r},${i}`,h,d,f,p]}xe.displayName="StraightEdge";const Te=(0,r.memo)((({sourceX:e,sourceY:t,targetX:n,targetY:i,sourcePosition:o=he.Bottom,targetPosition:s=he.Top,label:a,labelStyle:u,labelShowBg:c,labelBgStyle:l,labelBgPadding:h,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:m,pathOptions:g,interactionWidth:v})=>{const[y,b,_]=Ee({sourceX:e,sourceY:t,sourcePosition:o,targetX:n,targetY:i,targetPosition:s,curvature:g?.curvature});return r.createElement(ne,{path:y,labelX:b,labelY:_,label:a,labelStyle:u,labelShowBg:c,labelBgStyle:l,labelBgPadding:h,labelBgBorderRadius:d,style:f,markerEnd:p,markerStart:m,interactionWidth:v})}));Te.displayName="BezierEdge";const Me=(0,r.createContext)(null),Ae=Me.Provider;Me.Consumer;const Ce=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,Oe=(e,t)=>{if(void 0===e)return"";if("string"==typeof e)return e;return`${t?`${t}__`:""}${Object.keys(e).sort().map((t=>`${t}=${e[t]}`)).join("&")}`},Pe=({x:e,y:t},[n,r,i],o,[s,a])=>{const u={x:(e-n)/i,y:(t-r)/i};return o?{x:s*Math.round(u.x/s),y:a*Math.round(u.y/a)}:u},Re=({x:e,y:t},[n,r,i])=>({x:e*i+n,y:t*i+r}),Ne=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],i={x:e.position.x-n,y:e.position.y-r};return{...i,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:i}},Ie=(e,t=[0,0])=>{if(0===e.length)return{x:0,y:0,width:0,height:0};const n=e.reduce(((e,n)=>{const{x:r,y:i}=Ne(n,t).positionAbsolute;return V(e,G({x:r,y:i,width:n.width||0,height:n.height||0}))}),{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return H(n)},ke=(e,t,[n,r,i]=[0,0,1],o=!1,s=!1,a=[0,0])=>{const u={x:(t.x-n)/i,y:(t.y-r)/i,width:t.width/i,height:t.height/i},c=[];return e.forEach((e=>{const{width:t,height:n,selectable:r=!0,hidden:i=!1}=e;if(s&&!r||i)return!1;const{positionAbsolute:l}=Ne(e,a),h={x:l.x,y:l.y,width:t||0,height:n||0},d=X(u,h);(void 0===t||void 0===n||null===t||null===n||o&&d>0||d>=(t||0)*(n||0)||e.dragging)&&c.push(e)})),c},De=(e,t)=>{const n=e.map((e=>e.id));return t.filter((e=>n.includes(e.source)||n.includes(e.target)))},Le=(e,t,n,r,i,o=.1)=>{const s=t/(e.width*(1+o)),a=n/(e.height*(1+o)),u=Math.min(s,a),c=U(u,r,i);return{x:t/2-(e.x+e.width/2)*c,y:n/2-(e.y+e.height/2)*c,zoom:c}},Ue=(e,t=0)=>e.transition().duration(t);function Fe(e,t,n,r){return(t[n]||[]).reduce(((t,i)=>(`${e.id}-${i.id}-${n}`!==r&&t.push({id:i.id||null,type:n,nodeId:e.id,x:(e.positionAbsolute?.x??0)+i.x+i.width/2,y:(e.positionAbsolute?.y??0)+i.y+i.height/2}),t)),[])}const Be={source:null,target:null,sourceHandle:null,targetHandle:null},ze=()=>({handleDomNode:null,isValid:!1,connection:Be,endHandle:null});function je(e,t,n,r,i,o,s){const a="target"===i,u=s.querySelector(`.react-flow__handle[data-id="${e?.nodeId}-${e?.id}-${e?.type}"]`),c={...ze(),handleDomNode:u};if(u){const e=Ve(void 0,u),i=u.getAttribute("data-nodeid"),s=u.getAttribute("data-handleid"),l=u.classList.contains("connectable"),h=u.classList.contains("connectableend"),d={source:a?i:n,sourceHandle:a?s:r,target:a?n:i,targetHandle:a?r:s};c.connection=d;l&&h&&(t===se.Strict?a&&"source"===e||!a&&"target"===e:i!==n||s!==r)&&(c.endHandle={nodeId:i,handleId:s,type:e},c.isValid=o(d))}return c}function Ve(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function Ge(e){e?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function He(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function We({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:i,getState:o,setState:s,isValidConnection:a,edgeUpdaterType:u,onReconnectEnd:c}){const l=j(e.target),{connectionMode:h,domNode:d,autoPanOnConnect:f,connectionRadius:p,onConnectStart:m,panBy:g,getNodes:v,cancelConnection:y}=o();let b,_=0;const{x:x,y:w}=ee(e),S=l?.elementFromPoint(x,w),E=Ve(u,S),T=d?.getBoundingClientRect();if(!T||!E)return;let M,A=ee(e,T),C=!1,O=null,P=!1,R=null;const N=function({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce(((e,i)=>{if(i[$]){const{handleBounds:o}=i[$];let s=[],a=[];o&&(s=Fe(i,o,"source",`${t}-${n}-${r}`),a=Fe(i,o,"target",`${t}-${n}-${r}`)),e.push(...s,...a)}return e}),[])}({nodes:v(),nodeId:n,handleId:t,handleType:E}),I=()=>{if(!f)return;const[e,t]=z(A,T);g({x:e,y:t}),_=requestAnimationFrame(I)};function k(e){const{transform:r}=o();A=ee(e,T);const{handle:u,validHandleResult:c}=function(e,t,n,r,i,o){const{x:s,y:a}=ee(e),u=t.elementsFromPoint(s,a).find((e=>e.classList.contains("react-flow__handle")));if(u){const e=u.getAttribute("data-nodeid");if(e){const t=Ve(void 0,u),r=u.getAttribute("data-handleid"),s=o({nodeId:e,id:r,type:t});if(s){const o=i.find((n=>n.nodeId===e&&n.type===t&&n.id===r));return{handle:{id:r,type:t,nodeId:e,x:o?.x||n.x,y:o?.y||n.y},validHandleResult:s}}}}let c=[],l=1/0;if(i.forEach((e=>{const t=Math.sqrt((e.x-n.x)**2+(e.y-n.y)**2);if(t<=r){const n=o(e);t<=l&&(t<l?c=[{handle:e,validHandleResult:n}]:t===l&&c.push({handle:e,validHandleResult:n}),l=t)}})),!c.length)return{handle:null,validHandleResult:ze()};if(1===c.length)return c[0];const h=c.some((({validHandleResult:e})=>e.isValid)),d=c.some((({handle:e})=>"target"===e.type));return c.find((({handle:e,validHandleResult:t})=>d?"target"===e.type:!h||t.isValid))||c[0]}(e,l,Pe(A,r,!1,[1,1]),p,N,(e=>je(e,h,n,t,i?"target":"source",a,l)));if(b=u,C||(I(),C=!0),R=c.handleDomNode,O=c.connection,P=c.isValid,s({connectionPosition:b&&P?Re({x:b.x,y:b.y},r):A,connectionStatus:He(!!b,P),connectionEndHandle:c.endHandle}),!b&&!P&&!R)return Ge(M);O.source!==O.target&&R&&(Ge(M),M=R,R.classList.add("connecting","react-flow__handle-connecting"),R.classList.toggle("valid",P),R.classList.toggle("react-flow__handle-valid",P))}function D(e){(b||R)&&O&&P&&r?.(O),o().onConnectEnd?.(e),u&&c?.(e),Ge(M),y(),cancelAnimationFrame(_),C=!1,P=!1,O=null,R=null,l.removeEventListener("mousemove",k),l.removeEventListener("mouseup",D),l.removeEventListener("touchmove",k),l.removeEventListener("touchend",D)}s({connectionPosition:A,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:E,connectionStartHandle:{nodeId:n,handleId:t,type:E},connectionEndHandle:null}),m?.(e,{nodeId:n,handleId:t,handleType:E}),l.addEventListener("mousemove",k),l.addEventListener("mouseup",D),l.addEventListener("touchmove",k),l.addEventListener("touchend",D)}const qe=()=>!0,Xe=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),Ze=(0,r.forwardRef)((({type:e="source",position:t=he.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:a=!0,id:u,onConnect:c,children:l,className:h,onMouseDown:f,onTouchStart:p,...m},g)=>{const v=u||null,y="target"===e,b=R(),_=(0,r.useContext)(Me),{connectOnClick:x,noPanClassName:w}=P(Xe,d.X),{connecting:E,clickConnecting:T}=P(((e,t,n)=>r=>{const{connectionStartHandle:i,connectionEndHandle:o,connectionClickStartHandle:s}=r;return{connecting:i?.nodeId===e&&i?.handleId===t&&i?.type===n||o?.nodeId===e&&o?.handleId===t&&o?.type===n,clickConnecting:s?.nodeId===e&&s?.handleId===t&&s?.type===n}})(_,v,e),d.X);_||b.getState().onError?.("010",M());const A=e=>{const{defaultEdgeOptions:t,onConnect:n,hasDefaultEdges:r}=b.getState(),i={...t,...e};if(r){const{edges:e,setEdges:t}=b.getState();t(((e,t)=>{if(!e.source||!e.target)return K(0,S()),t;let n;var r;return n="id"in(r=e)&&"source"in r&&"target"in r?{...e}:{...e,id:Ce(e)},((e,t)=>t.some((t=>!(t.source!==e.source||t.target!==e.target||t.sourceHandle!==e.sourceHandle&&(t.sourceHandle||e.sourceHandle)||t.targetHandle!==e.targetHandle&&(t.targetHandle||e.targetHandle)))))(n,t)?t:t.concat(n)})(i,e))}n?.(i),c?.(i)},C=e=>{if(!_)return;const t=J(e);s&&(t&&0===e.button||!t)&&We({event:e,handleId:v,nodeId:_,onConnect:A,isTarget:y,getState:b.getState,setState:b.setState,isValidConnection:n||b.getState().isValidConnection||qe}),t?f?.(e):p?.(e)};return r.createElement("div",{"data-handleid":v,"data-nodeid":_,"data-handlepos":t,"data-id":`${_}-${v}-${e}`,className:(0,i.Z)(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",w,h,{source:!y,target:y,connectable:o,connectablestart:s,connectableend:a,connecting:T,connectionindicator:o&&(s&&!E||a&&E)}]),onMouseDown:C,onTouchStart:C,onClick:x?t=>{const{onClickConnectStart:r,onClickConnectEnd:i,connectionClickStartHandle:o,connectionMode:a,isValidConnection:u}=b.getState();if(!_||!o&&!s)return;if(!o)return r?.(t,{nodeId:_,handleId:v,handleType:e}),void b.setState({connectionClickStartHandle:{nodeId:_,type:e,handleId:v}});const c=j(t.target),l=n||u||qe,{connection:h,isValid:d}=je({nodeId:_,id:v,type:e},a,o.nodeId,o.handleId||null,o.type,l,c);d&&A(h),i?.(t),b.setState({connectionClickStartHandle:null})}:void 0,ref:g,...m},l)}));Ze.displayName="Handle";var $e=(0,r.memo)(Ze);const Ye=({data:e,isConnectable:t,targetPosition:n=he.Top,sourcePosition:i=he.Bottom})=>r.createElement(r.Fragment,null,r.createElement($e,{type:"target",position:n,isConnectable:t}),e?.label,r.createElement($e,{type:"source",position:i,isConnectable:t}));Ye.displayName="DefaultNode";var Ke=(0,r.memo)(Ye);const Qe=({data:e,isConnectable:t,sourcePosition:n=he.Bottom})=>r.createElement(r.Fragment,null,e?.label,r.createElement($e,{type:"source",position:n,isConnectable:t}));Qe.displayName="InputNode";var Je=(0,r.memo)(Qe);const et=({data:e,isConnectable:t,targetPosition:n=he.Top})=>r.createElement(r.Fragment,null,r.createElement($e,{type:"target",position:n,isConnectable:t}),e?.label);et.displayName="OutputNode";var tt=(0,r.memo)(et);const nt=()=>null;nt.displayName="GroupNode";const rt=e=>({selectedNodes:e.getNodes().filter((e=>e.selected)),selectedEdges:e.edges.filter((e=>e.selected)).map((e=>({...e})))}),it=e=>e.id;function ot(e,t){return(0,d.X)(e.selectedNodes.map(it),t.selectedNodes.map(it))&&(0,d.X)(e.selectedEdges.map(it),t.selectedEdges.map(it))}const st=(0,r.memo)((({onSelectionChange:e})=>{const t=R(),{selectedNodes:n,selectedEdges:i}=P(rt,ot);return(0,r.useEffect)((()=>{const r={nodes:n,edges:i};e?.(r),t.getState().onSelectionChange.forEach((e=>e(r)))}),[n,i,e]),null}));st.displayName="SelectionListener";const at=e=>!!e.onSelectionChange;function ut({onSelectionChange:e}){const t=P(at);return e||t?r.createElement(st,{onSelectionChange:e}):null}const ct=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function lt(e,t){(0,r.useEffect)((()=>{void 0!==e&&t(e)}),[e])}function ht(e,t,n){(0,r.useEffect)((()=>{void 0!==t&&n({[e]:t})}),[t])}const dt=({nodes:e,edges:t,defaultNodes:n,defaultEdges:i,onConnect:o,onConnectStart:s,onConnectEnd:a,onClickConnectStart:u,onClickConnectEnd:c,nodesDraggable:l,nodesConnectable:h,nodesFocusable:f,edgesFocusable:p,edgesUpdatable:m,elevateNodesOnSelect:g,minZoom:v,maxZoom:y,nodeExtent:b,onNodesChange:_,onEdgesChange:x,elementsSelectable:w,connectionMode:S,snapGrid:E,snapToGrid:T,translateExtent:M,connectOnClick:A,defaultEdgeOptions:C,fitView:O,fitViewOptions:N,onNodesDelete:I,onEdgesDelete:k,onNodeDrag:D,onNodeDragStart:L,onNodeDragStop:U,onSelectionDrag:F,onSelectionDragStart:B,onSelectionDragStop:z,noPanClassName:j,nodeOrigin:V,rfId:G,autoPanOnConnect:H,autoPanOnNodeDrag:W,onError:q,connectionRadius:X,isValidConnection:Z,nodeDragThreshold:$})=>{const{setNodes:Y,setEdges:K,setDefaultNodesAndEdges:Q,setMinZoom:J,setMaxZoom:ee,setTranslateExtent:te,setNodeExtent:ne,reset:re}=P(ct,d.X),ie=R();return(0,r.useEffect)((()=>{const e=i?.map((e=>({...e,...C})));return Q(n,e),()=>{re()}}),[]),ht("defaultEdgeOptions",C,ie.setState),ht("connectionMode",S,ie.setState),ht("onConnect",o,ie.setState),ht("onConnectStart",s,ie.setState),ht("onConnectEnd",a,ie.setState),ht("onClickConnectStart",u,ie.setState),ht("onClickConnectEnd",c,ie.setState),ht("nodesDraggable",l,ie.setState),ht("nodesConnectable",h,ie.setState),ht("nodesFocusable",f,ie.setState),ht("edgesFocusable",p,ie.setState),ht("edgesUpdatable",m,ie.setState),ht("elementsSelectable",w,ie.setState),ht("elevateNodesOnSelect",g,ie.setState),ht("snapToGrid",T,ie.setState),ht("snapGrid",E,ie.setState),ht("onNodesChange",_,ie.setState),ht("onEdgesChange",x,ie.setState),ht("connectOnClick",A,ie.setState),ht("fitViewOnInit",O,ie.setState),ht("fitViewOnInitOptions",N,ie.setState),ht("onNodesDelete",I,ie.setState),ht("onEdgesDelete",k,ie.setState),ht("onNodeDrag",D,ie.setState),ht("onNodeDragStart",L,ie.setState),ht("onNodeDragStop",U,ie.setState),ht("onSelectionDrag",F,ie.setState),ht("onSelectionDragStart",B,ie.setState),ht("onSelectionDragStop",z,ie.setState),ht("noPanClassName",j,ie.setState),ht("nodeOrigin",V,ie.setState),ht("rfId",G,ie.setState),ht("autoPanOnConnect",H,ie.setState),ht("autoPanOnNodeDrag",W,ie.setState),ht("onError",q,ie.setState),ht("connectionRadius",X,ie.setState),ht("isValidConnection",Z,ie.setState),ht("nodeDragThreshold",$,ie.setState),lt(e,Y),lt(t,K),lt(v,J),lt(y,ee),lt(M,te),lt(b,ne),null},ft={display:"none"},pt={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},mt="react-flow__node-desc",gt="react-flow__edge-desc",vt=e=>e.ariaLiveMessage;function yt({rfId:e}){const t=P(vt);return r.createElement("div",{id:`react-flow__aria-live-${e}`,"aria-live":"assertive","aria-atomic":"true",style:pt},t)}function bt({rfId:e,disableKeyboardA11y:t}){return r.createElement(r.Fragment,null,r.createElement("div",{id:`${mt}-${e}`,style:ft},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),r.createElement("div",{id:`${gt}-${e}`,style:ft},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&r.createElement(yt,{rfId:e}))}var _t=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,i]=(0,r.useState)(!1),o=(0,r.useRef)(!1),s=(0,r.useRef)(new Set([])),[a,u]=(0,r.useMemo)((()=>{if(null!==e){const t=(Array.isArray(e)?e:[e]).filter((e=>"string"==typeof e)).map((e=>e.split("+"))),n=t.reduce(((e,t)=>e.concat(...t)),[]);return[t,n]}return[[],[]]}),[e]);return(0,r.useEffect)((()=>{const n="undefined"!=typeof document?document:null,r=t?.target||n;if(null!==e){const e=e=>{o.current=e.ctrlKey||e.metaKey||e.shiftKey;if((!o.current||o.current&&!t.actInsideInputWithModifier)&&Q(e))return!1;const n=wt(e.code,u);s.current.add(e[n]),xt(a,s.current,!1)&&(e.preventDefault(),i(!0))},n=e=>{if((!o.current||o.current&&!t.actInsideInputWithModifier)&&Q(e))return!1;const n=wt(e.code,u);xt(a,s.current,!0)?(i(!1),s.current.clear()):s.current.delete(e[n]),"Meta"===e.key&&s.current.clear(),o.current=!1},c=()=>{s.current.clear(),i(!1)};return r?.addEventListener("keydown",e),r?.addEventListener("keyup",n),window.addEventListener("blur",c),()=>{r?.removeEventListener("keydown",e),r?.removeEventListener("keyup",n),window.removeEventListener("blur",c)}}}),[e,i]),n};function xt(e,t,n){return e.filter((e=>n||e.length===t.size)).some((e=>e.every((e=>t.has(e)))))}function wt(e,t){return t.includes(e)?"code":"key"}function St(e,t,n,r){const i=e.parentNode||e.parentId;if(!i)return n;const o=t.get(i),s=Ne(o,r);return St(o,t,{x:(n.x??0)+s.x,y:(n.y??0)+s.y,z:(o[$]?.z??0)>(n.z??0)?o[$]?.z??0:n.z??0},r)}function Et(e,t,n){e.forEach((r=>{const i=r.parentNode||r.parentId;if(i&&!e.has(i))throw new Error(`Parent node ${i} not found`);if(i||n?.[r.id]){const{x:i,y:o,z:s}=St(r,e,{...r.position,z:r[$]?.z??0},t);r.positionAbsolute={x:i,y:o},r[$].z=s,n?.[r.id]&&(r[$].isParent=!0)}}))}function Tt(e,t,n,r){const i=new Map,o={},s=r?1e3:0;return e.forEach((e=>{const n=(Z(e.zIndex)?e.zIndex:0)+(e.selected?s:0),r=t.get(e.id),a={...e,positionAbsolute:{x:e.position.x,y:e.position.y}},u=e.parentNode||e.parentId;u&&(o[u]=!0);const c=r?.type&&r?.type!==e.type;Object.defineProperty(a,$,{enumerable:!1,value:{handleBounds:c?void 0:r?.[$]?.handleBounds,z:n}}),i.set(e.id,a)})),Et(i,n,o),i}function Mt(e,t={}){const{getNodes:n,width:r,height:i,minZoom:o,maxZoom:s,d3Zoom:a,d3Selection:u,fitViewOnInitDone:c,fitViewOnInit:l,nodeOrigin:h}=e(),d=t.initial&&!c&&l;if(a&&u&&(d||!t.initial)){const e=n().filter((e=>{const n=t.includeHiddenNodes?e.width&&e.height:!e.hidden;return t.nodes?.length?n&&t.nodes.some((t=>t.id===e.id)):n})),c=e.every((e=>e.width&&e.height));if(e.length>0&&c){const n=Ie(e,h),{x:c,y:l,zoom:d}=Le(n,r,i,t.minZoom??o,t.maxZoom??s,t.padding??.1),p=f.CR.translate(c,l).scale(d);return"number"==typeof t.duration&&t.duration>0?a.transform(Ue(u,t.duration),p):a.transform(u,p),!0}}return!1}function At(e,t){return e.forEach((e=>{const n=t.get(e.id);n&&t.set(n.id,{...n,[$]:n[$],selected:e.selected})})),new Map(t)}function Ct(e,t){return t.map((t=>{const n=e.find((e=>e.id===t.id));return n&&(t.selected=n.selected),t}))}function Ot({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:i,edges:o,onNodesChange:s,onEdgesChange:a,hasDefaultNodes:u,hasDefaultEdges:c}=n();e?.length&&(u&&r({nodeInternals:At(e,i)}),s?.(e)),t?.length&&(c&&r({edges:Ct(t,o)}),a?.(t))}const Pt=()=>{},Rt={zoomIn:Pt,zoomOut:Pt,zoomTo:Pt,getZoom:()=>1,setViewport:Pt,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Pt,fitBounds:Pt,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},Nt=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection});function It(){const e=(()=>{const e=R(),{d3Zoom:t,d3Selection:n}=P(Nt,d.X);return(0,r.useMemo)((()=>n&&t?{zoomIn:e=>t.scaleBy(Ue(n,e?.duration),1.2),zoomOut:e=>t.scaleBy(Ue(n,e?.duration),1/1.2),zoomTo:(e,r)=>t.scaleTo(Ue(n,r?.duration),e),getZoom:()=>e.getState().transform[2],setViewport:(r,i)=>{const[o,s,a]=e.getState().transform,u=f.CR.translate(r.x??o,r.y??s).scale(r.zoom??a);t.transform(Ue(n,i?.duration),u)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},fitView:t=>Mt(e.getState,t),setCenter:(r,i,o)=>{const{width:s,height:a,maxZoom:u}=e.getState(),c=void 0!==o?.zoom?o.zoom:u,l=s/2-r*c,h=a/2-i*c,d=f.CR.translate(l,h).scale(c);t.transform(Ue(n,o?.duration),d)},fitBounds:(r,i)=>{const{width:o,height:s,minZoom:a,maxZoom:u}=e.getState(),{x:c,y:l,zoom:h}=Le(r,o,s,a,u,i?.padding??.1),d=f.CR.translate(c,l).scale(h);t.transform(Ue(n,i?.duration),d)},project:t=>{const{transform:n,snapToGrid:r,snapGrid:i}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Pe(t,n,r,i)},screenToFlowPosition:t=>{const{transform:n,snapToGrid:r,snapGrid:i,domNode:o}=e.getState();if(!o)return t;const{x:s,y:a}=o.getBoundingClientRect(),u={x:t.x-s,y:t.y-a};return Pe(u,n,r,i)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:i,y:o}=r.getBoundingClientRect(),s=Re(t,n);return{x:s.x+i,y:s.y+o}},viewportInitialized:!0}:Rt),[t,n])})(),t=R(),n=(0,r.useCallback)((()=>t.getState().getNodes().map((e=>({...e})))),[]),i=(0,r.useCallback)((e=>t.getState().nodeInternals.get(e)),[]),o=(0,r.useCallback)((()=>{const{edges:e=[]}=t.getState();return e.map((e=>({...e})))}),[]),s=(0,r.useCallback)((e=>{const{edges:n=[]}=t.getState();return n.find((t=>t.id===e))}),[]),a=(0,r.useCallback)((e=>{const{getNodes:n,setNodes:r,hasDefaultNodes:i,onNodesChange:o}=t.getState(),s=n(),a="function"==typeof e?e(s):e;if(i)r(a);else if(o){o(0===a.length?s.map((e=>({type:"remove",id:e.id}))):a.map((e=>({item:e,type:"reset"}))))}}),[]),u=(0,r.useCallback)((e=>{const{edges:n=[],setEdges:r,hasDefaultEdges:i,onEdgesChange:o}=t.getState(),s="function"==typeof e?e(n):e;if(i)r(s);else if(o){o(0===s.length?n.map((e=>({type:"remove",id:e.id}))):s.map((e=>({item:e,type:"reset"}))))}}),[]),c=(0,r.useCallback)((e=>{const n=Array.isArray(e)?e:[e],{getNodes:r,setNodes:i,hasDefaultNodes:o,onNodesChange:s}=t.getState();if(o){i([...r(),...n])}else if(s){s(n.map((e=>({item:e,type:"add"}))))}}),[]),l=(0,r.useCallback)((e=>{const n=Array.isArray(e)?e:[e],{edges:r=[],setEdges:i,hasDefaultEdges:o,onEdgesChange:s}=t.getState();if(o)i([...r,...n]);else if(s){s(n.map((e=>({item:e,type:"add"}))))}}),[]),h=(0,r.useCallback)((()=>{const{getNodes:e,edges:n=[],transform:r}=t.getState(),[i,o,s]=r;return{nodes:e().map((e=>({...e}))),edges:n.map((e=>({...e}))),viewport:{x:i,y:o,zoom:s}}}),[]),p=(0,r.useCallback)((({nodes:e,edges:n})=>{const{nodeInternals:r,getNodes:i,edges:o,hasDefaultNodes:s,hasDefaultEdges:a,onNodesDelete:u,onEdgesDelete:c,onNodesChange:l,onEdgesChange:h}=t.getState(),d=(e||[]).map((e=>e.id)),f=(n||[]).map((e=>e.id)),p=i().reduce(((e,t)=>{const n=t.parentNode||t.parentId,r=!d.includes(t.id)&&n&&e.find((e=>e.id===n));return("boolean"!=typeof t.deletable||t.deletable)&&(d.includes(t.id)||r)&&e.push(t),e}),[]),m=o.filter((e=>"boolean"!=typeof e.deletable||e.deletable)),g=m.filter((e=>f.includes(e.id)));if(p||g){const e=De(p,m),n=[...g,...e],i=n.reduce(((e,t)=>(e.includes(t.id)||e.push(t.id),e)),[]);if((a||s)&&(a&&t.setState({edges:o.filter((e=>!i.includes(e.id)))}),s&&(p.forEach((e=>{r.delete(e.id)})),t.setState({nodeInternals:new Map(r)}))),i.length>0&&(c?.(n),h&&h(i.map((e=>({id:e,type:"remove"}))))),p.length>0&&(u?.(p),l)){l(p.map((e=>({id:e.id,type:"remove"}))))}}}),[]),m=(0,r.useCallback)((e=>{const n=Z((r=e).width)&&Z(r.height)&&Z(r.x)&&Z(r.y);var r;const i=n?null:t.getState().nodeInternals.get(e.id);if(!n&&!i)return[null,null,n];return[n?e:W(i),i,n]}),[]),g=(0,r.useCallback)(((e,n=!0,r)=>{const[i,o,s]=m(e);return i?(r||t.getState().getNodes()).filter((e=>{if(!(s||e.id!==o.id&&e.positionAbsolute))return!1;const t=W(e),r=X(t,i);return n&&r>0||r>=i.width*i.height})):[]}),[]),v=(0,r.useCallback)(((e,t,n=!0)=>{const[r]=m(e);if(!r)return!1;const i=X(r,t);return n&&i>0||i>=r.width*r.height}),[]);return(0,r.useMemo)((()=>({...e,getNodes:n,getNode:i,getEdges:o,getEdge:s,setNodes:a,setEdges:u,addNodes:c,addEdges:l,toObject:h,deleteElements:p,getIntersectingNodes:g,isNodeIntersecting:v})),[e,n,i,o,s,a,u,c,l,h,p,g,v])}const kt={actInsideInputWithModifier:!1};const Dt={position:"absolute",width:"100%",height:"100%",top:0,left:0},Lt=e=>({x:e.x,y:e.y,zoom:e.k}),Ut=(e,t)=>e.target.closest(`.${t}`),Ft=(e,t)=>2===t&&Array.isArray(e)&&e.includes(2),Bt=e=>{const t=e.ctrlKey&&te()?10:1;return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*t},zt=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),jt=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:i,zoomOnScroll:o=!0,zoomOnPinch:s=!0,panOnScroll:a=!1,panOnScrollSpeed:u=.5,panOnScrollMode:c=ae.Free,zoomOnDoubleClick:l=!0,elementsSelectable:h,panOnDrag:g=!0,defaultViewport:v,translateExtent:y,minZoom:b,maxZoom:_,zoomActivationKeyCode:w,preventScrolling:S=!0,children:E,noWheelClassName:T,noPanClassName:M})=>{const A=(0,r.useRef)(),C=R(),O=(0,r.useRef)(!1),N=(0,r.useRef)(!1),I=(0,r.useRef)(null),k=(0,r.useRef)({x:0,y:0,zoom:0}),{d3Zoom:D,d3Selection:F,d3ZoomHandler:B,userSelectionActive:z}=P(zt,d.X),j=_t(w),V=(0,r.useRef)(0),G=(0,r.useRef)(!1),H=(0,r.useRef)();return function(e){const t=R();(0,r.useEffect)((()=>{let n;const r=()=>{if(!e.current)return;const n=L(e.current);0!==n.height&&0!==n.width||t.getState().onError?.("004",x()),t.setState({width:n.width||500,height:n.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver((()=>r())),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}}),[])}(I),(0,r.useEffect)((()=>{if(I.current){const e=I.current.getBoundingClientRect(),t=(0,f.sP)().scaleExtent([b,_]).translateExtent(y),n=(0,p.Z)(I.current).call(t),r=f.CR.translate(v.x,v.y).scale(U(v.zoom,b,_)),i=[[0,0],[e.width,e.height]],o=t.constrain()(r,i,y);t.transform(n,o),t.wheelDelta(Bt),C.setState({d3Zoom:t,d3Selection:n,d3ZoomHandler:n.on("wheel.zoom"),transform:[o.x,o.y,o.k],domNode:I.current.closest(".react-flow")})}}),[]),(0,r.useEffect)((()=>{F&&D&&(!a||j||z?void 0!==B&&F.on("wheel.zoom",(function(e,t){if(!S&&"wheel"===e.type&&!e.ctrlKey||Ut(e,T))return null;e.preventDefault(),B.call(this,e,t)}),{passive:!1}):F.on("wheel.zoom",(r=>{if(Ut(r,T))return!1;r.preventDefault(),r.stopImmediatePropagation();const i=F.property("__zoom").k||1;if(r.ctrlKey&&s){const e=(0,m.Z)(r),t=Bt(r),n=i*Math.pow(2,t);return void D.scaleTo(F,n,e,r)}const o=1===r.deltaMode?20:1;let a=c===ae.Vertical?0:r.deltaX*o,l=c===ae.Horizontal?0:r.deltaY*o;!te()&&r.shiftKey&&c!==ae.Vertical&&(a=r.deltaY*o,l=0),D.translateBy(F,-a/i*u,-l/i*u,{internal:!0});const h=Lt(F.property("__zoom")),{onViewportChangeStart:d,onViewportChange:f,onViewportChangeEnd:p}=C.getState();clearTimeout(H.current),G.current||(G.current=!0,t?.(r,h),d?.(h)),G.current&&(e?.(r,h),f?.(h),H.current=setTimeout((()=>{n?.(r,h),p?.(h),G.current=!1}),150))}),{passive:!1}))}),[z,a,c,F,D,B,j,s,S,T,t,e,n]),(0,r.useEffect)((()=>{D&&D.on("start",(e=>{if(!e.sourceEvent||e.sourceEvent.internal)return null;V.current=e.sourceEvent?.button;const{onViewportChangeStart:n}=C.getState(),r=Lt(e.transform);O.current=!0,k.current=r,"mousedown"===e.sourceEvent?.type&&C.setState({paneDragging:!0}),n?.(r),t?.(e.sourceEvent,r)}))}),[D,t]),(0,r.useEffect)((()=>{D&&(z&&!O.current?D.on("zoom",null):z||D.on("zoom",(t=>{const{onViewportChange:n}=C.getState();if(C.setState({transform:[t.transform.x,t.transform.y,t.transform.k]}),N.current=!(!i||!Ft(g,V.current??0)),(e||n)&&!t.sourceEvent?.internal){const r=Lt(t.transform);n?.(r),e?.(t.sourceEvent,r)}})))}),[z,D,e,g,i]),(0,r.useEffect)((()=>{D&&D.on("end",(e=>{if(!e.sourceEvent||e.sourceEvent.internal)return null;const{onViewportChangeEnd:t}=C.getState();if(O.current=!1,C.setState({paneDragging:!1}),i&&Ft(g,V.current??0)&&!N.current&&i(e.sourceEvent),N.current=!1,(n||t)&&(r=k.current,o=e.transform,r.x!==o.x||r.y!==o.y||r.zoom!==o.k)){const r=Lt(e.transform);k.current=r,clearTimeout(A.current),A.current=setTimeout((()=>{t?.(r),n?.(e.sourceEvent,r)}),a?150:0)}var r,o}))}),[D,a,g,n,i]),(0,r.useEffect)((()=>{D&&D.filter((e=>{const t=j||o,n=s&&e.ctrlKey;if((!0===g||Array.isArray(g)&&g.includes(1))&&1===e.button&&"mousedown"===e.type&&(Ut(e,"react-flow__node")||Ut(e,"react-flow__edge")))return!0;if(!(g||t||a||l||s))return!1;if(z)return!1;if(!l&&"dblclick"===e.type)return!1;if(Ut(e,T)&&"wheel"===e.type)return!1;if(Ut(e,M)&&("wheel"!==e.type||a&&"wheel"===e.type&&!j))return!1;if(!s&&e.ctrlKey&&"wheel"===e.type)return!1;if(!t&&!a&&!n&&"wheel"===e.type)return!1;if(!g&&("mousedown"===e.type||"touchstart"===e.type))return!1;if(Array.isArray(g)&&!g.includes(e.button)&&"mousedown"===e.type)return!1;const r=Array.isArray(g)&&g.includes(e.button)||!e.button||e.button<=1;return(!e.ctrlKey||"wheel"===e.type)&&r}))}),[z,D,o,s,a,l,g,h,j]),r.createElement("div",{className:"react-flow__renderer",ref:I,style:Dt},E)},Vt=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Gt(){const{userSelectionActive:e,userSelectionRect:t}=P(Vt,d.X);return e&&t?r.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function Ht(e,t){const n=t.parentNode||t.parentId,r=e.find((e=>e.id===n));if(r){const e=t.position.x+t.width-r.width,n=t.position.y+t.height-r.height;if(e>0||n>0||t.position.x<0||t.position.y<0){if(r.style={...r.style}||{},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,e>0&&(r.style.width+=e),n>0&&(r.style.height+=n),t.position.x<0){const e=Math.abs(t.position.x);r.position.x=r.position.x-e,r.style.width+=e,t.position.x=0}if(t.position.y<0){const e=Math.abs(t.position.y);r.position.y=r.position.y-e,r.style.height+=e,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function Wt(e,t){if(e.some((e=>"reset"===e.type)))return e.filter((e=>"reset"===e.type)).map((e=>e.item));const n=e.filter((e=>"add"===e.type)).map((e=>e.item));return t.reduce(((t,n)=>{const r=e.filter((e=>e.id===n.id));if(0===r.length)return t.push(n),t;const i={...n};for(const e of r)if(e)switch(e.type){case"select":i.selected=e.selected;break;case"position":void 0!==e.position&&(i.position=e.position),void 0!==e.positionAbsolute&&(i.positionAbsolute=e.positionAbsolute),void 0!==e.dragging&&(i.dragging=e.dragging),i.expandParent&&Ht(t,i);break;case"dimensions":void 0!==e.dimensions&&(i.width=e.dimensions.width,i.height=e.dimensions.height),void 0!==e.updateStyle&&(i.style={...i.style||{},...e.dimensions}),"boolean"==typeof e.resizing&&(i.resizing=e.resizing),i.expandParent&&Ht(t,i);break;case"remove":return t}return t.push(i),t}),n)}function qt(e,t){return Wt(e,t)}function Xt(e,t){return Wt(e,t)}const Zt=(e,t)=>({id:e,type:"select",selected:t});function $t(e,t){return e.reduce(((e,n)=>{const r=t.includes(n.id);return!n.selected&&r?(n.selected=!0,e.push(Zt(n.id,!0))):n.selected&&!r&&(n.selected=!1,e.push(Zt(n.id,!1))),e}),[])}const Yt=(e,t)=>n=>{n.target===t.current&&e?.(n)},Kt=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Qt=(0,r.memo)((({isSelecting:e,selectionMode:t=ue.Full,panOnDrag:n,onSelectionStart:o,onSelectionEnd:s,onPaneClick:a,onPaneContextMenu:u,onPaneScroll:c,onPaneMouseEnter:l,onPaneMouseMove:h,onPaneMouseLeave:f,children:p})=>{const m=(0,r.useRef)(null),g=R(),v=(0,r.useRef)(0),y=(0,r.useRef)(0),b=(0,r.useRef)(),{userSelectionActive:_,elementsSelectable:x,dragging:w}=P(Kt,d.X),S=()=>{g.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,y.current=0},E=e=>{a?.(e),g.getState().resetSelectedElements(),g.setState({nodesSelectionActive:!1})},T=c?e=>c(e):void 0,M=x&&(e||_);return r.createElement("div",{className:(0,i.Z)(["react-flow__pane",{dragging:w,selection:e}]),onClick:M?void 0:Yt(E,m),onContextMenu:Yt((e=>{Array.isArray(n)&&n?.includes(2)?e.preventDefault():u?.(e)}),m),onWheel:Yt(T,m),onMouseEnter:M?void 0:l,onMouseDown:M?t=>{const{resetSelectedElements:n,domNode:r}=g.getState();if(b.current=r?.getBoundingClientRect(),!x||!e||0!==t.button||t.target!==m.current||!b.current)return;const{x:i,y:s}=ee(t,b.current);n(),g.setState({userSelectionRect:{width:0,height:0,startX:i,startY:s,x:i,y:s}}),o?.(t)}:void 0,onMouseMove:M?n=>{const{userSelectionRect:r,nodeInternals:i,edges:o,transform:s,onNodesChange:a,onEdgesChange:u,nodeOrigin:c,getNodes:l}=g.getState();if(!e||!b.current||!r)return;g.setState({userSelectionActive:!0,nodesSelectionActive:!1});const h=ee(n,b.current),d=r.startX??0,f=r.startY??0,p={...r,x:h.x<d?h.x:d,y:h.y<f?h.y:f,width:Math.abs(h.x-d),height:Math.abs(h.y-f)},m=l(),_=ke(i,p,s,t===ue.Partial,!0,c),x=De(_,o).map((e=>e.id)),w=_.map((e=>e.id));if(v.current!==w.length){v.current=w.length;const e=$t(m,w);e.length&&a?.(e)}if(y.current!==x.length){y.current=x.length;const e=$t(o,x);e.length&&u?.(e)}g.setState({userSelectionRect:p})}:h,onMouseUp:M?e=>{if(0!==e.button)return;const{userSelectionRect:t}=g.getState();!_&&t&&e.target===m.current&&E?.(e),g.setState({nodesSelectionActive:v.current>0}),S(),s?.(e)}:void 0,onMouseLeave:M?e=>{_&&(g.setState({nodesSelectionActive:v.current>0}),s?.(e)),S()}:f,ref:m,style:Dt},p,r.createElement(Gt,null))}));function Jt(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return!!r&&(!!r.selected||Jt(r,t))}function en(e,t,n){let r=e;do{if(r?.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function tn(e,t,n,r){return Array.from(e.values()).filter((n=>(n.selected||n.id===r)&&(!n.parentNode||n.parentId||!Jt(n,e))&&(n.draggable||t&&void 0===n.draggable))).map((e=>({id:e.id,position:e.position||{x:0,y:0},positionAbsolute:e.positionAbsolute||{x:0,y:0},distance:{x:n.x-(e.positionAbsolute?.x??0),y:n.y-(e.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:e.extent,parentNode:e.parentNode||e.parentId,parentId:e.parentNode||e.parentId,width:e.width,height:e.height,expandParent:e.expandParent})))}function nn(e,t,n,r,i=[0,0],o){const s=function(e,t){return t&&"parent"!==t?[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]:t}(e,e.extent||r);let a=s;const u=e.parentNode||e.parentId;if("parent"!==e.extent||e.expandParent){if(e.extent&&u&&"parent"!==e.extent){const t=n.get(u),{x:r,y:o}=Ne(t,i).positionAbsolute;a=[[e.extent[0][0]+r,e.extent[0][1]+o],[e.extent[1][0]+r,e.extent[1][1]+o]]}}else if(u&&e.width&&e.height){const t=n.get(u),{x:r,y:o}=Ne(t,i).positionAbsolute;a=t&&Z(r)&&Z(o)&&Z(t.width)&&Z(t.height)?[[r+e.width*i[0],o+e.height*i[1]],[r+t.width-e.width+e.width*i[0],o+t.height-e.height+e.height*i[1]]]:a}else o?.("005",w()),a=s;let c={x:0,y:0};if(u){const e=n.get(u);c=Ne(e,i).positionAbsolute}const l=a&&"parent"!==a?F(t,a):t;return{position:{x:l.x-c.x,y:l.y-c.y},positionAbsolute:l}}function rn({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map((e=>({...n.get(e.id),position:e.position,positionAbsolute:e.positionAbsolute})));return[e?r.find((t=>t.id===e)):r[0],r]}Qt.displayName="Pane";const on=(e,t,n,r)=>{const i=t.querySelectorAll(e);if(!i||!i.length)return null;const o=Array.from(i),s=t.getBoundingClientRect(),a=s.width*r[0],u=s.height*r[1];return o.map((e=>{const t=e.getBoundingClientRect();return{id:e.getAttribute("data-handleid"),position:e.getAttribute("data-handlepos"),x:(t.left-s.left-a)/n,y:(t.top-s.top-u)/n,...L(e)}}))};function sn(e,t,n){return void 0===n?n:r=>{const i=t().nodeInternals.get(e);i&&n(r,{...i})}}function an({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:i,unselectNodesAndEdges:o,multiSelectionActive:s,nodeInternals:a,onError:u}=t.getState(),c=a.get(e);c?(t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&s)&&(o({nodes:[c],edges:[]}),requestAnimationFrame((()=>r?.current?.blur()))):i([e])):u?.("012",C(e))}function un(e){return(t,n,r)=>e?.(t,r)}function cn({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:i,nodeId:o,isSelectable:s,selectNodesOnDrag:a}){const u=R(),[c,l]=(0,r.useState)(!1),h=(0,r.useRef)([]),d=(0,r.useRef)({x:null,y:null}),f=(0,r.useRef)(0),m=(0,r.useRef)(null),v=(0,r.useRef)({x:0,y:0}),y=(0,r.useRef)(null),b=(0,r.useRef)(!1),_=(0,r.useRef)(!1),x=(0,r.useRef)(!1),w=function(){const e=R();return(0,r.useCallback)((({sourceEvent:t})=>{const{transform:n,snapGrid:r,snapToGrid:i}=e.getState(),o=t.touches?t.touches[0].clientX:t.clientX,s=t.touches?t.touches[0].clientY:t.clientY,a={x:(o-n[0])/n[2],y:(s-n[1])/n[2]};return{xSnapped:i?r[0]*Math.round(a.x/r[0]):a.x,ySnapped:i?r[1]*Math.round(a.y/r[1]):a.y,...a}}),[])}();return(0,r.useEffect)((()=>{if(e?.current){const r=(0,p.Z)(e.current),c=({x:e,y:t})=>{const{nodeInternals:n,onNodeDrag:r,onSelectionDrag:i,updateNodePositions:s,nodeExtent:a,snapGrid:c,snapToGrid:f,nodeOrigin:p,onError:m}=u.getState();d.current={x:e,y:t};let g=!1,v={x:0,y:0,x2:0,y2:0};if(h.current.length>1&&a){const e=Ie(h.current,p);v=G(e)}if(h.current=h.current.map((r=>{const i={x:e-r.distance.x,y:t-r.distance.y};f&&(i.x=c[0]*Math.round(i.x/c[0]),i.y=c[1]*Math.round(i.y/c[1]));const o=[[a[0][0],a[0][1]],[a[1][0],a[1][1]]];h.current.length>1&&a&&!r.extent&&(o[0][0]=r.positionAbsolute.x-v.x+a[0][0],o[1][0]=r.positionAbsolute.x+(r.width??0)-v.x2+a[1][0],o[0][1]=r.positionAbsolute.y-v.y+a[0][1],o[1][1]=r.positionAbsolute.y+(r.height??0)-v.y2+a[1][1]);const s=nn(r,i,n,o,p,m);return g=g||r.position.x!==s.position.x||r.position.y!==s.position.y,r.position=s.position,r.positionAbsolute=s.positionAbsolute,r})),!g)return;s(h.current,!0,!0),l(!0);const b=o?r:un(i);if(b&&y.current){const[e,t]=rn({nodeId:o,dragItems:h.current,nodeInternals:n});b(y.current,e,t)}},S=()=>{if(!m.current)return;const[e,t]=z(v.current,m.current);if(0!==e||0!==t){const{transform:n,panBy:r}=u.getState();d.current.x=(d.current.x??0)-e/n[2],d.current.y=(d.current.y??0)-t/n[2],r({x:e,y:t})&&c(d.current)}f.current=requestAnimationFrame(S)},E=t=>{const{nodeInternals:n,multiSelectionActive:r,nodesDraggable:i,unselectNodesAndEdges:c,onNodeDragStart:l,onSelectionDragStart:f}=u.getState();_.current=!0;const p=o?l:un(f);a&&s||r||!o||n.get(o)?.selected||c(),o&&s&&a&&an({id:o,store:u,nodeRef:e});const m=w(t);if(d.current=m,h.current=tn(n,i,m,o),p&&h.current){const[e,r]=rn({nodeId:o,dragItems:h.current,nodeInternals:n});p(t.sourceEvent,e,r)}};if(!t){const t=(0,g.Z)().on("start",(e=>{const{domNode:t,nodeDragThreshold:n}=u.getState();0===n&&E(e),x.current=!1;const r=w(e);d.current=r,m.current=t?.getBoundingClientRect()||null,v.current=ee(e.sourceEvent,m.current)})).on("drag",(e=>{const t=w(e),{autoPanOnNodeDrag:n,nodeDragThreshold:r}=u.getState();if("touchmove"===e.sourceEvent.type&&e.sourceEvent.touches.length>1&&(x.current=!0),!x.current){if(!b.current&&_.current&&n&&(b.current=!0,S()),!_.current){const n=t.xSnapped-(d?.current?.x??0),i=t.ySnapped-(d?.current?.y??0);Math.sqrt(n*n+i*i)>r&&E(e)}(d.current.x!==t.xSnapped||d.current.y!==t.ySnapped)&&h.current&&_.current&&(y.current=e.sourceEvent,v.current=ee(e.sourceEvent,m.current),c(t))}})).on("end",(e=>{if(_.current&&!x.current&&(l(!1),b.current=!1,_.current=!1,cancelAnimationFrame(f.current),h.current)){const{updateNodePositions:t,nodeInternals:n,onNodeDragStop:r,onSelectionDragStop:i}=u.getState(),s=o?r:un(i);if(t(h.current,!1,!1),s){const[t,r]=rn({nodeId:o,dragItems:h.current,nodeInternals:n});s(e.sourceEvent,t,r)}}})).filter((t=>{const r=t.target;return!t.button&&(!n||!en(r,`.${n}`,e))&&(!i||en(r,i,e))}));return r.call(t),()=>{r.on(".drag",null)}}r.on(".drag",null)}}),[e,t,n,i,s,u,o,a,w]),c}function ln(){const e=R();return(0,r.useCallback)((t=>{const{nodeInternals:n,nodeExtent:r,updateNodePositions:i,getNodes:o,snapToGrid:s,snapGrid:a,onError:u,nodesDraggable:c}=e.getState(),l=o().filter((e=>e.selected&&(e.draggable||c&&void 0===e.draggable))),h=s?a[0]:5,d=s?a[1]:5,f=t.isShiftPressed?4:1,p=t.x*h*f,m=t.y*d*f;i(l.map((e=>{if(e.positionAbsolute){const t={x:e.positionAbsolute.x+p,y:e.positionAbsolute.y+m};s&&(t.x=a[0]*Math.round(t.x/a[0]),t.y=a[1]*Math.round(t.y/a[1]));const{positionAbsolute:i,position:o}=nn(e,t,n,r,void 0,u);e.position=o,e.positionAbsolute=i}return e})),!0,!1)}),[])}const hn={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var dn=e=>{const t=({id:t,type:n,data:o,xPos:s,yPos:a,xPosOrigin:u,yPosOrigin:c,selected:l,onClick:h,onMouseEnter:d,onMouseMove:f,onMouseLeave:p,onContextMenu:m,onDoubleClick:g,style:v,className:y,isDraggable:b,isSelectable:_,isConnectable:x,isFocusable:w,selectNodesOnDrag:S,sourcePosition:E,targetPosition:T,hidden:M,resizeObserver:A,dragHandle:C,zIndex:O,isParent:P,noDragClassName:N,noPanClassName:I,initialized:k,disableKeyboardA11y:D,ariaLabel:L,rfId:U,hasHandleBounds:F})=>{const B=R(),z=(0,r.useRef)(null),j=(0,r.useRef)(null),V=(0,r.useRef)(E),G=(0,r.useRef)(T),H=(0,r.useRef)(n),W=_||b||h||d||f||p,q=ln(),X=sn(t,B.getState,d),Z=sn(t,B.getState,f),$=sn(t,B.getState,p),K=sn(t,B.getState,m),J=sn(t,B.getState,g);(0,r.useEffect)((()=>()=>{j.current&&(A?.unobserve(j.current),j.current=null)}),[]),(0,r.useEffect)((()=>{if(z.current&&!M){const e=z.current;k&&F&&j.current===e||(j.current&&A?.unobserve(j.current),A?.observe(e),j.current=e)}}),[M,k,F]),(0,r.useEffect)((()=>{const e=H.current!==n,r=V.current!==E,i=G.current!==T;z.current&&(e||r||i)&&(e&&(H.current=n),r&&(V.current=E),i&&(G.current=T),B.getState().updateNodeDimensions([{id:t,nodeElement:z.current,forceUpdate:!0}]))}),[t,n,E,T]);const ee=cn({nodeRef:z,disabled:M||!b,noDragClassName:N,handleSelector:C,nodeId:t,isSelectable:_,selectNodesOnDrag:S});return M?null:r.createElement("div",{className:(0,i.Z)(["react-flow__node",`react-flow__node-${n}`,{[I]:b},y,{selected:l,selectable:_,parent:P,dragging:ee}]),ref:z,style:{zIndex:O,transform:`translate(${u}px,${c}px)`,pointerEvents:W?"all":"none",visibility:k?"visible":"hidden",...v},"data-id":t,"data-testid":`rf__node-${t}`,onMouseEnter:X,onMouseMove:Z,onMouseLeave:$,onContextMenu:K,onClick:e=>{const{nodeDragThreshold:n}=B.getState();if(_&&(!S||!b||n>0)&&an({id:t,store:B,nodeRef:z}),h){const n=B.getState().nodeInternals.get(t);n&&h(e,{...n})}},onDoubleClick:J,onKeyDown:w?e=>{if(!Q(e)&&!D)if(Y.includes(e.key)&&_){const n="Escape"===e.key;an({id:t,store:B,unselect:n,nodeRef:z})}else b&&l&&Object.prototype.hasOwnProperty.call(hn,e.key)&&(B.setState({ariaLiveMessage:`Moved selected node ${e.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~s}, y: ${~~a}`}),q({x:hn[e.key].x,y:hn[e.key].y,isShiftPressed:e.shiftKey}))}:void 0,tabIndex:w?0:void 0,role:w?"button":void 0,"aria-describedby":D?void 0:`${mt}-${U}`,"aria-label":L},r.createElement(Ae,{value:t},r.createElement(e,{id:t,data:o,type:n,xPos:s,yPos:a,selected:l,isConnectable:x,sourcePosition:E,targetPosition:T,dragging:ee,dragHandle:C,zIndex:O})))};return t.displayName="NodeWrapper",(0,r.memo)(t)};const fn=e=>{const t=e.getNodes().filter((e=>e.selected));return{...Ie(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};var pn=(0,r.memo)((function({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=R(),{width:s,height:a,x:u,y:c,transformString:l,userSelectionActive:h}=P(fn,d.X),f=ln(),p=(0,r.useRef)(null);if((0,r.useEffect)((()=>{n||p.current?.focus({preventScroll:!0})}),[n]),cn({nodeRef:p}),h||!s||!a)return null;const m=e?t=>{const n=o.getState().getNodes().filter((e=>e.selected));e(t,n)}:void 0;return r.createElement("div",{className:(0,i.Z)(["react-flow__nodesselection","react-flow__container",t]),style:{transform:l}},r.createElement("div",{ref:p,className:"react-flow__nodesselection-rect",onContextMenu:m,tabIndex:n?void 0:-1,onKeyDown:n?void 0:e=>{Object.prototype.hasOwnProperty.call(hn,e.key)&&f({x:hn[e.key].x,y:hn[e.key].y,isShiftPressed:e.shiftKey})},style:{width:s,height:a,top:c,left:u}}))}));const mn=e=>e.nodesSelectionActive,gn=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:i,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:a,deleteKeyCode:u,onMove:c,onMoveStart:l,onMoveEnd:h,selectionKeyCode:d,selectionOnDrag:f,selectionMode:p,onSelectionStart:m,onSelectionEnd:g,multiSelectionKeyCode:v,panActivationKeyCode:y,zoomActivationKeyCode:b,elementsSelectable:_,zoomOnScroll:x,zoomOnPinch:w,panOnScroll:S,panOnScrollSpeed:E,panOnScrollMode:T,zoomOnDoubleClick:M,panOnDrag:A,defaultViewport:C,translateExtent:O,minZoom:N,maxZoom:I,preventScrolling:k,onSelectionContextMenu:D,noWheelClassName:L,noPanClassName:U,disableKeyboardA11y:F})=>{const B=P(mn),z=_t(d),j=_t(y),V=j||A,G=j||S,H=z||f&&!0!==V;return(({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=R(),{deleteElements:i}=It(),o=_t(e,kt),s=_t(t);(0,r.useEffect)((()=>{if(o){const{edges:e,getNodes:t}=n.getState(),r=t().filter((e=>e.selected)),o=e.filter((e=>e.selected));i({nodes:r,edges:o}),n.setState({nodesSelectionActive:!1})}}),[o]),(0,r.useEffect)((()=>{n.setState({multiSelectionActive:s})}),[s])})({deleteKeyCode:u,multiSelectionKeyCode:v}),r.createElement(jt,{onMove:c,onMoveStart:l,onMoveEnd:h,onPaneContextMenu:s,elementsSelectable:_,zoomOnScroll:x,zoomOnPinch:w,panOnScroll:G,panOnScrollSpeed:E,panOnScrollMode:T,zoomOnDoubleClick:M,panOnDrag:!z&&V,defaultViewport:C,translateExtent:O,minZoom:N,maxZoom:I,zoomActivationKeyCode:b,preventScrolling:k,noWheelClassName:L,noPanClassName:U},r.createElement(Qt,{onSelectionStart:m,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:i,onPaneMouseLeave:o,onPaneContextMenu:s,onPaneScroll:a,panOnDrag:V,isSelecting:!!H,selectionMode:p},e,B&&r.createElement(pn,{onSelectionContextMenu:D,noPanClassName:U,disableKeyboardA11y:F})))};gn.displayName="FlowRenderer";var vn=(0,r.memo)(gn);function yn(e){return{...{input:dn(e.input||Je),default:dn(e.default||Ke),output:dn(e.output||tt),group:dn(e.group||nt)},...Object.keys(e).filter((e=>!["input","default","output","group"].includes(e))).reduce(((t,n)=>(t[n]=dn(e[n]||Ke),t)),{})}}const bn=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),_n=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:i,elementsSelectable:o,updateNodeDimensions:s,onError:a}=P(bn,d.X),u=(c=e.onlyRenderVisibleElements,P((0,r.useCallback)((e=>c?ke(e.nodeInternals,{x:0,y:0,width:e.width,height:e.height},e.transform,!0):e.getNodes()),[c])));var c;const l=(0,r.useRef)(),h=(0,r.useMemo)((()=>{if("undefined"==typeof ResizeObserver)return null;const e=new ResizeObserver((e=>{const t=e.map((e=>({id:e.target.getAttribute("data-id"),nodeElement:e.target,forceUpdate:!0})));s(t)}));return l.current=e,e}),[]);return(0,r.useEffect)((()=>()=>{l?.current?.disconnect()}),[]),r.createElement("div",{className:"react-flow__nodes",style:Dt},u.map((s=>{let u=s.type||"default";e.nodeTypes[u]||(a?.("003",_(u)),u="default");const c=e.nodeTypes[u]||e.nodeTypes.default,l=!!(s.draggable||t&&void 0===s.draggable),d=!!(s.selectable||o&&void 0===s.selectable),f=!!(s.connectable||n&&void 0===s.connectable),p=!!(s.focusable||i&&void 0===s.focusable),m=e.nodeExtent?F(s.positionAbsolute,e.nodeExtent):s.positionAbsolute,g=m?.x??0,v=m?.y??0,y=(({x:e,y:t,width:n,height:r,origin:i})=>n&&r?i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:e,y:t}:{x:e-n*i[0],y:t-r*i[1]}:{x:e,y:t})({x:g,y:v,width:s.width??0,height:s.height??0,origin:e.nodeOrigin});return r.createElement(c,{key:s.id,id:s.id,className:s.className,style:s.style,type:u,data:s.data,sourcePosition:s.sourcePosition||he.Bottom,targetPosition:s.targetPosition||he.Top,hidden:s.hidden,xPos:g,yPos:v,xPosOrigin:y.x,yPosOrigin:y.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!s.selected,isDraggable:l,isSelectable:d,isConnectable:f,isFocusable:p,resizeObserver:h,dragHandle:s.dragHandle,zIndex:s[$]?.z??0,isParent:!!s[$]?.isParent,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!s.width&&!!s.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:s.ariaLabel,hasHandleBounds:!!s[$]?.handleBounds})})))};_n.displayName="NodeRenderer";var xn=(0,r.memo)(_n);const wn=(e,t,n)=>n===he.Left?e-t:n===he.Right?e+t:e,Sn=(e,t,n)=>n===he.Top?e-t:n===he.Bottom?e+t:e,En="react-flow__edgeupdater",Tn=({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:a,onMouseOut:u,type:c})=>r.createElement("circle",{onMouseDown:s,onMouseEnter:a,onMouseOut:u,className:(0,i.Z)([En,`${En}-${c}`]),cx:wn(t,o,e),cy:Sn(n,o,e),r:o,stroke:"transparent",fill:"transparent"}),Mn=()=>!0;var An=e=>{const t=({id:t,className:n,type:o,data:s,onClick:a,onEdgeDoubleClick:u,selected:c,animated:l,label:h,labelStyle:d,labelShowBg:f,labelBgStyle:p,labelBgPadding:m,labelBgBorderRadius:g,style:v,source:y,target:b,sourceX:_,sourceY:x,targetX:w,targetY:S,sourcePosition:E,targetPosition:T,elementsSelectable:M,hidden:A,sourceHandleId:C,targetHandleId:O,onContextMenu:P,onMouseEnter:N,onMouseMove:I,onMouseLeave:k,reconnectRadius:D,onReconnect:L,onReconnectStart:U,onReconnectEnd:F,markerEnd:B,markerStart:z,rfId:j,ariaLabel:V,isFocusable:G,isReconnectable:H,pathOptions:W,interactionWidth:q,disableKeyboardA11y:X})=>{const Z=(0,r.useRef)(null),[$,K]=(0,r.useState)(!1),[Q,J]=(0,r.useState)(!1),ee=R(),te=(0,r.useMemo)((()=>`url('#${Oe(z,j)}')`),[z,j]),ne=(0,r.useMemo)((()=>`url('#${Oe(B,j)}')`),[B,j]);if(A)return null;const ie=re(t,ee.getState,u),oe=re(t,ee.getState,P),se=re(t,ee.getState,N),ae=re(t,ee.getState,I),ue=re(t,ee.getState,k),ce=(e,n)=>{if(0!==e.button)return;const{edges:r,isValidConnection:i}=ee.getState(),o=n?b:y,s=(n?O:C)||null,a=n?"target":"source",u=i||Mn,c=n,l=r.find((e=>e.id===t));J(!0),U?.(e,l,a);We({event:e,handleId:s,nodeId:o,onConnect:e=>L?.(l,e),isTarget:c,getState:ee.getState,setState:ee.setState,isValidConnection:u,edgeUpdaterType:a,onReconnectEnd:e=>{J(!1),F?.(e,l,a)}})},le=()=>K(!0),he=()=>K(!1),de=!M&&!a;return r.createElement("g",{className:(0,i.Z)(["react-flow__edge",`react-flow__edge-${o}`,n,{selected:c,animated:l,inactive:de,updating:$}]),onClick:e=>{const{edges:n,addSelectedEdges:r,unselectNodesAndEdges:i,multiSelectionActive:o}=ee.getState(),s=n.find((e=>e.id===t));s&&(M&&(ee.setState({nodesSelectionActive:!1}),s.selected&&o?(i({nodes:[],edges:[s]}),Z.current?.blur()):r([t])),a&&a(e,s))},onDoubleClick:ie,onContextMenu:oe,onMouseEnter:se,onMouseMove:ae,onMouseLeave:ue,onKeyDown:G?e=>{if(!X&&Y.includes(e.key)&&M){const{unselectNodesAndEdges:n,addSelectedEdges:r,edges:i}=ee.getState();"Escape"===e.key?(Z.current?.blur(),n({edges:[i.find((e=>e.id===t))]})):r([t])}}:void 0,tabIndex:G?0:void 0,role:G?"button":"img","data-testid":`rf__edge-${t}`,"aria-label":null===V?void 0:V||`Edge from ${y} to ${b}`,"aria-describedby":G?`${gt}-${j}`:void 0,ref:Z},!Q&&r.createElement(e,{id:t,source:y,target:b,selected:c,animated:l,label:h,labelStyle:d,labelShowBg:f,labelBgStyle:p,labelBgPadding:m,labelBgBorderRadius:g,data:s,style:v,sourceX:_,sourceY:x,targetX:w,targetY:S,sourcePosition:E,targetPosition:T,sourceHandleId:C,targetHandleId:O,markerStart:te,markerEnd:ne,pathOptions:W,interactionWidth:q}),H&&r.createElement(r.Fragment,null,("source"===H||!0===H)&&r.createElement(Tn,{position:E,centerX:_,centerY:x,radius:D,onMouseDown:e=>ce(e,!0),onMouseEnter:le,onMouseOut:he,type:"source"}),("target"===H||!0===H)&&r.createElement(Tn,{position:T,centerX:w,centerY:S,radius:D,onMouseDown:e=>ce(e,!1),onMouseEnter:le,onMouseOut:he,type:"target"})))};return t.displayName="EdgeWrapper",(0,r.memo)(t)};function Cn(e){return{...{default:An(e.default||Te),straight:An(e.bezier||xe),step:An(e.step||_e),smoothstep:An(e.step||be),simplebezier:An(e.simplebezier||pe)},...Object.keys(e).filter((e=>!["default","bezier"].includes(e))).reduce(((t,n)=>(t[n]=An(e[n]||Te),t)),{})}}function On(e,t,n=null){const r=(n?.x||0)+t.x,i=(n?.y||0)+t.y,o=n?.width||t.width,s=n?.height||t.height;switch(e){case he.Top:return{x:r+o/2,y:i};case he.Right:return{x:r+o,y:i+s/2};case he.Bottom:return{x:r+o/2,y:i+s};case he.Left:return{x:r,y:i+s/2}}}function Pn(e,t){return e?1!==e.length&&t?t&&e.find((e=>e.id===t))||null:e[0]:null}function Rn(e){const t=e?.[$]?.handleBounds||null,n=t&&e?.width&&e?.height&&void 0!==e?.positionAbsolute?.x&&void 0!==e?.positionAbsolute?.y;return[{x:e?.positionAbsolute?.x||0,y:e?.positionAbsolute?.y||0,width:e?.width||0,height:e?.height||0},t,!!n]}const Nn=[{level:0,isMaxLevel:!0,edges:[]}];function In(e,t,n){return function(e,t,n=!1){let r=-1;const i=e.reduce(((e,i)=>{const o=Z(i.zIndex);let s=o?i.zIndex:0;if(n){const e=t.get(i.target),n=t.get(i.source),r=i.selected||e?.selected||n?.selected,a=Math.max(n?.[$]?.z||0,e?.[$]?.z||0,1e3);s=(o?i.zIndex:0)+(r?a:0)}return e[s]?e[s].push(i):e[s]=[i],r=s>r?s:r,e}),{}),o=Object.entries(i).map((([e,t])=>{const n=+e;return{edges:t,level:n,isMaxLevel:n===r}}));return 0===o.length?Nn:o}(P((0,r.useCallback)((n=>e?n.edges.filter((e=>{const r=t.get(e.source),i=t.get(e.target);return r?.width&&r?.height&&i?.width&&i?.height&&function({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:i,targetHeight:o,width:s,height:a,transform:u}){const c={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+i),y2:Math.max(e.y+r,t.y+o)};c.x===c.x2&&(c.x2+=1),c.y===c.y2&&(c.y2+=1);const l=G({x:(0-u[0])/u[2],y:(0-u[1])/u[2],width:s/u[2],height:a/u[2]}),h=Math.max(0,Math.min(l.x2,c.x2)-Math.max(l.x,c.x)),d=Math.max(0,Math.min(l.y2,c.y2)-Math.max(l.y,c.y));return Math.ceil(h*d)>0}({sourcePos:r.positionAbsolute||{x:0,y:0},targetPos:i.positionAbsolute||{x:0,y:0},sourceWidth:r.width,sourceHeight:r.height,targetWidth:i.width,targetHeight:i.height,width:n.width,height:n.height,transform:n.transform})})):n.edges),[e,t])),t,n)}const kn={[le.Arrow]:({color:e="none",strokeWidth:t=1})=>r.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),[le.ArrowClosed]:({color:e="none",strokeWidth:t=1})=>r.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})};const Dn=({id:e,type:t,color:n,width:i=12.5,height:o=12.5,markerUnits:s="strokeWidth",strokeWidth:a,orient:u="auto-start-reverse"})=>{const c=function(e){const t=R();return(0,r.useMemo)((()=>Object.prototype.hasOwnProperty.call(kn,e)?kn[e]:(t.getState().onError?.("009",E(e)),null)),[e])}(t);return c?r.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${i}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:u,refX:"0",refY:"0"},r.createElement(c,{color:n,strokeWidth:a})):null},Ln=({defaultColor:e,rfId:t})=>{const n=P((0,r.useCallback)((({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce(((n,i)=>([i.markerStart,i.markerEnd].forEach((i=>{if(i&&"object"==typeof i){const o=Oe(i,t);r.includes(o)||(n.push({id:o,color:i.color||e,...i}),r.push(o))}})),n)),[]).sort(((e,t)=>e.id.localeCompare(t.id)))})({defaultColor:e,rfId:t}),[e,t]),((e,t)=>!(e.length!==t.length||e.some(((e,n)=>e.id!==t[n].id)))));return r.createElement("defs",null,n.map((e=>r.createElement(Dn,{id:e.id,key:e.id,type:e.type,color:e.color,width:e.width,height:e.height,markerUnits:e.markerUnits,strokeWidth:e.strokeWidth,orient:e.orient}))))};Ln.displayName="MarkerDefinitions";var Un=(0,r.memo)(Ln);const Fn=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),Bn=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:o,edgeTypes:s,noPanClassName:a,onEdgeContextMenu:u,onEdgeMouseEnter:c,onEdgeMouseMove:l,onEdgeMouseLeave:h,onEdgeClick:f,onEdgeDoubleClick:p,onReconnect:m,onReconnectStart:g,onReconnectEnd:v,reconnectRadius:y,children:b,disableKeyboardA11y:_})=>{const{edgesFocusable:x,edgesUpdatable:w,elementsSelectable:S,width:E,height:M,connectionMode:C,nodeInternals:O,onError:R}=P(Fn,d.X),N=In(t,O,n);return E?r.createElement(r.Fragment,null,N.map((({level:t,edges:n,isMaxLevel:d})=>r.createElement("svg",{key:t,style:{zIndex:t},width:E,height:M,className:"react-flow__edges react-flow__container"},d&&r.createElement(Un,{defaultColor:e,rfId:o}),r.createElement("g",null,n.map((e=>{const[t,n,d]=Rn(O.get(e.source)),[b,E,M]=Rn(O.get(e.target));if(!d||!M)return null;let P=e.type||"default";s[P]||(R?.("011",A(P)),P="default");const N=s[P]||s.default,I=C===se.Strict?E.target:(E.target??[]).concat(E.source??[]),k=Pn(n.source,e.sourceHandle),D=Pn(I,e.targetHandle),L=k?.position||he.Bottom,U=D?.position||he.Top,F=!!(e.focusable||x&&void 0===e.focusable),B=e.reconnectable||e.updatable,z=void 0!==m&&(B||w&&void 0===B);if(!k||!D)return R?.("008",T(k,e)),null;const{sourceX:j,sourceY:V,targetX:G,targetY:H}=((e,t,n,r,i,o)=>{const s=On(n,e,t),a=On(o,r,i);return{sourceX:s.x,sourceY:s.y,targetX:a.x,targetY:a.y}})(t,k,L,b,D,U);return r.createElement(N,{key:e.id,id:e.id,className:(0,i.Z)([e.className,a]),type:P,data:e.data,selected:!!e.selected,animated:!!e.animated,hidden:!!e.hidden,label:e.label,labelStyle:e.labelStyle,labelShowBg:e.labelShowBg,labelBgStyle:e.labelBgStyle,labelBgPadding:e.labelBgPadding,labelBgBorderRadius:e.labelBgBorderRadius,style:e.style,source:e.source,target:e.target,sourceHandleId:e.sourceHandle,targetHandleId:e.targetHandle,markerEnd:e.markerEnd,markerStart:e.markerStart,sourceX:j,sourceY:V,targetX:G,targetY:H,sourcePosition:L,targetPosition:U,elementsSelectable:S,onContextMenu:u,onMouseEnter:c,onMouseMove:l,onMouseLeave:h,onClick:f,onEdgeDoubleClick:p,onReconnect:m,onReconnectStart:g,onReconnectEnd:v,reconnectRadius:y,rfId:o,ariaLabel:e.ariaLabel,isFocusable:F,isReconnectable:z,pathOptions:"pathOptions"in e?e.pathOptions:void 0,interactionWidth:e.interactionWidth,disableKeyboardA11y:_})})))))),b):null};Bn.displayName="EdgeRenderer";var zn=(0,r.memo)(Bn);const jn=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Vn({children:e}){const t=P(jn);return r.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}const Gn={[he.Left]:he.Right,[he.Right]:he.Left,[he.Top]:he.Bottom,[he.Bottom]:he.Top},Hn=({nodeId:e,handleType:t,style:n,type:i=ce.Bezier,CustomComponent:o,connectionStatus:s})=>{const{fromNode:a,handleId:u,toX:c,toY:l,connectionMode:h}=P((0,r.useCallback)((t=>({fromNode:t.nodeInternals.get(e),handleId:t.connectionHandleId,toX:(t.connectionPosition.x-t.transform[0])/t.transform[2],toY:(t.connectionPosition.y-t.transform[1])/t.transform[2],connectionMode:t.connectionMode})),[e]),d.X),f=a?.[$]?.handleBounds;let p=f?.[t];if(h===se.Loose&&(p=p||f?.["source"===t?"target":"source"]),!a||!p)return null;const m=u?p.find((e=>e.id===u)):p[0],g=m?m.x+m.width/2:(a.width??0)/2,v=m?m.y+m.height/2:a.height??0,y=(a.positionAbsolute?.x??0)+g,b=(a.positionAbsolute?.y??0)+v,_=m?.position,x=_?Gn[_]:null;if(!_||!x)return null;if(o)return r.createElement(o,{connectionLineType:i,connectionLineStyle:n,fromNode:a,fromHandle:m,fromX:y,fromY:b,toX:c,toY:l,fromPosition:_,toPosition:x,connectionStatus:s});let w="";const S={sourceX:y,sourceY:b,sourcePosition:_,targetX:c,targetY:l,targetPosition:x};return i===ce.Bezier?[w]=Ee(S):i===ce.Step?[w]=ye({...S,borderRadius:0}):i===ce.SmoothStep?[w]=ye(S):i===ce.SimpleBezier?[w]=fe(S):w=`M${y},${b} ${c},${l}`,r.createElement("path",{d:w,fill:"none",className:"react-flow__connection-path",style:n})};Hn.displayName="ConnectionLine";const Wn=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function qn({containerStyle:e,style:t,type:n,component:o}){const{nodeId:s,handleType:a,nodesConnectable:u,width:c,height:l,connectionStatus:h}=P(Wn,d.X);return!!(s&&a&&c&&u)?r.createElement("svg",{style:e,width:c,height:l,className:"react-flow__edges react-flow__connectionline react-flow__container"},r.createElement("g",{className:(0,i.Z)(["react-flow__connection",h])},r.createElement(Hn,{nodeId:s,handleType:a,style:t,type:n,CustomComponent:o,connectionStatus:h}))):null}function Xn(e,t){(0,r.useRef)(null),R();return(0,r.useMemo)((()=>t(e)),[e])}const Zn=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:i,onMoveEnd:o,onInit:s,onNodeClick:a,onEdgeClick:u,onNodeDoubleClick:c,onEdgeDoubleClick:l,onNodeMouseEnter:h,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:p,onSelectionContextMenu:m,onSelectionStart:g,onSelectionEnd:v,connectionLineType:y,connectionLineStyle:b,connectionLineComponent:_,connectionLineContainerStyle:x,selectionKeyCode:w,selectionOnDrag:S,selectionMode:E,multiSelectionKeyCode:T,panActivationKeyCode:M,zoomActivationKeyCode:A,deleteKeyCode:C,onlyRenderVisibleElements:O,elementsSelectable:P,selectNodesOnDrag:R,defaultViewport:N,translateExtent:I,minZoom:k,maxZoom:D,preventScrolling:L,defaultMarkerColor:U,zoomOnScroll:F,zoomOnPinch:B,panOnScroll:z,panOnScrollSpeed:j,panOnScrollMode:V,zoomOnDoubleClick:G,panOnDrag:H,onPaneClick:W,onPaneMouseEnter:q,onPaneMouseMove:X,onPaneMouseLeave:Z,onPaneScroll:$,onPaneContextMenu:Y,onEdgeContextMenu:K,onEdgeMouseEnter:Q,onEdgeMouseMove:J,onEdgeMouseLeave:ee,onReconnect:te,onReconnectStart:ne,onReconnectEnd:re,reconnectRadius:ie,noDragClassName:oe,noWheelClassName:se,noPanClassName:ae,elevateEdgesOnSelect:ue,disableKeyboardA11y:ce,nodeOrigin:le,nodeExtent:he,rfId:de})=>{const fe=Xn(e,yn),pe=Xn(t,Cn);return function(e){const t=It(),n=(0,r.useRef)(!1);(0,r.useEffect)((()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout((()=>e(t)),1),n.current=!0)}),[e,t.viewportInitialized])}(s),r.createElement(vn,{onPaneClick:W,onPaneMouseEnter:q,onPaneMouseMove:X,onPaneMouseLeave:Z,onPaneContextMenu:Y,onPaneScroll:$,deleteKeyCode:C,selectionKeyCode:w,selectionOnDrag:S,selectionMode:E,onSelectionStart:g,onSelectionEnd:v,multiSelectionKeyCode:T,panActivationKeyCode:M,zoomActivationKeyCode:A,elementsSelectable:P,onMove:n,onMoveStart:i,onMoveEnd:o,zoomOnScroll:F,zoomOnPinch:B,zoomOnDoubleClick:G,panOnScroll:z,panOnScrollSpeed:j,panOnScrollMode:V,panOnDrag:H,defaultViewport:N,translateExtent:I,minZoom:k,maxZoom:D,onSelectionContextMenu:m,preventScrolling:L,noDragClassName:oe,noWheelClassName:se,noPanClassName:ae,disableKeyboardA11y:ce},r.createElement(Vn,null,r.createElement(zn,{edgeTypes:pe,onEdgeClick:u,onEdgeDoubleClick:l,onlyRenderVisibleElements:O,onEdgeContextMenu:K,onEdgeMouseEnter:Q,onEdgeMouseMove:J,onEdgeMouseLeave:ee,onReconnect:te,onReconnectStart:ne,onReconnectEnd:re,reconnectRadius:ie,defaultMarkerColor:U,noPanClassName:ae,elevateEdgesOnSelect:!!ue,disableKeyboardA11y:ce,rfId:de},r.createElement(qn,{style:b,type:y,component:_,containerStyle:x})),r.createElement("div",{className:"react-flow__edgelabel-renderer"}),r.createElement(xn,{nodeTypes:fe,onNodeClick:a,onNodeDoubleClick:c,onNodeMouseEnter:h,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:p,selectNodesOnDrag:R,onlyRenderVisibleElements:O,noPanClassName:ae,noDragClassName:oe,disableKeyboardA11y:ce,nodeOrigin:le,nodeExtent:he,rfId:de})))};Zn.displayName="GraphView";var $n=(0,r.memo)(Zn);const Yn=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Kn={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Yn,nodeExtent:Yn,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:se.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:K,isValidConnection:void 0},Qn=()=>{return e=(e,t)=>({...Kn,setNodes:n=>{const{nodeInternals:r,nodeOrigin:i,elevateNodesOnSelect:o}=t();e({nodeInternals:Tt(n,r,i,o)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map((e=>({...r,...e})))})},setDefaultNodesAndEdges:(n,r)=>{const i=void 0!==n,o=void 0!==r,s=i?Tt(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:s,edges:o?r:[],hasDefaultNodes:i,hasDefaultEdges:o})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:i,fitViewOnInit:o,fitViewOnInitDone:s,fitViewOnInitOptions:a,domNode:u,nodeOrigin:c}=t(),l=u?.querySelector(".react-flow__viewport");if(!l)return;const h=window.getComputedStyle(l),{m22:d}=new window.DOMMatrixReadOnly(h.transform),f=n.reduce(((e,t)=>{const n=i.get(t.id);if(n?.hidden)i.set(n.id,{...n,[$]:{...n[$],handleBounds:void 0}});else if(n){const r=L(t.nodeElement);r.width&&r.height&&(n.width!==r.width||n.height!==r.height||t.forceUpdate)&&(i.set(n.id,{...n,[$]:{...n[$],handleBounds:{source:on(".source",t.nodeElement,d,c),target:on(".target",t.nodeElement,d,c)}},...r}),e.push({id:n.id,type:"dimensions",dimensions:r}))}return e}),[]);Et(i,c);const p=s||o&&!s&&Mt(t,{initial:!0,...a});e({nodeInternals:new Map(i),fitViewOnInitDone:p}),f?.length>0&&r?.(f)},updateNodePositions:(e,n=!0,r=!1)=>{const{triggerNodeChanges:i}=t();i(e.map((e=>{const t={id:e.id,type:"position",dragging:r};return n&&(t.positionAbsolute=e.positionAbsolute,t.position=e.position),t})))},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:i,hasDefaultNodes:o,nodeOrigin:s,getNodes:a,elevateNodesOnSelect:u}=t();if(n?.length){if(o){const t=Tt(qt(n,a()),i,s,u);e({nodeInternals:t})}r?.(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:i,getNodes:o}=t();let s,a=null;r?s=n.map((e=>Zt(e,!0))):(s=$t(o(),n),a=$t(i,[])),Ot({changedNodes:s,changedEdges:a,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:i,getNodes:o}=t();let s,a=null;r?s=n.map((e=>Zt(e,!0))):(s=$t(i,n),a=$t(o(),[])),Ot({changedNodes:a,changedEdges:s,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:i,getNodes:o}=t(),s=r||i;Ot({changedNodes:(n||o()).map((e=>(e.selected=!1,Zt(e.id,!1)))),changedEdges:s.map((e=>Zt(e.id,!1))),get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:i}=t();r?.scaleExtent([n,i]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:i}=t();r?.scaleExtent([i,n]),e({maxZoom:n})},setTranslateExtent:n=>{t().d3Zoom?.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t();Ot({changedNodes:r().filter((e=>e.selected)).map((e=>Zt(e.id,!1))),changedEdges:n.filter((e=>e.selected)).map((e=>Zt(e.id,!1))),get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach((e=>{e.positionAbsolute=F(e.position,n)})),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:e=>{const{transform:n,width:r,height:i,d3Zoom:o,d3Selection:s,translateExtent:a}=t();if(!o||!s||!e.x&&!e.y)return!1;const u=f.CR.translate(n[0]+e.x,n[1]+e.y).scale(n[2]),c=[[0,0],[r,i]],l=o?.constrain()(u,c,a);return o.transform(s,l),n[0]!==l.x||n[1]!==l.y||n[2]!==l.k},cancelConnection:()=>e({connectionNodeId:Kn.connectionNodeId,connectionHandleId:Kn.connectionHandleId,connectionHandleType:Kn.connectionHandleType,connectionStatus:Kn.connectionStatus,connectionStartHandle:Kn.connectionStartHandle,connectionEndHandle:Kn.connectionEndHandle}),reset:()=>e({...Kn})}),t=Object.is,e?h(e,t):h;var e,t},Jn=({children:e})=>{const t=(0,r.useRef)(null);return t.current||(t.current=Qn()),r.createElement(b,{value:t.current},e)};Jn.displayName="ReactFlowProvider";const er=({children:e})=>(0,r.useContext)(y)?r.createElement(r.Fragment,null,e):r.createElement(Jn,null,e);er.displayName="ReactFlowWrapper";const tr={input:Je,default:Ke,output:tt,group:nt},nr={default:Te,straight:xe,step:_e,smoothstep:be,simplebezier:pe},rr=[0,0],ir=[15,15],or={x:0,y:0,zoom:1},sr={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},ar=(0,r.forwardRef)((({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:a=tr,edgeTypes:u=nr,onNodeClick:c,onEdgeClick:l,onInit:h,onMove:d,onMoveStart:f,onMoveEnd:p,onConnect:m,onConnectStart:g,onConnectEnd:v,onClickConnectStart:y,onClickConnectEnd:b,onNodeMouseEnter:_,onNodeMouseMove:x,onNodeMouseLeave:w,onNodeContextMenu:S,onNodeDoubleClick:E,onNodeDragStart:T,onNodeDrag:M,onNodeDragStop:A,onNodesDelete:C,onEdgesDelete:O,onSelectionChange:P,onSelectionDragStart:R,onSelectionDrag:N,onSelectionDragStop:I,onSelectionContextMenu:D,onSelectionStart:L,onSelectionEnd:U,connectionMode:F=se.Strict,connectionLineType:B=ce.Bezier,connectionLineStyle:z,connectionLineComponent:j,connectionLineContainerStyle:V,deleteKeyCode:G="Backspace",selectionKeyCode:H="Shift",selectionOnDrag:W=!1,selectionMode:q=ue.Full,panActivationKeyCode:X="Space",multiSelectionKeyCode:Z=(te()?"Meta":"Control"),zoomActivationKeyCode:$=(te()?"Meta":"Control"),snapToGrid:Y=!1,snapGrid:K=ir,onlyRenderVisibleElements:Q=!1,selectNodesOnDrag:J=!0,nodesDraggable:ee,nodesConnectable:ne,nodesFocusable:re,nodeOrigin:ie=rr,edgesFocusable:oe,edgesUpdatable:le,elementsSelectable:he,defaultViewport:de=or,minZoom:fe=.5,maxZoom:pe=2,translateExtent:me=Yn,preventScrolling:ge=!0,nodeExtent:ve,defaultMarkerColor:ye="#b1b1b7",zoomOnScroll:be=!0,zoomOnPinch:_e=!0,panOnScroll:xe=!1,panOnScrollSpeed:we=.5,panOnScrollMode:Se=ae.Free,zoomOnDoubleClick:Ee=!0,panOnDrag:Te=!0,onPaneClick:Me,onPaneMouseEnter:Ae,onPaneMouseMove:Ce,onPaneMouseLeave:Oe,onPaneScroll:Pe,onPaneContextMenu:Re,children:Ne,onEdgeContextMenu:Ie,onEdgeDoubleClick:ke,onEdgeMouseEnter:De,onEdgeMouseMove:Le,onEdgeMouseLeave:Ue,onEdgeUpdate:Fe,onEdgeUpdateStart:Be,onEdgeUpdateEnd:ze,onReconnect:je,onReconnectStart:Ve,onReconnectEnd:Ge,reconnectRadius:He=10,edgeUpdaterRadius:We=10,onNodesChange:qe,onEdgesChange:Xe,noDragClassName:Ze="nodrag",noWheelClassName:$e="nowheel",noPanClassName:Ye="nopan",fitView:Ke=!1,fitViewOptions:Qe,connectOnClick:Je=!0,attributionPosition:et,proOptions:tt,defaultEdgeOptions:nt,elevateNodesOnSelect:rt=!0,elevateEdgesOnSelect:it=!1,disableKeyboardA11y:ot=!1,autoPanOnConnect:st=!0,autoPanOnNodeDrag:at=!0,connectionRadius:ct=20,isValidConnection:lt,onError:ht,style:ft,id:pt,nodeDragThreshold:mt,...gt},vt)=>{const yt=pt||"1";return r.createElement("div",{...gt,style:{...ft,...sr},ref:vt,className:(0,i.Z)(["react-flow",s]),"data-testid":"rf__wrapper",id:pt},r.createElement(er,null,r.createElement($n,{onInit:h,onMove:d,onMoveStart:f,onMoveEnd:p,onNodeClick:c,onEdgeClick:l,onNodeMouseEnter:_,onNodeMouseMove:x,onNodeMouseLeave:w,onNodeContextMenu:S,onNodeDoubleClick:E,nodeTypes:a,edgeTypes:u,connectionLineType:B,connectionLineStyle:z,connectionLineComponent:j,connectionLineContainerStyle:V,selectionKeyCode:H,selectionOnDrag:W,selectionMode:q,deleteKeyCode:G,multiSelectionKeyCode:Z,panActivationKeyCode:X,zoomActivationKeyCode:$,onlyRenderVisibleElements:Q,selectNodesOnDrag:J,defaultViewport:de,translateExtent:me,minZoom:fe,maxZoom:pe,preventScrolling:ge,zoomOnScroll:be,zoomOnPinch:_e,zoomOnDoubleClick:Ee,panOnScroll:xe,panOnScrollSpeed:we,panOnScrollMode:Se,panOnDrag:Te,onPaneClick:Me,onPaneMouseEnter:Ae,onPaneMouseMove:Ce,onPaneMouseLeave:Oe,onPaneScroll:Pe,onPaneContextMenu:Re,onSelectionContextMenu:D,onSelectionStart:L,onSelectionEnd:U,onEdgeContextMenu:Ie,onEdgeDoubleClick:ke,onEdgeMouseEnter:De,onEdgeMouseMove:Le,onEdgeMouseLeave:Ue,onReconnect:je??Fe,onReconnectStart:Ve??Be,onReconnectEnd:Ge??ze,reconnectRadius:He??We,defaultMarkerColor:ye,noDragClassName:Ze,noWheelClassName:$e,noPanClassName:Ye,elevateEdgesOnSelect:it,rfId:yt,disableKeyboardA11y:ot,nodeOrigin:ie,nodeExtent:ve}),r.createElement(dt,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:m,onConnectStart:g,onConnectEnd:v,onClickConnectStart:y,onClickConnectEnd:b,nodesDraggable:ee,nodesConnectable:ne,nodesFocusable:re,edgesFocusable:oe,edgesUpdatable:le,elementsSelectable:he,elevateNodesOnSelect:rt,minZoom:fe,maxZoom:pe,nodeExtent:ve,onNodesChange:qe,onEdgesChange:Xe,snapToGrid:Y,snapGrid:K,connectionMode:F,translateExtent:me,connectOnClick:Je,defaultEdgeOptions:nt,fitView:Ke,fitViewOptions:Qe,onNodesDelete:C,onEdgesDelete:O,onNodeDragStart:T,onNodeDrag:M,onNodeDragStop:A,onSelectionDrag:N,onSelectionDragStart:R,onSelectionDragStop:I,noPanClassName:Ye,nodeOrigin:ie,rfId:yt,autoPanOnConnect:st,autoPanOnNodeDrag:at,onError:ht,connectionRadius:ct,isValidConnection:lt,nodeDragThreshold:mt}),r.createElement(ut,{onSelectionChange:P}),Ne,r.createElement(k,{proOptions:tt,position:et}),r.createElement(bt,{rfId:yt,disableKeyboardA11y:ot})))}));ar.displayName="ReactFlow";const ur=e=>e.domNode?.querySelector(".react-flow__edgelabel-renderer");function cr({children:e}){const t=P(ur);return t?(0,v.createPortal)(e,t):null}function lr(e){return t=>{const[n,i]=(0,r.useState)(t),o=(0,r.useCallback)((t=>i((n=>e(t,n)))),[]);return[n,i,o]}}lr(qt),lr(Xt);function hr({onChange:e}){const t=R();(0,r.useEffect)((()=>{const n=[...t.getState().onSelectionChange,e];return t.setState({onSelectionChange:n}),()=>{const n=t.getState().onSelectionChange.filter((t=>t!==e));t.setState({onSelectionChange:n})}}),[e])}},11029:function(e,t,n){"use strict";n.d(t,{a:function(){return y}});var r=n(50959),i=n(28680),o=n(53394),s=n(89888),a=n(41468),u=n(13802),c=n(77320);const l=({id:e,x:t,y:n,width:o,height:s,style:a,color:u,strokeColor:c,strokeWidth:l,className:h,borderRadius:d,shapeRendering:f,onClick:p,selected:m})=>{const{background:g,backgroundColor:v}=a||{},y=u||g||v;return r.createElement("rect",{className:(0,i.Z)(["react-flow__minimap-node",{selected:m},h]),x:t,y:n,rx:d,ry:d,width:o,height:s,fill:y,stroke:c,strokeWidth:l,shapeRendering:f,onClick:p?t=>p(t,e):void 0})};l.displayName="MiniMapNode";var h=(0,r.memo)(l);const d=e=>e.nodeOrigin,f=e=>e.getNodes().filter((e=>!e.hidden&&e.width&&e.height)),p=e=>e instanceof Function?e:()=>e;var m=(0,r.memo)((function({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:i=5,nodeStrokeWidth:s=2,nodeComponent:a=h,onClick:u}){const l=(0,c.oR)(f,o.X),m=(0,c.oR)(d),g=p(t),v=p(e),y=p(n),b="undefined"==typeof window||window.chrome?"crispEdges":"geometricPrecision";return r.createElement(r.Fragment,null,l.map((e=>{const{x:t,y:n}=(0,c.VP)(e,m).positionAbsolute;return r.createElement(a,{key:e.id,x:t,y:n,width:e.width,height:e.height,style:e.style,selected:e.selected,className:y(e),color:g(e),borderRadius:i,strokeColor:v(e),strokeWidth:s,shapeRendering:b,onClick:u,id:e.id})})))}));const g=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?(0,c.oI)((0,c.RX)(t,e.nodeOrigin),n):n,rfId:e.rfId}};function v({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:l="#e2e2e2",nodeClassName:h="",nodeBorderRadius:d=5,nodeStrokeWidth:f=2,nodeComponent:p,maskColor:v="rgb(240, 240, 240, 0.6)",maskStrokeColor:y="none",maskStrokeWidth:b=1,position:_="bottom-right",onClick:x,onNodeClick:w,pannable:S=!1,zoomable:E=!1,ariaLabel:T="React Flow mini map",inversePan:M=!1,zoomStep:A=10,offsetScale:C=5}){const O=(0,c.AC)(),P=(0,r.useRef)(null),{boundingRect:R,viewBB:N,rfId:I}=(0,c.oR)(g,o.X),k=e?.width??200,D=e?.height??150,L=R.width/k,U=R.height/D,F=Math.max(L,U),B=F*k,z=F*D,j=C*F,V=R.x-(B-R.width)/2-j,G=R.y-(z-R.height)/2-j,H=B+2*j,W=z+2*j,q=`react-flow__minimap-desc-${I}`,X=(0,r.useRef)(0);X.current=F,(0,r.useEffect)((()=>{if(P.current){const e=(0,a.Z)(P.current),t=e=>{const{transform:t,d3Selection:n,d3Zoom:r}=O.getState();if("wheel"!==e.sourceEvent.type||!n||!r)return;const i=-e.sourceEvent.deltaY*(1===e.sourceEvent.deltaMode?.05:e.sourceEvent.deltaMode?1:.002)*A,o=t[2]*Math.pow(2,i);r.scaleTo(n,o)},n=e=>{const{transform:t,d3Selection:n,d3Zoom:r,translateExtent:i,width:o,height:a}=O.getState();if("mousemove"!==e.sourceEvent.type||!n||!r)return;const u=X.current*Math.max(1,t[2])*(M?-1:1),c={x:t[0]-e.sourceEvent.movementX*u,y:t[1]-e.sourceEvent.movementY*u},l=[[0,0],[o,a]],h=s.CR.translate(c.x,c.y).scale(t[2]),d=r.constrain()(h,l,i);r.transform(n,d)},r=(0,s.sP)().on("zoom",S?n:null).on("zoom.wheel",E?t:null);return e.call(r),()=>{e.on("zoom",null)}}}),[S,E,M,A]);const Z=x?e=>{const t=(0,u.Z)(e);x(e,{x:t[0],y:t[1]})}:void 0,$=w?(e,t)=>{const n=O.getState().nodeInternals.get(t);w(e,n)}:void 0;return r.createElement(c.s_,{position:_,style:e,className:(0,i.Z)(["react-flow__minimap",t]),"data-testid":"rf__minimap"},r.createElement("svg",{width:k,height:D,viewBox:`${V} ${G} ${H} ${W}`,role:"img","aria-labelledby":q,ref:P,onClick:Z},T&&r.createElement("title",{id:q},T),r.createElement(m,{onClick:$,nodeColor:l,nodeStrokeColor:n,nodeBorderRadius:d,nodeClassName:h,nodeStrokeWidth:f,nodeComponent:p}),r.createElement("path",{className:"react-flow__minimap-mask",d:`M${V-j},${G-j}h${H+2*j}v${W+2*j}h${-H-2*j}z\n        M${N.x},${N.y}h${N.width}v${N.height}h${-N.width}z`,fill:v,fillRule:"evenodd",stroke:y,strokeWidth:b,pointerEvents:"none"})))}v.displayName="MiniMap";var y=(0,r.memo)(v)},83109:function(e,t,n){"use strict";n.d(t,{ZA:function(){return s},kX:function(){return l},oY:function(){return i}});var r,i=Object.freeze({Linear:Object.freeze({None:function(e){return e},In:function(e){return e},Out:function(e){return e},InOut:function(e){return e}}),Quadratic:Object.freeze({In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}}),Circular:Object.freeze({In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}}),Back:Object.freeze({In:function(e){var t=1.70158;return 1===e?1:e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return 0===e?0:--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}),Bounce:Object.freeze({In:function(e){return 1-i.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*i.Bounce.In(2*e):.5*i.Bounce.Out(2*e-1)+.5}}),generatePow:function(e){return void 0===e&&(e=4),e=(e=e<Number.EPSILON?Number.EPSILON:e)>1e4?1e4:e,{In:function(t){return Math.pow(t,e)},Out:function(t){return 1-Math.pow(1-t,e)},InOut:function(t){return t<.5?Math.pow(2*t,e)/2:(1-Math.pow(2-2*t,e))/2+.5}}}}),o=function(){return performance.now()},s=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return e.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map((function(t){return e._tweens[t]}))},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var o=i[r];null===(e=o._group)||void 0===e||e.remove(o),o._group=this,this._tweens[o.getId()]=o,this._tweensAddedDuringUpdate[o.getId()]=o}},e.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,r=e;n<r.length;n++){var i=r[n];i._group=void 0,delete this._tweens[i.getId()],delete this._tweensAddedDuringUpdate[i.getId()]}},e.prototype.allStopped=function(){return this.getAll().every((function(e){return!e.isPlaying()}))},e.prototype.update=function(e,t){void 0===e&&(e=o()),void 0===t&&(t=!0);var n=Object.keys(this._tweens);if(0!==n.length)for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<n.length;r++){var i=this._tweens[n[r]],s=!t;i&&!1===i.update(e,s)&&!t&&this.remove(i)}n=Object.keys(this._tweensAddedDuringUpdate)}},e}(),a={Linear:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),o=a.Utils.Linear;return t<0?o(e[0],e[1],r):t>1?o(e[n],e[n-1],n-r):o(e[i],e[i+1>n?n:i+1],r-i)},Bezier:function(e,t){for(var n=0,r=e.length-1,i=Math.pow,o=a.Utils.Bernstein,s=0;s<=r;s++)n+=i(1-t,r-s)*i(t,s)*e[s]*o(r,s);return n},CatmullRom:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),o=a.Utils.CatmullRom;return e[0]===e[n]?(t<0&&(i=Math.floor(r=n*(1+t))),o(e[(i-1+n)%n],e[i],e[(i+1)%n],e[(i+2)%n],r-i)):t<0?e[0]-(o(e[0],e[0],e[1],e[1],-r)-e[0]):t>1?e[n]-(o(e[n],e[n],e[n-1],e[n-1],r-n)-e[n]):o(e[i?i-1:0],e[i],e[n<i+1?n:i+1],e[n<i+2?n:i+2],r-i)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=a.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:(r=[1],function(e){var t=1;if(r[e])return r[e];for(var n=e;n>1;n--)t*=n;return r[e]=t,t}),CatmullRom:function(e,t,n,r,i){var o=.5*(n-e),s=.5*(r-t),a=i*i;return(2*t-2*n+o+s)*(i*a)+(-3*t+3*n-2*o-s)*a+o*i+t}}},u=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),c=new s,l=function(){function e(e,t){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=i.Linear.None,this._interpolationFunction=a.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=u.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,"object"==typeof t?(this._group=t,t.add(this)):!0===t&&(this._group=c,c.add(this))}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.getDuration=function(){return this._duration},e.prototype.to=function(e,t){if(void 0===t&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},e.prototype.duration=function(e){return void 0===e&&(e=1e3),this._duration=e<0?0:e,this},e.prototype.dynamic=function(e){return void 0===e&&(e=!1),this._isDynamic=e,this},e.prototype.start=function(e,t){if(void 0===e&&(e=o()),void 0===t&&(t=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed)for(var n in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var i in this._valuesEnd)r[i]=this._valuesEnd[i];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},e.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},e.prototype._setupProperties=function(e,t,n,r,i){for(var o in n){var s=e[o],a=Array.isArray(s),u=a?"array":typeof s,c=!a&&Array.isArray(n[o]);if("undefined"!==u&&"function"!==u){if(c){if(0===(g=n[o]).length)continue;for(var l=[s],h=0,d=g.length;h<d;h+=1){var f=this._handleRelativeValue(s,g[h]);if(isNaN(f)){c=!1,console.warn("Found invalid interpolation list. Skipping.");break}l.push(f)}c&&(n[o]=l)}if("object"!==u&&!a||!s||c)(void 0===t[o]||i)&&(t[o]=s),a||(t[o]*=1),r[o]=c?n[o].slice().reverse():t[o]||0;else{t[o]=a?[]:{};var p=s;for(var m in p)t[o][m]=p[m];r[o]=a?[]:{};var g=n[o];if(!this._isDynamic){var v={};for(var m in g)v[m]=g[m];n[o]=g=v}this._setupProperties(p,t[o],g,r[o],i)}}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},e.prototype.pause=function(e){return void 0===e&&(e=o()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e),this},e.prototype.resume=function(e){return void 0===e&&(e=o()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this):this},e.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},e.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},e.prototype.remove=function(){var e;return null===(e=this._group)||void 0===e||e.remove(this),this},e.prototype.delay=function(e){return void 0===e&&(e=0),this._delayTime=e,this},e.prototype.repeat=function(e){return void 0===e&&(e=0),this._initialRepeat=e,this._repeat=e,this},e.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},e.prototype.yoyo=function(e){return void 0===e&&(e=!1),this._yoyo=e,this},e.prototype.easing=function(e){return void 0===e&&(e=i.Linear.None),this._easingFunction=e,this},e.prototype.interpolation=function(e){return void 0===e&&(e=a.Linear),this._interpolationFunction=e,this},e.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},e.prototype.onStart=function(e){return this._onStartCallback=e,this},e.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},e.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},e.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},e.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},e.prototype.onStop=function(e){return this._onStopCallback=e,this},e.prototype.update=function(t,n){var r,i,s=this;if(void 0===t&&(t=o()),void 0===n&&(n=e.autoStartOnUpdate),this._isPaused)return!0;if(!this._goToEnd&&!this._isPlaying){if(!n)return!1;this.start(t,!0)}if(this._goToEnd=!1,t<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),!1===this._onEveryStartCallbackFired&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var a=t-this._startTime,u=this._duration+(null!==(r=this._repeatDelayTime)&&void 0!==r?r:this._delayTime),c=this._duration+this._repeat*u,l=function(){if(0===s._duration)return 1;if(a>c)return 1;var e=Math.trunc(a/u),t=a-e*u,n=Math.min(t/s._duration,1);return 0===n&&a===s._duration?1:n}(),h=this._easingFunction(l);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,h),this._onUpdateCallback&&this._onUpdateCallback(this._object,l),0===this._duration||a>=this._duration){if(this._repeat>0){var d=Math.min(Math.trunc((a-this._duration)/u)+1,this._repeat);for(i in isFinite(this._repeat)&&(this._repeat-=d),this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[i]||(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo&&this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=u*d,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var f=0,p=this._chainedTweens.length;f<p;f++)this._chainedTweens[f].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(e,t,n,r){for(var i in n)if(void 0!==t[i]){var o=t[i]||0,s=n[i],a=Array.isArray(e[i]),u=Array.isArray(s);!a&&u?e[i]=this._interpolationFunction(s,r):"object"==typeof s&&s?this._updateProperties(e[i],o,s,r):"number"==typeof(s=this._handleRelativeValue(o,s))&&(e[i]=o+(s-o)*r)}},e.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},e.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],n=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof n?this._valuesStartRepeat[e]+parseFloat(n):this._valuesEnd[e],this._valuesEnd[e]=t},e.autoStartOnUpdate=!1,e}(),h=(u.nextId,c);h.getAll.bind(h),h.removeAll.bind(h),h.add.bind(h),h.remove.bind(h),h.update.bind(h)},43300:function(e,t,n){"use strict";n.d(t,{B8:function(){return E},Il:function(){return i},J5:function(){return s},SU:function(){return S},Ss:function(){return T},ZP:function(){return _},xV:function(){return o}});var r=n(90368);function i(){}var o=.7,s=1/o,a="\\s*([+-]?\\d+)\\s*",u="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",c="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",l=/^#([0-9a-f]{3,8})$/,h=new RegExp("^rgb\\(".concat(a,",").concat(a,",").concat(a,"\\)$")),d=new RegExp("^rgb\\(".concat(c,",").concat(c,",").concat(c,"\\)$")),f=new RegExp("^rgba\\(".concat(a,",").concat(a,",").concat(a,",").concat(u,"\\)$")),p=new RegExp("^rgba\\(".concat(c,",").concat(c,",").concat(c,",").concat(u,"\\)$")),m=new RegExp("^hsl\\(".concat(u,",").concat(c,",").concat(c,"\\)$")),g=new RegExp("^hsla\\(".concat(u,",").concat(c,",").concat(c,",").concat(u,"\\)$")),v={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function y(){return this.rgb().formatHex()}function b(){return this.rgb().formatRgb()}function _(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=l.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?x(t):3===n?new T(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?w(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?w(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=h.exec(e))?new T(t[1],t[2],t[3],1):(t=d.exec(e))?new T(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=f.exec(e))?w(t[1],t[2],t[3],t[4]):(t=p.exec(e))?w(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=m.exec(e))?R(t[1],t[2]/100,t[3]/100,1):(t=g.exec(e))?R(t[1],t[2]/100,t[3]/100,t[4]):v.hasOwnProperty(e)?x(v[e]):"transparent"===e?new T(NaN,NaN,NaN,0):null}function x(e){return new T(e>>16&255,e>>8&255,255&e,1)}function w(e,t,n,r){return r<=0&&(e=t=n=NaN),new T(e,t,n,r)}function S(e){return e instanceof i||(e=_(e)),e?new T((e=e.rgb()).r,e.g,e.b,e.opacity):new T}function E(e,t,n,r){return 1===arguments.length?S(e):new T(e,t,n,null==r?1:r)}function T(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function M(){return"#".concat(P(this.r)).concat(P(this.g)).concat(P(this.b))}function A(){var e=C(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(O(this.r),", ").concat(O(this.g),", ").concat(O(this.b)).concat(1===e?")":", ".concat(e,")"))}function C(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function O(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function P(e){return((e=O(e))<16?"0":"")+e.toString(16)}function R(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new I(e,t,n,r)}function N(e){if(e instanceof I)return new I(e.h,e.s,e.l,e.opacity);if(e instanceof i||(e=_(e)),!e)return new I;if(e instanceof I)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),s=Math.max(t,n,r),a=NaN,u=s-o,c=(s+o)/2;return u?(a=t===s?(n-r)/u+6*(n<r):n===s?(r-t)/u+2:(t-n)/u+4,u/=c<.5?s+o:2-s-o,a*=60):u=c>0&&c<1?0:a,new I(a,u,c,e.opacity)}function I(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function k(e){return(e=(e||0)%360)<0?e+360:e}function D(e){return Math.max(0,Math.min(1,e||0))}function L(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}(0,r.Z)(i,_,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:y,formatHex:y,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return N(this).formatHsl()},formatRgb:b,toString:b}),(0,r.Z)(T,E,(0,r.l)(i,{brighter:function(e){return e=null==e?s:Math.pow(s,e),new T(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?o:Math.pow(o,e),new T(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},clamp:function(){return new T(O(this.r),O(this.g),O(this.b),C(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:M,formatHex:M,formatHex8:function(){return"#".concat(P(this.r)).concat(P(this.g)).concat(P(this.b)).concat(P(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:A,toString:A})),(0,r.Z)(I,(function(e,t,n,r){return 1===arguments.length?N(e):new I(e,t,n,null==r?1:r)}),(0,r.l)(i,{brighter:function(e){return e=null==e?s:Math.pow(s,e),new I(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?o:Math.pow(o,e),new I(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new T(L(e>=240?e-240:e+120,i,r),L(e,i,r),L(e<120?e+240:e-120,i,r),this.opacity)},clamp:function(){return new I(k(this.h),D(this.s),D(this.l),C(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=C(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(k(this.h),", ").concat(100*D(this.s),"%, ").concat(100*D(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}))},90368:function(e,t,n){"use strict";function r(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function i(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}n.d(t,{Z:function(){return r},l:function(){return i}})},32436:function(e,t){"use strict";var n={value:function(){}};function r(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new i(r)}function i(e){this._=e}function o(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function s(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function a(e,t,r){for(var i=0,o=e.length;i<o;++i)if(e[i].name===t){e[i]=n,e=e.slice(0,i).concat(e.slice(i+1));break}return null!=r&&e.push({name:t,value:r}),e}i.prototype=r.prototype={constructor:i,on:function(e,t){var n,r=this._,i=o(e+"",r),u=-1,c=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++u<c;)if(n=(e=i[u]).type)r[n]=a(r[n],e.name,t);else if(null==t)for(n in r)r[n]=a(r[n],e.name,null);return this}for(;++u<c;)if((n=(e=i[u]).type)&&(n=s(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new i(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(r=this._[e]).length;o<n;++o)r[o].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,o=r.length;i<o;++i)r[i].value.apply(t,n)}},t.Z=r},46015:function(e,t,n){"use strict";function r(e){return null==e?null:i(e)}function i(e){if("function"!=typeof e)throw new Error;return e}n.d(t,{C:function(){return i},j:function(){return r}})},89329:function(e,t,n){"use strict";function r(){return 0}function i(e){return function(){return e}}n.d(t,{G:function(){return r},Z:function(){return i}})},4081:function(e,t,n){"use strict";n.d(t,{NB:function(){return p},le:function(){return f},ZP:function(){return c}});var r=n(82092);function i(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}var o=n(335);var s=n(90228),a=s().mark(u);function u(){var e,t,n,r,i,o;return s().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:n=[e=this];case 1:t=n.reverse(),n=[];case 2:if(!(e=t.pop())){s.next=8;break}return s.next=5,e;case 5:if(r=e.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);s.next=2;break;case 8:if(n.length){s.next=1;break}case 9:case"end":return s.stop()}}),a,this)}function c(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=h)):void 0===t&&(t=l);for(var n,r,i,o,s,a=new p(e),u=[a];n=u.pop();)if((i=t(n.data))&&(s=(i=Array.from(i)).length))for(n.children=i,o=s-1;o>=0;--o)u.push(r=i[o]=new p(i[o])),r.parent=n,r.depth=n.depth+1;return a.eachBefore(f)}function l(e){return e.children}function h(e){return Array.isArray(e)?e[1]:null}function d(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function f(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function p(e){this.data=e,this.depth=this.height=0,this.parent=null}p.prototype=c.prototype=r({constructor:p,count:function(){return this.eachAfter(i)},each:function(e,t){var n,r=-1,i=o(this);try{for(i.s();!(n=i.n()).done;){var s=n.value;e.call(t,s,++r,this)}}catch(e){i.e(e)}finally{i.f()}return this},eachAfter:function(e,t){for(var n,r,i,o=this,s=[o],a=[],u=-1;o=s.pop();)if(a.push(o),n=o.children)for(r=0,i=n.length;r<i;++r)s.push(n[r]);for(;o=a.pop();)e.call(t,o,++u,this);return this},eachBefore:function(e,t){for(var n,r,i=this,o=[i],s=-1;i=o.pop();)if(e.call(t,i,++s,this),n=i.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},find:function(e,t){var n,r=-1,i=o(this);try{for(i.s();!(n=i.n()).done;){var s=n.value;if(e.call(t,s,++r,this))return s}}catch(e){i.e(e)}finally{i.f()}},sum:function(e){return this.eachAfter((function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n}))},sort:function(e){return this.eachBefore((function(t){t.children&&t.children.sort(e)}))},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;e=n.pop(),t=r.pop();for(;e===t;)i=e,e=n.pop(),t=r.pop();return i}(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore((function(t){t.children||e.push(t)})),e},links:function(){var e=this,t=[];return e.each((function(n){n!==e&&t.push({source:n.parent,target:n})})),t},copy:function(){return c(this).eachBefore(d)}},Symbol.iterator,u)},62432:function(e,t,n){"use strict";n.d(t,{Z:function(){return x}});var r=n(46015),i=n(89329),o=4294967296;var s=n(31759);function a(e,t){for(var n,r,i=0,o=(e=function(e,t){for(var n,r,i=e.length;i;)r=t()*i--|0,n=e[i],e[i]=e[r],e[r]=n;return e}(Array.from(e),t)).length,s=[];i<o;)n=e[i],r&&l(r,n)?++i:(r=d(s=u(s,n)),i=0);return r}function u(e,t){var n,r;if(h(t,e))return[t];for(n=0;n<e.length;++n)if(c(t,e[n])&&h(f(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(c(f(e[n],e[r]),t)&&c(f(e[n],t),e[r])&&c(f(e[r],t),e[n])&&h(p(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function c(e,t){var n=e.r-t.r,r=t.x-e.x,i=t.y-e.y;return n<0||n*n<r*r+i*i}function l(e,t){var n=e.r-t.r+1e-9*Math.max(e.r,t.r,1),r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function h(e,t){for(var n=0;n<t.length;++n)if(!l(e,t[n]))return!1;return!0}function d(e){switch(e.length){case 1:return function(e){return{x:e.x,y:e.y,r:e.r}}(e[0]);case 2:return f(e[0],e[1]);case 3:return p(e[0],e[1],e[2])}}function f(e,t){var n=e.x,r=e.y,i=e.r,o=t.x,s=t.y,a=t.r,u=o-n,c=s-r,l=a-i,h=Math.sqrt(u*u+c*c);return{x:(n+o+u/h*l)/2,y:(r+s+c/h*l)/2,r:(h+i+a)/2}}function p(e,t,n){var r=e.x,i=e.y,o=e.r,s=t.x,a=t.y,u=t.r,c=n.x,l=n.y,h=n.r,d=r-s,f=r-c,p=i-a,m=i-l,g=u-o,v=h-o,y=r*r+i*i-o*o,b=y-s*s-a*a+u*u,_=y-c*c-l*l+h*h,x=f*p-d*m,w=(p*_-m*b)/(2*x)-r,S=(m*g-p*v)/x,E=(f*b-d*_)/(2*x)-i,T=(d*v-f*g)/x,M=S*S+T*T-1,A=2*(o+w*S+E*T),C=w*w+E*E-o*o,O=-(Math.abs(M)>1e-6?(A+Math.sqrt(A*A-4*M*C))/(2*M):C/A);return{x:r+w+S*O,y:i+E+T*O,r:O}}function m(e,t,n){var r,i,o,s,a=e.x-t.x,u=e.y-t.y,c=a*a+u*u;c?(i=t.r+n.r,i*=i,s=e.r+n.r,i>(s*=s)?(r=(c+s-i)/(2*c),o=Math.sqrt(Math.max(0,s/c-r*r)),n.x=e.x-r*a-o*u,n.y=e.y-r*u+o*a):(r=(c+i-s)/(2*c),o=Math.sqrt(Math.max(0,i/c-r*r)),n.x=t.x+r*a-o*u,n.y=t.y+r*u+o*a)):(n.x=t.x+n.r,n.y=t.y)}function g(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,i=t.y-e.y;return n>0&&n*n>r*r+i*i}function v(e){var t=e._,n=e.next._,r=t.r+n.r,i=(t.x*n.r+n.x*t.r)/r,o=(t.y*n.r+n.y*t.r)/r;return i*i+o*o}function y(e){this._=e,this.next=null,this.previous=null}function b(e,t){if(!(u=(n=e,e="object"===s(n)&&"length"in n?n:Array.from(n)).length))return 0;var n,r,i,o,u,c,l,h,d,f,p,b;if((r=e[0]).x=0,r.y=0,!(u>1))return r.r;if(i=e[1],r.x=-i.r,i.x=r.r,i.y=0,!(u>2))return r.r+i.r;m(i,r,o=e[2]),r=new y(r),i=new y(i),o=new y(o),r.next=o.previous=i,i.next=r.previous=o,o.next=i.previous=r;e:for(h=3;h<u;++h){m(r._,i._,o=e[h]),o=new y(o),d=i.next,f=r.previous,p=i._.r,b=r._.r;do{if(p<=b){if(g(d._,o._)){i=d,r.next=i,i.previous=r,--h;continue e}p+=d._.r,d=d.next}else{if(g(f._,o._)){(r=f).next=i,i.previous=r,--h;continue e}b+=f._.r,f=f.previous}}while(d!==f.next);for(o.previous=r,o.next=i,r.next=i.previous=i=o,c=v(r);(o=o.next)!==i;)(l=v(o))<c&&(r=o,c=l);i=r.next}for(r=[i._],o=i;(o=o.next)!==i;)r.push(o._);for(o=a(r,t),h=0;h<u;++h)(r=e[h]).x-=o.x,r.y-=o.y;return o.r}function _(e){return Math.sqrt(e.value)}function x(){var e=null,t=1,n=1,s=i.G;function a(r){var a,u=(a=1,function(){return(a=(1664525*a+1013904223)%o)/o});return r.x=t/2,r.y=n/2,e?r.eachBefore(w(e)).eachAfter(S(s,.5,u)).eachBefore(E(1)):r.eachBefore(w(_)).eachAfter(S(i.G,1,u)).eachAfter(S(s,r.r/Math.min(t,n),u)).eachBefore(E(Math.min(t,n)/(2*r.r))),r}return a.radius=function(t){return arguments.length?(e=(0,r.j)(t),a):e},a.size=function(e){return arguments.length?(t=+e[0],n=+e[1],a):[t,n]},a.padding=function(e){return arguments.length?(s="function"==typeof e?e:(0,i.Z)(+e),a):s},a}function w(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function S(e,t,n){return function(r){if(i=r.children){var i,o,s,a=i.length,u=e(r)*t||0;if(u)for(o=0;o<a;++o)i[o].r+=u;if(s=b(i,n),u)for(o=0;o<a;++o)i[o].r-=u;r.r=s+u}}}function E(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}},42558:function(e,t,n){"use strict";n.d(t,{ZP:function(){return a},wx:function(){return o},yi:function(){return s}});var r=n(41042);function i(e,t){return function(n){return e+n*t}}function o(e,t){var n=t-e;return n?i(e,n>180||n<-180?n-360*Math.round(n/360):n):(0,r.Z)(isNaN(e)?t:e)}function s(e){return 1==(e=+e)?a:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):(0,r.Z)(isNaN(t)?n:t)}}function a(e,t){var n=t-e;return n?i(e,n):(0,r.Z)(isNaN(e)?t:e)}},41042:function(e,t){"use strict";t.Z=function(e){return function(){return e}}},88486:function(e,t,n){"use strict";function r(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}n.d(t,{Z:function(){return r}})},45106:function(e,t,n){"use strict";n.d(t,{ZP:function(){return s},hD:function(){return u}});var r=n(43300);function i(e,t,n,r,i){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*n+(1+3*e+3*o-3*s)*r+s*i)/6}var o=n(42558),s=function e(t){var n=(0,o.yi)(t);function i(e,t){var i=n((e=(0,r.B8)(e)).r,(t=(0,r.B8)(t)).r),s=n(e.g,t.g),a=n(e.b,t.b),u=(0,o.ZP)(e.opacity,t.opacity);return function(t){return e.r=i(t),e.g=s(t),e.b=a(t),e.opacity=u(t),e+""}}return i.gamma=e,i}(1);function a(e){return function(t){var n,i,o=t.length,s=new Array(o),a=new Array(o),u=new Array(o);for(n=0;n<o;++n)i=(0,r.B8)(t[n]),s[n]=i.r||0,a[n]=i.g||0,u[n]=i.b||0;return s=e(s),a=e(a),u=e(u),i.opacity=1,function(e){return i.r=s(e),i.g=a(e),i.b=u(e),i+""}}}var u=a((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),o=e[r],s=e[r+1],a=r>0?e[r-1]:2*o-s,u=r<t-1?e[r+2]:2*s-o;return i((n-r/t)*t,a,o,s,u)}}));a((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),o=e[(r+t-1)%t],s=e[r%t],a=e[(r+1)%t],u=e[(r+2)%t];return i((n-r/t)*t,o,s,a,u)}}))},28685:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(88486),i=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,o=new RegExp(i.source,"g");function s(e,t){var n,s,a,u=i.lastIndex=o.lastIndex=0,c=-1,l=[],h=[];for(e+="",t+="";(n=i.exec(e))&&(s=o.exec(t));)(a=s.index)>u&&(a=t.slice(u,a),l[c]?l[c]+=a:l[++c]=a),(n=n[0])===(s=s[0])?l[c]?l[c]+=s:l[++c]=s:(l[++c]=null,h.push({i:c,x:(0,r.Z)(n,s)})),u=o.lastIndex;return u<t.length&&(a=t.slice(u),l[c]?l[c]+=a:l[++c]=a),l.length<2?h[0]?function(e){return function(t){return e(t)+""}}(h[0].x):function(e){return function(){return e}}(t):(t=h.length,function(e){for(var n,r=0;r<t;++r)l[(n=h[r]).i]=n.x(e);return l.join("")})}},54400:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(31759),i=n(43300),o=n(45106);function s(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,o=new Array(i),s=new Array(r);for(n=0;n<i;++n)o[n]=f(e[n],t[n]);for(;n<r;++n)s[n]=t[n];return function(e){for(n=0;n<i;++n)s[n]=o[n](e);return s}}function a(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}var u=n(88486);function c(e,t){var n,i={},o={};for(n in null!==e&&"object"===r(e)||(e={}),null!==t&&"object"===r(t)||(t={}),t)n in e?i[n]=f(e[n],t[n]):o[n]=t[n];return function(e){for(n in i)o[n]=i[n](e);return o}}var l=n(28685),h=n(41042);function d(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(o){for(n=0;n<r;++n)i[n]=e[n]*(1-o)+t[n]*o;return i}}function f(e,t){var n,f,p=r(t);return null==t||"boolean"===p?(0,h.Z)(t):("number"===p?u.Z:"string"===p?(n=(0,i.ZP)(t))?(t=n,o.ZP):l.Z:t instanceof i.ZP?o.ZP:t instanceof Date?a:(f=t,!ArrayBuffer.isView(f)||f instanceof DataView?Array.isArray(t)?s:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?c:u.Z:d))(e,t)}},66819:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var r=function(e){return"function"==typeof e?e:"string"==typeof e?function(t){return t[e]}:function(t){return e}}},28680:function(e,t,n){"use strict";function r(e){if("string"==typeof e||"number"==typeof e)return""+e;let t="";if(Array.isArray(e))for(let n,i=0;i<e.length;i++)""!==(n=r(e[i]))&&(t+=(t&&" ")+n);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}n.d(t,{Z:function(){return r}})},64784:function(e,t,n){"use strict";function r(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}n.d(t,{Z:function(){return r}})},44080:function(e,t,n){"use strict";n.d(t,{Nw:function(){return u},ZR:function(){return c}});var r=n(64784),i=n(40139),o=n(51578);const s=(0,i.Z)(r.Z),a=s.right,u=s.left,c=(0,i.Z)(o.Z).center;t.ZP=a},40139:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(64784);function i(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function o(e){let t,n,o;function a(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<0?i=t+1:o=t}while(i<o)}return i}return 2!==e.length?(t=r.Z,n=(t,n)=>(0,r.Z)(e(t),n),o=(t,n)=>e(t)-n):(t=e===r.Z||e===i?e:s,n=e,o=e),{left:a,center:function(e,t,n=0,r=e.length){const i=a(e,t,n,r-1);return i>n&&o(e[i-1],t)>-o(e[i],t)?i-1:i},right:function(e,r,i=0,o=e.length){if(i<o){if(0!==t(r,r))return o;do{const t=i+o>>>1;n(e[t],r)<=0?i=t+1:o=t}while(i<o)}return i}}}function s(){return 0}},86925:function(e,t,n){"use strict";function r(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}n.d(t,{Z:function(){return r}})},49085:function(e,t,n){"use strict";function r(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}n.d(t,{Z:function(){return r}})},51578:function(e,t,n){"use strict";function r(e){return null===e?NaN:+e}function*i(e,t){if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&(yield r)}}n.d(t,{K:function(){return i},Z:function(){return r}})},77252:function(e,t,n){"use strict";n.d(t,{G9:function(){return u},ZP:function(){return a},ly:function(){return c}});const r=Math.sqrt(50),i=Math.sqrt(10),o=Math.sqrt(2);function s(e,t,n){const a=(t-e)/Math.max(0,n),u=Math.floor(Math.log10(a)),c=a/Math.pow(10,u),l=c>=r?10:c>=i?5:c>=o?2:1;let h,d,f;return u<0?(f=Math.pow(10,-u)/l,h=Math.round(e*f),d=Math.round(t*f),h/f<e&&++h,d/f>t&&--d,f=-f):(f=Math.pow(10,u)*l,h=Math.round(e/f),d=Math.round(t/f),h*f<e&&++h,d*f>t&&--d),d<h&&.5<=n&&n<2?s(e,t,2*n):[h,d,f]}function a(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];const r=t<e,[i,o,a]=r?s(t,e,n):s(e,t,n);if(!(o>=i))return[];const u=o-i+1,c=new Array(u);if(r)if(a<0)for(let e=0;e<u;++e)c[e]=(o-e)/-a;else for(let e=0;e<u;++e)c[e]=(o-e)*a;else if(a<0)for(let e=0;e<u;++e)c[e]=(i+e)/-a;else for(let e=0;e<u;++e)c[e]=(i+e)*a;return c}function u(e,t,n){return s(e=+e,t=+t,n=+n)[2]}function c(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?u(t,e,n):u(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}},19753:function(e,t,n){"use strict";function r(e,t,n){if(isNaN(t))return e;var r,i,o,s,a,u,c=e._root,l={data:n},h=e._x0,d=e._x1;if(!c)return e._root=l,e;for(;c.length;)if((s=t>=(i=(h+d)/2))?h=i:d=i,r=c,!(c=c[a=+s]))return r[a]=l,e;if(t===(o=+e._x.call(null,c.data)))return l.next=c,r?r[a]=l:e._root=l,e;do{r=r?r[a]=new Array(2):e._root=new Array(2),(s=t>=(i=(h+d)/2))?h=i:d=i}while((a=+s)==(u=+(o>=i)));return r[u]=c,r[a]=l,e}function i(e,t,n){this.node=e,this.x0=t,this.x1=n}function o(e){return e[0]}function s(e,t){var n=new a(null==t?o:t,NaN,NaN);return null==e?n:n.addAll(e)}function a(e,t,n){this._x=e,this._x0=t,this._x1=n,this._root=void 0}function u(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}n.d(t,{Z:function(){return s}});var c=s.prototype=a.prototype;c.copy=function(){var e,t,n=new a(this._x,this._x0,this._x1),r=this._root;if(!r)return n;if(!r.length)return n._root=u(r),n;for(e=[{source:r,target:n._root=new Array(2)}];r=e.pop();)for(var i=0;i<2;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=new Array(2)}):r.target[i]=u(t));return n},c.add=function(e){const t=+this._x.call(null,e);return r(this.cover(t),t,e)},c.addAll=function(e){Array.isArray(e)||(e=Array.from(e));const t=e.length,n=new Float64Array(t);let i=1/0,o=-1/0;for(let r,s=0;s<t;++s)isNaN(r=+this._x.call(null,e[s]))||(n[s]=r,r<i&&(i=r),r>o&&(o=r));if(i>o)return this;this.cover(i).cover(o);for(let i=0;i<t;++i)r(this,n[i],e[i]);return this},c.cover=function(e){if(isNaN(e=+e))return this;var t=this._x0,n=this._x1;if(isNaN(t))n=(t=Math.floor(e))+1;else{for(var r,i,o=n-t||1,s=this._root;t>e||e>=n;)switch(i=+(e<t),(r=new Array(2))[i]=s,s=r,o*=2,i){case 0:n=t+o;break;case 1:t=n-o}this._root&&this._root.length&&(this._root=s)}return this._x0=t,this._x1=n,this},c.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},c.extent=function(e){return arguments.length?this.cover(+e[0][0]).cover(+e[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]},c.find=function(e,t){var n,r,o,s,a,u=this._x0,c=this._x1,l=[],h=this._root;for(h&&l.push(new i(h,u,c)),null==t?t=1/0:(u=e-t,c=e+t);s=l.pop();)if(!(!(h=s.node)||(r=s.x0)>c||(o=s.x1)<u))if(h.length){var d=(r+o)/2;l.push(new i(h[1],d,o),new i(h[0],r,d)),(a=+(e>=d))&&(s=l[l.length-1],l[l.length-1]=l[l.length-1-a],l[l.length-1-a]=s)}else{var f=Math.abs(e-+this._x.call(null,h.data));f<t&&(t=f,u=e-f,c=e+f,n=h.data)}return n},c.remove=function(e){if(isNaN(o=+this._x.call(null,e)))return this;var t,n,r,i,o,s,a,u,c,l=this._root,h=this._x0,d=this._x1;if(!l)return this;if(l.length)for(;;){if((a=o>=(s=(h+d)/2))?h=s:d=s,t=l,!(l=l[u=+a]))return this;if(!l.length)break;t[u+1&1]&&(n=t,c=u)}for(;l.data!==e;)if(r=l,!(l=l.next))return this;return(i=l.next)&&delete l.next,r?(i?r.next=i:delete r.next,this):t?(i?t[u]=i:delete t[u],(l=t[0]||t[1])&&l===(t[1]||t[0])&&!l.length&&(n?n[c]=l:this._root=l),this):(this._root=i,this)},c.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},c.root=function(){return this._root},c.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},c.visit=function(e){var t,n,r,o,s=[],a=this._root;for(a&&s.push(new i(a,this._x0,this._x1));t=s.pop();)if(!e(a=t.node,r=t.x0,o=t.x1)&&a.length){var u=(r+o)/2;(n=a[1])&&s.push(new i(n,u,o)),(n=a[0])&&s.push(new i(n,r,u))}return this},c.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new i(this._root,this._x0,this._x1));t=n.pop();){var o=t.node;if(o.length){var s,a=t.x0,u=t.x1,c=(a+u)/2;(s=o[0])&&n.push(new i(s,a,c)),(s=o[1])&&n.push(new i(s,c,u))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.x1);return this},c.x=function(e){return arguments.length?(this._x=e,this):this._x}},2941:function(e,t,n){"use strict";n.d(t,{Dm:function(){return L}});var r=n(32436),i=n(49289),o=n(54400),s=n(41468),a=n(13802),u=n(21063),c=e=>()=>e;function l(e,{sourceEvent:t,target:n,selection:r,mode:i,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:r,enumerable:!0,configurable:!0},mode:{value:i,enumerable:!0,configurable:!0},_:{value:o}})}function h(e){e.stopImmediatePropagation()}function d(e){e.preventDefault(),e.stopImmediatePropagation()}var f={name:"drag"},p={name:"space"},m={name:"handle"},g={name:"center"};const{abs:v,max:y,min:b}=Math;function _(e){return[+e[0],+e[1]]}function x(e){return[_(e[0]),_(e[1])]}var w={name:"x",handles:["w","e"].map(P),input:function(e,t){return null==e?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},S={name:"y",handles:["n","s"].map(P),input:function(e,t){return null==e?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},E={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(P),input:function(e){return null==e?null:x(e)},output:function(e){return e}},T={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},M={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},A={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},C={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},O={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function P(e){return{type:e}}function R(e){return!e.ctrlKey&&!e.button}function N(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function I(){return navigator.maxTouchPoints||"ontouchstart"in this}function k(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function D(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}function L(){return U(E)}function U(e){var t,n=N,_=R,E=I,L=!0,U=(0,r.Z)("start","brush","end"),F=6;function B(t){var n=t.property("__brush",q).selectAll(".overlay").data([P("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",T.overlay).merge(n).each((function(){var e=k(this).extent;(0,s.Z)(this).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1])})),t.selectAll(".selection").data([P("selection")]).enter().append("rect").attr("class","selection").attr("cursor",T.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=t.selectAll(".handle").data(e.handles,(function(e){return e.type}));r.exit().remove(),r.enter().append("rect").attr("class",(function(e){return"handle handle--"+e.type})).attr("cursor",(function(e){return T[e.type]})),t.each(z).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",G).filter(E).on("touchstart.brush",G).on("touchmove.brush",H).on("touchend.brush touchcancel.brush",W).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function z(){var e=(0,s.Z)(this),t=k(this).selection;t?(e.selectAll(".selection").style("display",null).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1]),e.selectAll(".handle").style("display",null).attr("x",(function(e){return"e"===e.type[e.type.length-1]?t[1][0]-F/2:t[0][0]-F/2})).attr("y",(function(e){return"s"===e.type[0]?t[1][1]-F/2:t[0][1]-F/2})).attr("width",(function(e){return"n"===e.type||"s"===e.type?t[1][0]-t[0][0]+F:F})).attr("height",(function(e){return"e"===e.type||"w"===e.type?t[1][1]-t[0][1]+F:F}))):e.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function j(e,t,n){var r=e.__brush.emitter;return!r||n&&r.clean?new V(e,t,n):r}function V(e,t,n){this.that=e,this.args=t,this.state=e.__brush,this.active=0,this.clean=n}function G(n){if((!t||n.touches)&&_.apply(this,arguments)){var r,o,c,l,x,E,P,R,N,I,U,F=this,B=n.target.__data__.type,V="selection"===(L&&n.metaKey?B="overlay":B)?f:L&&n.altKey?g:m,G=e===S?null:C[B],H=e===w?null:O[B],W=k(F),q=W.extent,X=W.selection,Z=q[0][0],$=q[0][1],Y=q[1][0],K=q[1][1],Q=0,J=0,ee=G&&H&&L&&n.shiftKey,te=Array.from(n.touches||[n],(e=>{const t=e.identifier;return(e=(0,a.Z)(e,F)).point0=e.slice(),e.identifier=t,e}));(0,u.e1)(F);var ne=j(F,arguments,!0).beforestart();if("overlay"===B){X&&(N=!0);const t=[te[0],te[1]||te[0]];W.selection=X=[[r=e===S?Z:b(t[0][0],t[1][0]),c=e===w?$:b(t[0][1],t[1][1])],[x=e===S?Y:y(t[0][0],t[1][0]),P=e===w?K:y(t[0][1],t[1][1])]],te.length>1&&ae(n)}else r=X[0][0],c=X[0][1],x=X[1][0],P=X[1][1];o=r,l=c,E=x,R=P;var re=(0,s.Z)(F).attr("pointer-events","none"),ie=re.selectAll(".overlay").attr("cursor",T[B]);if(n.touches)ne.moved=se,ne.ended=ue;else{var oe=(0,s.Z)(n.view).on("mousemove.brush",se,!0).on("mouseup.brush",ue,!0);L&&oe.on("keydown.brush",ce,!0).on("keyup.brush",le,!0),(0,i.Z)(n.view)}z.call(F),ne.start(n,V.name)}function se(e){for(const t of e.changedTouches||[e])for(const e of te)e.identifier===t.identifier&&(e.cur=(0,a.Z)(t,F));if(ee&&!I&&!U&&1===te.length){const e=te[0];v(e.cur[0]-e[0])>v(e.cur[1]-e[1])?U=!0:I=!0}for(const e of te)e.cur&&(e[0]=e.cur[0],e[1]=e.cur[1]);N=!0,d(e),ae(e)}function ae(e){const t=te[0],n=t.point0;var i;switch(Q=t[0]-n[0],J=t[1]-n[1],V){case p:case f:G&&(Q=y(Z-r,b(Y-x,Q)),o=r+Q,E=x+Q),H&&(J=y($-c,b(K-P,J)),l=c+J,R=P+J);break;case m:te[1]?(G&&(o=y(Z,b(Y,te[0][0])),E=y(Z,b(Y,te[1][0])),G=1),H&&(l=y($,b(K,te[0][1])),R=y($,b(K,te[1][1])),H=1)):(G<0?(Q=y(Z-r,b(Y-r,Q)),o=r+Q,E=x):G>0&&(Q=y(Z-x,b(Y-x,Q)),o=r,E=x+Q),H<0?(J=y($-c,b(K-c,J)),l=c+J,R=P):H>0&&(J=y($-P,b(K-P,J)),l=c,R=P+J));break;case g:G&&(o=y(Z,b(Y,r-Q*G)),E=y(Z,b(Y,x+Q*G))),H&&(l=y($,b(K,c-J*H)),R=y($,b(K,P+J*H)))}E<o&&(G*=-1,i=r,r=x,x=i,i=o,o=E,E=i,B in M&&ie.attr("cursor",T[B=M[B]])),R<l&&(H*=-1,i=c,c=P,P=i,i=l,l=R,R=i,B in A&&ie.attr("cursor",T[B=A[B]])),W.selection&&(X=W.selection),I&&(o=X[0][0],E=X[1][0]),U&&(l=X[0][1],R=X[1][1]),X[0][0]===o&&X[0][1]===l&&X[1][0]===E&&X[1][1]===R||(W.selection=[[o,l],[E,R]],z.call(F),ne.brush(e,V.name))}function ue(e){if(h(e),e.touches){if(e.touches.length)return;t&&clearTimeout(t),t=setTimeout((function(){t=null}),500)}else(0,i.D)(e.view,N),oe.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);re.attr("pointer-events","all"),ie.attr("cursor",T.overlay),W.selection&&(X=W.selection),D(X)&&(W.selection=null,z.call(F)),ne.end(e,V.name)}function ce(e){switch(e.keyCode){case 16:ee=G&&H;break;case 18:V===m&&(G&&(x=E-Q*G,r=o+Q*G),H&&(P=R-J*H,c=l+J*H),V=g,ae(e));break;case 32:V!==m&&V!==g||(G<0?x=E-Q:G>0&&(r=o-Q),H<0?P=R-J:H>0&&(c=l-J),V=p,ie.attr("cursor",T.selection),ae(e));break;default:return}d(e)}function le(e){switch(e.keyCode){case 16:ee&&(I=U=ee=!1,ae(e));break;case 18:V===g&&(G<0?x=E:G>0&&(r=o),H<0?P=R:H>0&&(c=l),V=m,ae(e));break;case 32:V===p&&(e.altKey?(G&&(x=E-Q*G,r=o+Q*G),H&&(P=R-J*H,c=l+J*H),V=g):(G<0?x=E:G>0&&(r=o),H<0?P=R:H>0&&(c=l),V=m),ie.attr("cursor",T[B]),ae(e));break;default:return}d(e)}}function H(e){j(this,arguments).moved(e)}function W(e){j(this,arguments).ended(e)}function q(){var t=this.__brush||{selection:null};return t.extent=x(n.apply(this,arguments)),t.dim=e,t}return B.move=function(t,n,r){t.tween?t.on("start.brush",(function(e){j(this,arguments).beforestart().start(e)})).on("interrupt.brush end.brush",(function(e){j(this,arguments).end(e)})).tween("brush",(function(){var t=this,r=t.__brush,i=j(t,arguments),s=r.selection,a=e.input("function"==typeof n?n.apply(this,arguments):n,r.extent),u=(0,o.Z)(s,a);function c(e){r.selection=1===e&&null===a?null:u(e),z.call(t),i.brush()}return null!==s&&null!==a?c:c(1)})):t.each((function(){var t=this,i=arguments,o=t.__brush,s=e.input("function"==typeof n?n.apply(t,i):n,o.extent),a=j(t,i).beforestart();(0,u.e1)(t),o.selection=null===s?null:s,z.call(t),a.start(r).brush(r).end(r)}))},B.clear=function(e,t){B.move(e,null,t)},V.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(e,t){return this.starting?(this.starting=!1,this.emit("start",e,t)):this.emit("brush",e),this},brush:function(e,t){return this.emit("brush",e,t),this},end:function(e,t){return 0==--this.active&&(delete this.state.emitter,this.emit("end",e,t)),this},emit:function(t,n,r){var i=(0,s.Z)(this.that).datum();U.call(t,this.that,new l(t,{sourceEvent:n,target:B,selection:e.output(this.state.selection),mode:r,dispatch:U}),i)}},B.extent=function(e){return arguments.length?(n="function"==typeof e?e:c(x(e)),B):n},B.filter=function(e){return arguments.length?(_="function"==typeof e?e:c(!!e),B):_},B.touchable=function(e){return arguments.length?(E="function"==typeof e?e:c(!!e),B):E},B.handleSize=function(e){return arguments.length?(F=+e,B):F},B.keyModifiers=function(e){return arguments.length?(L=!!e,B):L},B.on=function(){var e=U.on.apply(U,arguments);return e===U?B:e},B}},45452:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var r=n(32436),i=n(41468),o=n(13802),s=n(49289),a=n(5873),u=e=>()=>e;function c(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:o,x:s,y:a,dx:u,dy:c,dispatch:l}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:l}})}function l(e){return!e.ctrlKey&&!e.button}function h(){return this.parentNode}function d(e,t){return null==t?{x:e.x,y:e.y}:t}function f(){return navigator.maxTouchPoints||"ontouchstart"in this}function p(){var e,t,n,p,m=l,g=h,v=d,y=f,b={},_=(0,r.Z)("start","drag","end"),x=0,w=0;function S(e){e.on("mousedown.drag",E).filter(y).on("touchstart.drag",A).on("touchmove.drag",C,a.Q7).on("touchend.drag touchcancel.drag",O).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function E(r,o){if(!p&&m.call(this,r,o)){var u=P(this,g.call(this,r,o),r,o,"mouse");u&&((0,i.Z)(r.view).on("mousemove.drag",T,a.Dd).on("mouseup.drag",M,a.Dd),(0,s.Z)(r.view),(0,a.rG)(r),n=!1,e=r.clientX,t=r.clientY,u("start",r))}}function T(r){if((0,a.ZP)(r),!n){var i=r.clientX-e,o=r.clientY-t;n=i*i+o*o>w}b.mouse("drag",r)}function M(e){(0,i.Z)(e.view).on("mousemove.drag mouseup.drag",null),(0,s.D)(e.view,n),(0,a.ZP)(e),b.mouse("end",e)}function A(e,t){if(m.call(this,e,t)){var n,r,i=e.changedTouches,o=g.call(this,e,t),s=i.length;for(n=0;n<s;++n)(r=P(this,o,e,t,i[n].identifier,i[n]))&&((0,a.rG)(e),r("start",e,i[n]))}}function C(e){var t,n,r=e.changedTouches,i=r.length;for(t=0;t<i;++t)(n=b[r[t].identifier])&&((0,a.ZP)(e),n("drag",e,r[t]))}function O(e){var t,n,r=e.changedTouches,i=r.length;for(p&&clearTimeout(p),p=setTimeout((function(){p=null}),500),t=0;t<i;++t)(n=b[r[t].identifier])&&((0,a.rG)(e),n("end",e,r[t]))}function P(e,t,n,r,i,s){var a,u,l,h=_.copy(),d=(0,o.Z)(s||n,t);if(null!=(l=v.call(e,new c("beforestart",{sourceEvent:n,target:S,identifier:i,active:x,x:d[0],y:d[1],dx:0,dy:0,dispatch:h}),r)))return a=l.x-d[0]||0,u=l.y-d[1]||0,function n(s,f,p){var m,g=d;switch(s){case"start":b[i]=n,m=x++;break;case"end":delete b[i],--x;case"drag":d=(0,o.Z)(p||f,t),m=x}h.call(s,e,new c(s,{sourceEvent:f,subject:l,target:S,identifier:i,active:m,x:d[0]+a,y:d[1]+u,dx:d[0]-g[0],dy:d[1]-g[1],dispatch:h}),r)}}return S.filter=function(e){return arguments.length?(m="function"==typeof e?e:u(!!e),S):m},S.container=function(e){return arguments.length?(g="function"==typeof e?e:u(e),S):g},S.subject=function(e){return arguments.length?(v="function"==typeof e?e:u(e),S):v},S.touchable=function(e){return arguments.length?(y="function"==typeof e?e:u(!!e),S):y},S.on=function(){var e=_.on.apply(_,arguments);return e===_?S:e},S.clickDistance=function(e){return arguments.length?(w=(e=+e)*e,S):Math.sqrt(w)},S}c.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e}},49289:function(e,t,n){"use strict";n.d(t,{D:function(){return s},Z:function(){return o}});var r=n(41468),i=n(5873);function o(e){var t=e.document.documentElement,n=(0,r.Z)(e).on("dragstart.drag",i.ZP,i.Dd);"onselectstart"in t?n.on("selectstart.drag",i.ZP,i.Dd):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function s(e,t){var n=e.document.documentElement,o=(0,r.Z)(e).on("dragstart.drag",null);t&&(o.on("click.drag",i.ZP,i.Dd),setTimeout((function(){o.on("click.drag",null)}),0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}},5873:function(e,t,n){"use strict";n.d(t,{Dd:function(){return i},Q7:function(){return r},ZP:function(){return s},rG:function(){return o}});const r={passive:!1},i={capture:!0,passive:!1};function o(e){e.stopImmediatePropagation()}function s(e){e.preventDefault(),e.stopImmediatePropagation()}},44200:function(e,t,n){"use strict";function r(e,t,n){var r,i=1;function o(){var o,s,a=r.length,u=0,c=0,l=0;for(o=0;o<a;++o)u+=(s=r[o]).x||0,c+=s.y||0,l+=s.z||0;for(u=(u/a-e)*i,c=(c/a-t)*i,l=(l/a-n)*i,o=0;o<a;++o)s=r[o],u&&(s.x-=u),c&&(s.y-=c),l&&(s.z-=l)}return null==e&&(e=0),null==t&&(t=0),null==n&&(n=0),o.initialize=function(e){r=e},o.x=function(t){return arguments.length?(e=+t,o):e},o.y=function(e){return arguments.length?(t=+e,o):t},o.z=function(e){return arguments.length?(n=+e,o):n},o.strength=function(e){return arguments.length?(i=+e,o):i},o}n.d(t,{Z:function(){return r}})},68490:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(19753),i=n(76265),o=n(68091),s=n(55444),a=n(94219);function u(e){return e.x+e.vx}function c(e){return e.y+e.vy}function l(e){return e.z+e.vz}function h(e){var t,n,h,d,f=1,p=1;function m(){for(var e,s,m,v,y,b,_,x,w=t.length,S=0;S<p;++S)for(s=(1===n?(0,r.Z)(t,u):2===n?(0,i.Z)(t,u,c):3===n?(0,o.Z)(t,u,c,l):null).visitAfter(g),e=0;e<w;++e)m=t[e],_=h[m.index],x=_*_,v=m.x+m.vx,n>1&&(y=m.y+m.vy),n>2&&(b=m.z+m.vz),s.visit(E);function E(e,t,r,i,o,s,u){var c=[t,r,i,o,s,u],l=c[0],h=c[1],p=c[2],g=c[n],w=c[n+1],S=c[n+2],E=e.data,T=e.r,M=_+T;if(!E)return l>v+M||g<v-M||n>1&&(h>y+M||w<y-M)||n>2&&(p>b+M||S<b-M);if(E.index>m.index){var A=v-E.x-E.vx,C=n>1?y-E.y-E.vy:0,O=n>2?b-E.z-E.vz:0,P=A*A+C*C+O*O;P<M*M&&(0===A&&(P+=(A=(0,a.Z)(d))*A),n>1&&0===C&&(P+=(C=(0,a.Z)(d))*C),n>2&&0===O&&(P+=(O=(0,a.Z)(d))*O),P=(M-(P=Math.sqrt(P)))/P*f,m.vx+=(A*=P)*(M=(T*=T)/(x+T)),n>1&&(m.vy+=(C*=P)*M),n>2&&(m.vz+=(O*=P)*M),E.vx-=A*(M=1-M),n>1&&(E.vy-=C*M),n>2&&(E.vz-=O*M))}}}function g(e){if(e.data)return e.r=h[e.data.index];for(var t=e.r=0;t<Math.pow(2,n);++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function v(){if(t){var n,r,i=t.length;for(h=new Array(i),n=0;n<i;++n)r=t[n],h[r.index]=+e(r,n,t)}}return"function"!=typeof e&&(e=(0,s.Z)(null==e?1:+e)),m.initialize=function(e,...r){t=e,d=r.find((e=>"function"==typeof e))||Math.random,n=r.find((e=>[1,2,3].includes(e)))||2,v()},m.iterations=function(e){return arguments.length?(p=+e,m):p},m.strength=function(e){return arguments.length?(f=+e,m):f},m.radius=function(t){return arguments.length?(e="function"==typeof t?t:(0,s.Z)(+t),v(),m):e},m}},55444:function(e,t,n){"use strict";function r(e){return function(){return e}}n.d(t,{Z:function(){return r}})},94219:function(e,t,n){"use strict";function r(e){return 1e-6*(e()-.5)}n.d(t,{Z:function(){return r}})},5271:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(55444),i=n(94219);function o(e){return e.index}function s(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function a(e){var t,n,a,u,c,l,h,d=o,f=function(e){return 1/Math.min(c[e.source.index],c[e.target.index])},p=(0,r.Z)(30),m=1;function g(r){for(var o=0,s=e.length;o<m;++o)for(var a,c,d,f,p,g=0,v=0,y=0,b=0;g<s;++g)c=(a=e[g]).source,v=(d=a.target).x+d.vx-c.x-c.vx||(0,i.Z)(h),u>1&&(y=d.y+d.vy-c.y-c.vy||(0,i.Z)(h)),u>2&&(b=d.z+d.vz-c.z-c.vz||(0,i.Z)(h)),v*=f=((f=Math.sqrt(v*v+y*y+b*b))-n[g])/f*r*t[g],y*=f,b*=f,d.vx-=v*(p=l[g]),u>1&&(d.vy-=y*p),u>2&&(d.vz-=b*p),c.vx+=v*(p=1-p),u>1&&(c.vy+=y*p),u>2&&(c.vz+=b*p)}function v(){if(a){var r,i,o=a.length,u=e.length,h=new Map(a.map(((e,t)=>[d(e,t,a),e])));for(r=0,c=new Array(o);r<u;++r)(i=e[r]).index=r,"object"!=typeof i.source&&(i.source=s(h,i.source)),"object"!=typeof i.target&&(i.target=s(h,i.target)),c[i.source.index]=(c[i.source.index]||0)+1,c[i.target.index]=(c[i.target.index]||0)+1;for(r=0,l=new Array(u);r<u;++r)i=e[r],l[r]=c[i.source.index]/(c[i.source.index]+c[i.target.index]);t=new Array(u),y(),n=new Array(u),b()}}function y(){if(a)for(var n=0,r=e.length;n<r;++n)t[n]=+f(e[n],n,e)}function b(){if(a)for(var t=0,r=e.length;t<r;++t)n[t]=+p(e[t],t,e)}return null==e&&(e=[]),g.initialize=function(e,...t){a=e,h=t.find((e=>"function"==typeof e))||Math.random,u=t.find((e=>[1,2,3].includes(e)))||2,v()},g.links=function(t){return arguments.length?(e=t,v(),g):e},g.id=function(e){return arguments.length?(d=e,g):d},g.iterations=function(e){return arguments.length?(m=+e,g):m},g.strength=function(e){return arguments.length?(f="function"==typeof e?e:(0,r.Z)(+e),y(),g):f},g.distance=function(e){return arguments.length?(p="function"==typeof e?e:(0,r.Z)(+e),b(),g):p},g}},80621:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(19753),i=n(76265),o=n(68091),s=n(55444),a=n(94219),u=n(13320);function c(){var e,t,n,c,l,h,d=(0,s.Z)(-30),f=1,p=1/0,m=.81;function g(s){var a,c=e.length,h=(1===t?(0,r.Z)(e,u.x):2===t?(0,i.Z)(e,u.x,u.y):3===t?(0,o.Z)(e,u.x,u.y,u.z):null).visitAfter(y);for(l=s,a=0;a<c;++a)n=e[a],h.visit(b)}function v(){if(e){var t,n,r=e.length;for(h=new Array(r),t=0;t<r;++t)n=e[t],h[n.index]=+d(n,t,e)}}function y(e){var n,r,i,o,s,a,u=0,c=0,l=e.length;if(l){for(i=o=s=a=0;a<l;++a)(n=e[a])&&(r=Math.abs(n.value))&&(u+=n.value,c+=r,i+=r*(n.x||0),o+=r*(n.y||0),s+=r*(n.z||0));u*=Math.sqrt(4/l),e.x=i/c,t>1&&(e.y=o/c),t>2&&(e.z=s/c)}else{(n=e).x=n.data.x,t>1&&(n.y=n.data.y),t>2&&(n.z=n.data.z);do{u+=h[n.data.index]}while(n=n.next)}e.value=u}function b(e,r,i,o,s){if(!e.value)return!0;var u=[i,o,s][t-1],d=e.x-n.x,g=t>1?e.y-n.y:0,v=t>2?e.z-n.z:0,y=u-r,b=d*d+g*g+v*v;if(y*y/m<b)return b<p&&(0===d&&(b+=(d=(0,a.Z)(c))*d),t>1&&0===g&&(b+=(g=(0,a.Z)(c))*g),t>2&&0===v&&(b+=(v=(0,a.Z)(c))*v),b<f&&(b=Math.sqrt(f*b)),n.vx+=d*e.value*l/b,t>1&&(n.vy+=g*e.value*l/b),t>2&&(n.vz+=v*e.value*l/b)),!0;if(!(e.length||b>=p)){(e.data!==n||e.next)&&(0===d&&(b+=(d=(0,a.Z)(c))*d),t>1&&0===g&&(b+=(g=(0,a.Z)(c))*g),t>2&&0===v&&(b+=(v=(0,a.Z)(c))*v),b<f&&(b=Math.sqrt(f*b)));do{e.data!==n&&(y=h[e.data.index]*l/b,n.vx+=d*y,t>1&&(n.vy+=g*y),t>2&&(n.vz+=v*y))}while(e=e.next)}}return g.initialize=function(n,...r){e=n,c=r.find((e=>"function"==typeof e))||Math.random,t=r.find((e=>[1,2,3].includes(e)))||2,v()},g.strength=function(e){return arguments.length?(d="function"==typeof e?e:(0,s.Z)(+e),v(),g):d},g.distanceMin=function(e){return arguments.length?(f=e*e,g):Math.sqrt(f)},g.distanceMax=function(e){return arguments.length?(p=e*e,g):Math.sqrt(p)},g.theta=function(e){return arguments.length?(m=e*e,g):Math.sqrt(m)},g}},54476:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(55444);function i(e,t,n,i){var o,s,a,u,c=(0,r.Z)(.1);function l(e){for(var r=0,c=o.length;r<c;++r){var l=o[r],h=l.x-t||1e-6,d=(l.y||0)-n||1e-6,f=(l.z||0)-i||1e-6,p=Math.sqrt(h*h+d*d+f*f),m=(u[r]-p)*a[r]*e/p;l.vx+=h*m,s>1&&(l.vy+=d*m),s>2&&(l.vz+=f*m)}}function h(){if(o){var t,n=o.length;for(a=new Array(n),u=new Array(n),t=0;t<n;++t)u[t]=+e(o[t],t,o),a[t]=isNaN(u[t])?0:+c(o[t],t,o)}}return"function"!=typeof e&&(e=(0,r.Z)(+e)),null==t&&(t=0),null==n&&(n=0),null==i&&(i=0),l.initialize=function(e,...t){o=e,s=t.find((e=>[1,2,3].includes(e)))||2,h()},l.strength=function(e){return arguments.length?(c="function"==typeof e?e:(0,r.Z)(+e),h(),l):c},l.radius=function(t){return arguments.length?(e="function"==typeof t?t:(0,r.Z)(+t),h(),l):e},l.x=function(e){return arguments.length?(t=+e,l):t},l.y=function(e){return arguments.length?(n=+e,l):n},l.z=function(e){return arguments.length?(i=+e,l):i},l}},13320:function(e,t,n){"use strict";n.d(t,{Z:function(){return h},x:function(){return s},y:function(){return a},z:function(){return u}});var r=n(32436),i=n(83249);const o=4294967296;function s(e){return e.x}function a(e){return e.y}function u(e){return e.z}var c=Math.PI*(3-Math.sqrt(5)),l=20*Math.PI/(9+Math.sqrt(221));function h(e,t){t=t||2;var n,s=Math.min(3,Math.max(1,Math.round(t))),a=1,u=.001,h=1-Math.pow(u,1/300),d=0,f=.6,p=new Map,m=(0,i.HT)(y),g=(0,r.Z)("tick","end"),v=function(){let e=1;return()=>(e=(1664525*e+1013904223)%o)/o}();function y(){b(),g.call("tick",n),a<u&&(m.stop(),g.call("end",n))}function b(t){var r,i,o=e.length;void 0===t&&(t=1);for(var u=0;u<t;++u)for(a+=(d-a)*h,p.forEach((function(e){e(a)})),r=0;r<o;++r)null==(i=e[r]).fx?i.x+=i.vx*=f:(i.x=i.fx,i.vx=0),s>1&&(null==i.fy?i.y+=i.vy*=f:(i.y=i.fy,i.vy=0)),s>2&&(null==i.fz?i.z+=i.vz*=f:(i.z=i.fz,i.vz=0));return n}function _(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),null!=t.fz&&(t.z=t.fz),isNaN(t.x)||s>1&&isNaN(t.y)||s>2&&isNaN(t.z)){var i=10*(s>2?Math.cbrt(.5+n):s>1?Math.sqrt(.5+n):n),o=n*c,a=n*l;1===s?t.x=i:2===s?(t.x=i*Math.cos(o),t.y=i*Math.sin(o)):(t.x=i*Math.sin(o)*Math.cos(a),t.y=i*Math.cos(o),t.z=i*Math.sin(o)*Math.sin(a))}(isNaN(t.vx)||s>1&&isNaN(t.vy)||s>2&&isNaN(t.vz))&&(t.vx=0,s>1&&(t.vy=0),s>2&&(t.vz=0))}}function x(t){return t.initialize&&t.initialize(e,v,s),t}return null==e&&(e=[]),_(),n={tick:b,restart:function(){return m.restart(y),n},stop:function(){return m.stop(),n},numDimensions:function(e){return arguments.length?(s=Math.min(3,Math.max(1,Math.round(e))),p.forEach(x),n):s},nodes:function(t){return arguments.length?(e=t,_(),p.forEach(x),n):e},alpha:function(e){return arguments.length?(a=+e,n):a},alphaMin:function(e){return arguments.length?(u=+e,n):u},alphaDecay:function(e){return arguments.length?(h=+e,n):+h},alphaTarget:function(e){return arguments.length?(d=+e,n):d},velocityDecay:function(e){return arguments.length?(f=1-e,n):1-f},randomSource:function(e){return arguments.length?(v=e,p.forEach(x),n):v},force:function(e,t){return arguments.length>1?(null==t?p.delete(e):p.set(e,x(t)),n):p.get(e)},find:function(){var t,n,r,i,o,a,u=Array.prototype.slice.call(arguments),c=u.shift()||0,l=(s>1?u.shift():null)||0,h=(s>2?u.shift():null)||0,d=u.shift()||1/0,f=0,p=e.length;for(d*=d,f=0;f<p;++f)(i=(t=c-(o=e[f]).x)*t+(n=l-(o.y||0))*n+(r=h-(o.z||0))*r)<d&&(a=o,d=i);return a},on:function(e,t){return arguments.length>1?(g.on(e,t),n):g.on(e)}}}},4507:function(e,t,n){"use strict";function r(e,t){var n,r=1;function i(){var i,o,s=n.length,a=0,u=0;for(i=0;i<s;++i)a+=(o=n[i]).x,u+=o.y;for(a=(a/s-e)*r,u=(u/s-t)*r,i=0;i<s;++i)(o=n[i]).x-=a,o.y-=u}return null==e&&(e=0),null==t&&(t=0),i.initialize=function(e){n=e},i.x=function(t){return arguments.length?(e=+t,i):e},i.y=function(e){return arguments.length?(t=+e,i):t},i.strength=function(e){return arguments.length?(r=+e,i):r},i}n.d(t,{Z:function(){return r}})},56617:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(76265),i=n(61722),o=n(24211);function s(e){return e.x+e.vx}function a(e){return e.y+e.vy}function u(e){var t,n,u,c=1,l=1;function h(){for(var e,i,h,f,p,m,g,v=t.length,y=0;y<l;++y)for(i=(0,r.Z)(t,s,a).visitAfter(d),e=0;e<v;++e)h=t[e],m=n[h.index],g=m*m,f=h.x+h.vx,p=h.y+h.vy,i.visit(b);function b(e,t,n,r,i){var s=e.data,a=e.r,l=m+a;if(!s)return t>f+l||r<f-l||n>p+l||i<p-l;if(s.index>h.index){var d=f-s.x-s.vx,v=p-s.y-s.vy,y=d*d+v*v;y<l*l&&(0===d&&(y+=(d=(0,o.Z)(u))*d),0===v&&(y+=(v=(0,o.Z)(u))*v),y=(l-(y=Math.sqrt(y)))/y*c,h.vx+=(d*=y)*(l=(a*=a)/(g+a)),h.vy+=(v*=y)*l,s.vx-=d*(l=1-l),s.vy-=v*l)}}}function d(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function f(){if(t){var r,i,o=t.length;for(n=new Array(o),r=0;r<o;++r)i=t[r],n[i.index]=+e(i,r,t)}}return"function"!=typeof e&&(e=(0,i.Z)(null==e?1:+e)),h.initialize=function(e,n){t=e,u=n,f()},h.iterations=function(e){return arguments.length?(l=+e,h):l},h.strength=function(e){return arguments.length?(c=+e,h):c},h.radius=function(t){return arguments.length?(e="function"==typeof t?t:(0,i.Z)(+t),f(),h):e},h}},61722:function(e,t,n){"use strict";function r(e){return function(){return e}}n.d(t,{Z:function(){return r}})},24211:function(e,t,n){"use strict";function r(e){return 1e-6*(e()-.5)}n.d(t,{Z:function(){return r}})},44575:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(61722),i=n(24211);function o(e){return e.index}function s(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function a(e){var t,n,a,u,c,l,h=o,d=function(e){return 1/Math.min(u[e.source.index],u[e.target.index])},f=(0,r.Z)(30),p=1;function m(r){for(var o=0,s=e.length;o<p;++o)for(var a,u,h,d,f,m,g,v=0;v<s;++v)u=(a=e[v]).source,d=(h=a.target).x+h.vx-u.x-u.vx||(0,i.Z)(l),f=h.y+h.vy-u.y-u.vy||(0,i.Z)(l),d*=m=((m=Math.sqrt(d*d+f*f))-n[v])/m*r*t[v],f*=m,h.vx-=d*(g=c[v]),h.vy-=f*g,u.vx+=d*(g=1-g),u.vy+=f*g}function g(){if(a){var r,i,o=a.length,l=e.length,d=new Map(a.map(((e,t)=>[h(e,t,a),e])));for(r=0,u=new Array(o);r<l;++r)(i=e[r]).index=r,"object"!=typeof i.source&&(i.source=s(d,i.source)),"object"!=typeof i.target&&(i.target=s(d,i.target)),u[i.source.index]=(u[i.source.index]||0)+1,u[i.target.index]=(u[i.target.index]||0)+1;for(r=0,c=new Array(l);r<l;++r)i=e[r],c[r]=u[i.source.index]/(u[i.source.index]+u[i.target.index]);t=new Array(l),v(),n=new Array(l),y()}}function v(){if(a)for(var n=0,r=e.length;n<r;++n)t[n]=+d(e[n],n,e)}function y(){if(a)for(var t=0,r=e.length;t<r;++t)n[t]=+f(e[t],t,e)}return null==e&&(e=[]),m.initialize=function(e,t){a=e,l=t,g()},m.links=function(t){return arguments.length?(e=t,g(),m):e},m.id=function(e){return arguments.length?(h=e,m):h},m.iterations=function(e){return arguments.length?(p=+e,m):p},m.strength=function(e){return arguments.length?(d="function"==typeof e?e:(0,r.Z)(+e),v(),m):d},m.distance=function(e){return arguments.length?(f="function"==typeof e?e:(0,r.Z)(+e),y(),m):f},m}},64681:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(76265),i=n(61722),o=n(24211),s=n(42655);function a(){var e,t,n,a,u,c=(0,i.Z)(-30),l=1,h=1/0,d=.81;function f(n){var i,o=e.length,u=(0,r.Z)(e,s.x,s.y).visitAfter(m);for(a=n,i=0;i<o;++i)t=e[i],u.visit(g)}function p(){if(e){var t,n,r=e.length;for(u=new Array(r),t=0;t<r;++t)n=e[t],u[n.index]=+c(n,t,e)}}function m(e){var t,n,r,i,o,s=0,a=0;if(e.length){for(r=i=o=0;o<4;++o)(t=e[o])&&(n=Math.abs(t.value))&&(s+=t.value,a+=n,r+=n*t.x,i+=n*t.y);e.x=r/a,e.y=i/a}else{(t=e).x=t.data.x,t.y=t.data.y;do{s+=u[t.data.index]}while(t=t.next)}e.value=s}function g(e,r,i,s){if(!e.value)return!0;var c=e.x-t.x,f=e.y-t.y,p=s-r,m=c*c+f*f;if(p*p/d<m)return m<h&&(0===c&&(m+=(c=(0,o.Z)(n))*c),0===f&&(m+=(f=(0,o.Z)(n))*f),m<l&&(m=Math.sqrt(l*m)),t.vx+=c*e.value*a/m,t.vy+=f*e.value*a/m),!0;if(!(e.length||m>=h)){(e.data!==t||e.next)&&(0===c&&(m+=(c=(0,o.Z)(n))*c),0===f&&(m+=(f=(0,o.Z)(n))*f),m<l&&(m=Math.sqrt(l*m)));do{e.data!==t&&(p=u[e.data.index]*a/m,t.vx+=c*p,t.vy+=f*p)}while(e=e.next)}}return f.initialize=function(t,r){e=t,n=r,p()},f.strength=function(e){return arguments.length?(c="function"==typeof e?e:(0,i.Z)(+e),p(),f):c},f.distanceMin=function(e){return arguments.length?(l=e*e,f):Math.sqrt(l)},f.distanceMax=function(e){return arguments.length?(h=e*e,f):Math.sqrt(h)},f.theta=function(e){return arguments.length?(d=e*e,f):Math.sqrt(d)},f}},2881:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(61722);function i(e,t,n){var i,o,s,a=(0,r.Z)(.1);function u(e){for(var r=0,a=i.length;r<a;++r){var u=i[r],c=u.x-t||1e-6,l=u.y-n||1e-6,h=Math.sqrt(c*c+l*l),d=(s[r]-h)*o[r]*e/h;u.vx+=c*d,u.vy+=l*d}}function c(){if(i){var t,n=i.length;for(o=new Array(n),s=new Array(n),t=0;t<n;++t)s[t]=+e(i[t],t,i),o[t]=isNaN(s[t])?0:+a(i[t],t,i)}}return"function"!=typeof e&&(e=(0,r.Z)(+e)),null==t&&(t=0),null==n&&(n=0),u.initialize=function(e){i=e,c()},u.strength=function(e){return arguments.length?(a="function"==typeof e?e:(0,r.Z)(+e),c(),u):a},u.radius=function(t){return arguments.length?(e="function"==typeof t?t:(0,r.Z)(+t),c(),u):e},u.x=function(e){return arguments.length?(t=+e,u):t},u.y=function(e){return arguments.length?(n=+e,u):n},u}},42655:function(e,t,n){"use strict";n.d(t,{Z:function(){return c},x:function(){return s},y:function(){return a}});var r=n(32436),i=n(83249);const o=4294967296;function s(e){return e.x}function a(e){return e.y}var u=Math.PI*(3-Math.sqrt(5));function c(e){var t,n=1,s=.001,a=1-Math.pow(s,1/300),c=0,l=.6,h=new Map,d=(0,i.HT)(m),f=(0,r.Z)("tick","end"),p=function(){let e=1;return()=>(e=(1664525*e+1013904223)%o)/o}();function m(){g(),f.call("tick",t),n<s&&(d.stop(),f.call("end",t))}function g(r){var i,o,s=e.length;void 0===r&&(r=1);for(var u=0;u<r;++u)for(n+=(c-n)*a,h.forEach((function(e){e(n)})),i=0;i<s;++i)null==(o=e[i]).fx?o.x+=o.vx*=l:(o.x=o.fx,o.vx=0),null==o.fy?o.y+=o.vy*=l:(o.y=o.fy,o.vy=0);return t}function v(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var i=10*Math.sqrt(.5+n),o=n*u;t.x=i*Math.cos(o),t.y=i*Math.sin(o)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function y(t){return t.initialize&&t.initialize(e,p),t}return null==e&&(e=[]),v(),t={tick:g,restart:function(){return d.restart(m),t},stop:function(){return d.stop(),t},nodes:function(n){return arguments.length?(e=n,v(),h.forEach(y),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(s=+e,t):s},alphaDecay:function(e){return arguments.length?(a=+e,t):+a},alphaTarget:function(e){return arguments.length?(c=+e,t):c},velocityDecay:function(e){return arguments.length?(l=1-e,t):1-l},randomSource:function(e){return arguments.length?(p=e,h.forEach(y),t):p},force:function(e,n){return arguments.length>1?(null==n?h.delete(e):h.set(e,y(n)),t):h.get(e)},find:function(t,n,r){var i,o,s,a,u,c=0,l=e.length;for(null==r?r=1/0:r*=r,c=0;c<l;++c)(s=(i=t-(a=e[c]).x)*i+(o=n-a.y)*o)<r&&(u=a,r=s);return u},on:function(e,n){return arguments.length>1?(f.on(e,n),t):f.on(e)}}}},32458:function(e,t,n){"use strict";n.d(t,{WU:function(){return h},jH:function(){return d}});var r=n(43466);var i=n(41653);var o,s=n(29651);function a(e,t){var n=(0,s.V)(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var u={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:s.Z,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>a(100*e,t),r:a,s:function(e,t){var n=(0,s.V)(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(o=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,u=r.length;return a===u?r:a>u?r+new Array(a-u+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+(0,s.V)(e,Math.max(0,t+a-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function c(e){return e}var l,h,d,f=Array.prototype.map,p=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function m(e){var t,n,s=void 0===e.grouping||void 0===e.thousands?c:(t=f.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,o=[],s=0,a=t[0],u=0;i>0&&a>0&&(u+a+1>r&&(a=Math.max(1,r-u)),o.push(e.substring(i-=a,i+a)),!((u+=a+1)>r));)a=t[s=(s+1)%t.length];return o.reverse().join(n)}),a=void 0===e.currency?"":e.currency[0]+"",l=void 0===e.currency?"":e.currency[1]+"",h=void 0===e.decimal?".":e.decimal+"",d=void 0===e.numerals?c:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(f.call(e.numerals,String)),m=void 0===e.percent?"%":e.percent+"",g=void 0===e.minus?"−":e.minus+"",v=void 0===e.nan?"NaN":e.nan+"";function y(e){var t=(e=(0,i.Z)(e)).fill,n=e.align,r=e.sign,c=e.symbol,f=e.zero,y=e.width,b=e.comma,_=e.precision,x=e.trim,w=e.type;"n"===w?(b=!0,w="g"):u[w]||(void 0===_&&(_=12),x=!0,w="g"),(f||"0"===t&&"="===n)&&(f=!0,t="0",n="=");var S="$"===c?a:"#"===c&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",E="$"===c?l:/[%p]/.test(w)?m:"",T=u[w],M=/[defgprs%]/.test(w);function A(e){var i,a,u,c=S,l=E;if("c"===w)l=T(e)+l,e="";else{var m=(e=+e)<0||1/e<0;if(e=isNaN(e)?v:T(Math.abs(e),_),x&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),m&&0==+e&&"+"!==r&&(m=!1),c=(m?"("===r?r:g:"-"===r||"("===r?"":r)+c,l=("s"===w?p[8+o/3]:"")+l+(m&&"("===r?")":""),M)for(i=-1,a=e.length;++i<a;)if(48>(u=e.charCodeAt(i))||u>57){l=(46===u?h+e.slice(i+1):e.slice(i))+l,e=e.slice(0,i);break}}b&&!f&&(e=s(e,1/0));var A=c.length+e.length+l.length,C=A<y?new Array(y-A+1).join(t):"";switch(b&&f&&(e=s(C+e,C.length?y-l.length:1/0),C=""),n){case"<":e=c+e+l+C;break;case"=":e=c+C+e+l;break;case"^":e=C.slice(0,A=C.length>>1)+c+e+l+C.slice(A);break;default:e=C+c+e+l}return d(e)}return _=void 0===_?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_)),A.toString=function(){return e+""},A}return{format:y,formatPrefix:function(e,t){var n=y(((e=(0,i.Z)(e)).type="f",e)),o=3*Math.max(-8,Math.min(8,Math.floor((0,r.Z)(t)/3))),s=Math.pow(10,-o),a=p[8+o/3];return function(e){return n(s*e)+a}}}}l=m({thousands:",",grouping:[3],currency:["$",""]}),h=l.format,d=l.formatPrefix},43466:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(29651);function i(e){return(e=(0,r.V)(Math.abs(e)))?e[1]:NaN}},29651:function(e,t,n){"use strict";function r(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function i(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}n.d(t,{V:function(){return i},Z:function(){return r}})},41653:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function i(e){if(!(t=r.exec(e)))throw new Error("invalid format: "+e);var t;return new o({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function o(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}i.prototype=o.prototype,o.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type}},68091:function(e,t,n){"use strict";function r(e,t,n,r,i){if(isNaN(t)||isNaN(n)||isNaN(r))return e;var o,s,a,u,c,l,h,d,f,p,m,g,v=e._root,y={data:i},b=e._x0,_=e._y0,x=e._z0,w=e._x1,S=e._y1,E=e._z1;if(!v)return e._root=y,e;for(;v.length;)if((d=t>=(s=(b+w)/2))?b=s:w=s,(f=n>=(a=(_+S)/2))?_=a:S=a,(p=r>=(u=(x+E)/2))?x=u:E=u,o=v,!(v=v[m=p<<2|f<<1|d]))return o[m]=y,e;if(c=+e._x.call(null,v.data),l=+e._y.call(null,v.data),h=+e._z.call(null,v.data),t===c&&n===l&&r===h)return y.next=v,o?o[m]=y:e._root=y,e;do{o=o?o[m]=new Array(8):e._root=new Array(8),(d=t>=(s=(b+w)/2))?b=s:w=s,(f=n>=(a=(_+S)/2))?_=a:S=a,(p=r>=(u=(x+E)/2))?x=u:E=u}while((m=p<<2|f<<1|d)==(g=(h>=u)<<2|(l>=a)<<1|c>=s));return o[g]=v,o[m]=y,e}function i(e,t,n,r,i,o,s){this.node=e,this.x0=t,this.y0=n,this.z0=r,this.x1=i,this.y1=o,this.z1=s}function o(e){return e[0]}function s(e){return e[1]}function a(e){return e[2]}function u(e,t,n,r){var i=new c(null==t?o:t,null==n?s:n,null==r?a:r,NaN,NaN,NaN,NaN,NaN,NaN);return null==e?i:i.addAll(e)}function c(e,t,n,r,i,o,s,a,u){this._x=e,this._y=t,this._z=n,this._x0=r,this._y0=i,this._z0=o,this._x1=s,this._y1=a,this._z1=u,this._root=void 0}function l(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}n.d(t,{Z:function(){return u}});var h=u.prototype=c.prototype;h.copy=function(){var e,t,n=new c(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),r=this._root;if(!r)return n;if(!r.length)return n._root=l(r),n;for(e=[{source:r,target:n._root=new Array(8)}];r=e.pop();)for(var i=0;i<8;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=new Array(8)}):r.target[i]=l(t));return n},h.add=function(e){const t=+this._x.call(null,e),n=+this._y.call(null,e),i=+this._z.call(null,e);return r(this.cover(t,n,i),t,n,i,e)},h.addAll=function(e){Array.isArray(e)||(e=Array.from(e));const t=e.length,n=new Float64Array(t),i=new Float64Array(t),o=new Float64Array(t);let s=1/0,a=1/0,u=1/0,c=-1/0,l=-1/0,h=-1/0;for(let r,d,f,p,m=0;m<t;++m)isNaN(d=+this._x.call(null,r=e[m]))||isNaN(f=+this._y.call(null,r))||isNaN(p=+this._z.call(null,r))||(n[m]=d,i[m]=f,o[m]=p,d<s&&(s=d),d>c&&(c=d),f<a&&(a=f),f>l&&(l=f),p<u&&(u=p),p>h&&(h=p));if(s>c||a>l||u>h)return this;this.cover(s,a,u).cover(c,l,h);for(let s=0;s<t;++s)r(this,n[s],i[s],o[s],e[s]);return this},h.cover=function(e,t,n){if(isNaN(e=+e)||isNaN(t=+t)||isNaN(n=+n))return this;var r=this._x0,i=this._y0,o=this._z0,s=this._x1,a=this._y1,u=this._z1;if(isNaN(r))s=(r=Math.floor(e))+1,a=(i=Math.floor(t))+1,u=(o=Math.floor(n))+1;else{for(var c,l,h=s-r||1,d=this._root;r>e||e>=s||i>t||t>=a||o>n||n>=u;)switch(l=(n<o)<<2|(t<i)<<1|e<r,(c=new Array(8))[l]=d,d=c,h*=2,l){case 0:s=r+h,a=i+h,u=o+h;break;case 1:r=s-h,a=i+h,u=o+h;break;case 2:s=r+h,i=a-h,u=o+h;break;case 3:r=s-h,i=a-h,u=o+h;break;case 4:s=r+h,a=i+h,o=u-h;break;case 5:r=s-h,a=i+h,o=u-h;break;case 6:s=r+h,i=a-h,o=u-h;break;case 7:r=s-h,i=a-h,o=u-h}this._root&&this._root.length&&(this._root=d)}return this._x0=r,this._y0=i,this._z0=o,this._x1=s,this._y1=a,this._z1=u,this},h.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},h.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1],+e[0][2]).cover(+e[1][0],+e[1][1],+e[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},h.find=function(e,t,n,r){var o,s,a,u,c,l,h,d,f,p=this._x0,m=this._y0,g=this._z0,v=this._x1,y=this._y1,b=this._z1,_=[],x=this._root;for(x&&_.push(new i(x,p,m,g,v,y,b)),null==r?r=1/0:(p=e-r,m=t-r,g=n-r,v=e+r,y=t+r,b=n+r,r*=r);d=_.pop();)if(!(!(x=d.node)||(s=d.x0)>v||(a=d.y0)>y||(u=d.z0)>b||(c=d.x1)<p||(l=d.y1)<m||(h=d.z1)<g))if(x.length){var w=(s+c)/2,S=(a+l)/2,E=(u+h)/2;_.push(new i(x[7],w,S,E,c,l,h),new i(x[6],s,S,E,w,l,h),new i(x[5],w,a,E,c,S,h),new i(x[4],s,a,E,w,S,h),new i(x[3],w,S,u,c,l,E),new i(x[2],s,S,u,w,l,E),new i(x[1],w,a,u,c,S,E),new i(x[0],s,a,u,w,S,E)),(f=(n>=E)<<2|(t>=S)<<1|e>=w)&&(d=_[_.length-1],_[_.length-1]=_[_.length-1-f],_[_.length-1-f]=d)}else{var T=e-+this._x.call(null,x.data),M=t-+this._y.call(null,x.data),A=n-+this._z.call(null,x.data),C=T*T+M*M+A*A;if(C<r){var O=Math.sqrt(r=C);p=e-O,m=t-O,g=n-O,v=e+O,y=t+O,b=n+O,o=x.data}}return o},h.remove=function(e){if(isNaN(o=+this._x.call(null,e))||isNaN(s=+this._y.call(null,e))||isNaN(a=+this._z.call(null,e)))return this;var t,n,r,i,o,s,a,u,c,l,h,d,f,p,m,g=this._root,v=this._x0,y=this._y0,b=this._z0,_=this._x1,x=this._y1,w=this._z1;if(!g)return this;if(g.length)for(;;){if((h=o>=(u=(v+_)/2))?v=u:_=u,(d=s>=(c=(y+x)/2))?y=c:x=c,(f=a>=(l=(b+w)/2))?b=l:w=l,t=g,!(g=g[p=f<<2|d<<1|h]))return this;if(!g.length)break;(t[p+1&7]||t[p+2&7]||t[p+3&7]||t[p+4&7]||t[p+5&7]||t[p+6&7]||t[p+7&7])&&(n=t,m=p)}for(;g.data!==e;)if(r=g,!(g=g.next))return this;return(i=g.next)&&delete g.next,r?(i?r.next=i:delete r.next,this):t?(i?t[p]=i:delete t[p],(g=t[0]||t[1]||t[2]||t[3]||t[4]||t[5]||t[6]||t[7])&&g===(t[7]||t[6]||t[5]||t[4]||t[3]||t[2]||t[1]||t[0])&&!g.length&&(n?n[m]=g:this._root=g),this):(this._root=i,this)},h.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},h.root=function(){return this._root},h.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},h.visit=function(e){var t,n,r,o,s,a,u,c,l=[],h=this._root;for(h&&l.push(new i(h,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=l.pop();)if(!e(h=t.node,r=t.x0,o=t.y0,s=t.z0,a=t.x1,u=t.y1,c=t.z1)&&h.length){var d=(r+a)/2,f=(o+u)/2,p=(s+c)/2;(n=h[7])&&l.push(new i(n,d,f,p,a,u,c)),(n=h[6])&&l.push(new i(n,r,f,p,d,u,c)),(n=h[5])&&l.push(new i(n,d,o,p,a,f,c)),(n=h[4])&&l.push(new i(n,r,o,p,d,f,c)),(n=h[3])&&l.push(new i(n,d,f,s,a,u,p)),(n=h[2])&&l.push(new i(n,r,f,s,d,u,p)),(n=h[1])&&l.push(new i(n,d,o,s,a,f,p)),(n=h[0])&&l.push(new i(n,r,o,s,d,f,p))}return this},h.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new i(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=n.pop();){var o=t.node;if(o.length){var s,a=t.x0,u=t.y0,c=t.z0,l=t.x1,h=t.y1,d=t.z1,f=(a+l)/2,p=(u+h)/2,m=(c+d)/2;(s=o[0])&&n.push(new i(s,a,u,c,f,p,m)),(s=o[1])&&n.push(new i(s,f,u,c,l,p,m)),(s=o[2])&&n.push(new i(s,a,p,c,f,h,m)),(s=o[3])&&n.push(new i(s,f,p,c,l,h,m)),(s=o[4])&&n.push(new i(s,a,u,m,f,p,d)),(s=o[5])&&n.push(new i(s,f,u,m,l,p,d)),(s=o[6])&&n.push(new i(s,a,p,m,f,h,d)),(s=o[7])&&n.push(new i(s,f,p,m,l,h,d))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.z0,t.x1,t.y1,t.z1);return this},h.x=function(e){return arguments.length?(this._x=e,this):this._x},h.y=function(e){return arguments.length?(this._y=e,this):this._y},h.z=function(e){return arguments.length?(this._z=e,this):this._z}},76265:function(e,t,n){"use strict";function r(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,o,s,a,u,c,l,h,d,f=e._root,p={data:r},m=e._x0,g=e._y0,v=e._x1,y=e._y1;if(!f)return e._root=p,e;for(;f.length;)if((c=t>=(o=(m+v)/2))?m=o:v=o,(l=n>=(s=(g+y)/2))?g=s:y=s,i=f,!(f=f[h=l<<1|c]))return i[h]=p,e;if(a=+e._x.call(null,f.data),u=+e._y.call(null,f.data),t===a&&n===u)return p.next=f,i?i[h]=p:e._root=p,e;do{i=i?i[h]=new Array(4):e._root=new Array(4),(c=t>=(o=(m+v)/2))?m=o:v=o,(l=n>=(s=(g+y)/2))?g=s:y=s}while((h=l<<1|c)==(d=(u>=s)<<1|a>=o));return i[d]=f,i[h]=p,e}function i(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function o(e){return e[0]}function s(e){return e[1]}function a(e,t,n){var r=new u(null==t?o:t,null==n?s:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function u(e,t,n,r,i,o){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function c(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}n.d(t,{Z:function(){return a}});var l=a.prototype=u.prototype;l.copy=function(){var e,t,n=new u(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=c(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var i=0;i<4;++i)(t=r.source[i])&&(t.length?e.push({source:t,target:r.target[i]=new Array(4)}):r.target[i]=c(t));return n},l.add=function(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return r(this.cover(t,n),t,n,e)},l.addAll=function(e){var t,n,i,o,s=e.length,a=new Array(s),u=new Array(s),c=1/0,l=1/0,h=-1/0,d=-1/0;for(n=0;n<s;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(o=+this._y.call(null,t))||(a[n]=i,u[n]=o,i<c&&(c=i),i>h&&(h=i),o<l&&(l=o),o>d&&(d=o));if(c>h||l>d)return this;for(this.cover(c,l).cover(h,d),n=0;n<s;++n)r(this,a[n],u[n],e[n]);return this},l.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,o=(r=Math.floor(t))+1;else{for(var s,a,u=i-n||1,c=this._root;n>e||e>=i||r>t||t>=o;)switch(a=(t<r)<<1|e<n,(s=new Array(4))[a]=c,c=s,u*=2,a){case 0:i=n+u,o=r+u;break;case 1:n=i-u,o=r+u;break;case 2:i=n+u,r=o-u;break;case 3:n=i-u,r=o-u}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},l.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},l.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},l.find=function(e,t,n){var r,o,s,a,u,c,l,h=this._x0,d=this._y0,f=this._x1,p=this._y1,m=[],g=this._root;for(g&&m.push(new i(g,h,d,f,p)),null==n?n=1/0:(h=e-n,d=t-n,f=e+n,p=t+n,n*=n);c=m.pop();)if(!(!(g=c.node)||(o=c.x0)>f||(s=c.y0)>p||(a=c.x1)<h||(u=c.y1)<d))if(g.length){var v=(o+a)/2,y=(s+u)/2;m.push(new i(g[3],v,y,a,u),new i(g[2],o,y,v,u),new i(g[1],v,s,a,y),new i(g[0],o,s,v,y)),(l=(t>=y)<<1|e>=v)&&(c=m[m.length-1],m[m.length-1]=m[m.length-1-l],m[m.length-1-l]=c)}else{var b=e-+this._x.call(null,g.data),_=t-+this._y.call(null,g.data),x=b*b+_*_;if(x<n){var w=Math.sqrt(n=x);h=e-w,d=t-w,f=e+w,p=t+w,r=g.data}}return r},l.remove=function(e){if(isNaN(o=+this._x.call(null,e))||isNaN(s=+this._y.call(null,e)))return this;var t,n,r,i,o,s,a,u,c,l,h,d,f=this._root,p=this._x0,m=this._y0,g=this._x1,v=this._y1;if(!f)return this;if(f.length)for(;;){if((c=o>=(a=(p+g)/2))?p=a:g=a,(l=s>=(u=(m+v)/2))?m=u:v=u,t=f,!(f=f[h=l<<1|c]))return this;if(!f.length)break;(t[h+1&3]||t[h+2&3]||t[h+3&3])&&(n=t,d=h)}for(;f.data!==e;)if(r=f,!(f=f.next))return this;return(i=f.next)&&delete f.next,r?(i?r.next=i:delete r.next,this):t?(i?t[h]=i:delete t[h],(f=t[0]||t[1]||t[2]||t[3])&&f===(t[3]||t[2]||t[1]||t[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=i,this)},l.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},l.root=function(){return this._root},l.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},l.visit=function(e){var t,n,r,o,s,a,u=[],c=this._root;for(c&&u.push(new i(c,this._x0,this._y0,this._x1,this._y1));t=u.pop();)if(!e(c=t.node,r=t.x0,o=t.y0,s=t.x1,a=t.y1)&&c.length){var l=(r+s)/2,h=(o+a)/2;(n=c[3])&&u.push(new i(n,l,h,s,a)),(n=c[2])&&u.push(new i(n,r,h,l,a)),(n=c[1])&&u.push(new i(n,l,o,s,h)),(n=c[0])&&u.push(new i(n,r,o,l,h))}return this},l.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new i(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var o=t.node;if(o.length){var s,a=t.x0,u=t.y0,c=t.x1,l=t.y1,h=(a+c)/2,d=(u+l)/2;(s=o[0])&&n.push(new i(s,a,u,h,d)),(s=o[1])&&n.push(new i(s,h,u,c,d)),(s=o[2])&&n.push(new i(s,a,d,h,l)),(s=o[3])&&n.push(new i(s,h,d,c,l))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},l.x=function(e){return arguments.length?(this._x=e,this):this._x},l.y=function(e){return arguments.length?(this._y=e,this):this._y}},22059:function(e,t,n){"use strict";var r=n(92972);t.Z=(0,r.Z)("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928")},92972:function(e,t,n){"use strict";function r(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}n.d(t,{Z:function(){return r}})},40220:function(e,t,n){"use strict";n.d(t,{JG:function(){return f},ZP:function(){return m},yR:function(){return c},l4:function(){return p}});var r=n(44080),i=n(54400),o=n(88486);function s(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function a(e){return+e}var u=[0,1];function c(e){return e}function l(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function h(e,t,n){var r=e[0],i=e[1],o=t[0],s=t[1];return i<r?(r=l(i,r),o=n(s,o)):(r=l(r,i),o=n(o,s)),function(e){return o(r(e))}}function d(e,t,n){var i=Math.min(e.length,t.length)-1,o=new Array(i),s=new Array(i),a=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<i;)o[a]=l(e[a],e[a+1]),s[a]=n(t[a],t[a+1]);return function(t){var n=(0,r.ZP)(e,t,1,i)-1;return s[n](o[n](t))}}function f(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function p(){var e,t,n,r,l,f,p=u,m=u,g=i.Z,v=c;function y(){var e=Math.min(p.length,m.length);return v!==c&&(v=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(p[0],p[e-1])),r=e>2?d:h,l=f=null,b}function b(t){return null==t||isNaN(t=+t)?n:(l||(l=r(p.map(e),m,g)))(e(v(t)))}return b.invert=function(n){return v(t((f||(f=r(m,p.map(e),o.Z)))(n)))},b.domain=function(e){return arguments.length?(p=Array.from(e,a),y()):p.slice()},b.range=function(e){return arguments.length?(m=Array.from(e),y()):m.slice()},b.rangeRound=function(e){return m=Array.from(e),g=s,y()},b.clamp=function(e){return arguments.length?(v=!!e||c,y()):v!==c},b.interpolate=function(e){return arguments.length?(g=e,y()):g},b.unknown=function(e){return arguments.length?(n=e,b):n},function(n,r){return e=n,t=r,y()}}function m(){return p()(c,c)}},33235:function(e,t,n){"use strict";function r(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}n.d(t,{o:function(){return r}})},31105:function(e,t,n){"use strict";n.d(t,{Z:function(){return h},Q:function(){return l}});var r=n(77252),i=n(40220),o=n(33235),s=n(41653),a=n(43466);var u=n(32458);function c(e,t,n,i){var o,c=(0,r.ly)(e,t,n);switch((i=(0,s.Z)(null==i?",f":i)).type){case"s":var l=Math.max(Math.abs(e),Math.abs(t));return null!=i.precision||isNaN(o=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor((0,a.Z)(t)/3)))-(0,a.Z)(Math.abs(e)))}(c,l))||(i.precision=o),(0,u.jH)(i,l);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(o=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,(0,a.Z)(t)-(0,a.Z)(e))+1}(c,Math.max(Math.abs(e),Math.abs(t))))||(i.precision=o-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(o=function(e){return Math.max(0,-(0,a.Z)(Math.abs(e)))}(c))||(i.precision=o-2*("%"===i.type))}return(0,u.WU)(i)}function l(e){var t=e.domain;return e.ticks=function(e){var n=t();return(0,r.ZP)(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return c(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var i,o,s=t(),a=0,u=s.length-1,c=s[a],l=s[u],h=10;for(l<c&&(o=c,c=l,l=o,o=a,a=u,u=o);h-- >0;){if((o=(0,r.G9)(c,l,n))===i)return s[a]=c,s[u]=l,t(s);if(o>0)c=Math.floor(c/o)*o,l=Math.ceil(l/o)*o;else{if(!(o<0))break;c=Math.ceil(c*o)/o,l=Math.floor(l*o)/o}i=o}return e},e}function h(){var e=(0,i.ZP)();return e.copy=function(){return(0,i.JG)(e,h())},o.o.apply(e,arguments),l(e)}},7706:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var r=n(77252),i=n(41653),o=n(32458);var s=n(40220),a=n(33235);function u(e){return Math.log(e)}function c(e){return Math.exp(e)}function l(e){return-Math.log(-e)}function h(e){return-Math.exp(-e)}function d(e){return isFinite(e)?+("1e"+e):e<0?0:e}function f(e){return(t,n)=>-e(-t,n)}function p(e){const t=e(u,c),n=t.domain;let s,a,p=10;function m(){return s=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(p),a=function(e){return 10===e?d:e===Math.E?Math.exp:t=>Math.pow(e,t)}(p),n()[0]<0?(s=f(s),a=f(a),e(l,h)):e(u,c),t}return t.base=function(e){return arguments.length?(p=+e,m()):p},t.domain=function(e){return arguments.length?(n(e),m()):n()},t.ticks=e=>{const t=n();let i=t[0],o=t[t.length-1];const u=o<i;u&&([i,o]=[o,i]);let c,l,h=s(i),d=s(o);const f=null==e?10:+e;let m=[];if(!(p%1)&&d-h<f){if(h=Math.floor(h),d=Math.ceil(d),i>0){for(;h<=d;++h)for(c=1;c<p;++c)if(l=h<0?c/a(-h):c*a(h),!(l<i)){if(l>o)break;m.push(l)}}else for(;h<=d;++h)for(c=p-1;c>=1;--c)if(l=h>0?c/a(-h):c*a(h),!(l<i)){if(l>o)break;m.push(l)}2*m.length<f&&(m=(0,r.ZP)(i,o,f))}else m=(0,r.ZP)(h,d,Math.min(d-h,f)).map(a);return u?m.reverse():m},t.tickFormat=(e,n)=>{if(null==e&&(e=10),null==n&&(n=10===p?"s":","),"function"!=typeof n&&(p%1||null!=(n=(0,i.Z)(n)).precision||(n.trim=!0),n=(0,o.WU)(n)),e===1/0)return n;const r=Math.max(1,p*e/t.ticks().length);return e=>{let t=e/a(Math.round(s(e)));return t*p<p-.5&&(t*=p),t<=r?n(e):""}},t.nice=()=>n(function(e,t){var n,r=0,i=(e=e.slice()).length-1,o=e[r],s=e[i];return s<o&&(n=r,r=i,i=n,n=o,o=s,s=n),e[r]=t.floor(o),e[i]=t.ceil(s),e}(n(),{floor:e=>a(Math.floor(s(e))),ceil:e=>a(Math.ceil(s(e)))})),t}function m(){const e=p((0,s.l4)()).domain([1,10]);return e.copy=()=>(0,s.JG)(e,m()).base(e.base()),a.o.apply(e,arguments),e}},9771:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(14131),i=n(33235);const o=Symbol("implicit");function s(){var e=new r.L,t=[],n=[],a=o;function u(r){let i=e.get(r);if(void 0===i){if(a!==o)return a;e.set(r,i=t.push(r)-1)}return n[i%n.length]}return u.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new r.L;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return u},u.range=function(e){return arguments.length?(n=Array.from(e),u):n.slice()},u.unknown=function(e){return arguments.length?(a=e,u):a},u.copy=function(){return s(t,n).unknown(a)},i.o.apply(u,arguments),u}},78620:function(e,t,n){"use strict";n.d(t,{ZP:function(){return l}});var r=n(31105),i=n(40220),o=n(33235);function s(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function a(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function u(e){return e<0?-e*e:e*e}function c(e){var t=e(i.yR,i.yR),n=1;function o(){return 1===n?e(i.yR,i.yR):.5===n?e(a,u):e(s(n),s(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,o()):n},(0,r.Q)(t)}function l(){var e=c((0,i.l4)());return e.copy=function(){return(0,i.JG)(e,l()).exponent(e.exponent())},o.o.apply(e,arguments),e}},73409:function(e,t,n){"use strict";function r(e){return function(){return this.matches(e)}}function i(e){return function(t){return t.matches(e)}}n.d(t,{P:function(){return i},Z:function(){return r}})},60021:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(17110);function i(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),r.Z.hasOwnProperty(t)?{space:r.Z[t],local:e}:e}},17110:function(e,t,n){"use strict";n.d(t,{P:function(){return r}});var r="http://www.w3.org/1999/xhtml";t.Z={svg:"http://www.w3.org/2000/svg",xhtml:r,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"}},13802:function(e,t,n){"use strict";function r(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}n.d(t,{Z:function(){return r}})},41468:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(1776);function i(e){return"string"==typeof e?new r.Y1([[document.querySelector(e)]],[document.documentElement]):new r.Y1([[e]],r.Jz)}},1776:function(e,t,n){"use strict";n.d(t,{Y1:function(){return ue},ZP:function(){return le},Jz:function(){return ae}});var r=n(66456);function i(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}var o=n(16851);var s=n(73409),a=Array.prototype.find;function u(){return this.firstElementChild}var c=Array.prototype.filter;function l(){return Array.from(this.children)}function h(e){return new Array(e.length)}function d(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function f(e){return function(){return e}}function p(e,t,n,r,i,o){for(var s,a=0,u=t.length,c=o.length;a<c;++a)(s=t[a])?(s.__data__=o[a],r[a]=s):n[a]=new d(e,o[a]);for(;a<u;++a)(s=t[a])&&(i[a]=s)}function m(e,t,n,r,i,o,s){var a,u,c,l=new Map,h=t.length,f=o.length,p=new Array(h);for(a=0;a<h;++a)(u=t[a])&&(p[a]=c=s.call(u,u.__data__,a,t)+"",l.has(c)?i[a]=u:l.set(c,u));for(a=0;a<f;++a)c=s.call(e,o[a],a,o)+"",(u=l.get(c))?(r[a]=u,u.__data__=o[a],l.delete(c)):n[a]=new d(e,o[a]);for(a=0;a<h;++a)(u=t[a])&&l.get(p[a])===u&&(i[a]=u)}function g(e){return e.__data__}function v(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function y(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}d.prototype={constructor:d,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var b=n(60021);function _(e){return function(){this.removeAttribute(e)}}function x(e){return function(){this.removeAttributeNS(e.space,e.local)}}function w(e,t){return function(){this.setAttribute(e,t)}}function S(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function E(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function T(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}var M=n(77932);function A(e){return function(){delete this[e]}}function C(e,t){return function(){this[e]=t}}function O(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function P(e){return e.trim().split(/^|\s+/)}function R(e){return e.classList||new N(e)}function N(e){this._node=e,this._names=P(e.getAttribute("class")||"")}function I(e,t){for(var n=R(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function k(e,t){for(var n=R(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function D(e){return function(){I(this,e)}}function L(e){return function(){k(this,e)}}function U(e,t){return function(){(t.apply(this,arguments)?I:k)(this,e)}}function F(){this.textContent=""}function B(e){return function(){this.textContent=e}}function z(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function j(){this.innerHTML=""}function V(e){return function(){this.innerHTML=e}}function G(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function H(){this.nextSibling&&this.parentNode.appendChild(this)}function W(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}N.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var q=n(17110);function X(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===q.P&&t.documentElement.namespaceURI===q.P?t.createElement(e):t.createElementNS(n,e)}}function Z(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function $(e){var t=(0,b.Z)(e);return(t.local?Z:X)(t)}function Y(){return null}function K(){var e=this.parentNode;e&&e.removeChild(this)}function Q(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function J(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ee(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function te(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,o=t.length;r<o;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?t.length=i:delete this.__on}}}function ne(e,t,n){return function(){var r,i=this.__on,o=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var s=0,a=i.length;s<a;++s)if((r=i[s]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=t);this.addEventListener(e.type,o,n),r={type:e.type,name:e.name,value:t,listener:o,options:n},i?i.push(r):this.__on=[r]}}var re=n(4010);function ie(e,t,n){var r=(0,re.Z)(e),i=r.CustomEvent;"function"==typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function oe(e,t){return function(){return ie(this,e,t)}}function se(e,t){return function(){return ie(this,e,t.apply(this,arguments))}}var ae=[null];function ue(e,t){this._groups=e,this._parents=t}function ce(){return new ue([[document.documentElement]],ae)}ue.prototype=ce.prototype={constructor:ue,select:function(e){"function"!=typeof e&&(e=(0,r.Z)(e));for(var t=this._groups,n=t.length,i=new Array(n),o=0;o<n;++o)for(var s,a,u=t[o],c=u.length,l=i[o]=new Array(c),h=0;h<c;++h)(s=u[h])&&(a=e.call(s,s.__data__,h,u))&&("__data__"in s&&(a.__data__=s.__data__),l[h]=a);return new ue(i,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){return i(e.apply(this,arguments))}}(e):(0,o.Z)(e);for(var t=this._groups,n=t.length,r=[],s=[],a=0;a<n;++a)for(var u,c=t[a],l=c.length,h=0;h<l;++h)(u=c[h])&&(r.push(e.call(u,u.__data__,h,c)),s.push(u));return new ue(r,s)},selectChild:function(e){return this.select(null==e?u:function(e){return function(){return a.call(this.children,e)}}("function"==typeof e?e:(0,s.P)(e)))},selectChildren:function(e){return this.selectAll(null==e?l:function(e){return function(){return c.call(this.children,e)}}("function"==typeof e?e:(0,s.P)(e)))},filter:function(e){"function"!=typeof e&&(e=(0,s.Z)(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a=t[i],u=a.length,c=r[i]=[],l=0;l<u;++l)(o=a[l])&&e.call(o,o.__data__,l,a)&&c.push(o);return new ue(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,g);var n=t?m:p,r=this._parents,i=this._groups;"function"!=typeof e&&(e=f(e));for(var o=i.length,s=new Array(o),a=new Array(o),u=new Array(o),c=0;c<o;++c){var l=r[c],h=i[c],d=h.length,y=v(e.call(l,l&&l.__data__,c,r)),b=y.length,_=a[c]=new Array(b),x=s[c]=new Array(b),w=u[c]=new Array(d);n(l,h,_,x,w,y,t);for(var S,E,T=0,M=0;T<b;++T)if(S=_[T]){for(T>=M&&(M=T+1);!(E=x[M])&&++M<b;);S._next=E||null}}return(s=new ue(s,r))._enter=a,s._exit=u,s},enter:function(){return new ue(this._enter||this._groups.map(h),this._parents)},exit:function(){return new ue(this._exit||this._groups.map(h),this._parents)},join:function(e,t,n){var r=this.enter(),i=this,o=this.exit();return"function"==typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(i=t(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,o=r.length,s=Math.min(i,o),a=new Array(i),u=0;u<s;++u)for(var c,l=n[u],h=r[u],d=l.length,f=a[u]=new Array(d),p=0;p<d;++p)(c=l[p]||h[p])&&(f[p]=c);for(;u<i;++u)a[u]=n[u];return new ue(a,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],o=i.length-1,s=i[o];--o>=0;)(r=i[o])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=y);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s,a=n[o],u=a.length,c=i[o]=new Array(u),l=0;l<u;++l)(s=a[l])&&(c[l]=s);c.sort(t)}return new ue(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,o=t[n],s=0,a=o.length;s<a;++s)(i=o[s])&&e.call(i,i.__data__,s,o);return this},attr:function(e,t){var n=(0,b.Z)(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?x:_:"function"==typeof t?n.local?T:E:n.local?S:w)(n,t))},style:M.Z,property:function(e,t){return arguments.length>1?this.each((null==t?A:"function"==typeof t?O:C)(e,t)):this.node()[e]},classed:function(e,t){var n=P(e+"");if(arguments.length<2){for(var r=R(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?U:t?D:L)(n,t))},text:function(e){return arguments.length?this.each(null==e?F:("function"==typeof e?z:B)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?j:("function"==typeof e?G:V)(e)):this.node().innerHTML},raise:function(){return this.each(H)},lower:function(){return this.each(W)},append:function(e){var t="function"==typeof e?e:$(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:$(e),i=null==t?Y:"function"==typeof t?t:(0,r.Z)(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(K)},clone:function(e){return this.select(e?J:Q)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,o=ee(e+""),s=o.length;if(!(arguments.length<2)){for(a=t?ne:te,r=0;r<s;++r)this.each(a(o[r],t,n));return this}var a=this.node().__on;if(a)for(var u,c=0,l=a.length;c<l;++c)for(r=0,u=a[c];r<s;++r)if((i=o[r]).type===u.type&&i.name===u.name)return u.value},dispatch:function(e,t){return this.each(("function"==typeof t?se:oe)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,i=e[t],o=0,s=i.length;o<s;++o)(r=i[o])&&(yield r)}};var le=ce},77932:function(e,t,n){"use strict";n.d(t,{S:function(){return u},Z:function(){return a}});var r=n(4010);function i(e){return function(){this.style.removeProperty(e)}}function o(e,t,n){return function(){this.style.setProperty(e,t,n)}}function s(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function a(e,t,n){return arguments.length>1?this.each((null==t?i:"function"==typeof t?s:o)(e,t,null==n?"":n)):u(this.node(),e)}function u(e,t){return e.style.getPropertyValue(t)||(0,r.Z)(e).getComputedStyle(e,null).getPropertyValue(t)}},66456:function(e,t,n){"use strict";function r(){}function i(e){return null==e?r:function(){return this.querySelector(e)}}n.d(t,{Z:function(){return i}})},16851:function(e,t,n){"use strict";function r(){return[]}function i(e){return null==e?r:function(){return this.querySelectorAll(e)}}n.d(t,{Z:function(){return i}})},4010:function(e,t,n){"use strict";function r(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}n.d(t,{Z:function(){return r}})},83249:function(e,t,n){"use strict";n.d(t,{B7:function(){return m},HT:function(){return g},zO:function(){return f}});var r,i,o=0,s=0,a=0,u=0,c=0,l=0,h="object"==typeof performance&&performance.now?performance:Date,d="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function f(){return c||(d(p),c=h.now()+l)}function p(){c=0}function m(){this._call=this._time=this._next=null}function g(e,t,n){var r=new m;return r.restart(e,t,n),r}function v(){c=(u=h.now())+l,o=s=0;try{!function(){f(),++o;for(var e,t=r;t;)(e=c-t._time)>=0&&t._call.call(void 0,e),t=t._next;--o}()}finally{o=0,function(){var e,t,n=r,o=1/0;for(;n;)n._call?(o>n._time&&(o=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:r=t);i=e,b(o)}(),c=0}}function y(){var e=h.now(),t=e-u;t>1e3&&(l-=t,u=e)}function b(e){o||(s&&(s=clearTimeout(s)),e-c>24?(e<1/0&&(s=setTimeout(v,e-h.now()-l)),a&&(a=clearInterval(a))):(a||(u=h.now(),a=setInterval(y,1e3)),o=1,d(v)))}m.prototype=g.prototype={constructor:m,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?f():+n)+(null==t?0:+t),this._next||i===this||(i?i._next=this:r=this,i=this),this._call=e,this._time=n,b()},stop:function(){this._call&&(this._call=null,this._time=1/0,b())}}},21063:function(e,t,n){"use strict";n.d(t,{e1:function(){return f}});var r=n(1776),i=n(32436),o=n(83249);function s(e,t,n){var r=new o.B7;return t=null==t?0:+t,r.restart((n=>{r.stop(),e(n+t)}),t,n),r}var a=(0,i.Z)("start","end","cancel","interrupt"),u=[];function c(e,t,n,r,i,c){var l=e.__transition;if(l){if(n in l)return}else e.__transition={};!function(e,t,n){var r,i=e.__transition;function a(e){n.state=1,n.timer.restart(u,n.delay,n.time),n.delay<=e&&u(e-n.delay)}function u(o){var a,h,d,f;if(1!==n.state)return l();for(a in i)if((f=i[a]).name===n.name){if(3===f.state)return s(u);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",e,e.__data__,f.index,f.group),delete i[a]):+a<t&&(f.state=6,f.timer.stop(),f.on.call("cancel",e,e.__data__,f.index,f.group),delete i[a])}if(s((function(){3===n.state&&(n.state=4,n.timer.restart(c,n.delay,n.time),c(o))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(d=n.tween.length),a=0,h=-1;a<d;++a)(f=n.tween[a].value.call(e,e.__data__,n.index,n.group))&&(r[++h]=f);r.length=h+1}}function c(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(l),n.state=5,1),o=-1,s=r.length;++o<s;)r[o].call(e,i);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=(0,o.HT)(a,0,n.time)}(e,n,{name:t,index:r,group:i,on:a,tween:u,time:c.time,delay:c.delay,duration:c.duration,ease:c.ease,timer:null,state:0})}function l(e,t){var n=d(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function h(e,t){var n=d(e,t);if(n.state>3)throw new Error("too late; already running");return n}function d(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function f(e,t){var n,r,i,o=e.__transition,s=!0;if(o){for(i in t=null==t?null:t+"",o)(n=o[i]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete o[i]):s=!1;s&&delete e.__transition}}var p,m=n(88486),g=180/Math.PI,v={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function y(e,t,n,r,i,o){var s,a,u;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(u=e*n+t*r)&&(n-=e*u,r-=t*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),e*r<t*n&&(e=-e,t=-t,u=-u,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*g,skewX:Math.atan(u)*g,scaleX:s,scaleY:a}}function b(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(o,s){var a=[],u=[];return o=e(o),s=e(s),function(e,r,i,o,s,a){if(e!==i||r!==o){var u=s.push("translate(",null,t,null,n);a.push({i:u-4,x:(0,m.Z)(e,i)},{i:u-2,x:(0,m.Z)(r,o)})}else(i||o)&&s.push("translate("+i+t+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,u),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:(0,m.Z)(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(o.rotate,s.rotate,a,u),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:(0,m.Z)(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(o.skewX,s.skewX,a,u),function(e,t,n,r,o,s){if(e!==n||t!==r){var a=o.push(i(o)+"scale(",null,",",null,")");s.push({i:a-4,x:(0,m.Z)(e,n)},{i:a-2,x:(0,m.Z)(t,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,u),o=s=null,function(e){for(var t,n=-1,r=u.length;++n<r;)a[(t=u[n]).i]=t.x(e);return a.join("")}}}var _=b((function(e){var t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?v:y(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),x=b((function(e){return null==e?v:(p||(p=document.createElementNS("http://www.w3.org/2000/svg","g")),p.setAttribute("transform",e),(e=p.transform.baseVal.consolidate())?y((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):v)}),", ",")",")"),w=n(60021);function S(e,t){var n,r;return function(){var i=h(this,e),o=i.tween;if(o!==n)for(var s=0,a=(r=n=o).length;s<a;++s)if(r[s].name===t){(r=r.slice()).splice(s,1);break}i.tween=r}}function E(e,t,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=h(this,e),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:t,value:n},u=0,c=i.length;u<c;++u)if(i[u].name===t){i[u]=a;break}u===c&&i.push(a)}o.tween=i}}function T(e,t,n){var r=e._id;return e.each((function(){var e=h(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return d(e,r).value[t]}}var M=n(43300),A=n(45106),C=n(28685);function O(e,t){var n;return("number"==typeof t?m.Z:t instanceof M.ZP?A.ZP:(n=(0,M.ZP)(t))?(t=n,A.ZP):C.Z)(e,t)}function P(e){return function(){this.removeAttribute(e)}}function R(e){return function(){this.removeAttributeNS(e.space,e.local)}}function N(e,t,n){var r,i,o=n+"";return function(){var s=this.getAttribute(e);return s===o?null:s===r?i:i=t(r=s,n)}}function I(e,t,n){var r,i,o=n+"";return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===r?i:i=t(r=s,n)}}function k(e,t,n){var r,i,o;return function(){var s,a,u=n(this);if(null!=u)return(s=this.getAttribute(e))===(a=u+"")?null:s===r&&a===i?o:(i=a,o=t(r=s,u));this.removeAttribute(e)}}function D(e,t,n){var r,i,o;return function(){var s,a,u=n(this);if(null!=u)return(s=this.getAttributeNS(e.space,e.local))===(a=u+"")?null:s===r&&a===i?o:(i=a,o=t(r=s,u));this.removeAttributeNS(e.space,e.local)}}function L(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function U(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function F(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&U(e,i)),n}return i._value=t,i}function B(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&L(e,i)),n}return i._value=t,i}function z(e,t){return function(){l(this,e).delay=+t.apply(this,arguments)}}function j(e,t){return t=+t,function(){l(this,e).delay=t}}function V(e,t){return function(){h(this,e).duration=+t.apply(this,arguments)}}function G(e,t){return t=+t,function(){h(this,e).duration=t}}function H(e,t){if("function"!=typeof t)throw new Error;return function(){h(this,e).ease=t}}var W=n(73409);function q(e,t,n){var r,i,o=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?l:h;return function(){var s=o(this,e),a=s.on;a!==r&&(i=(r=a).copy()).on(t,n),s.on=i}}var X=n(66456);var Z=n(16851);var $=r.ZP.prototype.constructor;var Y=n(77932);function K(e){return function(){this.style.removeProperty(e)}}function Q(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function J(e,t,n){var r,i;function o(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&Q(e,o,n)),r}return o._value=t,o}function ee(e){return function(t){this.textContent=e.call(this,t)}}function te(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&ee(r)),t}return r._value=e,r}var ne=0;function re(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function ie(){return++ne}var oe=r.ZP.prototype;re.prototype=function(e){return(0,r.ZP)().transition(e)}.prototype={constructor:re,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=(0,X.Z)(e));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var a,u,l=r[s],h=l.length,f=o[s]=new Array(h),p=0;p<h;++p)(a=l[p])&&(u=e.call(a,a.__data__,p,l))&&("__data__"in a&&(u.__data__=a.__data__),f[p]=u,c(f[p],t,n,p,f,d(a,n)));return new re(o,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=(0,Z.Z)(e));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var u,l=r[a],h=l.length,f=0;f<h;++f)if(u=l[f]){for(var p,m=e.call(u,u.__data__,f,l),g=d(u,n),v=0,y=m.length;v<y;++v)(p=m[v])&&c(p,t,n,v,m,g);o.push(m),s.push(u)}return new re(o,s,t,n)},selectChild:oe.selectChild,selectChildren:oe.selectChildren,filter:function(e){"function"!=typeof e&&(e=(0,W.Z)(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,s=t[i],a=s.length,u=r[i]=[],c=0;c<a;++c)(o=s[c])&&e.call(o,o.__data__,c,s)&&u.push(o);return new re(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var u,c=t[a],l=n[a],h=c.length,d=s[a]=new Array(h),f=0;f<h;++f)(u=c[f]||l[f])&&(d[f]=u);for(;a<r;++a)s[a]=t[a];return new re(s,this._parents,this._name,this._id)},selection:function(){return new $(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=ie(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],u=a.length,l=0;l<u;++l)if(s=a[l]){var h=d(s,t);c(s,e,n,l,a,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new re(r,this._parents,e,n)},call:oe.call,nodes:oe.nodes,node:oe.node,size:oe.size,empty:oe.empty,each:oe.each,on:function(e,t){var n=this._id;return arguments.length<2?d(this.node(),n).on.on(e):this.each(q(n,e,t))},attr:function(e,t){var n=(0,w.Z)(e),r="transform"===n?x:O;return this.attrTween(e,"function"==typeof t?(n.local?D:k)(n,r,T(this,"attr."+e,t)):null==t?(n.local?R:P)(n):(n.local?I:N)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var r=(0,w.Z)(e);return this.tween(n,(r.local?F:B)(r,t))},style:function(e,t,n){var r="transform"==(e+="")?_:O;return null==t?this.styleTween(e,function(e,t){var n,r,i;return function(){var o=(0,Y.S)(this,e),s=(this.style.removeProperty(e),(0,Y.S)(this,e));return o===s?null:o===n&&s===r?i:i=t(n=o,r=s)}}(e,r)).on("end.style."+e,K(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var r,i,o;return function(){var s=(0,Y.S)(this,e),a=n(this),u=a+"";return null==a&&(this.style.removeProperty(e),u=a=(0,Y.S)(this,e)),s===u?null:s===r&&u===i?o:(i=u,o=t(r=s,a))}}(e,r,T(this,"style."+e,t))).each(function(e,t){var n,r,i,o,s="style."+t,a="end."+s;return function(){var u=h(this,e),c=u.on,l=null==u.value[s]?o||(o=K(t)):void 0;c===n&&i===l||(r=(n=c).copy()).on(a,i=l),u.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,i,o=n+"";return function(){var s=(0,Y.S)(this,e);return s===o?null:s===r?i:i=t(r=s,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;return this.tween(r,J(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(T(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,te(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,i=d(this.node(),n).tween,o=0,s=i.length;o<s;++o)if((r=i[o]).name===e)return r.value;return null}return this.each((null==t?S:E)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?z:j)(t,e)):d(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?V:G)(t,e)):d(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(H(t,e)):d(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw new Error;h(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,i=n.size();return new Promise((function(o,s){var a={value:s},u={value:function(){0==--i&&o()}};n.each((function(){var n=h(this,r),i=n.on;i!==e&&((t=(e=i).copy())._.cancel.push(a),t._.interrupt.push(a),t._.end.push(u)),n.on=t})),0===i&&o()}))},[Symbol.iterator]:oe[Symbol.iterator]};var se={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function ae(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}r.ZP.prototype.interrupt=function(e){return this.each((function(){f(this,e)}))},r.ZP.prototype.transition=function(e){var t,n;e instanceof re?(t=e._id,e=e._name):(t=ie(),(n=se).time=(0,o.zO)(),e=null==e?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var a,u=r[s],l=u.length,h=0;h<l;++h)(a=u[h])&&c(a,e,t,h,u,n||ae(a,t));return new re(r,this._parents,e,t)}},89888:function(e,t,n){"use strict";n.d(t,{sP:function(){return S},CR:function(){return f},P2:function(){return p}});var r=n(32436),i=n(49289);function o(e){return((e=Math.exp(e))+1/e)/2}var s=function e(t,n,r){function i(e,i){var s,a,u=e[0],c=e[1],l=e[2],h=i[0],d=i[1],f=i[2],p=h-u,m=d-c,g=p*p+m*m;if(g<1e-12)a=Math.log(f/l)/t,s=function(e){return[u+e*p,c+e*m,l*Math.exp(t*e*a)]};else{var v=Math.sqrt(g),y=(f*f-l*l+r*g)/(2*l*n*v),b=(f*f-l*l-r*g)/(2*f*n*v),_=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(b*b+1)-b);a=(x-_)/t,s=function(e){var r,i=e*a,s=o(_),h=l/(n*v)*(s*(r=t*i+_,((r=Math.exp(2*r))-1)/(r+1))-function(e){return((e=Math.exp(e))-1/e)/2}(_));return[u+h*p,c+h*m,l*s/o(t*i+_)]}}return s.duration=1e3*a*t/Math.SQRT2,s}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},i}(Math.SQRT2,2,4),a=n(41468),u=n(13802),c=n(21063),l=e=>()=>e;function h(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function d(e,t,n){this.k=e,this.x=t,this.y=n}d.prototype={constructor:d,scale:function(e){return 1===e?this:new d(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new d(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var f=new d(1,0,0);function p(e){for(;!e.__zoom;)if(!(e=e.parentNode))return f;return e.__zoom}function m(e){e.stopImmediatePropagation()}function g(e){e.preventDefault(),e.stopImmediatePropagation()}function v(e){return!(e.ctrlKey&&"wheel"!==e.type||e.button)}function y(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function b(){return this.__zoom||f}function _(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function x(){return navigator.maxTouchPoints||"ontouchstart"in this}function w(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function S(){var e,t,n,o=v,p=y,S=w,E=_,T=x,M=[0,1/0],A=[[-1/0,-1/0],[1/0,1/0]],C=250,O=s,P=(0,r.Z)("start","zoom","end"),R=500,N=0,I=10;function k(e){e.property("__zoom",b).on("wheel.zoom",j,{passive:!1}).on("mousedown.zoom",V).on("dblclick.zoom",G).filter(T).on("touchstart.zoom",H).on("touchmove.zoom",W).on("touchend.zoom touchcancel.zoom",q).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function D(e,t){return(t=Math.max(M[0],Math.min(M[1],t)))===e.k?e:new d(t,e.x,e.y)}function L(e,t,n){var r=t[0]-n[0]*e.k,i=t[1]-n[1]*e.k;return r===e.x&&i===e.y?e:new d(e.k,r,i)}function U(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function F(e,t,n,r){e.on("start.zoom",(function(){B(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){B(this,arguments).event(r).end()})).tween("zoom",(function(){var e=this,i=arguments,o=B(e,i).event(r),s=p.apply(e,i),a=null==n?U(s):"function"==typeof n?n.apply(e,i):n,u=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),c=e.__zoom,l="function"==typeof t?t.apply(e,i):t,h=O(c.invert(a).concat(u/c.k),l.invert(a).concat(u/l.k));return function(e){if(1===e)e=l;else{var t=h(e),n=u/t[2];e=new d(n,a[0]-t[0]*n,a[1]-t[1]*n)}o.zoom(null,e)}}))}function B(e,t,n){return!n&&e.__zooming||new z(e,t)}function z(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=p.apply(e,t),this.taps=0}function j(e,...t){if(o.apply(this,arguments)){var n=B(this,t).event(e),r=this.__zoom,i=Math.max(M[0],Math.min(M[1],r.k*Math.pow(2,E.apply(this,arguments)))),s=(0,u.Z)(e);if(n.wheel)n.mouse[0][0]===s[0]&&n.mouse[0][1]===s[1]||(n.mouse[1]=r.invert(n.mouse[0]=s)),clearTimeout(n.wheel);else{if(r.k===i)return;n.mouse=[s,r.invert(s)],(0,c.e1)(this),n.start()}g(e),n.wheel=setTimeout(a,150),n.zoom("mouse",S(L(D(r,i),n.mouse[0],n.mouse[1]),n.extent,A))}function a(){n.wheel=null,n.end()}}function V(e,...t){if(!n&&o.apply(this,arguments)){var r=e.currentTarget,s=B(this,t,!0).event(e),l=(0,a.Z)(e.view).on("mousemove.zoom",p,!0).on("mouseup.zoom",v,!0),h=(0,u.Z)(e,r),d=e.clientX,f=e.clientY;(0,i.Z)(e.view),m(e),s.mouse=[h,this.__zoom.invert(h)],(0,c.e1)(this),s.start()}function p(e){if(g(e),!s.moved){var t=e.clientX-d,n=e.clientY-f;s.moved=t*t+n*n>N}s.event(e).zoom("mouse",S(L(s.that.__zoom,s.mouse[0]=(0,u.Z)(e,r),s.mouse[1]),s.extent,A))}function v(e){l.on("mousemove.zoom mouseup.zoom",null),(0,i.D)(e.view,s.moved),g(e),s.event(e).end()}}function G(e,...t){if(o.apply(this,arguments)){var n=this.__zoom,r=(0,u.Z)(e.changedTouches?e.changedTouches[0]:e,this),i=n.invert(r),s=n.k*(e.shiftKey?.5:2),c=S(L(D(n,s),r,i),p.apply(this,t),A);g(e),C>0?(0,a.Z)(this).transition().duration(C).call(F,c,r,e):(0,a.Z)(this).call(k.transform,c,r,e)}}function H(n,...r){if(o.apply(this,arguments)){var i,s,a,l,h=n.touches,d=h.length,f=B(this,r,n.changedTouches.length===d).event(n);for(m(n),s=0;s<d;++s)a=h[s],l=[l=(0,u.Z)(a,this),this.__zoom.invert(l),a.identifier],f.touch0?f.touch1||f.touch0[2]===l[2]||(f.touch1=l,f.taps=0):(f.touch0=l,i=!0,f.taps=1+!!e);e&&(e=clearTimeout(e)),i&&(f.taps<2&&(t=l[0],e=setTimeout((function(){e=null}),R)),(0,c.e1)(this),f.start())}}function W(e,...t){if(this.__zooming){var n,r,i,o,s=B(this,t).event(e),a=e.changedTouches,c=a.length;for(g(e),n=0;n<c;++n)r=a[n],i=(0,u.Z)(r,this),s.touch0&&s.touch0[2]===r.identifier?s.touch0[0]=i:s.touch1&&s.touch1[2]===r.identifier&&(s.touch1[0]=i);if(r=s.that.__zoom,s.touch1){var l=s.touch0[0],h=s.touch0[1],d=s.touch1[0],f=s.touch1[1],p=(p=d[0]-l[0])*p+(p=d[1]-l[1])*p,m=(m=f[0]-h[0])*m+(m=f[1]-h[1])*m;r=D(r,Math.sqrt(p/m)),i=[(l[0]+d[0])/2,(l[1]+d[1])/2],o=[(h[0]+f[0])/2,(h[1]+f[1])/2]}else{if(!s.touch0)return;i=s.touch0[0],o=s.touch0[1]}s.zoom("touch",S(L(r,i,o),s.extent,A))}}function q(e,...r){if(this.__zooming){var i,o,s=B(this,r).event(e),c=e.changedTouches,l=c.length;for(m(e),n&&clearTimeout(n),n=setTimeout((function(){n=null}),R),i=0;i<l;++i)o=c[i],s.touch0&&s.touch0[2]===o.identifier?delete s.touch0:s.touch1&&s.touch1[2]===o.identifier&&delete s.touch1;if(s.touch1&&!s.touch0&&(s.touch0=s.touch1,delete s.touch1),s.touch0)s.touch0[1]=this.__zoom.invert(s.touch0[0]);else if(s.end(),2===s.taps&&(o=(0,u.Z)(o,this),Math.hypot(t[0]-o[0],t[1]-o[1])<I)){var h=(0,a.Z)(this).on("dblclick.zoom");h&&h.apply(this,arguments)}}}return k.transform=function(e,t,n,r){var i=e.selection?e.selection():e;i.property("__zoom",b),e!==i?F(e,t,n,r):i.interrupt().each((function(){B(this,arguments).event(r).start().zoom(null,"function"==typeof t?t.apply(this,arguments):t).end()}))},k.scaleBy=function(e,t,n,r){k.scaleTo(e,(function(){var e=this.__zoom.k,n="function"==typeof t?t.apply(this,arguments):t;return e*n}),n,r)},k.scaleTo=function(e,t,n,r){k.transform(e,(function(){var e=p.apply(this,arguments),r=this.__zoom,i=null==n?U(e):"function"==typeof n?n.apply(this,arguments):n,o=r.invert(i),s="function"==typeof t?t.apply(this,arguments):t;return S(L(D(r,s),i,o),e,A)}),n,r)},k.translateBy=function(e,t,n,r){k.transform(e,(function(){return S(this.__zoom.translate("function"==typeof t?t.apply(this,arguments):t,"function"==typeof n?n.apply(this,arguments):n),p.apply(this,arguments),A)}),null,r)},k.translateTo=function(e,t,n,r,i){k.transform(e,(function(){var e=p.apply(this,arguments),i=this.__zoom,o=null==r?U(e):"function"==typeof r?r.apply(this,arguments):r;return S(f.translate(o[0],o[1]).scale(i.k).translate("function"==typeof t?-t.apply(this,arguments):-t,"function"==typeof n?-n.apply(this,arguments):-n),e,A)}),r,i)},z.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=(0,a.Z)(this.that).datum();P.call(e,this.that,new h(e,{sourceEvent:this.sourceEvent,target:k,type:e,transform:this.that.__zoom,dispatch:P}),t)}},k.wheelDelta=function(e){return arguments.length?(E="function"==typeof e?e:l(+e),k):E},k.filter=function(e){return arguments.length?(o="function"==typeof e?e:l(!!e),k):o},k.touchable=function(e){return arguments.length?(T="function"==typeof e?e:l(!!e),k):T},k.extent=function(e){return arguments.length?(p="function"==typeof e?e:l([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),k):p},k.scaleExtent=function(e){return arguments.length?(M[0]=+e[0],M[1]=+e[1],k):[M[0],M[1]]},k.translateExtent=function(e){return arguments.length?(A[0][0]=+e[0][0],A[1][0]=+e[1][0],A[0][1]=+e[0][1],A[1][1]=+e[1][1],k):[[A[0][0],A[0][1]],[A[1][0],A[1][1]]]},k.constrain=function(e){return arguments.length?(S=e,k):S},k.duration=function(e){return arguments.length?(C=+e,k):C},k.interpolate=function(e){return arguments.length?(O=e,k):O},k.on=function(){var e=P.on.apply(P,arguments);return e===P?k:e},k.clickDistance=function(e){return arguments.length?(N=(e=+e)*e,k):Math.sqrt(N)},k.tapDistance=function(e){return arguments.length?(I=+e,k):I},k}p.prototype=d.prototype},21896:function(e,n,r){"use strict";r.d(n,{Z:function(){return Ne}});var i=r(41468),o=r(89888),s=r(45452),a=r(49085),u=r(86925),c=r(32598),l=r(82433);var h=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return(0,l.Z)(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),(0,c.Z)(e,t,{leading:r,maxWait:t,trailing:i})},d=r(83109),f=r(42358),p=r(66819),m=r(20680);function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){return e.get(v(e,t))}function _(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function x(e,t,n){return e.set(v(e,t),n),n}function w(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,E(r.key),r)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function S(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}var T=function(e,t,n){return(e<<16)+(t<<8)+n},M=function(e,t){return 123*e%Math.pow(2,t)},A=new WeakMap,C=new WeakMap,O=function(){return w((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;y(this,e),_(this,A,void 0),_(this,C,void 0),x(C,this,t),this.reset()}),[{key:"reset",value:function(){x(A,this,["__reserved for background__"])}},{key:"register",value:function(e){if(b(A,this).length>=Math.pow(2,24-b(C,this)))return null;var t,n=b(A,this).length,r=M(n,b(C,this)),i=(t=n+(r<<24-b(C,this)),"#".concat(Math.min(t,Math.pow(2,24)).toString(16).padStart(6,"0")));return b(A,this).push(e),i}},{key:"lookup",value:function(e){if(!e)return null;var t,n,r,i,o,s="string"==typeof e?(t=e,n=(0,m.Z)(t).toRgb(),r=n.r,i=n.g,o=n.b,T(r,i,o)):T.apply(void 0,S(e));if(!s)return null;var a=s&Math.pow(2,24-b(C,this))-1,u=s>>24-b(C,this)&Math.pow(2,b(C,this))-1;return M(a,b(C,this))!==u||a>=b(A,this).length?null:b(A,this)[a]}}])}(),P=r(13320),R=r(5271),N=r(80621),I=r(44200),k=r(54476);const{abs:D,cos:L,sin:U,acos:F,atan2:B,sqrt:z,pow:j}=Math;function V(e){return e<0?-j(-e,1/3):j(e,1/3)}const G=Math.PI,H=2*G,W=G/2,q=Number.MAX_SAFE_INTEGER||9007199254740991,X=Number.MIN_SAFE_INTEGER||-9007199254740991,Z={x:0,y:0,z:0},$={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(e,t){const n=t(e);let r=n.x*n.x+n.y*n.y;return void 0!==n.z&&(r+=n.z*n.z),z(r)},compute:function(e,t,n){if(0===e)return t[0].t=0,t[0];const r=t.length-1;if(1===e)return t[r].t=1,t[r];const i=1-e;let o=t;if(0===r)return t[0].t=e,t[0];if(1===r){const t={x:i*o[0].x+e*o[1].x,y:i*o[0].y+e*o[1].y,t:e};return n&&(t.z=i*o[0].z+e*o[1].z),t}if(r<4){let t,s,a,u=i*i,c=e*e,l=0;2===r?(o=[o[0],o[1],o[2],Z],t=u,s=i*e*2,a=c):3===r&&(t=u*i,s=u*e*3,a=i*c*3,l=e*c);const h={x:t*o[0].x+s*o[1].x+a*o[2].x+l*o[3].x,y:t*o[0].y+s*o[1].y+a*o[2].y+l*o[3].y,t:e};return n&&(h.z=t*o[0].z+s*o[1].z+a*o[2].z+l*o[3].z),h}const s=JSON.parse(JSON.stringify(t));for(;s.length>1;){for(let t=0;t<s.length-1;t++)s[t]={x:s[t].x+(s[t+1].x-s[t].x)*e,y:s[t].y+(s[t+1].y-s[t].y)*e},void 0!==s[t].z&&(s[t].z=s[t].z+(s[t+1].z-s[t].z)*e);s.splice(s.length-1,1)}return s[0].t=e,s[0]},computeWithRatios:function(e,t,n,r){const i=1-e,o=n,s=t;let a,u=o[0],c=o[1],l=o[2],h=o[3];return u*=i,c*=e,2===s.length?(a=u+c,{x:(u*s[0].x+c*s[1].x)/a,y:(u*s[0].y+c*s[1].y)/a,z:!!r&&(u*s[0].z+c*s[1].z)/a,t:e}):(u*=i,c*=2*i,l*=e*e,3===s.length?(a=u+c+l,{x:(u*s[0].x+c*s[1].x+l*s[2].x)/a,y:(u*s[0].y+c*s[1].y+l*s[2].y)/a,z:!!r&&(u*s[0].z+c*s[1].z+l*s[2].z)/a,t:e}):(u*=i,c*=1.5*i,l*=3*i,h*=e*e*e,4===s.length?(a=u+c+l+h,{x:(u*s[0].x+c*s[1].x+l*s[2].x+h*s[3].x)/a,y:(u*s[0].y+c*s[1].y+l*s[2].y+h*s[3].y)/a,z:!!r&&(u*s[0].z+c*s[1].z+l*s[2].z+h*s[3].z)/a,t:e}):void 0))},derive:function(e,t){const n=[];for(let r=e,i=r.length,o=i-1;i>1;i--,o--){const e=[];for(let n,i=0;i<o;i++)n={x:o*(r[i+1].x-r[i].x),y:o*(r[i+1].y-r[i].y)},t&&(n.z=o*(r[i+1].z-r[i].z)),e.push(n);n.push(e),r=e}return n},between:function(e,t,n){return t<=e&&e<=n||$.approximately(e,t)||$.approximately(e,n)},approximately:function(e,t,n){return D(e-t)<=(n||1e-6)},length:function(e){const t=$.Tvalues.length;let n=0;for(let r,i=0;i<t;i++)r=.5*$.Tvalues[i]+.5,n+=$.Cvalues[i]*$.arcfn(r,e);return.5*n},map:function(e,t,n,r,i){return r+(i-r)*((e-t)/(n-t))},lerp:function(e,t,n){const r={x:t.x+e*(n.x-t.x),y:t.y+e*(n.y-t.y)};return void 0!==t.z&&void 0!==n.z&&(r.z=t.z+e*(n.z-t.z)),r},pointToString:function(e){let t=e.x+"/"+e.y;return void 0!==e.z&&(t+="/"+e.z),t},pointsToString:function(e){return"["+e.map($.pointToString).join(", ")+"]"},copy:function(e){return JSON.parse(JSON.stringify(e))},angle:function(e,t,n){const r=t.x-e.x,i=t.y-e.y,o=n.x-e.x,s=n.y-e.y;return B(r*s-i*o,r*o+i*s)},round:function(e,t){const n=""+e,r=n.indexOf(".");return parseFloat(n.substring(0,r+1+t))},dist:function(e,t){const n=e.x-t.x,r=e.y-t.y;return z(n*n+r*r)},closest:function(e,t){let n,r,i=j(2,63);return e.forEach((function(e,o){r=$.dist(t,e),r<i&&(i=r,n=o)})),{mdist:i,mpos:n}},abcratio:function(e,t){if(2!==t&&3!==t)return!1;if(void 0===e)e=.5;else if(0===e||1===e)return e;const n=j(e,t)+j(1-e,t);return D((n-1)/n)},projectionratio:function(e,t){if(2!==t&&3!==t)return!1;if(void 0===e)e=.5;else if(0===e||1===e)return e;const n=j(1-e,t);return n/(j(e,t)+n)},lli8:function(e,t,n,r,i,o,s,a){const u=(e-n)*(o-a)-(t-r)*(i-s);return 0!=u&&{x:((e*r-t*n)*(i-s)-(e-n)*(i*a-o*s))/u,y:((e*r-t*n)*(o-a)-(t-r)*(i*a-o*s))/u}},lli4:function(e,t,n,r){const i=e.x,o=e.y,s=t.x,a=t.y,u=n.x,c=n.y,l=r.x,h=r.y;return $.lli8(i,o,s,a,u,c,l,h)},lli:function(e,t){return $.lli4(e,e.c,t,t.c)},makeline:function(e,t){return new oe(e.x,e.y,(e.x+t.x)/2,(e.y+t.y)/2,t.x,t.y)},findbbox:function(e){let t=q,n=q,r=X,i=X;return e.forEach((function(e){const o=e.bbox();t>o.x.min&&(t=o.x.min),n>o.y.min&&(n=o.y.min),r<o.x.max&&(r=o.x.max),i<o.y.max&&(i=o.y.max)})),{x:{min:t,mid:(t+r)/2,max:r,size:r-t},y:{min:n,mid:(n+i)/2,max:i,size:i-n}}},shapeintersections:function(e,t,n,r,i){if(!$.bboxoverlap(t,r))return[];const o=[],s=[e.startcap,e.forward,e.back,e.endcap],a=[n.startcap,n.forward,n.back,n.endcap];return s.forEach((function(t){t.virtual||a.forEach((function(r){if(r.virtual)return;const s=t.intersects(r,i);s.length>0&&(s.c1=t,s.c2=r,s.s1=e,s.s2=n,o.push(s))}))})),o},makeshape:function(e,t,n){const r=t.points.length,i=e.points.length,o=$.makeline(t.points[r-1],e.points[0]),s=$.makeline(e.points[i-1],t.points[0]),a={startcap:o,forward:e,back:t,endcap:s,bbox:$.findbbox([o,e,t,s]),intersections:function(e){return $.shapeintersections(a,a.bbox,e,e.bbox,n)}};return a},getminmax:function(e,t,n){if(!n)return{min:0,max:0};let r,i,o=q,s=X;-1===n.indexOf(0)&&(n=[0].concat(n)),-1===n.indexOf(1)&&n.push(1);for(let a=0,u=n.length;a<u;a++)r=n[a],i=e.get(r),i[t]<o&&(o=i[t]),i[t]>s&&(s=i[t]);return{min:o,mid:(o+s)/2,max:s,size:s-o}},align:function(e,t){const n=t.p1.x,r=t.p1.y,i=-B(t.p2.y-r,t.p2.x-n);return e.map((function(e){return{x:(e.x-n)*L(i)-(e.y-r)*U(i),y:(e.x-n)*U(i)+(e.y-r)*L(i)}}))},roots:function(e,t){t=t||{p1:{x:0,y:0},p2:{x:1,y:0}};const n=e.length-1,r=$.align(e,t),i=function(e){return 0<=e&&e<=1};if(2===n){const e=r[0].y,t=r[1].y,n=r[2].y,o=e-2*t+n;if(0!==o){const r=-z(t*t-e*n),s=-e+t;return[-(r+s)/o,-(-r+s)/o].filter(i)}return t!==n&&0===o?[(2*t-n)/(2*t-2*n)].filter(i):[]}const o=r[0].y,s=r[1].y,a=r[2].y;let u=3*s-o-3*a+r[3].y,c=3*o-6*s+3*a,l=-3*o+3*s,h=o;if($.approximately(u,0)){if($.approximately(c,0))return $.approximately(l,0)?[]:[-h/l].filter(i);const e=z(l*l-4*c*h),t=2*c;return[(e-l)/t,(-l-e)/t].filter(i)}c/=u,l/=u,h/=u;const d=(3*l-c*c)/3,f=d/3,p=(2*c*c*c-9*c*l+27*h)/27,m=p/2,g=m*m+f*f*f;let v,y,b,_,x;if(g<0){const e=-d/3,t=z(e*e*e),n=-p/(2*t),r=F(n<-1?-1:n>1?1:n),o=2*V(t);return b=o*L(r/3)-c/3,_=o*L((r+H)/3)-c/3,x=o*L((r+2*H)/3)-c/3,[b,_,x].filter(i)}if(0===g)return v=m<0?V(-m):-V(m),b=2*v-c/3,_=-v-c/3,[b,_].filter(i);{const e=z(g);return v=V(-m+e),y=V(m+e),[v-y-c/3].filter(i)}},droots:function(e){if(3===e.length){const t=e[0],n=e[1],r=e[2],i=t-2*n+r;if(0!==i){const e=-z(n*n-t*r),o=-t+n;return[-(e+o)/i,-(-e+o)/i]}return n!==r&&0===i?[(2*n-r)/(2*(n-r))]:[]}if(2===e.length){const t=e[0],n=e[1];return t!==n?[t/(t-n)]:[]}return[]},curvature:function(e,t,n,r,i){let o,s,a,u,c=0,l=0;const h=$.compute(e,t),d=$.compute(e,n),f=h.x*h.x+h.y*h.y;if(r?(o=z(j(h.y*d.z-d.y*h.z,2)+j(h.z*d.x-d.z*h.x,2)+j(h.x*d.y-d.x*h.y,2)),s=j(f+h.z*h.z,1.5)):(o=h.x*d.y-h.y*d.x,s=j(f,1.5)),0===o||0===s)return{k:0,r:0};if(c=o/s,l=s/o,!i){const i=$.curvature(e-.001,t,n,r,!0).k,o=$.curvature(e+.001,t,n,r,!0).k;u=(o-c+(c-i))/2,a=(D(o-c)+D(c-i))/2}return{k:c,r:l,dk:u,adk:a}},inflections:function(e){if(e.length<4)return[];const t=$.align(e,{p1:e[0],p2:e.slice(-1)[0]}),n=t[2].x*t[1].y,r=t[3].x*t[1].y,i=t[1].x*t[2].y,o=18*(-3*n+2*r+3*i-t[3].x*t[2].y),s=18*(3*n-r-3*i),a=18*(i-n);if($.approximately(o,0)){if(!$.approximately(s,0)){let e=-a/s;if(0<=e&&e<=1)return[e]}return[]}const u=2*o;if($.approximately(u,0))return[];const c=s*s-4*o*a;if(c<0)return[];const l=Math.sqrt(c);return[(l-s)/u,-(s+l)/u].filter((function(e){return 0<=e&&e<=1}))},bboxoverlap:function(e,t){const n=["x","y"],r=n.length;for(let i,o,s,a,u=0;u<r;u++)if(i=n[u],o=e[i].mid,s=t[i].mid,a=(e[i].size+t[i].size)/2,D(o-s)>=a)return!1;return!0},expandbox:function(e,t){t.x.min<e.x.min&&(e.x.min=t.x.min),t.y.min<e.y.min&&(e.y.min=t.y.min),t.z&&t.z.min<e.z.min&&(e.z.min=t.z.min),t.x.max>e.x.max&&(e.x.max=t.x.max),t.y.max>e.y.max&&(e.y.max=t.y.max),t.z&&t.z.max>e.z.max&&(e.z.max=t.z.max),e.x.mid=(e.x.min+e.x.max)/2,e.y.mid=(e.y.min+e.y.max)/2,e.z&&(e.z.mid=(e.z.min+e.z.max)/2),e.x.size=e.x.max-e.x.min,e.y.size=e.y.max-e.y.min,e.z&&(e.z.size=e.z.max-e.z.min)},pairiteration:function(e,t,n){const r=e.bbox(),i=t.bbox(),o=1e5,s=n||.5;if(r.x.size+r.y.size<s&&i.x.size+i.y.size<s)return[(o*(e._t1+e._t2)/2|0)/o+"/"+(o*(t._t1+t._t2)/2|0)/o];let a=e.split(.5),u=t.split(.5),c=[{left:a.left,right:u.left},{left:a.left,right:u.right},{left:a.right,right:u.right},{left:a.right,right:u.left}];c=c.filter((function(e){return $.bboxoverlap(e.left.bbox(),e.right.bbox())}));let l=[];return 0===c.length||(c.forEach((function(e){l=l.concat($.pairiteration(e.left,e.right,s))})),l=l.filter((function(e,t){return l.indexOf(e)===t}))),l},getccenter:function(e,t,n){const r=t.x-e.x,i=t.y-e.y,o=n.x-t.x,s=n.y-t.y,a=r*L(W)-i*U(W),u=r*U(W)+i*L(W),c=o*L(W)-s*U(W),l=o*U(W)+s*L(W),h=(e.x+t.x)/2,d=(e.y+t.y)/2,f=(t.x+n.x)/2,p=(t.y+n.y)/2,m=h+a,g=d+u,v=f+c,y=p+l,b=$.lli8(h,d,m,g,f,p,v,y),_=$.dist(b,e);let x,w=B(e.y-b.y,e.x-b.x),S=B(t.y-b.y,t.x-b.x),E=B(n.y-b.y,n.x-b.x);return w<E?((w>S||S>E)&&(w+=H),w>E&&(x=E,E=w,w=x)):E<S&&S<w?(x=E,E=w,w=x):E+=H,b.s=w,b.e=E,b.r=_,b},numberSort:function(e,t){return e-t}};class Y{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map((function(e){return $.pointsToString(e.points)})).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map((function(e){return e.length()})).reduce((function(e,t){return e+t}))}curve(e){return this.curves[e]}bbox(){const e=this.curves;for(var t=e[0].bbox(),n=1;n<e.length;n++)$.expandbox(t,e[n].bbox());return t}offset(e){const t=[];return this.curves.forEach((function(n){t.push(...n.offset(e))})),new Y(t)}}const{abs:K,min:Q,max:J,cos:ee,sin:te,acos:ne,sqrt:re}=Math,ie=Math.PI;class oe{constructor(e){let t=e&&e.forEach?e:Array.from(arguments).slice(),n=!1;if("object"==typeof t[0]){n=t.length;const e=[];t.forEach((function(t){["x","y","z"].forEach((function(n){void 0!==t[n]&&e.push(t[n])}))})),t=e}let r=!1;const i=t.length;if(n){if(n>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");r=!0}}else if(6!==i&&8!==i&&9!==i&&12!==i&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const o=this._3d=!r&&(9===i||12===i)||e&&e[0]&&void 0!==e[0].z,s=this.points=[];for(let e=0,n=o?3:2;e<i;e+=n){var a={x:t[e],y:t[e+1]};o&&(a.z=t[e+2]),s.push(a)}const u=this.order=s.length-1,c=this.dims=["x","y"];o&&c.push("z"),this.dimlen=c.length;const l=$.align(s,{p1:s[0],p2:s[u]}),h=$.dist(s[0],s[u]);this._linear=l.reduce(((e,t)=>e+K(t.y)),0)<h/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(e,t,n,r){if(void 0===r&&(r=.5),0===r)return new oe(t,t,n);if(1===r)return new oe(e,t,t);const i=oe.getABC(2,e,t,n,r);return new oe(e,i.A,n)}static cubicFromPoints(e,t,n,r,i){void 0===r&&(r=.5);const o=oe.getABC(3,e,t,n,r);void 0===i&&(i=$.dist(t,o.C));const s=i*(1-r)/r,a=$.dist(e,n),u=(n.x-e.x)/a,c=(n.y-e.y)/a,l=i*u,h=i*c,d=s*u,f=s*c,p=t.x-l,m=t.y-h,g=t.x+d,v=t.y+f,y=o.A,b=y.x+(p-y.x)/(1-r),_=y.y+(m-y.y)/(1-r),x=y.x+(g-y.x)/r,w=y.y+(v-y.y)/r,S={x:e.x+(b-e.x)/r,y:e.y+(_-e.y)/r},E={x:n.x+(x-n.x)/(1-r),y:n.y+(w-n.y)/(1-r)};return new oe(e,S,E,n)}static getUtils(){return $}getUtils(){return oe.getUtils()}static get PolyBezier(){return Y}valueOf(){return this.toString()}toString(){return $.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const e=this.points,t=["M",e[0].x,e[0].y,2===this.order?"Q":"C"];for(let n=1,r=e.length;n<r;n++)t.push(e[n].x),t.push(e[n].y);return t.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){const e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map((function(e,t){return""+t+e.x+e.y+(e.z?e.z:0)})).join("")}update(){this._lut=[],this.dpoints=$.derive(this.points,this._3d),this.computedirection()}computedirection(){const e=this.points,t=$.angle(e[0],e[this.order],e[1]);this.clockwise=t>0}length(){return $.length(this.derivative.bind(this))}static getABC(e=2,t,n,r,i=.5){const o=$.projectionratio(i,e),s=1-o,a={x:o*t.x+s*r.x,y:o*t.y+s*r.y},u=$.abcratio(i,e);return{A:{x:n.x+(n.x-a.x)/u,y:n.y+(n.y-a.y)/u},B:n,C:a,S:t,E:r}}getABC(e,t){t=t||this.get(e);let n=this.points[0],r=this.points[this.order];return oe.getABC(this.order,n,t,r,e)}getLUT(e){if(this.verify(),e=e||100,this._lut.length===e+1)return this._lut;this._lut=[],e++,this._lut=[];for(let t,n,r=0;r<e;r++)n=r/(e-1),t=this.compute(n),t.t=n,this._lut.push(t);return this._lut}on(e,n){n=n||5;const r=this.getLUT(),i=[];for(let t,o=0,s=0;o<r.length;o++)t=r[o],$.dist(t,e)<n&&(i.push(t),s+=o/r.length);return!!i.length&&(t/=i.length)}project(e){const t=this.getLUT(),n=t.length-1,r=$.closest(t,e),i=r.mpos,o=(i-1)/n,s=(i+1)/n,a=.1/n;let u,c,l=r.mdist,h=o,d=h;for(l+=1;h<s+a;h+=a)u=this.compute(h),c=$.dist(e,u),c<l&&(l=c,d=h);return d=d<0?0:d>1?1:d,u=this.compute(d),u.t=d,u.d=l,u}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?$.computeWithRatios(e,this.points,this.ratios,this._3d):$.compute(e,this.points,this._3d,this.ratios)}raise(){const e=this.points,t=[e[0]],n=e.length;for(let r,i,o=1;o<n;o++)r=e[o],i=e[o-1],t[o]={x:(n-o)/n*r.x+o/n*i.x,y:(n-o)/n*r.y+o/n*i.y};return t[n]=e[n-1],new oe(t)}derivative(e){return $.compute(e,this.dpoints[0],this._3d)}dderivative(e){return $.compute(e,this.dpoints[1],this._3d)}align(){let e=this.points;return new oe($.align(e,{p1:e[0],p2:e[e.length-1]}))}curvature(e){return $.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return $.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){const t=this.derivative(e),n=re(t.x*t.x+t.y*t.y);return{t:e,x:-t.y/n,y:t.x/n}}__normal3(e){const t=this.derivative(e),n=this.derivative(e+.01),r=re(t.x*t.x+t.y*t.y+t.z*t.z),i=re(n.x*n.x+n.y*n.y+n.z*n.z);t.x/=r,t.y/=r,t.z/=r,n.x/=i,n.y/=i,n.z/=i;const o={x:n.y*t.z-n.z*t.y,y:n.z*t.x-n.x*t.z,z:n.x*t.y-n.y*t.x},s=re(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=s,o.y/=s,o.z/=s;const a=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{t:e,x:a[0]*t.x+a[1]*t.y+a[2]*t.z,y:a[3]*t.x+a[4]*t.y+a[5]*t.z,z:a[6]*t.x+a[7]*t.y+a[8]*t.z}}hull(e){let t=this.points,n=[],r=[],i=0;for(r[i++]=t[0],r[i++]=t[1],r[i++]=t[2],3===this.order&&(r[i++]=t[3]);t.length>1;){n=[];for(let o,s=0,a=t.length-1;s<a;s++)o=$.lerp(e,t[s],t[s+1]),r[i++]=o,n.push(o);t=n}return r}split(e,t){if(0===e&&t)return this.split(t).left;if(1===t)return this.split(e).right;const n=this.hull(e),r={left:2===this.order?new oe([n[0],n[3],n[5]]):new oe([n[0],n[4],n[7],n[9]]),right:2===this.order?new oe([n[5],n[4],n[2]]):new oe([n[9],n[8],n[6],n[3]]),span:n};return r.left._t1=$.map(0,0,1,this._t1,this._t2),r.left._t2=$.map(e,0,1,this._t1,this._t2),r.right._t1=$.map(e,0,1,this._t1,this._t2),r.right._t2=$.map(1,0,1,this._t1,this._t2),t?(t=$.map(t,e,1,0,1),r.right.split(t).left):r}extrema(){const e={};let t=[];return this.dims.forEach(function(n){let r=function(e){return e[n]},i=this.dpoints[0].map(r);e[n]=$.droots(i),3===this.order&&(i=this.dpoints[1].map(r),e[n]=e[n].concat($.droots(i))),e[n]=e[n].filter((function(e){return e>=0&&e<=1})),t=t.concat(e[n].sort($.numberSort))}.bind(this)),e.values=t.sort($.numberSort).filter((function(e,n){return t.indexOf(e)===n})),e}bbox(){const e=this.extrema(),t={};return this.dims.forEach(function(n){t[n]=$.getminmax(this,n,e[n])}.bind(this)),t}overlaps(e){const t=this.bbox(),n=e.bbox();return $.bboxoverlap(t,n)}offset(e,t){if(void 0!==t){const n=this.get(e),r=this.normal(e),i={c:n,n:r,x:n.x+r.x*t,y:n.y+r.y*t};return this._3d&&(i.z=n.z+r.z*t),i}if(this._linear){const t=this.normal(0),n=this.points.map((function(n){const r={x:n.x+e*t.x,y:n.y+e*t.y};return n.z&&t.z&&(r.z=n.z+e*t.z),r}));return[new oe(n)]}return this.reduce().map((function(t){return t._linear?t.offset(e)[0]:t.scale(e)}))}simple(){if(3===this.order){const e=$.angle(this.points[0],this.points[3],this.points[1]),t=$.angle(this.points[0],this.points[3],this.points[2]);if(e>0&&t<0||e<0&&t>0)return!1}const e=this.normal(0),t=this.normal(1);let n=e.x*t.x+e.y*t.y;return this._3d&&(n+=e.z*t.z),K(ne(n))<ie/3}reduce(){let e,t,n=0,r=0,i=.01,o=[],s=[],a=this.extrema().values;for(-1===a.indexOf(0)&&(a=[0].concat(a)),-1===a.indexOf(1)&&a.push(1),n=a[0],e=1;e<a.length;e++)r=a[e],t=this.split(n,r),t._t1=n,t._t2=r,o.push(t),n=r;return o.forEach((function(e){for(n=0,r=0;r<=1;)for(r=n+i;r<=1.01;r+=i)if(t=e.split(n,r),!t.simple()){if(r-=i,K(n-r)<i)return[];t=e.split(n,r),t._t1=$.map(n,0,1,e._t1,e._t2),t._t2=$.map(r,0,1,e._t1,e._t2),s.push(t),n=r;break}n<1&&(t=e.split(n,1),t._t1=$.map(n,0,1,e._t1,e._t2),t._t2=e._t2,s.push(t))})),s}translate(e,t,n){n="number"==typeof n?n:t;const r=this.order;let i=this.points.map(((e,i)=>(1-i/r)*t+i/r*n));return new oe(this.points.map(((t,n)=>({x:t.x+e.x*i[n],y:t.y+e.y*i[n]}))))}scale(e){const t=this.order;let n=!1;if("function"==typeof e&&(n=e),n&&2===t)return this.raise().scale(n);const r=this.clockwise,i=this.points;if(this._linear)return this.translate(this.normal(0),n?n(0):e,n?n(1):e);const o=n?n(0):e,s=n?n(1):e,a=[this.offset(0,10),this.offset(1,10)],u=[],c=$.lli4(a[0],a[0].c,a[1],a[1].c);if(!c)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach((function(e){const n=u[e*t]=$.copy(i[e*t]);n.x+=(e?s:o)*a[e].n.x,n.y+=(e?s:o)*a[e].n.y})),n?([0,1].forEach((function(o){if(2!==t||!o){var s=i[o+1],a={x:s.x-c.x,y:s.y-c.y},l=n?n((o+1)/t):e;n&&!r&&(l=-l);var h=re(a.x*a.x+a.y*a.y);a.x/=h,a.y/=h,u[o+1]={x:s.x+l*a.x,y:s.y+l*a.y}}})),new oe(u)):([0,1].forEach((e=>{if(2===t&&e)return;const n=u[e*t],r=this.derivative(e),o={x:n.x+r.x,y:n.y+r.y};u[e+1]=$.lli4(n,o,c,i[e+1])})),new oe(u))}outline(e,t,n,r){if(t=void 0===t?e:t,this._linear){const i=this.normal(0),o=this.points[0],s=this.points[this.points.length-1];let a,u,c;void 0===n&&(n=e,r=t),a={x:o.x+i.x*e,y:o.y+i.y*e},c={x:s.x+i.x*n,y:s.y+i.y*n},u={x:(a.x+c.x)/2,y:(a.y+c.y)/2};const l=[a,u,c];a={x:o.x-i.x*t,y:o.y-i.y*t},c={x:s.x-i.x*r,y:s.y-i.y*r},u={x:(a.x+c.x)/2,y:(a.y+c.y)/2};const h=[c,u,a],d=$.makeline(h[2],l[0]),f=$.makeline(l[2],h[0]),p=[d,new oe(l),f,new oe(h)];return new Y(p)}const i=this.reduce(),o=i.length,s=[];let a,u=[],c=0,l=this.length();const h=void 0!==n&&void 0!==r;function d(e,t,n,r,i){return function(o){const s=r/n,a=(r+i)/n,u=t-e;return $.map(o,0,1,e+s*u,e+a*u)}}i.forEach((function(i){const o=i.length();h?(s.push(i.scale(d(e,n,l,c,o))),u.push(i.scale(d(-t,-r,l,c,o)))):(s.push(i.scale(e)),u.push(i.scale(-t))),c+=o})),u=u.map((function(e){return a=e.points,a[3]?e.points=[a[3],a[2],a[1],a[0]]:e.points=[a[2],a[1],a[0]],e})).reverse();const f=s[0].points[0],p=s[o-1].points[s[o-1].points.length-1],m=u[o-1].points[u[o-1].points.length-1],g=u[0].points[0],v=$.makeline(m,f),y=$.makeline(p,g),b=[v].concat(s).concat([y]).concat(u);return new Y(b)}outlineshapes(e,t,n){t=t||e;const r=this.outline(e,t).curves,i=[];for(let e=1,t=r.length;e<t/2;e++){const o=$.makeshape(r[e],r[t-e],n);o.startcap.virtual=e>1,o.endcap.virtual=e<t/2-1,i.push(o)}return i}intersects(e,t){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof oe&&(e=e.reduce()),this.curveintersects(this.reduce(),e,t)):this.selfintersects(t)}lineIntersects(e){const t=Q(e.p1.x,e.p2.x),n=Q(e.p1.y,e.p2.y),r=J(e.p1.x,e.p2.x),i=J(e.p1.y,e.p2.y);return $.roots(this.points,e).filter((e=>{var o=this.get(e);return $.between(o.x,t,r)&&$.between(o.y,n,i)}))}selfintersects(e){const t=this.reduce(),n=t.length-2,r=[];for(let i,o,s,a=0;a<n;a++)o=t.slice(a,a+1),s=t.slice(a+2),i=this.curveintersects(o,s,e),r.push(...i);return r}curveintersects(e,t,n){const r=[];e.forEach((function(e){t.forEach((function(t){e.overlaps(t)&&r.push({left:e,right:t})}))}));let i=[];return r.forEach((function(e){const t=$.pairiteration(e.left,e.right,n);t.length>0&&(i=i.concat(t))})),i}arcs(e){return e=e||.5,this._iterate(e,[])}_error(e,t,n,r){const i=(r-n)/4,o=this.get(n+i),s=this.get(r-i),a=$.dist(e,t),u=$.dist(e,o),c=$.dist(e,s);return K(u-a)+K(c-a)}_iterate(e,t){let n,r=0,i=1;do{n=0,i=1;let o,s,a,u,c,l=this.get(r),h=!1,d=!1,f=i,p=1,m=0;do{if(d=h,u=a,f=(r+i)/2,m++,o=this.get(f),s=this.get(i),a=$.getccenter(l,o,s),a.interval={start:r,end:i},h=this._error(a,l,r,i)<=e,c=d&&!h,c||(p=i),h){if(i>=1){if(a.interval.end=p=1,u=a,i>1){let e={x:a.x+a.r*ee(a.e),y:a.y+a.r*te(a.e)};a.e+=$.angle({x:a.x,y:a.y},e,this.get(1))}break}i+=(i-r)/2}else i=f}while(!c&&n++<100);if(n>=100)break;u=u||a,t.push(u),r=p}while(i<1);return t}}var se=r(37996),ae=r(9771),ue=r(22059);function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function le(e,t,n){if(de())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var i=new(e.bind.apply(e,r));return i}function he(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function de(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(de=function(){return!!e})()}function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){he(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function me(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,s,a=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t);else for(;!(u=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(e,t)||ye(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(e){return function(e){if(Array.isArray(e))return ce(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ye(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ve(e){return ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ve(e)}function ye(e,t){if(e){if("string"==typeof e)return ce(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ce(e,t):void 0}}!function(e,t){void 0===t&&(t={});var n=t.insertAt;if("undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css","top"===n&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}(".force-graph-container canvas {\n  display: block;\n  user-select: none;\n  outline: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.force-graph-container .graph-tooltip {\n  position: absolute;\n  top: 0;\n  font-family: sans-serif;\n  font-size: 16px;\n  padding: 4px;\n  border-radius: 3px;\n  color: #eee;\n  background: rgba(0,0,0,0.65);\n  visibility: hidden; /* by default */\n}\n\n.force-graph-container .clickable {\n  cursor: pointer;\n}\n\n.force-graph-container .grabbable {\n  cursor: move;\n  cursor: grab;\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n}\n\n.force-graph-container .grabbable:active {\n  cursor: grabbing;\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n}\n");var be=(0,ae.Z)(ue.Z);function _e(e,t,n){t&&"string"==typeof n&&e.filter((function(e){return!e[n]})).forEach((function(e){e[n]=be(t(e))}))}var xe=function(e,t){return t.onNeedsRedraw&&t.onNeedsRedraw()},we=function(e,t){if(!t.isShadow){var n=(0,p.Z)(t.linkDirectionalParticles);t.graphData.links.forEach((function(e){var t=Math.round(Math.abs(n(e)));t?e.__photons=ge(Array(t)).map((function(){return{}})):delete e.__photons}))}},Se=(0,f.Z)({props:{graphData:{default:{nodes:[],links:[]},onChange:function(e,t){t.engineRunning=!1,we(0,t)}},dagMode:{onChange:function(e,t){!e&&(t.graphData.nodes||[]).forEach((function(e){return e.fx=e.fy=void 0}))}},dagLevelDistance:{},dagNodeFilter:{default:function(e){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4,triggerUpdate:!1,onChange:xe},nodeId:{default:"id"},nodeVal:{default:"val",triggerUpdate:!1,onChange:xe},nodeColor:{default:"color",triggerUpdate:!1,onChange:xe},nodeAutoColorBy:{},nodeCanvasObject:{triggerUpdate:!1,onChange:xe},nodeCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:xe},nodeVisibility:{default:!0,triggerUpdate:!1,onChange:xe},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0,triggerUpdate:!1,onChange:xe},linkColor:{default:"color",triggerUpdate:!1,onChange:xe},linkAutoColorBy:{},linkLineDash:{triggerUpdate:!1,onChange:xe},linkWidth:{default:1,triggerUpdate:!1,onChange:xe},linkCurvature:{default:0,triggerUpdate:!1,onChange:xe},linkCanvasObject:{triggerUpdate:!1,onChange:xe},linkCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:xe},linkDirectionalArrowLength:{default:0,triggerUpdate:!1,onChange:xe},linkDirectionalArrowColor:{triggerUpdate:!1,onChange:xe},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1,onChange:xe},linkDirectionalParticles:{default:0,triggerUpdate:!1,onChange:we},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:4,triggerUpdate:!1},linkDirectionalParticleColor:{triggerUpdate:!1},globalScale:{default:1,triggerUpdate:!1},d3AlphaMin:{default:0,triggerUpdate:!1},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(e,t){t.forceLayout.alphaDecay(e)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(e,t){t.forceLayout.alphaTarget(e)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(e,t){t.forceLayout.velocityDecay(e)}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1},onNeedsRedraw:{triggerUpdate:!1},isShadow:{default:!1,triggerUpdate:!1}},methods:{d3Force:function(e,t,n){return void 0===n?e.forceLayout.force(t):(e.forceLayout.force(t,n),this)},d3ReheatSimulation:function(e){return e.forceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(e){return e.cntTicks=0,e.startTickTime=new Date,e.engineRunning=!0,this},isEngineRunning:function(e){return!!e.engineRunning},tickFrame:function(e){var t,n,r,i,o,s;return!e.isShadow&&e.engineRunning&&(++e.cntTicks>e.cooldownTicks||new Date-e.startTickTime>e.cooldownTime||e.d3AlphaMin>0&&e.forceLayout.alpha()<e.d3AlphaMin?(e.engineRunning=!1,e.onEngineStop()):(e.forceLayout.tick(),e.onEngineTick())),function(){var t=(0,p.Z)(e.linkVisibility),n=(0,p.Z)(e.linkColor),r=(0,p.Z)(e.linkWidth),i=(0,p.Z)(e.linkLineDash),o=(0,p.Z)(e.linkCurvature),s=(0,p.Z)(e.linkCanvasObjectMode),a=e.ctx,u=2*e.isShadow,c=e.graphData.links.filter(t);c.forEach((function(e){var t=o(e);if(!t)return void(e.__controlPoints=null);var n=e.source,r=e.target;if(!(n&&r&&n.hasOwnProperty("x")&&r.hasOwnProperty("x")))return;var i=Math.sqrt(Math.pow(r.x-n.x,2)+Math.pow(r.y-n.y,2));if(i>0){var s=Math.atan2(r.y-n.y,r.x-n.x),a=i*t,u={x:(n.x+r.x)/2+a*Math.cos(s-Math.PI/2),y:(n.y+r.y)/2+a*Math.sin(s-Math.PI/2)};e.__controlPoints=[u.x,u.y]}else{var c=70*t;e.__controlPoints=[r.x,r.y-c,r.x+c,r.y]}}));var l=[],h=[],d=c;if(e.linkCanvasObject){var f=[],m=[];c.forEach((function(e){return({before:l,after:h,replace:f}[s(e)]||m).push(e)})),d=[].concat(ge(l),h,m),l=l.concat(f)}a.save(),l.forEach((function(t){return e.linkCanvasObject(t,a,e.globalScale)})),a.restore();var g=(0,se.Z)(d,[n,r,i]);a.save(),Object.entries(g).forEach((function(t){var n=me(t,2),r=n[0],o=n[1],s=r&&"undefined"!==r?r:"rgba(0,0,0,0.15)";Object.entries(o).forEach((function(t){var n=me(t,2),r=n[0],o=n[1],c=(r||1)/e.globalScale+u;Object.entries(o).forEach((function(e){var t=me(e,2);t[0];var n=t[1],r=i(n[0]);a.beginPath(),n.forEach((function(e){var t=e.source,n=e.target;if(t&&n&&t.hasOwnProperty("x")&&n.hasOwnProperty("x")){a.moveTo(t.x,t.y);var r=e.__controlPoints;r?a[2===r.length?"quadraticCurveTo":"bezierCurveTo"].apply(a,ge(r).concat([n.x,n.y])):a.lineTo(n.x,n.y)}})),a.strokeStyle=s,a.lineWidth=c,a.setLineDash(r||[]),a.stroke()}))}))})),a.restore(),a.save(),h.forEach((function(t){return e.linkCanvasObject(t,a,e.globalScale)})),a.restore()}(),!e.isShadow&&(t=(0,p.Z)(e.linkDirectionalArrowLength),n=(0,p.Z)(e.linkDirectionalArrowRelPos),r=(0,p.Z)(e.linkVisibility),i=(0,p.Z)(e.linkDirectionalArrowColor||e.linkColor),o=(0,p.Z)(e.nodeVal),(s=e.ctx).save(),e.graphData.links.filter(r).forEach((function(r){var a=t(r);if(a&&!(a<0)){var u=r.source,c=r.target;if(u&&c&&u.hasOwnProperty("x")&&c.hasOwnProperty("x")){var l=Math.sqrt(Math.max(0,o(u)||1))*e.nodeRelSize,h=Math.sqrt(Math.max(0,o(c)||1))*e.nodeRelSize,d=Math.min(1,Math.max(0,n(r))),f=i(r)||"rgba(0,0,0,0.28)",p=a/1.6/2,m=r.__controlPoints&&le(oe,[u.x,u.y].concat(ge(r.__controlPoints),[c.x,c.y])),g=m?function(e){return m.get(e)}:function(e){return{x:u.x+(c.x-u.x)*e||0,y:u.y+(c.y-u.y)*e||0}},v=m?m.length():Math.sqrt(Math.pow(c.x-u.x,2)+Math.pow(c.y-u.y,2)),y=l+a+(v-l-h-a)*d,b=g(y/v),_=g((y-a)/v),x=g((y-.8*a)/v),w=Math.atan2(b.y-_.y,b.x-_.x)-Math.PI/2;s.beginPath(),s.moveTo(b.x,b.y),s.lineTo(_.x+p*Math.cos(w),_.y+p*Math.sin(w)),s.lineTo(x.x,x.y),s.lineTo(_.x-p*Math.cos(w),_.y-p*Math.sin(w)),s.fillStyle=f,s.fill()}}})),s.restore()),!e.isShadow&&function(){var t=(0,p.Z)(e.linkDirectionalParticles),n=(0,p.Z)(e.linkDirectionalParticleSpeed),r=(0,p.Z)(e.linkDirectionalParticleWidth),i=(0,p.Z)(e.linkVisibility),o=(0,p.Z)(e.linkDirectionalParticleColor||e.linkColor),s=e.ctx;s.save(),e.graphData.links.filter(i).forEach((function(i){var a=t(i);if(i.hasOwnProperty("__photons")&&i.__photons.length){var u=i.source,c=i.target;if(u&&c&&u.hasOwnProperty("x")&&c.hasOwnProperty("x")){var l=n(i),h=i.__photons||[],d=Math.max(0,r(i)/2)/Math.sqrt(e.globalScale),f=o(i)||"rgba(0,0,0,0.28)";s.fillStyle=f;var p=i.__controlPoints?le(oe,[u.x,u.y].concat(ge(i.__controlPoints),[c.x,c.y])):null,m=0,g=!1;h.forEach((function(e){var t=!!e.__singleHop;if(e.hasOwnProperty("__progressRatio")||(e.__progressRatio=t?0:m/a),!t&&m++,e.__progressRatio+=l,e.__progressRatio>=1){if(t)return void(g=!0);e.__progressRatio=e.__progressRatio%1}var n=e.__progressRatio,r=p?p.get(n):{x:u.x+(c.x-u.x)*n||0,y:u.y+(c.y-u.y)*n||0};s.beginPath(),s.arc(r.x,r.y,d,0,2*Math.PI,!1),s.fill()})),g&&(i.__photons=i.__photons.filter((function(e){return!e.__singleHop||e.__progressRatio<=1})))}}})),s.restore()}(),function(){var t=(0,p.Z)(e.nodeVisibility),n=(0,p.Z)(e.nodeVal),r=(0,p.Z)(e.nodeColor),i=(0,p.Z)(e.nodeCanvasObjectMode),o=e.ctx,s=e.isShadow/e.globalScale,a=e.graphData.nodes.filter(t);o.save(),a.forEach((function(t){var a=i(t);if(!e.nodeCanvasObject||"before"!==a&&"replace"!==a||(e.nodeCanvasObject(t,o,e.globalScale),"replace"!==a)){var u=Math.sqrt(Math.max(0,n(t)||1))*e.nodeRelSize+s;o.beginPath(),o.arc(t.x,t.y,u,0,2*Math.PI,!1),o.fillStyle=r(t)||"rgba(31, 120, 180, 0.92)",o.fill(),e.nodeCanvasObject&&"after"===a&&e.nodeCanvasObject(t,e.ctx,e.globalScale)}else o.restore()})),o.restore()}(),this},emitParticle:function(e,t){return t&&(!t.__photons&&(t.__photons=[]),t.__photons.push({__singleHop:!0})),this}},stateInit:function(){return{forceLayout:(0,P.Z)().force("link",(0,R.Z)()).force("charge",(0,N.Z)()).force("center",(0,I.Z)()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(e,t){t.ctx=e},update:function(e,t){e.engineRunning=!1,e.onUpdate(),null!==e.nodeAutoColorBy&&_e(e.graphData.nodes,(0,p.Z)(e.nodeAutoColorBy),e.nodeColor),null!==e.linkAutoColorBy&&_e(e.graphData.links,(0,p.Z)(e.linkAutoColorBy),e.linkColor),e.graphData.links.forEach((function(t){t.source=t[e.linkSource],t.target=t[e.linkTarget]})),e.forceLayout.stop().alpha(1).nodes(e.graphData.nodes);var n=e.forceLayout.force("link");n&&n.id((function(t){return t[e.nodeId]})).links(e.graphData.links);var r=e.dagMode&&function(e,t){var n=e.nodes,r=e.links,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=i.nodeFilter,s=void 0===o?function(){return!0}:o,a=i.onLoopError,u=void 0===a?function(e){throw"Invalid DAG structure! Found cycle in node path: ".concat(e.join(" -> "),".")}:a,c={};n.forEach((function(e){return c[t(e)]={data:e,out:[],depth:-1,skip:!s(e)}})),r.forEach((function(e){var n=e.source,r=e.target,i=u(n),o=u(r);if(!c.hasOwnProperty(i))throw"Missing source node with id: ".concat(i);if(!c.hasOwnProperty(o))throw"Missing target node with id: ".concat(o);var s=c[i],a=c[o];function u(e){return"object"===ve(e)?t(e):e}s.out.push(a)}));var l=[];d(Object.values(c));var h=Object.assign.apply(Object,[{}].concat(ge(Object.entries(c).filter((function(e){return!me(e,2)[1].skip})).map((function(e){var t=me(e,2);return he({},t[0],t[1].depth)})))));return h;function d(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=function(){var i=e[o];if(-1!==n.indexOf(i)){var s=[].concat(ge(n.slice(n.indexOf(i))),[i]).map((function(e){return t(e.data)}));return l.some((function(e){return e.length===s.length&&e.every((function(e,t){return e===s[t]}))}))||(l.push(s),u(s)),1}r>i.depth&&(i.depth=r,d(i.out,[].concat(ge(n),[i]),r+(i.skip?0:1)))},o=0,s=e.length;o<s;o++)i()}}(e.graphData,(function(t){return t[e.nodeId]}),{nodeFilter:e.dagNodeFilter,onLoopError:e.onDagError||void 0}),i=Math.max.apply(Math,ge(Object.values(r||[]))),o=e.dagLevelDistance||e.graphData.nodes.length/(i||1)*2*(-1!==["radialin","radialout"].indexOf(e.dagMode)?.7:1);if(["lr","rl","td","bu"].includes(t.dagMode)){var s=["lr","rl"].includes(t.dagMode)?"fx":"fy";e.graphData.nodes.filter(e.dagNodeFilter).forEach((function(e){return delete e[s]}))}if(["lr","rl","td","bu"].includes(e.dagMode)){var a=["rl","bu"].includes(e.dagMode),u=["lr","rl"].includes(e.dagMode)?"fx":"fy";e.graphData.nodes.filter(e.dagNodeFilter).forEach((function(t){return t[u]=function(t){return(r[t[e.nodeId]]-i/2)*o*(a?-1:1)}(t)}))}e.forceLayout.force("dagRadial",-1!==["radialin","radialout"].indexOf(e.dagMode)?(0,k.Z)((function(t){var n=r[t[e.nodeId]]||-1;return("radialin"===e.dagMode?i-n:n)*o})).strength((function(t){return e.dagNodeFilter(t)?1:0})):null);for(var c=0;c<e.warmupTicks&&!(e.d3AlphaMin>0&&e.forceLayout.alpha()<e.d3AlphaMin);c++)e.forceLayout.tick();this.resetCountdown(),e.onFinishUpdate()}});function Ee(e,t){var n=e instanceof Array?e:[e],r=new t;return r._destructor&&r._destructor(),{linkProp:function(e){return{default:r[e](),onChange:function(t,r){n.forEach((function(n){return r[n][e](t)}))},triggerUpdate:!1}},linkMethod:function(e){return function(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var s=[];return n.forEach((function(n){var r=t[n],o=r[e].apply(r,i);o!==r&&s.push(o)})),s.length?s[0]:this}}}}var Te=Ee("forceGraph",Se),Me=Ee(["forceGraph","shadowGraph"],Se),Ae=Object.assign.apply(Object,ge(["nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","dagMode","dagLevelDistance","dagNodeFilter","onDagError","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map((function(e){return he({},e,Te.linkProp(e))}))).concat(ge(["nodeRelSize","nodeId","nodeVal","nodeVisibility","linkSource","linkTarget","linkVisibility","linkCurvature"].map((function(e){return he({},e,Me.linkProp(e))}))))),Ce=Object.assign.apply(Object,ge(["d3Force","d3ReheatSimulation","emitParticle"].map((function(e){return he({},e,Te.linkMethod(e))}))));function Oe(e){if(e.canvas){var t=e.canvas.width,n=e.canvas.height;300===t&&150===n&&(t=n=0);var r=window.devicePixelRatio;t/=r,n/=r,[e.canvas,e.shadowCanvas].forEach((function(i){i.style.width="".concat(e.width,"px"),i.style.height="".concat(e.height,"px"),i.width=e.width*r,i.height=e.height*r,t||n||i.getContext("2d").scale(r,r)}));var i=(0,o.P2)(e.canvas).k;e.zoom.translateBy(e.zoom.__baseElem,(e.width-t)/2/i,(e.height-n)/2/i),e.needsRedraw=!0}}function Pe(e){var t=window.devicePixelRatio;e.setTransform(t,0,0,t,0,0)}function Re(e,t,n){e.save(),Pe(e),e.clearRect(0,0,t,n),e.restore()}var Ne=(0,f.Z)({props:pe({width:{default:window.innerWidth,onChange:function(e,t){return Oe(t)},triggerUpdate:!1},height:{default:window.innerHeight,onChange:function(e,t){return Oe(t)},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(e,t){[e.nodes,e.links].every((function(e){return(e||[]).every((function(e){return!e.hasOwnProperty("__indexColor")}))}))&&t.colorTracker.reset(),[{type:"Node",objs:e.nodes},{type:"Link",objs:e.links}].forEach((function(e){var n=e.type;e.objs.filter((function(e){if(!e.hasOwnProperty("__indexColor"))return!0;var n=t.colorTracker.lookup(e.__indexColor);return!n||!n.hasOwnProperty("d")||n.d!==e})).forEach((function(e){e.__indexColor=t.colorTracker.register({type:n,d:e})}))})),t.forceGraph.graphData(e),t.shadowGraph.graphData(e)},triggerUpdate:!1},backgroundColor:{onChange:function(e,t){t.canvas&&e&&(t.canvas.style.background=e)},triggerUpdate:!1},nodeLabel:{default:"name",triggerUpdate:!1},nodePointerAreaPaint:{onChange:function(e,t){t.shadowGraph.nodeCanvasObject(e?function(t,n,r){return e(t,t.__indexColor,n,r)}:null),t.flushShadowCanvas&&t.flushShadowCanvas()},triggerUpdate:!1},linkPointerAreaPaint:{onChange:function(e,t){t.shadowGraph.linkCanvasObject(e?function(t,n,r){return e(t,t.__indexColor,n,r)}:null),t.flushShadowCanvas&&t.flushShadowCanvas()},triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:4,triggerUpdate:!1},minZoom:{default:.01,onChange:function(e,t){t.zoom.scaleExtent([e,t.zoom.scaleExtent()[1]])},triggerUpdate:!1},maxZoom:{default:1e3,onChange:function(e,t){t.zoom.scaleExtent([t.zoom.scaleExtent()[0],e])},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},enableZoomInteraction:{default:!0,triggerUpdate:!1},enablePanInteraction:{default:!0,triggerUpdate:!1},enableZoomPanInteraction:{default:!0,triggerUpdate:!1},enablePointerInteraction:{default:!0,onChange:function(e,t){t.hoverObj=null},triggerUpdate:!1},autoPauseRedraw:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},onZoom:{triggerUpdate:!1},onZoomEnd:{triggerUpdate:!1},onRenderFramePre:{triggerUpdate:!1},onRenderFramePost:{triggerUpdate:!1}},Ae),aliases:{stopAnimation:"pauseAnimation"},methods:pe({graph2ScreenCoords:function(e,t,n){var r=(0,o.P2)(e.canvas);return{x:t*r.k+r.x,y:n*r.k+r.y}},screen2GraphCoords:function(e,t,n){var r=(0,o.P2)(e.canvas);return{x:(t-r.x)/r.k,y:(n-r.y)/r.k}},centerAt:function(e,t,n,r){if(!e.canvas)return null;if(void 0!==t||void 0!==n){var i=Object.assign({},void 0!==t?{x:t}:{},void 0!==n?{y:n}:{});return r?e.tweenGroup.add(new d.kX(s()).to(i,r).easing(d.oY.Quadratic.Out).onUpdate(a).start()):a(i),this}return s();function s(){var t=(0,o.P2)(e.canvas);return{x:(e.width/2-t.x)/t.k,y:(e.height/2-t.y)/t.k}}function a(t){var n=t.x,r=t.y;e.zoom.translateTo(e.zoom.__baseElem,void 0===n?s().x:n,void 0===r?s().y:r),e.needsRedraw=!0}},zoom:function(e,t,n){return e.canvas?void 0!==t?(n?e.tweenGroup.add(new d.kX({k:r()}).to({k:t},n).easing(d.oY.Quadratic.Out).onUpdate((function(e){return i(e.k)})).start()):i(t),this):r():null;function r(){return(0,o.P2)(e.canvas).k}function i(t){e.zoom.scaleTo(e.zoom.__baseElem,t),e.needsRedraw=!0}},zoomToFit:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=arguments.length,i=new Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];var s=this.getGraphBbox.apply(this,i);if(s){var a={x:(s.x[0]+s.x[1])/2,y:(s.y[0]+s.y[1])/2},u=Math.max(1e-12,Math.min(1e12,(e.width-2*n)/(s.x[1]-s.x[0]),(e.height-2*n)/(s.y[1]-s.y[0])));this.centerAt(a.x,a.y,t),this.zoom(u,t)}return this},getGraphBbox:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=(0,p.Z)(e.nodeVal),r=function(t){return Math.sqrt(Math.max(0,n(t)||1))*e.nodeRelSize},i=e.graphData.nodes.filter(t).map((function(e){return{x:e.x,y:e.y,r:r(e)}}));return i.length?{x:[(0,a.Z)(i,(function(e){return e.x-e.r})),(0,u.Z)(i,(function(e){return e.x+e.r}))],y:[(0,a.Z)(i,(function(e){return e.y-e.r})),(0,u.Z)(i,(function(e){return e.y+e.r}))]}:null},pauseAnimation:function(e){return e.animationFrameRequestId&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),this},resumeAnimation:function(e){return e.animationFrameRequestId||this._animationCycle(),this},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},Ce),stateInit:function(){return{lastSetZoom:1,zoom:(0,o.sP)(),forceGraph:new Se,shadowGraph:(new Se).cooldownTicks(0).nodeColor("__indexColor").linkColor("__indexColor").isShadow(!0),colorTracker:new O,tweenGroup:new d.ZA}},init:function(e,t){var n=this;e.innerHTML="";var r=document.createElement("div");r.classList.add("force-graph-container"),r.style.position="relative",e.appendChild(r),t.canvas=document.createElement("canvas"),t.backgroundColor&&(t.canvas.style.background=t.backgroundColor),r.appendChild(t.canvas),t.shadowCanvas=document.createElement("canvas");var a=t.canvas.getContext("2d"),u=t.shadowCanvas.getContext("2d",{willReadFrequently:!0}),c={x:-1e12,y:-1e12},l=function(){var e=null,n=window.devicePixelRatio,r=c.x>0&&c.y>0?u.getImageData(c.x*n,c.y*n,1,1):null;return r&&(e=t.colorTracker.lookup(r.data)),e};(0,i.Z)(t.canvas).call((0,s.Z)().subject((function(){if(!t.enableNodeDrag)return null;var e=l();return e&&"Node"===e.type?e.d:null})).on("start",(function(e){var n=e.subject;n.__initialDragPos={x:n.x,y:n.y,fx:n.fx,fy:n.fy},e.active||(n.fx=n.x,n.fy=n.y),t.canvas.classList.add("grabbable")})).on("drag",(function(e){var n=e.subject,r=n.__initialDragPos,i=e,s=(0,o.P2)(t.canvas).k,a={x:r.x+(i.x-r.x)/s-n.x,y:r.y+(i.y-r.y)/s-n.y};["x","y"].forEach((function(e){return n["f".concat(e)]=n[e]=r[e]+(i[e]-r[e])/s})),t.forceGraph.d3AlphaTarget(.3).resetCountdown(),t.isPointerDragging=!0,n.__dragged=!0,t.onNodeDrag(n,a)})).on("end",(function(e){var n=e.subject,r=n.__initialDragPos,i={x:n.x-r.x,y:n.y-r.y};void 0===r.fx&&(n.fx=void 0),void 0===r.fy&&(n.fy=void 0),delete n.__initialDragPos,t.forceGraph.d3AlphaTarget()&&t.forceGraph.d3AlphaTarget(0).resetCountdown(),t.canvas.classList.remove("grabbable"),t.isPointerDragging=!1,n.__dragged&&(delete n.__dragged,t.onNodeDragEnd(n,i))}))),t.zoom(t.zoom.__baseElem=(0,i.Z)(t.canvas)),t.zoom.__baseElem.on("dblclick.zoom",null),t.zoom.filter((function(e){return!e.button&&t.enableZoomPanInteraction&&("wheel"!==e.type||(0,p.Z)(t.enableZoomInteraction)(e))&&("wheel"===e.type||(0,p.Z)(t.enablePanInteraction)(e))})).on("zoom",(function(e){var r=e.transform;[a,u].forEach((function(e){Pe(e),e.translate(r.x,r.y),e.scale(r.k,r.k)})),t.onZoom&&t.onZoom(pe(pe({},r),n.centerAt())),t.needsRedraw=!0})).on("end",(function(e){return t.onZoomEnd&&t.onZoomEnd(pe(pe({},e.transform),n.centerAt()))})),Oe(t),t.forceGraph.onNeedsRedraw((function(){return t.needsRedraw=!0})).onFinishUpdate((function(){(0,o.P2)(t.canvas).k===t.lastSetZoom&&t.graphData.nodes.length&&(t.zoom.scaleTo(t.zoom.__baseElem,t.lastSetZoom=4/Math.cbrt(t.graphData.nodes.length)),t.needsRedraw=!0)}));var d=document.createElement("div");d.classList.add("graph-tooltip"),r.appendChild(d),["pointermove","pointerdown"].forEach((function(e){return r.addEventListener(e,(function(n){"pointerdown"===e&&(t.isPointerPressed=!0,t.pointerDownEvent=n),!t.isPointerDragging&&"pointermove"===n.type&&t.onBackgroundClick&&(n.pressure>0||t.isPointerPressed)&&("touch"!==n.pointerType||void 0===n.movementX||[n.movementX,n.movementY].some((function(e){return Math.abs(e)>1})))&&(t.isPointerDragging=!0);var i,o,s,a=(i=r.getBoundingClientRect(),o=window.pageXOffset||document.documentElement.scrollLeft,s=window.pageYOffset||document.documentElement.scrollTop,{top:i.top+s,left:i.left+o});c.x=n.pageX-a.left,c.y=n.pageY-a.top,d.style.top="".concat(c.y,"px"),d.style.left="".concat(c.x,"px"),d.style.transform="translate(-".concat(c.x/t.width*100,"%, ").concat(t.height-c.y<100?"calc(-100% - 8px)":"21px",")")}),{passive:!0})})),r.addEventListener("pointerup",(function(e){if(t.isPointerPressed=!1,t.isPointerDragging)t.isPointerDragging=!1;else{var n=[e,t.pointerDownEvent];requestAnimationFrame((function(){if(0===e.button)if(t.hoverObj){var r=t["on".concat(t.hoverObj.type,"Click")];r&&r.apply(void 0,[t.hoverObj.d].concat(n))}else t.onBackgroundClick&&t.onBackgroundClick.apply(t,n);if(2===e.button)if(t.hoverObj){var i=t["on".concat(t.hoverObj.type,"RightClick")];i&&i.apply(void 0,[t.hoverObj.d].concat(n))}else t.onBackgroundRightClick&&t.onBackgroundRightClick.apply(t,n)}))}}),{passive:!0}),r.addEventListener("contextmenu",(function(e){return!(t.onBackgroundRightClick||t.onNodeRightClick||t.onLinkRightClick)||(e.preventDefault(),!1)})),t.forceGraph(a),t.shadowGraph(u);var f=h((function(){Re(u,t.width,t.height),t.shadowGraph.linkWidth((function(e){return(0,p.Z)(t.linkWidth)(e)+t.linkHoverPrecision}));var e=(0,o.P2)(t.canvas);t.shadowGraph.globalScale(e.k).tickFrame()}),800);t.flushShadowCanvas=f.flush,(this._animationCycle=function e(){var n=!t.autoPauseRedraw||!!t.needsRedraw||t.forceGraph.isEngineRunning()||t.graphData.links.some((function(e){return e.__photons&&e.__photons.length}));if(t.needsRedraw=!1,t.enablePointerInteraction){var r=t.isPointerDragging?null:l();if(r!==t.hoverObj){var i=t.hoverObj,s=i?i.type:null,u=r?r.type:null;if(s&&s!==u){var c=t["on".concat(s,"Hover")];c&&c(null,i.d)}if(u){var h=t["on".concat(u,"Hover")];h&&h(r.d,s===u?i.d:null)}var m=r&&(0,p.Z)(t["".concat(r.type.toLowerCase(),"Label")])(r.d)||"";d.style.visibility=m?"visible":"hidden",d.innerHTML=m,t.canvas.classList[r&&t["on".concat(u,"Click")]||!r&&t.onBackgroundClick?"add":"remove"]("clickable"),t.hoverObj=r}n&&f()}if(n){Re(a,t.width,t.height);var g=(0,o.P2)(t.canvas).k;t.onRenderFramePre&&t.onRenderFramePre(a,g),t.forceGraph.globalScale(g).tickFrame(),t.onRenderFramePost&&t.onRenderFramePost(a,g)}t.tweenGroup.update(),t.animationFrameRequestId=requestAnimationFrame(e)})()},update:function(e){}})},53874:function(e,t,n){"use strict";n.d(t,{Fl:function(){return q},Uy:function(){return W}});var r=Symbol.for("immer-nothing"),i=Symbol.for("immer-draftable"),o=Symbol.for("immer-state");function s(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var a=Object.getPrototypeOf;function u(e){return!!e&&!!e[o]}function c(e){return!!e&&(h(e)||Array.isArray(e)||!!e[i]||!!e.constructor?.[i]||g(e)||v(e))}var l=Object.prototype.constructor.toString();function h(e){if(!e||"object"!=typeof e)return!1;const t=a(e);if(null===t)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===l}function d(e,t){0===f(e)?Reflect.ownKeys(e).forEach((n=>{t(n,e[n],e)})):e.forEach(((n,r)=>t(r,n,e)))}function f(e){const t=e[o];return t?t.type_:Array.isArray(e)?1:g(e)?2:v(e)?3:0}function p(e,t){return 2===f(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function m(e,t,n){const r=f(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function g(e){return e instanceof Map}function v(e){return e instanceof Set}function y(e){return e.copy_||e.base_}function b(e,t){if(g(e))return new Map(e);if(v(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=h(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[o];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const i=n[r],o=t[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(a(e),t)}{const t=a(e);if(null!==t&&n)return{...e};const r=Object.create(t);return Object.assign(r,e)}}function _(e,t=!1){return w(e)||u(e)||!c(e)||(f(e)>1&&(e.set=e.add=e.clear=e.delete=x),Object.freeze(e),t&&Object.entries(e).forEach((([e,t])=>_(t,!0)))),e}function x(){s(2)}function w(e){return Object.isFrozen(e)}var S,E={};function T(e){const t=E[e];return t||s(0),t}function M(){return S}function A(e,t){t&&(T("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function C(e){O(e),e.drafts_.forEach(R),e.drafts_=null}function O(e){e===S&&(S=e.parent_)}function P(e){return S={drafts_:[],parent_:S,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function R(e){const t=e[o];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function N(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[o].modified_&&(C(t),s(4)),c(e)&&(e=I(t,e),t.parent_||D(t,e)),t.patches_&&T("Patches").generateReplacementPatches_(n[o].base_,e,t.patches_,t.inversePatches_)):e=I(t,n,[]),C(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==r?e:void 0}function I(e,t,n){if(w(t))return t;const r=t[o];if(!r)return d(t,((i,o)=>k(e,r,t,i,o,n))),t;if(r.scope_!==e)return t;if(!r.modified_)return D(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const t=r.copy_;let i=t,o=!1;3===r.type_&&(i=new Set(t),t.clear(),o=!0),d(i,((i,s)=>k(e,r,t,i,s,n,o))),D(e,t,!1),n&&e.patches_&&T("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function k(e,t,n,r,i,o,s){if(u(i)){const s=I(e,i,o&&t&&3!==t.type_&&!p(t.assigned_,r)?o.concat(r):void 0);if(m(n,r,s),!u(s))return;e.canAutoFreeze_=!1}else s&&n.add(i);if(c(i)&&!w(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;I(e,i),t&&t.scope_.parent_||"symbol"==typeof r||!Object.prototype.propertyIsEnumerable.call(n,r)||D(e,i)}}function D(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&_(t,n)}var L={get(e,t){if(t===o)return e;const n=y(e);if(!p(n,t))return function(e,t,n){const r=B(t,n);return r?"value"in r?r.value:r.get?.call(e.draft_):void 0}(e,n,t);const r=n[t];return e.finalized_||!c(r)?r:r===F(e.base_,t)?(j(e),e.copy_[t]=V(r,e)):r},has(e,t){return t in y(e)},ownKeys(e){return Reflect.ownKeys(y(e))},set(e,t,n){const r=B(y(e),t);if(r?.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=F(y(e),t),a=r?.[o];if(a&&a.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(((i=n)===(s=r)?0!==i||1/i==1/s:i!=i&&s!=s)&&(void 0!==n||p(e.base_,t)))return!0;j(e),z(e)}var i,s;return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return void 0!==F(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,j(e),z(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=y(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty(){s(11)},getPrototypeOf(e){return a(e.base_)},setPrototypeOf(){s(12)}},U={};function F(e,t){const n=e[o];return(n?y(n):e)[t]}function B(e,t){if(!(t in e))return;let n=a(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=a(n)}}function z(e){e.modified_||(e.modified_=!0,e.parent_&&z(e.parent_))}function j(e){e.copy_||(e.copy_=b(e.base_,e.scope_.immer_.useStrictShallowCopy_))}d(L,((e,t)=>{U[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),U.deleteProperty=function(e,t){return U.set.call(this,e,t,void 0)},U.set=function(e,t,n){return L.set.call(this,e[0],t,n,e[0])};function V(e,t){const n=g(e)?T("MapSet").proxyMap_(e,t):v(e)?T("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:M(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,o=L;n&&(i=[r],o=U);const{revoke:s,proxy:a}=Proxy.revocable(i,o);return r.draft_=a,r.revoke_=s,a}(e,t);return(t?t.scope_:M()).drafts_.push(n),n}function G(e){if(!c(e)||w(e))return e;const t=e[o];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=b(e,t.scope_.immer_.useStrictShallowCopy_)}else n=b(e,!0);return d(n,((e,t)=>{m(n,e,G(t))})),t&&(t.finalized_=!1),n}var H=new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if("function"==typeof e&&"function"!=typeof t){const n=t;t=e;const r=this;return function(e=n,...i){return r.produce(e,(e=>t.call(this,e,...i)))}}let i;if("function"!=typeof t&&s(6),void 0!==n&&"function"!=typeof n&&s(7),c(e)){const r=P(this),o=V(e,void 0);let s=!0;try{i=t(o),s=!1}finally{s?C(r):O(r)}return A(r,n),N(i,r)}if(!e||"object"!=typeof e){if(i=t(e),void 0===i&&(i=e),i===r&&(i=void 0),this.autoFreeze_&&_(i,!0),n){const t=[],r=[];T("Patches").generateReplacementPatches_(e,i,t,r),n(t,r)}return i}s(1)},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...n)=>this.produceWithPatches(t,(t=>e(t,...n)));let n,r;return[this.produce(e,t,((e,t)=>{n=e,r=t})),n,r]},"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof e?.useStrictShallowCopy&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){c(e)||s(8),u(e)&&(e=function(e){u(e)||s(10);return G(e)}(e));const t=P(this),n=V(e,void 0);return n[o].isManual_=!0,O(t),n}finishDraft(e,t){const n=e&&e[o];n&&n.isManual_||s(9);const{scope_:r}=n;return A(r,t),N(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=T("Patches").applyPatches_;return u(e)?r(e,t):this.produce(e,(e=>r(e,t)))}},W=H.produce,q=(H.produceWithPatches.bind(H),H.setAutoFreeze.bind(H));H.setUseStrictShallowCopy.bind(H),H.applyPatches.bind(H),H.createDraft.bind(H),H.finishDraft.bind(H)},37996:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,s,a=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t);else for(;!(u=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}function u(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}n.d(t,{Z:function(){return c}});var c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=(t instanceof Array?t.length?t:[void 0]:[t]).map((function(e){return{keyAccessor:e,isProp:!(e instanceof Function)}})),c=e.reduce((function(e,t){var r=e,o=t;return u.forEach((function(e,t){var s,c=e.keyAccessor;if(e.isProp){var l=o,h=l[c],d=i(l,[c].map(a));s=h,o=d}else s=c(o,t);t+1<u.length?(r.hasOwnProperty(s)||(r[s]={}),r=r[s]):n?(r.hasOwnProperty(s)||(r[s]=[]),r[s].push(o)):r[s]=o})),e}),{});n instanceof Function&&function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;r===u.length?Object.keys(t).forEach((function(e){return t[e]=n(t[e])})):Object.values(t).forEach((function(t){return e(t,r+1)}))}(c);var l=c;return r&&(l=[],function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];n.length===u.length?l.push({keys:n,vals:t}):Object.entries(t).forEach((function(t){var r=o(t,2),i=r[0],a=r[1];return e(a,[].concat(s(n),[i]))}))}(c),t instanceof Array&&0===t.length&&1===l.length&&(l[0].keys=[])),l}},14131:function(e,t,n){"use strict";n.d(t,{L:function(){return r}});class r extends Map{constructor(e,t=a){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[t,n]of e)this.set(t,n)}get(e){return super.get(i(this,e))}has(e){return super.has(i(this,e))}set(e,t){return super.set(o(this,e),t)}delete(e){return super.delete(s(this,e))}}function i({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function o({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function s({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function a(e){return null!==e&&"object"==typeof e?e.valueOf():e}},80487:function(e,t,n){"use strict";function r(e){return null==e}var i={isNothing:r,isObject:function(e){return"object"==typeof e&&null!==e},toArray:function(e){return Array.isArray(e)?e:r(e)?[]:[e]},repeat:function(e,t){var n,r="";for(n=0;n<t;n+=1)r+=e;return r},isNegativeZero:function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e},extend:function(e,t){var n,r,i,o;if(t)for(n=0,r=(o=Object.keys(t)).length;n<r;n+=1)e[i=o[n]]=t[i];return e}};function o(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+="\n\n"+e.mark.snippet),r+" "+n):r}function s(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=o(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}s.prototype=Object.create(Error.prototype),s.prototype.constructor=s,s.prototype.toString=function(e){return this.name+": "+o(this,e)};var a=s;function u(e,t,n,r,i){var o="",s="",a=Math.floor(i/2)-1;return r-t>a&&(t=r-a+(o=" ... ").length),n-r>a&&(n=r+a-(s=" ...").length),{str:o+e.slice(t,n).replace(/\t/g,"→")+s,pos:r-t+o.length}}function c(e,t){return i.repeat(" ",t-e.length)+e}var l=function(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var n,r=/\r?\n|\r|\0/g,o=[0],s=[],a=-1;n=r.exec(e.buffer);)s.push(n.index),o.push(n.index+n[0].length),e.position<=n.index&&a<0&&(a=o.length-2);a<0&&(a=o.length-1);var l,h,d="",f=Math.min(e.line+t.linesAfter,s.length).toString().length,p=t.maxLength-(t.indent+f+3);for(l=1;l<=t.linesBefore&&!(a-l<0);l++)h=u(e.buffer,o[a-l],s[a-l],e.position-(o[a]-o[a-l]),p),d=i.repeat(" ",t.indent)+c((e.line-l+1).toString(),f)+" | "+h.str+"\n"+d;for(h=u(e.buffer,o[a],s[a],e.position,p),d+=i.repeat(" ",t.indent)+c((e.line+1).toString(),f)+" | "+h.str+"\n",d+=i.repeat("-",t.indent+f+3+h.pos)+"^\n",l=1;l<=t.linesAfter&&!(a+l>=s.length);l++)h=u(e.buffer,o[a+l],s[a+l],e.position-(o[a]-o[a+l]),p),d+=i.repeat(" ",t.indent)+c((e.line+l+1).toString(),f)+" | "+h.str+"\n";return d.replace(/\n$/,"")},h=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],d=["scalar","sequence","mapping"];var f=function(e,t){if(t=t||{},Object.keys(t).forEach((function(t){if(-1===h.indexOf(t))throw new a('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')})),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=function(e){var t={};return null!==e&&Object.keys(e).forEach((function(n){e[n].forEach((function(e){t[String(e)]=n}))})),t}(t.styleAliases||null),-1===d.indexOf(this.kind))throw new a('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')};function p(e,t){var n=[];return e[t].forEach((function(e){var t=n.length;n.forEach((function(n,r){n.tag===e.tag&&n.kind===e.kind&&n.multi===e.multi&&(t=r)})),n[t]=e})),n}function m(e){return this.extend(e)}m.prototype.extend=function(e){var t=[],n=[];if(e instanceof f)n.push(e);else if(Array.isArray(e))n=n.concat(e);else{if(!e||!Array.isArray(e.implicit)&&!Array.isArray(e.explicit))throw new a("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit))}t.forEach((function(e){if(!(e instanceof f))throw new a("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new a("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new a("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")})),n.forEach((function(e){if(!(e instanceof f))throw new a("Specified list of YAML types (or a single Type object) contains a non-Type object.")}));var r=Object.create(m.prototype);return r.implicit=(this.implicit||[]).concat(t),r.explicit=(this.explicit||[]).concat(n),r.compiledImplicit=p(r,"implicit"),r.compiledExplicit=p(r,"explicit"),r.compiledTypeMap=function(){var e,t,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function r(e){e.multi?(n.multi[e.kind].push(e),n.multi.fallback.push(e)):n[e.kind][e.tag]=n.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(r);return n}(r.compiledImplicit,r.compiledExplicit),r};var g=m,v=new f("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),y=new f("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),b=new f("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}}),_=new g({explicit:[v,y,b]});var x=new f("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});var w=new f("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function S(e){return 48<=e&&e<=55}function E(e){return 48<=e&&e<=57}var T=new f("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,r=e.length,i=0,o=!1;if(!r)return!1;if("-"!==(t=e[i])&&"+"!==t||(t=e[++i]),"0"===t){if(i+1===r)return!0;if("b"===(t=e[++i])){for(i++;i<r;i++)if("_"!==(t=e[i])){if("0"!==t&&"1"!==t)return!1;o=!0}return o&&"_"!==t}if("x"===t){for(i++;i<r;i++)if("_"!==(t=e[i])){if(!(48<=(n=e.charCodeAt(i))&&n<=57||65<=n&&n<=70||97<=n&&n<=102))return!1;o=!0}return o&&"_"!==t}if("o"===t){for(i++;i<r;i++)if("_"!==(t=e[i])){if(!S(e.charCodeAt(i)))return!1;o=!0}return o&&"_"!==t}}if("_"===t)return!1;for(;i<r;i++)if("_"!==(t=e[i])){if(!E(e.charCodeAt(i)))return!1;o=!0}return!(!o||"_"===t)},construct:function(e){var t,n=e,r=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),"-"!==(t=n[0])&&"+"!==t||("-"===t&&(r=-1),t=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===t){if("b"===n[1])return r*parseInt(n.slice(2),2);if("x"===n[1])return r*parseInt(n.slice(2),16);if("o"===n[1])return r*parseInt(n.slice(2),8)}return r*parseInt(n,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!i.isNegativeZero(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),M=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");var A=/^[-+]?[0-9]+e/;var C=new f("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!(!M.test(e)||"_"===e[e.length-1])},construct:function(e){var t,n;return n="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:n*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||i.isNegativeZero(e))},represent:function(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(i.isNegativeZero(e))return"-0.0";return n=e.toString(10),A.test(n)?n.replace("e",".e"):n},defaultStyle:"lowercase"}),O=_.extend({implicit:[x,w,T,C]}),P=O,R=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),N=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");var I=new f("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==R.exec(e)||null!==N.exec(e))},construct:function(e){var t,n,r,i,o,s,a,u,c=0,l=null;if(null===(t=R.exec(e))&&(t=N.exec(e)),null===t)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(n,r,i));if(o=+t[4],s=+t[5],a=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(l=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(l=-l)),u=new Date(Date.UTC(n,r,i,o,s,a,c)),l&&u.setTime(u.getTime()-l),u},instanceOf:Date,represent:function(e){return e.toISOString()}});var k=new f("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}}),D="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";var L=new f("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,r=0,i=e.length,o=D;for(n=0;n<i;n++)if(!((t=o.indexOf(e.charAt(n)))>64)){if(t<0)return!1;r+=6}return r%8==0},construct:function(e){var t,n,r=e.replace(/[\r\n=]/g,""),i=r.length,o=D,s=0,a=[];for(t=0;t<i;t++)t%4==0&&t&&(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)),s=s<<6|o.indexOf(r.charAt(t));return 0===(n=i%4*6)?(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)):18===n?(a.push(s>>10&255),a.push(s>>2&255)):12===n&&a.push(s>>4&255),new Uint8Array(a)},predicate:function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},represent:function(e){var t,n,r="",i=0,o=e.length,s=D;for(t=0;t<o;t++)t%3==0&&t&&(r+=s[i>>18&63],r+=s[i>>12&63],r+=s[i>>6&63],r+=s[63&i]),i=(i<<8)+e[t];return 0===(n=o%3)?(r+=s[i>>18&63],r+=s[i>>12&63],r+=s[i>>6&63],r+=s[63&i]):2===n?(r+=s[i>>10&63],r+=s[i>>4&63],r+=s[i<<2&63],r+=s[64]):1===n&&(r+=s[i>>2&63],r+=s[i<<4&63],r+=s[64],r+=s[64]),r}}),U=Object.prototype.hasOwnProperty,F=Object.prototype.toString;var B=new f("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,r,i,o,s=[],a=e;for(t=0,n=a.length;t<n;t+=1){if(r=a[t],o=!1,"[object Object]"!==F.call(r))return!1;for(i in r)if(U.call(r,i)){if(o)return!1;o=!0}if(!o)return!1;if(-1!==s.indexOf(i))return!1;s.push(i)}return!0},construct:function(e){return null!==e?e:[]}}),z=Object.prototype.toString;var j=new f("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,r,i,o,s=e;for(o=new Array(s.length),t=0,n=s.length;t<n;t+=1){if(r=s[t],"[object Object]"!==z.call(r))return!1;if(1!==(i=Object.keys(r)).length)return!1;o[t]=[i[0],r[i[0]]]}return!0},construct:function(e){if(null===e)return[];var t,n,r,i,o,s=e;for(o=new Array(s.length),t=0,n=s.length;t<n;t+=1)r=s[t],i=Object.keys(r),o[t]=[i[0],r[i[0]]];return o}}),V=Object.prototype.hasOwnProperty;var G=new f("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,n=e;for(t in n)if(V.call(n,t)&&null!==n[t])return!1;return!0},construct:function(e){return null!==e?e:{}}}),H=P.extend({implicit:[I,k],explicit:[L,B,j,G]}),W=Object.prototype.hasOwnProperty,q=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,X=/[\x85\u2028\u2029]/,Z=/[,\[\]\{\}]/,$=/^(?:!|!!|![a-z\-]+!)$/i,Y=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function K(e){return Object.prototype.toString.call(e)}function Q(e){return 10===e||13===e}function J(e){return 9===e||32===e}function ee(e){return 9===e||32===e||10===e||13===e}function te(e){return 44===e||91===e||93===e||123===e||125===e}function ne(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function re(e){return 48===e?"\0":97===e?"":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"":95===e?" ":76===e?"\u2028":80===e?"\u2029":""}function ie(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}for(var oe=new Array(256),se=new Array(256),ae=0;ae<256;ae++)oe[ae]=re(ae)?1:0,se[ae]=re(ae);function ue(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||H,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function ce(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=l(n),new a(t,n)}function le(e,t){throw ce(e,t)}function he(e,t){e.onWarning&&e.onWarning.call(null,ce(e,t))}var de={YAML:function(e,t,n){var r,i,o;null!==e.version&&le(e,"duplication of %YAML directive"),1!==n.length&&le(e,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(n[0]))&&le(e,"ill-formed argument of the YAML directive"),i=parseInt(r[1],10),o=parseInt(r[2],10),1!==i&&le(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=o<2,1!==o&&2!==o&&he(e,"unsupported YAML version of the document")},TAG:function(e,t,n){var r,i;2!==n.length&&le(e,"TAG directive accepts exactly two arguments"),r=n[0],i=n[1],$.test(r)||le(e,"ill-formed tag handle (first argument) of the TAG directive"),W.call(e.tagMap,r)&&le(e,'there is a previously declared suffix for "'+r+'" tag handle'),Y.test(i)||le(e,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch(t){le(e,"tag prefix is malformed: "+i)}e.tagMap[r]=i}};function fe(e,t,n,r){var i,o,s,a;if(t<n){if(a=e.input.slice(t,n),r)for(i=0,o=a.length;i<o;i+=1)9===(s=a.charCodeAt(i))||32<=s&&s<=1114111||le(e,"expected valid JSON character");else q.test(a)&&le(e,"the stream contains non-printable characters");e.result+=a}}function pe(e,t,n,r){var o,s,a,u;for(i.isObject(n)||le(e,"cannot merge mappings; the provided source object is unacceptable"),a=0,u=(o=Object.keys(n)).length;a<u;a+=1)s=o[a],W.call(t,s)||(t[s]=n[s],r[s]=!0)}function me(e,t,n,r,i,o,s,a,u){var c,l;if(Array.isArray(i))for(c=0,l=(i=Array.prototype.slice.call(i)).length;c<l;c+=1)Array.isArray(i[c])&&le(e,"nested arrays are not supported inside keys"),"object"==typeof i&&"[object Object]"===K(i[c])&&(i[c]="[object Object]");if("object"==typeof i&&"[object Object]"===K(i)&&(i="[object Object]"),i=String(i),null===t&&(t={}),"tag:yaml.org,2002:merge"===r)if(Array.isArray(o))for(c=0,l=o.length;c<l;c+=1)pe(e,t,o[c],n);else pe(e,t,o,n);else e.json||W.call(n,i)||!W.call(t,i)||(e.line=s||e.line,e.lineStart=a||e.lineStart,e.position=u||e.position,le(e,"duplicated mapping key")),"__proto__"===i?Object.defineProperty(t,i,{configurable:!0,enumerable:!0,writable:!0,value:o}):t[i]=o,delete n[i];return t}function ge(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):le(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function ve(e,t,n){for(var r=0,i=e.input.charCodeAt(e.position);0!==i;){for(;J(i);)9===i&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&35===i)do{i=e.input.charCodeAt(++e.position)}while(10!==i&&13!==i&&0!==i);if(!Q(i))break;for(ge(e),i=e.input.charCodeAt(e.position),r++,e.lineIndent=0;32===i;)e.lineIndent++,i=e.input.charCodeAt(++e.position)}return-1!==n&&0!==r&&e.lineIndent<n&&he(e,"deficient indentation"),r}function ye(e){var t,n=e.position;return!(45!==(t=e.input.charCodeAt(n))&&46!==t||t!==e.input.charCodeAt(n+1)||t!==e.input.charCodeAt(n+2)||(n+=3,0!==(t=e.input.charCodeAt(n))&&!ee(t)))}function be(e,t){1===t?e.result+=" ":t>1&&(e.result+=i.repeat("\n",t-1))}function _e(e,t){var n,r,i=e.tag,o=e.anchor,s=[],a=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=s),r=e.input.charCodeAt(e.position);0!==r&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,le(e,"tab characters must not be used in indentation")),45===r)&&ee(e.input.charCodeAt(e.position+1));)if(a=!0,e.position++,ve(e,!0,-1)&&e.lineIndent<=t)s.push(null),r=e.input.charCodeAt(e.position);else if(n=e.line,Se(e,t,3,!1,!0),s.push(e.result),ve(e,!0,-1),r=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&0!==r)le(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!a&&(e.tag=i,e.anchor=o,e.kind="sequence",e.result=s,!0)}function xe(e){var t,n,r,i,o=!1,s=!1;if(33!==(i=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&le(e,"duplication of a tag property"),60===(i=e.input.charCodeAt(++e.position))?(o=!0,i=e.input.charCodeAt(++e.position)):33===i?(s=!0,n="!!",i=e.input.charCodeAt(++e.position)):n="!",t=e.position,o){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&62!==i);e.position<e.length?(r=e.input.slice(t,e.position),i=e.input.charCodeAt(++e.position)):le(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==i&&!ee(i);)33===i&&(s?le(e,"tag suffix cannot contain exclamation marks"):(n=e.input.slice(t-1,e.position+1),$.test(n)||le(e,"named tag handle cannot contain such characters"),s=!0,t=e.position+1)),i=e.input.charCodeAt(++e.position);r=e.input.slice(t,e.position),Z.test(r)&&le(e,"tag suffix cannot contain flow indicator characters")}r&&!Y.test(r)&&le(e,"tag name cannot contain such characters: "+r);try{r=decodeURIComponent(r)}catch(t){le(e,"tag name is malformed: "+r)}return o?e.tag=r:W.call(e.tagMap,n)?e.tag=e.tagMap[n]+r:"!"===n?e.tag="!"+r:"!!"===n?e.tag="tag:yaml.org,2002:"+r:le(e,'undeclared tag handle "'+n+'"'),!0}function we(e){var t,n;if(38!==(n=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&le(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!ee(n)&&!te(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&le(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function Se(e,t,n,r,o){var s,a,u,c,l,h,d,f,p,m=1,g=!1,v=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,s=a=u=4===n||3===n,r&&ve(e,!0,-1)&&(g=!0,e.lineIndent>t?m=1:e.lineIndent===t?m=0:e.lineIndent<t&&(m=-1)),1===m)for(;xe(e)||we(e);)ve(e,!0,-1)?(g=!0,u=s,e.lineIndent>t?m=1:e.lineIndent===t?m=0:e.lineIndent<t&&(m=-1)):u=!1;if(u&&(u=g||o),1!==m&&4!==n||(f=1===n||2===n?t:t+1,p=e.position-e.lineStart,1===m?u&&(_e(e,p)||function(e,t,n){var r,i,o,s,a,u,c,l=e.tag,h=e.anchor,d={},f=Object.create(null),p=null,m=null,g=null,v=!1,y=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=d),c=e.input.charCodeAt(e.position);0!==c;){if(v||-1===e.firstTabInLine||(e.position=e.firstTabInLine,le(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),o=e.line,63!==c&&58!==c||!ee(r)){if(s=e.line,a=e.lineStart,u=e.position,!Se(e,n,2,!1,!0))break;if(e.line===o){for(c=e.input.charCodeAt(e.position);J(c);)c=e.input.charCodeAt(++e.position);if(58===c)ee(c=e.input.charCodeAt(++e.position))||le(e,"a whitespace character is expected after the key-value separator within a block mapping"),v&&(me(e,d,f,p,m,null,s,a,u),p=m=g=null),y=!0,v=!1,i=!1,p=e.tag,m=e.result;else{if(!y)return e.tag=l,e.anchor=h,!0;le(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!y)return e.tag=l,e.anchor=h,!0;le(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===c?(v&&(me(e,d,f,p,m,null,s,a,u),p=m=g=null),y=!0,v=!0,i=!0):v?(v=!1,i=!0):le(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,c=r;if((e.line===o||e.lineIndent>t)&&(v&&(s=e.line,a=e.lineStart,u=e.position),Se(e,t,4,!0,i)&&(v?m=e.result:g=e.result),v||(me(e,d,f,p,m,g,s,a,u),p=m=g=null),ve(e,!0,-1),c=e.input.charCodeAt(e.position)),(e.line===o||e.lineIndent>t)&&0!==c)le(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return v&&me(e,d,f,p,m,null,s,a,u),y&&(e.tag=l,e.anchor=h,e.kind="mapping",e.result=d),y}(e,p,f))||function(e,t){var n,r,i,o,s,a,u,c,l,h,d,f,p=!0,m=e.tag,g=e.anchor,v=Object.create(null);if(91===(f=e.input.charCodeAt(e.position)))s=93,c=!1,o=[];else{if(123!==f)return!1;s=125,c=!0,o={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=o),f=e.input.charCodeAt(++e.position);0!==f;){if(ve(e,!0,t),(f=e.input.charCodeAt(e.position))===s)return e.position++,e.tag=m,e.anchor=g,e.kind=c?"mapping":"sequence",e.result=o,!0;p?44===f&&le(e,"expected the node content, but found ','"):le(e,"missed comma between flow collection entries"),d=null,a=u=!1,63===f&&ee(e.input.charCodeAt(e.position+1))&&(a=u=!0,e.position++,ve(e,!0,t)),n=e.line,r=e.lineStart,i=e.position,Se(e,t,1,!1,!0),h=e.tag,l=e.result,ve(e,!0,t),f=e.input.charCodeAt(e.position),!u&&e.line!==n||58!==f||(a=!0,f=e.input.charCodeAt(++e.position),ve(e,!0,t),Se(e,t,1,!1,!0),d=e.result),c?me(e,o,v,h,l,d,n,r,i):a?o.push(me(e,null,v,h,l,d,n,r,i)):o.push(l),ve(e,!0,t),44===(f=e.input.charCodeAt(e.position))?(p=!0,f=e.input.charCodeAt(++e.position)):p=!1}le(e,"unexpected end of the stream within a flow collection")}(e,f)?v=!0:(a&&function(e,t){var n,r,o,s,a,u=1,c=!1,l=!1,h=t,d=0,f=!1;if(124===(s=e.input.charCodeAt(e.position)))r=!1;else{if(62!==s)return!1;r=!0}for(e.kind="scalar",e.result="";0!==s;)if(43===(s=e.input.charCodeAt(++e.position))||45===s)1===u?u=43===s?3:2:le(e,"repeat of a chomping mode identifier");else{if(!((o=48<=(a=s)&&a<=57?a-48:-1)>=0))break;0===o?le(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):l?le(e,"repeat of an indentation width identifier"):(h=t+o-1,l=!0)}if(J(s)){do{s=e.input.charCodeAt(++e.position)}while(J(s));if(35===s)do{s=e.input.charCodeAt(++e.position)}while(!Q(s)&&0!==s)}for(;0!==s;){for(ge(e),e.lineIndent=0,s=e.input.charCodeAt(e.position);(!l||e.lineIndent<h)&&32===s;)e.lineIndent++,s=e.input.charCodeAt(++e.position);if(!l&&e.lineIndent>h&&(h=e.lineIndent),Q(s))d++;else{if(e.lineIndent<h){3===u?e.result+=i.repeat("\n",c?1+d:d):1===u&&c&&(e.result+="\n");break}for(r?J(s)?(f=!0,e.result+=i.repeat("\n",c?1+d:d)):f?(f=!1,e.result+=i.repeat("\n",d+1)):0===d?c&&(e.result+=" "):e.result+=i.repeat("\n",d):e.result+=i.repeat("\n",c?1+d:d),c=!0,l=!0,d=0,n=e.position;!Q(s)&&0!==s;)s=e.input.charCodeAt(++e.position);fe(e,n,e.position,!1)}}return!0}(e,f)||function(e,t){var n,r,i;if(39!==(n=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,r=i=e.position;0!==(n=e.input.charCodeAt(e.position));)if(39===n){if(fe(e,r,e.position,!0),39!==(n=e.input.charCodeAt(++e.position)))return!0;r=e.position,e.position++,i=e.position}else Q(n)?(fe(e,r,i,!0),be(e,ve(e,!1,t)),r=i=e.position):e.position===e.lineStart&&ye(e)?le(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);le(e,"unexpected end of the stream within a single quoted scalar")}(e,f)||function(e,t){var n,r,i,o,s,a,u;if(34!==(a=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;0!==(a=e.input.charCodeAt(e.position));){if(34===a)return fe(e,n,e.position,!0),e.position++,!0;if(92===a){if(fe(e,n,e.position,!0),Q(a=e.input.charCodeAt(++e.position)))ve(e,!1,t);else if(a<256&&oe[a])e.result+=se[a],e.position++;else if((s=120===(u=a)?2:117===u?4:85===u?8:0)>0){for(i=s,o=0;i>0;i--)(s=ne(a=e.input.charCodeAt(++e.position)))>=0?o=(o<<4)+s:le(e,"expected hexadecimal character");e.result+=ie(o),e.position++}else le(e,"unknown escape sequence");n=r=e.position}else Q(a)?(fe(e,n,r,!0),be(e,ve(e,!1,t)),n=r=e.position):e.position===e.lineStart&&ye(e)?le(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}le(e,"unexpected end of the stream within a double quoted scalar")}(e,f)?v=!0:!function(e){var t,n,r;if(42!==(r=e.input.charCodeAt(e.position)))return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;0!==r&&!ee(r)&&!te(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&le(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),W.call(e.anchorMap,n)||le(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],ve(e,!0,-1),!0}(e)?function(e,t,n){var r,i,o,s,a,u,c,l,h=e.kind,d=e.result;if(ee(l=e.input.charCodeAt(e.position))||te(l)||35===l||38===l||42===l||33===l||124===l||62===l||39===l||34===l||37===l||64===l||96===l)return!1;if((63===l||45===l)&&(ee(r=e.input.charCodeAt(e.position+1))||n&&te(r)))return!1;for(e.kind="scalar",e.result="",i=o=e.position,s=!1;0!==l;){if(58===l){if(ee(r=e.input.charCodeAt(e.position+1))||n&&te(r))break}else if(35===l){if(ee(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&ye(e)||n&&te(l))break;if(Q(l)){if(a=e.line,u=e.lineStart,c=e.lineIndent,ve(e,!1,-1),e.lineIndent>=t){s=!0,l=e.input.charCodeAt(e.position);continue}e.position=o,e.line=a,e.lineStart=u,e.lineIndent=c;break}}s&&(fe(e,i,o,!1),be(e,e.line-a),i=o=e.position,s=!1),J(l)||(o=e.position+1),l=e.input.charCodeAt(++e.position)}return fe(e,i,o,!1),!!e.result||(e.kind=h,e.result=d,!1)}(e,f,1===n)&&(v=!0,null===e.tag&&(e.tag="?")):(v=!0,null===e.tag&&null===e.anchor||le(e,"alias node should not have any properties")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===m&&(v=u&&_e(e,p))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&le(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),c=0,l=e.implicitTypes.length;c<l;c+=1)if((d=e.implicitTypes[c]).resolve(e.result)){e.result=d.construct(e.result),e.tag=d.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if(W.call(e.typeMap[e.kind||"fallback"],e.tag))d=e.typeMap[e.kind||"fallback"][e.tag];else for(d=null,c=0,l=(h=e.typeMap.multi[e.kind||"fallback"]).length;c<l;c+=1)if(e.tag.slice(0,h[c].tag.length)===h[c].tag){d=h[c];break}d||le(e,"unknown tag !<"+e.tag+">"),null!==e.result&&d.kind!==e.kind&&le(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+d.kind+'", not "'+e.kind+'"'),d.resolve(e.result,e.tag)?(e.result=d.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):le(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||v}function Ee(e){var t,n,r,i,o=e.position,s=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(i=e.input.charCodeAt(e.position))&&(ve(e,!0,-1),i=e.input.charCodeAt(e.position),!(e.lineIndent>0||37!==i));){for(s=!0,i=e.input.charCodeAt(++e.position),t=e.position;0!==i&&!ee(i);)i=e.input.charCodeAt(++e.position);for(r=[],(n=e.input.slice(t,e.position)).length<1&&le(e,"directive name must not be less than one character in length");0!==i;){for(;J(i);)i=e.input.charCodeAt(++e.position);if(35===i){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&!Q(i));break}if(Q(i))break;for(t=e.position;0!==i&&!ee(i);)i=e.input.charCodeAt(++e.position);r.push(e.input.slice(t,e.position))}0!==i&&ge(e),W.call(de,n)?de[n](e,n,r):he(e,'unknown document directive "'+n+'"')}ve(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,ve(e,!0,-1)):s&&le(e,"directives end mark is expected"),Se(e,e.lineIndent-1,4,!1,!0),ve(e,!0,-1),e.checkLineBreaks&&X.test(e.input.slice(o,e.position))&&he(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&ye(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,ve(e,!0,-1)):e.position<e.length-1&&le(e,"end of the stream or a document separator is expected")}function Te(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var n=new ue(e,t),r=e.indexOf("\0");for(-1!==r&&(n.position=r,le(n,"null byte is not allowed in input")),n.input+="\0";32===n.input.charCodeAt(n.position);)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)Ee(n);return n.documents}var Me={loadAll:function(e,t,n){null!==t&&"object"==typeof t&&void 0===n&&(n=t,t=null);var r=Te(e,n);if("function"!=typeof t)return r;for(var i=0,o=r.length;i<o;i+=1)t(r[i])},load:function(e,t){var n=Te(e,t);if(0!==n.length){if(1===n.length)return n[0];throw new a("expected a single document in the stream, but found more")}}},Ae=Object.prototype.toString,Ce=Object.prototype.hasOwnProperty,Oe=65279,Pe={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},Re=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],Ne=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function Ie(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else{if(!(e<=4294967295))throw new a("code point within a string may not be greater than 0xFFFFFFFF");n="U",r=8}return"\\"+n+i.repeat("0",r-t.length)+t}function ke(e){this.schema=e.schema||H,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=i.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=function(e,t){var n,r,i,o,s,a,u;if(null===t)return{};for(n={},i=0,o=(r=Object.keys(t)).length;i<o;i+=1)s=r[i],a=String(t[s]),"!!"===s.slice(0,2)&&(s="tag:yaml.org,2002:"+s.slice(2)),(u=e.compiledTypeMap.fallback[s])&&Ce.call(u.styleAliases,a)&&(a=u.styleAliases[a]),n[s]=a;return n}(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType='"'===e.quotingType?2:1,this.forceQuotes=e.forceQuotes||!1,this.replacer="function"==typeof e.replacer?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function De(e,t){for(var n,r=i.repeat(" ",t),o=0,s=-1,a="",u=e.length;o<u;)-1===(s=e.indexOf("\n",o))?(n=e.slice(o),o=u):(n=e.slice(o,s+1),o=s+1),n.length&&"\n"!==n&&(a+=r),a+=n;return a}function Le(e,t){return"\n"+i.repeat(" ",e.indent*t)}function Ue(e){return 32===e||9===e}function Fe(e){return 32<=e&&e<=126||161<=e&&e<=55295&&8232!==e&&8233!==e||57344<=e&&e<=65533&&e!==Oe||65536<=e&&e<=1114111}function Be(e){return Fe(e)&&e!==Oe&&13!==e&&10!==e}function ze(e,t,n){var r=Be(e),i=r&&!Ue(e);return(n?r:r&&44!==e&&91!==e&&93!==e&&123!==e&&125!==e)&&35!==e&&!(58===t&&!i)||Be(t)&&!Ue(t)&&35===e||58===t&&i}function je(e,t){var n,r=e.charCodeAt(t);return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1))>=56320&&n<=57343?1024*(r-55296)+n-56320+65536:r}function Ve(e){return/^\n* /.test(e)}function Ge(e,t,n,r,i,o,s,a){var u,c,l=0,h=null,d=!1,f=!1,p=-1!==r,m=-1,g=Fe(c=je(e,0))&&c!==Oe&&!Ue(c)&&45!==c&&63!==c&&58!==c&&44!==c&&91!==c&&93!==c&&123!==c&&125!==c&&35!==c&&38!==c&&42!==c&&33!==c&&124!==c&&61!==c&&62!==c&&39!==c&&34!==c&&37!==c&&64!==c&&96!==c&&function(e){return!Ue(e)&&58!==e}(je(e,e.length-1));if(t||s)for(u=0;u<e.length;l>=65536?u+=2:u++){if(!Fe(l=je(e,u)))return 5;g=g&&ze(l,h,a),h=l}else{for(u=0;u<e.length;l>=65536?u+=2:u++){if(10===(l=je(e,u)))d=!0,p&&(f=f||u-m-1>r&&" "!==e[m+1],m=u);else if(!Fe(l))return 5;g=g&&ze(l,h,a),h=l}f=f||p&&u-m-1>r&&" "!==e[m+1]}return d||f?n>9&&Ve(e)?5:s?2===o?5:2:f?4:3:!g||s||i(e)?2===o?5:2:1}function He(e,t,n,r,i){e.dump=function(){if(0===t.length)return 2===e.quotingType?'""':"''";if(!e.noCompatMode&&(-1!==Re.indexOf(t)||Ne.test(t)))return 2===e.quotingType?'"'+t+'"':"'"+t+"'";var o=e.indent*Math.max(1,n),s=-1===e.lineWidth?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-o),u=r||e.flowLevel>-1&&n>=e.flowLevel;switch(Ge(t,u,e.indent,s,(function(t){return function(e,t){var n,r;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(e.implicitTypes[n].resolve(t))return!0;return!1}(e,t)}),e.quotingType,e.forceQuotes&&!r,i)){case 1:return t;case 2:return"'"+t.replace(/'/g,"''")+"'";case 3:return"|"+We(t,e.indent)+qe(De(t,o));case 4:return">"+We(t,e.indent)+qe(De(function(e,t){var n,r,i=/(\n+)([^\n]*)/g,o=(a=e.indexOf("\n"),a=-1!==a?a:e.length,i.lastIndex=a,Xe(e.slice(0,a),t)),s="\n"===e[0]||" "===e[0];var a;for(;r=i.exec(e);){var u=r[1],c=r[2];n=" "===c[0],o+=u+(s||n||""===c?"":"\n")+Xe(c,t),s=n}return o}(t,s),o));case 5:return'"'+function(e){for(var t,n="",r=0,i=0;i<e.length;r>=65536?i+=2:i++)r=je(e,i),!(t=Pe[r])&&Fe(r)?(n+=e[i],r>=65536&&(n+=e[i+1])):n+=t||Ie(r);return n}(t)+'"';default:throw new a("impossible error: invalid scalar style")}}()}function We(e,t){var n=Ve(e)?String(t):"",r="\n"===e[e.length-1];return n+(r&&("\n"===e[e.length-2]||"\n"===e)?"+":r?"":"-")+"\n"}function qe(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}function Xe(e,t){if(""===e||" "===e[0])return e;for(var n,r,i=/ [^ ]/g,o=0,s=0,a=0,u="";n=i.exec(e);)(a=n.index)-o>t&&(r=s>o?s:a,u+="\n"+e.slice(o,r),o=r+1),s=a;return u+="\n",e.length-o>t&&s>o?u+=e.slice(o,s)+"\n"+e.slice(s+1):u+=e.slice(o),u.slice(1)}function Ze(e,t,n,r){var i,o,s,a="",u=e.tag;for(i=0,o=n.length;i<o;i+=1)s=n[i],e.replacer&&(s=e.replacer.call(n,String(i),s)),(Ye(e,t+1,s,!0,!0,!1,!0)||void 0===s&&Ye(e,t+1,null,!0,!0,!1,!0))&&(r&&""===a||(a+=Le(e,t)),e.dump&&10===e.dump.charCodeAt(0)?a+="-":a+="- ",a+=e.dump);e.tag=u,e.dump=a||"[]"}function $e(e,t,n){var r,i,o,s,u,c;for(o=0,s=(i=n?e.explicitTypes:e.implicitTypes).length;o<s;o+=1)if(((u=i[o]).instanceOf||u.predicate)&&(!u.instanceOf||"object"==typeof t&&t instanceof u.instanceOf)&&(!u.predicate||u.predicate(t))){if(n?u.multi&&u.representName?e.tag=u.representName(t):e.tag=u.tag:e.tag="?",u.represent){if(c=e.styleMap[u.tag]||u.defaultStyle,"[object Function]"===Ae.call(u.represent))r=u.represent(t,c);else{if(!Ce.call(u.represent,c))throw new a("!<"+u.tag+'> tag resolver accepts not "'+c+'" style');r=u.represent[c](t,c)}e.dump=r}return!0}return!1}function Ye(e,t,n,r,i,o,s){e.tag=null,e.dump=n,$e(e,n,!1)||$e(e,n,!0);var u,c=Ae.call(e.dump),l=r;r&&(r=e.flowLevel<0||e.flowLevel>t);var h,d,f="[object Object]"===c||"[object Array]"===c;if(f&&(d=-1!==(h=e.duplicates.indexOf(n))),(null!==e.tag&&"?"!==e.tag||d||2!==e.indent&&t>0)&&(i=!1),d&&e.usedDuplicates[h])e.dump="*ref_"+h;else{if(f&&d&&!e.usedDuplicates[h]&&(e.usedDuplicates[h]=!0),"[object Object]"===c)r&&0!==Object.keys(e.dump).length?(!function(e,t,n,r){var i,o,s,u,c,l,h="",d=e.tag,f=Object.keys(n);if(!0===e.sortKeys)f.sort();else if("function"==typeof e.sortKeys)f.sort(e.sortKeys);else if(e.sortKeys)throw new a("sortKeys must be a boolean or a function");for(i=0,o=f.length;i<o;i+=1)l="",r&&""===h||(l+=Le(e,t)),u=n[s=f[i]],e.replacer&&(u=e.replacer.call(n,s,u)),Ye(e,t+1,s,!0,!0,!0)&&((c=null!==e.tag&&"?"!==e.tag||e.dump&&e.dump.length>1024)&&(e.dump&&10===e.dump.charCodeAt(0)?l+="?":l+="? "),l+=e.dump,c&&(l+=Le(e,t)),Ye(e,t+1,u,!0,c)&&(e.dump&&10===e.dump.charCodeAt(0)?l+=":":l+=": ",h+=l+=e.dump));e.tag=d,e.dump=h||"{}"}(e,t,e.dump,i),d&&(e.dump="&ref_"+h+e.dump)):(!function(e,t,n){var r,i,o,s,a,u="",c=e.tag,l=Object.keys(n);for(r=0,i=l.length;r<i;r+=1)a="",""!==u&&(a+=", "),e.condenseFlow&&(a+='"'),s=n[o=l[r]],e.replacer&&(s=e.replacer.call(n,o,s)),Ye(e,t,o,!1,!1)&&(e.dump.length>1024&&(a+="? "),a+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),Ye(e,t,s,!1,!1)&&(u+=a+=e.dump));e.tag=c,e.dump="{"+u+"}"}(e,t,e.dump),d&&(e.dump="&ref_"+h+" "+e.dump));else if("[object Array]"===c)r&&0!==e.dump.length?(e.noArrayIndent&&!s&&t>0?Ze(e,t-1,e.dump,i):Ze(e,t,e.dump,i),d&&(e.dump="&ref_"+h+e.dump)):(!function(e,t,n){var r,i,o,s="",a=e.tag;for(r=0,i=n.length;r<i;r+=1)o=n[r],e.replacer&&(o=e.replacer.call(n,String(r),o)),(Ye(e,t,o,!1,!1)||void 0===o&&Ye(e,t,null,!1,!1))&&(""!==s&&(s+=","+(e.condenseFlow?"":" ")),s+=e.dump);e.tag=a,e.dump="["+s+"]"}(e,t,e.dump),d&&(e.dump="&ref_"+h+" "+e.dump));else{if("[object String]"!==c){if("[object Undefined]"===c)return!1;if(e.skipInvalid)return!1;throw new a("unacceptable kind of an object to dump "+c)}"?"!==e.tag&&He(e,e.dump,t,o,l)}null!==e.tag&&"?"!==e.tag&&(u=encodeURI("!"===e.tag[0]?e.tag.slice(1):e.tag).replace(/!/g,"%21"),u="!"===e.tag[0]?"!"+u:"tag:yaml.org,2002:"===u.slice(0,18)?"!!"+u.slice(18):"!<"+u+">",e.dump=u+" "+e.dump)}return!0}function Ke(e,t){var n,r,i=[],o=[];for(Qe(e,i,o),n=0,r=o.length;n<r;n+=1)t.duplicates.push(i[o[n]]);t.usedDuplicates=new Array(r)}function Qe(e,t,n){var r,i,o;if(null!==e&&"object"==typeof e)if(-1!==(i=t.indexOf(e)))-1===n.indexOf(i)&&n.push(i);else if(t.push(e),Array.isArray(e))for(i=0,o=e.length;i<o;i+=1)Qe(e[i],t,n);else for(i=0,o=(r=Object.keys(e)).length;i<o;i+=1)Qe(e[r[i]],t,n)}function Je(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var et={Type:f,Schema:g,FAILSAFE_SCHEMA:_,JSON_SCHEMA:O,CORE_SCHEMA:P,DEFAULT_SCHEMA:H,load:Me.load,loadAll:Me.loadAll,dump:{dump:function(e,t){var n=new ke(t=t||{});n.noRefs||Ke(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),Ye(n,0,r,!0,!0)?n.dump+"\n":""}}.dump,YAMLException:a,types:{binary:L,float:C,map:b,null:x,pairs:j,set:G,timestamp:I,bool:w,int:T,merge:k,omap:B,seq:y,str:v},safeLoad:Je("safeLoad","load"),safeLoadAll:Je("safeLoadAll","loadAll"),safeDump:Je("safeDump","dump")};t.ZP=et},42358:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(32598);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t,n){return Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,s,a=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t);else for(;!(u=(r=o.call(n)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var a=o((function e(t,n){var r=n.default,i=void 0===r?null:r,o=n.triggerUpdate,s=void 0===o||o,a=n.onChange,u=void 0===a?function(e,t){}:a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.defaultVal=i,this.triggerUpdate=s,this.onChange=u}));function u(e){var t=e.stateInit,n=void 0===t?function(){return{}}:t,i=e.props,o=void 0===i?{}:i,u=e.methods,c=void 0===u?{}:u,l=e.aliases,h=void 0===l?{}:l,d=e.init,f=void 0===d?function(){}:d,p=e.update,m=void 0===p?function(){}:p,g=Object.keys(o).map((function(e){return new a(e,o[e])}));return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},n instanceof Function?n(e):n,{initialised:!1}),i={};function o(t){return a(t,e),u(),o}var a=function(e,n){f.call(o,e,t,n),t.initialised=!0},u=(0,r.Z)((function(){t.initialised&&(m.call(o,t,i),i={})}),1);return g.forEach((function(e){o[e.name]=function(e){var n=e.name,r=e.triggerUpdate,s=void 0!==r&&r,a=e.onChange,c=void 0===a?function(e,t){}:a,l=e.defaultVal,h=void 0===l?null:l;return function(e){var r=t[n];if(!arguments.length)return r;var a=void 0===e?h:e;return t[n]=a,c.call(o,a,t,r),!i.hasOwnProperty(n)&&(i[n]=r),s&&u(),o}}(e)})),Object.keys(c).forEach((function(e){o[e]=function(){for(var n,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(n=c[e]).call.apply(n,[o,t].concat(i))}})),Object.entries(h).forEach((function(e){var t=s(e,2),n=t[0],r=t[1];return o[n]=o[r]})),o.resetProps=function(){return g.forEach((function(e){o[e.name](e.defaultVal)})),o},o.resetProps(),t._rerender=u,o}}},32598:function(e,t,n){"use strict";n.d(t,{Z:function(){return R}});var r=n(82433),i="object"==typeof global&&global&&global.Object===Object&&global,o="object"==typeof self&&self&&self.Object===Object&&self,s=i||o||Function("return this")(),a=function(){return s.Date.now()},u=/\s/;var c=function(e){for(var t=e.length;t--&&u.test(e.charAt(t)););return t},l=/^\s+/;var h=function(e){return e?e.slice(0,c(e)+1).replace(l,""):e},d=s.Symbol,f=Object.prototype,p=f.hasOwnProperty,m=f.toString,g=d?d.toStringTag:void 0;var v=function(e){var t=p.call(e,g),n=e[g];try{e[g]=void 0;var r=!0}catch(e){}var i=m.call(e);return r&&(t?e[g]=n:delete e[g]),i},y=Object.prototype.toString;var b=function(e){return y.call(e)},_=d?d.toStringTag:void 0;var x=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":_&&_ in Object(e)?v(e):b(e)};var w=function(e){return null!=e&&"object"==typeof e};var S=function(e){return"symbol"==typeof e||w(e)&&"[object Symbol]"==x(e)},E=/^[-+]0x[0-9a-f]+$/i,T=/^0b[01]+$/i,M=/^0o[0-7]+$/i,A=parseInt;var C=function(e){if("number"==typeof e)return e;if(S(e))return NaN;if((0,r.Z)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=(0,r.Z)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=h(e);var n=T.test(e);return n||M.test(e)?A(e.slice(2),n?2:8):E.test(e)?NaN:+e},O=Math.max,P=Math.min;var R=function(e,t,n){var i,o,s,u,c,l,h=0,d=!1,f=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var n=i,r=o;return i=o=void 0,h=t,u=e.apply(r,n)}function g(e){return h=e,c=setTimeout(y,t),d?m(e):u}function v(e){var n=e-l;return void 0===l||n>=t||n<0||f&&e-h>=s}function y(){var e=a();if(v(e))return b(e);c=setTimeout(y,function(e){var n=t-(e-l);return f?P(n,s-(e-h)):n}(e))}function b(e){return c=void 0,p&&i?m(e):(i=o=void 0,u)}function _(){var e=a(),n=v(e);if(i=arguments,o=this,l=e,n){if(void 0===c)return g(l);if(f)return clearTimeout(c),c=setTimeout(y,t),m(l)}return void 0===c&&(c=setTimeout(y,t)),u}return t=C(t)||0,(0,r.Z)(n)&&(d=!!n.leading,s=(f="maxWait"in n)?O(C(n.maxWait)||0,t):s,p="trailing"in n?!!n.trailing:p),_.cancel=function(){void 0!==c&&clearTimeout(c),h=0,i=l=o=c=void 0},_.flush=function(){return void 0===c?u:b(a())},_}},82433:function(e,t){"use strict";t.Z=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},92067:function(e,t,n){"use strict";function r(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map((function(e){e(n)})),(r=e.get("*"))&&r.slice().map((function(e){e(t,n)}))}}}n.d(t,{Z:function(){return r}})},20680:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{Z:function(){return s}});var i=/^\s+/,o=/\s+$/;function s(e,t){if(t=t||{},(e=e||"")instanceof s)return e;if(!(this instanceof s))return new s(e,t);var n=function(e){var t={r:0,g:0,b:0},n=1,s=null,a=null,u=null,c=!1,l=!1;"string"==typeof e&&(e=function(e){e=e.replace(i,"").replace(o,"").toLowerCase();var t,n=!1;if(S[e])e=S[e],n=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};if(t=L.rgb.exec(e))return{r:t[1],g:t[2],b:t[3]};if(t=L.rgba.exec(e))return{r:t[1],g:t[2],b:t[3],a:t[4]};if(t=L.hsl.exec(e))return{h:t[1],s:t[2],l:t[3]};if(t=L.hsla.exec(e))return{h:t[1],s:t[2],l:t[3],a:t[4]};if(t=L.hsv.exec(e))return{h:t[1],s:t[2],v:t[3]};if(t=L.hsva.exec(e))return{h:t[1],s:t[2],v:t[3],a:t[4]};if(t=L.hex8.exec(e))return{r:C(t[1]),g:C(t[2]),b:C(t[3]),a:N(t[4]),format:n?"name":"hex8"};if(t=L.hex6.exec(e))return{r:C(t[1]),g:C(t[2]),b:C(t[3]),format:n?"name":"hex"};if(t=L.hex4.exec(e))return{r:C(t[1]+""+t[1]),g:C(t[2]+""+t[2]),b:C(t[3]+""+t[3]),a:N(t[4]+""+t[4]),format:n?"name":"hex8"};if(t=L.hex3.exec(e))return{r:C(t[1]+""+t[1]),g:C(t[2]+""+t[2]),b:C(t[3]+""+t[3]),format:n?"name":"hex"};return!1}(e));"object"==r(e)&&(U(e.r)&&U(e.g)&&U(e.b)?(h=e.r,d=e.g,f=e.b,t={r:255*M(h,255),g:255*M(d,255),b:255*M(f,255)},c=!0,l="%"===String(e.r).substr(-1)?"prgb":"rgb"):U(e.h)&&U(e.s)&&U(e.v)?(s=P(e.s),a=P(e.v),t=function(e,t,n){e=6*M(e,360),t=M(t,100),n=M(n,100);var r=Math.floor(e),i=e-r,o=n*(1-t),s=n*(1-i*t),a=n*(1-(1-i)*t),u=r%6,c=[n,s,o,o,a,n][u],l=[a,n,n,s,o,o][u],h=[o,o,a,n,n,s][u];return{r:255*c,g:255*l,b:255*h}}(e.h,s,a),c=!0,l="hsv"):U(e.h)&&U(e.s)&&U(e.l)&&(s=P(e.s),u=P(e.l),t=function(e,t,n){var r,i,o;function s(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(e=M(e,360),t=M(t,100),n=M(n,100),0===t)r=i=o=n;else{var a=n<.5?n*(1+t):n+t-n*t,u=2*n-a;r=s(u,a,e+1/3),i=s(u,a,e),o=s(u,a,e-1/3)}return{r:255*r,g:255*i,b:255*o}}(e.h,s,u),c=!0,l="hsl"),e.hasOwnProperty("a")&&(n=e.a));var h,d,f;return n=T(n),{ok:c,format:e.format||l,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:n}}(e);this._originalInput=e,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=t.format||n.format,this._gradientType=t.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}function a(e,t,n){e=M(e,255),t=M(t,255),n=M(n,255);var r,i,o=Math.max(e,t,n),s=Math.min(e,t,n),a=(o+s)/2;if(o==s)r=i=0;else{var u=o-s;switch(i=a>.5?u/(2-o-s):u/(o+s),o){case e:r=(t-n)/u+(t<n?6:0);break;case t:r=(n-e)/u+2;break;case n:r=(e-t)/u+4}r/=6}return{h:r,s:i,l:a}}function u(e,t,n){e=M(e,255),t=M(t,255),n=M(n,255);var r,i,o=Math.max(e,t,n),s=Math.min(e,t,n),a=o,u=o-s;if(i=0===o?0:u/o,o==s)r=0;else{switch(o){case e:r=(t-n)/u+(t<n?6:0);break;case t:r=(n-e)/u+2;break;case n:r=(e-t)/u+4}r/=6}return{h:r,s:i,v:a}}function c(e,t,n,r){var i=[O(Math.round(e).toString(16)),O(Math.round(t).toString(16)),O(Math.round(n).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function l(e,t,n,r){return[O(R(r)),O(Math.round(e).toString(16)),O(Math.round(t).toString(16)),O(Math.round(n).toString(16))].join("")}function h(e,t){t=0===t?0:t||10;var n=s(e).toHsl();return n.s-=t/100,n.s=A(n.s),s(n)}function d(e,t){t=0===t?0:t||10;var n=s(e).toHsl();return n.s+=t/100,n.s=A(n.s),s(n)}function f(e){return s(e).desaturate(100)}function p(e,t){t=0===t?0:t||10;var n=s(e).toHsl();return n.l+=t/100,n.l=A(n.l),s(n)}function m(e,t){t=0===t?0:t||10;var n=s(e).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(-t/100*255))),n.g=Math.max(0,Math.min(255,n.g-Math.round(-t/100*255))),n.b=Math.max(0,Math.min(255,n.b-Math.round(-t/100*255))),s(n)}function g(e,t){t=0===t?0:t||10;var n=s(e).toHsl();return n.l-=t/100,n.l=A(n.l),s(n)}function v(e,t){var n=s(e).toHsl(),r=(n.h+t)%360;return n.h=r<0?360+r:r,s(n)}function y(e){var t=s(e).toHsl();return t.h=(t.h+180)%360,s(t)}function b(e,t){if(isNaN(t)||t<=0)throw new Error("Argument to polyad must be a positive number");for(var n=s(e).toHsl(),r=[s(e)],i=360/t,o=1;o<t;o++)r.push(s({h:(n.h+o*i)%360,s:n.s,l:n.l}));return r}function _(e){var t=s(e).toHsl(),n=t.h;return[s(e),s({h:(n+72)%360,s:t.s,l:t.l}),s({h:(n+216)%360,s:t.s,l:t.l})]}function x(e,t,n){t=t||6,n=n||30;var r=s(e).toHsl(),i=360/n,o=[s(e)];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,o.push(s(r));return o}function w(e,t){t=t||6;for(var n=s(e).toHsv(),r=n.h,i=n.s,o=n.v,a=[],u=1/t;t--;)a.push(s({h:r,s:i,v:o})),o=(o+u)%1;return a}s.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,t,n,r=this.toRgb();return e=r.r/255,t=r.g/255,n=r.b/255,.2126*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.7152*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))},setAlpha:function(e){return this._a=T(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=u(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=u(this._r,this._g,this._b),t=Math.round(360*e.h),n=Math.round(100*e.s),r=Math.round(100*e.v);return 1==this._a?"hsv("+t+", "+n+"%, "+r+"%)":"hsva("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=a(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=a(this._r,this._g,this._b),t=Math.round(360*e.h),n=Math.round(100*e.s),r=Math.round(100*e.l);return 1==this._a?"hsl("+t+", "+n+"%, "+r+"%)":"hsla("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return c(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return function(e,t,n,r,i){var o=[O(Math.round(e).toString(16)),O(Math.round(t).toString(16)),O(Math.round(n).toString(16)),O(R(r))];if(i&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)&&o[3].charAt(0)==o[3].charAt(1))return o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0);return o.join("")}(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*M(this._r,255))+"%",g:Math.round(100*M(this._g,255))+"%",b:Math.round(100*M(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Math.round(100*M(this._r,255))+"%, "+Math.round(100*M(this._g,255))+"%, "+Math.round(100*M(this._b,255))+"%)":"rgba("+Math.round(100*M(this._r,255))+"%, "+Math.round(100*M(this._g,255))+"%, "+Math.round(100*M(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(E[c(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+l(this._r,this._g,this._b,this._a),n=t,r=this._gradientType?"GradientType = 1, ":"";if(e){var i=s(e);n="#"+l(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this._format;var n=!1,r=this._a<1&&this._a>=0;return t||!r||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"hex4"!==e&&"hex8"!==e&&"name"!==e?("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex4"===e&&(n=this.toHex8String(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},clone:function(){return s(this.toString())},_applyModification:function(e,t){var n=e.apply(null,[this].concat([].slice.call(t)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(p,arguments)},brighten:function(){return this._applyModification(m,arguments)},darken:function(){return this._applyModification(g,arguments)},desaturate:function(){return this._applyModification(h,arguments)},saturate:function(){return this._applyModification(d,arguments)},greyscale:function(){return this._applyModification(f,arguments)},spin:function(){return this._applyModification(v,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(x,arguments)},complement:function(){return this._applyCombination(y,arguments)},monochromatic:function(){return this._applyCombination(w,arguments)},splitcomplement:function(){return this._applyCombination(_,arguments)},triad:function(){return this._applyCombination(b,[3])},tetrad:function(){return this._applyCombination(b,[4])}},s.fromRatio=function(e,t){if("object"==r(e)){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]="a"===i?e[i]:P(e[i]));e=n}return s(e,t)},s.equals=function(e,t){return!(!e||!t)&&s(e).toRgbString()==s(t).toRgbString()},s.random=function(){return s.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},s.mix=function(e,t,n){n=0===n?0:n||50;var r=s(e).toRgb(),i=s(t).toRgb(),o=n/100;return s({r:(i.r-r.r)*o+r.r,g:(i.g-r.g)*o+r.g,b:(i.b-r.b)*o+r.b,a:(i.a-r.a)*o+r.a})},s.readability=function(e,t){var n=s(e),r=s(t);return(Math.max(n.getLuminance(),r.getLuminance())+.05)/(Math.min(n.getLuminance(),r.getLuminance())+.05)},s.isReadable=function(e,t,n){var r,i,o=s.readability(e,t);switch(i=!1,(r=function(e){var t,n;t=((e=e||{level:"AA",size:"small"}).level||"AA").toUpperCase(),n=(e.size||"small").toLowerCase(),"AA"!==t&&"AAA"!==t&&(t="AA");"small"!==n&&"large"!==n&&(n="small");return{level:t,size:n}}(n)).level+r.size){case"AAsmall":case"AAAlarge":i=o>=4.5;break;case"AAlarge":i=o>=3;break;case"AAAsmall":i=o>=7}return i},s.mostReadable=function(e,t,n){var r,i,o,a,u=null,c=0;i=(n=n||{}).includeFallbackColors,o=n.level,a=n.size;for(var l=0;l<t.length;l++)(r=s.readability(e,t[l]))>c&&(c=r,u=s(t[l]));return s.isReadable(e,u,{level:o,size:a})||!i?u:(n.includeFallbackColors=!1,s.mostReadable(e,["#fff","#000"],n))};var S=s.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},E=s.hexNames=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}(S);function T(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function M(e,t){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function A(e){return Math.min(1,Math.max(0,e))}function C(e){return parseInt(e,16)}function O(e){return 1==e.length?"0"+e:""+e}function P(e){return e<=1&&(e=100*e+"%"),e}function R(e){return Math.round(255*parseFloat(e)).toString(16)}function N(e){return C(e)/255}var I,k,D,L=(k="[\\s|\\(]+("+(I="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+I+")[,|\\s]+("+I+")\\s*\\)?",D="[\\s|\\(]+("+I+")[,|\\s]+("+I+")[,|\\s]+("+I+")[,|\\s]+("+I+")\\s*\\)?",{CSS_UNIT:new RegExp(I),rgb:new RegExp("rgb"+k),rgba:new RegExp("rgba"+D),hsl:new RegExp("hsl"+k),hsla:new RegExp("hsla"+D),hsv:new RegExp("hsv"+k),hsva:new RegExp("hsva"+D),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function U(e){return!!L.CSS_UNIT.exec(e)}},53394:function(e,t,n){"use strict";function r(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,r]of e)if(!Object.is(r,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}n.d(t,{X:function(){return r}})},74914:function(e,t,n){"use strict";n.d(t,{M:function(){return i}});const r=e=>{let t;const n=new Set,r=(e,r)=>{const i="function"==typeof e?e(t):e;if(!Object.is(i,t)){const e=t;t=(null!=r?r:"object"!=typeof i||null===i)?i:Object.assign({},t,i),n.forEach((n=>n(t,e)))}},i=()=>t,o={setState:r,getState:i,getInitialState:()=>s,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},s=t=e(r,i,o);return o},i=e=>e?r(e):r},55227:function(e,t,n){"use strict";n.d(t,{U:function(){return a}});var r=n(50959);const i=e=>{let t;const n=new Set,r=(e,r)=>{const i="function"==typeof e?e(t):e;if(!Object.is(i,t)){const e=t;t=(null!=r?r:"object"!=typeof i||null===i)?i:Object.assign({},t,i),n.forEach((n=>n(t,e)))}},i=()=>t,o={setState:r,getState:i,getInitialState:()=>s,subscribe:e=>(n.add(e),()=>n.delete(e))},s=t=e(r,i,o);return o},o=e=>e;const s=e=>{const t=(e=>e?i(e):i)(e),n=e=>function(e,t=o){const n=r.useSyncExternalStore(e.subscribe,(()=>t(e.getState())),(()=>t(e.getInitialState())));return r.useDebugValue(n),n}(t,e);return Object.assign(n,t),n},a=e=>e?s(e):s}}]);